id,title,username,language,date,content
dv30saFW,RotationUtil,GamingLVScripts,Java,Monday 1st of April 2024 12:58:03 PM CDT,"package tech.atani.client.utility.player.rotation;

import net.minecraft.entity.Entity;
import net.minecraft.util.*;
import tech.atani.client.utility.interfaces.Methods;
import tech.atani.client.utility.math.random.RandomUtil;
import tech.atani.client.utility.player.PlayerHandler;
import tech.atani.client.utility.player.raytrace.RaytraceUtil;

import java.security.NoSuchAlgorithmException;
import java.security.SecureRandom;

public class RotationUtil implements Methods {

    public static Vec3 getBestVector(Vec3 look, AxisAlignedBB axisAlignedBB) {
        return new Vec3(MathHelper.clamp(look.xCoord, axisAlignedBB.minX, axisAlignedBB.maxX), MathHelper.clamp(look.yCoord, axisAlignedBB.minY, axisAlignedBB.maxY), MathHelper.clamp(look.zCoord, axisAlignedBB.minZ, axisAlignedBB.maxZ));
    }

    public static Vec3 toDirection(float yaw, float pitch) {
        float f = MathHelper.cos(-yaw * 0.017453292F - (float) Math.PI);
        float f1 = MathHelper.sin(-yaw * 0.017453292F - (float) Math.PI);
        float f2 = -MathHelper.cos(-pitch * 0.017453292F);
        float f3 = MathHelper.sin(-pitch * 0.017453292F);
        return new Vec3((double) (f1 * f2), (double) f3, (double) (f * f2));
    }

    public static Vec3 getVectorForRotation(float yaw, float pitch) {
        float f = MathHelper.cos((float) (-yaw * 0.017163291F - Math.PI));
        float f2 = MathHelper.sin((float) (-yaw * 0.017163291F - Math.PI));
        float f3 = -MathHelper.cos(-pitch * 0.017163291F);
        float f4 = MathHelper.sin(-pitch * 0.017163291F);
        return new Vec3(f2 * f3, f4, f * f3);
    }

    public static float[] getRotation(Vec3 aimVector) {
        double x = aimVector.xCoord - mc.thePlayer.posX;
        double y = aimVector.yCoord - (mc.thePlayer.posY + (double) mc.thePlayer.getEyeHeight());
        double z = aimVector.zCoord - mc.thePlayer.posZ;

        double d3 = MathHelper.sqrt(x * x + z * z);
        float f = (float) (MathHelper.atan2(z, x) * (180 / Math.PI)) - 90.0F;
        float f1 = (float) (-(MathHelper.atan2(y, d3) * (180 / Math.PI)));
        f1 = MathHelper.clamp(f1, -90, 90);
        return new float[]{f, f1};
    }

    public static float[] getRotation(Entity entity, String vectorMode, float heightDivisor, boolean mouseFix, boolean heuristics, double minRandomYaw, double maxRandomYaw, double minRandomPitch, double maxRandomPitch, boolean prediction, float minYaw, float maxYaw, float minPitch, float maxPitch, boolean snapYaw, boolean snapPitch) {
        Vec3 aimVector = getBestVector(mc.thePlayer.getPositionEyes(1F), entity.getEntityBoundingBox());
        switch (vectorMode) {
            case ""Bruteforce"":
                for (double yPercent = 1; yPercent >= 0; yPercent -= 0.25) {
                    for (double xPercent = 1; xPercent >= -0.5; xPercent -= 0.5) {
                        for (double zPercent = 1; zPercent >= -0.5; zPercent -= 0.5) {
                            Vec3 tempVec = new Vec3(xPercent, yPercent, zPercent);
                            if (RaytraceUtil.rayCast(1F, getRotation(tempVec)).typeOfHit == MovingObjectPosition.MovingObjectType.ENTITY) {
                                aimVector = tempVec;
                            }
                        }
                    }
                }
                break;
            case ""Head"":
                aimVector = new Vec3(entity.posX, entity.posY + entity.getEyeHeight(), entity.posZ);
                break;
            case ""Torso"":
                aimVector = new Vec3(entity.posX, entity.posY + entity.getEyeHeight() / 2d, entity.posZ);
                break;
            case ""Feet"":
                aimVector = new Vec3(entity.posX, entity.posY, entity.posZ);
                break;
            case ""Custom"":
                aimVector = new Vec3(entity.posX, entity.posY + entity.getEyeHeight() / heightDivisor, entity.posZ);
                break;
            case ""Random"":
                double x = RandomUtil.randomBetween(0, 0.4) - 0.2;
                double y = RandomUtil.randomBetween(0, 1) + 1;
                double z = RandomUtil.randomBetween(0, 0.4) - 0.2;
                aimVector = new Vec3(entity.posX + x, entity.posY + y, entity.posZ + z);
                break;
        }
        aimVector.xCoord += RandomUtil.randomBetween(minRandomYaw, maxRandomYaw);
        aimVector.yCoord += RandomUtil.randomBetween(minRandomPitch, maxRandomPitch);
        aimVector.zCoord += RandomUtil.randomBetween(minRandomYaw, maxRandomYaw);
        double x = aimVector.xCoord - mc.thePlayer.posX;
        double y = aimVector.yCoord - (mc.thePlayer.posY + (double) mc.thePlayer.getEyeHeight());
        double z = aimVector.zCoord - mc.thePlayer.posZ;

        if (prediction) {
            final boolean targetIsSprinting = entity.isSprinting();
            final boolean playerIsSprinting = mc.thePlayer.isSprinting();

            final float walkingSpeed = 0.10000000149011612f;
            final float targetSpeed = targetIsSprinting ? 1.25f : walkingSpeed;
            final float playerSpeed = playerIsSprinting ? 1.25f : walkingSpeed;

            final float targetPredictedX = (float) ((entity.posX - entity.prevPosX) * targetSpeed);
            final float targetPredictedZ = (float) ((entity.posZ - entity.prevPosZ) * targetSpeed);
            final float playerPredictedX = (float) ((mc.thePlayer.posX - mc.thePlayer.prevPosX) * playerSpeed);
            final float playerPredictedZ = (float) ((mc.thePlayer.posZ - mc.thePlayer.prevPosZ) * playerSpeed);

            if (targetPredictedX != 0.0f && targetPredictedZ != 0.0f || playerPredictedX != 0.0f && playerPredictedZ != 0.0f) {
                x += targetPredictedX + playerPredictedX;
                z += targetPredictedZ + playerPredictedZ;
            }
        }

        if (heuristics) {
            try {
                x += SecureRandom.getInstanceStrong().nextDouble() * 0.1;
                y += SecureRandom.getInstanceStrong().nextDouble() * 0.1;
                z += SecureRandom.getInstanceStrong().nextDouble() * 0.1;
            } catch (NoSuchAlgorithmException e) {
                e.printStackTrace();
            }
        }

        double d3 = MathHelper.sqrt(x * x + z * z);
        float yawSpeed = (float) RandomUtil.randomBetween(minYaw, maxYaw);
        float pitchSpeed = (float) RandomUtil.randomBetween(minPitch, maxPitch);
        float f = (float) (MathHelper.atan2(z, x) * (180 / Math.PI)) - 90.0F;
        float f1 = (float) (-(MathHelper.atan2(y, d3) * (180 / Math.PI)));
        final float deltaYaw = (((f - PlayerHandler.yaw) + 540) % 360) - 180;
        final float deltaPitch = f1 - PlayerHandler.pitch;
        final float yawDistance = MathHelper.clamp_float(deltaYaw, -yawSpeed, yawSpeed);
        final float pitchDistance = MathHelper.clamp_float(deltaPitch, -pitchSpeed, pitchSpeed);
        float calcYaw = snapYaw ? f : PlayerHandler.yaw + yawDistance;
        float calcPitch = snapPitch ? f1 : PlayerHandler.pitch + pitchDistance;
        calcPitch = MathHelper.clamp(calcPitch, -90, 90);
        if (!mouseFix)
            return new float[]{calcYaw, calcPitch};
        return applyMouseFix(calcYaw, calcPitch);
    }

    public static float[] applyMouseFix(float newYaw, float newPitch) {
        final float sensitivity = Math.max(0.001F, mc.gameSettings.mouseSensitivity);
        final int deltaYaw = (int) ((newYaw - PlayerHandler.yaw) / ((sensitivity * (sensitivity >= 0.5 ? sensitivity : 1) / 2)));
        final int deltaPitch = (int) ((newPitch - PlayerHandler.pitch) / ((sensitivity * (sensitivity >= 0.5 ? sensitivity : 1) / 2))) * -1;
        final float f = sensitivity * 0.6F + 0.2F;
        final float f1 = f * f * f * 8.0F;
        final float f2 = (float) deltaYaw * f1;
        final float f3 = (float) deltaPitch * f1;

        final float endYaw = (float) ((double) PlayerHandler.yaw + (double) f2 * 0.15);
        float endPitch = (float) ((double) PlayerHandler.pitch - (double) f3 * 0.15);
        endPitch = MathHelper.clamp(endPitch, -90, 90);
        return new float[]{endYaw, endPitch};
    }

    public static float[] updateRotationSimple(float newYaw, float newPitch, float speed) {
        return RotationUtil.updateRotationSimple(PlayerHandler.yaw, newYaw, speed, PlayerHandler.pitch, newPitch, speed);
    }

    public static float[] updateRotationSimple(float oldYaw, float newYaw, float yawSpeed, float oldPitch, float newPitch, float pitchSpeed) {
        return new float[] {updateRotation(oldYaw, newYaw, yawSpeed), updateRotation(oldPitch, newPitch, pitchSpeed)};
    }

    public static float getDistanceToLastPitch(final float pitch) {
        return Math.abs(pitch - PlayerHandler.pitch);
    }

    public static void resetRotations(float yaw, float pitch, boolean silent) {
        if(silent) {
            mc.thePlayer.rotationYaw = yaw - yaw % 360 + mc.thePlayer.rotationYaw % 360;
        } else {
            mc.thePlayer.rotationYaw = yaw;
            mc.thePlayer.rotationPitch = pitch;
        }
    }

    public static float updateRotation(float oldRot, float newRot, float speed) {
        float f = MathHelper.wrapDegrees(newRot - oldRot);

        if (f > (float) speed) {
            f = (float) speed;
        }

        if (f < -(float) speed) {
            f = -(float) speed;
        }

        return oldRot + f;
    }

}
"
1ArBmL8w,attackTargetEntityWithCurrentItem,GamingLVScripts,Java,Monday 1st of April 2024 12:55:12 PM CDT,"/**
     * Attacks for the player the targeted entity with the currently equipped item.  The equipped item has hitEntity
     * called on it. Args: targetEntity
     */
    public void attackTargetEntityWithCurrentItem(Entity targetEntity)
    {
        if (targetEntity.canAttackWithItem())
        {
            if (!targetEntity.hitByEntity(this))
            {
                float f = (float)this.getEntityAttribute(SharedMonsterAttributes.attackDamage).getAttributeValue();
                int i = 0;
                float f1 = 0.0F;

                if (targetEntity instanceof EntityLivingBase)
                {
                    f1 = EnchantmentHelper.func_152377_a(this.getHeldItem(), ((EntityLivingBase)targetEntity).getCreatureAttribute());
                }
                else
                {
                    f1 = EnchantmentHelper.func_152377_a(this.getHeldItem(), EnumCreatureAttribute.UNDEFINED);
                }

                i = i + EnchantmentHelper.getKnockbackModifier(this);

                if (this.isSprinting())
                {
                    ++i;
                }

                if (f > 0.0F || f1 > 0.0F)
                {
                    boolean flag = this.fallDistance > 0.0F && !this.onGround && !this.isOnLadder() && !this.isInWater() && !this.isPotionActive(Potion.blindness) && this.ridingEntity == null && targetEntity instanceof EntityLivingBase;

                    if (flag && f > 0.0F)
                    {
                        f *= 1.5F;
                    }

                    f = f + f1;
                    boolean flag1 = false;
                    int j = EnchantmentHelper.getFireAspectModifier(this);

                    if (targetEntity instanceof EntityLivingBase && j > 0 && !targetEntity.isBurning())
                    {
                        flag1 = true;
                        targetEntity.setFire(1);
                    }

                    double d0 = targetEntity.motionX;
                    double d1 = targetEntity.motionY;
                    double d2 = targetEntity.motionZ;
                    boolean flag2 = targetEntity.attackEntityFrom(DamageSource.causePlayerDamage(this), f);

                    if (flag2) {
                        final KnockbackModifierEvent knockbackModifierEvent = new KnockbackModifierEvent(i > 0).publishItself();
                        float yaw = this.rotationYaw;
                        if(this == Minecraft.getMinecraft().thePlayer)
                            yaw = PlayerHandler.yaw;
                        if (knockbackModifierEvent.isFlag()) {
                            targetEntity.addVelocity((double) (-MathHelper.sin(yaw * (float) Math.PI / 180.0F) * (float) i * 0.5F), 0.1D, (double) (MathHelper.cos(yaw * (float) Math.PI / 180.0F) * (float) i * 0.5F));
                            this.motionX *= 0.6D;
                            this.motionZ *= 0.6D;
                            this.setSprinting(false);
                        }
                        if (targetEntity instanceof EntityPlayerMP && targetEntity.velocityChanged)
                        {
                            ((EntityPlayerMP)targetEntity).playerNetServerHandler.sendPacket(new S12PacketEntityVelocity(targetEntity));
                            targetEntity.velocityChanged = false;
                            targetEntity.motionX = d0;
                            targetEntity.motionY = d1;
                            targetEntity.motionZ = d2;
                        }

                        if (flag)
                        {
                            this.onCriticalHit(targetEntity);
                        }

                        if (f1 > 0.0F)
                        {
                            this.onEnchantmentCritical(targetEntity);
                        }

                        if (f >= 18.0F)
                        {
                            this.triggerAchievement(AchievementList.overkill);
                        }

                        this.setLastAttacker(targetEntity);

                        if (targetEntity instanceof EntityLivingBase)
                        {
                            EnchantmentHelper.applyThornEnchantments((EntityLivingBase)targetEntity, this);
                        }

                        EnchantmentHelper.applyArthropodEnchantments(this, targetEntity);
                        ItemStack itemstack = this.getCurrentEquippedItem();
                        Entity entity = targetEntity;

                        if (targetEntity instanceof EntityDragonPart)
                        {
                            IEntityMultiPart ientitymultipart = ((EntityDragonPart)targetEntity).entityDragonObj;

                            if (ientitymultipart instanceof EntityLivingBase)
                            {
                                entity = (EntityLivingBase)ientitymultipart;
                            }
                        }

                        if (itemstack != null && entity instanceof EntityLivingBase)
                        {
                            itemstack.hitEntity((EntityLivingBase)entity, this);

                            if (itemstack.stackSize <= 0)
                            {
                                this.destroyCurrentEquippedItem();
                            }
                        }

                        if (targetEntity instanceof EntityLivingBase)
                        {
                            this.addStat(StatList.damageDealtStat, Math.round(f * 10.0F));

                            if (j > 0)
                            {
                                targetEntity.setFire(j * 4);
                            }
                        }

                        this.addExhaustion(0.3F);
                    }
                    else if (flag1)
                    {
                        targetEntity.extinguish();
                    }
                }
            }
        }
    }"
FYwsJVfw,dropItem,GamingLVScripts,Java,Monday 1st of April 2024 12:54:11 PM CDT,"public EntityItem dropItem(ItemStack droppedItem, boolean dropAround, boolean traceItem)
    {
        if (droppedItem == null)
        {
            return null;
        }
        else if (droppedItem.stackSize == 0)
        {
            return null;
        }
        else
        {
            double d0 = this.posY - 0.30000001192092896D + (double)this.getEyeHeight();
            EntityItem entityitem = new EntityItem(this.worldObj, this.posX, d0, this.posZ, droppedItem);
            entityitem.setPickupDelay(40);

            if (traceItem)
            {
                entityitem.setThrower(this.getCommandSenderName());
            }

            if (dropAround)
            {
                float f = this.rand.nextFloat() * 0.5F;
                float f1 = this.rand.nextFloat() * (float)Math.PI * 2.0F;
                entityitem.motionX = (double)(-MathHelper.sin(f1) * f);
                entityitem.motionZ = (double)(MathHelper.cos(f1) * f);
                entityitem.motionY = 0.20000000298023224D;
            }
            else
            {
                float f2 = 0.3F;
                float yaw = this.rotationYaw;
                float pitch = this.rotationYaw;
                if(this == Minecraft.getMinecraft().thePlayer) {
                    yaw = PlayerHandler.yaw;
                    pitch = PlayerHandler.pitch;
                }
                entityitem.motionX = (double) (-MathHelper.sin(yaw / 180.0F * (float) Math.PI) * MathHelper.cos(pitch / 180.0F * (float) Math.PI) * f2);
                entityitem.motionZ = (double) (MathHelper.cos(yaw / 180.0F * (float) Math.PI) * MathHelper.cos(pitch / 180.0F * (float) Math.PI) * f2);
                entityitem.motionY = (double) (-MathHelper.sin(pitch / 180.0F * (float) Math.PI) * f2 + 0.1F);
                float f3 = this.rand.nextFloat() * (float) Math.PI * 2.0F;
                f2 = 0.02F * this.rand.nextFloat();
                entityitem.motionX += Math.cos((double) f3) * (double) f2;
                entityitem.motionY += (double) ((this.rand.nextFloat() - this.rand.nextFloat()) * 0.1F);
                entityitem.motionZ += Math.sin((double) f3) * (double) f2;
            }

            this.joinEntityItemWithWorld(entityitem);

            if (traceItem)
            {
                this.triggerAchievement(StatList.dropStat);
            }

            return entityitem;
        }
    }"
BXafK1SN,updateRidden,GamingLVScripts,Java,Monday 1st of April 2024 12:53:24 PM CDT,"/**
     * Handles updating while being ridden by an entity
     */
    public void updateRidden() {
        if (!this.worldObj.isRemote && this.isSneaking()) {
            this.mountEntity((Entity) null);
            this.setSneaking(false);
        } else {
            double d0 = this.posX;
            double d1 = this.posY;
            double d2 = this.posZ;
            float yaw = this.rotationYaw;
            float pitch = this.rotationPitch;
            if(this == Minecraft.getMinecraft().thePlayer) {
                yaw = PlayerHandler.yaw;
                pitch = PlayerHandler.pitch;
            }
            float f = yaw;
            float f1 = pitch;
            super.updateRidden();
            this.prevCameraYaw = this.cameraYaw;
            this.cameraYaw = 0.0F;
            this.addMountedMovementStat(this.posX - d0, this.posY - d1, this.posZ - d2);

            if (this.ridingEntity instanceof EntityPig) {
                this.rotationPitch = f1;
                this.rotationYaw = f;
                if(this == Minecraft.getMinecraft().thePlayer) {
                    PlayerHandler.yaw = f;
                    PlayerHandler.pitch = f1;
                }
                this.renderYawOffset = ((EntityPig) this.ridingEntity).renderYawOffset;
            }
        }
    }"
xSVie0j7,RDGBDNYDNYNY,gadungw71,PHP,Monday 1st of April 2024 12:52:42 PM CDT,"•	https://github.com/Godzilla-y-Kong-El-nuevo-imperio-2024-N
•	https://github.com/3-Godzilla-y-Kong-El-nuevo-imperio-2024
•	https://github.com/VER-Godzilla-y-Kong-2-La-Pelicula
•	https://github.com/PELISPLUS-VER-Godzilla-y-Kong-2-2024-N
•	https://www.artstation.com/artwork/Ry2ydy
•	https://www.artstation.com/pelispusvergodzilaykong2online/profile
•	https://www.artstation.com/artwork/4909Q8
•	https://www.artstation.com/cuevana3gratisgodzillaykongelnuevoimperio2024/profile
•	https://www.artstation.com/artwork/obDbVJ
•	https://www.artstation.com/watchexhuma2024hdthaisub4/profile
•	https://www.artstation.com/artwork/obDb5B
•	https://www.artstation.com/exhuma20241080p4/profile
•	https://www.enablesurvey.com/r/V7DrVEw
•	https://www.enablesurvey.com/r/ygJOCD8
•	https://bento.me/vergodzilaykong2
•	https://bento.me/pelispusvergodzilaykong2peliculacompleta
•	https://github.com/Xem-phim-Qu-C-u-2024-FULL-HD-Online
•	https://www.artstation.com/artwork/BXbXrA
•	https://www.artstation.com/quycau2023fullhdvietsub7/profile
•	https://wandering.flarum.cloud/d/52722-aulama
•	https://hiuderyy.hashnode.dev/sasukamoo
•	https://click4r.com/posts/g/16157998/asulamaaa
•	https://medium.com/@across-the-furious-sea-hd-1080/hoorasaa-12fe6ec7a5b7
•	https://open.firstory.me/story/cluh7oju00ryk01x7e1exgta0
•	https://forum.mush.com.br/topic/208711/kucobamerayu
•	https://www.onfeetnation.com/profiles/blogs/vdsebestndry
•	https://demo.hedgedoc.org/s/CWe9_MOBm
•	https://rentry.co/ogaheyev
•	https://paste.ee/p/xYew8
•	https://yamcode.com/dsfsegse-8
•	https://start.me/w/jMdONQ
•	https://telegra.ph/DGESHGSE-04-01
•	https://muckrack.com/lendot-roopwx/bio
•	https://www.kooapp.com/koo/guest_P68S8O/cb345107-b57e-4d46-a375-ed8aa58c2514
•	https://www.kooapp.com/koo/guest_5AA9GO/b88060a8-05ad-40a6-a08f-84a0f71905f2
•	http://aldenfamilydentistry.com/UserProfile/tabid/57/userId/721483/Default.aspx
•	https://profile.hatena.ne.jp/scesvrvbt/
•	https://www.fitlynk.com/1711993862F935932
"
UBQD5uVh,onUpdate,GamingLVScripts,Java,Monday 1st of April 2024 12:50:50 PM CDT,"/**
     * Called to update the entity's position/logic.
     */
    public void onUpdate()
    {
        super.onUpdate();

        if (!this.worldObj.isRemote)
        {
            int i = this.getArrowCountInEntity();

            if (i > 0)
            {
                if (this.arrowHitTimer <= 0)
                {
                    this.arrowHitTimer = 20 * (30 - i);
                }

                --this.arrowHitTimer;

                if (this.arrowHitTimer <= 0)
                {
                    this.setArrowCountInEntity(i - 1);
                }
            }

            for (int j = 0; j < 5; ++j)
            {
                ItemStack itemstack = this.previousEquipment[j];
                ItemStack itemstack1 = this.getEquipmentInSlot(j);

                if (!ItemStack.areItemStacksEqual(itemstack1, itemstack))
                {
                    ((WorldServer)this.worldObj).getEntityTracker().sendToAllTrackingEntity(this, new S04PacketEntityEquipment(this.getEntityId(), j, itemstack1));

                    if (itemstack != null)
                    {
                        this.attributeMap.removeAttributeModifiers(itemstack.getAttributeModifiers());
                    }

                    if (itemstack1 != null)
                    {
                        this.attributeMap.applyAttributeModifiers(itemstack1.getAttributeModifiers());
                    }

                    this.previousEquipment[j] = itemstack1 == null ? null : itemstack1.copy();
                }
            }

            if (this.ticksExisted % 20 == 0)
            {
                this.getCombatTracker().reset();
            }
        }

        this.onLivingUpdate();
        double deltaX = this.posX - this.prevPosX;
        double deltaZ = this.posZ - this.prevPosZ;
        float distance = (float) (deltaX * deltaX + deltaZ * deltaZ);
        float yawHead = rotationYawHead;
        if(this == Minecraft.getMinecraft().thePlayer)
            yawHead = PlayerHandler.yaw;
        float offset = renderYawOffset;

        float f2 = 0.0F;
        this.prevOnGroundSpeedFactor = this.onGroundSpeedFactor;
        float f3 = 0.0F;

        if (distance > 0.0025000002F)
            offset = (float) MathHelper.func_181159_b(deltaZ, deltaX) * 180.0F / (float) Math.PI - 90.0F;

        if (this.swingProgress > 0.0F)
            offset = yawHead;

        if (!this.onGround) {
            f3 = 0.0F;
        }

        this.onGroundSpeedFactor += (f3 - this.onGroundSpeedFactor) * 0.3F;
        this.worldObj.theProfiler.startSection(""headTurn"");
        f2 = this.func_110146_f(offset, f2);
        this.worldObj.theProfiler.endSection();
        this.worldObj.theProfiler.startSection(""rangeChecks"");

        while (this.rotationYaw - this.prevRotationYaw < -180.0F) {
            this.prevRotationYaw -= 360.0F;
        }

        while (this.rotationYaw - this.prevRotationYaw >= 180.0F) {
            this.prevRotationYaw += 360.0F;
        }

        while (this.renderYawOffset - this.prevRenderYawOffset < -180.0F) {
            this.prevRenderYawOffset -= 360.0F;
        }

        while (this.renderYawOffset - this.prevRenderYawOffset >= 180.0F) {
            this.prevRenderYawOffset += 360.0F;
        }

        while (this.rotationPitch - this.prevRotationPitch < -180.0F) {
            this.prevRotationPitch -= 360.0F;
        }

        while (this.rotationPitch - this.prevRotationPitch >= 180.0F) {
            this.prevRotationPitch += 360.0F;
        }

        while (this.rotationYawHead - this.prevRotationYawHead < -180.0F) {
            this.prevRotationYawHead -= 360.0F;
        }

        while (this.rotationYawHead - this.prevRotationYawHead >= 180.0F) {
            this.prevRotationYawHead += 360.0F;
        }

        this.worldObj.theProfiler.endSection();
        this.movedDistance += f2;
    }"
Cg5RfL13,onEntityUpdate,GamingLVScripts,Java,Monday 1st of April 2024 12:49:59 PM CDT,"/**
     * Gets called every tick from main Entity class
     */
    public void onEntityUpdate()
    {
        this.prevSwingProgress = this.swingProgress;
        super.onEntityUpdate();
        this.worldObj.theProfiler.startSection(""livingEntityBaseTick"");
        boolean flag = this instanceof EntityPlayer;

        if (this.isEntityAlive())
        {
            if (this.isEntityInsideOpaqueBlock())
            {
                this.attackEntityFrom(DamageSource.inWall, 1.0F);
            }
            else if (flag && !this.worldObj.getWorldBorder().contains(this.getEntityBoundingBox()))
            {
                double d0 = this.worldObj.getWorldBorder().getClosestDistance(this) + this.worldObj.getWorldBorder().getDamageBuffer();

                if (d0 < 0.0D)
                {
                    this.attackEntityFrom(DamageSource.inWall, (float)Math.max(1, MathHelper.floor_double(-d0 * this.worldObj.getWorldBorder().getDamageAmount())));
                }
            }
        }

        if (this.isImmuneToFire() || this.worldObj.isRemote)
        {
            this.extinguish();
        }

        boolean flag1 = flag && ((EntityPlayer)this).capabilities.disableDamage;

        if (this.isEntityAlive())
        {
            if (this.isInsideOfMaterial(Material.water))
            {
                if (!this.canBreatheUnderwater() && !this.isPotionActive(Potion.waterBreathing.id) && !flag1)
                {
                    this.setAir(this.decreaseAirSupply(this.getAir()));

                    if (this.getAir() == -20)
                    {
                        this.setAir(0);

                        for (int i = 0; i < 8; ++i)
                        {
                            float f = this.rand.nextFloat() - this.rand.nextFloat();
                            float f1 = this.rand.nextFloat() - this.rand.nextFloat();
                            float f2 = this.rand.nextFloat() - this.rand.nextFloat();
                            this.worldObj.spawnParticle(EnumParticleTypes.WATER_BUBBLE, this.posX + (double)f, this.posY + (double)f1, this.posZ + (double)f2, this.motionX, this.motionY, this.motionZ, new int[0]);
                        }

                        this.attackEntityFrom(DamageSource.drown, 2.0F);
                    }
                }

                if (!this.worldObj.isRemote && this.isRiding() && this.ridingEntity instanceof EntityLivingBase)
                {
                    this.mountEntity((Entity)null);
                }
            }
            else
            {
                this.setAir(300);
            }
        }

        if (this.isEntityAlive() && this.isWet())
        {
            this.extinguish();
        }

        this.prevCameraPitch = this.cameraPitch;

        if (this.hurtTime > 0)
        {
            --this.hurtTime;
        }

        if (this.hurtResistantTime > 0 && !(this instanceof EntityPlayerMP))
        {
            --this.hurtResistantTime;
        }

        if (this.getHealth() <= 0.0F)
        {
            this.onDeathUpdate();
        }

        if (this.recentlyHit > 0)
        {
            --this.recentlyHit;
        }
        else
        {
            this.attackingPlayer = null;
        }

        if (this.lastAttacker != null && !this.lastAttacker.isEntityAlive())
        {
            this.lastAttacker = null;
        }

        if (this.entityLivingToAttack != null)
        {
            if (!this.entityLivingToAttack.isEntityAlive())
            {
                this.setRevengeTarget((EntityLivingBase)null);
            }
            else if (this.ticksExisted - this.revengeTimer > 100)
            {
                this.setRevengeTarget((EntityLivingBase)null);
            }
        }

        this.updatePotionEffects();
        this.prevMovedDistance = this.movedDistance;
        this.prevRenderYawOffset = this.renderYawOffset;
        this.prevRotationYawHead = this.rotationYawHead;
        this.prevRotationYaw = this.rotationYaw;
        this.prevRotationPitch = this.rotationPitch;
        if(this == Minecraft.getMinecraft().thePlayer) {
            this.prevRotationYawHead = PlayerHandler.yaw;
            PlayerHandler.prevPitch = PlayerHandler.pitch;
        }
        this.worldObj.theProfiler.endSection();
    }"
H9708QbX,Auto map builder for RS,WarPie90,Delphi,Monday 1st of April 2024 12:49:52 PM CDT,"program MinimapCapture;
{$I SRL-T/osr.simba}
(*
  Simple program to capture the minimap at 400x400 from the memory of RS.
  Requires: https://github.com/slackydev/Simba-MemScan/releases/tag/1.1

  Download the plugin (dll) named `memscan32`, add it to your ""Plugins"" folder in Simba

  Start RS, target RS, start the script
*)
{$loadlib memscan32.dll}

// all you have to do is to run around and have runescape load new world regions
// while tihs tool puzzles together each new region to build a single map.
//
// Sometimes a build can take a minute, but usually within seconds.
// Just dont try to go to fast, step back if it gets stuck, maybe log in and out
// while it's running in such a case (this will generate a new region).

const
  PATH = 'C:\Simba\Includes\Test.png';  //change it to where u wanna save
  LOAD_MAP = TRUE;
  REBUILD_TIMER = 15000;   {rebuild world map every}
  BACKUP_TIMER  = 5*60000; {save a .bak world map every}



type
  PInt32 = ^Int32;

var
  mem: TMemScan;

const
  _512: array of Int64 = [0,0,0,0,0,0,0,0];

function BytesToTIA(data:TByteArray): TIntegerArray;
begin
  SetLength(result, length(data) div 4);
  MemMove(data[0], result[0], Length(data));
end;

function ValidMapAddr(address:PtrUInt): Boolean;
var
  data:Int32;
  tmp: TByteArray;
begin
  data := PInt32(mem.CopyMem(address+8,4))^;
  if (data = 512 * 512) then
  begin
    tmp := mem.CopyMem(address+12, 64);
    Result := CompareMem(_512[0], tmp[0], 64); //row of black
  end;
end;

function GetMemBufferImage(scan:TMemScan; loc:PtrUInt; W,H:Int32): TMufasaBitmap;
var
  data:TByteArray;
  ptr: PRGB32;
begin
  data := scan.CopyMem(loc, W*H*SizeOf(TRGB32));
  Result.Init();
  Result.SetSize(W,H);
  ptr := Result.getData();
  MemMove(data[0], ptr^, Length(data));
end;

function GetMap(): TMufasaBitmap;
var
  res: TPtrIntArray;
  ptr: PtrUInt;
  raw: TByteArray;
  i,c: Int32;
  ints: TIntegerArray;
begin
  res := mem.FindInt32(512, 1);

  Result := nil;
  for ptr in res do
  begin
    c   := 0;
    raw := mem.CopyMem(ptr, 48);

    for i:=0 to 44 with 4 do
      if PInt32(raw+i)^ = 512 then Inc(c);

    if c >= 4 then
    begin
      ints := BytesToTIA(raw);
      for i in ints do
        if (i > $FFF) and ValidMapAddr(i) then begin
          Result := GetMemBufferImage(mem, i+12, 512, 512);
          break;
        end;
    end;
  end;
  Result.SetList(client.GetMBitmaps);
  client.GetMBitmaps.AddBMP(Result);
end;



var
  ResMap: TMufasaBitmap;
  LastSaveT, LastBackT: Int64;

procedure TMufasaBitmap.DrawTo(X,Y: Int32; var Image: TMufasaBitmap);
var
  tmp: TMufasaBitmap;
  x1,y1,W,H: Int32;
  xx,yy,R1,G1,B1,R2,G2,B2: Int32;
begin
  tmp.Init(client.GetMBitmaps);

  W := Max(Image.GetWidth  + Abs(Min(0,X)), Self.GetWidth()  + X);
  H := Max(Image.GetHeight + Abs(Min(0,Y)), Self.GetHeight() + Y);

  tmp.SetSize(W,H);
  Image.DrawTransparent(Abs(Min(X,0)), Abs(Min(Y,0)), tmp);

  // Self.DrawTransparent(Max(0, X), Max(0, Y), tmp);
  begin // smoother draw instead
    x1 := Max(0, X); y1 := Max(0, Y);
    for yy:=0 to Self.GetHeight-1 do
      for xx:=0 to Self.GetWidth-1 do
      begin
        ColorToRGB(tmp.GetPixel(x1+xx, y1+yy), R1,G1,B1);
        if (R1=0) and (G1=0) and (B1=0) then
          tmp.SetPixel(x1+xx, y1+yy, Self.GetPixel(xx,yy))
        else
        begin
          ColorToRGB(Self.GetPixel(xx,yy), R2,G2,B2);
          tmp.SetPixel(x1+xx, y1+yy, RGBtoColor((R1*3+R2) div 4, (G1*3+G2) div 4, (B1*3+B2) div 4));
        end;
      end;
  end;
  Image.Free();
  Image := tmp;
end;

function AddPiece(Piece: TMufasaBitmap): Boolean;

  function AssertValidMatch(World, Piece: TMufasaBitmap; pt: TPoint; Tol:Int32; Match:Double): Boolean;
  var
    x,y,W,H,WorldW,WorldH,color,count,SAD:Int32;
    c1,c2:TRGB32;
  begin
    GetBitmapSize(Piece.GetIndex, W,H);
    GetBitmapSize(World.GetIndex, WorldW, WorldH);

    WriteLn('>>> Validating location');
    SAD := 0;
    for y:=0 to H-1 do
      for x:=0 to W-1 do
      begin
        if ((x+pt.x >= 0) and (y+pt.y >= 0)) and ((x+pt.x < WorldW) and (y+pt.y < WorldH)) then
        begin
          color := World.GetPixel(x+pt.x,y+pt.y);
          if color = 0 then continue;
          c1 := TRGB32(color);
          c2 := TRGB32(Piece.GetPixel(x,y));
          if (Abs(c1.R-c2.R) < Tol) and
             (Abs(c1.G-c2.G) < Tol) and
             (Abs(c1.B-c2.B) < Tol) then
            Inc(SAD);
          Inc(count);
        end;
      end;
    Result := SAD / Max(1,count) >= Match;
    if Result then
      WriteLn('>>> Validated location (',pt.x, ', ',pt.y,')')
    else
      WriteLn('>>> Invalid location (',pt.x, ', ',pt.y,') -> ', SAD / Max(1,count))

    //WriteLn(SAD / Max(1,count), ' at ', pt,', sz = ', [WorldW, WorldH]);
  end;

  function Find(Sub, Map: TMufasaBitmap; out PT: TPoint): Boolean;
  var
    x,y,W,H: Int32;
    OldTarget, NewTarget: NativeInt;
    TL,BL,TR,BR: TMufasaBitmap;
  begin
    OldTarget := GetImageTarget;
    NewTarget := SetTargetBitmap(Map.GetIndex());

    W := Sub.GetWidth();
    H := Sub.GetHeight();

    TL := Sub.Copy(0,     0,     130, 130); TL.SetList(client.GetMBitmaps); client.GetMBitmaps.AddBMP(TL);
    TR := Sub.Copy(W-131, 0,     W-1, 130); TR.SetList(client.GetMBitmaps); client.GetMBitmaps.AddBMP(TR);
    BL := Sub.Copy(0,     H-131, 130, H-1); BL.SetList(client.GetMBitmaps); client.GetMBitmaps.AddBMP(BL);
    BR := Sub.Copy(W-131, H-131, W-1, H-1); BR.SetList(client.GetMBitmaps); client.GetMBitmaps.AddBMP(BR);

    if (not Result) then
    begin
      WriteLn('>>> Searching for fitting location [1]');
      if (Result := FindBitmapToleranceIn(TL.GetIndex(), x,y, [0,0,Map.GetWidth()-1, Map.GetHeight()-1], 50)) then
        PT := [x,y];
      Result := AssertValidMatch(Map, Sub, PT, 55, 0.999);
    end;

    if (not Result) then
    begin
      WriteLn('>>> Searching for fitting location [2]');
      if (Result := FindBitmapToleranceIn(TR.GetIndex(), x,y, [0,0,Map.GetWidth()-1, Map.GetHeight()-1], 50)) then
        PT := [x-(W-131), y];
      Result := AssertValidMatch(Map, Sub, PT, 55, 0.999)
    end;

    if (not Result) then
    begin
      WriteLn('>>> Searching for fitting location [3]');
      if (Result := FindBitmapToleranceIn(BL.GetIndex(), x,y, [0,0,Map.GetWidth()-1, Map.GetHeight()-1], 50)) then
        PT := [x, y-(H-131)];
      Result := AssertValidMatch(Map, Sub, PT, 55, 0.999)
    end;

    if (not Result) then
    begin
      WriteLn('>>> Searching for fitting location [4]');
      if (Result := FindBitmapToleranceIn(BR.GetIndex(), x,y, [0,0,Map.GetWidth()-1, Map.GetHeight()-1], 50)) then
        PT := [x-(W-131), y-(H-131)];
      Result := AssertValidMatch(Map, Sub, PT, 55, 0.999)
    end;

    TL.Free();
    TR.Free();
    BL.Free();
    BR.Free();
    FreeTarget(NewTarget);
    SetImageTarget(OldTarget);
  end;

var
  pt: TPoint;
begin
  if ResMap = nil then
  begin
    ResMap.Init(client.GetMBitmaps);
    Piece.DrawTo(0,0,ResMap);
    Exit(True);
  end;

  if Find(Piece, ResMap, PT) then
  begin
    Piece.DrawTo(pt.x,pt.y, ResMap);
    Result := True;
    if (GetTickCount()-LastSaveT > REBUILD_TIMER) then
    begin
      ResMap.SaveToFile(PATH);
      LastSaveT := GetTickCount();
    end;

    if (GetTickCount()-LastBackT > BACKUP_TIMER) then
    begin
      ResMap.SaveToFile(PATH+'.bak.png');
      LastBackT := GetTickCount();
    end;
  end else
  begin
    WriteLn('Warning: Failed to add piece, please walk back');
    Wait(5000);
  end;

  ResMap.Debug();
end;


var
  bmp, tmp, prev: TMufasaBitmap;
  t: Double;

procedure OnTerminate();
begin
  ResMap.SaveToFile(PATH);
  ResMap.Free();
  prev.Free();
end;

begin
  mem.Init(GetTargetPID());
  AddOnTerminate('OnTerminate');

  if (LOAD_MAP) and FileExists(PATH) then
  begin
    ResMap.Init(client.GetMBitmaps);
    ResMap.LoadFromFile(PATH);
  end;

  while True do
  begin
    bmp := GetMap();
    WriteLn(bmp.GetIndex(),', ',[bmp.GetWidth(), bmp.GetHeight()]);
    bmp.Crop(65,65, 511-65,511-65);

    if (prev = nil) or (bmp.MatchTemplate(prev, TM_CCORR_NORMED).Max() < 1) then
    begin
      WriteLn('Rebuilding map... Please wait, this might take some time');
      t := PerformanceTimer();
      if AddPiece(bmp) then
      begin
        if (prev <> nil) then prev.Free();
        prev := bmp;
        WriteLn('Map rebuilt in ', PerformanceTimer-t,'ms');
      end else
        BMP.Free();
    end else
      bmp.Free();
  end;
end."
x54tf4Bu,func_181560_a,GamingLVScripts,Java,Monday 1st of April 2024 12:48:57 PM CDT,"public void func_181560_a(float p_181560_1_, long p_181560_2_, float particleTicks)
    {
        Config.renderPartialTicks = p_181560_1_;
        this.frameInit();
        boolean flag = Display.isActive();

        if (!flag && this.mc.gameSettings.pauseOnLostFocus && (!this.mc.gameSettings.touchscreen || !Mouse.isButtonDown(1)))
        {
            if (Minecraft.getSystemTime() - this.prevFrameTime > 500L)
            {
                this.mc.displayInGameMenu();
            }
        }
        else
        {
            this.prevFrameTime = Minecraft.getSystemTime();
        }

        this.mc.mcProfiler.startSection(""mouse"");

        if (flag && Minecraft.isRunningOnMac && this.mc.inGameHasFocus && !Mouse.isInsideWindow())
        {
            Mouse.setGrabbed(false);
            Mouse.setCursorPosition(Display.getWidth() / 2, Display.getHeight() / 2);
            Mouse.setGrabbed(true);
        }


        if (this.mc.inGameHasFocus && flag) {
            if (this.pointedEntity instanceof EntityLivingBase) {
                final EntityLivingBase livingBase = (EntityLivingBase) this.mc.getRenderViewEntity();
                final RendererEvent rendererEvent = new RendererEvent(livingBase.rotationYaw, livingBase.rotationPitch).publishItself();
            }

            this.mc.mouseHelper.mouseXYChange();
            float f = this.mc.gameSettings.mouseSensitivity * 0.6F + 0.2F;
            float f1 = f * f * f * 8.0F;
            float f2 = (float) this.mc.mouseHelper.deltaX * f1;
            float f3 = (float) this.mc.mouseHelper.deltaY * f1;
            int i = 1;

            if (this.mc.gameSettings.invertMouse) {
                i = -1;
            }

            final EntityRendererEvent entityRendererEvent = new EntityRendererEvent(this.mc.thePlayer).publishItself();
            if (entityRendererEvent.getEntity() != null)
                if (this.mc.gameSettings.smoothCamera) {
                    this.smoothCamYaw += f2;
                    this.smoothCamPitch += f3;
                    float f4 = p_181560_1_ - this.smoothCamPartialTicks;
                    this.smoothCamPartialTicks = p_181560_1_;
                    f2 = this.smoothCamFilterX * f4;
                    f3 = this.smoothCamFilterY * f4;
                    entityRendererEvent.getEntity().setAngles(f2, f3 * (float) i);
                } else {
                    this.smoothCamYaw = 0.0F;
                    this.smoothCamPitch = 0.0F;
                    entityRendererEvent.getEntity().setAngles(f2, f3 * (float) i);
                }
            PlayerHandler.prevYaw = PlayerHandler.yaw;
            PlayerHandler.prevPitch = PlayerHandler.pitch;
            final RotationEvent rotationEvent = new RotationEvent(entityRendererEvent.getEntity().rotationYaw, entityRendererEvent.getEntity().rotationPitch).publishItself();
            PlayerHandler.yaw = rotationEvent.getYaw();
            PlayerHandler.pitch = rotationEvent.getPitch();
        }

        this.mc.mcProfiler.endSection();

        if (!this.mc.skipRenderWorld)
        {
            anaglyphEnable = this.mc.gameSettings.anaglyph;
            final ScaledResolution scaledresolution = new ScaledResolution(this.mc);
            int i1 = scaledresolution.getScaledWidth();
            int j1 = scaledresolution.getScaledHeight();
            final int k1 = Mouse.getX() * i1 / this.mc.displayWidth;
            final int l1 = j1 - Mouse.getY() * j1 / this.mc.displayHeight - 1;
            int i2 = this.mc.gameSettings.limitFramerate;

            if (this.mc.theWorld != null)
            {
                this.mc.mcProfiler.startSection(""level"");
                int j = Math.min(Minecraft.getDebugFPS(), i2);
                j = Math.max(j, 60);
                long k = System.nanoTime() - p_181560_2_;
                long l = Math.max((long)(1000000000 / j / 4) - k, 0L);
                this.renderWorld(p_181560_1_, System.nanoTime() + l, particleTicks);

                if (OpenGlHelper.shadersSupported)
                {
                    this.mc.renderGlobal.renderEntityOutlineFramebuffer();

                    if (this.theShaderGroup != null && this.useShader)
                    {
                        GlStateManager.matrixMode(5890);
                        GlStateManager.pushMatrix();
                        GlStateManager.loadIdentity();
                        this.theShaderGroup.loadShaderGroup(p_181560_1_);
                        GlStateManager.popMatrix();
                    }

                    this.mc.getFramebuffer().bindFramebuffer(true);
                }

                this.renderEndNanoTime = System.nanoTime();
                this.mc.mcProfiler.endStartSection(""gui"");

                if (!this.mc.gameSettings.hideGUI || this.mc.currentScreen != null)
                {
                    GlStateManager.alphaFunc(516, 0.1F);
                    this.mc.ingameGUI.renderGameOverlay(p_181560_1_);

                    if (this.mc.gameSettings.ofShowFps && !this.mc.gameSettings.showDebugInfo)
                    {
                        Config.drawFps();
                    }

                    if (this.mc.gameSettings.showDebugInfo)
                    {
                        Lagometer.showLagometer(scaledresolution);
                    }
                }

                this.mc.mcProfiler.endSection();
            }
            else
            {
                GlStateManager.viewport(0, 0, this.mc.displayWidth, this.mc.displayHeight);
                GlStateManager.matrixMode(5889);
                GlStateManager.loadIdentity();
                GlStateManager.matrixMode(5888);
                GlStateManager.loadIdentity();
                this.setupOverlayRendering();
                this.renderEndNanoTime = System.nanoTime();
                TileEntityRendererDispatcher.instance.renderEngine = this.mc.getTextureManager();
                TileEntityRendererDispatcher.instance.fontRenderer = this.mc.fontRendererObj;
            }

            if (this.mc.currentScreen != null)
            {
                GlStateManager.clear(256);

                try
                {
                    if (Reflector.ForgeHooksClient_drawScreen.exists())
                    {
                        Reflector.callVoid(Reflector.ForgeHooksClient_drawScreen, new Object[] {this.mc.currentScreen, Integer.valueOf(k1), Integer.valueOf(l1), Float.valueOf(p_181560_1_)});
                    }
                    else
                    {
                        this.mc.currentScreen.drawScreen(k1, l1, p_181560_1_);
                    }
                }
                catch (Throwable throwable)
                {
                    CrashReport crashreport = CrashReport.makeCrashReport(throwable, ""Rendering screen"");
                    CrashReportCategory crashreportcategory = crashreport.makeCategory(""Screen render details"");
                    crashreportcategory.addCrashSectionCallable(""Screen name"", new Callable<String>()
                    {
                        public String call() throws Exception
                        {
                            return EntityRenderer.this.mc.currentScreen.getClass().getCanonicalName();
                        }
                    });
                    crashreportcategory.addCrashSectionCallable(""Mouse location"", new Callable<String>()
                    {
                        public String call() throws Exception
                        {
                            return String.format(""Scaled: (%d, %d). Absolute: (%d, %d)"", new Object[] {Integer.valueOf(k1), Integer.valueOf(l1), Integer.valueOf(Mouse.getX()), Integer.valueOf(Mouse.getY())});
                        }
                    });
                    crashreportcategory.addCrashSectionCallable(""Screen size"", new Callable<String>()
                    {
                        public String call() throws Exception
                        {
                            return String.format(""Scaled: (%d, %d). Absolute: (%d, %d). Scale factor of %d"", new Object[] {Integer.valueOf(scaledresolution.getScaledWidth()), Integer.valueOf(scaledresolution.getScaledHeight()), Integer.valueOf(EntityRenderer.this.mc.displayWidth), Integer.valueOf(EntityRenderer.this.mc.displayHeight), Integer.valueOf(scaledresolution.getScaleFactor())});
                        }
                    });
                    throw new ReportedException(crashreport);
                }
            }
        }

        this.frameFinish();
        this.waitForServerThread();
        Lagometer.updateLagometer();

        if (this.mc.gameSettings.ofProfiler)
        {
            this.mc.gameSettings.showDebugProfilerChart = true;
        }
    }"
jkDsrddG,doRender,GamingLVScripts,Java,Monday 1st of April 2024 12:48:00 PM CDT,"/**
     * Actually renders the given argument. This is a synthetic bridge method, always casting down its argument and then
     * handing it off to a worker function which does the actual work. In all probabilty, the class Render is generic
     * (Render<T extends Entity>) and this method has signature public void doRender(T entity, double d, double d1,
     * double d2, float f, float f1). But JAD is pre 1.5 so doe
     *  
     * @param entityYaw The yaw rotation of the passed entity
     */
    public void doRender(T entity, double x, double y, double z, float entityYaw, float partialTicks)
    {
        if (!Reflector.RenderLivingEvent_Pre_Constructor.exists() || !Reflector.postForgeBusEvent(Reflector.RenderLivingEvent_Pre_Constructor, new Object[] {entity, this, Double.valueOf(x), Double.valueOf(y), Double.valueOf(z)}))
        {
            if (animateModelLiving)
            {
                entity.limbSwingAmount = 1.0F;
            }

            GlStateManager.pushMatrix();
            GlStateManager.disableCull();
            this.mainModel.swingProgress = this.getSwingProgress(entity, partialTicks);
            this.mainModel.isRiding = entity.isRiding();

            if (Reflector.ForgeEntity_shouldRiderSit.exists())
            {
                this.mainModel.isRiding = entity.isRiding() && entity.ridingEntity != null && Reflector.callBoolean(entity.ridingEntity, Reflector.ForgeEntity_shouldRiderSit, new Object[0]);
            }

            this.mainModel.isChild = entity.isChild();

            try
            {
                float yaw = entity.rotationYawHead;
                if(entity == Minecraft.getMinecraft().thePlayer) {
                    yaw = PlayerHandler.yaw;
                }
                float f = this.interpolateRotation(entity.prevRenderYawOffset, entity.renderYawOffset, partialTicks);
                float f1 = this.interpolateRotation(entity.prevRotationYawHead, yaw, partialTicks);
                float f2 = f1 - f;

                if (this.mainModel.isRiding && entity.ridingEntity instanceof EntityLivingBase)
                {
                    EntityLivingBase entitylivingbase = (EntityLivingBase)entity.ridingEntity;
                    f = this.interpolateRotation(entitylivingbase.prevRenderYawOffset, entitylivingbase.renderYawOffset, partialTicks);
                    f2 = f1 - f;
                    float f3 = MathHelper.wrapAngleTo180_float(f2);

                    if (f3 < -85.0F)
                    {
                        f3 = -85.0F;
                    }

                    if (f3 >= 85.0F)
                    {
                        f3 = 85.0F;
                    }

                    f = f1 - f3;

                    if (f3 * f3 > 2500.0F)
                    {
                        f += f3 * 0.2F;
                    }

                    f2 = f1 - f;
                }

                float f7 = entity.prevRotationPitch + (entity.rotationPitch - entity.prevRotationPitch) * partialTicks;
                this.renderLivingAt(entity, x, y, z);
                float f8 = this.handleRotationFloat(entity, partialTicks);
                if (entity == Minecraft.getMinecraft().thePlayer)
                    f7 = PlayerHandler.prevPitch + (PlayerHandler.pitch - PlayerHandler.prevPitch) * partialTicks;
                this.rotateCorpse(entity, f8, f, partialTicks);
                GlStateManager.enableRescaleNormal();
                GlStateManager.scale(-1.0F, -1.0F, 1.0F);
                this.preRenderCallback(entity, partialTicks);
                float f4 = 0.0625F;
                GlStateManager.translate(0.0F, -1.5078125F, 0.0F);
                float f5 = entity.prevLimbSwingAmount + (entity.limbSwingAmount - entity.prevLimbSwingAmount) * partialTicks;
                float f6 = entity.limbSwing - entity.limbSwingAmount * (1.0F - partialTicks);

                if (entity.isChild())
                {
                    f6 *= 3.0F;
                }

                if (f5 > 1.0F)
                {
                    f5 = 1.0F;
                }

                GlStateManager.enableAlpha();
                this.mainModel.setLivingAnimations(entity, f6, f5, partialTicks);
                this.mainModel.setRotationAngles(f6, f5, f8, f2, f7, 0.0625F, entity);

                if (CustomEntityModels.isActive())
                {
                    this.renderEntity = entity;
                    this.renderLimbSwing = f6;
                    this.renderLimbSwingAmount = f5;
                    this.renderAgeInTicks = f8;
                    this.renderHeadYaw = f2;
                    this.renderHeadPitch = f7;
                    this.renderScaleFactor = f4;
                    this.renderPartialTicks = partialTicks;
                }

                if (this.renderOutlines)
                {
                    boolean flag1 = this.setScoreTeamColor(entity);
                    this.renderModel(entity, f6, f5, f8, f2, f7, 0.0625F);

                    if (flag1)
                    {
                        this.unsetScoreTeamColor();
                    }
                }
                else
                {
                    boolean flag = this.setDoRenderBrightness(entity, partialTicks);

                    if (EmissiveTextures.isActive())
                    {
                        EmissiveTextures.beginRender();
                    }

                    if (this.renderModelPushMatrix)
                    {
                        GlStateManager.pushMatrix();
                    }

                    this.renderModel(entity, f6, f5, f8, f2, f7, 0.0625F);

                    if (this.renderModelPushMatrix)
                    {
                        GlStateManager.popMatrix();
                    }

                    if (EmissiveTextures.isActive())
                    {
                        if (EmissiveTextures.hasEmissive())
                        {
                            this.renderModelPushMatrix = true;
                            EmissiveTextures.beginRenderEmissive();
                            GlStateManager.pushMatrix();
                            this.renderModel(entity, f6, f5, f8, f2, f7, f4);
                            GlStateManager.popMatrix();
                            EmissiveTextures.endRenderEmissive();
                        }

                        EmissiveTextures.endRender();
                    }

                    if (flag)
                    {
                        this.unsetBrightness();
                    }

                    GlStateManager.depthMask(true);

                    if (!(entity instanceof EntityPlayer) || !((EntityPlayer)entity).isSpectator())
                    {
                        this.renderLayers(entity, f6, f5, partialTicks, f8, f2, f7, 0.0625F);
                    }
                }

                if (CustomEntityModels.isActive())
                {
                    this.renderEntity = null;
                }

                GlStateManager.disableRescaleNormal();
            }
            catch (Exception exception)
            {
                logger.error((String)""Couldn\'t render entity"", (Throwable)exception);
            }

            GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
            GlStateManager.enableTexture2D();
            GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
            GlStateManager.enableCull();
            GlStateManager.popMatrix();

            if (!this.renderOutlines)
            {
                super.doRender(entity, x, y, z, entityYaw, partialTicks);
            }

            if (Reflector.RenderLivingEvent_Post_Constructor.exists())
            {
                Reflector.postForgeBusEvent(Reflector.RenderLivingEvent_Post_Constructor, new Object[] {entity, this, Double.valueOf(x), Double.valueOf(y), Double.valueOf(z)});
            }
        }
    }"
CHtzQeCN,handlePlayerPosLook,GamingLVScripts,Java,Monday 1st of April 2024 12:47:11 PM CDT,"/**
     * Handles changes in player positioning and rotation such as when travelling to a new dimension, (re)spawning,
     * mounting horses etc. Seems to immediately reply to the server with the clients post-processing perspective on the
     * player positioning
     */
    public void handlePlayerPosLook(S08PacketPlayerPosLook packetIn)
    {
        PacketThreadUtil.checkThreadAndEnqueue(packetIn, this, this.gameController);
        EntityPlayer entityplayer = this.gameController.thePlayer;
        double d0 = packetIn.getX();
        double d1 = packetIn.getY();
        double d2 = packetIn.getZ();
        float f = packetIn.getYaw();
        float f1 = packetIn.getPitch();

        if (packetIn.func_179834_f().contains(S08PacketPlayerPosLook.EnumFlags.X)) {
            d0 += entityplayer.posX;
        } else {
            entityplayer.motionX = 0.0D;
        }

        if (packetIn.func_179834_f().contains(S08PacketPlayerPosLook.EnumFlags.Y)) {
            d1 += entityplayer.posY;
        } else {
            entityplayer.motionY = 0.0D;
        }

        if (packetIn.func_179834_f().contains(S08PacketPlayerPosLook.EnumFlags.Z)) {
            d2 += entityplayer.posZ;
        } else {
            entityplayer.motionZ = 0.0D;
        }

        if (packetIn.func_179834_f().contains(S08PacketPlayerPosLook.EnumFlags.X_ROT)) {
            f1 += PlayerHandler.pitch;
        }

        if (packetIn.func_179834_f().contains(S08PacketPlayerPosLook.EnumFlags.Y_ROT)) {
            f += PlayerHandler.yaw;
        }

        final HeadLookEvent headLookEvent = new HeadLookEvent(f, f1, d0, d1, d2).publishItself();

        final float yaw = f;
        final float pitch = f1;
        if (!headLookEvent.isCancelled())
            entityplayer.setPositionAndRotation(headLookEvent.getX(), headLookEvent.getY(), headLookEvent.getZ(), headLookEvent.getYaw(), headLookEvent.getPitch());
        PlayerHandler.yaw = yaw;
        PlayerHandler.pitch = pitch;
        this.netManager.sendPacket(new C03PacketPlayer.C06PacketPlayerPosLook(entityplayer.posX, entityplayer.getEntityBoundingBox().minY, entityplayer.posZ, yaw, pitch, false));

        if (!this.doneLoadingTerrain) {
            this.gameController.thePlayer.prevPosX = this.gameController.thePlayer.posX;
            this.gameController.thePlayer.prevPosY = this.gameController.thePlayer.posY;
            this.gameController.thePlayer.prevPosZ = this.gameController.thePlayer.posZ;
            this.doneLoadingTerrain = true;
            this.gameController.displayGuiScreen((GuiScreen) null);
        }
    }"
AeNyuDLj,handleEntityTeleport,GamingLVScripts,Java,Monday 1st of April 2024 12:46:34 PM CDT,"/**
     * Updates an entity's position and rotation as specified by the packet
     */
    public void handleEntityTeleport(S18PacketEntityTeleport packetIn)
    {
        PacketThreadUtil.checkThreadAndEnqueue(packetIn, this, this.gameController);
        Entity entity = this.clientWorldController.getEntityByID(packetIn.getEntityId());

        if (entity != null)
        {
            entity.serverPosX = packetIn.getX();
            entity.serverPosY = packetIn.getY();
            entity.serverPosZ = packetIn.getZ();
            double d0 = (double)entity.serverPosX / 32.0D;
            double d1 = (double)entity.serverPosY / 32.0D;
            double d2 = (double)entity.serverPosZ / 32.0D;
            float f = (float)(packetIn.getYaw() * 360) / 256.0F;
            float f1 = (float)(packetIn.getPitch() * 360) / 256.0F;

            if (Math.abs(entity.posX - d0) < 0.03125D && Math.abs(entity.posY - d1) < 0.015625D && Math.abs(entity.posZ - d2) < 0.03125D)
            {
                entity.setPositionAndRotation2(entity.posX, entity.posY, entity.posZ, f, f1, 3, true);
            }
            else
            {
                entity.setPositionAndRotation2(d0, d1, d2, f, f1, 3, true);
            }

            if(entity == Minecraft.getMinecraft().thePlayer) {
                PlayerHandler.yaw = f;
                PlayerHandler.pitch = f1;
            }

            entity.onGround = packetIn.getOnGround();
        }
    }"
iH6FQiiw,drawEntityOnScreen,GamingLVScripts,Java,Monday 1st of April 2024 12:45:50 PM CDT,"   /**
     * Draws the entity to the screen. Args: xPos, yPos, scale, mouseX, mouseY, entityLiving
     */
    public static void drawEntityOnScreen(int posX, int posY, int scale, float mouseX, float mouseY, EntityLivingBase ent)
    {
        GlStateManager.enableDepth();
        GlStateManager.enableColorMaterial();
        GlStateManager.pushMatrix();
        GlStateManager.translate((float)posX, (float)posY, 50.0F);
        GlStateManager.scale((float)(-scale), (float)scale, (float)scale);
        GlStateManager.rotate(180.0F, 0.0F, 0.0F, 1.0F);
        float f = ent.renderYawOffset;
        float f1 = ent.rotationYaw;
        float f2 = ent.rotationPitch;
        float f3 = ent.prevRotationYawHead;
        float f4 = ent.rotationYawHead;

        final float beforeYaw = PlayerHandler.yaw;
        final float beforePitch = PlayerHandler.pitch;
        final float beforePrevPitch = PlayerHandler.prevPitch;

        GlStateManager.rotate(135.0F, 0.0F, 1.0F, 0.0F);
        RenderHelper.enableStandardItemLighting();
        GlStateManager.rotate(-135.0F, 0.0F, 1.0F, 0.0F);
        GlStateManager.rotate(-((float)Math.atan((double)(mouseY / 40.0F))) * 20.0F, 1.0F, 0.0F, 0.0F);
        ent.renderYawOffset = (float)Math.atan((double)(mouseX / 40.0F)) * 20.0F;
        ent.rotationYaw = (float)Math.atan((double)(mouseX / 40.0F)) * 40.0F;
        ent.rotationPitch = -((float)Math.atan((double)(mouseY / 40.0F))) * 20.0F;
        ent.rotationYawHead = ent.rotationYaw;
        ent.prevRotationYawHead = ent.rotationYaw;
        if(ent == Minecraft.getMinecraft().thePlayer) {
            PlayerHandler.yaw = ent.rotationYawHead;
            PlayerHandler.pitch = ent.rotationPitch;
            PlayerHandler.prevPitch = ent.prevRotationPitch;
        }
        GlStateManager.translate(0.0F, 0.0F, 0.0F);
        RenderManager rendermanager = Minecraft.getMinecraft().getRenderManager();
        rendermanager.setPlayerViewY(180.0F);
        rendermanager.setRenderShadow(false);
        rendermanager.renderEntityWithPosYaw(ent, 0.0D, 0.0D, 0.0D, 0.0F, 1.0F);
        rendermanager.setRenderShadow(true);
        ent.renderYawOffset = f;
        ent.rotationYaw = f1;
        ent.rotationPitch = f2;
        ent.prevRotationYawHead = f3;
        ent.rotationYawHead = f4;
        if(ent == Minecraft.getMinecraft().thePlayer) {
            PlayerHandler.yaw = beforeYaw;
            PlayerHandler.pitch = beforePitch;
            PlayerHandler.prevPitch = beforePrevPitch;
        }
        GlStateManager.popMatrix();
        RenderHelper.disableStandardItemLighting();
        GlStateManager.disableRescaleNormal();
        GlStateManager.setActiveTexture(OpenGlHelper.lightmapTexUnit);
        GlStateManager.disableTexture2D();
        GlStateManager.setActiveTexture(OpenGlHelper.defaultTexUnit);
    }"
GKYSfk2E,RT%,Dang2006,Lua,Monday 1st of April 2024 12:44:47 PM CDT,"--[[Subscribe to Zaptosis on YouTube for more awesome scripts
Also Subscribe to JN HH Gaming on Youtube
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
███▀▀▀███░░░░░░░░░░░░░░░░░░░██░░░░░░░░░░░░░░░░░░░░██░░░░░░░░░
█▀░░░███░░░░░░░░░░░░░░░░░░░░██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
▀░░░███░░▄█▀██▄░▀████████▄██████░░▄██▀██▄░▄██▀██████░░▄██▀███
░░░███░░██░░░██░░░██░░░▀██░░██░░░██▀░░░▀████░░░▀▀░██░░██░░░▀▀
░░███░░░▄▄█████░░░██░░░░██░░██░░░██░░░░░██▀█████▄░██░░▀█████▄
░███░░░▄██░░░██░░░██░░░▄██░░██░░░██▄░░░▄███▄░░░██░██░░█▄░░░██
█████████████▀██▄░██████▀░░░▀████░▀█████▀░██████▀████▄██████▀
░░░░░░░░░░░░░░░░░░██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░▄████▄░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
]]
local find1 = game.Lighting:FindFirstChildWhichIsA(""BloomEffect"") if find1 then
game.Lighting:FindFirstChildWhichIsA(""BloomEffect""):Destroy()
end
local find2 = game.Lighting:FindFirstChildWhichIsA(""SunRaysEffect"") if find2 then
game.Lighting:FindFirstChildWhichIsA(""SunRaysEffect""):Destroy()
end
local find3 = game.Lighting:FindFirstChildWhichIsA(""ColorCorrectionEffect"") if find3 then
game.Lighting:FindFirstChildWhichIsA(""ColorCorrectionEffect""):Destroy()
end
local find4 = game.Lighting:FindFirstChildWhichIsA(""BlurEffect"") if find4 then
game.Lighting:FindFirstChildWhichIsA(""BlurEffect""):Destroy()
end
local find5 = game.Lighting:FindFirstChildWhichIsA(""Sky"") if find5 then
game.Lighting:FindFirstChildWhichIsA(""Sky""):Destroy()
end
local blem = Instance.new(""BloomEffect"",game.Lighting)
local sanrey = Instance.new(""SunRaysEffect"",game.Lighting)
local color = Instance.new(""ColorCorrectionEffect"",game.Lighting)
local blor = Instance.new(""BlurEffect"",game.Lighting)
Instance.new(""Sky"",game.Lighting)
game.Lighting.ExposureCompensation = 0.34
game.Lighting.ShadowSoftness = 1
game.Lighting.EnvironmentDiffuseScale = 0.343
game.Lighting.EnvironmentSpecularScale = 1
game.Lighting.Brightness = 2
game.Lighting.ColorShift_Top = Color3.fromRGB(118,117,108)
game.Lighting.OutdoorAmbient = Color3.fromRGB(141,141,141)
game.Lighting.GeographicLatitude = 100
game.Lighting.Ambient = Color3.fromRGB(112,112,112)
blem.Intensity = 0.5
blem.Size = 22
blem.Threshold = 1.5
sanrey.Intensity = 0.117
sanrey.Spread = 1
blor.Size = 2
color.Contrast = 0.3
color.Saturation = 0.2
color.TintColor = Color3.fromRGB(255,252,224)"
a9hfJrF0,mySilentStrafe,GamingLVScripts,Java,Monday 1st of April 2024 12:44:47 PM CDT,"public float[] mySilentStrafe(final float strafe, final float forward, final float yaw, final boolean advanced) {
        final Minecraft mc = Minecraft.getMinecraft();
        final float diff = MathHelper.wrapAngleTo180_float(yaw - PlayerHandler.yaw);
        float newForward = 0.0f;
        float newStrafe = 0.0f;
        if (!advanced) {
            if (diff >= 22.5 && diff < 67.5) {
                newStrafe += strafe;
                newForward += forward;
                newStrafe -= forward;
                newForward += strafe;
            }
            else if (diff >= 67.5 && diff < 112.5) {
                newStrafe -= forward;
                newForward += strafe;
            }
            else if (diff >= 112.5 && diff < 157.5) {
                newStrafe -= strafe;
                newForward -= forward;
                newStrafe -= forward;
                newForward += strafe;
            }
            else if (diff >= 157.5 || diff <= -157.5) {
                newStrafe -= strafe;
                newForward -= forward;
            }
            else if (diff > -157.5 && diff <= -112.5) {
                newStrafe -= strafe;
                newForward -= forward;
                newStrafe += forward;
                newForward -= strafe;
            }
            else if (diff > -112.5 && diff <= -67.5) {
                newStrafe += forward;
                newForward -= strafe;
            }
            else if (diff > -67.5 && diff <= -22.5) {
                newStrafe += strafe;
                newForward += forward;
                newStrafe += forward;
                newForward -= strafe;
            }
            else {
                newStrafe += strafe;
                newForward += forward;
            }
            return new float[] { newStrafe, newForward };
        }
        final double[] realMotion = MoveUtil.getMotion(0.22, strafe, forward, mc.thePlayer.rotationYaw);
        final double[] array;
        final double[] realPos = array = new double[] { mc.thePlayer.posX, mc.thePlayer.posZ };
        final int n = 0;
        array[n] += realMotion[0];
        final double[] array2 = realPos;
        final int n2 = 1;
        array2[n2] += realMotion[1];
        final ArrayList<float[]> possibleForwardStrafe = new ArrayList<float[]>();
        int i = 0;
        boolean b = false;
        while (!b) {
            newForward = 0.0f;
            newStrafe = 0.0f;
            if (i == 0) {
                newStrafe += strafe;
                newForward += forward;
                newStrafe -= forward;
                newForward += strafe;
                possibleForwardStrafe.add(new float[] { newForward, newStrafe });
            }
            else if (i == 1) {
                newStrafe -= forward;
                newForward += strafe;
                possibleForwardStrafe.add(new float[] { newForward, newStrafe });
            }
            else if (i == 2) {
                newStrafe -= strafe;
                newForward -= forward;
                newStrafe -= forward;
                newForward += strafe;
                possibleForwardStrafe.add(new float[] { newForward, newStrafe });
            }
            else if (i == 3) {
                newStrafe -= strafe;
                newForward -= forward;
                possibleForwardStrafe.add(new float[] { newForward, newStrafe });
            }
            else if (i == 4) {
                newStrafe -= strafe;
                newForward -= forward;
                newStrafe += forward;
                newForward -= strafe;
                possibleForwardStrafe.add(new float[] { newForward, newStrafe });
            }
            else if (i == 5) {
                newStrafe += forward;
                newForward -= strafe;
                possibleForwardStrafe.add(new float[] { newForward, newStrafe });
            }
            else if (i == 6) {
                newStrafe += strafe;
                newForward += forward;
                newStrafe += forward;
                newForward -= strafe;
                possibleForwardStrafe.add(new float[] { newForward, newStrafe });
            }
            else {
                newStrafe += strafe;
                newForward += forward;
                possibleForwardStrafe.add(new float[] { newForward, newStrafe });
                b = true;
            }
            ++i;
        }
        double distance = 5000.0;
        float[] floats = new float[2];
        for (final float[] flo : possibleForwardStrafe) {
            if (flo[0] > 1.0f) {
                flo[0] = 1.0f;
            }
            else if (flo[0] < -1.0f) {
                flo[0] = -1.0f;
            }
            if (flo[1] > 1.0f) {
                flo[1] = 1.0f;
            }
            else if (flo[1] < -1.0f) {
                flo[1] = -1.0f;
            }
            final double[] motion2;
            final double[] motion = motion2 = MoveUtil.getMotion(0.22, flo[1], flo[0], PlayerHandler.yaw);
            final int n3 = 0;
            motion2[n3] += mc.thePlayer.posX;
            final double[] array3 = motion;
            final int n4 = 1;
            array3[n4] += mc.thePlayer.posZ;
            final double diffX = Math.abs(realPos[0] - motion[0]);
            final double diffZ = Math.abs(realPos[1] - motion[1]);
            final double d0 = diffX * diffX + diffZ * diffZ;
            if (d0 < distance) {
                distance = d0;
                floats = flo;
            }
        }
        return new float[] { floats[1], floats[0] };
    }"
ZGJxr3e9,onLivingUpdate,GamingLVScripts,Java,Monday 1st of April 2024 12:44:13 PM CDT,"/**
     * Called frequently so the entity can update its state every tick as required. For example, zombies and skeletons
     * use this to react to sunlight and start to burn.
     */
    public void onLivingUpdate()
    {
        if (this.sprintingTicksLeft > 0)
        {
            --this.sprintingTicksLeft;

            if (this.sprintingTicksLeft == 0)
            {
                this.setSprinting(false);
            }
        }

        if (this.sprintToggleTimer > 0)
        {
            --this.sprintToggleTimer;
        }

        this.prevTimeInPortal = this.timeInPortal;

        if (this.inPortal)
        {
            if (this.mc.currentScreen != null && !this.mc.currentScreen.doesGuiPauseGame())
            {
                this.mc.displayGuiScreen((GuiScreen)null);
            }

            if (this.timeInPortal == 0.0F)
            {
                this.mc.getSoundHandler().playSound(PositionedSoundRecord.create(new ResourceLocation(""portal.trigger""), this.rand.nextFloat() * 0.4F + 0.8F));
            }

            this.timeInPortal += 0.0125F;

            if (this.timeInPortal >= 1.0F)
            {
                this.timeInPortal = 1.0F;
            }

            this.inPortal = false;
        }
        else if (this.isPotionActive(Potion.confusion) && this.getActivePotionEffect(Potion.confusion).getDuration() > 60)
        {
            this.timeInPortal += 0.006666667F;

            if (this.timeInPortal > 1.0F)
            {
                this.timeInPortal = 1.0F;
            }
        }
        else
        {
            if (this.timeInPortal > 0.0F)
            {
                this.timeInPortal -= 0.05F;
            }

            if (this.timeInPortal < 0.0F)
            {
                this.timeInPortal = 0.0F;
            }
        }

        if (this.timeUntilPortal > 0)
        {
            --this.timeUntilPortal;
        }

        boolean flag = this.movementInput.jump;
        boolean flag1 = this.movementInput.sneak;
        float f = 0.8F;
        boolean flag2 = this.movementInput.moveForward >= f;
        final boolean flag3 = this.movementInput.moveForward >= f;
        final float forward = this.movementInput.moveForward;
        final float strafe = this.movementInput.moveStrafe;
        this.movementInput.updatePlayerMoveState();
        new SilentMoveEvent().publishItself();
        if (PlayerHandler.moveFix && PlayerHandler.currentMode == PlayerHandler.MoveFixMode.SILENT) {
            final float[] floats = this.mySilentStrafe(this.movementInput.moveStrafe, this.movementInput.moveForward, this.rotationYaw, true);
            final float diffForward = forward - floats[1];
            final float diffStrafe = strafe - floats[0];
            if (this.movementInput.sneak) {
                this.movementInput.moveStrafe = MathHelper.clamp_float(floats[0], -0.3f, 0.3f);
                this.movementInput.moveForward = MathHelper.clamp_float(floats[1], -0.3f, 0.3f);
            }
            else {
                if (diffForward >= 2.0f) {
                    floats[1] = 0.0f;
                }
                if (diffForward <= -2.0f) {
                    floats[1] = 0.0f;
                }
                if (diffStrafe >= 2.0f) {
                    floats[0] = 0.0f;
                }
                if (diffStrafe <= -2.0f) {
                    floats[0] = 0.0f;
                }
                this.movementInput.moveStrafe = MathHelper.clamp_float(floats[0], -1.0f, 1.0f);
                this.movementInput.moveForward = MathHelper.clamp_float(floats[1], -1.0f, 1.0f);
            }
        }

        NoSlowEvent noSlowEvent = new NoSlowEvent(0.2f, 0.2f);
        noSlowEvent.publishItself();

        if (this.isUsingItem() && !this.isRiding())
        {
            MovementInput moveInput1 = this.movementInput;
            moveInput1.moveStrafe *= noSlowEvent.getStrafe();
            MovementInput moveInput2 = this.movementInput;
            moveInput2.moveForward *= noSlowEvent.getForward();
            this.sprintToggleTimer = 0;
        }

        this.pushOutOfBlocks(this.posX - (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ + (double)this.width * 0.35D);
        this.pushOutOfBlocks(this.posX - (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ - (double)this.width * 0.35D);
        this.pushOutOfBlocks(this.posX + (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ - (double)this.width * 0.35D);
        this.pushOutOfBlocks(this.posX + (double)this.width * 0.35D, this.getEntityBoundingBox().minY + 0.5D, this.posZ + (double)this.width * 0.35D);
        boolean flag69 = (float) this.getFoodStats().getFoodLevel() > 6.0F || this.capabilities.allowFlying;

        float movef = this.movementInput.moveForward;
        if (PlayerHandler.shouldSprintReset) {
            movef = this.movementInput.moveForward;
            this.movementInput.moveForward = 0;
        }
        if (this.onGround && !flag1 && !flag2 && this.movementInput.moveForward >= f && !this.isSprinting() && flag69 && (!this.isUsingItem() || noSlowEvent.isSprint()) && !this.isPotionActive(Potion.blindness)) {
            if (this.sprintToggleTimer <= 0 && !this.mc.gameSettings.keyBindSprint.isKeyDown()) {
                this.sprintToggleTimer = 7;
            } else {
                this.setSprinting(true);
            }
        }

        if (!this.isSprinting() && this.movementInput.moveForward >= f && flag69 && (!this.isUsingItem() || noSlowEvent.isSprint()) && !this.isPotionActive(Potion.blindness) && this.mc.gameSettings.keyBindSprint.isKeyDown()) {
            this.setSprinting(true);
        }

        final DirectionSprintCheckEvent sprintCheckEvent = new DirectionSprintCheckEvent(this.movementInput.moveForward < f).publishItself();
        if (this.isSprinting() && (sprintCheckEvent.isSprintCheck() || this.isCollidedHorizontally || !flag69)) {
            this.setSprinting(false);
        }

        if (!noSlowEvent.isSprint() && this.isUsingItem() && !this.isRiding()) {
            this.setSprinting(false);
        }

        if (PlayerHandler.shouldSprintReset) {
            this.movementInput.moveForward = movef;
            PlayerHandler.shouldSprintReset = false;
        }

        if (this.capabilities.allowFlying)
        {
            if (this.mc.playerController.isSpectatorMode())
            {
                if (!this.capabilities.isFlying)
                {
                    this.capabilities.isFlying = true;
                    this.sendPlayerAbilities();
                }
            }
            else if (!flag && this.movementInput.jump)
            {
                if (this.flyToggleTimer == 0)
                {
                    this.flyToggleTimer = 7;
                }
                else
                {
                    this.capabilities.isFlying = !this.capabilities.isFlying;
                    this.sendPlayerAbilities();
                    this.flyToggleTimer = 0;
                }
            }
        }

        if (this.capabilities.isFlying && this.isCurrentViewEntity())
        {
            if (this.movementInput.sneak)
            {
                this.motionY -= (double)(this.capabilities.getFlySpeed() * 3.0F);
            }

            if (this.movementInput.jump)
            {
                this.motionY += (double)(this.capabilities.getFlySpeed() * 3.0F);
            }
        }

        if (this.isRidingHorse())
        {
            if (this.horseJumpPowerCounter < 0)
            {
                ++this.horseJumpPowerCounter;

                if (this.horseJumpPowerCounter == 0)
                {
                    this.horseJumpPower = 0.0F;
                }
            }

            if (flag && !this.movementInput.jump)
            {
                this.horseJumpPowerCounter = -10;
                this.sendHorseJump();
            }
            else if (!flag && this.movementInput.jump)
            {
                this.horseJumpPowerCounter = 0;
                this.horseJumpPower = 0.0F;
            }
            else if (flag)
            {
                ++this.horseJumpPowerCounter;

                if (this.horseJumpPowerCounter < 10)
                {
                    this.horseJumpPower = (float)this.horseJumpPowerCounter * 0.1F;
                }
                else
                {
                    this.horseJumpPower = 0.8F + 2.0F / (float)(this.horseJumpPowerCounter - 9) * 0.1F;
                }
            }
        }
        else
        {
            this.horseJumpPower = 0.0F;
        }

        super.onLivingUpdate();

        if (this.onGround && this.capabilities.isFlying && !this.mc.playerController.isSpectatorMode())
        {
            this.capabilities.isFlying = false;
            this.sendPlayerAbilities();
        }
    }"
jcLweH6J,onUpdateWalkingPlayer,GamingLVScripts,Java,Monday 1st of April 2024 12:43:16 PM CDT,"/**
     * called every tick when the player is on foot. Performs all the things that normally happen during movement.
     */
    public void onUpdateWalkingPlayer(UpdateMotionEvent updateMotionEvent, float yaw, float pitch) {
        boolean flag = this.isSprinting();

        if (flag != this.serverSprintState) {
            if (flag) {
                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.START_SPRINTING));
            } else {
                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.STOP_SPRINTING));
            }


            PlayerHandler.shouldSprintReset = false;

            this.serverSprintState = flag;
        }

        boolean flag1 = this.isSneaking();

        if (flag1 != this.serverSneakState) {
            if (flag1) {
                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.START_SNEAKING));
            } else {
                this.sendQueue.addToSendQueue(new C0BPacketEntityAction(this, C0BPacketEntityAction.Action.STOP_SNEAKING));
            }

            this.serverSneakState = flag1;
        }

        if (updateMotionEvent.isCurrentView()) {
            double d0 = this.posX - this.lastReportedPosX;
            double d1 = this.getEntityBoundingBox().minY - this.lastReportedPosY;
            double d2 = this.posZ - this.lastReportedPosZ;
            double d3 = (double) (yaw - this.lastReportedYaw);
            double d4 = (double) (pitch - this.lastReportedPitch);

            boolean flag2 = d0 * d0 + d1 * d1 + d2 * d2 > 9.0E-4D || this.positionUpdateTicks >= 20;
            boolean flag3 = d3 != 0.0D || d4 != 0.0D;

            if (this.ridingEntity == null) {
                if (flag2 && flag3) {
                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C06PacketPlayerPosLook(this.posX, this.getEntityBoundingBox().minY, this.posZ, yaw, pitch, this.onGround));
                } else if (flag2) {
                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C04PacketPlayerPosition(this.posX, this.getEntityBoundingBox().minY, this.posZ, this.onGround));
                } else if (flag3) {
                    this.sendQueue.addToSendQueue(new C03PacketPlayer.C05PacketPlayerLook(yaw, pitch, this.onGround));
                } else {
                    this.sendQueue.addToSendQueue(new C03PacketPlayer(this.onGround));
                }
            } else {
                final RidingEntityEvent ridingEntityEvent = new RidingEntityEvent(this.motionX, -999D, this.motionZ, this.onGround).publishItself();
                this.sendQueue.addToSendQueue(new C03PacketPlayer.C06PacketPlayerPosLook(ridingEntityEvent.getMotionX(), ridingEntityEvent.getMotionY(), ridingEntityEvent.getMotionZ(), yaw, pitch, ridingEntityEvent.isOnGround()));
                flag2 = false;
            }

            ++this.positionUpdateTicks;

            if (flag2) {
                this.lastReportedPosX = this.posX;
                this.lastReportedPosY = this.getEntityBoundingBox().minY;
                this.lastReportedPosZ = this.posZ;
                this.positionUpdateTicks = 0;
            }

            if (flag3) {
                this.lastReportedYaw = yaw;
                this.lastReportedPitch = pitch;
            }

            new UpdateMotionEvent(UpdateMotionEvent.Type.POST, updateMotionEvent.isCurrentView()).publishItself();
        }
    }"
9akDhd12,getLook,GamingLVScripts,Java,Monday 1st of April 2024 12:41:46 PM CDT,"    /**
     * interpolated look vector
     */
    @Override
    public Vec3 getLook(float partialTicks) {
        return getVectorForRotation(PlayerHandler.pitch, PlayerHandler.yaw);
    }"
2r5hwfnD,onUpdate,GamingLVScripts,Java,Monday 1st of April 2024 12:40:55 PM CDT,"/**
     * Called to update the entity's position/logic.
     */
    public void onUpdate() {
        if (this.worldObj.isBlockLoaded(new BlockPos(this.posX, 0.0D, this.posZ))) {
            new UpdateEvent().publishItself();
            final UpdateMotionEvent updateMotionEvent = new UpdateMotionEvent(UpdateMotionEvent.Type.PRE, this.isCurrentViewEntity()).publishItself();
            if(updateMotionEvent.isCancelled())
                return;
            super.onUpdate();
            new UpdateMotionEvent(UpdateMotionEvent.Type.MID, updateMotionEvent.isCurrentView()).publishItself();
            if (this.isRiding()) {
                this.sendQueue.addToSendQueue(new C03PacketPlayer.C05PacketPlayerLook(PlayerHandler.yaw, PlayerHandler.pitch, this.onGround));
                this.sendQueue.addToSendQueue(new C0CPacketInput(this.moveStrafing, this.moveForward, this.movementInput.jump, this.movementInput.sneak));
            } else {
                this.onUpdateWalkingPlayer(updateMotionEvent, PlayerHandler.yaw, PlayerHandler.pitch);
            }
        }
    }"
AFfVazpT,moveFlying,GamingLVScripts,Java,Monday 1st of April 2024 12:39:55 PM CDT,"    @Override
    public void moveFlying(float f, float f2, float f3) {
        MoveFlyingEvent moveFlyingEvent = new MoveFlyingEvent(f, f2, f3).publishItself();
        f = moveFlyingEvent.getStrafe();
        f2 = moveFlyingEvent.getForward();
        if (moveFlyingEvent.isCancelled()) {
            return;
        }
        float f4 = PlayerHandler.moveFix ? PlayerHandler.yaw : this.rotationYaw;
        float f5 = f * f + f2 * f2;
        if (f5 >= 1.0E-4f) {
            if ((f5 = MathHelper.sqrt_float(f5)) < 1.0f) {
                f5 = 1.0f;
            }
            f5 = f3 / f5;
            float f6 = MathHelper.sin(f4 * (float)Math.PI / 180.0f);
            float f7 = MathHelper.cos(f4 * (float)Math.PI / 180.0f);
            this.motionX += (double)((f *= f5) * f7 - (f2 *= f5) * f6);
            this.motionZ += (double)(f2 * f7 + f * f6);
        }
    }"
vw8sFSCX,Untitled,hydrian,YAML,Monday 1st of April 2024 12:37:26 PM CDT,"---
id: net.tygerclan.cstitch
runtime: org.kde.Platform
runtime-version: '5.9'
sdk: org.kde.Sdk
command: cstitch
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --device=dri
  - --filesystem=xdg-documents
modules:
  - name: cstitch
    buildsystem: simple
    build-commands:
      - ""chmod +x magick""
      - ""doc/createDocs.py""
      - ""qmake -project""
      - './progen.py'
      - ""cd icons && ls -l .. && for FILE in *.svg ; do ls ../magick ; ../magick ${FILE} -size 32x32 ${FILE%.*}.png ; done""
      - 'qmake'
      - 'make'
    builddir: true
    sources: 
      - type: git
        url: 'https://git.code.sf.net/p/cstitch/code'
        tag: 0.9.8
      - type: file
        url: https://imagemagick.org/archive/binaries/magick
        sha256: 93c6dd3f0d0bd97338834719cbd41187c3498dc16949ac45df8b4768f87d184e
"
BFuUMeac,invincible warp,marcusa3000,Lua,Monday 1st of April 2024 12:25:15 PM CDT,"{
	Tools = ordered() {
		Merge23 = Merge {
			Inputs = {
				Background = Input {
					SourceOp = ""Background_27"",
					Source = ""Output"",
				},
				Foreground = Input {
					SourceOp = ""Background_28"",
					Source = ""Output"",
				},
				Size = Input { Value = 0.911111111111111, },
				PerformDepthMerge = Input { Value = 0, },
			},
			ViewInfo = OperatorInfo { Pos = { 1155, -1633.5 } },
		},
		Background_27 = Background {
			NameSet = true,
			Inputs = {
				GlobalOut = Input { Value = 118, },
				Width = Input { Value = 1080, },
				Height = Input { Value = 540, },
				Depth = Input { Value = 1, },
				[""Gamut.SLogVersion""] = Input { Value = FuID { ""SLog2"" }, },
				TopLeftRed = Input { Value = 0.0980392172932625, },
				TopLeftGreen = Input { Value = 0.615686297416687, },
				TopLeftBlue = Input { Value = 0.988235294818878, },
				TopRightRed = Input { Value = 1, },
				TopRightGreen = Input { Value = 1, },
				TopRightBlue = Input { Value = 1, },
				BottomLeftRed = Input { Value = 1, },
				BottomLeftGreen = Input { Value = 0.5, },
				BottomRightGreen = Input { Value = 0.5, },
				BottomRightBlue = Input { Value = 1, },
				Start = Input { Value = { 0.5, 0 }, },
				End = Input { Value = { 0.5, 1 }, },
				Gradient = Input {
					Value = Gradient {
						Colors = {
							[0] = { 1, 1, 1, 1 },
							[1] = { 0, 0, 0, 1 }
						}
					},
				},
			},
			ViewInfo = OperatorInfo { Pos = { 1265, -1666.5 } },
		},
		Background_28 = Background {
			NameSet = true,
			Inputs = {
				EffectMask = Input {
					SourceOp = ""GridWarp1_3"",
					Source = ""Output"",
				},
				GlobalOut = Input { Value = 118, },
				Width = Input { Value = 1080, },
				Height = Input { Value = 1080, },
				Depth = Input { Value = 1, },
				[""Gamut.SLogVersion""] = Input { Value = FuID { ""SLog2"" }, },
				TopLeftRed = Input { Value = 0.996078431606293, },
				TopLeftGreen = Input { Value = 0.929411768913269, },
				TopLeftBlue = Input { Value = 0.00784313771873713, },
				TopRightRed = Input { Value = 1, },
				TopRightGreen = Input { Value = 1, },
				TopRightBlue = Input { Value = 1, },
				BottomLeftRed = Input { Value = 1, },
				BottomLeftGreen = Input { Value = 0.5, },
				BottomRightGreen = Input { Value = 0.5, },
				BottomRightBlue = Input { Value = 1, },
				Start = Input { Value = { 0.5, 0 }, },
				End = Input { Value = { 0.5, 1 }, },
				Gradient = Input {
					Value = Gradient {
						Colors = {
							[0] = { 1, 1, 1, 1 },
							[1] = { 0, 0, 0, 1 }
						}
					},
				},
			},
			ViewInfo = OperatorInfo { Pos = { 1155, -1699.5 } },
		},
		GridWarp1_3 = GridWarp {
			SrcDrawMode = 1,
			DestDrawMode = 1,
			Inputs = {
				MagnetType = Input { Value = 0, },
				DstXGridSize = Input { Value = 2, },
				DstYGridSize = Input { Value = 1, },
				DstPointTolerance = Input { Value = 0.00999999977648258, },
				DstOverSizeAmount = Input { Value = 0.0500000007450581, },
				DstSnapDistance = Input { Value = 0.0199999995529652, },
				SrcXGridSize = Input { Value = 2, },
				SrcYGridSize = Input { Value = 1, },
				SrcGridChange = Input {
					Value = Mesh {
						Count = 6,
						Col = 3,
						DeltaR = 1,
						DeltaC = 0.5,
						P1X = -0.5,
						P1Y = -0.5,
						Points = {
							{ X = -0.5, Y = -0.5, L_CX = 0, T_CY = 0, },
							{ X = 0, Y = -0.5, T_CY = 0, },
							{ X = 0.5, Y = -0.5, T_CY = 0, R_CX = 0, },
							{ X = -0.5, Y = 0.5, L_CX = 0, B_CY = 0, },
							{ X = 0, Y = 0.5, B_CY = 0, },
							{ X = 0.5, Y = 0.5, R_CX = 0, B_CY = 0, }
						},
						SavePoints = {
						}
					},
				},
				SrcPolyline = Input {
					Value = Polyline {
					},
				},
				DstGridChange = Input {
					Value = Mesh {
						Count = 6,
						Col = 3,
						DeltaR = 1,
						DeltaC = 0.5,
						P1X = -0.5,
						P1Y = -0.5,
						Points = {
							{ X = -0.5, Y = -0.5, Z = 0.0001, L_CX = 0, T_CY = 0, R_CX = 0.160499986879611, R_CY = 0.096506090971375, B_CX = 0.0141252378402467, B_CY = 0.333241163097135, },
							{ X = 0, Y = -0.287261051373955, Z = 0.0001, V = -0.5, L_CX = -0.177096702880834, T_CY = 0, R_CX = 0.177096702880834, B_CX = -2.28934162722926e-05, B_CY = 0.262328180221786, },
							{ X = 0.5, Y = -0.5, Z = 0.0001, L_CX = -0.156931656627646, L_CY = 0.0960397932751801, T_CY = 0, R_CX = 0, B_CX = -0.0141710246727921, B_CY = 0.333241163097135, },
							{ X = -0.457624286479259, Y = 0.499723489291404, Z = 0.0001, U = -0.5, V = 0.5, L_CX = 0, T_CX = -0.0141252378402467, T_CY = -0.333241163097135, R_CX = 0.152518535410147, B_CY = 0, },
							{ X = -6.86802488180584e-05, Y = 0.499723489291404, Z = 0.0001, U = 0, V = 0.5, L_CX = -0.152518535410147, T_CX = 2.28934162722926e-05, T_CY = -0.262328180221786, R_CX = 0.152518535410147, B_CY = 0, },
							{ X = 0.457486925981623, Y = 0.499723489291404, Z = 0.0001, U = 0.5, V = 0.5, L_CX = -0.152518535410147, T_CX = 0.0141710246727921, T_CY = -0.333241163097135, R_CX = 0, B_CY = 0, }
						},
						SavePoints = {
						}
					},
				},
				DstPolyline = Input {
					Value = Polyline {
					},
				},
				Input = Input {
					SourceOp = ""Scale3"",
					Source = ""Output"",
				},
			},
			ViewInfo = OperatorInfo { Pos = { 1155, -1765.5 } },
		},
		Background_30 = Background {
			NameSet = true,
			Inputs = {
				EffectMask = Input {
					SourceOp = ""Scale3"",
					Source = ""Output"",
				},
				GlobalOut = Input { Value = 118, },
				Width = Input { Value = 1080, },
				Height = Input { Value = 1080, },
				Depth = Input { Value = 1, },
				[""Gamut.SLogVersion""] = Input { Value = FuID { ""SLog2"" }, },
				TopLeftRed = Input { Value = 0.996078431606293, },
				TopLeftGreen = Input { Value = 0.929411768913269, },
				TopLeftBlue = Input { Value = 0.00784313771873713, },
				TopRightRed = Input { Value = 1, },
				TopRightGreen = Input { Value = 1, },
				TopRightBlue = Input { Value = 1, },
				BottomLeftRed = Input { Value = 1, },
				BottomLeftGreen = Input { Value = 0.5, },
				BottomRightGreen = Input { Value = 0.5, },
				BottomRightBlue = Input { Value = 1, },
				Start = Input { Value = { 0.5, 0 }, },
				End = Input { Value = { 0.5, 1 }, },
				Gradient = Input {
					Value = Gradient {
						Colors = {
							[0] = { 1, 1, 1, 1 },
							[1] = { 0, 0, 0, 1 }
						}
					},
				},
			},
			ViewInfo = OperatorInfo { Pos = { 1375, -1765.5 } },
		},
		Displace1 = Displace {
			Inputs = {
				Type = Input { Value = 1, },
				YRefraction = Input { Value = -0.11, },
				Input = Input {
					SourceOp = ""Background_30"",
					Source = ""Output"",
				},
				Foreground = Input {
					SourceOp = ""Rectangle3"",
					Source = ""Mask"",
				},
			},
			ViewInfo = OperatorInfo { Pos = { 1375, -1732.5 } },
		},
		Transform7 = ofx.com.blackmagicdesign.resolvefx.Transform {
			Inputs = {
				Source = Input {
					SourceOp = ""Displace1"",
					Source = ""Output"",
				},
				controlMode = Input { Value = FuID { ""TransformControlsSliders"" }, },
				controlReset = Input { Value = 0, },
				controlGroup = Input { Value = 1, },
				controlVisibility = Input { Value = FuID { ""Show"" }, },
				posX = Input { Value = 0.014, },
				posY = Input { Value = 0, },
				zoom = Input { Value = 1, },
				rotate = Input { Value = 0, },
				scaleX = Input { Value = 0.946, },
				scaleY = Input { Value = 1.204, },
				pitch = Input { Value = 0.277, },
				yaw = Input { Value = 0, },
				flipH = Input { Value = 0, },
				flipV = Input { Value = 0, },
				adjustGroup = Input { Value = 0, },
				isCrop = Input { Value = 0, },
				cropL = Input { Value = 0, },
				cropR = Input { Value = 0, },
				cropT = Input { Value = 0, },
				cropB = Input { Value = 0, },
				edgeSoftness = Input { Value = 0, },
				edgeRounding = Input { Value = 0, },
				animationGroup = Input { Value = 0, },
				serializedWarpable = Input {
					Value = Text {
					},
				},
				serializedPinnable = Input {
					Value = Text {
					},
				},
				motionBlur = Input { Value = 0, },
				advancedGroup = Input { Value = 0, },
				edgeBehaviour = Input { Value = FuID { ""Constant"" }, },
				CompositeType = Input { Value = FuID { ""COMPOSITE_NORMAL"" }, },
				olayAntiAlias = Input { Value = 1, },
				previewAlpha = Input { Value = 0, },
				isLegacyCrop = Input { Value = 0, },
				isLegacyAlphaHandling = Input { Value = 0, },
				isEnforceBlanking = Input { Value = 0, },
				blendGroup = Input { Value = 0, },
				blendIn = Input { Value = 1, },
				blend = Input { Value = 0, },
				ignoreContentShape = Input { Value = 0, },
				legacyIsProcessRGBOnly = Input { Value = 0, },
				IsNoTemporalFramesReqd = Input { Value = 0, },
				refreshTrigger = Input { Value = 1, },
				resolvefxVersion = Input { Value = ""1.4"", },
			},
			ViewInfo = OperatorInfo { Pos = { 1375, -1699.5 } },
		},
		Merge23_1 = Merge {
			Inputs = {
				Background = Input {
					SourceOp = ""Background_27"",
					Source = ""Output"",
				},
				Foreground = Input {
					SourceOp = ""Transform7"",
					Source = ""Output"",
				},
				Center = Input { Value = { 0.5, 0.455922865013774 }, },
				Size = Input { Value = 0.911111111111111, },
				PerformDepthMerge = Input { Value = 0, },
			},
			ViewInfo = OperatorInfo { Pos = { 1375, -1633.5 } },
		},
		Rectangle3 = RectangleMask {
			Inputs = {
				EffectMask = Input {
					SourceOp = ""Ellipse10"",
					Source = ""Mask"",
				},
				Filter = Input { Value = FuID { ""Fast Gaussian"" }, },
				SoftEdge = Input { Value = 0.1433, },
				PaintMode = Input { Value = FuID { ""Subtract"" }, },
				MaskWidth = Input { Value = 1080, },
				MaskHeight = Input { Value = 1080, },
				PixelAspect = Input { Value = { 1, 1 }, },
				UseFrameFormatSettings = Input { Value = 1, },
				ClippingMode = Input { Value = FuID { ""None"" }, },
				Center = Input { Value = { 0.5, 0.940850190475545 }, },
				Width = Input { Value = 1.32249560632689, },
				Height = Input { Value = 0.488888888888889, },
			},
			ViewInfo = OperatorInfo { Pos = { 1485, -1732.5 } },
		},
		Scale3 = Scale {
			Inputs = {
				LockXY = Input { Value = 0, },
				YSize = Input { Value = 1.25, },
				HiQOnly = Input { Value = 0, },
				PixelAspect = Input { Value = { 1, 1 }, },
			},
			ViewInfo = OperatorInfo { Pos = { 1265, -1864.5 } },
		},
		Ellipse10 = EllipseMask {
			Inputs = {
				Filter = Input { Value = FuID { ""Fast Gaussian"" }, },
				SoftEdge = Input { Value = 0.178, },
				MaskWidth = Input { Value = 1080, },
				MaskHeight = Input { Value = 1080, },
				PixelAspect = Input { Value = { 1, 1 }, },
				UseFrameFormatSettings = Input { Value = 1, },
				ClippingMode = Input { Value = FuID { ""None"" }, },
				Center = Input { Value = { 0.5, 0.255007824726135 }, },
				Width = Input { Value = 0.82962962962963, },
				Height = Input { Value = 0.663719353155973, },
			},
			ViewInfo = OperatorInfo { Pos = { 1595, -1732.5 } },
		}
	}
}"
LJJwZhWd,Untitled,tabr,Diff,Monday 1st of April 2024 12:22:04 PM CDT,"diff --git a/.gitignore b/.gitignore
index 28cb1cb..19d3ddb 100644
--- a/.gitignore
+++ b/.gitignore
@@ -32,6 +32,7 @@ sensor/log_test.txt
 yandex_9f7c39d954ff4229.html

 .idea
+.editorconfig
 pma/*
 include/IntervalsClass.php.bak
 *.bak
diff --git a/admin/save_data.php b/admin/save_data.php
index 07c026b..9395bc1 100644
--- a/admin/save_data.php
+++ b/admin/save_data.php
@@ -3,6 +3,7 @@ include('../config.php');
 include('../connect_db.php');
 include('../functions.php');
 require_once(__DIR__ . '/../include/TimeZone.php');
+require_once(__DIR__ . '/../include/Util.php');
 require_once(__DIR__ . '/../api3/objects/DeviceSettingsStorage.php');
 require_once(__DIR__ . '/../api3/objects/DeviceSettingsCurrent.php');
 require_once(__DIR__ . '/../api3/objects/Devices.php');
@@ -13,686 +14,692 @@ error_reporting(1);
 $_POST[u] = $_COOKIE[u];

 if ($_POST[action]) {
-       $res = mysql_query(""select * from users where id in (select userID from session where session='$_POST[u]')"");
-       if ($res and mysql_num_rows($res)>0) {
-               $userData = mysql_fetch_array($res);
-       }
-       if ($userData[email]) mysql_query(""insert save_log (user, action, query) values ('$userData[email]', '$_POST[action]', '"".print_r($_POST,true).""')"");
+    $res = mysql_query(""select * from users where id in (select userID from session where session='$_POST[u]')"");
+    if ($res and mysql_num_rows($res) > 0) {
+        $userData = mysql_fetch_array($res);
+    }
+    if ($userData[email]) mysql_query(""insert save_log (user, action, query) values ('$userData[email]', '$_POST[action]', '"" . print_r($_POST, true) . ""')"");
 }

 switch ($_POST[action]) {
-       case ""del_defect_type"":
-               mysql_query(""delete from defect_type where id='{$_POST['id']}'"");
-               mysql_query(""delete from defect_type_equipment where defect_type_id='{$_POST['id']}'"");
-               mysql_query(""delete from defect_type_production_group where defect_type_id='{$_POST['id']}'"");
-               header(""Location: ./?action=defect_type"");
-       break;
-       case ""add_del_defect"":
-               mysql_query(""insert defect_type (name, dop_id) values ('{$_POST['name']}', '{$_POST['dop_id']}')"");
-               $defect_type_id = mysql_insert_id();
-               foreach ($_POST['defect_type_equipment'] as $key => $value) {
-                       mysql_query(""insert defect_type_equipment (defect_type_id, equipment_group) values ('{$defect_type_id}', '{$value}')"");
-               }
-               foreach ($_POST['defect_type_production_group'] as $key => $value) {
-                       mysql_query(""insert defect_type_production_group (defect_type_id, production_group) values ('{$defect_type_id}', '{$value}')"");
-               }
-               header(""Location: ./?action=defect_type&id="".$defect_type_id);
-       break;
-       case ""update_defect_type"":
-               mysql_query(""update defect_type set name='{$_POST['name']}', dop_id='{$_POST['dop_id']}' where id='{$_POST['id']}'"");
-               mysql_query(""delete from defect_type_equipment  where defect_type_id='{$_POST['id']}'"");
-               foreach ($_POST['defect_type_equipment'] as $key => $value) {
-                       mysql_query(""insert defect_type_equipment (defect_type_id, equipment_group) values ('{$_POST['id']}', '{$value}')"");
-               }
-               mysql_query(""delete from defect_type_production_group  where defect_type_id='{$_POST['id']}'"");
-               foreach ($_POST['defect_type_production_group'] as $key => $value) {
-                       mysql_query(""insert defect_type_production_group (defect_type_id, production_group) values ('{$_POST['id']}', '{$value}')"");
-               }
-               header(""Location: ./?action=defect_type&id="".$_POST['id']);
-       break;
-       case ""create_downtime_correction"":
-               $res = mysql_query(""select * from arm_tablo where update_time='{$_POST[time]}' and arm_serial='{$_POST['serial']}'"");
-               if ($res and mysql_num_rows($res)>0) {
-                       while ($r = mysql_fetch_assoc($res)) {
-                               $original = $r;
-                       }
-               }
-               mysql_query(""insert arm_tablo_downtime_correction (update_time, arm_serial, user_modificator, downtime, comment) values ('{$_POST[time]}', '{$_POST['serial']}', '{$userData['id']}', '{$original['downtime']}', '{$original['comment']}')"");
-               mysql_query(""update arm_tablo set comment='{$_POST['comment']}', downtime='{$_POST['downtime']}' where update_time='{$_POST['time']}' and arm_serial='{$_POST['serial']}'"");
-               header(""Location: ./?action=downtime_report&from={$_POST[from]}&from_time={$_POST[from_time]}&to={$_POST[to]}&to_time={$_POST[to_time]}"");
-       break;
-       case ""delete_downtime_correction"":
-               print_r($_POST);
-               $res = mysql_query(""select * from arm_tablo_downtime_correction where update_time='{$_POST[time]}'"");
-               if ($res and mysql_num_rows($res)>0) {
-                       while ($r = mysql_fetch_assoc($res)) {
-                               $correction = $r;
-                       }
-               }
-               //print_r($correction);
-               mysql_query(""update arm_tablo set comment='{$correction['comment']}', downtime='{$correction['downtime']}' where update_time='{$_POST['time']}'"");
-               mysql_query(""delete from arm_tablo_downtime_correction where update_time='{$_POST['time']}'"");
-               header(""Location: ./?action=downtime_report&from={$_POST[from]}&from_time={$_POST[from_time]}&to={$_POST[to]}&to_time={$_POST[to_time]}"");
-       break;
-       case ""delete_defect_correction"":
-               $sql = ""delete from arm_defect where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"";
-               mysql_query($sql);
-               $sql = ""insert arm_defect select arm_serial, time, user, nom, mat, inst, defect, comment, defect_type from arm_defect_correction where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"";
-               mysql_query($sql);
-               // echo $sql;
-               // exit;
-               mysql_query(""delete from arm_defect_correction where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"");
-               header(""Location: ./?action=defect2&id={$_POST['id']}&from={$_POST[date_from]}&from_time={$_POST[time_from]}&to={$_POST[date_to]}&to_time={$_POST[time_to]}"");
-       break;
-       case ""create_defect_correction"":
-               $sql = ""insert into arm_defect_correction select *, '{$userData[id]}' as user_modificator from arm_defect where time='{$_POST[time]}' and arm_serial='{$_POST[arm]}'"";
-               // echo $sql;
-               // exit;
-               mysql_query($sql);
-               $sql = ""update arm_defect set defect='{$_POST[defect]}', comment='{$_POST[comment]}', defect_type='{$_POST[defect_type]}' where time='{$_POST[time]}' and arm_serial='{$_POST[arm]}'"";
-               mysql_query($sql);
-               header(""Location: ./?action=defect2&id={$_POST['id']}&from={$_POST[date_from]}&from_time={$_POST[time_from]}&to={$_POST[date_to]}&to_time={$_POST[time_to]}"");
-       break;
-       case ""del_correction"":
-               mysql_query(""delete from arm_circuit where time_begin='{$_POST[id]}'"");
-               mysql_query(""insert arm_circuit select arm_serial, time_begin, time_end, user, nom, mat, inst, multiplicator, consumption from arm_circuit_correction where time_begin='{$_POST[id]}'"");
-               mysql_query(""delete from arm_circuit_correction where time_begin='{$_POST[id]}'"");
-               header(""Location: ./?action=production_correction&id={$_POST['id']}"");
-       break;
-       case ""create_correction"":
-               $res = mysql_query(""select * from production where id='{$_POST[nom]}'"");
-               if ($res and mysql_num_rows($res)>0) {
-                       while ($r = mysql_fetch_assoc($res)) {
-                               $consumption = $r[consumption];
-                               $multiplicator = $r[multiplicator];
-                       }
-               }
-               mysql_query(""insert into arm_circuit_correction select *, '{$_POST[user_modificator]}' as user_modificator from arm_circuit where time_begin='{$_POST[id]}'"");
-               mysql_query(""update arm_circuit set multiplicator='{$multiplicator}', consumption='{$consumption}', nom='{$_POST[nom]}', mat='{$_POST[mat]}', inst='{$_POST[inst]}' where time_begin='{$_POST[id]}'"");
-               header(""Location: ./?action=production_correction&id={$_POST['id']}"");
-       break;
-       case ""arm_message"":
-               mysql_query(""insert arm_message (arm_serial, message, sender) values ('{$_POST[id]}', '{$_POST['message']}', '{$_POST['sender']}')"");
-       break;
-       case ""update_event_conditions"":
-       if (checkskey($_POST['id'])) {
-               if ($_POST[downtime_id] and $_POST[downtime_duration] and $_POST['type'] == 'downtime_continue') {
-                       $params = ""params='{\""id\"" : {$_POST[downtime_id]}, \""duration\"" : {$_POST[downtime_duration]} }', "";
-               }
-               mysql_query(""update event_conditions set {$params} type='{$_POST['type']}', equipment_id='"".implode(',',$_POST['equipment_id']).""', admin_id='"".implode(',',$_POST['admin_id']).""', pause='{$_POST['pause']}', counter='{$_POST['counter']}', back_time='{$_POST['back_time']}' where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=event_conditions&id={$_POST['id']}"");
-       break;
-       case ""add_event_conditions"":
-       if (checkskey()) {
-               $params = '';
-               if ($_POST[downtime_id] and $_POST[downtime_duration]) {
-                       $params = ""{\""id\"" : {$_POST[downtime_id]}, \""duration\"" : {$_POST[downtime_duration]} }"";
-               }
-               $sql = ""insert event_conditions (params, type, equipment_id, admin_id, pause, counter, back_time) values ('{$params}', '{$_POST['type']}', '"".implode(',',$_POST['equipment_id']).""', '"".implode(',',$_POST['admin_id']).""', '{$_POST['pause']}', '{$_POST['counter']}', '{$_POST['back_time']}')"";
-               mysql_query($sql);
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=event_conditions&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=event_conditions&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=event_conditions"");
-       }
-       break;
-       case ""del_plan_downtime"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from plan_downtime where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=plan_downtime"");
-       break;
+    case ""del_defect_type"":
+        mysql_query(""delete from defect_type where id='{$_POST['id']}'"");
+        mysql_query(""delete from defect_type_equipment where defect_type_id='{$_POST['id']}'"");
+        mysql_query(""delete from defect_type_production_group where defect_type_id='{$_POST['id']}'"");
+        header(""Location: ./?action=defect_type"");
+        break;
+    case ""add_del_defect"":
+        mysql_query(""insert defect_type (name, dop_id) values ('{$_POST['name']}', '{$_POST['dop_id']}')"");
+        $defect_type_id = mysql_insert_id();
+        foreach ($_POST['defect_type_equipment'] as $key => $value) {
+            mysql_query(""insert defect_type_equipment (defect_type_id, equipment_group) values ('{$defect_type_id}', '{$value}')"");
+        }
+        foreach ($_POST['defect_type_production_group'] as $key => $value) {
+            mysql_query(""insert defect_type_production_group (defect_type_id, production_group) values ('{$defect_type_id}', '{$value}')"");
+        }
+        header(""Location: ./?action=defect_type&id="" . $defect_type_id);
+        break;
+    case ""update_defect_type"":
+        mysql_query(""update defect_type set name='{$_POST['name']}', dop_id='{$_POST['dop_id']}' where id='{$_POST['id']}'"");
+        mysql_query(""delete from defect_type_equipment  where defect_type_id='{$_POST['id']}'"");
+        foreach ($_POST['defect_type_equipment'] as $key => $value) {
+            mysql_query(""insert defect_type_equipment (defect_type_id, equipment_group) values ('{$_POST['id']}', '{$value}')"");
+        }
+        mysql_query(""delete from defect_type_production_group  where defect_type_id='{$_POST['id']}'"");
+        foreach ($_POST['defect_type_production_group'] as $key => $value) {
+            mysql_query(""insert defect_type_production_group (defect_type_id, production_group) values ('{$_POST['id']}', '{$value}')"");
+        }
+        header(""Location: ./?action=defect_type&id="" . $_POST['id']);
+        break;
+    case ""create_downtime_correction"":
+        $res = mysql_query(""select * from arm_tablo where update_time='{$_POST[time]}' and arm_serial='{$_POST['serial']}'"");
+        if ($res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $original = $r;
+            }
+        }
+        mysql_query(""insert arm_tablo_downtime_correction (update_time, arm_serial, user_modificator, downtime, comment) values ('{$_POST[time]}', '{$_POST['serial']}', '{$userData['id']}', '{$original['downtime']}', '{$original['comment']}')"");
+        mysql_query(""update arm_tablo set comment='{$_POST['comment']}', downtime='{$_POST['downtime']}' where update_time='{$_POST['time']}' and arm_serial='{$_POST['serial']}'"");
+        header(""Location: ./?action=downtime_report&from={$_POST[from]}&from_time={$_POST[from_time]}&to={$_POST[to]}&to_time={$_POST[to_time]}"");
+        break;
+    case ""delete_downtime_correction"":
+        print_r($_POST);
+        $res = mysql_query(""select * from arm_tablo_downtime_correction where update_time='{$_POST[time]}'"");
+        if ($res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $correction = $r;
+            }
+        }
+        //print_r($correction);
+        mysql_query(""update arm_tablo set comment='{$correction['comment']}', downtime='{$correction['downtime']}' where update_time='{$_POST['time']}'"");
+        mysql_query(""delete from arm_tablo_downtime_correction where update_time='{$_POST['time']}'"");
+        header(""Location: ./?action=downtime_report&from={$_POST[from]}&from_time={$_POST[from_time]}&to={$_POST[to]}&to_time={$_POST[to_time]}"");
+        break;
+    case ""delete_defect_correction"":
+        $sql = ""delete from arm_defect where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"";
+        mysql_query($sql);
+        $sql = ""insert arm_defect select arm_serial, time, user, nom, mat, inst, defect, comment, defect_type from arm_defect_correction where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"";
+        mysql_query($sql);
+        // echo $sql;
+        // exit;
+        mysql_query(""delete from arm_defect_correction where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"");
+        header(""Location: ./?action=defect2&id={$_POST['id']}&from={$_POST[date_from]}&from_time={$_POST[time_from]}&to={$_POST[date_to]}&to_time={$_POST[time_to]}"");
+        break;
+    case ""create_defect_correction"":
+        $sql = ""insert into arm_defect_correction select *, '{$userData[id]}' as user_modificator from arm_defect where time='{$_POST[time]}' and arm_serial='{$_POST[arm]}'"";
+        // echo $sql;
+        // exit;
+        mysql_query($sql);
+        $sql = ""update arm_defect set defect='{$_POST[defect]}', comment='{$_POST[comment]}', defect_type='{$_POST[defect_type]}' where time='{$_POST[time]}' and arm_serial='{$_POST[arm]}'"";
+        mysql_query($sql);
+        header(""Location: ./?action=defect2&id={$_POST['id']}&from={$_POST[date_from]}&from_time={$_POST[time_from]}&to={$_POST[date_to]}&to_time={$_POST[time_to]}"");
+        break;
+    case ""del_correction"":
+        mysql_query(""delete from arm_circuit where time_begin='{$_POST[id]}'"");
+        mysql_query(""insert arm_circuit select arm_serial, time_begin, time_end, user, nom, mat, inst, multiplicator, consumption from arm_circuit_correction where time_begin='{$_POST[id]}'"");
+        mysql_query(""delete from arm_circuit_correction where time_begin='{$_POST[id]}'"");
+        header(""Location: ./?action=production_correction&id={$_POST['id']}"");
+        break;
+    case ""create_correction"":
+        $res = mysql_query(""select * from production where id='{$_POST[nom]}'"");
+        if ($res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $consumption = $r[consumption];
+                $multiplicator = $r[multiplicator];
+            }
+        }
+        mysql_query(""insert into arm_circuit_correction select *, '{$_POST[user_modificator]}' as user_modificator from arm_circuit where time_begin='{$_POST[id]}'"");
+        mysql_query(""update arm_circuit set multiplicator='{$multiplicator}', consumption='{$consumption}', nom='{$_POST[nom]}', mat='{$_POST[mat]}', inst='{$_POST[inst]}' where time_begin='{$_POST[id]}'"");
+        header(""Location: ./?action=production_correction&id={$_POST['id']}"");
+        break;
+    case ""arm_message"":
+        mysql_query(""insert arm_message (arm_serial, message, sender) values ('{$_POST[id]}', '{$_POST['message']}', '{$_POST['sender']}')"");
+        break;
+    case ""update_event_conditions"":
+        if (checkskey($_POST['id'])) {
+            if ($_POST[downtime_id] and $_POST[downtime_duration] and $_POST['type'] == 'downtime_continue') {
+                $params = ""params='{\""id\"" : {$_POST[downtime_id]}, \""duration\"" : {$_POST[downtime_duration]} }', "";
+            }
+            mysql_query(""update event_conditions set {$params} type='{$_POST['type']}', equipment_id='"" . implode(',', $_POST['equipment_id']) . ""', admin_id='"" . implode(',', $_POST['admin_id']) . ""', pause='{$_POST['pause']}', counter='{$_POST['counter']}', back_time='{$_POST['back_time']}' where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=event_conditions&id={$_POST['id']}"");
+        break;
+    case ""add_event_conditions"":
+        if (checkskey()) {
+            $params = '';
+            if ($_POST[downtime_id] and $_POST[downtime_duration]) {
+                $params = ""{\""id\"" : {$_POST[downtime_id]}, \""duration\"" : {$_POST[downtime_duration]} }"";
+            }
+            $sql = ""insert event_conditions (params, type, equipment_id, admin_id, pause, counter, back_time) values ('{$params}', '{$_POST['type']}', '"" . implode(',', $_POST['equipment_id']) . ""', '"" . implode(',', $_POST['admin_id']) . ""', '{$_POST['pause']}', '{$_POST['counter']}', '{$_POST['back_time']}')"";
+            mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=event_conditions&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=event_conditions&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=event_conditions"");
+        }
+        break;
+    case ""del_plan_downtime"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from plan_downtime where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=plan_downtime"");
+        break;

-       case ""del_plan_oee"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from plan_oee where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=plan_oee"");
-       break;
+    case ""del_plan_oee"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from plan_oee where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=plan_oee"");
+        break;

-       case ""update_plan_oee"":
-       mysql_query(""update plan_oee set year='{$_POST['year']}', month='{$_POST['month']}', param='{$_POST['param']}', percent='{$_POST['percent']}', user='{$userData['id']}' where id='{$_POST['id']}'"");
-       header(""Location: ./?action=plan_oee&id={$_POST['id']}&msg=1"");
-       break;
+    case ""update_plan_oee"":
+        mysql_query(""update plan_oee set year='{$_POST['year']}', month='{$_POST['month']}', param='{$_POST['param']}', percent='{$_POST['percent']}', user='{$userData['id']}' where id='{$_POST['id']}'"");
+        header(""Location: ./?action=plan_oee&id={$_POST['id']}&msg=1"");
+        break;

-       case ""add_plan_oee"":
-       $sql = ""select * from plan_oee where year='{$_POST[year]}' and month='{$_POST[month]}' and param='{$_POST[param]}'"";
-       $res = mysql_query($sql);
-       if ($res and mysql_num_rows($res)>0) {
-               header(""Location: ./?action=plan_oee&id={$_POST['id']}&msg=3"");
-         exit;
-       } else {
-               $sql = ""insert plan_oee (year, month, param, percent, user) values ('{$_POST['year']}', '{$_POST['month']}', '{$_POST['param']}', '{$_POST['percent']}', '{$userData['id']}')"";
-               mysql_query($sql);
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=plan_oee&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=plan_oee&id={$id}&msg=2"");
-               }
-       }
-       break;
+    case ""add_plan_oee"":
+        $sql = ""select * from plan_oee where year='{$_POST[year]}' and month='{$_POST[month]}' and param='{$_POST[param]}'"";
+        $res = mysql_query($sql);
+        if ($res and mysql_num_rows($res) > 0) {
+            header(""Location: ./?action=plan_oee&id={$_POST['id']}&msg=3"");
+            exit;
+        } else {
+            $sql = ""insert plan_oee (year, month, param, percent, user) values ('{$_POST['year']}', '{$_POST['month']}', '{$_POST['param']}', '{$_POST['percent']}', '{$userData['id']}')"";
+            mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=plan_oee&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=plan_oee&id={$id}&msg=2"");
+            }
+        }
+        break;

-       case ""del_event_conditions"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from event_conditions where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=event_conditions"");
-       break;
-       case ""update_plan_downtime"":
-       mysql_query(""update plan_downtime set equipment_id='{$_POST['equipment_id']}', comment='{$_POST['comment']}', begin_time='{$_POST['begin_date']} {$_POST['begin_time']}', duration='{$_POST['duration']}' where id='{$_POST['id']}'"");
-       header(""Location: ./?action=plan_downtime&id={$_POST['id']}"");
-       break;
+    case ""del_event_conditions"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from event_conditions where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=event_conditions"");
+        break;
+    case ""update_plan_downtime"":
+        mysql_query(""update plan_downtime set equipment_id='{$_POST['equipment_id']}', comment='{$_POST['comment']}', begin_time='{$_POST['begin_date']} {$_POST['begin_time']}', duration='{$_POST['duration']}' where id='{$_POST['id']}'"");
+        header(""Location: ./?action=plan_downtime&id={$_POST['id']}"");
+        break;

-       case ""add_plan_downtime"":
-       if (checkskey()) {
-               mysql_query(""insert plan_downtime (equipment_id, begin_time, duration, comment) values ('{$_POST['equipment_id']}', '{$_POST['begin_date']} {$_POST['begin_time']}', '{$_POST['duration']}', '{$_POST['comment']}')"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=plan_downtime&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=plan_downtime&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=plan_downtime"");
-       }
-       break;
+    case ""add_plan_downtime"":
+        if (checkskey()) {
+            mysql_query(""insert plan_downtime (equipment_id, begin_time, duration, comment) values ('{$_POST['equipment_id']}', '{$_POST['begin_date']} {$_POST['begin_time']}', '{$_POST['duration']}', '{$_POST['comment']}')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=plan_downtime&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=plan_downtime&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=plan_downtime"");
+        }
+        break;

-       case ""update_plan_smena"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""update plan_smena set date='{$_POST['date']}', shift='{$_POST['shift']}', equipment_id='{$_POST['equipment_id']}', emp_id='{$_POST['emp_id']}', nom='{$_POST['nom']}', mat='{$_POST['mat']}', inst='{$_POST['inst']}', quantity='{$_POST['quantity']}' where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=plan_smena&id={$_POST['id']}&msg=1"");
-       break;
-       case ""add_plan_smena"":
-       if (checkskey()) {
-               mysql_query(""insert plan_smena (date, shift, equipment_id, emp_id, nom, mat, inst, quantity) values ('{$_POST['date']}', '{$_POST['shift']}', '{$_POST['equipment_id']}', '{$_POST['emp_id']}', '{$_POST['nom']}', '{$_POST['mat']}', '{$_POST['inst']}', '{$_POST['quantity']}')"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=plan_smena&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=plan_smena&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=plan_smena"");
-       }
-       break;
-       case ""del_plan_smena"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from plan_smena where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=plan_smena"");
-       break;
-       case ""del_time_interval"":
-       if (checkskey($_POST['id'])) {
-               seveLog(""time_interval"");
-               mysql_query(""delete from time_interval where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=time_interval"");
-       break;
-       case ""update_time_interval"":
-       if (checkskey($_POST['id'])) {
-               seveLog(""time_interval"");
-               $tb = explode(':',$_POST['time_begin']);
-               if (strlen($tb[0])<2) {
-                       $_POST['time_begin'] = '0'.$_POST['time_begin'];
-               }
-               $tb = explode(':',$_POST['time_end']);
-               if (strlen($tb[0])<2) {
-                       $_POST['time_end'] = '0'.$_POST['time_end'];
-               }
-               $res = mysql_query(""update time_interval set name='{$_POST['name']}', time_begin='{$_POST['time_begin']}', time_end='{$_POST['time_end']}' where id='{$_POST['id']}'"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       header(""Location: ./?action=time_interval&id={$_POST['id']}&msg=1"");
-               } else {
-                       header(""Location: ./?action=time_interval&id={$_POST['id']}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=time_interval&&id={$_POST['id']}&msg=3"");
-       }
-       break;
-       case ""add_time_interval"":
-       if (checkskey()) {
-               seveLog(""time_interval"");
-               $tb = explode(':',$_POST['time_begin']);
-               if (strlen($tb[0])<2) {
-                       $_POST['time_begin'] = '0'.$_POST['time_begin'];
-               }
-               $tb = explode(':',$_POST['time_end']);
-               if (strlen($tb[0])<2) {
-                       $_POST['time_end'] = '0'.$_POST['time_end'];
-               }
-               $res = mysql_query(""insert time_interval (name, time_begin, time_end) values ('{$_POST['name']}', '{$_POST['time_begin']}', '{$_POST['time_end']}')"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=time_interval&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=time_interval&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=time_interval&&id={$_POST['id']}&msg=3"");
-       }
-       break;
-       case ""del_news"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from news where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=news_admin"");
-       break;
-       case ""update_news"":
-       if (checkskey($_POST['id'])) {
-               $res = mysql_query(""update news set title='{$_POST['title']}', date='{$_POST['date']}', content='{$_POST['content']}', publish="".($_POST['publish'] ? 1 : 0)."" where id='{$_POST['id']}'"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       header(""Location: ./?action=news_admin&id={$_POST['id']}&msg=1"");
-               } else {
-                       header(""Location: ./?action=news_admin&id={$_POST['id']}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=news_admin&&id={$_POST['id']}&msg=3"");
-       }
-       break;
-       case ""add_news"":
-       if (checkskey()) {
-               $res = mysql_query(""insert news (title, date, content, publish ) values ('{$_POST['title']}', '{$_POST['date']}', '{$_POST['content']}', "".($_POST['publish'] ? 1 : 0)."")"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=news_admin&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=news_admin&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=news_admin&&id={$_POST['id']}&msg=3"");
-       }
-       break;
+    case ""update_plan_smena"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""update plan_smena set date='{$_POST['date']}', shift='{$_POST['shift']}', equipment_id='{$_POST['equipment_id']}', emp_id='{$_POST['emp_id']}', nom='{$_POST['nom']}', mat='{$_POST['mat']}', inst='{$_POST['inst']}', quantity='{$_POST['quantity']}' where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=plan_smena&id={$_POST['id']}&msg=1"");
+        break;
+    case ""add_plan_smena"":
+        if (checkskey()) {
+            mysql_query(""insert plan_smena (date, shift, equipment_id, emp_id, nom, mat, inst, quantity) values ('{$_POST['date']}', '{$_POST['shift']}', '{$_POST['equipment_id']}', '{$_POST['emp_id']}', '{$_POST['nom']}', '{$_POST['mat']}', '{$_POST['inst']}', '{$_POST['quantity']}')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=plan_smena&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=plan_smena&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=plan_smena"");
+        }
+        break;
+    case ""del_plan_smena"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from plan_smena where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=plan_smena"");
+        break;
+    case ""del_time_interval"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""time_interval"");
+            mysql_query(""delete from time_interval where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=time_interval"");
+        break;
+    case ""update_time_interval"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""time_interval"");
+            $tb = explode(':', $_POST['time_begin']);
+            if (strlen($tb[0]) < 2) {
+                $_POST['time_begin'] = '0' . $_POST['time_begin'];
+            }
+            $tb = explode(':', $_POST['time_end']);
+            if (strlen($tb[0]) < 2) {
+                $_POST['time_end'] = '0' . $_POST['time_end'];
+            }
+            $res = mysql_query(""update time_interval set name='{$_POST['name']}', time_begin='{$_POST['time_begin']}', time_end='{$_POST['time_end']}' where id='{$_POST['id']}'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=time_interval&id={$_POST['id']}&msg=1"");
+            } else {
+                header(""Location: ./?action=time_interval&id={$_POST['id']}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=time_interval&&id={$_POST['id']}&msg=3"");
+        }
+        break;
+    case ""add_time_interval"":
+        if (checkskey()) {
+            seveLog(""time_interval"");
+            $tb = explode(':', $_POST['time_begin']);
+            if (strlen($tb[0]) < 2) {
+                $_POST['time_begin'] = '0' . $_POST['time_begin'];
+            }
+            $tb = explode(':', $_POST['time_end']);
+            if (strlen($tb[0]) < 2) {
+                $_POST['time_end'] = '0' . $_POST['time_end'];
+            }
+            $res = mysql_query(""insert time_interval (name, time_begin, time_end) values ('{$_POST['name']}', '{$_POST['time_begin']}', '{$_POST['time_end']}')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=time_interval&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=time_interval&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=time_interval&&id={$_POST['id']}&msg=3"");
+        }
+        break;
+    case ""del_news"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from news where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=news_admin"");
+        break;
+    case ""update_news"":
+        if (checkskey($_POST['id'])) {
+            $res = mysql_query(""update news set title='{$_POST['title']}', date='{$_POST['date']}', content='{$_POST['content']}', publish="" . ($_POST['publish'] ? 1 : 0) . "" where id='{$_POST['id']}'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=news_admin&id={$_POST['id']}&msg=1"");
+            } else {
+                header(""Location: ./?action=news_admin&id={$_POST['id']}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=news_admin&&id={$_POST['id']}&msg=3"");
+        }
+        break;
+    case ""add_news"":
+        if (checkskey()) {
+            $res = mysql_query(""insert news (title, date, content, publish ) values ('{$_POST['title']}', '{$_POST['date']}', '{$_POST['content']}', "" . ($_POST['publish'] ? 1 : 0) . "")"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=news_admin&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=news_admin&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=news_admin&&id={$_POST['id']}&msg=3"");
+        }
+        break;

-       case ""del_circuit_min_time"":
-       if (checkskey($_POST['id'])) {
-               seveLog(""circuit_min_time"");
-               mysql_query(""delete from arm_circuit_min_time where nom='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=circuit_min_time"");
-       break;
-       case ""add_circuit_min_time"":
-       if (checkskey()) {
-               seveLog(""circuit_min_time"");
-               mysql_query(""delete from arm_circuit_min_time where nom='{$_POST['nom']}'"");
-               mysql_query(""insert arm_circuit_min_time (nom, time) values ('{$_POST['nom']}', '{$_POST['time']}') "");
-       }
-       header(""Location: ./?action=circuit_min_time&nom={$_POST['nom']}&msg=1"");
-       break;
-       case ""update_matrix_short_stop"":
-       seveLog(""action_matrix_short_stop"");
-       if (checkskey($_POST['id'])) {
-               $res = mysql_query(""update short_stop set equipment='{$_POST['equipment']}', production='{$_POST['production']}', time='{$_POST['time']}' where id='{$_POST['id']}'"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       header(""Location: ./?action=action_matrix_short_stop&id={$_POST['id']}&msg=1"");
-               } else {
-                       header(""Location: ./?action=action_matrix_short_stop&id={$_POST['id']}&msg=2"");
-               }
-       }
-       break;
-       case ""add_matrix_short_stop"":
-       seveLog(""action_matrix_short_stop"");
-       if (checkskey()) {
-               $res = mysql_query(""insert short_stop (equipment, production, `time`) values ('{$_POST['equipment']}', '{$_POST['production']}', '{$_POST['time']}')"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=action_matrix_short_stop&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=action_matrix_short_stop&id={$id}&msg=2"");
-               }
-       }
-       break;
-       case ""del_matrix_short_stop"":
-       seveLog(""action_matrix_short_stop"");
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from short_stop where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=action_matrix_short_stop"");
-       break;
-       case ""settings"":
-       if (checkskey()) {
-               seveLog($_POST[action]);
-               //$time_zone_name = mysqli_real_escape_string(DB::$dblink, $_POST['time_zone_name']);
-               $TimeZone = new TimeZone($_POST['time_zone_name']);
-               if (!strpos($_POST['short_stop'], ':')) {
-                       $_POST['short_stop'] = '0:0:'.$_POST['short_stop'];
-               }
-               $t = explode(':',$_POST['short_stop']);
-               if (count($t)==2) $_POST['short_stop'] = '0:'.$_POST['short_stop'];
-               $parsed = date_parse($_POST['short_stop']);
-               $short_stop = $parsed['hour'] * 3600 + $parsed['minute'] * 60 + $parsed['second'];
+    case ""del_circuit_min_time"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""circuit_min_time"");
+            mysql_query(""delete from arm_circuit_min_time where nom='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=circuit_min_time"");
+        break;
+    case ""add_circuit_min_time"":
+        if (checkskey()) {
+            seveLog(""circuit_min_time"");
+            mysql_query(""delete from arm_circuit_min_time where nom='{$_POST['nom']}'"");
+            mysql_query(""insert arm_circuit_min_time (nom, time) values ('{$_POST['nom']}', '{$_POST['time']}') "");
+        }
+        header(""Location: ./?action=circuit_min_time&nom={$_POST['nom']}&msg=1"");
+        break;
+    case ""update_matrix_short_stop"":
+        seveLog(""action_matrix_short_stop"");
+        if (checkskey($_POST['id'])) {
+            $res = mysql_query(""update short_stop set equipment='{$_POST['equipment']}', production='{$_POST['production']}', time='{$_POST['time']}' where id='{$_POST['id']}'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=action_matrix_short_stop&id={$_POST['id']}&msg=1"");
+            } else {
+                header(""Location: ./?action=action_matrix_short_stop&id={$_POST['id']}&msg=2"");
+            }
+        }
+        break;
+    case ""add_matrix_short_stop"":
+        seveLog(""action_matrix_short_stop"");
+        if (checkskey()) {
+            $res = mysql_query(""insert short_stop (equipment, production, `time`) values ('{$_POST['equipment']}', '{$_POST['production']}', '{$_POST['time']}')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=action_matrix_short_stop&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=action_matrix_short_stop&id={$id}&msg=2"");
+            }
+        }
+        break;
+    case ""del_matrix_short_stop"":
+        seveLog(""action_matrix_short_stop"");
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from short_stop where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=action_matrix_short_stop"");
+        break;
+    case ""settings"":
+        if (checkskey()) {
+            seveLog($_POST[action]);
+            //$time_zone_name = mysqli_real_escape_string(DB::$dblink, $_POST['time_zone_name']);
+            $TimeZone = new TimeZone($_POST['time_zone_name']);
+            if (!strpos($_POST['short_stop'], ':')) {
+                $_POST['short_stop'] = '0:0:' . $_POST['short_stop'];
+            }
+            $t = explode(':', $_POST['short_stop']);
+            if (count($t) == 2) $_POST['short_stop'] = '0:' . $_POST['short_stop'];
+            $parsed = date_parse($_POST['short_stop']);
+            $short_stop = $parsed['hour'] * 3600 + $parsed['minute'] * 60 + $parsed['second'];


-               // if (!strpos($_POST['circuit_min_time'], ':')) {
-               //      $_POST['circuit_min_time'] = '0:0:'.$_POST['circuit_min_time'];
-               // }
-               // $t = explode(':',$_POST['circuit_min_time']);
-               // if (count($t)==2) $_POST['circuit_min_time'] = '0:'.$_POST['circuit_min_time'];
-               // $parsed = date_parse($_POST['circuit_min_time']);
-               // $circuit_min_time = $parsed['hour'] * 3600 + $parsed['minute'] * 60 + $parsed['second'];
-               $circuit_min_time = $_POST['circuit_min_time'];
+            // if (!strpos($_POST['circuit_min_time'], ':')) {
+            //         $_POST['circuit_min_time'] = '0:0:'.$_POST['circuit_min_time'];
+            // }
+            // $t = explode(':',$_POST['circuit_min_time']);
+            // if (count($t)==2) $_POST['circuit_min_time'] = '0:'.$_POST['circuit_min_time'];
+            // $parsed = date_parse($_POST['circuit_min_time']);
+            // $circuit_min_time = $parsed['hour'] * 3600 + $parsed['minute'] * 60 + $parsed['second'];
+            $circuit_min_time = $_POST['circuit_min_time'];

-               mysql_query(""delete from `config` where `key` = 'short_stop'"");
-               mysql_query(""delete from `config` where `key` = 'fluctuation'"");
-               mysql_query(""delete from `config` where `key` = 'instrument_report'"");
-               mysql_query(""delete from `config` where `key` = 'circuit_min_time'"");
-               mysql_query(""delete from `config` where `key` = 'defect'"");
-               mysql_query(""delete from `config` where `key` = 'defect_type'"");
-               mysql_query(""delete from `config` where `key` = 'report_encoding'"");
-               mysql_query(""delete from `config` where `key` = 'report_filetype'"");
-               mysql_query(""delete from `config` where `key` = 'arm_user_change'"");
-               mysql_query(""delete from `config` where `key` = 'plan_downtime_info'"");
-               mysql_query(""delete from `config` where `key` = 'autostop_by_circle'"");
-               mysql_query(""delete from `config` where `key` = 'eq_allavlb'"");
-               mysql_query(""delete from `config` where `key` = 'widget_7_param'"");
+            mysql_query(""delete from `config` where `key` = 'short_stop'"");
+            mysql_query(""delete from `config` where `key` = 'fluctuation'"");
+            mysql_query(""delete from `config` where `key` = 'instrument_report'"");
+            mysql_query(""delete from `config` where `key` = 'circuit_min_time'"");
+            mysql_query(""delete from `config` where `key` = 'defect'"");
+            mysql_query(""delete from `config` where `key` = 'defect_type'"");
+            mysql_query(""delete from `config` where `key` = 'report_encoding'"");
+            mysql_query(""delete from `config` where `key` = 'report_filetype'"");
+            mysql_query(""delete from `config` where `key` = 'arm_user_change'"");
+            mysql_query(""delete from `config` where `key` = 'plan_downtime_info'"");
+            mysql_query(""delete from `config` where `key` = 'autostop_by_circle'"");
+            mysql_query(""delete from `config` where `key` = 'eq_allavlb'"");
+            mysql_query(""delete from `config` where `key` = 'widget_7_param'"");

-               mysql_query(""insert into `config` (`key`, `value`) values ('widget_7_param', '{$_POST['widget_7_param']}')"");
-               mysql_query(""insert into `config` (`key`, `value`) values ('eq_allavlb', '{$_POST['eq_allavlb']}')"");
-               mysql_query(""insert into `config` (`key`, `value`) values ('circuit_min_time', '{$circuit_min_time}')"");
-               mysql_query(""insert into `config` (`key`, `value`) values ('short_stop', '{$short_stop}')"");
-               mysql_query(""insert into `config` (`key`, `value`) values ('fluctuation', '{$_POST['fluctuation']}')"");
-               if ($_POST['defect']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('defect', 1)"");
-               }
-               if ($_POST['defect_type']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('defect_type', 1)"");
-               }
-               if ($_POST['instrument_report']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('instrument_report', 1)"");
-               }
-               if ($_POST['arm_user_change']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('arm_user_change', 1)"");
-               }
-               if ($_POST['report_encoding']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('report_encoding', '{$_POST['report_encoding']}')"");
-               }
-               if ($_POST['report_filetype']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('report_filetype', '{$_POST['report_filetype']}')"");
-               }
-               if ($_POST['plan_downtime_info']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('plan_downtime_info', 1)"");
-               }
-               if ($_POST['autostop_by_circle']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('autostop_by_circle', 1)"");
-               }
+            mysql_query(""insert into `config` (`key`, `value`) values ('widget_7_param', '{$_POST['widget_7_param']}')"");
+            mysql_query(""insert into `config` (`key`, `value`) values ('eq_allavlb', '{$_POST['eq_allavlb']}')"");
+            mysql_query(""insert into `config` (`key`, `value`) values ('circuit_min_time', '{$circuit_min_time}')"");
+            mysql_query(""insert into `config` (`key`, `value`) values ('short_stop', '{$short_stop}')"");
+            mysql_query(""insert into `config` (`key`, `value`) values ('fluctuation', '{$_POST['fluctuation']}')"");
+            if ($_POST['defect']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('defect', 1)"");
+            }
+            if ($_POST['defect_type']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('defect_type', 1)"");
+            }
+            if ($_POST['instrument_report']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('instrument_report', 1)"");
+            }
+            if ($_POST['arm_user_change']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('arm_user_change', 1)"");
+            }
+            if ($_POST['report_encoding']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('report_encoding', '{$_POST['report_encoding']}')"");
+            }
+            if ($_POST['report_filetype']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('report_filetype', '{$_POST['report_filetype']}')"");
+            }
+            if ($_POST['plan_downtime_info']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('plan_downtime_info', 1)"");
+            }
+            if ($_POST['autostop_by_circle']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('autostop_by_circle', 1)"");
+            }

-               DB::connect(DB_NAME, DB_HOST, DB_USER, DB_PASS);
-               //mysql_query(""update organizations set time_zone='{$_POST[time_zone]}' where domen='{$customer[domen]}'"");
-               mysql_query(""update organizations set time_zone='"".($TimeZone->getUTCOffset()/(60*60) - 3).""',client_timezone='"".$TimeZone->getName().""' where domen='{$customer[domen]}'"");//-3 mean Moscow
-       }
-       header(""Location: ./?action=settings"");
-       break;
-       case ""add_resource"":
-       if (checkskey($_POST[id])) {
-               seveLog(""resources"");
-               mysql_query(""insert resources (name, units, price) values ('{$_POST[name]}', '{$_POST[units]}', '{$_POST[price]}')"");
-               $id = mysql_insert_id();
-       }
-       header(""Location: ./?action=resources&id={$id}"");
-       break;
-       case ""update_resource"":
-       if (checkskey($_POST[id])) {
-               seveLog(""resources"");
-               mysql_query(""update resources set name='{$_POST[name]}', units='{$_POST[units]}', price='{$_POST[price]}' where id='{$_POST[id]}'"");
-       }
-       header(""Location: ./?action=resources&id=$_POST[id]"");
-       break;
-       case ""del_resource"":
-       if (checkskey($_POST[id])) {
-               seveLog(""resources"");
-               mysql_query(""delete from resources where id='$_POST[id]'"");
-       }
-       header(""Location: ./?action=resources&id=$_POST[id]"");
-       break;
-       case ""create_service_task"":
-       if (checkskey()) {
-               $_POST[content] = addslashes($_POST[content]);
-               while (list($key, $val) = each($_POST[responce_2])) {
-                       $responce_2 .= ""$val,"";
-               }
-               $responce_2 = substr($responce_2,0,-1);
-               $_POST[request_id] = ($_POST[request_id] ? $_POST[request_id] : 0);
-               $sql = ""insert service_task (created, service_type, equipment_id, responce, responce_2, request_id, creator, date_plan, hours_plan, content, status) values (
-                       now(), '{$_POST[service_type]}', '{$_POST[equipment_id]}', '{$_POST[responce]}', '{$responce_2}', '{$_POST[request_id]}', '{$userData[id]}', '{$_POST[date]} {$_POST[time]}', '{$_POST[hours_plan]}', '{$_POST[content]}', "".($_POST[status] ? 1 : 0)."")"";
-                       mysql_query($sql);
-                       // echo $sql;
-                       // exit;
-               }
-               header(""Location: ./?action=service_request_list&id=$_POST[request_id]"");
-               break;
+            DB::connect(DB_NAME, DB_HOST, DB_USER, DB_PASS);
+            //mysql_query(""update organizations set time_zone='{$_POST[time_zone]}' where domen='{$customer[domen]}'"");
+            mysql_query(""update organizations set time_zone='"" . ($TimeZone->getUTCOffset() / (60 * 60) - 3) . ""',client_timezone='"" . $TimeZone->getName() . ""' where domen='{$customer[domen]}'"");//-3 mean Moscow
+        }
+        header(""Location: ./?action=settings"");
+        break;
+    case ""add_resource"":
+        if (checkskey($_POST[id])) {
+            seveLog(""resources"");
+            mysql_query(""insert resources (name, units, price) values ('{$_POST[name]}', '{$_POST[units]}', '{$_POST[price]}')"");
+            $id = mysql_insert_id();
+        }
+        header(""Location: ./?action=resources&id={$id}"");
+        break;
+    case ""update_resource"":
+        if (checkskey($_POST[id])) {
+            seveLog(""resources"");
+            mysql_query(""update resources set name='{$_POST[name]}', units='{$_POST[units]}', price='{$_POST[price]}' where id='{$_POST[id]}'"");
+        }
+        header(""Location: ./?action=resources&id=$_POST[id]"");
+        break;
+    case ""del_resource"":
+        if (checkskey($_POST[id])) {
+            seveLog(""resources"");
+            mysql_query(""delete from resources where id='$_POST[id]'"");
+        }
+        header(""Location: ./?action=resources&id=$_POST[id]"");
+        break;
+    case ""create_service_task"":
+        if (checkskey()) {
+            $_POST[content] = addslashes($_POST[content]);
+            while (list($key, $val) = each($_POST[responce_2])) {
+                $responce_2 .= ""$val,"";
+            }
+            $responce_2 = substr($responce_2, 0, -1);
+            $_POST[request_id] = ($_POST[request_id] ? $_POST[request_id] : 0);
+            $sql = ""insert service_task (created, service_type, equipment_id, responce, responce_2, request_id, creator, date_plan, hours_plan, content, status) values (
+                       now(), '{$_POST[service_type]}', '{$_POST[equipment_id]}', '{$_POST[responce]}', '{$responce_2}', '{$_POST[request_id]}', '{$userData[id]}', '{$_POST[date]} {$_POST[time]}', '{$_POST[hours_plan]}', '{$_POST[content]}', "" . ($_POST[status] ? 1 : 0) . "")"";
+            mysql_query($sql);
+            // echo $sql;
+            // exit;
+        }
+        header(""Location: ./?action=service_request_list&id=$_POST[request_id]"");
+        break;

-               case 'cancel_task':
-               mysql_query(""update service_task set status='"".ST_CANCEL.""' where id='{$_POST[id]}'"");
-               header(""Location: ./?action=service_task_list&id=$_POST[id]"");
-               break;
-               case 'move_task':
-               mysql_query(""update service_task set date_plan='{$_POST[task_new_time]}' where id='{$_POST[id]}'"");
-               header(""Location: ./?action=service_task_shedule&date=$_POST[date]"");
-               break;
-               case ""update_service_task"":
-               if (checkskey()) {
-                       $_POST[content] = addslashes($_POST[content]);
-                       while (list($key, $val) = each($_POST[responce_2])) {
-                               $responce_2 .= ""$val,"";
-                       }
-                       $responce_2 = substr($responce_2,0,-1);
-                       $sql = ""update service_task set created=now(), status='"".($_POST[status] ? 1 : 0).""', service_type='{$_POST[service_type]}', equipment_id='{$_POST[equipment_id]}', responce='{$_POST[responce]}', responce_2='{$responce_2}', creator='{$userData[id]}', date_plan='{$_POST[date]} {$_POST[time]}', hours_plan='{$_POST[hours_plan]}', content='{$_POST[content]}' where id='{$_POST[id]}'"";
-                       mysql_query($sql);
-               }
-               header(""Location: ./?action=service_task_list&id=$_POST[id]"");
-               break;
+    case 'cancel_task':
+        mysql_query(""update service_task set status='"" . ST_CANCEL . ""' where id='{$_POST[id]}'"");
+        header(""Location: ./?action=service_task_list&id=$_POST[id]"");
+        break;
+    case 'move_task':
+        mysql_query(""update service_task set date_plan='{$_POST[task_new_time]}' where id='{$_POST[id]}'"");
+        header(""Location: ./?action=service_task_shedule&date=$_POST[date]"");
+        break;
+    case ""update_service_task"":
+        if (checkskey()) {
+            $_POST[content] = addslashes($_POST[content]);
+            while (list($key, $val) = each($_POST[responce_2])) {
+                $responce_2 .= ""$val,"";
+            }
+            $responce_2 = substr($responce_2, 0, -1);
+            $sql = ""update service_task set created=now(), status='"" . ($_POST[status] ? 1 : 0) . ""', service_type='{$_POST[service_type]}', equipment_id='{$_POST[equipment_id]}', responce='{$_POST[responce]}', responce_2='{$responce_2}', creator='{$userData[id]}', date_plan='{$_POST[date]} {$_POST[time]}', hours_plan='{$_POST[hours_plan]}', content='{$_POST[content]}' where id='{$_POST[id]}'"";
+            mysql_query($sql);
+        }
+        header(""Location: ./?action=service_task_list&id=$_POST[id]"");
+        break;

-               case 'del_task':
-               if (checkskey($_POST[id])) {
-                       mysql_query(""delete from service_task where id='{$_POST[id]}'"");
-               }
-               header(""Location: ./?action=service_task_list&id=$_POST[id]"");
-               break;
+    case 'del_task':
+        if (checkskey($_POST[id])) {
+            mysql_query(""delete from service_task where id='{$_POST[id]}'"");
+        }
+        header(""Location: ./?action=service_task_list&id=$_POST[id]"");
+        break;

-               case 'accept_service_task':
-               $autoclose =  implode(',', array_keys($_POST[autoclose]));
-               if (checkskey()) {
-                       mysql_query(""update service_task set accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id={$_POST[id]}"");
+    case 'accept_service_task':
+        $autoclose = implode(',', array_keys($_POST[autoclose]));
+        if (checkskey()) {
+            mysql_query(""update service_task set accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id={$_POST[id]}"");

-                       // $res = mysql_query(""select id from service_task where responce_2='' and accept_date is NULL and request_id in (select request_id from service_task where id={$_POST[id]}) "");
-                       // if ($res and mysql_num_rows($res)>0) {
-                       //               while ($r = mysql_fetch_assoc($res)) {
-                       //                       $ids .= $r[id]."","";
-                       //               }
-                       //               $ids = substr($ids, 0, -1);
-                       //               mysql_query(""update service_task set accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id in ($ids)"");
-                       // }
-                       mysql_query(""update service_task set finished=now(), finisher='{$userData[id]}', accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id in ($autoclose)"");
-               }
-               header(""Location: ./?action=service_task_list&id=$_POST[id]"");
-               break;
+            // $res = mysql_query(""select id from service_task where responce_2='' and accept_date is NULL and request_id in (select request_id from service_task where id={$_POST[id]}) "");
+            // if ($res and mysql_num_rows($res)>0) {
+            //                  while ($r = mysql_fetch_assoc($res)) {
+            //                          $ids .= $r[id]."","";
+            //                  }
+            //                  $ids = substr($ids, 0, -1);
+            //                  mysql_query(""update service_task set accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id in ($ids)"");
+            // }
+            mysql_query(""update service_task set finished=now(), finisher='{$userData[id]}', accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id in ($autoclose)"");
+        }
+        header(""Location: ./?action=service_task_list&id=$_POST[id]"");
+        break;

-               case ""decline_service_request"":
-               mysql_query(""update service_request set status=10 where id='{$_POST[id]}'"");
-               header(""Location: ./?action=service_request_list&id=$_POST[id]"");
-               break;
-               case ""update_notifications"":
-                       if ($_POST[message]) {
-                               mysql_query(""replace into notifications_button_message (status, message, n_type) values ('{$_POST[status]}', '{$_POST[message]}', '{$_POST[n_type]}') "");
-                               mysql_query(""delete from notifications_button_user where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
+    case ""decline_service_request"":
+        mysql_query(""update service_request set status=10 where id='{$_POST[id]}'"");
+        header(""Location: ./?action=service_request_list&id=$_POST[id]"");
+        break;
+    case ""update_notifications"":
+        if ($_POST[message]) {
+            mysql_query(""replace into notifications_button_message (status, message, n_type) values ('{$_POST[status]}', '{$_POST[message]}', '{$_POST[n_type]}') "");
+            mysql_query(""delete from notifications_button_user where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");

-                               while (list($key, $val) = each($_POST[users])) {
-                                       echo ""insert notifications_button_user (status, user, n_type) values ('{$_POST[status]}', '{$val}', '{$_POST[n_type]}')"";
-                                       mysql_query(""insert notifications_button_user (status, user, n_type) values ('{$_POST[status]}', '{$val}', '{$_POST[n_type]}')"");
-                               }
-                       } else {
-                               mysql_query(""delete from notifications_button_message where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
-                               mysql_query(""delete from notifications_button_user where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
-                       }
-                       header(""Location: ./?action=notifications&status=$_POST[status]&n_type=$_POST[n_type]"");
-                       break;
-                       case ""del_device"": // удаление устройства
-                       if (checkskey($_POST[id])) {
-                seveLog(""devices"");
-                $device_id = (int)$_POST['id'];
-                $Devices = new Devices();
-                $Devices->delete(array('id'=>$device_id));
-                /*
-                $Devices_read = $Devices->read(array('id'=>$device_id));
-                //var_dump($Devices_read);die;
-                if (!empty($Devices_read)) {
-                    $device_serial = $Devices_read[0]['serialNumber'];
-                    $DeviceSettingsStorage = new DeviceSettingsStorage();
-                    $DeviceSettingsStorage->delete(array('device_id'=>$device_serial));
-                    $DeviceSettingsCurrent = new DeviceSettingsCurrent();
-                    $DeviceSettingsCurrent->delete(array('device_id'=>$device_serial));
+            while (list($key, $val) = each($_POST[users])) {
+                echo ""insert notifications_button_user (status, user, n_type) values ('{$_POST[status]}', '{$val}', '{$_POST[n_type]}')"";
+                mysql_query(""insert notifications_button_user (status, user, n_type) values ('{$_POST[status]}', '{$val}', '{$_POST[n_type]}')"");
+            }
+        } else {
+            mysql_query(""delete from notifications_button_message where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
+            mysql_query(""delete from notifications_button_user where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
+        }
+        header(""Location: ./?action=notifications&status=$_POST[status]&n_type=$_POST[n_type]"");
+        break;
+    case ""del_device"": // удаление устройства
+        if (checkskey($_POST[id])) {
+            seveLog(""devices"");
+            $device_id = (int)$_POST['id'];
+            $Devices = new Devices();
+            $Devices->delete(array('id' => $device_id));
+            /*
+            $Devices_read = $Devices->read(array('id'=>$device_id));
+            //var_dump($Devices_read);die;
+            if (!empty($Devices_read)) {
+                $device_serial = $Devices_read[0]['serialNumber'];
+                $DeviceSettingsStorage = new DeviceSettingsStorage();
+                $DeviceSettingsStorage->delete(array('device_id'=>$device_serial));
+                $DeviceSettingsCurrent = new DeviceSettingsCurrent();
+                $DeviceSettingsCurrent->delete(array('device_id'=>$device_serial));
+            }
+
+            //mysql_query(""delete from devices where id='{$_POST[id]}'"");
+            $sql = 'delete from devices where id='.$device_id;
+            mysql_query($sql);
+            $res = mysql_query(""select * from sensors where device_id='$_POST[id]' order by channel"");
+            if ($res and mysql_num_rows($res)>0) {
+                while ($r = mysql_fetch_assoc($res)) {
+                    mysql_query(""delete from equipment_sensors where sensor_id='{$r[id]}'"");
                 }
+            }
+            //mysql_query(""delete from sensors where device_id='{$_POST[id]}'"");
+            $sql = 'delete from sensors where device_id='.$device_id;
+            mysql_query($sql);
+            */
+        }
+        header(""Location: ./?action=devices"");
+        break;
+    case ""del_arm"": // удаление устройства
+        if (checkskey($_POST[id])) {
+            seveLog(""arm"");
+            mysql_query(""delete from arm where id='{$_POST[id]}'"");
+        }
+        header(""Location: ./?action=arm"");
+        break;
+    case ""add_arm"":
+        if (checkskey()) {
+            seveLog(""arm"");
+            if ($_POST['is_virtual']) {
+                $v_link = md5($_POST[serial] . """" . time());
+            }
+            $sql = ""insert arm (name, serial, widget1, widget2, widget3, widget4, screensaver, rele, publish, is_virtual, virtual_link, info_screen) values ('$_POST[name]', '$_POST[serial]', '$_POST[widget1]', '$_POST[widget2]', '$_POST[widget3]', '$_POST[widget4]', '"" . ($_POST[screensaver] ? 1 : 0) . ""', '"" . ($_POST[rele] ? 1 : 0) . ""', '"" . ($_POST[publish] ? 1 : 0) . ""', '"" . ($_POST['is_virtual'] ? 1 : 0) . ""', '{$v_link}', '{$_POST['info_screen']}')"";
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=arm&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=arm&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=arm"");
+        }
+        break;

-                //mysql_query(""delete from devices where id='{$_POST[id]}'"");
-                $sql = 'delete from devices where id='.$device_id;
-                mysql_query($sql);
-                $res = mysql_query(""select * from sensors where device_id='$_POST[id]' order by channel"");
-                if ($res and mysql_num_rows($res)>0) {
-                    while ($r = mysql_fetch_assoc($res)) {
-                        mysql_query(""delete from equipment_sensors where sensor_id='{$r[id]}'"");
+    case ""update_arm"":
+        if (checkskey($_POST[id])) {
+            seveLog(""arm"");
+            $sql = ""update arm set info_screen='{$_POST['info_screen']}', name='$_POST[name]', serial='$_POST[serial]', widget1='$_POST[widget1]', widget2='$_POST[widget2]', widget3='$_POST[widget3]', widget4='$_POST[widget4]', screensaver='"" . ($_POST[screensaver] ? 1 : 0) . ""', rele='"" . ($_POST[rele] ? 1 : 0) . ""', publish='"" . ($_POST[publish] ? 1 : 0) . ""' where id='{$_POST[id]}'"";
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=arm&id={$_POST[id]}&msg=1"");
+            } else {
+                header(""Location: ./?action=arm&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=arm"");
+        }
+        break;
+    case ""add_device"": // добавление нового устройства
+        if (checkskey()) {
+            seveLog(""devices"");
+            $sql = ""INSERT devices (title, serialNumber, publish, equipment_id, discrete, is_dhcp, ip, mac, netmask, gw, time_zone, host, debug_cmd)
+                               VALUES ('$_POST[title]', '$_POST[serialNumber]', '"" . ($_POST[publish] ? 1 : 0) . ""', '$_POST[newequipment]', '$_POST[newdiscrete]', '"" . ($_POST[is_dhcp] ? 1 : 0) . ""', '$_POST[ip]', '$_POST[mac]', '$_POST[netmask]', '$_POST[gw]', '$_POST[time_zone]', '$_POST[host]', '$_POST[debug_cmd]')"";
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[sensor] as $k => $v) {
+                    $_POST[sensor_type][$k] = ($_POST[sensor_type][$k] ? $_POST[sensor_type][$k] : 1);
+                    $_POST[discret_ch][$k] = ($_POST[discret_ch][$k] ? $_POST[discret_ch][$k] : 15);
+                    $_POST[channel][$k] = ($_POST[channel][$k] ? $_POST[channel][$k] : 0);
+                    $sql = ""insert sensors (title, channel, sensor_type, device_id, discrete, measure, max_value, divider) values ('$v', '"" . ($_POST[channel][$k] * 1) . ""', '"" . ($_POST[sensor_type][$k] * 1) . ""', '$id', '"" . $_POST[discret_ch][$k] . ""', '"" . $_POST[measure][$k] . ""', '"" . $_POST['max_value'][$k] . ""', '"" . str_replace(',', '.', $_POST[divider][$k]) . ""')"";
+                    echo $sql;
+                    mysql_query($sql);
+                    $sensor_id = mysql_insert_id();
+                    if ($_POST['equipments'][$k]) {
+                        // Добавляем связь с оборудованими
+                        Sensor::bindEquipment($sensor_id, $_POST['equipments'][$k]);
                     }
                 }
-                //mysql_query(""delete from sensors where device_id='{$_POST[id]}'"");
-                $sql = 'delete from sensors where device_id='.$device_id;
-                mysql_query($sql);
-                */
-                       }
-                       header(""Location: ./?action=devices"");
-                       break;
-                       case ""del_arm"": // удаление устройства
-                       if (checkskey($_POST[id])) {
-                               seveLog(""arm"");
-                               mysql_query(""delete from arm where id='{$_POST[id]}'"");
-                       }
-                       header(""Location: ./?action=arm"");
-                       break;
-                       case ""add_arm"":
-                       if (checkskey()) {
-                               seveLog(""arm"");
-                               if ($_POST['is_virtual']) {
-                                       $v_link = md5($_POST[serial]."""".time());
-                               }
-                               $sql = ""insert arm (name, serial, widget1, widget2, widget3, widget4, screensaver, rele, publish, is_virtual, virtual_link, info_screen) values ('$_POST[name]', '$_POST[serial]', '$_POST[widget1]', '$_POST[widget2]', '$_POST[widget3]', '$_POST[widget4]', '"".($_POST[screensaver] ? 1 : 0).""', '"".($_POST[rele] ? 1 : 0).""', '"".($_POST[publish] ? 1 : 0).""', '"".($_POST['is_virtual'] ? 1 : 0).""', '{$v_link}', '{$_POST['info_screen']}')"";
-                               $res = mysql_query($sql);
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       $id = mysql_insert_id();
-                                       header(""Location: ./?action=arm&id={$id}&msg=1"");
-                               } else {
-                                       header(""Location: ./?action=arm&msg=2"");
-                               }
-                       } else {
-                               header(""Location: ./?action=arm"");
-                       }
-                       break;

-                       case ""update_arm"":
-                       if (checkskey($_POST[id])) {
-                               seveLog(""arm"");
-                               $sql = ""update arm set info_screen='{$_POST['info_screen']}', name='$_POST[name]', serial='$_POST[serial]', widget1='$_POST[widget1]', widget2='$_POST[widget2]', widget3='$_POST[widget3]', widget4='$_POST[widget4]', screensaver='"".($_POST[screensaver] ? 1 : 0).""', rele='"".($_POST[rele] ? 1 : 0).""', publish='"".($_POST[publish] ? 1 : 0).""' where id='{$_POST[id]}'"";
-                               $res = mysql_query($sql);
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       header(""Location: ./?action=arm&id={$_POST[id]}&msg=1"");
-                               } else {
-                                       header(""Location: ./?action=arm&msg=2"");
-                               }
-                       } else {
-                               header(""Location: ./?action=arm"");
-                       }
-                       break;
-                       case ""add_device"": // добавление нового устройства
-                       if (checkskey()) {
-                               seveLog(""devices"");
-                               $sql = ""INSERT devices (title, serialNumber, publish, equipment_id, discrete, is_dhcp, ip, mac, netmask, gw, time_zone, host, debug_cmd)
-                               VALUES ('$_POST[title]', '$_POST[serialNumber]', '"".($_POST[publish] ? 1 : 0).""', '$_POST[newequipment]', '$_POST[newdiscrete]', '"".($_POST[is_dhcp] ? 1 : 0).""', '$_POST[ip]', '$_POST[mac]', '$_POST[netmask]', '$_POST[gw]', '$_POST[time_zone]', '$_POST[host]', '$_POST[debug_cmd]')"";
-                               $res = mysql_query($sql);
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       $id = mysql_insert_id();
-                                       foreach($_POST[sensor] as $k => $v){
-                                               $_POST[sensor_type][$k] = ($_POST[sensor_type][$k] ? $_POST[sensor_type][$k] : 1);
-                                               $_POST[discret_ch][$k] = ($_POST[discret_ch][$k] ? $_POST[discret_ch][$k] : 15);
-                                               $_POST[channel][$k] = ($_POST[channel][$k] ? $_POST[channel][$k] : 0);
-                                               $sql = ""insert sensors (title, channel, sensor_type, device_id, discrete, measure, max_value, divider) values ('$v', '"".($_POST[channel][$k]*1).""', '"".($_POST[sensor_type][$k]*1).""', '$id', '"".$_POST[discret_ch][$k].""', '"".$_POST[measure][$k].""', '"".$_POST['max_value'][$k].""', '"".str_replace(',','.',$_POST[divider][$k]).""')"";
-                                               echo $sql;
-                                               mysql_query($sql);
-                                               $sensor_id = mysql_insert_id();
-                                               if ($_POST['equipments'][$k]) {
-                                                       // Добавляем связь с оборудованими
-                                                       Sensor::bindEquipment($sensor_id, $_POST['equipments'][$k]);
-                                               }
-                                       }
+                // Ответственные
+                foreach ($_POST['users'] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert users_notify (user_id, device_id) values ('$v', '$id')"");
+                }

-                                       // Ответственные
-                                       foreach($_POST['users'] as $k => $v){
-                                               // записываем новые роли
-                                               mysql_query(""insert users_notify (user_id, device_id) values ('$v', '$id')"");
-                                       }
+                // создаем таблицы для записи данных
+                // DESCRIBE `z_device_2`
+                // ALTER TABLE `z_device_1` CHANGE `data` `data` FLOAT(7,2) NOT NULL;
+                mysql_query(""CREATE TABLE IF NOT EXISTS `z_device_$id` (  `timestamp` datetime NOT NULL,  `sensor` tinyint(1) unsigned NOT NULL,  `data` float(7,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;"");
+                mysql_query(""CREATE TABLE IF NOT EXISTS `z_device_$id"" . ""_arc` (  `timestamp` datetime NOT NULL,  `sensor` tinyint(1) unsigned NOT NULL,  `data` float(7,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;"");
+                mysql_query(""ALTER TABLE `z_device_$id` ADD UNIQUE KEY `timestamp` (`timestamp`,`sensor`)"");
+                header(""Location: ./?action=devices&msg=1&id=$id&$k"");

-                                       // создаем таблицы для записи данных
-                                       // DESCRIBE `z_device_2`
-                                       // ALTER TABLE `z_device_1` CHANGE `data` `data` FLOAT(7,2) NOT NULL;
-                                       mysql_query(""CREATE TABLE IF NOT EXISTS `z_device_$id` (  `timestamp` datetime NOT NULL,  `sensor` tinyint(1) unsigned NOT NULL,  `data` float(7,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;"");
-                                       mysql_query(""CREATE TABLE IF NOT EXISTS `z_device_$id"".""_arc` (  `timestamp` datetime NOT NULL,  `sensor` tinyint(1) unsigned NOT NULL,  `data` float(7,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;"");
-                                       mysql_query(""ALTER TABLE `z_device_$id` ADD UNIQUE KEY `timestamp` (`timestamp`,`sensor`)"");
-                                       header(""Location: ./?action=devices&msg=1&id=$id&$k"");
-                               } else {
-                                       header(""Location: ./?action=devices&msg=2&$k"");
-                               }
-                       }
-                       break;
-                       case ""update_device"": // изменение параметров устройства
-                       if (checkskey($_POST['id'])) {
-                               seveLog(""devices"");
-                               $deviseData = Device::getOne($_POST['id']);
-                               $modif = $deviseData['modified']; // текущее значение ""изменены ли данные""
-                               $modif_data = false; // изменены ли основные данные
-                               $modif_sensors = false; // изменены ли сенсоры
-                               $modif_data_and_sensors = false; // изменены и основные данные и сенсоры
+                // Начало создания записи о гарантии на устройство
+                /** @var ModelDBT_DeviceWarranty $deviceWarranty */
+                $deviceWarranty = QCGA::API3()->objectFactory('ModelDBT_DeviceWarranty');
+                $deviceWarranty->createForCurrentCustomer($_POST['serialNumber']);
+                // Конец создания записи о гарантии на устройство
+            } else {
+                header(""Location: ./?action=devices&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_device"": // изменение параметров устройства
+        if (checkskey($_POST['id'])) {
+            seveLog(""devices"");
+            $deviseData = Device::getOne($_POST['id']);
+            $modif = $deviseData['modified']; // текущее значение ""изменены ли данные""
+            $modif_data = false; // изменены ли основные данные
+            $modif_sensors = false; // изменены ли сенсоры
+            $modif_data_and_sensors = false; // изменены и основные данные и сенсоры

-                               // Проверяем на изменение основных данных
-                               if (
-                                       $_POST['title'] != $deviseData['title'] ||
-                                       $_POST['serialNumber'] != $deviseData['serialNumber'] ||
-                                       $_POST['publish'] != $deviseData['publish'] ||
-                                       $_POST['discrete'] != $deviseData['discrete'] ||
-                                       $_POST['is_dhcp'] != $deviseData['is_dhcp'] ||
-                                       $_POST['ip'] != $deviseData['ip'] ||
-                                       $_POST['mac'] != $deviseData['mac'] ||
-                                       $_POST['netmask'] != $deviseData['netmask'] ||
-                                       $_POST['gw'] != $deviseData['gw'] ||
-                                       $_POST['time_zone'] != $deviseData['time_zone'] ||
-                                       $_POST['host'] != $deviseData['host'] ||
-                                       $_POST['debug_cmd'] != $deviseData['debug_cmd']
-                               ) {
-                                       $modif_data = true;
-                               }
+            // Проверяем на изменение основных данных
+            if (
+                $_POST['title'] != $deviseData['title'] ||
+                $_POST['serialNumber'] != $deviseData['serialNumber'] ||
+                $_POST['publish'] != $deviseData['publish'] ||
+                $_POST['discrete'] != $deviseData['discrete'] ||
+                $_POST['is_dhcp'] != $deviseData['is_dhcp'] ||
+                $_POST['ip'] != $deviseData['ip'] ||
+                $_POST['mac'] != $deviseData['mac'] ||
+                $_POST['netmask'] != $deviseData['netmask'] ||
+                $_POST['gw'] != $deviseData['gw'] ||
+                $_POST['time_zone'] != $deviseData['time_zone'] ||
+                $_POST['host'] != $deviseData['host'] ||
+                $_POST['debug_cmd'] != $deviseData['debug_cmd']
+            ) {
+                $modif_data = true;
+            }

-                               $sql = ""UPDATE devices
+            $sql = ""UPDATE devices
                                SET
                                modified='$modif',
                                discrete='$_POST[discrete]',
                                title='$_POST[title]',
                                serialNumber='$_POST[serialNumber]',
-                               publish='"".($_POST[publish] ? 1 : 0).""',
-                               is_dhcp='"".($_POST[is_dhcp] ? 1 : 0).""',
+                               publish='"" . ($_POST[publish] ? 1 : 0) . ""',
+                               is_dhcp='"" . ($_POST[is_dhcp] ? 1 : 0) . ""',
                                ip = '$_POST[ip]',
                                mac = '$_POST[mac]',
                                netmask = '$_POST[netmask]',
@@ -701,916 +708,925 @@ switch ($_POST[action]) {
                                host = '$_POST[host]',
                                debug_cmd = '$_POST[debug_cmd]'
                                WHERE id='$_POST[id]'"";
-                               $res = mysql_query($sql);
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       mysql_query(""update devices set equipment_id=0 where equipment_id='$_POST[equipment]' and id<>'$_POST[id]'"");
-                               }
-                               $mdf = 0;
-                               foreach($_POST['sensor'] as $k => $v) {
-                                       $sensorId = $k;
-                                       $sensorName = trim($v);
-                                       $sensorChannel = (int) trim($_POST['channel'][$sensorId]);
-                                       $hasSensorData = ($sensorName && $sensorChannel);
-                                       $_POST[sensor_type][$k] = ($_POST[sensor_type][$k] ? $_POST[sensor_type][$k] : 1);
-                                       $_POST[discret_ch][$k] = ($_POST[discret_ch][$k] ? $_POST[discret_ch][$k] : 15);
-                                       $_POST[channel][$k] = ($_POST[channel][$k] ? $_POST[channel][$k] : 0);
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""update devices set equipment_id=0 where equipment_id='$_POST[equipment]' and id<>'$_POST[id]'"");
+            }
+            $mdf = 0;
+            foreach ($_POST['sensor'] as $k => $v) {
+                $sensorId = $k;
+                $sensorName = trim($v);
+                $sensorChannel = (int)trim($_POST['channel'][$sensorId]);
+                $hasSensorData = ($sensorName && $sensorChannel);
+                $_POST[sensor_type][$k] = ($_POST[sensor_type][$k] ? $_POST[sensor_type][$k] : 1);
+                $_POST[discret_ch][$k] = ($_POST[discret_ch][$k] ? $_POST[discret_ch][$k] : 15);
+                $_POST[channel][$k] = ($_POST[channel][$k] ? $_POST[channel][$k] : 0);

-                                       if ($sensorId > 0) {
+                if ($sensorId > 0) {

-                                               // изменяем данные существующих датчиков
-                                               $sql = ""update sensors set divider='"".str_replace(',','.',$_POST[divider][$k]).""', measure='"".$_POST[measure][$k].""', discrete='"".$_POST[discret_ch][$k].""', title='$v', channel='"".$_POST[channel][$k].""', sensor_type='"".$_POST[sensor_type][$k].""', max_value='"".$_POST['max_value'][$k].""' where id='$k'"";
-                                               //echo $sql;
-                                               mysql_query($sql);
-                                               if (mysql_affected_rows()) {
-                                                       /*if ($_POST[sensor_type][$k] == $releTypeID) {
-                                                       $modif = $modif | MODIFIED_RELE; // изменилось значение реле
-                                               } else {
-                                               $modif = $modif | MODIFIED_CHANNELS; // изменилось значение дискретности опроса оборудования дитчиком
-                                       }*/
-                                       $mdf = 1;
-                                       $modif_sensors = true;
-                               }
-                       } else if ($hasSensorData) {
-                               // добавляем новые датчики, если они есть
-                               $sql = ""insert sensors (title, channel, sensor_type, device_id, equipment_id, discrete, measure, divider, max_value)
-                               values ('$sensorName', '$sensorChannel', '"".($_POST[sensor_type][$k]*1).""', '$_POST[id]', '"".$_POST['equipments'][ $k ][0].""', '"".$_POST[discret_ch][$k].""', '"".$_POST[measure][$k].""', '"".$_POST[divider][$k].""', '"".$_POST['max_value'][$k].""')"";
-                               // print_r($_POST);
-                               // echo $sql;
-                               // exit;
-                               mysql_query($sql);
-                               /*if ($_POST[sensor_type][$k] == $releTypeID) {
-                               $modif = $modif | MODIFIED_RELE;
-                       } else {
-                       $modif = $modif | MODIFIED_CHANNELS;
-               }*/
-               $mdf = 2;
-               $modif_sensors = true;
-               $sensorId = mysql_insert_id(); // ID добавленного датчика
-       }
+                    // изменяем данные существующих датчиков
+                    $sql = ""update sensors set divider='"" . str_replace(',', '.', $_POST[divider][$k]) . ""', measure='"" . $_POST[measure][$k] . ""', discrete='"" . $_POST[discret_ch][$k] . ""', title='$v', channel='"" . $_POST[channel][$k] . ""', sensor_type='"" . $_POST[sensor_type][$k] . ""', max_value='"" . $_POST['max_value'][$k] . ""' where id='$k'"";
+                    //echo $sql;
+                    mysql_query($sql);
+                    if (mysql_affected_rows()) {
+                        /*if ($_POST[sensor_type][$k] == $releTypeID) {
+                        $modif = $modif | MODIFIED_RELE; // изменилось значение реле
+                    } else {
+                    $modif = $modif | MODIFIED_CHANNELS; // изменилось значение дискретности опроса оборудования дитчиком
+                }*/
+                        $mdf = 1;
+                        $modif_sensors = true;
+                    }
+                } else if ($hasSensorData) {
+                    // добавляем новые датчики, если они есть
+                    $sql = ""insert sensors (title, channel, sensor_type, device_id, equipment_id, discrete, measure, divider, max_value)
+                               values ('$sensorName', '$sensorChannel', '"" . ($_POST[sensor_type][$k] * 1) . ""', '$_POST[id]', '"" . $_POST['equipments'][$k][0] . ""', '"" . $_POST[discret_ch][$k] . ""', '"" . $_POST[measure][$k] . ""', '"" . $_POST[divider][$k] . ""', '"" . $_POST['max_value'][$k] . ""')"";
+                    // print_r($_POST);
+                    // echo $sql;
+                    // exit;
+                    mysql_query($sql);
+                    /*if ($_POST[sensor_type][$k] == $releTypeID) {
+                    $modif = $modif | MODIFIED_RELE;
+                } else {
+                $modif = $modif | MODIFIED_CHANNELS;
+            }*/
+                    $mdf = 2;
+                    $modif_sensors = true;
+                    $sensorId = mysql_insert_id(); // ID добавленного датчика
+                }

-       if (!$sensorId) {
-               continue;
-       }
+                if (!$sensorId) {
+                    continue;
+                }

-       if ($hasSensorData) {
-               // Добавляем связь с оборудованими
-               Sensor::bindEquipment($sensorId, $_POST['equipments'][$k]);
-       } else {
-               Sensor::deleteOne($sensorId); // удаляем не нужные датчики
-               Sensor::unbindEquipment($sensorId); // удаляем связь с оборудованиями
-               $modif_sensors = true;
-       }
-}
-// Cтавим признаки измененных данных
-if (!$modif && ($modif_data || $modif_sensors)) {
-       if ($modif_data && $modif_sensors) {
-               $modif = MODIFIED_DEVICE_AND_SENSORS_DATA;
-       } else {
-               if ($modif_data) {
-                       $modif = MODIFIED_DEVICE_DATA;
-               } else {
-                       $modif = MODIFIED_SENSORS_DATA;
-               }
-       }
-       mysql_query(""update devices set modified='$modif' where id='$_POST[id]'"");
-}
+                if ($hasSensorData) {
+                    // Добавляем связь с оборудованими
+                    Sensor::bindEquipment($sensorId, $_POST['equipments'][$k]);
+                } else {
+                    Sensor::deleteOne($sensorId); // удаляем не нужные датчики
+                    Sensor::unbindEquipment($sensorId); // удаляем связь с оборудованиями
+                    $modif_sensors = true;
+                }
+            }
+            // Cтавим признаки измененных данных
+            if (!$modif && ($modif_data || $modif_sensors)) {
+                if ($modif_data && $modif_sensors) {
+                    $modif = MODIFIED_DEVICE_AND_SENSORS_DATA;
+                } else {
+                    if ($modif_data) {
+                        $modif = MODIFIED_DEVICE_DATA;
+                    } else {
+                        $modif = MODIFIED_SENSORS_DATA;
+                    }
+                }
+                mysql_query(""update devices set modified='$modif' where id='$_POST[id]'"");
+            }

-// Ответственные
-mysql_query(""delete from users_notify where device_id='$_POST[id]'"");
-foreach($_POST['users'] as $k => $v){
-       // записываем новые роли
-       mysql_query(""insert users_notify (user_id, device_id) values ('$v', '$_POST[id]')"");
-}
-//exit;
-header(""Location: ./?action=devices&msg=1&id=$_POST[id]&"".($mdf));
-}
-break;
-case ""upload_plan"": // загрузка картинки с планом помещения
-move_uploaded_file($_FILES[""myfile""][""tmp_name""],""plan/{$customer['planpath']}/"".$_POST[upid]."".png"");
-header(""Location: ./?action=departments&msg=1&id=$_POST[id]"");
-break;
-case ""update_department"": // изменение данных опомещении
-if (checkskey($_POST[id])) {
-       $res = mysql_query(""update departments set camera='$_POST[camera]', name='$_POST[name]', publish='"".($_POST[publish] ? 1 : 0).""' where id='$_POST[id]'"");
-       $k = mysql_affected_rows();
-       if ($res and $k>-1) {
-               header(""Location: ./?action=departments&msg=1&id=$_POST[id]"");
-       } else {
-               header(""Location: ./?action=departments&msg=2&id=$_POST[id]"");
-       }
-}
-break;
-case ""add_department"": // добавление нового помещения
-if (checkskey('')) {
-       $res = mysql_query(""insert departments (name, publish, camera) values ('$_POST[name]', '"".($_POST[publish] ? 1 : 0).""', '$_POST[camera]')"");
-       $k = mysql_affected_rows();
-       if ($res and $k>-1) {
-               $id = mysql_insert_id();
-               header(""Location: ./?action=departments&msg=1&id=$id&$k"");
-       } else {
-               header(""Location: ./?action=departments&msg=2&$k"");
-       }
-}
-break;
-case ""update_user"": // изменение данных пользователя
-if (checkskey($_POST[id])) {
-       seveLog(""users"");
-       $res = mysql_query(""update users set "".($_POST[password] ? "" passwd='"".md5($_POST[password]).""', "" : """")."" telegram_id='$_POST[telegram_id]', name='$_POST[name]', notification_link='$_POST[notification_link]', fname='$_POST[fname]', email='$_POST[email]', publish='"".($_POST[publish] ? 1 : 0).""' where id='$_POST[id]'"");
-       $k = mysql_affected_rows();
-       if ($res and $k>-1) {
-               mysql_query(""delete from user_role where userID='$_POST[id]'"");
-               foreach($_POST[role] as $k => $v){
-                       mysql_query(""insert user_role (userID, role) values ('$_POST[id]', '$v')"");
-               }
-               mysql_query(""delete from users_email_reports where user_id='$_POST[id]'"");
-               foreach($_POST[users_email_reports] as $k => $v){
-                       mysql_query(""insert users_email_reports (user_id, report_slug) values ('$_POST[id]', '$v')"");
-               }
-               header(""Location: ./?action=users&msg=1&id=$_POST[id]"");
-       } else {
-               header(""Location: ./?action=users&msg=2&id=$_POST[id]"");
-       }
-}
-break;
-case ""add_user"": // добавление нового пользователя
-if (checkskey('')) {
-       seveLog(""users"");
-       $res = mysql_query(""insert users (name, fname, email, publish, passwd, notification_link, telegram_id) values ('$_POST[name]', '$_POST[fname]', '$_POST[email]', '"".($_POST[publish] ? 1 : 0).""', '"".md5($_POST[password]).""', '$_POST[notification_link]', '$_POST[telegram_id]')"");
-       $k = mysql_affected_rows();
-       if ($res and $k>-1) {
-               $id = mysql_insert_id();
-               foreach($_POST[role] as $k => $v){
-                       mysql_query(""insert user_role (userID, role) values ('$id', '$v')"");
-               }
-               foreach($_POST[users_email_reports] as $k => $v){
-                       mysql_query(""insert users_email_reports (user_id, report_slug) values ('$id', '$v')"");
-               }
-               header(""Location: ./?action=users&msg=1&id=$id&$k"");
-       } else {
-               header(""Location: ./?action=users&msg=2&$k"");
-       }
-}
-break;
-case ""del_user"":
-if (checkskey($_POST[id])) {
-       seveLog(""users"");
-       mysql_query(""delete from users WHERE id='$_POST[id]'"");
-       header(""Location: ./?action=users"");
-}
-break;
-case ""update_employee"": // изменение данных сотрудника
-$msg = 1;
-$res = mysql_query(""select * from employees where pin='{$_POST[pin]}'"");
-if ($_POST[pin] and $res and mysql_num_rows($res)>0) {
-       while ($r = mysql_fetch_assoc($res)) {
-               $msg = 3;
-       }
-}
-if (checkskey($_POST['id'])) {
-       seveLog(""employees"");
-       $res = mysql_query(""UPDATE employees
+            // Начало создания записи о гарантии на устройство
+            // Когда серийный номер устройства изменяется, предполагается, что это теперь другое устройство.
+            if ($_POST['serialNumber'] !== $deviseData['serialNumber']) {
+                /** @var ModelDBT_DeviceWarranty $deviceWarranty */
+                $deviceWarranty = QCGA::API3()->objectFactory('ModelDBT_DeviceWarranty');
+                $deviceWarranty->createForCurrentCustomer($_POST['serialNumber']);
+            }
+            // Конец создания записи о гарантии на устройство
+
+            // Ответственные
+            mysql_query(""delete from users_notify where device_id='$_POST[id]'"");
+            foreach ($_POST['users'] as $k => $v) {
+                // записываем новые роли
+                mysql_query(""insert users_notify (user_id, device_id) values ('$v', '$_POST[id]')"");
+            }
+            //exit;
+            header(""Location: ./?action=devices&msg=1&id=$_POST[id]&"" . ($mdf));
+        }
+        break;
+    case ""upload_plan"": // загрузка картинки с планом помещения
+        move_uploaded_file($_FILES[""myfile""][""tmp_name""], ""plan/{$customer['planpath']}/"" . $_POST[upid] . "".png"");
+        header(""Location: ./?action=departments&msg=1&id=$_POST[id]"");
+        break;
+    case ""update_department"": // изменение данных опомещении
+        if (checkskey($_POST[id])) {
+            $res = mysql_query(""update departments set camera='$_POST[camera]', name='$_POST[name]', publish='"" . ($_POST[publish] ? 1 : 0) . ""' where id='$_POST[id]'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=departments&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=departments&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""add_department"": // добавление нового помещения
+        if (checkskey('')) {
+            $res = mysql_query(""insert departments (name, publish, camera) values ('$_POST[name]', '"" . ($_POST[publish] ? 1 : 0) . ""', '$_POST[camera]')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=departments&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=departments&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_user"": // изменение данных пользователя
+        if (checkskey($_POST[id])) {
+            seveLog(""users"");
+            $res = mysql_query(""update users set "" . ($_POST[password] ? "" passwd='"" . md5($_POST[password]) . ""', "" : """") . "" telegram_id='$_POST[telegram_id]', name='$_POST[name]', notification_link='$_POST[notification_link]', fname='$_POST[fname]', email='$_POST[email]', publish='"" . ($_POST[publish] ? 1 : 0) . ""' where id='$_POST[id]'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""delete from user_role where userID='$_POST[id]'"");
+                foreach ($_POST[role] as $k => $v) {
+                    mysql_query(""insert user_role (userID, role) values ('$_POST[id]', '$v')"");
+                }
+                mysql_query(""delete from users_email_reports where user_id='$_POST[id]'"");
+                foreach ($_POST[users_email_reports] as $k => $v) {
+                    mysql_query(""insert users_email_reports (user_id, report_slug) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=users&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=users&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""add_user"": // добавление нового пользователя
+        if (checkskey('')) {
+            seveLog(""users"");
+            $res = mysql_query(""insert users (name, fname, email, publish, passwd, notification_link, telegram_id) values ('$_POST[name]', '$_POST[fname]', '$_POST[email]', '"" . ($_POST[publish] ? 1 : 0) . ""', '"" . md5($_POST[password]) . ""', '$_POST[notification_link]', '$_POST[telegram_id]')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[role] as $k => $v) {
+                    mysql_query(""insert user_role (userID, role) values ('$id', '$v')"");
+                }
+                foreach ($_POST[users_email_reports] as $k => $v) {
+                    mysql_query(""insert users_email_reports (user_id, report_slug) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=users&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=users&msg=2&$k"");
+            }
+        }
+        break;
+    case ""del_user"":
+        if (checkskey($_POST[id])) {
+            seveLog(""users"");
+            mysql_query(""delete from users WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=users"");
+        }
+        break;
+    case ""update_employee"": // изменение данных сотрудника
+        $msg = 1;
+        $res = mysql_query(""select * from employees where pin='{$_POST[pin]}'"");
+        if ($_POST[pin] and $res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $msg = 3;
+            }
+        }
+        if (checkskey($_POST['id'])) {
+            seveLog(""employees"");
+            $res = mysql_query(""UPDATE employees
                SET first_name='$_POST[first_name]',
                last_name='$_POST[last_name]',
-               RFID='$_POST[rfid]',"".
-               ($msg == 3 ? """": "" pin='$_POST[pin]', "").""
+               RFID='$_POST[rfid]',"" .
+                ($msg == 3 ? """" : "" pin='$_POST[pin]', "") . ""
                phone='$_POST[phone]',
-               publish='"".($_POST[publish] ? 1 : 0).""'
+               publish='"" . ($_POST[publish] ? 1 : 0) . ""'
                WHERE id='$_POST[id]'"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       // обнуляем роли
-                       mysql_query(""delete from employees_roles_bind where id='$_POST[id]'"");
-                       foreach($_POST[role] as $k => $v){
-                               // записываем новые роли
-                               mysql_query(""insert employees_roles_bind (id, role) values ('$_POST[id]', '$v')"");
-                       }
-                       // обнуляем группы оборудования
-                       mysql_query(""delete from employees_equipment_group_bind where id='$_POST[id]'"");
-                       foreach($_POST[equipments] as $k => $v){
-                               // записываем новые роли
-                               mysql_query(""insert employees_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
-                       }
-                       header(""Location: ./?action=employees&msg={$msg}&id=$_POST[id]"");
-               } else {
-                       header(""Location: ./?action=employees&msg=2&id=$_POST[id]"");
-               }
-       }
-       break;
-       case ""add_employee"": // добавление нового сотрудника
-       $msg = 1;
-       $res = mysql_query(""select * from employees where pin='{$_POST[pin]}'"");
-       if ($_POST[pin] and $res and mysql_num_rows($res)>0) {
-               while ($r = mysql_fetch_assoc($res)) {
-                       $msg = 4;
-               }
-       }
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                // обнуляем роли
+                mysql_query(""delete from employees_roles_bind where id='$_POST[id]'"");
+                foreach ($_POST[role] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert employees_roles_bind (id, role) values ('$_POST[id]', '$v')"");
+                }
+                // обнуляем группы оборудования
+                mysql_query(""delete from employees_equipment_group_bind where id='$_POST[id]'"");
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert employees_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=employees&msg={$msg}&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=employees&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""add_employee"": // добавление нового сотрудника
+        $msg = 1;
+        $res = mysql_query(""select * from employees where pin='{$_POST[pin]}'"");
+        if ($_POST[pin] and $res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $msg = 4;
+            }
+        }

-       if (checkskey('')) {
-               seveLog(""employees"");
-               $res = mysql_query(""INSERT INTO employees (first_name, last_name, RFID, "".($msg == 4 ? """" : ""pin, "")."" publish, phone) VALUES ('$_POST[first_name]', '$_POST[last_name]', '$_POST[rfid]', "".($msg == 4 ? """" : ""'$_POST[pin]', "").""'"".($_POST[publish] ? 1 : 0).""', '{$_POST[phone]}')"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       foreach($_POST[role] as $k => $v){
-                               // записываем роли
-                               mysql_query(""insert employees_roles_bind (id, role) values ('$id', '$v')"");
-                       }
-                       foreach($_POST[equipments] as $k => $v){
-                               // записываем группы оборудования
-                               mysql_query(""insert employees_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
-                       }
-                       header(""Location: ./?action=employees&msg={$msg}&id=$id&$k"");
-               } else {
-                       header(""Location: ./?action=employees&msg=2&$k"");
-               }
-       }
-       break;
-       case ""update_employees_roles"":
-       if (checkskey($_POST['id'])) {
-               if (trim($_POST[name]) and checkskey($_POST[id])) {
-                       mysql_query(""update employees_roles set name='$_POST[name]' where id='$_POST[id]'"");
-                       echo '{""ok"" : ""1""}';
-               }
-       }
-       break;
-       case ""add_employees_roles"":
-       if (trim($_POST[newgroupname]) and checkskey($_POST[newgroupname])) {
-               mysql_query(""insert employees_roles (name) values ('$_POST[newgroupname]')"");
-               echo '{""ok"" : ""1""}';
-       }
-       break;
-       case ""del_employees_roles"":
-       if (checkskey($_POST[id])) {
-               mysql_query(""delete from employees_roles where id='$_POST[id]'"");
-               mysql_query(""delete from employees_roles_bind where role='$_POST[id]'"");
-               echo '{""ok"" : ""1""}';
-       }
-       break;
-       case ""add_production"":
-       if (checkskey('')) {
-               seveLog(""production"");
-               $_POST[consumption] = $_POST[consumption]*1;
-               $sql = ""INSERT INTO production (name, multiplicator, consumption, publish, production_group) VALUES ('$_POST[name]', '$_POST[multiplicator]', '$_POST[consumption]', '"".($_POST[publish] ? 1 : 0).""', '$_POST[production_group]')"";
-               $res = mysql_query($sql);
-               $k = mysql_affected_rows();
-               //var_dump($k);var_dump($sql);die('aaa');
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       foreach($_POST[material] as $k => $v){
-                               mysql_query(""insert production_material_bind (id, material) values ('$id', '$v')"");
-                       }
-                       foreach($_POST[instrument] as $k => $v){
-                               mysql_query(""insert production_instrument_bind (id, instrument) values ('$id', '$v')"");
-                       }
-                       foreach($_POST[equipments] as $k => $v){
-                               // записываем группы оборудования
-                               mysql_query(""insert production_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
-                       }
-                       header(""Location: ./?action=production&msg=1&id=$id&$k"");
-               } else {
-                       header(""Location: ./?action=production&msg=2&$k"");
-               }
-       }
-       break;
-       case ""del_production_group"":
-       if (checkskey($_POST[id])) {
-               seveLog(""del_production_group"");
-               mysql_query(""delete from  production_group_list WHERE id='$_POST[id]'"");
-               mysql_query(""update production set production_group=0 where production_group='$_POST[id]'"");
-               header(""Location: ./?action=production_group"");
-       }
-       break;
-       case ""add_production_group"":
-       if (checkskey('')) {
-               seveLog(""production_group"");
-               $sql = ""INSERT INTO production_group_list (name) VALUES ('{$_POST[name]}')"";
-               $res = mysql_query($sql);
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=production_group&msg=1&id=$id&$k"");
-               } else {
-                       header(""Location: ./?action=production_group&msg=2&$k"");
-               }
-       }
-       break;
-       case ""update_production_group"":
-       if (checkskey($_POST[id])) {
-               seveLog(""production_group"");
-               $sql = ""update production_group_list set name='{$_POST[name]}' where id = {$_POST[id]}"";
-               $res = mysql_query($sql);
-               header(""Location: ./?action=production_group&msg=1&id={$_POST[id]}"");
-       }
-       break;
-       case ""update_production"":
-       if (checkskey($_POST['id'])) {
-               seveLog(""production"");
-               $res = mysql_query(""UPDATE production
+        if (checkskey('')) {
+            seveLog(""employees"");
+            $res = mysql_query(""INSERT INTO employees (first_name, last_name, RFID, "" . ($msg == 4 ? """" : ""pin, "") . "" publish, phone) VALUES ('$_POST[first_name]', '$_POST[last_name]', '$_POST[rfid]', "" . ($msg == 4 ? """" : ""'$_POST[pin]', "") . ""'"" . ($_POST[publish] ? 1 : 0) . ""', '{$_POST[phone]}')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[role] as $k => $v) {
+                    // записываем роли
+                    mysql_query(""insert employees_roles_bind (id, role) values ('$id', '$v')"");
+                }
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем группы оборудования
+                    mysql_query(""insert employees_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=employees&msg={$msg}&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=employees&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_employees_roles"":
+        if (checkskey($_POST['id'])) {
+            if (trim($_POST[name]) and checkskey($_POST[id])) {
+                mysql_query(""update employees_roles set name='$_POST[name]' where id='$_POST[id]'"");
+                echo '{""ok"" : ""1""}';
+            }
+        }
+        break;
+    case ""add_employees_roles"":
+        if (trim($_POST[newgroupname]) and checkskey($_POST[newgroupname])) {
+            mysql_query(""insert employees_roles (name) values ('$_POST[newgroupname]')"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""del_employees_roles"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""delete from employees_roles where id='$_POST[id]'"");
+            mysql_query(""delete from employees_roles_bind where role='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""add_production"":
+        if (checkskey('')) {
+            seveLog(""production"");
+            $_POST[consumption] = $_POST[consumption] * 1;
+            $sql = ""INSERT INTO production (name, multiplicator, consumption, publish, production_group) VALUES ('$_POST[name]', '$_POST[multiplicator]', '$_POST[consumption]', '"" . ($_POST[publish] ? 1 : 0) . ""', '$_POST[production_group]')"";
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            //var_dump($k);var_dump($sql);die('aaa');
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[material] as $k => $v) {
+                    mysql_query(""insert production_material_bind (id, material) values ('$id', '$v')"");
+                }
+                foreach ($_POST[instrument] as $k => $v) {
+                    mysql_query(""insert production_instrument_bind (id, instrument) values ('$id', '$v')"");
+                }
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем группы оборудования
+                    mysql_query(""insert production_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=production&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=production&msg=2&$k"");
+            }
+        }
+        break;
+    case ""del_production_group"":
+        if (checkskey($_POST[id])) {
+            seveLog(""del_production_group"");
+            mysql_query(""delete from  production_group_list WHERE id='$_POST[id]'"");
+            mysql_query(""update production set production_group=0 where production_group='$_POST[id]'"");
+            header(""Location: ./?action=production_group"");
+        }
+        break;
+    case ""add_production_group"":
+        if (checkskey('')) {
+            seveLog(""production_group"");
+            $sql = ""INSERT INTO production_group_list (name) VALUES ('{$_POST[name]}')"";
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=production_group&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=production_group&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_production_group"":
+        if (checkskey($_POST[id])) {
+            seveLog(""production_group"");
+            $sql = ""update production_group_list set name='{$_POST[name]}' where id = {$_POST[id]}"";
+            $res = mysql_query($sql);
+            header(""Location: ./?action=production_group&msg=1&id={$_POST[id]}"");
+        }
+        break;
+    case ""update_production"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""production"");
+            $res = mysql_query(""UPDATE production
                        SET name='$_POST[name]',
                        multiplicator='$_POST[multiplicator]',
                        consumption='$_POST[consumption]',
                        production_group='$_POST[production_group]',
-                       publish='"".($_POST[publish] ? 1 : 0).""'
+                       publish='"" . ($_POST[publish] ? 1 : 0) . ""'
                        WHERE id='$_POST[id]'"");
-                       $k = mysql_affected_rows();
-                       if ($res and $k>-1) {
-                               mysql_query(""delete from production_material_bind where id='$_POST[id]'"");
-                               foreach($_POST[material] as $k => $v){
-                                       mysql_query(""insert production_material_bind (id, material) values ('$_POST[id]', '$v')"");
-                               }
-                               mysql_query(""delete from production_instrument_bind where id='$_POST[id]'"");
-                               foreach($_POST[instrument] as $k => $v){
-                                       mysql_query(""insert production_instrument_bind (id, instrument) values ('$_POST[id]', '$v')"");
-                               }
-                               // обнуляем группы оборудования
-                               mysql_query(""delete from production_equipment_group_bind where id='$_POST[id]'"");
-                               foreach($_POST[equipments] as $k => $v){
-                                       // записываем новые роли
-                                       mysql_query(""insert production_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
-                               }
-                               header(""Location: ./?action=production&msg=1&id=$_POST[id]"");
-                       } else {
-                               header(""Location: ./?action=production&msg=2&id=$_POST[id]"");
-                       }
-               }
-               break;
-               case ""del_production"":
-               if (checkskey($_POST[id])) {
-                       seveLog(""production"");
-                       mysql_query(""delete from production WHERE id='$_POST[id]'"");
-                       header(""Location: ./?action=production"");
-               }
-               break;
-               case ""update_norma"":
-               seveLog(""norma"");
-               if (checkskey($_POST['id'])) {
-                       $res = mysql_query(""UPDATE norma
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""delete from production_material_bind where id='$_POST[id]'"");
+                foreach ($_POST[material] as $k => $v) {
+                    mysql_query(""insert production_material_bind (id, material) values ('$_POST[id]', '$v')"");
+                }
+                mysql_query(""delete from production_instrument_bind where id='$_POST[id]'"");
+                foreach ($_POST[instrument] as $k => $v) {
+                    mysql_query(""insert production_instrument_bind (id, instrument) values ('$_POST[id]', '$v')"");
+                }
+                // обнуляем группы оборудования
+                mysql_query(""delete from production_equipment_group_bind where id='$_POST[id]'"");
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert production_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=production&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=production&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""del_production"":
+        if (checkskey($_POST[id])) {
+            seveLog(""production"");
+            mysql_query(""delete from production WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=production"");
+        }
+        break;
+    case ""update_norma"":
+        seveLog(""norma"");
+        if (checkskey($_POST['id'])) {
+            $res = mysql_query(""UPDATE norma
                                SET time='$_POST[time]',
                                percent='{$_POST['percent']}',
                                material='$_POST[material]',
                                instrument='$_POST[instrument]',
                                product='$_POST[product]'
                                WHERE id='$_POST[id]'"");
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       header(""Location: ./?action=norma&msg=1&id=$_POST[id]"");
-                               } else {
-                                       header(""Location: ./?action=norma&msg=2&id=$_POST[id]"");
-                               }
-                       }
-                       break;
-                       case ""add_norma"":
-                       if (checkskey($_POST['id'])) {
-                               seveLog(""norma"");
-                               $res = mysql_query(""INSERT INTO norma (time, percent, material, instrument, product) VALUES ('$_POST[time]', '{$_POST['percent']}', '$_POST[material]', '$_POST[instrument]', '$_POST[product]')"");
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       $id = mysql_insert_id();
-                                       header(""Location: ./?action=norma&msg=1&id={$id}"");
-                               } else {
-                                       header(""Location: ./?action=norma&msg=2&id=$_POST[id]"");
-                               }
-                       }
-                       break;
-                       case ""del_norma"":
-                       if (checkskey($_POST[id])) {
-                               seveLog(""norma"");
-                               mysql_query(""delete from norma WHERE id='$_POST[id]'"");
-                               header(""Location: ./?action=norma"");
-                       }
-                       break;
-                       case ""add_instrument"":
-                       if (checkskey('')) {
-                               seveLog(""instrument"");
-                               $res = mysql_query(""INSERT INTO instrument (name, circles_before_to, divider, publish) VALUES ('$_POST[name]', '$_POST[circles_before_to]', '$_POST[divider]', '"".($_POST[publish] ? 1 : 0).""')"");
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       $id = mysql_insert_id();
-                                       foreach($_POST[material] as $k => $v){
-                                               // записываем роли
-                                               mysql_query(""insert instrument_material_bind (id, material) values ('$id', '$v')"");
-                                       }
-                                       foreach($_POST[equipments] as $k => $v){
-                                               // записываем группы оборудования
-                                               mysql_query(""insert instrument_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
-                                       }
-                                       header(""Location: ./?action=instrument&msg=1&id=$id&$k"");
-                               } else {
-                                       header(""Location: ./?action=instrument&msg=2&$k"");
-                               }
-                       }
-                       break;
-                       case ""update_instrument"":
-                       if (checkskey($_POST['id'])) {
-                               seveLog(""instrument"");
-                               $res = mysql_query(""UPDATE instrument
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=norma&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=norma&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""add_norma"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""norma"");
+            $res = mysql_query(""INSERT INTO norma (time, percent, material, instrument, product) VALUES ('$_POST[time]', '{$_POST['percent']}', '$_POST[material]', '$_POST[instrument]', '$_POST[product]')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=norma&msg=1&id={$id}"");
+            } else {
+                header(""Location: ./?action=norma&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""del_norma"":
+        if (checkskey($_POST[id])) {
+            seveLog(""norma"");
+            mysql_query(""delete from norma WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=norma"");
+        }
+        break;
+    case ""add_instrument"":
+        if (checkskey('')) {
+            seveLog(""instrument"");
+            $res = mysql_query(""INSERT INTO instrument (name, circles_before_to, divider, publish) VALUES ('$_POST[name]', '$_POST[circles_before_to]', '$_POST[divider]', '"" . ($_POST[publish] ? 1 : 0) . ""')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[material] as $k => $v) {
+                    // записываем роли
+                    mysql_query(""insert instrument_material_bind (id, material) values ('$id', '$v')"");
+                }
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем группы оборудования
+                    mysql_query(""insert instrument_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=instrument&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=instrument&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_instrument"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""instrument"");
+            $res = mysql_query(""UPDATE instrument
                                        SET name='$_POST[name]',
                                        circles_before_to='$_POST[circles_before_to]',
                                        divider='$_POST[divider]',
-                                       publish='"".($_POST[publish] ? 1 : 0).""'
+                                       publish='"" . ($_POST[publish] ? 1 : 0) . ""'
                                        WHERE id='$_POST[id]'"");
-                                       $k = mysql_affected_rows();
-                                       if ($res and $k>-1) {
-                                               mysql_query(""delete from instrument_material_bind where id='$_POST[id]'"");
-                                               foreach($_POST[material] as $k => $v){
-                                                       mysql_query(""insert instrument_material_bind (id, material) values ('$_POST[id]', '$v')"");
-                                               }
-                                               // обнуляем группы оборудования
-                                               mysql_query(""delete from instrument_equipment_group_bind where id='$_POST[id]'"");
-                                               foreach($_POST[equipments] as $k => $v){
-                                                       // записываем новые роли
-                                                       mysql_query(""insert instrument_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
-                                               }
-                                               header(""Location: ./?action=instrument&msg=1&id=$_POST[id]"");
-                                       } else {
-                                               header(""Location: ./?action=instrument&msg=2&id=$_POST[id]"");
-                                       }
-                               }
-                               break;
-                               case ""del_instrument"":
-                               if (checkskey($_POST[id])) {
-                                       seveLog(""instrument"");
-                                       mysql_query(""delete from instrument WHERE id='$_POST[id]'"");
-                                       header(""Location: ./?action=instrument"");
-                               }
-                               break;
-                               case ""add_reason"":
-                               if (checkskey('')) {
-                                       seveLog(""reasons"");
-                                       $res = mysql_query(""INSERT INTO reasons (name, color, publish, plan, autostop) VALUES ('{$_POST[name]}', '{$_POST[color]}', '"".($_POST[publish] ? 1 : 0).""', '"".($_POST[plan] ? 1 : 0).""', '"".($_POST[autostop] ? 1 : 0).""')"");
-                                       $k = mysql_affected_rows();
-                                       if ($res and $k>-1) {
-                                               $id = mysql_insert_id();
-                                               foreach($_POST[role] as $k => $v){
-                                                       // записываем роли
-                                                       mysql_query(""insert reasons_roles_bind (id, role) values ('$id', '$v')"");
-                                               }
-                                               foreach($_POST[equipments] as $k => $v){
-                                                       // записываем группы оборудования
-                                                       mysql_query(""insert reasons_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
-                                               }
-                                               header(""Location: ./?action=reasons&msg=1&id=$id&$k"");
-                                       } else {
-                                               header(""Location: ./?action=reasons&msg=2&$k"");
-                                       }
-                               }
-                               break;
-                               case ""update_reason"":
-                               if (checkskey($_POST['id'])) {
-                                       seveLog(""reasons"");
-                                       $res = mysql_query(""UPDATE reasons
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""delete from instrument_material_bind where id='$_POST[id]'"");
+                foreach ($_POST[material] as $k => $v) {
+                    mysql_query(""insert instrument_material_bind (id, material) values ('$_POST[id]', '$v')"");
+                }
+                // обнуляем группы оборудования
+                mysql_query(""delete from instrument_equipment_group_bind where id='$_POST[id]'"");
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert instrument_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=instrument&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=instrument&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""del_instrument"":
+        if (checkskey($_POST[id])) {
+            seveLog(""instrument"");
+            mysql_query(""delete from instrument WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=instrument"");
+        }
+        break;
+    case ""add_reason"":
+        if (checkskey('')) {
+            seveLog(""reasons"");
+            $res = mysql_query(""INSERT INTO reasons (name, color, publish, plan, autostop) VALUES ('{$_POST[name]}', '{$_POST[color]}', '"" . ($_POST[publish] ? 1 : 0) . ""', '"" . ($_POST[plan] ? 1 : 0) . ""', '"" . ($_POST[autostop] ? 1 : 0) . ""')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[role] as $k => $v) {
+                    // записываем роли
+                    mysql_query(""insert reasons_roles_bind (id, role) values ('$id', '$v')"");
+                }
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем группы оборудования
+                    mysql_query(""insert reasons_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=reasons&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=reasons&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_reason"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""reasons"");
+            $res = mysql_query(""UPDATE reasons
                                                SET name='$_POST[name]',
                                                color='$_POST[color]',
-                                               publish='"".($_POST[publish] ? 1 : 0).""',
-                                               autostop='"".($_POST[autostop] ? 1 : 0).""',
-                                               plan='"".($_POST[plan] ? 1 : 0).""'
+                                               publish='"" . ($_POST[publish] ? 1 : 0) . ""',
+                                               autostop='"" . ($_POST[autostop] ? 1 : 0) . ""',
+                                               plan='"" . ($_POST[plan] ? 1 : 0) . ""'
                                                WHERE id='$_POST[id]'"");
-                                               $k = mysql_affected_rows();
-                                               if ($res and $k>-1) {
-                                                       // обнуляем роли
-                                                       mysql_query(""delete from reasons_roles_bind where id='$_POST[id]'"");
-                                                       foreach($_POST[role] as $k => $v){
-                                                               // записываем новые роли
-                                                               mysql_query(""insert reasons_roles_bind (id, role) values ('$_POST[id]', '$v')"");
-                                                       }
-                                                       // обнуляем группы оборудования
-                                                       mysql_query(""delete from reasons_equipment_group_bind where id='$_POST[id]'"");
-                                                       foreach($_POST[equipments] as $k => $v){
-                                                               // записываем новые роли
-                                                               mysql_query(""insert reasons_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
-                                                       }
-                                                       header(""Location: ./?action=reasons&msg=1&id=$_POST[id]"");
-                                               } else {
-                                                       header(""Location: ./?action=reasons&msg=2&id=$_POST[id]"");
-                                               }
-                                       }
-                                       break;
-                                       case ""del_reason"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""reasons"");
-                                               mysql_query(""delete from reasons WHERE id='$_POST[id]'"");
-                                               header(""Location: ./?action=reasons"");
-                                       }
-                                       break;
-                                       case ""add_material"":
-                                       if (checkskey('')) {
-                                               seveLog(""material"");
-                                               $sql = ""INSERT INTO material (name, publish) VALUES ('{$_POST[name]}', "".($_POST[publish] ? 1 : 0)."")"";
-                                               $res = mysql_query($sql);
-                                               $k = mysql_affected_rows();
-                                               if ($res and $k>-1) {
-                                                       $id = mysql_insert_id();
-                                                       header(""Location: ./?action=material&msg=1&id=$id&$k"");
-                                               } else {
-                                                       header(""Location: ./?action=material&msg=2&$k"");
-                                               }
-                                       }
-                                       break;
-                                       case ""del_material"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""material"");
-                                               $sql = ""delete from material where id = {$_POST[id]}"";
-                                               $res = mysql_query($sql);
-                                               header(""Location: ./?action=material&msg=1"");
-                                       }
-                                       break;
-                                       case ""update_material"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""material"");
-                                               $sql = ""update material set name='{$_POST[name]}', publish="".($_POST[publish] ? 1 : 0)."" where id = {$_POST[id]}"";
-                                               $res = mysql_query($sql);
-                                               header(""Location: ./?action=material&msg=1&id={$_POST[id]}"");
-                                       }
-                                       break;
-                                       case ""del_employe"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""employees"");
-                                               mysql_query(""delete from employees WHERE id='$_POST[id]'"");
-                                               header(""Location: ./?action=employees"");
-                                       }
-                                       break;
-                                       case ""add_equipment"": // добавление нового оборудования
-                                       if (checkskey('')) {
-                                               seveLog(""equipment"");
-                                               if ($_POST[now]) {
-                                                       $wts = ""now()"";
-                                               } else {
-                                                       $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
-                                               }
-                                               if ($_POST[arm]) {
-                                                       mysql_query(""update equipment_list set arm=0 where arm='{$_POST[arm]}'"");
-                                               }
-                                               $res = mysql_query(""insert equipment_list (name, arm, publish, time_tracking, camera, camera_token, can_plan, no_notifications, work_time_start, average_working_time, downtime_limit) values ('$_POST[name]', '$_POST[arm]', '"".($_POST[publish] ? 1 : 0).""', '$_POST[time_tracking]', '$_POST[camera]', '$_POST[camera_token]', '$_POST[can_plan]', '"".($_POST[no_notifications] ? 1 : 0).""', {$wts}, '{$_POST[average_working_time]}', '{$_POST['downtime_limit']}')"");
-                                               mysql_query(""insert equipment_condition (timestamp, equipment, status) values ('1970-01-01 00:00:00', '{$_POST[id]}', 0)"");
-                                               $k = mysql_affected_rows();
-                                               if ($res and $k>-1) {
-                                                       $id = mysql_insert_id();
-                                                       mysql_query(""update devices set equipment_id='$id' where id='$_POST[newdevice]'"");
-                                                       mysql_query(""update devices set equipment_id=0 where equipment_id='$id' and id<>'$_POST[newdevice]'"");
-                                                       foreach($_POST[group] as $k => $v){
-                                                               mysql_query(""insert equipment_group (equipmentID, groupID) values ('$id', '$v')"");
-                                                       }
-                                                       header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=1&id=$id&$k"");
-                                               } else {
-                                                       header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=2&$k"");
-                                               }
-                                       }
-                                       break;
-                                       case ""update_equipment"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""equipment"");
-                                               if ($_POST[now]) {
-                                                       $wts = ""now()"";
-                                               } else {
-                                                       $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
-                                               }
-                                               if ($_POST[arm]) {
-                                                       mysql_query(""update equipment_list set arm=0 where arm='{$_POST[arm]}' and id != '{$_POST[id]}'"");
-                                               }
-                                               mysql_query(""delete from equipment_sensors where equipment_id='{$_POST[id]}'"");
-                                               foreach($_POST[connected_sensor] as $key => $val){
-                                                       $sql = ""insert equipment_sensors (equipment_id, sensor_id, is_units_counter, is_cirquit_channel, is_counter_to_circle) values ('{$_POST[id]}', '{$key}', '"".($key == $_POST['units_counter'] ? 1 : 0).""', '"".($key == $_POST['cirquit_channel'] ? 1 : 0).""', '"".($key == $_POST['counter_to_circle'] ? 1 : 0).""' )"";
-                                                       //echo $sql.""\n"";
-                                                       mysql_query($sql);
-                                               }
-                                               //exit;
-                                               $res = mysql_query(""update equipment_list set arm='{$_POST[arm]}', work_time_start={$wts}, average_working_time='{$_POST[average_working_time]}', can_plan='"".($_POST[can_plan] ? 1 : 0).""', no_notifications='"".($_POST[no_notifications] ? 1 : 0).""', camera='$_POST[camera]', camera_token='$_POST[camera_token]', name='$_POST[name]', publish='"".($_POST[publish] ? 1 : 0).""', time_tracking='$_POST[time_tracking]', downtime_limit='{$_POST['downtime_limit']}' where id='$_POST[id]'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                // обнуляем роли
+                mysql_query(""delete from reasons_roles_bind where id='$_POST[id]'"");
+                foreach ($_POST[role] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert reasons_roles_bind (id, role) values ('$_POST[id]', '$v')"");
+                }
+                // обнуляем группы оборудования
+                mysql_query(""delete from reasons_equipment_group_bind where id='$_POST[id]'"");
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert reasons_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=reasons&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=reasons&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""del_reason"":
+        if (checkskey($_POST[id])) {
+            seveLog(""reasons"");
+            mysql_query(""delete from reasons WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=reasons"");
+        }
+        break;
+    case ""add_material"":
+        if (checkskey('')) {
+            seveLog(""material"");
+            $sql = ""INSERT INTO material (name, publish) VALUES ('{$_POST[name]}', "" . ($_POST[publish] ? 1 : 0) . "")"";
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=material&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=material&msg=2&$k"");
+            }
+        }
+        break;
+    case ""del_material"":
+        if (checkskey($_POST[id])) {
+            seveLog(""material"");
+            $sql = ""delete from material where id = {$_POST[id]}"";
+            $res = mysql_query($sql);
+            header(""Location: ./?action=material&msg=1"");
+        }
+        break;
+    case ""update_material"":
+        if (checkskey($_POST[id])) {
+            seveLog(""material"");
+            $sql = ""update material set name='{$_POST[name]}', publish="" . ($_POST[publish] ? 1 : 0) . "" where id = {$_POST[id]}"";
+            $res = mysql_query($sql);
+            header(""Location: ./?action=material&msg=1&id={$_POST[id]}"");
+        }
+        break;
+    case ""del_employe"":
+        if (checkskey($_POST[id])) {
+            seveLog(""employees"");
+            mysql_query(""delete from employees WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=employees"");
+        }
+        break;
+    case ""add_equipment"": // добавление нового оборудования
+        if (checkskey('')) {
+            seveLog(""equipment"");
+            if ($_POST[now]) {
+                $wts = ""now()"";
+            } else {
+                $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
+            }
+            if ($_POST[arm]) {
+                mysql_query(""update equipment_list set arm=0 where arm='{$_POST[arm]}'"");
+            }
+            $res = mysql_query(""insert equipment_list (name, arm, publish, time_tracking, camera, camera_token, can_plan, no_notifications, work_time_start, average_working_time, downtime_limit) values ('$_POST[name]', '$_POST[arm]', '"" . ($_POST[publish] ? 1 : 0) . ""', '$_POST[time_tracking]', '$_POST[camera]', '$_POST[camera_token]', '$_POST[can_plan]', '"" . ($_POST[no_notifications] ? 1 : 0) . ""', {$wts}, '{$_POST[average_working_time]}', '{$_POST['downtime_limit']}')"");
+            mysql_query(""insert equipment_condition (timestamp, equipment, status) values ('1970-01-01 00:00:00', '{$_POST[id]}', 0)"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                mysql_query(""update devices set equipment_id='$id' where id='$_POST[newdevice]'"");
+                mysql_query(""update devices set equipment_id=0 where equipment_id='$id' and id<>'$_POST[newdevice]'"");
+                foreach ($_POST[group] as $k => $v) {
+                    mysql_query(""insert equipment_group (equipmentID, groupID) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_equipment"":
+        if (checkskey($_POST[id])) {
+            seveLog(""equipment"");
+            if ($_POST[now]) {
+                $wts = ""now()"";
+            } else {
+                $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
+            }
+            if ($_POST[arm]) {
+                mysql_query(""update equipment_list set arm=0 where arm='{$_POST[arm]}' and id != '{$_POST[id]}'"");
+            }
+            mysql_query(""delete from equipment_sensors where equipment_id='{$_POST[id]}'"");
+            foreach ($_POST[connected_sensor] as $key => $val) {
+                $sql = ""insert equipment_sensors (equipment_id, sensor_id, is_units_counter, is_cirquit_channel, is_counter_to_circle) values ('{$_POST[id]}', '{$key}', '"" . ($key == $_POST['units_counter'] ? 1 : 0) . ""', '"" . ($key == $_POST['cirquit_channel'] ? 1 : 0) . ""', '"" . ($key == $_POST['counter_to_circle'] ? 1 : 0) . ""' )"";
+                //echo $sql.""\n"";
+                mysql_query($sql);
+            }
+            //exit;
+            $res = mysql_query(""update equipment_list set arm='{$_POST[arm]}', work_time_start={$wts}, average_working_time='{$_POST[average_working_time]}', can_plan='"" . ($_POST[can_plan] ? 1 : 0) . ""', no_notifications='"" . ($_POST[no_notifications] ? 1 : 0) . ""', camera='$_POST[camera]', camera_token='$_POST[camera_token]', name='$_POST[name]', publish='"" . ($_POST[publish] ? 1 : 0) . ""', time_tracking='$_POST[time_tracking]', downtime_limit='{$_POST['downtime_limit']}' where id='$_POST[id]'"");

-                                               $k = mysql_affected_rows();
-                                               if ($res and $k>-1) {
-                                                       mysql_query(""insert equipment_condition (timestamp, equipment, status) values ('1970-01-01 00:00:00', '{$_POST[id]}', 0)"");
-                                                       mysql_query(""update devices set equipment_id='$_POST[id]' where id='$_POST[device]'"");
-                                                       mysql_query(""update devices set equipment_id=0 where equipment_id='$_POST[id]' and id<>'$_POST[device]'"");
-                                                       mysql_query(""delete from equipment_group where equipmentID='$_POST[id]'"");
-                                                       foreach($_POST[group] as $k => $v){
-                                                               mysql_query(""insert equipment_group (equipmentID, groupID) values ('$_POST[id]', '$v')"");
-                                                       }
-                                                       header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=1&id=$_POST[id]"");
-                                               } else {
-                                                       header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=2&id=$_POST[id]"");
-                                               }
-                                       }
-                                       break;
-                                       case ""update_equipment_worked"":
-                                       seveLog(""equipment_worked"");
-                                       if ($_POST[now]) {
-                                               $wts = ""now()"";
-                                       } else {
-                                               $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
-                                       }
-                                       $res = mysql_query(""update equipment_list set work_time_start={$wts}, average_working_time='{$_POST[average_working_time]}' where id='$_POST[id]'"");
-                                       header(""Location: ./?action=equipment_worked&active_only={$_POST[active_only]}&id=$_POST[id]"");
-                                       break;
-                                       case ""del_equipment"":
-                                       if (checkskey($_POST[id])) {
-                                               mysql_query(""delete from equipment_list WHERE id='$_POST[id]'"");
-                                               header(""Location: ./?action=equipment&active_only={$_POST[active_only]}"");
-                                       }
-                                       break;
-                                       case ""del_group"":
-                                       if (checkskey($_POST[id])) {
-                                               mysql_query(""delete from equipment_group_list where id='$_POST[id]'"");
-                                               mysql_query(""delete from equipment_group where groupID='$_POST[id]'"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""add_group"":
-                                       if (trim($_POST[newgroupname]) and checkskey($_POST[newgroupname])) {
-                                               mysql_query(""insert equipment_group_list (name) values ('$_POST[newgroupname]')"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""update_group"":
-                                       if (trim($_POST[name]) and checkskey($_POST[id])) {
-                                               mysql_query(""update equipment_group_list set name='$_POST[name]' where id='$_POST[id]'"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""save_equipment_coord"":
-                                       if (checkskey($_POST[id])) {
-                                               mysql_query(""update equipment_list set department='$_POST[department]', y='$_POST[y]', x='$_POST[x]', x2='$_POST[x2]', y2='$_POST[y2]' where id='$_POST[id]'"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""del_equipment_coord"":
-                                       if (checkskey($_POST[id])) {
-                                               mysql_query(""update equipment_list set department='0', y='0', x='0', x2='0', y2='0' where id='$_POST[id]'"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""copy_formula"":
-                                               if (checkskey($_POST[IDto])) {
-                                                       seveLog(""formula"");
-                                                       $res = mysql_query(""select * from formuls where device_id='$_POST[IDfrom]'"");
-                                                       if ($res and mysql_num_rows($res)>0) {
-                                                               while ($r = mysql_fetch_array($res)) {
-                                                                       mysql_query(""insert formuls (title, device_id, status_id, formula) values ('$r[title]', '$_POST[IDto]', '$r[status_id]', '$r[formula]')"");
-                                                               }
-                                                       }
-                                                       header(""Location: ./?action=formula&device_id=$_POST[IDto]"");
-                                               }
-                                               break;
-                                               case ""copy_formula_energy"":
-                                                       if (checkskey($_POST[IDto])) {
-                                                               seveLog(""formula_energy"");
-                                                               $res = mysql_query(""select * from formuls_energy where equipment_id='$_POST[IDfrom]'"");
-                                                               if ($res and mysql_num_rows($res)>0) {
-                                                                       while ($r = mysql_fetch_array($res)) {
-                                                                               mysql_query(""insert formuls_energy (title, equipment_id, formula, resource_id) values ('$r[title]', '$_POST[IDto]', '$r[formula]', '$r[resource_id]')"");
-                                                                       }
-                                                               }
-                                                               header(""Location: ./?action=formula_energy&equipment_id=$_POST[IDto]&resource_id=$_POST[resource_id]"");
-                                                       }
-                                                       break;
-                                                       case ""del_formula"":
-                                                               if (checkskey($_POST[device_id])) {
-                                                                       seveLog(""formula"");
-                                                                       mysql_query(""DELETE FROM formuls WHERE id='$_POST[id]' LIMIT 1"");
-                                                               }
-                                                               header(""Location: ./?action=formula&device_id=$_POST[device_id]"");
-                                                               break;
-                                                               case ""del_formula_energy"":
-                                                                       if (checkskey($_POST[device_id])) {
-                                                                               seveLog(""formula_energy"");
-                                                                               mysql_query(""DELETE FROM formuls_energy WHERE id='$_POST[id]' LIMIT 1"");
-                                                                       }
-                                                                       header(""Location: ./?action=formula_energy&device_id=$_POST[device_id]"");
-                                                                       break;
-                                                                       case ""add_status"":
-                                                                       case ""update_status"":
-                                                                       seveLog(""statuses"");
-                                                                       include_once '../models/Status.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               $data = [
-                                                                                       'title' => htmlspecialchars($_POST['title']),
-                                                                                       'is_it_work' => (!empty($_POST['is_it_work'])) ? 1 : 0,
-                                                                                       'subtitle' => (!empty($_POST['subtitle'])) ? 1 : 0,
-                                                                                       'color' => htmlspecialchars($_POST['color']),
-                                                                               ];
-                                                                               if ($_POST['action'] == 'add_status') {
-                                                                                       Status::insert($data);
-                                                                                       $id = Status::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_status') {
-                                                                                       Status::update($data, $id);
-                                                                               }
-                                                                               header(""Location: ./?action=statuses&id={$id}"");
-                                                                       }
-                                                                       break;
-                                                                       case 'change_status' :
-                                                                       if (checkskey()) {
-                                                                               $equipment = isset($_POST['equipment']) ? intval($_POST['equipment']) : null;
-                                                                               $status = isset($_POST['status']) ? intval($_POST['status']) : null;
-                                                                               if ($equipment !== null && $status !== null) {
-                                                                                       $time = date('Y-m-d H:i:s');
-                                                                                       DB::query(""INSERT INTO `equipment_condition` (`timestamp`, `equipment`, `status`, `source`)
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""insert equipment_condition (timestamp, equipment, status) values ('1970-01-01 00:00:00', '{$_POST[id]}', 0)"");
+                mysql_query(""update devices set equipment_id='$_POST[id]' where id='$_POST[device]'"");
+                mysql_query(""update devices set equipment_id=0 where equipment_id='$_POST[id]' and id<>'$_POST[device]'"");
+                mysql_query(""delete from equipment_group where equipmentID='$_POST[id]'"");
+                foreach ($_POST[group] as $k => $v) {
+                    mysql_query(""insert equipment_group (equipmentID, groupID) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""update_equipment_worked"":
+        seveLog(""equipment_worked"");
+        if ($_POST[now]) {
+            $wts = ""now()"";
+        } else {
+            $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
+        }
+        $res = mysql_query(""update equipment_list set work_time_start={$wts}, average_working_time='{$_POST[average_working_time]}' where id='$_POST[id]'"");
+        header(""Location: ./?action=equipment_worked&active_only={$_POST[active_only]}&id=$_POST[id]"");
+        break;
+    case ""del_equipment"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""delete from equipment_list WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=equipment&active_only={$_POST[active_only]}"");
+        }
+        break;
+    case ""del_group"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""delete from equipment_group_list where id='$_POST[id]'"");
+            mysql_query(""delete from equipment_group where groupID='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""add_group"":
+        if (trim($_POST[newgroupname]) and checkskey($_POST[newgroupname])) {
+            mysql_query(""insert equipment_group_list (name) values ('$_POST[newgroupname]')"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""update_group"":
+        if (trim($_POST[name]) and checkskey($_POST[id])) {
+            mysql_query(""update equipment_group_list set name='$_POST[name]' where id='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""save_equipment_coord"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""update equipment_list set department='$_POST[department]', y='$_POST[y]', x='$_POST[x]', x2='$_POST[x2]', y2='$_POST[y2]' where id='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""del_equipment_coord"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""update equipment_list set department='0', y='0', x='0', x2='0', y2='0' where id='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""copy_formula"":
+        if (checkskey($_POST[IDto])) {
+            seveLog(""formula"");
+            $res = mysql_query(""select * from formuls where device_id='$_POST[IDfrom]'"");
+            if ($res and mysql_num_rows($res) > 0) {
+                while ($r = mysql_fetch_array($res)) {
+                    mysql_query(""insert formuls (title, device_id, status_id, formula) values ('$r[title]', '$_POST[IDto]', '$r[status_id]', '$r[formula]')"");
+                }
+            }
+            header(""Location: ./?action=formula&device_id=$_POST[IDto]"");
+        }
+        break;
+    case ""copy_formula_energy"":
+        if (checkskey($_POST[IDto])) {
+            seveLog(""formula_energy"");
+            $res = mysql_query(""select * from formuls_energy where equipment_id='$_POST[IDfrom]'"");
+            if ($res and mysql_num_rows($res) > 0) {
+                while ($r = mysql_fetch_array($res)) {
+                    mysql_query(""insert formuls_energy (title, equipment_id, formula, resource_id) values ('$r[title]', '$_POST[IDto]', '$r[formula]', '$r[resource_id]')"");
+                }
+            }
+            header(""Location: ./?action=formula_energy&equipment_id=$_POST[IDto]&resource_id=$_POST[resource_id]"");
+        }
+        break;
+    case ""del_formula"":
+        if (checkskey($_POST[device_id])) {
+            seveLog(""formula"");
+            mysql_query(""DELETE FROM formuls WHERE id='$_POST[id]' LIMIT 1"");
+        }
+        header(""Location: ./?action=formula&device_id=$_POST[device_id]"");
+        break;
+    case ""del_formula_energy"":
+        if (checkskey($_POST[device_id])) {
+            seveLog(""formula_energy"");
+            mysql_query(""DELETE FROM formuls_energy WHERE id='$_POST[id]' LIMIT 1"");
+        }
+        header(""Location: ./?action=formula_energy&device_id=$_POST[device_id]"");
+        break;
+    case ""add_status"":
+    case ""update_status"":
+        seveLog(""statuses"");
+        include_once '../models/Status.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            $data = [
+                'title' => htmlspecialchars($_POST['title']),
+                'is_it_work' => (!empty($_POST['is_it_work'])) ? 1 : 0,
+                'subtitle' => (!empty($_POST['subtitle'])) ? 1 : 0,
+                'color' => htmlspecialchars($_POST['color']),
+            ];
+            if ($_POST['action'] == 'add_status') {
+                Status::insert($data);
+                $id = Status::insertId();
+            }
+            if ($_POST['action'] == 'update_status') {
+                Status::update($data, $id);
+            }
+            header(""Location: ./?action=statuses&id={$id}"");
+        }
+        break;
+    case 'change_status' :
+        if (checkskey()) {
+            $equipment = isset($_POST['equipment']) ? intval($_POST['equipment']) : null;
+            $status = isset($_POST['status']) ? intval($_POST['status']) : null;
+            if ($equipment !== null && $status !== null) {
+                $time = date('Y-m-d H:i:s');
+                DB::query(""INSERT INTO `equipment_condition` (`timestamp`, `equipment`, `status`, `source`)
                                                                                        VALUES('$time', '$equipment', '$status', 'change_status')"");
-                                                                               }
-                                                                               echo json_encode('OK');
-                                                                       }
-                                                                       break;
+            }
+            echo json_encode('OK');
+        }
+        break;

-                                                                       // Технологические этапы
-                                                                       case ""add_tplan_stage"":
-                                                                       case ""update_tplan_stage"":
-                                                                       include_once '../models/TplanStage.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               $data = [
-                                                                                       'name' => htmlspecialchars($_POST['name']),
-                                                                                       'equipment_count' => count($_POST['equipment']),
-                                                                                       'sort' => intval($_POST['sort']),
-                                                                                       'active' => (!empty($_POST['active'])) ? 1 : 0,
-                                                                                       'color' => htmlspecialchars($_POST['color']),
-                                                                                       'bg_color' => htmlspecialchars($_POST['bg_color'])
-                                                                               ];
+    // Технологические этапы
+    case ""add_tplan_stage"":
+    case ""update_tplan_stage"":
+        include_once '../models/TplanStage.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            $data = [
+                'name' => htmlspecialchars($_POST['name']),
+                'equipment_count' => count($_POST['equipment']),
+                'sort' => intval($_POST['sort']),
+                'active' => (!empty($_POST['active'])) ? 1 : 0,
+                'color' => htmlspecialchars($_POST['color']),
+                'bg_color' => htmlspecialchars($_POST['bg_color'])
+            ];

-                                                                               if ($_POST['action'] == 'add_tplan_stage') {
-                                                                                       TplanStage::insert($data);
-                                                                                       $id = TplanStage::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_tplan_stage') {
-                                                                                       TplanStage::update($data, $id);
-                                                                               }
+            if ($_POST['action'] == 'add_tplan_stage') {
+                TplanStage::insert($data);
+                $id = TplanStage::insertId();
+            }
+            if ($_POST['action'] == 'update_tplan_stage') {
+                TplanStage::update($data, $id);
+            }

-                                                                               // Обновляем оборудования
-                                                                               TplanStage::updateEquipments($id, $_POST['equipment']);
+            // Обновляем оборудования
+            TplanStage::updateEquipments($id, $_POST['equipment']);

-                                                                               header(""Location: ./?action=tplan_stage&id={$id}"");
-                                                                       }
-                                                                       break;
+            header(""Location: ./?action=tplan_stage&id={$id}"");
+        }
+        break;

-                                                                       // Технологические цепочки
-                                                                       case ""add_tplan_line"":
-                                                                       case ""update_tplan_line"":
-                                                                       include_once '../models/TplanLine.php';
-                                                                       include_once '../models/TplanLineTime.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               $data = [
-                                                                                       'name' => htmlspecialchars($_POST['name']),
-                                                                                       'active' => (!empty($_POST['active'])) ? 1 : 0,
-                                                                               ];
-                                                                               if ($_POST['action'] == 'add_tplan_line') {
-                                                                                       TplanLine::insert($data);
-                                                                                       $id = TplanLine::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_tplan_line') {
-                                                                                       TplanLine::update($data, $id);
-                                                                               }
+    // Технологические цепочки
+    case ""add_tplan_line"":
+    case ""update_tplan_line"":
+        include_once '../models/TplanLine.php';
+        include_once '../models/TplanLineTime.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            $data = [
+                'name' => htmlspecialchars($_POST['name']),
+                'active' => (!empty($_POST['active'])) ? 1 : 0,
+            ];
+            if ($_POST['action'] == 'add_tplan_line') {
+                TplanLine::insert($data);
+                $id = TplanLine::insertId();
+            }
+            if ($_POST['action'] == 'update_tplan_line') {
+                TplanLine::update($data, $id);
+            }

-                                                                               // Обновляем этапы
-                                                                               TplanLine::updateStages($id, $_POST);
+            // Обновляем этапы
+            TplanLine::updateStages($id, $_POST);

-                                                                               header(""Location: ./?action=tplan_line&id={$id}"");
-                                                                       }
-                                                                       break;
+            header(""Location: ./?action=tplan_line&id={$id}"");
+        }
+        break;

-                                                                       // Роли пользователей
-                                                                       case ""add_role"":
-                                                                       case ""update_role"":
-                                                                       include_once '../models/Role.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               seveLog(""role"");
-                                                                               $data = [
-                                                                                       'name' => htmlspecialchars($_POST['name']),
-                                                                               ];
+    // Роли пользователей
+    case ""add_role"":
+    case ""update_role"":
+        include_once '../models/Role.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            seveLog(""role"");
+            $data = [
+                'name' => htmlspecialchars($_POST['name']),
+            ];

-                                                                               if ($_POST['action'] == 'add_role') {
-                                                                                       Role::insert($data);
-                                                                                       $id = Role::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_role') {
-                                                                                       Role::update($data, $id);
-                                                                               }
+            if ($_POST['action'] == 'add_role') {
+                Role::insert($data);
+                $id = Role::insertId();
+            }
+            if ($_POST['action'] == 'update_role') {
+                Role::update($data, $id);
+            }

-                                                                               // Обновляем разрешенные действия
-                                                                               Role::updateActions($id, $_POST['actions']);
+            // Обновляем разрешенные действия
+            Role::updateActions($id, $_POST['actions']);

-                                                                               header(""Location: ./?action=role&id={$id}"");
-                                                                       }
-                                                                       break;
+            header(""Location: ./?action=role&id={$id}"");
+        }
+        break;

-                                                                       case ""add_tplan_order"":
-                                                                       case ""update_tplan_order"":
-                                                                       include_once '../models/TplanOrder.php';
-                                                                       include_once '../models/TplanOrderLine.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               $data = [
-                                                                                       'name' => htmlspecialchars($_POST['name']),
-                                                                                       'date_plan' => htmlspecialchars($_POST['date_plan']),
-                                                                                       'date_extra' => htmlspecialchars($_POST['date_extra']),
-                                                                               ];
-                                                                               if ($_POST['action'] == 'add_tplan_order') {
-                                                                                       TplanOrder::insert($data);
-                                                                                       $id = TplanOrder::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_tplan_order') {
-                                                                                       TplanOrder::update($data, $id);
-                                                                               }
+    case ""add_tplan_order"":
+    case ""update_tplan_order"":
+        include_once '../models/TplanOrder.php';
+        include_once '../models/TplanOrderLine.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            $data = [
+                'name' => htmlspecialchars($_POST['name']),
+                'date_plan' => htmlspecialchars($_POST['date_plan']),
+                'date_extra' => htmlspecialchars($_POST['date_extra']),
+            ];
+            if ($_POST['action'] == 'add_tplan_order') {
+                TplanOrder::insert($data);
+                $id = TplanOrder::insertId();
+            }
+            if ($_POST['action'] == 'update_tplan_order') {
+                TplanOrder::update($data, $id);
+            }

-                                                                               // Обновляем детали
-                                                                               TplanOrder::updateLines($id, $_POST['lines'], $_POST);
+            // Обновляем детали
+            TplanOrder::updateLines($id, $_POST['lines'], $_POST);

-                                                                               header(""Location: ./?action=tplan_order&id={$id}"");
-                                                                       }
-                                                                       break;
+            header(""Location: ./?action=tplan_order&id={$id}"");
+        }
+        break;

-                                                                       // Перемещение деталей
-                                                                       case ""update_tplan_matrix"":
-                                                                       include_once '../models/TplanMatrix.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               TplanMatrix::save($id, $_POST['equipments']);
-                                                                               header(""Location: ./?action=tplan_matrix_input&id={$id}"");
-                                                                       }
-                                                                       break;
+    // Перемещение деталей
+    case ""update_tplan_matrix"":
+        include_once '../models/TplanMatrix.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            TplanMatrix::save($id, $_POST['equipments']);
+            header(""Location: ./?action=tplan_matrix_input&id={$id}"");
+        }
+        break;

-                                                                       // Сохранение времени перемещения детали
-                                                                       case ""update_tplan_matrix_time"":
-                                                                       include_once '../models/TplanMatrix.php';
-                                                                       if (checkskey()) {
-                                                                               TplanMatrix::updateTime($_POST);
-                                                                               echo json_encode(['value'=>$_POST['value']]);
-                                                                       }
-                                                                       break;
+    // Сохранение времени перемещения детали
+    case ""update_tplan_matrix_time"":
+        include_once '../models/TplanMatrix.php';
+        if (checkskey()) {
+            TplanMatrix::updateTime($_POST);
+            echo json_encode(['value' => $_POST['value']]);
+        }
+        break;

-                                                                       // Сохранение отрезка сетки плана
-                                                                       case ""update_tplan"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               $noSave = $_POST['no_save'] ?? null;
-                                                                               $error = 0; // по умолчанию - нет ошибок
-                                                                               // Данные отрезка до перемещения
-                                                                               $barData = Tplan::getBarData(
-                                                                                       intval($_POST['order_line_id']),
-                                                                                       intval($_POST['stage_id']),
-                                                                                       htmlspecialchars($_POST['grid_date_start'])
-                                                                               );
-                                                                               // Если нужно сохранять
-                                                                               if (!$noSave) {
-                                                                                       // Если без ошибок, в barData возвращаем новые данные отрезка
-                                                                                       if (!$error = Tplan::save($_POST)) {
-                                                                                               $barData = Tplan::getBarData(
-                                                                                                       intval($_POST['order_line_id']),
-                                                                                                       intval($_POST['stage_id']),
-                                                                                                       htmlspecialchars($_POST['grid_date_start'])
-                                                                                               );
-                                                                                       }
-                                                                               }
-                                                                               echo json_encode([
-                                                                                       'error' => $error,
-                                                                                       'bar' => $barData,
-                                                                               ]);
-                                                                       }
-                                                                       break;
+    // Сохранение отрезка сетки плана
+    case ""update_tplan"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            $noSave = $_POST['no_save'] ?? null;
+            $error = 0; // по умолчанию - нет ошибок
+            // Данные отрезка до перемещения
+            $barData = Tplan::getBarData(
+                intval($_POST['order_line_id']),
+                intval($_POST['stage_id']),
+                htmlspecialchars($_POST['grid_date_start'])
+            );
+            // Если нужно сохранять
+            if (!$noSave) {
+                // Если без ошибок, в barData возвращаем новые данные отрезка
+                if (!$error = Tplan::save($_POST)) {
+                    $barData = Tplan::getBarData(
+                        intval($_POST['order_line_id']),
+                        intval($_POST['stage_id']),
+                        htmlspecialchars($_POST['grid_date_start'])
+                    );
+                }
+            }
+            echo json_encode([
+                'error' => $error,
+                'bar' => $barData,
+            ]);
+        }
+        break;

-                                                                       // Удаление отрезков сетки плана указанной детали и заказа
-                                                                       case ""delete_tplan"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               Tplan::deleteOrderLine(intval($_POST['order_line_id']), $_POST['with_order_line']??false);
-                                                                               echo json_encode(['ok'=>1]);
-                                                                       }
-                                                                       break;
+    // Удаление отрезков сетки плана указанной детали и заказа
+    case ""delete_tplan"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            Tplan::deleteOrderLine(intval($_POST['order_line_id']), $_POST['with_order_line'] ?? false);
+            echo json_encode(['ok' => 1]);
+        }
+        break;

-                                                                       // Удаление одного отрезка сетки плана указанной детали и заказа
-                                                                       case ""delete_one_bar"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               Tplan::delete(intval($_POST['order_line_id']), intval($_POST['stage_id']) );
-                                                                               echo json_encode(['ok'=>1]);
-                                                                       }
-                                                                       break;
+    // Удаление одного отрезка сетки плана указанной детали и заказа
+    case ""delete_one_bar"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            Tplan::delete(intval($_POST['order_line_id']), intval($_POST['stage_id']));
+            echo json_encode(['ok' => 1]);
+        }
+        break;

-                                                                       // Добавление на сетку отрезков в первые попавшиеся позиции
-                                                                       case ""insert_tplan"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               $result = Tplan::insertBarsGrid($_POST['date_start'], intval($_POST['order_line_id']));
-                                                                               echo json_encode(['ok' => $result]);
-                                                                       }
-                                                                       break;
+    // Добавление на сетку отрезков в первые попавшиеся позиции
+    case ""insert_tplan"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            $result = Tplan::insertBarsGrid($_POST['date_start'], intval($_POST['order_line_id']));
+            echo json_encode(['ok' => $result]);
+        }
+        break;

-                                                                       // Освобождаем время
-                                                                       case ""empty_time"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               $result = Tplan::emptyTime($_POST['date_start'], $_POST['date_end']);
-                                                                               echo json_encode(['ok' => $result]);
-                                                                       }
-                                                                       break;
+    // Освобождаем время
+    case ""empty_time"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            $result = Tplan::emptyTime($_POST['date_start'], $_POST['date_end']);
+            echo json_encode(['ok' => $result]);
+        }
+        break;

-                                                                       // Чистим сетку
-                                                                       case ""clear_matrix"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               $result = Tplan::clearMatrix($_POST['from']);
-                                                                               echo json_encode(['ok' => $result]);
-                                                                       }
-                                                                       break;
-                                                               }
+    // Чистим сетку
+    case ""clear_matrix"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            $result = Tplan::clearMatrix($_POST['from']);
+            echo json_encode(['ok' => $result]);
+        }
+        break;
+}
diff --git a/api3/objects/Devices.php b/api3/objects/Devices.php
index 99be0e6..2645599 100644
--- a/api3/objects/Devices.php
+++ b/api3/objects/Devices.php
@@ -6,10 +6,17 @@ require_once(__DIR__ . '/DeviceSettingsCurrent.php');

 class Devices extends CRUD {
     const DEFAULT_DEVICE_NAME = '[NEW]';
-    public function tableName(): string {
+
+    public function tableName(): string
+    {
         return 'devices';
     }
-    public function createEmpty($serialNumber = '') {
+
+    /**
+     * @return false|string
+     */
+    public function createEmpty($serialNumber = '')
+    {
         //if (!empty($serialNumber)) {
         //    $serialNumber = $this->real_escape_string($serialNumber);
         //}
@@ -36,23 +43,54 @@ class Devices extends CRUD {

         return $this->create($create);
     }
-    public function create(array $array, array $params = array()) {
+
+    /**
+     * @return false|string
+     */
+    public function create(array $array, array $params = array())
+    {
         //$sql_create_z_device =
         $device_id = parent::create($array, $params);
         if (empty($device_id)) {
             return $device_id;
         }
-        $sql_create_z_device = 'CREATE TABLE `z_device_'.$device_id.'` (`timestamp` datetime NOT NULL, `sensor` tinyint(1) unsigned NOT NULL, `data` float(7,2) NOT NULL, UNIQUE KEY `timestamp` (`timestamp`,`sensor`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8';
+        $sql_create_z_device = 'CREATE TABLE `z_device_' . $device_id . '` (`timestamp` datetime NOT NULL, `sensor` tinyint(1) unsigned NOT NULL, `data` float(7,2) NOT NULL, UNIQUE KEY `timestamp` (`timestamp`,`sensor`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8';
         //echo $sql_create_z_device,PHP_EOL;
         $this->query($sql_create_z_device);
-        $sql_create_z_device_arc = 'CREATE TABLE `z_device_'.$device_id.'_arc` ( `timestamp` datetime NOT NULL, `sensor` tinyint(1) unsigned NOT NULL, `data` float(7,2) NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8';
+        $sql_create_z_device_arc = 'CREATE TABLE `z_device_' . $device_id . '_arc` ( `timestamp` datetime NOT NULL, `sensor` tinyint(1) unsigned NOT NULL, `data` float(7,2) NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8';
         //echo $sql_create_z_device_arc,PHP_EOL;
         $this->query($sql_create_z_device_arc);

+        // Начало создания записи о гарантии на устройство
+        /** @var ModelDBT_DeviceWarranty $deviceWarranty */
+        $deviceWarranty = QCGA::API3()->objectFactory('ModelDBT_DeviceWarranty');
+        $deviceWarranty->createForCurrentCustomer($array['serialNumber']);
+        // Конец создания записи о гарантии на устройство
+
         return $device_id;
     }

-    public function delete(array $where) {
+
+    /**
+     * Метод не реализован, вернет null в любом случае.
+     * @return null
+     */
+    public function update(array $data, array $where = [])
+    {
+        // При реализации этого метода, не забыть про гарантии на устройства.
+        return null;
+//        //Начало создания записи о гарантии на устройство
+//        //Когда серийный номер устройства изменяется, предполагается, что это теперь другое устройство.
+//        if ($data['serialNumber'] !== $deviseData['serialNumber']) {
+//            /** @var ModelDBT_DeviceWarranty $deviceWarranty */
+//            $deviceWarranty = QCGA::API3()->objectFactory('ModelDBT_DeviceWarranty');
+//            $deviceWarranty->createForCurrentCustomer($array['serialNumber']);
+//        }
+//        //Конец создания записи о гарантии на устройство
+    }
+
+    public function delete(array $where): ?bool
+    {
         if (Util::isParameterIsEmpty($where, 'id') && Util::isParameterIsEmpty($where, 'serialNumber') ) {
             return false;
         }
@@ -125,7 +163,8 @@ class Devices extends CRUD {
         return parent::delete($where);
     }

-    function __construct($domain_name = '') {
+    function __construct($domain_name = '')
+    {
         parent::__construct($domain_name);
         $this->appendField('id', 'int(8) unsigned NOT NULL AUTO_INCREMENT PRIMARY KEY');
         $this->appendField('title', 'varchar(100) NOT NULL');
diff --git a/api3/objects/ModelDBT/ModelDBT_DeviceWarranty.php b/api3/objects/ModelDBT/ModelDBT_DeviceWarranty.php
new file mode 100644
index 0000000..90bbf3d
--- /dev/null
+++ b/api3/objects/ModelDBT/ModelDBT_DeviceWarranty.php
@@ -0,0 +1,150 @@
+<?php
+
+require_once(__DIR__ . '/../../ModelDBT.php');
+require_once(__DIR__ . '/../../../include/Util.php');
+require_once(__DIR__ . '/../../../include/qCanGlobalAccessor.php');
+
+/**
+ * <p><b>API3 модель для таблицы DeviceWarranty.</b></p><p>
+ * 'id' - идентификатор, авто инкремент.</p><p>
+ * 'device_serial' - серийный номер устройства.</p><p>
+ * 'organization_id' - id организации из таблицы organizations.</p><p>
+ * 'start_date' - дата начала эксплуатации устройства.</p><p>
+ * 'warranty_expiration_date' - дата истечения гаранитии на устройство.</p>
+ */
+class ModelDBT_DeviceWarranty extends ModelDBT
+{
+    private $deviceSerial = 'device_serial';
+    private $organizationId = 'organization_id';
+    private $startDate = 'start_date';
+    private $warrantyExpirationDate = 'warranty_expiration_date';
+
+    public function __construct($domain_name = '')
+    {
+        parent::__construct($domain_name);
+        $this->appendField($this->deviceSerial, 'VARCHAR(32)');
+        $this->appendField($this->organizationId, 'INT(6) UNSIGNED');
+        $this->appendField($this->startDate, 'DATETIME');
+        $this->appendField($this->warrantyExpirationDate, 'DATETIME');
+    }
+
+    /**
+     * Создает новую запись о гарантии на устройство, если для организации еще нет записи с таким серийным номером.
+     * @return false|string
+     */
+    public function createForCurrentCustomer(int $deviceSerial)
+    {
+        /** @var CurrentCustomer $currentCustomer */
+        $currentCustomer = QCGA::API3()->objectFactory('CurrentCustomer');
+        $organization = $currentCustomer->read();
+
+        return $this->create(['device_serial' => $deviceSerial, 'organization_id' => $organization['ID']]);
+    }
+
+    /**
+     * Создает новую запись о гарантии на устройство, если для организации еще нет записи с таким серийным номером.
+     * @return false|string
+     */
+    public function create(array $array, array $params = [])
+    {
+        $arrayKeysRequireIsEmptyChecking = [$this->deviceSerial, $this->organizationId,];
+        foreach ($arrayKeysRequireIsEmptyChecking as $key) {
+            if (Util::isParameterIsEmpty($array, $key)) {
+                if (Util::isParameterIsEmpty($params, 'debug')) {
+                    echo ""$key is empty"", PHP_EOL;
+                }
+
+                return false;
+            }
+        }
+
+        if ($this->read($array) !== []) {
+            return false;
+        }
+
+        /** @var GlobalSettings $globalSettings */
+        $globalSettings = QCGA::API3()->objectFactory('GlobalSettings');
+        $warrantySettings = $globalSettings->read(['name' => 'WARRANTY_PERIOD_MONTHS']);
+        $warrantyLength = $warrantySettings['value'];
+
+        $array[$this->startDate] = $array[$this->startDate] ?? date('Y-m-d H:i:s');
+        $date = DateTime::createFromFormat('Y-m-d H:i:s', $array[$this->startDate]);
+        $date->modify(""+$warrantyLength months"");
+        $array[$this->warrantyExpirationDate] = $date->format('Y-m-d H:i:s');
+
+        return parent::create($array, $params);
+    }
+
+    /**
+     * Создает запись о гарантии на устройство для каждого устройства, <u>каждой зарегистрированной организации</u>.
+     * Рассчет времени начала эксплуатации устройства производится на основании самой ранней записи в базе данных.
+     * Если устройство создано, но записей о его работе нет, время начала эксплуатации устанавливается равным текущему времени.
+     * @return array - отчет о выполненных записях
+     */
+    public function calculateWarrantyForAllCustomers(): array
+    {
+        $resultsReport = [];
+        /** @var Organizations $organizations */
+        $organizations = QCGA::API3()->objectFactory('Organizations');
+        $organizationData = $organizations->read();
+        foreach ($organizationData as $organization) {
+            $resultsReport += $this->calculateWarrantyForCustomerById($organization['ID']);
+        }
+
+        return $resultsReport;
+    }
+
+    /**
+     * Создает запись о гарантии на устройство для каждого устройства <u>одной</u> организации, по ID.
+     * Рассчет времени начала эксплуатации устройства производится на основании самой ранней записи в базе данных.
+     * Если устройство создано, но записей о его работе нет, время начала эксплуатации устанавливается равным текущему времени.
+     * @param int $id ID организации
+     * @return array - отчет о выполненных записях
+     */
+    public function calculateWarrantyForCustomerById(int $id): array
+    {
+        $resultsReport = [];
+        /** @var Organizations $organizations */
+        $organizations = QCGA::API3()->objectFactory('Organizations');
+        $orgData = $organizations->read(['ID' => $id]);
+
+        $domainName = $orgData['domen'];
+
+        /** @var Devices $devices */
+        $devices = QCGA::API3()->objectFactory('Devices', $domainName);
+        $devicesData = $devices->read();
+        foreach ($devicesData as $device) {
+            $deviceId = $device['id'];
+            $deviceSerial = $device['serialNumber'];
+            $tableName = 'z_device_' . $deviceId;
+            $sql = ""SELECT * FROM $tableName ORDER BY timestamp LIMIT 1"";
+
+            $connection = new mysqli($orgData['db_host'], $orgData['db_user'], $orgData['db_pass'], $orgData['db']);
+            if ($connection->connect_errno) {
+                $resultsReport[$domainName . ""_"" . $tableName] = ['conn_err' => $connection->connect_error];
+                continue;
+            }
+            $result = $connection->query($sql);
+            if ($result && $result->num_rows > 0) {
+                $row = $result->fetch_assoc();
+                $startDate = $row['timestamp'];
+                $creationResult = $this->create([
+                    $this->deviceSerial => $deviceSerial,
+                    $this->organizationId => $id,
+                    $this->startDate => $startDate,
+                ]);
+            } else {
+                $creationResult = $this->create([$this->deviceSerial => $deviceSerial, $this->organizationId => $id]);
+            }
+            $resultsReport[$domainName . ""_"" . $tableName] = ['creation_result' => $creationResult];
+            $result->free_result();
+        }
+
+        return $resultsReport;
+    }
+
+    public function db_connection(): mysqli
+    {
+        return QCGA::getCore()->getDbMasterConnection();
+    }
+}
diff --git a/api3/objects/ModelDBT/ModelDBT_ToolMaintenance.php b/api3/objects/ModelDBT/ModelDBT_ToolMaintenance.php
index da073e3..2e6ce18 100644
--- a/api3/objects/ModelDBT/ModelDBT_ToolMaintenance.php
+++ b/api3/objects/ModelDBT/ModelDBT_ToolMaintenance.php
@@ -3,6 +3,14 @@
 require_once(__DIR__ . '/../../ModelDBT.php');
 require_once(__DIR__ . '/../../../include/Util.php');

+/**
+ * <p><b>API3 модель для работы с таблицей ToolMaintenance.</b></p><p>
+ * 'id' - идентификатор ТО, авто инкремент.</p><p>
+ * 'maintenance_date' - дата и время создания записи о ТО.</p><p>
+ * 'instrument_id' - id инструмента из таблицы instrument.</p><p>
+ * 'cycles_at_maintenance' - количество циклов работы инструмента на момент ТО.</p><p>
+ * 'user_id' - id пользователя из таблицы users.</p>
+ */
 class ModelDBT_ToolMaintenance extends ModelDBT
 {
     public function __construct($domain_name = '')
@@ -20,28 +28,32 @@ class ModelDBT_ToolMaintenance extends ModelDBT
     /**
      * @return false|string
      */
-    public function create(array $array, array $params = array())
+    public function create(array $array, array $params = [])
     {
         if (Util::isParameterIsEmpty($array, 'instrument_id')) {
             if (Util::isParameterIsEmpty($params, 'debug')) {
                 echo 'instrument_id is empty', PHP_EOL;
             }
+
             return false;
         }
         if (Util::isParameterIsEmpty($array, 'cycles_at_maintenance')) {
             if (Util::isParameterIsEmpty($params, 'debug')) {
                 echo 'cycles_at_maintenance is empty', PHP_EOL;
             }
+
             return false;
         }
         if (Util::isParameterIsEmpty($array, 'user_id')) {
             if (Util::isParameterIsEmpty($params, 'debug')) {
                 echo 'user_id is empty', PHP_EOL;
             }
+
             return false;
         }
         $array['maintenance_date'] = Util::currentCustomerNow();
+
         return parent::create($array, $params);
     }

-}
\ No newline at end of file
+}
diff --git a/api3/objects/ModelDBT/ModelDBT_Tools.php b/api3/objects/ModelDBT/ModelDBT_Tools.php
index 3d81026..021778f 100644
--- a/api3/objects/ModelDBT/ModelDBT_Tools.php
+++ b/api3/objects/ModelDBT/ModelDBT_Tools.php
@@ -3,6 +3,14 @@
 require_once(__DIR__ . '/../../ModelDBT.php');
 require_once(__DIR__ . '/../../../include/Util.php');

+/**
+ * <p><b>API3 модель для работы с таблицей instrument.</b></p><p>
+ * 'id' - идентификатор инструмента, авто инкремент.</p><p>
+ * 'name' - название инструмента.</p><p>
+ * 'cycles_before_to' - количество циклов работы инструмента до планового ТО.</p><p>
+ * 'divider' - делитель (что бы это не значило).</p><p>
+ * 'publish' - флаг публикации.</p>
+ */
 class ModelDBT_Tools extends ModelDBT
 {
     public function __construct($domain_name = '')
@@ -18,4 +26,4 @@ class ModelDBT_Tools extends ModelDBT
     {
         return 'instrument';
     }
-}
\ No newline at end of file
+}
diff --git a/api3/objects/Report/ReportToolList.php b/api3/objects/Report/ReportToolList.php
index 8cef454..89f88ea 100644
--- a/api3/objects/Report/ReportToolList.php
+++ b/api3/objects/Report/ReportToolList.php
@@ -30,7 +30,7 @@ class ReportToolList extends Report
             $result = $this->query($sql);
             if ($result && $result->num_rows > 0) {
                 $row = $result->fetch_assoc();
-                $maintenanceDate = $row['last_maintenance_date'];
+                $maintenanceDate = $row['last_maintenance_date'] ?? 0;
             } else {
                 $maintenanceDate = 0;
             }
"
eLrw7ysF,Untitled,tabr,Diff,Monday 1st of April 2024 12:20:38 PM CDT,"diff --git a/admin/save_data.php b/admin/save_data.php
index 07c026b..9395bc1 100644
--- a/admin/save_data.php
+++ b/admin/save_data.php
@@ -3,6 +3,7 @@ include('../config.php');
 include('../connect_db.php');
 include('../functions.php');
 require_once(__DIR__ . '/../include/TimeZone.php');
+require_once(__DIR__ . '/../include/Util.php');
 require_once(__DIR__ . '/../api3/objects/DeviceSettingsStorage.php');
 require_once(__DIR__ . '/../api3/objects/DeviceSettingsCurrent.php');
 require_once(__DIR__ . '/../api3/objects/Devices.php');
@@ -13,686 +14,692 @@ error_reporting(1);
 $_POST[u] = $_COOKIE[u];

 if ($_POST[action]) {
-       $res = mysql_query(""select * from users where id in (select userID from session where session='$_POST[u]')"");
-       if ($res and mysql_num_rows($res)>0) {
-               $userData = mysql_fetch_array($res);
-       }
-       if ($userData[email]) mysql_query(""insert save_log (user, action, query) values ('$userData[email]', '$_POST[action]', '"".print_r($_POST,true).""')"");
+    $res = mysql_query(""select * from users where id in (select userID from session where session='$_POST[u]')"");
+    if ($res and mysql_num_rows($res) > 0) {
+        $userData = mysql_fetch_array($res);
+    }
+    if ($userData[email]) mysql_query(""insert save_log (user, action, query) values ('$userData[email]', '$_POST[action]', '"" . print_r($_POST, true) . ""')"");
 }

 switch ($_POST[action]) {
-       case ""del_defect_type"":
-               mysql_query(""delete from defect_type where id='{$_POST['id']}'"");
-               mysql_query(""delete from defect_type_equipment where defect_type_id='{$_POST['id']}'"");
-               mysql_query(""delete from defect_type_production_group where defect_type_id='{$_POST['id']}'"");
-               header(""Location: ./?action=defect_type"");
-       break;
-       case ""add_del_defect"":
-               mysql_query(""insert defect_type (name, dop_id) values ('{$_POST['name']}', '{$_POST['dop_id']}')"");
-               $defect_type_id = mysql_insert_id();
-               foreach ($_POST['defect_type_equipment'] as $key => $value) {
-                       mysql_query(""insert defect_type_equipment (defect_type_id, equipment_group) values ('{$defect_type_id}', '{$value}')"");
-               }
-               foreach ($_POST['defect_type_production_group'] as $key => $value) {
-                       mysql_query(""insert defect_type_production_group (defect_type_id, production_group) values ('{$defect_type_id}', '{$value}')"");
-               }
-               header(""Location: ./?action=defect_type&id="".$defect_type_id);
-       break;
-       case ""update_defect_type"":
-               mysql_query(""update defect_type set name='{$_POST['name']}', dop_id='{$_POST['dop_id']}' where id='{$_POST['id']}'"");
-               mysql_query(""delete from defect_type_equipment  where defect_type_id='{$_POST['id']}'"");
-               foreach ($_POST['defect_type_equipment'] as $key => $value) {
-                       mysql_query(""insert defect_type_equipment (defect_type_id, equipment_group) values ('{$_POST['id']}', '{$value}')"");
-               }
-               mysql_query(""delete from defect_type_production_group  where defect_type_id='{$_POST['id']}'"");
-               foreach ($_POST['defect_type_production_group'] as $key => $value) {
-                       mysql_query(""insert defect_type_production_group (defect_type_id, production_group) values ('{$_POST['id']}', '{$value}')"");
-               }
-               header(""Location: ./?action=defect_type&id="".$_POST['id']);
-       break;
-       case ""create_downtime_correction"":
-               $res = mysql_query(""select * from arm_tablo where update_time='{$_POST[time]}' and arm_serial='{$_POST['serial']}'"");
-               if ($res and mysql_num_rows($res)>0) {
-                       while ($r = mysql_fetch_assoc($res)) {
-                               $original = $r;
-                       }
-               }
-               mysql_query(""insert arm_tablo_downtime_correction (update_time, arm_serial, user_modificator, downtime, comment) values ('{$_POST[time]}', '{$_POST['serial']}', '{$userData['id']}', '{$original['downtime']}', '{$original[
-               mysql_query(""update arm_tablo set comment='{$_POST['comment']}', downtime='{$_POST['downtime']}' where update_time='{$_POST['time']}' and arm_serial='{$_POST['serial']}'"");
-               header(""Location: ./?action=downtime_report&from={$_POST[from]}&from_time={$_POST[from_time]}&to={$_POST[to]}&to_time={$_POST[to_time]}"");
-       break;
-       case ""delete_downtime_correction"":
-               print_r($_POST);
-               $res = mysql_query(""select * from arm_tablo_downtime_correction where update_time='{$_POST[time]}'"");
-               if ($res and mysql_num_rows($res)>0) {
-                       while ($r = mysql_fetch_assoc($res)) {
-                               $correction = $r;
-                       }
-               }
-               //print_r($correction);
-               mysql_query(""update arm_tablo set comment='{$correction['comment']}', downtime='{$correction['downtime']}' where update_time='{$_POST['time']}'"");
-               mysql_query(""delete from arm_tablo_downtime_correction where update_time='{$_POST['time']}'"");
-               header(""Location: ./?action=downtime_report&from={$_POST[from]}&from_time={$_POST[from_time]}&to={$_POST[to]}&to_time={$_POST[to_time]}"");
-       break;
-       case ""delete_defect_correction"":
-               $sql = ""delete from arm_defect where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"";
-               mysql_query($sql);
-               $sql = ""insert arm_defect select arm_serial, time, user, nom, mat, inst, defect, comment, defect_type from arm_defect_correction where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"";
-               mysql_query($sql);
-               // echo $sql;
-               // exit;
-               mysql_query(""delete from arm_defect_correction where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"");
-               header(""Location: ./?action=defect2&id={$_POST['id']}&from={$_POST[date_from]}&from_time={$_POST[time_from]}&to={$_POST[date_to]}&to_time={$_POST[time_to]}"");
-       break;
-       case ""create_defect_correction"":
-               $sql = ""insert into arm_defect_correction select *, '{$userData[id]}' as user_modificator from arm_defect where time='{$_POST[time]}' and arm_serial='{$_POST[arm]}'"";
-               // echo $sql;
-               // exit;
-               mysql_query($sql);
-               $sql = ""update arm_defect set defect='{$_POST[defect]}', comment='{$_POST[comment]}', defect_type='{$_POST[defect_type]}' where time='{$_POST[time]}' and arm_serial='{$_POST[arm]}'"";
-               mysql_query($sql);
-               header(""Location: ./?action=defect2&id={$_POST['id']}&from={$_POST[date_from]}&from_time={$_POST[time_from]}&to={$_POST[date_to]}&to_time={$_POST[time_to]}"");
-       break;
-       case ""del_correction"":
-               mysql_query(""delete from arm_circuit where time_begin='{$_POST[id]}'"");
-               mysql_query(""insert arm_circuit select arm_serial, time_begin, time_end, user, nom, mat, inst, multiplicator, consumption from arm_circuit_correction where time_begin='{$_POST[id]}'"");
-               mysql_query(""delete from arm_circuit_correction where time_begin='{$_POST[id]}'"");
-               header(""Location: ./?action=production_correction&id={$_POST['id']}"");
-       break;
-       case ""create_correction"":
-               $res = mysql_query(""select * from production where id='{$_POST[nom]}'"");
-               if ($res and mysql_num_rows($res)>0) {
-                       while ($r = mysql_fetch_assoc($res)) {
-                               $consumption = $r[consumption];
-                               $multiplicator = $r[multiplicator];
-                       }
-               }
-               mysql_query(""insert into arm_circuit_correction select *, '{$_POST[user_modificator]}' as user_modificator from arm_circuit where time_begin='{$_POST[id]}'"");
-               mysql_query(""update arm_circuit set multiplicator='{$multiplicator}', consumption='{$consumption}', nom='{$_POST[nom]}', mat='{$_POST[mat]}', inst='{$_POST[inst]}' where time_begin='{$_POST[id]}'"");
-               header(""Location: ./?action=production_correction&id={$_POST['id']}"");
-       break;
-       case ""arm_message"":
-               mysql_query(""insert arm_message (arm_serial, message, sender) values ('{$_POST[id]}', '{$_POST['message']}', '{$_POST['sender']}')"");
-       break;
-       case ""update_event_conditions"":
-       if (checkskey($_POST['id'])) {
-               if ($_POST[downtime_id] and $_POST[downtime_duration] and $_POST['type'] == 'downtime_continue') {
-                       $params = ""params='{\""id\"" : {$_POST[downtime_id]}, \""duration\"" : {$_POST[downtime_duration]} }', "";
-               }
-               mysql_query(""update event_conditions set {$params} type='{$_POST['type']}', equipment_id='"".implode(',',$_POST['equipment_id']).""', admin_id='"".implode(',',$_POST['admin_id']).""', pause='{$_POST['pause']}', counter='{$_PO
-       }
-       header(""Location: ./?action=event_conditions&id={$_POST['id']}"");
-       break;
-       case ""add_event_conditions"":
-       if (checkskey()) {
-               $params = '';
-               if ($_POST[downtime_id] and $_POST[downtime_duration]) {
-                       $params = ""{\""id\"" : {$_POST[downtime_id]}, \""duration\"" : {$_POST[downtime_duration]} }"";
-               }
-               $sql = ""insert event_conditions (params, type, equipment_id, admin_id, pause, counter, back_time) values ('{$params}', '{$_POST['type']}', '"".implode(',',$_POST['equipment_id']).""', '"".implode(',',$_POST['admin_id']).""',
-               mysql_query($sql);
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=event_conditions&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=event_conditions&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=event_conditions"");
-       }
-       break;
-       case ""del_plan_downtime"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from plan_downtime where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=plan_downtime"");
-       break;
+    case ""del_defect_type"":
+        mysql_query(""delete from defect_type where id='{$_POST['id']}'"");
+        mysql_query(""delete from defect_type_equipment where defect_type_id='{$_POST['id']}'"");
+        mysql_query(""delete from defect_type_production_group where defect_type_id='{$_POST['id']}'"");
+        header(""Location: ./?action=defect_type"");
+        break;
+    case ""add_del_defect"":
+        mysql_query(""insert defect_type (name, dop_id) values ('{$_POST['name']}', '{$_POST['dop_id']}')"");
+        $defect_type_id = mysql_insert_id();
+        foreach ($_POST['defect_type_equipment'] as $key => $value) {
+            mysql_query(""insert defect_type_equipment (defect_type_id, equipment_group) values ('{$defect_type_id}', '{$value}')"");
+        }
+        foreach ($_POST['defect_type_production_group'] as $key => $value) {
+            mysql_query(""insert defect_type_production_group (defect_type_id, production_group) values ('{$defect_type_id}', '{$value}')"");
+        }
+        header(""Location: ./?action=defect_type&id="" . $defect_type_id);
+        break;
+    case ""update_defect_type"":
+        mysql_query(""update defect_type set name='{$_POST['name']}', dop_id='{$_POST['dop_id']}' where id='{$_POST['id']}'"");
+        mysql_query(""delete from defect_type_equipment  where defect_type_id='{$_POST['id']}'"");
+        foreach ($_POST['defect_type_equipment'] as $key => $value) {
+            mysql_query(""insert defect_type_equipment (defect_type_id, equipment_group) values ('{$_POST['id']}', '{$value}')"");
+        }
+        mysql_query(""delete from defect_type_production_group  where defect_type_id='{$_POST['id']}'"");
+        foreach ($_POST['defect_type_production_group'] as $key => $value) {
+            mysql_query(""insert defect_type_production_group (defect_type_id, production_group) values ('{$_POST['id']}', '{$value}')"");
+        }
+        header(""Location: ./?action=defect_type&id="" . $_POST['id']);
+        break;
+    case ""create_downtime_correction"":
+        $res = mysql_query(""select * from arm_tablo where update_time='{$_POST[time]}' and arm_serial='{$_POST['serial']}'"");
+        if ($res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $original = $r;
+            }
+        }
+        mysql_query(""insert arm_tablo_downtime_correction (update_time, arm_serial, user_modificator, downtime, comment) values ('{$_POST[time]}', '{$_POST['serial']}', '{$userData['id']}', '{$original['downtime']}', '{$original['commen
+        mysql_query(""update arm_tablo set comment='{$_POST['comment']}', downtime='{$_POST['downtime']}' where update_time='{$_POST['time']}' and arm_serial='{$_POST['serial']}'"");
+        header(""Location: ./?action=downtime_report&from={$_POST[from]}&from_time={$_POST[from_time]}&to={$_POST[to]}&to_time={$_POST[to_time]}"");
+        break;
+    case ""delete_downtime_correction"":
+        print_r($_POST);
+        $res = mysql_query(""select * from arm_tablo_downtime_correction where update_time='{$_POST[time]}'"");
+        if ($res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $correction = $r;
+            }
+        }
+        //print_r($correction);
+        mysql_query(""update arm_tablo set comment='{$correction['comment']}', downtime='{$correction['downtime']}' where update_time='{$_POST['time']}'"");
+        mysql_query(""delete from arm_tablo_downtime_correction where update_time='{$_POST['time']}'"");
+        header(""Location: ./?action=downtime_report&from={$_POST[from]}&from_time={$_POST[from_time]}&to={$_POST[to]}&to_time={$_POST[to_time]}"");
+        break;
+    case ""delete_defect_correction"":
+        $sql = ""delete from arm_defect where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"";
+        mysql_query($sql);
+        $sql = ""insert arm_defect select arm_serial, time, user, nom, mat, inst, defect, comment, defect_type from arm_defect_correction where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"";
+        mysql_query($sql);
+        // echo $sql;
+        // exit;
+        mysql_query(""delete from arm_defect_correction where time='{$_POST[id]}' and arm_serial='{$_POST[arm]}'"");
+        header(""Location: ./?action=defect2&id={$_POST['id']}&from={$_POST[date_from]}&from_time={$_POST[time_from]}&to={$_POST[date_to]}&to_time={$_POST[time_to]}"");
+        break;
+    case ""create_defect_correction"":
+        $sql = ""insert into arm_defect_correction select *, '{$userData[id]}' as user_modificator from arm_defect where time='{$_POST[time]}' and arm_serial='{$_POST[arm]}'"";
+        // echo $sql;
+        // exit;
+        mysql_query($sql);
+        $sql = ""update arm_defect set defect='{$_POST[defect]}', comment='{$_POST[comment]}', defect_type='{$_POST[defect_type]}' where time='{$_POST[time]}' and arm_serial='{$_POST[arm]}'"";
+        mysql_query($sql);
+        header(""Location: ./?action=defect2&id={$_POST['id']}&from={$_POST[date_from]}&from_time={$_POST[time_from]}&to={$_POST[date_to]}&to_time={$_POST[time_to]}"");
+        break;
+    case ""del_correction"":
+        mysql_query(""delete from arm_circuit where time_begin='{$_POST[id]}'"");
+        mysql_query(""insert arm_circuit select arm_serial, time_begin, time_end, user, nom, mat, inst, multiplicator, consumption from arm_circuit_correction where time_begin='{$_POST[id]}'"");
+        mysql_query(""delete from arm_circuit_correction where time_begin='{$_POST[id]}'"");
+        header(""Location: ./?action=production_correction&id={$_POST['id']}"");
+        break;
+    case ""create_correction"":
+        $res = mysql_query(""select * from production where id='{$_POST[nom]}'"");
+        if ($res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $consumption = $r[consumption];
+                $multiplicator = $r[multiplicator];
+            }
+        }
+        mysql_query(""insert into arm_circuit_correction select *, '{$_POST[user_modificator]}' as user_modificator from arm_circuit where time_begin='{$_POST[id]}'"");
+        mysql_query(""update arm_circuit set multiplicator='{$multiplicator}', consumption='{$consumption}', nom='{$_POST[nom]}', mat='{$_POST[mat]}', inst='{$_POST[inst]}' where time_begin='{$_POST[id]}'"");
+        header(""Location: ./?action=production_correction&id={$_POST['id']}"");
+        break;
+    case ""arm_message"":
+        mysql_query(""insert arm_message (arm_serial, message, sender) values ('{$_POST[id]}', '{$_POST['message']}', '{$_POST['sender']}')"");
+        break;
+    case ""update_event_conditions"":
+        if (checkskey($_POST['id'])) {
+            if ($_POST[downtime_id] and $_POST[downtime_duration] and $_POST['type'] == 'downtime_continue') {
+                $params = ""params='{\""id\"" : {$_POST[downtime_id]}, \""duration\"" : {$_POST[downtime_duration]} }', "";
+            }
+            mysql_query(""update event_conditions set {$params} type='{$_POST['type']}', equipment_id='"" . implode(',', $_POST['equipment_id']) . ""', admin_id='"" . implode(',', $_POST['admin_id']) . ""', pause='{$_POST['pause']}', counter
+        }
+        header(""Location: ./?action=event_conditions&id={$_POST['id']}"");
+        break;
+    case ""add_event_conditions"":
+        if (checkskey()) {
+            $params = '';
+            if ($_POST[downtime_id] and $_POST[downtime_duration]) {
+                $params = ""{\""id\"" : {$_POST[downtime_id]}, \""duration\"" : {$_POST[downtime_duration]} }"";
+            }
+            $sql = ""insert event_conditions (params, type, equipment_id, admin_id, pause, counter, back_time) values ('{$params}', '{$_POST['type']}', '"" . implode(',', $_POST['equipment_id']) . ""', '"" . implode(',', $_POST['admin_id'])
+            mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=event_conditions&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=event_conditions&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=event_conditions"");
+        }
+        break;
+    case ""del_plan_downtime"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from plan_downtime where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=plan_downtime"");
+        break;

-       case ""del_plan_oee"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from plan_oee where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=plan_oee"");
-       break;
+    case ""del_plan_oee"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from plan_oee where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=plan_oee"");
+        break;

-       case ""update_plan_oee"":
-       mysql_query(""update plan_oee set year='{$_POST['year']}', month='{$_POST['month']}', param='{$_POST['param']}', percent='{$_POST['percent']}', user='{$userData['id']}' where id='{$_POST['id']}'"");
-       header(""Location: ./?action=plan_oee&id={$_POST['id']}&msg=1"");
-       break;
+    case ""update_plan_oee"":
+        mysql_query(""update plan_oee set year='{$_POST['year']}', month='{$_POST['month']}', param='{$_POST['param']}', percent='{$_POST['percent']}', user='{$userData['id']}' where id='{$_POST['id']}'"");
+        header(""Location: ./?action=plan_oee&id={$_POST['id']}&msg=1"");
+        break;

-       case ""add_plan_oee"":
-       $sql = ""select * from plan_oee where year='{$_POST[year]}' and month='{$_POST[month]}' and param='{$_POST[param]}'"";
-       $res = mysql_query($sql);
-       if ($res and mysql_num_rows($res)>0) {
-               header(""Location: ./?action=plan_oee&id={$_POST['id']}&msg=3"");
-         exit;
-       } else {
-               $sql = ""insert plan_oee (year, month, param, percent, user) values ('{$_POST['year']}', '{$_POST['month']}', '{$_POST['param']}', '{$_POST['percent']}', '{$userData['id']}')"";
-               mysql_query($sql);
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=plan_oee&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=plan_oee&id={$id}&msg=2"");
-               }
-       }
-       break;
+    case ""add_plan_oee"":
+        $sql = ""select * from plan_oee where year='{$_POST[year]}' and month='{$_POST[month]}' and param='{$_POST[param]}'"";
+        $res = mysql_query($sql);
+        if ($res and mysql_num_rows($res) > 0) {
+            header(""Location: ./?action=plan_oee&id={$_POST['id']}&msg=3"");
+            exit;
+        } else {
+            $sql = ""insert plan_oee (year, month, param, percent, user) values ('{$_POST['year']}', '{$_POST['month']}', '{$_POST['param']}', '{$_POST['percent']}', '{$userData['id']}')"";
+            mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=plan_oee&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=plan_oee&id={$id}&msg=2"");
+            }
+        }
+        break;

-       case ""del_event_conditions"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from event_conditions where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=event_conditions"");
-       break;
-       case ""update_plan_downtime"":
-       mysql_query(""update plan_downtime set equipment_id='{$_POST['equipment_id']}', comment='{$_POST['comment']}', begin_time='{$_POST['begin_date']} {$_POST['begin_time']}', duration='{$_POST['duration']}' where id='{$_POST['id']}'"")
-       header(""Location: ./?action=plan_downtime&id={$_POST['id']}"");
-       break;
+    case ""del_event_conditions"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from event_conditions where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=event_conditions"");
+        break;
+    case ""update_plan_downtime"":
+        mysql_query(""update plan_downtime set equipment_id='{$_POST['equipment_id']}', comment='{$_POST['comment']}', begin_time='{$_POST['begin_date']} {$_POST['begin_time']}', duration='{$_POST['duration']}' where id='{$_POST['id']}'""
+        header(""Location: ./?action=plan_downtime&id={$_POST['id']}"");
+        break;

-       case ""add_plan_downtime"":
-       if (checkskey()) {
-               mysql_query(""insert plan_downtime (equipment_id, begin_time, duration, comment) values ('{$_POST['equipment_id']}', '{$_POST['begin_date']} {$_POST['begin_time']}', '{$_POST['duration']}', '{$_POST['comment']}')"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=plan_downtime&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=plan_downtime&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=plan_downtime"");
-       }
-       break;
+    case ""add_plan_downtime"":
+        if (checkskey()) {
+            mysql_query(""insert plan_downtime (equipment_id, begin_time, duration, comment) values ('{$_POST['equipment_id']}', '{$_POST['begin_date']} {$_POST['begin_time']}', '{$_POST['duration']}', '{$_POST['comment']}')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=plan_downtime&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=plan_downtime&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=plan_downtime"");
+        }
+        break;

-       case ""update_plan_smena"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""update plan_smena set date='{$_POST['date']}', shift='{$_POST['shift']}', equipment_id='{$_POST['equipment_id']}', emp_id='{$_POST['emp_id']}', nom='{$_POST['nom']}', mat='{$_POST['mat']}', inst='{$_POST['ins
-       }
-       header(""Location: ./?action=plan_smena&id={$_POST['id']}&msg=1"");
-       break;
-       case ""add_plan_smena"":
-       if (checkskey()) {
-               mysql_query(""insert plan_smena (date, shift, equipment_id, emp_id, nom, mat, inst, quantity) values ('{$_POST['date']}', '{$_POST['shift']}', '{$_POST['equipment_id']}', '{$_POST['emp_id']}', '{$_POST['nom']}', '{$_POST['
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=plan_smena&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=plan_smena&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=plan_smena"");
-       }
-       break;
-       case ""del_plan_smena"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from plan_smena where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=plan_smena"");
-       break;
-       case ""del_time_interval"":
-       if (checkskey($_POST['id'])) {
-               seveLog(""time_interval"");
-               mysql_query(""delete from time_interval where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=time_interval"");
-       break;
-       case ""update_time_interval"":
-       if (checkskey($_POST['id'])) {
-               seveLog(""time_interval"");
-               $tb = explode(':',$_POST['time_begin']);
-               if (strlen($tb[0])<2) {
-                       $_POST['time_begin'] = '0'.$_POST['time_begin'];
-               }
-               $tb = explode(':',$_POST['time_end']);
-               if (strlen($tb[0])<2) {
-                       $_POST['time_end'] = '0'.$_POST['time_end'];
-               }
-               $res = mysql_query(""update time_interval set name='{$_POST['name']}', time_begin='{$_POST['time_begin']}', time_end='{$_POST['time_end']}' where id='{$_POST['id']}'"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       header(""Location: ./?action=time_interval&id={$_POST['id']}&msg=1"");
-               } else {
-                       header(""Location: ./?action=time_interval&id={$_POST['id']}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=time_interval&&id={$_POST['id']}&msg=3"");
-       }
-       break;
-       case ""add_time_interval"":
-       if (checkskey()) {
-               seveLog(""time_interval"");
-               $tb = explode(':',$_POST['time_begin']);
-               if (strlen($tb[0])<2) {
-                       $_POST['time_begin'] = '0'.$_POST['time_begin'];
-               }
-               $tb = explode(':',$_POST['time_end']);
-               if (strlen($tb[0])<2) {
-                       $_POST['time_end'] = '0'.$_POST['time_end'];
-               }
-               $res = mysql_query(""insert time_interval (name, time_begin, time_end) values ('{$_POST['name']}', '{$_POST['time_begin']}', '{$_POST['time_end']}')"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=time_interval&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=time_interval&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=time_interval&&id={$_POST['id']}&msg=3"");
-       }
-       break;
-       case ""del_news"":
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from news where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=news_admin"");
-       break;
-       case ""update_news"":
-       if (checkskey($_POST['id'])) {
-               $res = mysql_query(""update news set title='{$_POST['title']}', date='{$_POST['date']}', content='{$_POST['content']}', publish="".($_POST['publish'] ? 1 : 0)."" where id='{$_POST['id']}'"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       header(""Location: ./?action=news_admin&id={$_POST['id']}&msg=1"");
-               } else {
-                       header(""Location: ./?action=news_admin&id={$_POST['id']}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=news_admin&&id={$_POST['id']}&msg=3"");
-       }
-       break;
-       case ""add_news"":
-       if (checkskey()) {
-               $res = mysql_query(""insert news (title, date, content, publish ) values ('{$_POST['title']}', '{$_POST['date']}', '{$_POST['content']}', "".($_POST['publish'] ? 1 : 0)."")"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=news_admin&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=news_admin&id={$id}&msg=2"");
-               }
-       } else {
-               header(""Location: ./?action=news_admin&&id={$_POST['id']}&msg=3"");
-       }
-       break;
+    case ""update_plan_smena"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""update plan_smena set date='{$_POST['date']}', shift='{$_POST['shift']}', equipment_id='{$_POST['equipment_id']}', emp_id='{$_POST['emp_id']}', nom='{$_POST['nom']}', mat='{$_POST['mat']}', inst='{$_POST['inst']
+        }
+        header(""Location: ./?action=plan_smena&id={$_POST['id']}&msg=1"");
+        break;
+    case ""add_plan_smena"":
+        if (checkskey()) {
+            mysql_query(""insert plan_smena (date, shift, equipment_id, emp_id, nom, mat, inst, quantity) values ('{$_POST['date']}', '{$_POST['shift']}', '{$_POST['equipment_id']}', '{$_POST['emp_id']}', '{$_POST['nom']}', '{$_POST['mat
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=plan_smena&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=plan_smena&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=plan_smena"");
+        }
+        break;
+    case ""del_plan_smena"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from plan_smena where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=plan_smena"");
+        break;
+    case ""del_time_interval"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""time_interval"");
+            mysql_query(""delete from time_interval where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=time_interval"");
+        break;
+    case ""update_time_interval"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""time_interval"");
+            $tb = explode(':', $_POST['time_begin']);
+            if (strlen($tb[0]) < 2) {
+                $_POST['time_begin'] = '0' . $_POST['time_begin'];
+            }
+            $tb = explode(':', $_POST['time_end']);
+            if (strlen($tb[0]) < 2) {
+                $_POST['time_end'] = '0' . $_POST['time_end'];
+            }
+            $res = mysql_query(""update time_interval set name='{$_POST['name']}', time_begin='{$_POST['time_begin']}', time_end='{$_POST['time_end']}' where id='{$_POST['id']}'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=time_interval&id={$_POST['id']}&msg=1"");
+            } else {
+                header(""Location: ./?action=time_interval&id={$_POST['id']}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=time_interval&&id={$_POST['id']}&msg=3"");
+        }
+        break;
+    case ""add_time_interval"":
+        if (checkskey()) {
+            seveLog(""time_interval"");
+            $tb = explode(':', $_POST['time_begin']);
+            if (strlen($tb[0]) < 2) {
+                $_POST['time_begin'] = '0' . $_POST['time_begin'];
+            }
+            $tb = explode(':', $_POST['time_end']);
+            if (strlen($tb[0]) < 2) {
+                $_POST['time_end'] = '0' . $_POST['time_end'];
+            }
+            $res = mysql_query(""insert time_interval (name, time_begin, time_end) values ('{$_POST['name']}', '{$_POST['time_begin']}', '{$_POST['time_end']}')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=time_interval&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=time_interval&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=time_interval&&id={$_POST['id']}&msg=3"");
+        }
+        break;
+    case ""del_news"":
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from news where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=news_admin"");
+        break;
+    case ""update_news"":
+        if (checkskey($_POST['id'])) {
+            $res = mysql_query(""update news set title='{$_POST['title']}', date='{$_POST['date']}', content='{$_POST['content']}', publish="" . ($_POST['publish'] ? 1 : 0) . "" where id='{$_POST['id']}'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=news_admin&id={$_POST['id']}&msg=1"");
+            } else {
+                header(""Location: ./?action=news_admin&id={$_POST['id']}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=news_admin&&id={$_POST['id']}&msg=3"");
+        }
+        break;
+    case ""add_news"":
+        if (checkskey()) {
+            $res = mysql_query(""insert news (title, date, content, publish ) values ('{$_POST['title']}', '{$_POST['date']}', '{$_POST['content']}', "" . ($_POST['publish'] ? 1 : 0) . "")"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=news_admin&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=news_admin&id={$id}&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=news_admin&&id={$_POST['id']}&msg=3"");
+        }
+        break;

-       case ""del_circuit_min_time"":
-       if (checkskey($_POST['id'])) {
-               seveLog(""circuit_min_time"");
-               mysql_query(""delete from arm_circuit_min_time where nom='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=circuit_min_time"");
-       break;
-       case ""add_circuit_min_time"":
-       if (checkskey()) {
-               seveLog(""circuit_min_time"");
-               mysql_query(""delete from arm_circuit_min_time where nom='{$_POST['nom']}'"");
-               mysql_query(""insert arm_circuit_min_time (nom, time) values ('{$_POST['nom']}', '{$_POST['time']}') "");
-       }
-       header(""Location: ./?action=circuit_min_time&nom={$_POST['nom']}&msg=1"");
-       break;
-       case ""update_matrix_short_stop"":
-       seveLog(""action_matrix_short_stop"");
-       if (checkskey($_POST['id'])) {
-               $res = mysql_query(""update short_stop set equipment='{$_POST['equipment']}', production='{$_POST['production']}', time='{$_POST['time']}' where id='{$_POST['id']}'"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       header(""Location: ./?action=action_matrix_short_stop&id={$_POST['id']}&msg=1"");
-               } else {
-                       header(""Location: ./?action=action_matrix_short_stop&id={$_POST['id']}&msg=2"");
-               }
-       }
-       break;
-       case ""add_matrix_short_stop"":
-       seveLog(""action_matrix_short_stop"");
-       if (checkskey()) {
-               $res = mysql_query(""insert short_stop (equipment, production, `time`) values ('{$_POST['equipment']}', '{$_POST['production']}', '{$_POST['time']}')"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=action_matrix_short_stop&id={$id}&msg=1"");
-               } else {
-                       header(""Location: ./?action=action_matrix_short_stop&id={$id}&msg=2"");
-               }
-       }
-       break;
-       case ""del_matrix_short_stop"":
-       seveLog(""action_matrix_short_stop"");
-       if (checkskey($_POST['id'])) {
-               mysql_query(""delete from short_stop where id='{$_POST['id']}'"");
-       }
-       header(""Location: ./?action=action_matrix_short_stop"");
-       break;
-       case ""settings"":
-       if (checkskey()) {
-               seveLog($_POST[action]);
-               //$time_zone_name = mysqli_real_escape_string(DB::$dblink, $_POST['time_zone_name']);
-               $TimeZone = new TimeZone($_POST['time_zone_name']);
-               if (!strpos($_POST['short_stop'], ':')) {
-                       $_POST['short_stop'] = '0:0:'.$_POST['short_stop'];
-               }
-               $t = explode(':',$_POST['short_stop']);
-               if (count($t)==2) $_POST['short_stop'] = '0:'.$_POST['short_stop'];
-               $parsed = date_parse($_POST['short_stop']);
-               $short_stop = $parsed['hour'] * 3600 + $parsed['minute'] * 60 + $parsed['second'];
+    case ""del_circuit_min_time"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""circuit_min_time"");
+            mysql_query(""delete from arm_circuit_min_time where nom='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=circuit_min_time"");
+        break;
+    case ""add_circuit_min_time"":
+        if (checkskey()) {
+            seveLog(""circuit_min_time"");
+            mysql_query(""delete from arm_circuit_min_time where nom='{$_POST['nom']}'"");
+            mysql_query(""insert arm_circuit_min_time (nom, time) values ('{$_POST['nom']}', '{$_POST['time']}') "");
+        }
+        header(""Location: ./?action=circuit_min_time&nom={$_POST['nom']}&msg=1"");
+        break;
+    case ""update_matrix_short_stop"":
+        seveLog(""action_matrix_short_stop"");
+        if (checkskey($_POST['id'])) {
+            $res = mysql_query(""update short_stop set equipment='{$_POST['equipment']}', production='{$_POST['production']}', time='{$_POST['time']}' where id='{$_POST['id']}'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=action_matrix_short_stop&id={$_POST['id']}&msg=1"");
+            } else {
+                header(""Location: ./?action=action_matrix_short_stop&id={$_POST['id']}&msg=2"");
+            }
+        }
+        break;
+    case ""add_matrix_short_stop"":
+        seveLog(""action_matrix_short_stop"");
+        if (checkskey()) {
+            $res = mysql_query(""insert short_stop (equipment, production, `time`) values ('{$_POST['equipment']}', '{$_POST['production']}', '{$_POST['time']}')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=action_matrix_short_stop&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=action_matrix_short_stop&id={$id}&msg=2"");
+            }
+        }
+        break;
+    case ""del_matrix_short_stop"":
+        seveLog(""action_matrix_short_stop"");
+        if (checkskey($_POST['id'])) {
+            mysql_query(""delete from short_stop where id='{$_POST['id']}'"");
+        }
+        header(""Location: ./?action=action_matrix_short_stop"");
+        break;
+    case ""settings"":
+        if (checkskey()) {
+            seveLog($_POST[action]);
+            //$time_zone_name = mysqli_real_escape_string(DB::$dblink, $_POST['time_zone_name']);
+            $TimeZone = new TimeZone($_POST['time_zone_name']);
+            if (!strpos($_POST['short_stop'], ':')) {
+                $_POST['short_stop'] = '0:0:' . $_POST['short_stop'];
+            }
+            $t = explode(':', $_POST['short_stop']);
+            if (count($t) == 2) $_POST['short_stop'] = '0:' . $_POST['short_stop'];
+            $parsed = date_parse($_POST['short_stop']);
+            $short_stop = $parsed['hour'] * 3600 + $parsed['minute'] * 60 + $parsed['second'];


-               // if (!strpos($_POST['circuit_min_time'], ':')) {
-               //      $_POST['circuit_min_time'] = '0:0:'.$_POST['circuit_min_time'];
-               // }
-               // $t = explode(':',$_POST['circuit_min_time']);
-               // if (count($t)==2) $_POST['circuit_min_time'] = '0:'.$_POST['circuit_min_time'];
-               // $parsed = date_parse($_POST['circuit_min_time']);
-               // $circuit_min_time = $parsed['hour'] * 3600 + $parsed['minute'] * 60 + $parsed['second'];
-               $circuit_min_time = $_POST['circuit_min_time'];
+            // if (!strpos($_POST['circuit_min_time'], ':')) {
+            //         $_POST['circuit_min_time'] = '0:0:'.$_POST['circuit_min_time'];
+            // }
+            // $t = explode(':',$_POST['circuit_min_time']);
+            // if (count($t)==2) $_POST['circuit_min_time'] = '0:'.$_POST['circuit_min_time'];
+            // $parsed = date_parse($_POST['circuit_min_time']);
+            // $circuit_min_time = $parsed['hour'] * 3600 + $parsed['minute'] * 60 + $parsed['second'];
+            $circuit_min_time = $_POST['circuit_min_time'];

-               mysql_query(""delete from `config` where `key` = 'short_stop'"");
-               mysql_query(""delete from `config` where `key` = 'fluctuation'"");
-               mysql_query(""delete from `config` where `key` = 'instrument_report'"");
-               mysql_query(""delete from `config` where `key` = 'circuit_min_time'"");
-               mysql_query(""delete from `config` where `key` = 'defect'"");
-               mysql_query(""delete from `config` where `key` = 'defect_type'"");
-               mysql_query(""delete from `config` where `key` = 'report_encoding'"");
-               mysql_query(""delete from `config` where `key` = 'report_filetype'"");
-               mysql_query(""delete from `config` where `key` = 'arm_user_change'"");
-               mysql_query(""delete from `config` where `key` = 'plan_downtime_info'"");
-               mysql_query(""delete from `config` where `key` = 'autostop_by_circle'"");
-               mysql_query(""delete from `config` where `key` = 'eq_allavlb'"");
-               mysql_query(""delete from `config` where `key` = 'widget_7_param'"");
+            mysql_query(""delete from `config` where `key` = 'short_stop'"");
+            mysql_query(""delete from `config` where `key` = 'fluctuation'"");
+            mysql_query(""delete from `config` where `key` = 'instrument_report'"");
+            mysql_query(""delete from `config` where `key` = 'circuit_min_time'"");
+            mysql_query(""delete from `config` where `key` = 'defect'"");
+            mysql_query(""delete from `config` where `key` = 'defect_type'"");
+            mysql_query(""delete from `config` where `key` = 'report_encoding'"");
+            mysql_query(""delete from `config` where `key` = 'report_filetype'"");
+            mysql_query(""delete from `config` where `key` = 'arm_user_change'"");
+            mysql_query(""delete from `config` where `key` = 'plan_downtime_info'"");
+            mysql_query(""delete from `config` where `key` = 'autostop_by_circle'"");
+            mysql_query(""delete from `config` where `key` = 'eq_allavlb'"");
+            mysql_query(""delete from `config` where `key` = 'widget_7_param'"");

-               mysql_query(""insert into `config` (`key`, `value`) values ('widget_7_param', '{$_POST['widget_7_param']}')"");
-               mysql_query(""insert into `config` (`key`, `value`) values ('eq_allavlb', '{$_POST['eq_allavlb']}')"");
-               mysql_query(""insert into `config` (`key`, `value`) values ('circuit_min_time', '{$circuit_min_time}')"");
-               mysql_query(""insert into `config` (`key`, `value`) values ('short_stop', '{$short_stop}')"");
-               mysql_query(""insert into `config` (`key`, `value`) values ('fluctuation', '{$_POST['fluctuation']}')"");
-               if ($_POST['defect']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('defect', 1)"");
-               }
-               if ($_POST['defect_type']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('defect_type', 1)"");
-               }
-               if ($_POST['instrument_report']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('instrument_report', 1)"");
-               }
-               if ($_POST['arm_user_change']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('arm_user_change', 1)"");
-               }
-               if ($_POST['report_encoding']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('report_encoding', '{$_POST['report_encoding']}')"");
-               }
-               if ($_POST['report_filetype']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('report_filetype', '{$_POST['report_filetype']}')"");
-               }
-               if ($_POST['plan_downtime_info']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('plan_downtime_info', 1)"");
-               }
-               if ($_POST['autostop_by_circle']) {
-                       mysql_query(""insert into `config` (`key`, `value`) values ('autostop_by_circle', 1)"");
-               }
+            mysql_query(""insert into `config` (`key`, `value`) values ('widget_7_param', '{$_POST['widget_7_param']}')"");
+            mysql_query(""insert into `config` (`key`, `value`) values ('eq_allavlb', '{$_POST['eq_allavlb']}')"");
+            mysql_query(""insert into `config` (`key`, `value`) values ('circuit_min_time', '{$circuit_min_time}')"");
+            mysql_query(""insert into `config` (`key`, `value`) values ('short_stop', '{$short_stop}')"");
+            mysql_query(""insert into `config` (`key`, `value`) values ('fluctuation', '{$_POST['fluctuation']}')"");
+            if ($_POST['defect']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('defect', 1)"");
+            }
+            if ($_POST['defect_type']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('defect_type', 1)"");
+            }
+            if ($_POST['instrument_report']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('instrument_report', 1)"");
+            }
+            if ($_POST['arm_user_change']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('arm_user_change', 1)"");
+            }
+            if ($_POST['report_encoding']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('report_encoding', '{$_POST['report_encoding']}')"");
+            }
+            if ($_POST['report_filetype']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('report_filetype', '{$_POST['report_filetype']}')"");
+            }
+            if ($_POST['plan_downtime_info']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('plan_downtime_info', 1)"");
+            }
+            if ($_POST['autostop_by_circle']) {
+                mysql_query(""insert into `config` (`key`, `value`) values ('autostop_by_circle', 1)"");
+            }

-               DB::connect(DB_NAME, DB_HOST, DB_USER, DB_PASS);
-               //mysql_query(""update organizations set time_zone='{$_POST[time_zone]}' where domen='{$customer[domen]}'"");
-               mysql_query(""update organizations set time_zone='"".($TimeZone->getUTCOffset()/(60*60) - 3).""',client_timezone='"".$TimeZone->getName().""' where domen='{$customer[domen]}'"");//-3 mean Moscow
-       }
-       header(""Location: ./?action=settings"");
-       break;
-       case ""add_resource"":
-       if (checkskey($_POST[id])) {
-               seveLog(""resources"");
-               mysql_query(""insert resources (name, units, price) values ('{$_POST[name]}', '{$_POST[units]}', '{$_POST[price]}')"");
-               $id = mysql_insert_id();
-       }
-       header(""Location: ./?action=resources&id={$id}"");
-       break;
-       case ""update_resource"":
-       if (checkskey($_POST[id])) {
-               seveLog(""resources"");
-               mysql_query(""update resources set name='{$_POST[name]}', units='{$_POST[units]}', price='{$_POST[price]}' where id='{$_POST[id]}'"");
-       }
-       header(""Location: ./?action=resources&id=$_POST[id]"");
-       break;
-       case ""del_resource"":
-       if (checkskey($_POST[id])) {
-               seveLog(""resources"");
-               mysql_query(""delete from resources where id='$_POST[id]'"");
-       }
-       header(""Location: ./?action=resources&id=$_POST[id]"");
-       break;
-       case ""create_service_task"":
-       if (checkskey()) {
-               $_POST[content] = addslashes($_POST[content]);
-               while (list($key, $val) = each($_POST[responce_2])) {
-                       $responce_2 .= ""$val,"";
-               }
-               $responce_2 = substr($responce_2,0,-1);
-               $_POST[request_id] = ($_POST[request_id] ? $_POST[request_id] : 0);
-               $sql = ""insert service_task (created, service_type, equipment_id, responce, responce_2, request_id, creator, date_plan, hours_plan, content, status) values (
-                       now(), '{$_POST[service_type]}', '{$_POST[equipment_id]}', '{$_POST[responce]}', '{$responce_2}', '{$_POST[request_id]}', '{$userData[id]}', '{$_POST[date]} {$_POST[time]}', '{$_POST[hours_plan]}', '{$_POST[conten
-                       mysql_query($sql);
-                       // echo $sql;
-                       // exit;
-               }
-               header(""Location: ./?action=service_request_list&id=$_POST[request_id]"");
-               break;
+            DB::connect(DB_NAME, DB_HOST, DB_USER, DB_PASS);
+            //mysql_query(""update organizations set time_zone='{$_POST[time_zone]}' where domen='{$customer[domen]}'"");
+            mysql_query(""update organizations set time_zone='"" . ($TimeZone->getUTCOffset() / (60 * 60) - 3) . ""',client_timezone='"" . $TimeZone->getName() . ""' where domen='{$customer[domen]}'"");//-3 mean Moscow
+        }
+        header(""Location: ./?action=settings"");
+        break;
+    case ""add_resource"":
+        if (checkskey($_POST[id])) {
+            seveLog(""resources"");
+            mysql_query(""insert resources (name, units, price) values ('{$_POST[name]}', '{$_POST[units]}', '{$_POST[price]}')"");
+            $id = mysql_insert_id();
+        }
+        header(""Location: ./?action=resources&id={$id}"");
+        break;
+    case ""update_resource"":
+        if (checkskey($_POST[id])) {
+            seveLog(""resources"");
+            mysql_query(""update resources set name='{$_POST[name]}', units='{$_POST[units]}', price='{$_POST[price]}' where id='{$_POST[id]}'"");
+        }
+        header(""Location: ./?action=resources&id=$_POST[id]"");
+        break;
+    case ""del_resource"":
+        if (checkskey($_POST[id])) {
+            seveLog(""resources"");
+            mysql_query(""delete from resources where id='$_POST[id]'"");
+        }
+        header(""Location: ./?action=resources&id=$_POST[id]"");
+        break;
+    case ""create_service_task"":
+        if (checkskey()) {
+            $_POST[content] = addslashes($_POST[content]);
+            while (list($key, $val) = each($_POST[responce_2])) {
+                $responce_2 .= ""$val,"";
+            }
+            $responce_2 = substr($responce_2, 0, -1);
+            $_POST[request_id] = ($_POST[request_id] ? $_POST[request_id] : 0);
+            $sql = ""insert service_task (created, service_type, equipment_id, responce, responce_2, request_id, creator, date_plan, hours_plan, content, status) values (
+                       now(), '{$_POST[service_type]}', '{$_POST[equipment_id]}', '{$_POST[responce]}', '{$responce_2}', '{$_POST[request_id]}', '{$userData[id]}', '{$_POST[date]} {$_POST[time]}', '{$_POST[hours_plan]}', '{$_POST[conten
+            mysql_query($sql);
+            // echo $sql;
+            // exit;
+        }
+        header(""Location: ./?action=service_request_list&id=$_POST[request_id]"");
+        break;

-               case 'cancel_task':
-               mysql_query(""update service_task set status='"".ST_CANCEL.""' where id='{$_POST[id]}'"");
-               header(""Location: ./?action=service_task_list&id=$_POST[id]"");
-               break;
-               case 'move_task':
-               mysql_query(""update service_task set date_plan='{$_POST[task_new_time]}' where id='{$_POST[id]}'"");
-               header(""Location: ./?action=service_task_shedule&date=$_POST[date]"");
-               break;
-               case ""update_service_task"":
-               if (checkskey()) {
-                       $_POST[content] = addslashes($_POST[content]);
-                       while (list($key, $val) = each($_POST[responce_2])) {
-                               $responce_2 .= ""$val,"";
-                       }
-                       $responce_2 = substr($responce_2,0,-1);
-                       $sql = ""update service_task set created=now(), status='"".($_POST[status] ? 1 : 0).""', service_type='{$_POST[service_type]}', equipment_id='{$_POST[equipment_id]}', responce='{$_POST[responce]}', responce_2='{$resp
-                       mysql_query($sql);
-               }
-               header(""Location: ./?action=service_task_list&id=$_POST[id]"");
-               break;
+    case 'cancel_task':
+        mysql_query(""update service_task set status='"" . ST_CANCEL . ""' where id='{$_POST[id]}'"");
+        header(""Location: ./?action=service_task_list&id=$_POST[id]"");
+        break;
+    case 'move_task':
+        mysql_query(""update service_task set date_plan='{$_POST[task_new_time]}' where id='{$_POST[id]}'"");
+        header(""Location: ./?action=service_task_shedule&date=$_POST[date]"");
+        break;
+    case ""update_service_task"":
+        if (checkskey()) {
+            $_POST[content] = addslashes($_POST[content]);
+            while (list($key, $val) = each($_POST[responce_2])) {
+                $responce_2 .= ""$val,"";
+            }
+            $responce_2 = substr($responce_2, 0, -1);
+            $sql = ""update service_task set created=now(), status='"" . ($_POST[status] ? 1 : 0) . ""', service_type='{$_POST[service_type]}', equipment_id='{$_POST[equipment_id]}', responce='{$_POST[responce]}', responce_2='{$responce_2}
+            mysql_query($sql);
+        }
+        header(""Location: ./?action=service_task_list&id=$_POST[id]"");
+        break;

-               case 'del_task':
-               if (checkskey($_POST[id])) {
-                       mysql_query(""delete from service_task where id='{$_POST[id]}'"");
-               }
-               header(""Location: ./?action=service_task_list&id=$_POST[id]"");
-               break;
+    case 'del_task':
+        if (checkskey($_POST[id])) {
+            mysql_query(""delete from service_task where id='{$_POST[id]}'"");
+        }
+        header(""Location: ./?action=service_task_list&id=$_POST[id]"");
+        break;

-               case 'accept_service_task':
-               $autoclose =  implode(',', array_keys($_POST[autoclose]));
-               if (checkskey()) {
-                       mysql_query(""update service_task set accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id={$_POST[id]}"");
+    case 'accept_service_task':
+        $autoclose = implode(',', array_keys($_POST[autoclose]));
+        if (checkskey()) {
+            mysql_query(""update service_task set accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id={$_POST[id]}"");

-                       // $res = mysql_query(""select id from service_task where responce_2='' and accept_date is NULL and request_id in (select request_id from service_task where id={$_POST[id]}) "");
-                       // if ($res and mysql_num_rows($res)>0) {
-                       //               while ($r = mysql_fetch_assoc($res)) {
-                       //                       $ids .= $r[id]."","";
-                       //               }
-                       //               $ids = substr($ids, 0, -1);
-                       //               mysql_query(""update service_task set accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id in ($ids)"");
-                       // }
-                       mysql_query(""update service_task set finished=now(), finisher='{$userData[id]}', accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' wher
-               }
-               header(""Location: ./?action=service_task_list&id=$_POST[id]"");
-               break;
+            // $res = mysql_query(""select id from service_task where responce_2='' and accept_date is NULL and request_id in (select request_id from service_task where id={$_POST[id]}) "");
+            // if ($res and mysql_num_rows($res)>0) {
+            //                  while ($r = mysql_fetch_assoc($res)) {
+            //                          $ids .= $r[id]."","";
+            //                  }
+            //                  $ids = substr($ids, 0, -1);
+            //                  mysql_query(""update service_task set accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id in ($ids)"");
+            // }
+            mysql_query(""update service_task set finished=now(), finisher='{$userData[id]}', accept_date=now(), accept_grade='{$_POST[accept_grade]}', accept_comment='{$_POST[accept_comment]}', acceptor='{$userData[id]}' where id in ($a
+        }
+        header(""Location: ./?action=service_task_list&id=$_POST[id]"");
+        break;

-               case ""decline_service_request"":
-               mysql_query(""update service_request set status=10 where id='{$_POST[id]}'"");
-               header(""Location: ./?action=service_request_list&id=$_POST[id]"");
-               break;
-               case ""update_notifications"":
-                       if ($_POST[message]) {
-                               mysql_query(""replace into notifications_button_message (status, message, n_type) values ('{$_POST[status]}', '{$_POST[message]}', '{$_POST[n_type]}') "");
-                               mysql_query(""delete from notifications_button_user where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
+    case ""decline_service_request"":
+        mysql_query(""update service_request set status=10 where id='{$_POST[id]}'"");
+        header(""Location: ./?action=service_request_list&id=$_POST[id]"");
+        break;
+    case ""update_notifications"":
+        if ($_POST[message]) {
+            mysql_query(""replace into notifications_button_message (status, message, n_type) values ('{$_POST[status]}', '{$_POST[message]}', '{$_POST[n_type]}') "");
+            mysql_query(""delete from notifications_button_user where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");

-                               while (list($key, $val) = each($_POST[users])) {
-                                       echo ""insert notifications_button_user (status, user, n_type) values ('{$_POST[status]}', '{$val}', '{$_POST[n_type]}')"";
-                                       mysql_query(""insert notifications_button_user (status, user, n_type) values ('{$_POST[status]}', '{$val}', '{$_POST[n_type]}')"");
-                               }
-                       } else {
-                               mysql_query(""delete from notifications_button_message where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
-                               mysql_query(""delete from notifications_button_user where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
-                       }
-                       header(""Location: ./?action=notifications&status=$_POST[status]&n_type=$_POST[n_type]"");
-                       break;
-                       case ""del_device"": // удаление устройства
-                       if (checkskey($_POST[id])) {
-                seveLog(""devices"");
-                $device_id = (int)$_POST['id'];
-                $Devices = new Devices();
-                $Devices->delete(array('id'=>$device_id));
-                /*
-                $Devices_read = $Devices->read(array('id'=>$device_id));
-                //var_dump($Devices_read);die;
-                if (!empty($Devices_read)) {
-                    $device_serial = $Devices_read[0]['serialNumber'];
-                    $DeviceSettingsStorage = new DeviceSettingsStorage();
-                    $DeviceSettingsStorage->delete(array('device_id'=>$device_serial));
-                    $DeviceSettingsCurrent = new DeviceSettingsCurrent();
-                    $DeviceSettingsCurrent->delete(array('device_id'=>$device_serial));
+            while (list($key, $val) = each($_POST[users])) {
+                echo ""insert notifications_button_user (status, user, n_type) values ('{$_POST[status]}', '{$val}', '{$_POST[n_type]}')"";
+                mysql_query(""insert notifications_button_user (status, user, n_type) values ('{$_POST[status]}', '{$val}', '{$_POST[n_type]}')"");
+            }
+        } else {
+            mysql_query(""delete from notifications_button_message where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
+            mysql_query(""delete from notifications_button_user where status='{$_POST[status]}' and n_type='{$_POST[n_type]}'"");
+        }
+        header(""Location: ./?action=notifications&status=$_POST[status]&n_type=$_POST[n_type]"");
+        break;
+    case ""del_device"": // удаление устройства
+        if (checkskey($_POST[id])) {
+            seveLog(""devices"");
+            $device_id = (int)$_POST['id'];
+            $Devices = new Devices();
+            $Devices->delete(array('id' => $device_id));
+            /*
+            $Devices_read = $Devices->read(array('id'=>$device_id));
+            //var_dump($Devices_read);die;
+            if (!empty($Devices_read)) {
+                $device_serial = $Devices_read[0]['serialNumber'];
+                $DeviceSettingsStorage = new DeviceSettingsStorage();
+                $DeviceSettingsStorage->delete(array('device_id'=>$device_serial));
+                $DeviceSettingsCurrent = new DeviceSettingsCurrent();
+                $DeviceSettingsCurrent->delete(array('device_id'=>$device_serial));
+            }
+
+            //mysql_query(""delete from devices where id='{$_POST[id]}'"");
+            $sql = 'delete from devices where id='.$device_id;
+            mysql_query($sql);
+            $res = mysql_query(""select * from sensors where device_id='$_POST[id]' order by channel"");
+            if ($res and mysql_num_rows($res)>0) {
+                while ($r = mysql_fetch_assoc($res)) {
+                    mysql_query(""delete from equipment_sensors where sensor_id='{$r[id]}'"");
                 }
+            }
+            //mysql_query(""delete from sensors where device_id='{$_POST[id]}'"");
+            $sql = 'delete from sensors where device_id='.$device_id;
+            mysql_query($sql);
+            */
+        }
+        header(""Location: ./?action=devices"");
+        break;
+    case ""del_arm"": // удаление устройства
+        if (checkskey($_POST[id])) {
+            seveLog(""arm"");
+            mysql_query(""delete from arm where id='{$_POST[id]}'"");
+        }
+        header(""Location: ./?action=arm"");
+        break;
+    case ""add_arm"":
+        if (checkskey()) {
+            seveLog(""arm"");
+            if ($_POST['is_virtual']) {
+                $v_link = md5($_POST[serial] . """" . time());
+            }
+            $sql = ""insert arm (name, serial, widget1, widget2, widget3, widget4, screensaver, rele, publish, is_virtual, virtual_link, info_screen) values ('$_POST[name]', '$_POST[serial]', '$_POST[widget1]', '$_POST[widget2]', '$_POST
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=arm&id={$id}&msg=1"");
+            } else {
+                header(""Location: ./?action=arm&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=arm"");
+        }
+        break;

-                //mysql_query(""delete from devices where id='{$_POST[id]}'"");
-                $sql = 'delete from devices where id='.$device_id;
-                mysql_query($sql);
-                $res = mysql_query(""select * from sensors where device_id='$_POST[id]' order by channel"");
-                if ($res and mysql_num_rows($res)>0) {
-                    while ($r = mysql_fetch_assoc($res)) {
-                        mysql_query(""delete from equipment_sensors where sensor_id='{$r[id]}'"");
+    case ""update_arm"":
+        if (checkskey($_POST[id])) {
+            seveLog(""arm"");
+            $sql = ""update arm set info_screen='{$_POST['info_screen']}', name='$_POST[name]', serial='$_POST[serial]', widget1='$_POST[widget1]', widget2='$_POST[widget2]', widget3='$_POST[widget3]', widget4='$_POST[widget4]', screensa
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=arm&id={$_POST[id]}&msg=1"");
+            } else {
+                header(""Location: ./?action=arm&msg=2"");
+            }
+        } else {
+            header(""Location: ./?action=arm"");
+        }
+        break;
+    case ""add_device"": // добавление нового устройства
+        if (checkskey()) {
+            seveLog(""devices"");
+            $sql = ""INSERT devices (title, serialNumber, publish, equipment_id, discrete, is_dhcp, ip, mac, netmask, gw, time_zone, host, debug_cmd)
+                               VALUES ('$_POST[title]', '$_POST[serialNumber]', '"" . ($_POST[publish] ? 1 : 0) . ""', '$_POST[newequipment]', '$_POST[newdiscrete]', '"" . ($_POST[is_dhcp] ? 1 : 0) . ""', '$_POST[ip]', '$_POST[mac]', '$_POS
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[sensor] as $k => $v) {
+                    $_POST[sensor_type][$k] = ($_POST[sensor_type][$k] ? $_POST[sensor_type][$k] : 1);
+                    $_POST[discret_ch][$k] = ($_POST[discret_ch][$k] ? $_POST[discret_ch][$k] : 15);
+                    $_POST[channel][$k] = ($_POST[channel][$k] ? $_POST[channel][$k] : 0);
+                    $sql = ""insert sensors (title, channel, sensor_type, device_id, discrete, measure, max_value, divider) values ('$v', '"" . ($_POST[channel][$k] * 1) . ""', '"" . ($_POST[sensor_type][$k] * 1) . ""', '$id', '"" . $_POST[di
+                    echo $sql;
+                    mysql_query($sql);
+                    $sensor_id = mysql_insert_id();
+                    if ($_POST['equipments'][$k]) {
+                        // Добавляем связь с оборудованими
+                        Sensor::bindEquipment($sensor_id, $_POST['equipments'][$k]);
                     }
                 }
-                //mysql_query(""delete from sensors where device_id='{$_POST[id]}'"");
-                $sql = 'delete from sensors where device_id='.$device_id;
-                mysql_query($sql);
-                */
-                       }
-                       header(""Location: ./?action=devices"");
-                       break;
-                       case ""del_arm"": // удаление устройства
-                       if (checkskey($_POST[id])) {
-                               seveLog(""arm"");
-                               mysql_query(""delete from arm where id='{$_POST[id]}'"");
-                       }
-                       header(""Location: ./?action=arm"");
-                       break;
-                       case ""add_arm"":
-                       if (checkskey()) {
-                               seveLog(""arm"");
-                               if ($_POST['is_virtual']) {
-                                       $v_link = md5($_POST[serial]."""".time());
-                               }
-                               $sql = ""insert arm (name, serial, widget1, widget2, widget3, widget4, screensaver, rele, publish, is_virtual, virtual_link, info_screen) values ('$_POST[name]', '$_POST[serial]', '$_POST[widget1]', '$_POST
-                               $res = mysql_query($sql);
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       $id = mysql_insert_id();
-                                       header(""Location: ./?action=arm&id={$id}&msg=1"");
-                               } else {
-                                       header(""Location: ./?action=arm&msg=2"");
-                               }
-                       } else {
-                               header(""Location: ./?action=arm"");
-                       }
-                       break;

-                       case ""update_arm"":
-                       if (checkskey($_POST[id])) {
-                               seveLog(""arm"");
-                               $sql = ""update arm set info_screen='{$_POST['info_screen']}', name='$_POST[name]', serial='$_POST[serial]', widget1='$_POST[widget1]', widget2='$_POST[widget2]', widget3='$_POST[widget3]', widget4='$_POST[
-                               $res = mysql_query($sql);
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       header(""Location: ./?action=arm&id={$_POST[id]}&msg=1"");
-                               } else {
-                                       header(""Location: ./?action=arm&msg=2"");
-                               }
-                       } else {
-                               header(""Location: ./?action=arm"");
-                       }
-                       break;
-                       case ""add_device"": // добавление нового устройства
-                       if (checkskey()) {
-                               seveLog(""devices"");
-                               $sql = ""INSERT devices (title, serialNumber, publish, equipment_id, discrete, is_dhcp, ip, mac, netmask, gw, time_zone, host, debug_cmd)
-                               VALUES ('$_POST[title]', '$_POST[serialNumber]', '"".($_POST[publish] ? 1 : 0).""', '$_POST[newequipment]', '$_POST[newdiscrete]', '"".($_POST[is_dhcp] ? 1 : 0).""', '$_POST[ip]', '$_POST[mac]', '$_POST[netmas
-                               $res = mysql_query($sql);
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       $id = mysql_insert_id();
-                                       foreach($_POST[sensor] as $k => $v){
-                                               $_POST[sensor_type][$k] = ($_POST[sensor_type][$k] ? $_POST[sensor_type][$k] : 1);
-                                               $_POST[discret_ch][$k] = ($_POST[discret_ch][$k] ? $_POST[discret_ch][$k] : 15);
-                                               $_POST[channel][$k] = ($_POST[channel][$k] ? $_POST[channel][$k] : 0);
-                                               $sql = ""insert sensors (title, channel, sensor_type, device_id, discrete, measure, max_value, divider) values ('$v', '"".($_POST[channel][$k]*1).""', '"".($_POST[sensor_type][$k]*1).""', '$id',
-                                               echo $sql;
-                                               mysql_query($sql);
-                                               $sensor_id = mysql_insert_id();
-                                               if ($_POST['equipments'][$k]) {
-                                                       // Добавляем связь с оборудованими
-                                                       Sensor::bindEquipment($sensor_id, $_POST['equipments'][$k]);
-                                               }
-                                       }
+                // Ответственные
+                foreach ($_POST['users'] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert users_notify (user_id, device_id) values ('$v', '$id')"");
+                }

-                                       // Ответственные
-                                       foreach($_POST['users'] as $k => $v){
-                                               // записываем новые роли
-                                               mysql_query(""insert users_notify (user_id, device_id) values ('$v', '$id')"");
-                                       }
+                // создаем таблицы для записи данных
+                // DESCRIBE `z_device_2`
+                // ALTER TABLE `z_device_1` CHANGE `data` `data` FLOAT(7,2) NOT NULL;
+                mysql_query(""CREATE TABLE IF NOT EXISTS `z_device_$id` (  `timestamp` datetime NOT NULL,  `sensor` tinyint(1) unsigned NOT NULL,  `data` float(7,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;"");
+                mysql_query(""CREATE TABLE IF NOT EXISTS `z_device_$id"" . ""_arc` (  `timestamp` datetime NOT NULL,  `sensor` tinyint(1) unsigned NOT NULL,  `data` float(7,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;"");
+                mysql_query(""ALTER TABLE `z_device_$id` ADD UNIQUE KEY `timestamp` (`timestamp`,`sensor`)"");
+                header(""Location: ./?action=devices&msg=1&id=$id&$k"");

-                                       // создаем таблицы для записи данных
-                                       // DESCRIBE `z_device_2`
-                                       // ALTER TABLE `z_device_1` CHANGE `data` `data` FLOAT(7,2) NOT NULL;
-                                       mysql_query(""CREATE TABLE IF NOT EXISTS `z_device_$id` (  `timestamp` datetime NOT NULL,  `sensor` tinyint(1) unsigned NOT NULL,  `data` float(7,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8;"");
-                                       mysql_query(""CREATE TABLE IF NOT EXISTS `z_device_$id"".""_arc` (  `timestamp` datetime NOT NULL,  `sensor` tinyint(1) unsigned NOT NULL,  `data` float(7,2) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=ut
-                                       mysql_query(""ALTER TABLE `z_device_$id` ADD UNIQUE KEY `timestamp` (`timestamp`,`sensor`)"");
-                                       header(""Location: ./?action=devices&msg=1&id=$id&$k"");
-                               } else {
-                                       header(""Location: ./?action=devices&msg=2&$k"");
-                               }
-                       }
-                       break;
-                       case ""update_device"": // изменение параметров устройства
-                       if (checkskey($_POST['id'])) {
-                               seveLog(""devices"");
-                               $deviseData = Device::getOne($_POST['id']);
-                               $modif = $deviseData['modified']; // текущее значение ""изменены ли данные""
-                               $modif_data = false; // изменены ли основные данные
-                               $modif_sensors = false; // изменены ли сенсоры
-                               $modif_data_and_sensors = false; // изменены и основные данные и сенсоры
+                // Начало создания записи о гарантии на устройство
+                /** @var ModelDBT_DeviceWarranty $deviceWarranty */
+                $deviceWarranty = QCGA::API3()->objectFactory('ModelDBT_DeviceWarranty');
+                $deviceWarranty->createForCurrentCustomer($_POST['serialNumber']);
+                // Конец создания записи о гарантии на устройство
+            } else {
+                header(""Location: ./?action=devices&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_device"": // изменение параметров устройства
+        if (checkskey($_POST['id'])) {
+            seveLog(""devices"");
+            $deviseData = Device::getOne($_POST['id']);
+            $modif = $deviseData['modified']; // текущее значение ""изменены ли данные""
+            $modif_data = false; // изменены ли основные данные
+            $modif_sensors = false; // изменены ли сенсоры
+            $modif_data_and_sensors = false; // изменены и основные данные и сенсоры

-                               // Проверяем на изменение основных данных
-                               if (
-                                       $_POST['title'] != $deviseData['title'] ||
-                                       $_POST['serialNumber'] != $deviseData['serialNumber'] ||
-                                       $_POST['publish'] != $deviseData['publish'] ||
-                                       $_POST['discrete'] != $deviseData['discrete'] ||
-                                       $_POST['is_dhcp'] != $deviseData['is_dhcp'] ||
-                                       $_POST['ip'] != $deviseData['ip'] ||
-                                       $_POST['mac'] != $deviseData['mac'] ||
-                                       $_POST['netmask'] != $deviseData['netmask'] ||
-                                       $_POST['gw'] != $deviseData['gw'] ||
-                                       $_POST['time_zone'] != $deviseData['time_zone'] ||
-                                       $_POST['host'] != $deviseData['host'] ||
-                                       $_POST['debug_cmd'] != $deviseData['debug_cmd']
-                               ) {
-                                       $modif_data = true;
-                               }
+            // Проверяем на изменение основных данных
+            if (
+                $_POST['title'] != $deviseData['title'] ||
+                $_POST['serialNumber'] != $deviseData['serialNumber'] ||
+                $_POST['publish'] != $deviseData['publish'] ||
+                $_POST['discrete'] != $deviseData['discrete'] ||
+                $_POST['is_dhcp'] != $deviseData['is_dhcp'] ||
+                $_POST['ip'] != $deviseData['ip'] ||
+                $_POST['mac'] != $deviseData['mac'] ||
+                $_POST['netmask'] != $deviseData['netmask'] ||
+                $_POST['gw'] != $deviseData['gw'] ||
+                $_POST['time_zone'] != $deviseData['time_zone'] ||
+                $_POST['host'] != $deviseData['host'] ||
+                $_POST['debug_cmd'] != $deviseData['debug_cmd']
+            ) {
+                $modif_data = true;
+            }

-                               $sql = ""UPDATE devices
+            $sql = ""UPDATE devices
                                SET
                                modified='$modif',
                                discrete='$_POST[discrete]',
                                title='$_POST[title]',
                                serialNumber='$_POST[serialNumber]',
-                               publish='"".($_POST[publish] ? 1 : 0).""',
-                               is_dhcp='"".($_POST[is_dhcp] ? 1 : 0).""',
+                               publish='"" . ($_POST[publish] ? 1 : 0) . ""',
+                               is_dhcp='"" . ($_POST[is_dhcp] ? 1 : 0) . ""',
                                ip = '$_POST[ip]',
                                mac = '$_POST[mac]',
                                netmask = '$_POST[netmask]',
@@ -701,916 +708,925 @@ switch ($_POST[action]) {
                                host = '$_POST[host]',
                                debug_cmd = '$_POST[debug_cmd]'
                                WHERE id='$_POST[id]'"";
-                               $res = mysql_query($sql);
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       mysql_query(""update devices set equipment_id=0 where equipment_id='$_POST[equipment]' and id<>'$_POST[id]'"");
-                               }
-                               $mdf = 0;
-                               foreach($_POST['sensor'] as $k => $v) {
-                                       $sensorId = $k;
-                                       $sensorName = trim($v);
-                                       $sensorChannel = (int) trim($_POST['channel'][$sensorId]);
-                                       $hasSensorData = ($sensorName && $sensorChannel);
-                                       $_POST[sensor_type][$k] = ($_POST[sensor_type][$k] ? $_POST[sensor_type][$k] : 1);
-                                       $_POST[discret_ch][$k] = ($_POST[discret_ch][$k] ? $_POST[discret_ch][$k] : 15);
-                                       $_POST[channel][$k] = ($_POST[channel][$k] ? $_POST[channel][$k] : 0);
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""update devices set equipment_id=0 where equipment_id='$_POST[equipment]' and id<>'$_POST[id]'"");
+            }
+            $mdf = 0;
+            foreach ($_POST['sensor'] as $k => $v) {
+                $sensorId = $k;
+                $sensorName = trim($v);
+                $sensorChannel = (int)trim($_POST['channel'][$sensorId]);
+                $hasSensorData = ($sensorName && $sensorChannel);
+                $_POST[sensor_type][$k] = ($_POST[sensor_type][$k] ? $_POST[sensor_type][$k] : 1);
+                $_POST[discret_ch][$k] = ($_POST[discret_ch][$k] ? $_POST[discret_ch][$k] : 15);
+                $_POST[channel][$k] = ($_POST[channel][$k] ? $_POST[channel][$k] : 0);

-                                       if ($sensorId > 0) {
+                if ($sensorId > 0) {

-                                               // изменяем данные существующих датчиков
-                                               $sql = ""update sensors set divider='"".str_replace(',','.',$_POST[divider][$k]).""', measure='"".$_POST[measure][$k].""', discrete='"".$_POST[discret_ch][$k].""', title='$v', channel='"".$_POST[ch
-                                               //echo $sql;
-                                               mysql_query($sql);
-                                               if (mysql_affected_rows()) {
-                                                       /*if ($_POST[sensor_type][$k] == $releTypeID) {
-                                                       $modif = $modif | MODIFIED_RELE; // изменилось значение реле
-                                               } else {
-                                               $modif = $modif | MODIFIED_CHANNELS; // изменилось значение дискретности опроса оборудования дитчиком
-                                       }*/
-                                       $mdf = 1;
-                                       $modif_sensors = true;
-                               }
-                       } else if ($hasSensorData) {
-                               // добавляем новые датчики, если они есть
-                               $sql = ""insert sensors (title, channel, sensor_type, device_id, equipment_id, discrete, measure, divider, max_value)
-                               values ('$sensorName', '$sensorChannel', '"".($_POST[sensor_type][$k]*1).""', '$_POST[id]', '"".$_POST['equipments'][ $k ][0].""', '"".$_POST[discret_ch][$k].""', '"".$_POST[measure][$k].""', '"".$_POST[divider][$k
-                               // print_r($_POST);
-                               // echo $sql;
-                               // exit;
-                               mysql_query($sql);
-                               /*if ($_POST[sensor_type][$k] == $releTypeID) {
-                               $modif = $modif | MODIFIED_RELE;
-                       } else {
-                       $modif = $modif | MODIFIED_CHANNELS;
-               }*/
-               $mdf = 2;
-               $modif_sensors = true;
-               $sensorId = mysql_insert_id(); // ID добавленного датчика
-       }
+                    // изменяем данные существующих датчиков
+                    $sql = ""update sensors set divider='"" . str_replace(',', '.', $_POST[divider][$k]) . ""', measure='"" . $_POST[measure][$k] . ""', discrete='"" . $_POST[discret_ch][$k] . ""', title='$v', channel='"" . $_POST[channel][$k]
+                    //echo $sql;
+                    mysql_query($sql);
+                    if (mysql_affected_rows()) {
+                        /*if ($_POST[sensor_type][$k] == $releTypeID) {
+                        $modif = $modif | MODIFIED_RELE; // изменилось значение реле
+                    } else {
+                    $modif = $modif | MODIFIED_CHANNELS; // изменилось значение дискретности опроса оборудования дитчиком
+                }*/
+                        $mdf = 1;
+                        $modif_sensors = true;
+                    }
+                } else if ($hasSensorData) {
+                    // добавляем новые датчики, если они есть
+                    $sql = ""insert sensors (title, channel, sensor_type, device_id, equipment_id, discrete, measure, divider, max_value)
+                               values ('$sensorName', '$sensorChannel', '"" . ($_POST[sensor_type][$k] * 1) . ""', '$_POST[id]', '"" . $_POST['equipments'][$k][0] . ""', '"" . $_POST[discret_ch][$k] . ""', '"" . $_POST[measure][$k] . ""', '"" .
+                    // print_r($_POST);
+                    // echo $sql;
+                    // exit;
+                    mysql_query($sql);
+                    /*if ($_POST[sensor_type][$k] == $releTypeID) {
+                    $modif = $modif | MODIFIED_RELE;
+                } else {
+                $modif = $modif | MODIFIED_CHANNELS;
+            }*/
+                    $mdf = 2;
+                    $modif_sensors = true;
+                    $sensorId = mysql_insert_id(); // ID добавленного датчика
+                }

-       if (!$sensorId) {
-               continue;
-       }
+                if (!$sensorId) {
+                    continue;
+                }

-       if ($hasSensorData) {
-               // Добавляем связь с оборудованими
-               Sensor::bindEquipment($sensorId, $_POST['equipments'][$k]);
-       } else {
-               Sensor::deleteOne($sensorId); // удаляем не нужные датчики
-               Sensor::unbindEquipment($sensorId); // удаляем связь с оборудованиями
-               $modif_sensors = true;
-       }
-}
-// Cтавим признаки измененных данных
-if (!$modif && ($modif_data || $modif_sensors)) {
-       if ($modif_data && $modif_sensors) {
-               $modif = MODIFIED_DEVICE_AND_SENSORS_DATA;
-       } else {
-               if ($modif_data) {
-                       $modif = MODIFIED_DEVICE_DATA;
-               } else {
-                       $modif = MODIFIED_SENSORS_DATA;
-               }
-       }
-       mysql_query(""update devices set modified='$modif' where id='$_POST[id]'"");
-}
+                if ($hasSensorData) {
+                    // Добавляем связь с оборудованими
+                    Sensor::bindEquipment($sensorId, $_POST['equipments'][$k]);
+                } else {
+                    Sensor::deleteOne($sensorId); // удаляем не нужные датчики
+                    Sensor::unbindEquipment($sensorId); // удаляем связь с оборудованиями
+                    $modif_sensors = true;
+                }
+            }
+            // Cтавим признаки измененных данных
+            if (!$modif && ($modif_data || $modif_sensors)) {
+                if ($modif_data && $modif_sensors) {
+                    $modif = MODIFIED_DEVICE_AND_SENSORS_DATA;
+                } else {
+                    if ($modif_data) {
+                        $modif = MODIFIED_DEVICE_DATA;
+                    } else {
+                        $modif = MODIFIED_SENSORS_DATA;
+                    }
+                }
+                mysql_query(""update devices set modified='$modif' where id='$_POST[id]'"");
+            }

-// Ответственные
-mysql_query(""delete from users_notify where device_id='$_POST[id]'"");
-foreach($_POST['users'] as $k => $v){
-       // записываем новые роли
-       mysql_query(""insert users_notify (user_id, device_id) values ('$v', '$_POST[id]')"");
-}
-//exit;
-header(""Location: ./?action=devices&msg=1&id=$_POST[id]&"".($mdf));
-}
-break;
-case ""upload_plan"": // загрузка картинки с планом помещения
-move_uploaded_file($_FILES[""myfile""][""tmp_name""],""plan/{$customer['planpath']}/"".$_POST[upid]."".png"");
-header(""Location: ./?action=departments&msg=1&id=$_POST[id]"");
-break;
-case ""update_department"": // изменение данных опомещении
-if (checkskey($_POST[id])) {
-       $res = mysql_query(""update departments set camera='$_POST[camera]', name='$_POST[name]', publish='"".($_POST[publish] ? 1 : 0).""' where id='$_POST[id]'"");
-       $k = mysql_affected_rows();
-       if ($res and $k>-1) {
-               header(""Location: ./?action=departments&msg=1&id=$_POST[id]"");
-       } else {
-               header(""Location: ./?action=departments&msg=2&id=$_POST[id]"");
-       }
-}
-break;
-case ""add_department"": // добавление нового помещения
-if (checkskey('')) {
-       $res = mysql_query(""insert departments (name, publish, camera) values ('$_POST[name]', '"".($_POST[publish] ? 1 : 0).""', '$_POST[camera]')"");
-       $k = mysql_affected_rows();
-       if ($res and $k>-1) {
-               $id = mysql_insert_id();
-               header(""Location: ./?action=departments&msg=1&id=$id&$k"");
-       } else {
-               header(""Location: ./?action=departments&msg=2&$k"");
-       }
-}
-break;
-case ""update_user"": // изменение данных пользователя
-if (checkskey($_POST[id])) {
-       seveLog(""users"");
-       $res = mysql_query(""update users set "".($_POST[password] ? "" passwd='"".md5($_POST[password]).""', "" : """")."" telegram_id='$_POST[telegram_id]', name='$_POST[name]', notification_link='$_POST[notification_link]', fname='$_POST[fname
-       $k = mysql_affected_rows();
-       if ($res and $k>-1) {
-               mysql_query(""delete from user_role where userID='$_POST[id]'"");
-               foreach($_POST[role] as $k => $v){
-                       mysql_query(""insert user_role (userID, role) values ('$_POST[id]', '$v')"");
-               }
-               mysql_query(""delete from users_email_reports where user_id='$_POST[id]'"");
-               foreach($_POST[users_email_reports] as $k => $v){
-                       mysql_query(""insert users_email_reports (user_id, report_slug) values ('$_POST[id]', '$v')"");
-               }
-               header(""Location: ./?action=users&msg=1&id=$_POST[id]"");
-       } else {
-               header(""Location: ./?action=users&msg=2&id=$_POST[id]"");
-       }
-}
-break;
-case ""add_user"": // добавление нового пользователя
-if (checkskey('')) {
-       seveLog(""users"");
-       $res = mysql_query(""insert users (name, fname, email, publish, passwd, notification_link, telegram_id) values ('$_POST[name]', '$_POST[fname]', '$_POST[email]', '"".($_POST[publish] ? 1 : 0).""', '"".md5($_POST[password]).""', '$_POS
-       $k = mysql_affected_rows();
-       if ($res and $k>-1) {
-               $id = mysql_insert_id();
-               foreach($_POST[role] as $k => $v){
-                       mysql_query(""insert user_role (userID, role) values ('$id', '$v')"");
-               }
-               foreach($_POST[users_email_reports] as $k => $v){
-                       mysql_query(""insert users_email_reports (user_id, report_slug) values ('$id', '$v')"");
-               }
-               header(""Location: ./?action=users&msg=1&id=$id&$k"");
-       } else {
-               header(""Location: ./?action=users&msg=2&$k"");
-       }
-}
-break;
-case ""del_user"":
-if (checkskey($_POST[id])) {
-       seveLog(""users"");
-       mysql_query(""delete from users WHERE id='$_POST[id]'"");
-       header(""Location: ./?action=users"");
-}
-break;
-case ""update_employee"": // изменение данных сотрудника
-$msg = 1;
-$res = mysql_query(""select * from employees where pin='{$_POST[pin]}'"");
-if ($_POST[pin] and $res and mysql_num_rows($res)>0) {
-       while ($r = mysql_fetch_assoc($res)) {
-               $msg = 3;
-       }
-}
-if (checkskey($_POST['id'])) {
-       seveLog(""employees"");
-       $res = mysql_query(""UPDATE employees
+            // Начало создания записи о гарантии на устройство
+            // Когда серийный номер устройства изменяется, предполагается, что это теперь другое устройство.
+            if ($_POST['serialNumber'] !== $deviseData['serialNumber']) {
+                /** @var ModelDBT_DeviceWarranty $deviceWarranty */
+                $deviceWarranty = QCGA::API3()->objectFactory('ModelDBT_DeviceWarranty');
+                $deviceWarranty->createForCurrentCustomer($_POST['serialNumber']);
+            }
+            // Конец создания записи о гарантии на устройство
+
+            // Ответственные
+            mysql_query(""delete from users_notify where device_id='$_POST[id]'"");
+            foreach ($_POST['users'] as $k => $v) {
+                // записываем новые роли
+                mysql_query(""insert users_notify (user_id, device_id) values ('$v', '$_POST[id]')"");
+            }
+            //exit;
+            header(""Location: ./?action=devices&msg=1&id=$_POST[id]&"" . ($mdf));
+        }
+        break;
+    case ""upload_plan"": // загрузка картинки с планом помещения
+        move_uploaded_file($_FILES[""myfile""][""tmp_name""], ""plan/{$customer['planpath']}/"" . $_POST[upid] . "".png"");
+        header(""Location: ./?action=departments&msg=1&id=$_POST[id]"");
+        break;
+    case ""update_department"": // изменение данных опомещении
+        if (checkskey($_POST[id])) {
+            $res = mysql_query(""update departments set camera='$_POST[camera]', name='$_POST[name]', publish='"" . ($_POST[publish] ? 1 : 0) . ""' where id='$_POST[id]'"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=departments&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=departments&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""add_department"": // добавление нового помещения
+        if (checkskey('')) {
+            $res = mysql_query(""insert departments (name, publish, camera) values ('$_POST[name]', '"" . ($_POST[publish] ? 1 : 0) . ""', '$_POST[camera]')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=departments&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=departments&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_user"": // изменение данных пользователя
+        if (checkskey($_POST[id])) {
+            seveLog(""users"");
+            $res = mysql_query(""update users set "" . ($_POST[password] ? "" passwd='"" . md5($_POST[password]) . ""', "" : """") . "" telegram_id='$_POST[telegram_id]', name='$_POST[name]', notification_link='$_POST[notification_link]', fname=
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""delete from user_role where userID='$_POST[id]'"");
+                foreach ($_POST[role] as $k => $v) {
+                    mysql_query(""insert user_role (userID, role) values ('$_POST[id]', '$v')"");
+                }
+                mysql_query(""delete from users_email_reports where user_id='$_POST[id]'"");
+                foreach ($_POST[users_email_reports] as $k => $v) {
+                    mysql_query(""insert users_email_reports (user_id, report_slug) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=users&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=users&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""add_user"": // добавление нового пользователя
+        if (checkskey('')) {
+            seveLog(""users"");
+            $res = mysql_query(""insert users (name, fname, email, publish, passwd, notification_link, telegram_id) values ('$_POST[name]', '$_POST[fname]', '$_POST[email]', '"" . ($_POST[publish] ? 1 : 0) . ""', '"" . md5($_POST[password])
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[role] as $k => $v) {
+                    mysql_query(""insert user_role (userID, role) values ('$id', '$v')"");
+                }
+                foreach ($_POST[users_email_reports] as $k => $v) {
+                    mysql_query(""insert users_email_reports (user_id, report_slug) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=users&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=users&msg=2&$k"");
+            }
+        }
+        break;
+    case ""del_user"":
+        if (checkskey($_POST[id])) {
+            seveLog(""users"");
+            mysql_query(""delete from users WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=users"");
+        }
+        break;
+    case ""update_employee"": // изменение данных сотрудника
+        $msg = 1;
+        $res = mysql_query(""select * from employees where pin='{$_POST[pin]}'"");
+        if ($_POST[pin] and $res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $msg = 3;
+            }
+        }
+        if (checkskey($_POST['id'])) {
+            seveLog(""employees"");
+            $res = mysql_query(""UPDATE employees
                SET first_name='$_POST[first_name]',
                last_name='$_POST[last_name]',
-               RFID='$_POST[rfid]',"".
-               ($msg == 3 ? """": "" pin='$_POST[pin]', "").""
+               RFID='$_POST[rfid]',"" .
+                ($msg == 3 ? """" : "" pin='$_POST[pin]', "") . ""
                phone='$_POST[phone]',
-               publish='"".($_POST[publish] ? 1 : 0).""'
+               publish='"" . ($_POST[publish] ? 1 : 0) . ""'
                WHERE id='$_POST[id]'"");
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       // обнуляем роли
-                       mysql_query(""delete from employees_roles_bind where id='$_POST[id]'"");
-                       foreach($_POST[role] as $k => $v){
-                               // записываем новые роли
-                               mysql_query(""insert employees_roles_bind (id, role) values ('$_POST[id]', '$v')"");
-                       }
-                       // обнуляем группы оборудования
-                       mysql_query(""delete from employees_equipment_group_bind where id='$_POST[id]'"");
-                       foreach($_POST[equipments] as $k => $v){
-                               // записываем новые роли
-                               mysql_query(""insert employees_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
-                       }
-                       header(""Location: ./?action=employees&msg={$msg}&id=$_POST[id]"");
-               } else {
-                       header(""Location: ./?action=employees&msg=2&id=$_POST[id]"");
-               }
-       }
-       break;
-       case ""add_employee"": // добавление нового сотрудника
-       $msg = 1;
-       $res = mysql_query(""select * from employees where pin='{$_POST[pin]}'"");
-       if ($_POST[pin] and $res and mysql_num_rows($res)>0) {
-               while ($r = mysql_fetch_assoc($res)) {
-                       $msg = 4;
-               }
-       }
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                // обнуляем роли
+                mysql_query(""delete from employees_roles_bind where id='$_POST[id]'"");
+                foreach ($_POST[role] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert employees_roles_bind (id, role) values ('$_POST[id]', '$v')"");
+                }
+                // обнуляем группы оборудования
+                mysql_query(""delete from employees_equipment_group_bind where id='$_POST[id]'"");
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert employees_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=employees&msg={$msg}&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=employees&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""add_employee"": // добавление нового сотрудника
+        $msg = 1;
+        $res = mysql_query(""select * from employees where pin='{$_POST[pin]}'"");
+        if ($_POST[pin] and $res and mysql_num_rows($res) > 0) {
+            while ($r = mysql_fetch_assoc($res)) {
+                $msg = 4;
+            }
+        }

-       if (checkskey('')) {
-               seveLog(""employees"");
-               $res = mysql_query(""INSERT INTO employees (first_name, last_name, RFID, "".($msg == 4 ? """" : ""pin, "")."" publish, phone) VALUES ('$_POST[first_name]', '$_POST[last_name]', '$_POST[rfid]', "".($msg == 4 ? """" : ""'$_POST[pin]',
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       foreach($_POST[role] as $k => $v){
-                               // записываем роли
-                               mysql_query(""insert employees_roles_bind (id, role) values ('$id', '$v')"");
-                       }
-                       foreach($_POST[equipments] as $k => $v){
-                               // записываем группы оборудования
-                               mysql_query(""insert employees_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
-                       }
-                       header(""Location: ./?action=employees&msg={$msg}&id=$id&$k"");
-               } else {
-                       header(""Location: ./?action=employees&msg=2&$k"");
-               }
-       }
-       break;
-       case ""update_employees_roles"":
-       if (checkskey($_POST['id'])) {
-               if (trim($_POST[name]) and checkskey($_POST[id])) {
-                       mysql_query(""update employees_roles set name='$_POST[name]' where id='$_POST[id]'"");
-                       echo '{""ok"" : ""1""}';
-               }
-       }
-       break;
-       case ""add_employees_roles"":
-       if (trim($_POST[newgroupname]) and checkskey($_POST[newgroupname])) {
-               mysql_query(""insert employees_roles (name) values ('$_POST[newgroupname]')"");
-               echo '{""ok"" : ""1""}';
-       }
-       break;
-       case ""del_employees_roles"":
-       if (checkskey($_POST[id])) {
-               mysql_query(""delete from employees_roles where id='$_POST[id]'"");
-               mysql_query(""delete from employees_roles_bind where role='$_POST[id]'"");
-               echo '{""ok"" : ""1""}';
-       }
-       break;
-       case ""add_production"":
-       if (checkskey('')) {
-               seveLog(""production"");
-               $_POST[consumption] = $_POST[consumption]*1;
-               $sql = ""INSERT INTO production (name, multiplicator, consumption, publish, production_group) VALUES ('$_POST[name]', '$_POST[multiplicator]', '$_POST[consumption]', '"".($_POST[publish] ? 1 : 0).""', '$_POST[production_grou
-               $res = mysql_query($sql);
-               $k = mysql_affected_rows();
-               //var_dump($k);var_dump($sql);die('aaa');
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       foreach($_POST[material] as $k => $v){
-                               mysql_query(""insert production_material_bind (id, material) values ('$id', '$v')"");
-                       }
-                       foreach($_POST[instrument] as $k => $v){
-                               mysql_query(""insert production_instrument_bind (id, instrument) values ('$id', '$v')"");
-                       }
-                       foreach($_POST[equipments] as $k => $v){
-                               // записываем группы оборудования
-                               mysql_query(""insert production_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
-                       }
-                       header(""Location: ./?action=production&msg=1&id=$id&$k"");
-               } else {
-                       header(""Location: ./?action=production&msg=2&$k"");
-               }
-       }
-       break;
-       case ""del_production_group"":
-       if (checkskey($_POST[id])) {
-               seveLog(""del_production_group"");
-               mysql_query(""delete from  production_group_list WHERE id='$_POST[id]'"");
-               mysql_query(""update production set production_group=0 where production_group='$_POST[id]'"");
-               header(""Location: ./?action=production_group"");
-       }
-       break;
-       case ""add_production_group"":
-       if (checkskey('')) {
-               seveLog(""production_group"");
-               $sql = ""INSERT INTO production_group_list (name) VALUES ('{$_POST[name]}')"";
-               $res = mysql_query($sql);
-               $k = mysql_affected_rows();
-               if ($res and $k>-1) {
-                       $id = mysql_insert_id();
-                       header(""Location: ./?action=production_group&msg=1&id=$id&$k"");
-               } else {
-                       header(""Location: ./?action=production_group&msg=2&$k"");
-               }
-       }
-       break;
-       case ""update_production_group"":
-       if (checkskey($_POST[id])) {
-               seveLog(""production_group"");
-               $sql = ""update production_group_list set name='{$_POST[name]}' where id = {$_POST[id]}"";
-               $res = mysql_query($sql);
-               header(""Location: ./?action=production_group&msg=1&id={$_POST[id]}"");
-       }
-       break;
-       case ""update_production"":
-       if (checkskey($_POST['id'])) {
-               seveLog(""production"");
-               $res = mysql_query(""UPDATE production
+        if (checkskey('')) {
+            seveLog(""employees"");
+            $res = mysql_query(""INSERT INTO employees (first_name, last_name, RFID, "" . ($msg == 4 ? """" : ""pin, "") . "" publish, phone) VALUES ('$_POST[first_name]', '$_POST[last_name]', '$_POST[rfid]', "" . ($msg == 4 ? """" : ""'$_POST[pin
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[role] as $k => $v) {
+                    // записываем роли
+                    mysql_query(""insert employees_roles_bind (id, role) values ('$id', '$v')"");
+                }
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем группы оборудования
+                    mysql_query(""insert employees_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=employees&msg={$msg}&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=employees&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_employees_roles"":
+        if (checkskey($_POST['id'])) {
+            if (trim($_POST[name]) and checkskey($_POST[id])) {
+                mysql_query(""update employees_roles set name='$_POST[name]' where id='$_POST[id]'"");
+                echo '{""ok"" : ""1""}';
+            }
+        }
+        break;
+    case ""add_employees_roles"":
+        if (trim($_POST[newgroupname]) and checkskey($_POST[newgroupname])) {
+            mysql_query(""insert employees_roles (name) values ('$_POST[newgroupname]')"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""del_employees_roles"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""delete from employees_roles where id='$_POST[id]'"");
+            mysql_query(""delete from employees_roles_bind where role='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""add_production"":
+        if (checkskey('')) {
+            seveLog(""production"");
+            $_POST[consumption] = $_POST[consumption] * 1;
+            $sql = ""INSERT INTO production (name, multiplicator, consumption, publish, production_group) VALUES ('$_POST[name]', '$_POST[multiplicator]', '$_POST[consumption]', '"" . ($_POST[publish] ? 1 : 0) . ""', '$_POST[production_gro
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            //var_dump($k);var_dump($sql);die('aaa');
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[material] as $k => $v) {
+                    mysql_query(""insert production_material_bind (id, material) values ('$id', '$v')"");
+                }
+                foreach ($_POST[instrument] as $k => $v) {
+                    mysql_query(""insert production_instrument_bind (id, instrument) values ('$id', '$v')"");
+                }
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем группы оборудования
+                    mysql_query(""insert production_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=production&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=production&msg=2&$k"");
+            }
+        }
+        break;
+    case ""del_production_group"":
+        if (checkskey($_POST[id])) {
+            seveLog(""del_production_group"");
+            mysql_query(""delete from  production_group_list WHERE id='$_POST[id]'"");
+            mysql_query(""update production set production_group=0 where production_group='$_POST[id]'"");
+            header(""Location: ./?action=production_group"");
+        }
+        break;
+    case ""add_production_group"":
+        if (checkskey('')) {
+            seveLog(""production_group"");
+            $sql = ""INSERT INTO production_group_list (name) VALUES ('{$_POST[name]}')"";
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=production_group&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=production_group&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_production_group"":
+        if (checkskey($_POST[id])) {
+            seveLog(""production_group"");
+            $sql = ""update production_group_list set name='{$_POST[name]}' where id = {$_POST[id]}"";
+            $res = mysql_query($sql);
+            header(""Location: ./?action=production_group&msg=1&id={$_POST[id]}"");
+        }
+        break;
+    case ""update_production"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""production"");
+            $res = mysql_query(""UPDATE production
                        SET name='$_POST[name]',
                        multiplicator='$_POST[multiplicator]',
                        consumption='$_POST[consumption]',
                        production_group='$_POST[production_group]',
-                       publish='"".($_POST[publish] ? 1 : 0).""'
+                       publish='"" . ($_POST[publish] ? 1 : 0) . ""'
                        WHERE id='$_POST[id]'"");
-                       $k = mysql_affected_rows();
-                       if ($res and $k>-1) {
-                               mysql_query(""delete from production_material_bind where id='$_POST[id]'"");
-                               foreach($_POST[material] as $k => $v){
-                                       mysql_query(""insert production_material_bind (id, material) values ('$_POST[id]', '$v')"");
-                               }
-                               mysql_query(""delete from production_instrument_bind where id='$_POST[id]'"");
-                               foreach($_POST[instrument] as $k => $v){
-                                       mysql_query(""insert production_instrument_bind (id, instrument) values ('$_POST[id]', '$v')"");
-                               }
-                               // обнуляем группы оборудования
-                               mysql_query(""delete from production_equipment_group_bind where id='$_POST[id]'"");
-                               foreach($_POST[equipments] as $k => $v){
-                                       // записываем новые роли
-                                       mysql_query(""insert production_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
-                               }
-                               header(""Location: ./?action=production&msg=1&id=$_POST[id]"");
-                       } else {
-                               header(""Location: ./?action=production&msg=2&id=$_POST[id]"");
-                       }
-               }
-               break;
-               case ""del_production"":
-               if (checkskey($_POST[id])) {
-                       seveLog(""production"");
-                       mysql_query(""delete from production WHERE id='$_POST[id]'"");
-                       header(""Location: ./?action=production"");
-               }
-               break;
-               case ""update_norma"":
-               seveLog(""norma"");
-               if (checkskey($_POST['id'])) {
-                       $res = mysql_query(""UPDATE norma
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""delete from production_material_bind where id='$_POST[id]'"");
+                foreach ($_POST[material] as $k => $v) {
+                    mysql_query(""insert production_material_bind (id, material) values ('$_POST[id]', '$v')"");
+                }
+                mysql_query(""delete from production_instrument_bind where id='$_POST[id]'"");
+                foreach ($_POST[instrument] as $k => $v) {
+                    mysql_query(""insert production_instrument_bind (id, instrument) values ('$_POST[id]', '$v')"");
+                }
+                // обнуляем группы оборудования
+                mysql_query(""delete from production_equipment_group_bind where id='$_POST[id]'"");
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert production_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=production&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=production&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""del_production"":
+        if (checkskey($_POST[id])) {
+            seveLog(""production"");
+            mysql_query(""delete from production WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=production"");
+        }
+        break;
+    case ""update_norma"":
+        seveLog(""norma"");
+        if (checkskey($_POST['id'])) {
+            $res = mysql_query(""UPDATE norma
                                SET time='$_POST[time]',
                                percent='{$_POST['percent']}',
                                material='$_POST[material]',
                                instrument='$_POST[instrument]',
                                product='$_POST[product]'
                                WHERE id='$_POST[id]'"");
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       header(""Location: ./?action=norma&msg=1&id=$_POST[id]"");
-                               } else {
-                                       header(""Location: ./?action=norma&msg=2&id=$_POST[id]"");
-                               }
-                       }
-                       break;
-                       case ""add_norma"":
-                       if (checkskey($_POST['id'])) {
-                               seveLog(""norma"");
-                               $res = mysql_query(""INSERT INTO norma (time, percent, material, instrument, product) VALUES ('$_POST[time]', '{$_POST['percent']}', '$_POST[material]', '$_POST[instrument]', '$_POST[product]')"");
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       $id = mysql_insert_id();
-                                       header(""Location: ./?action=norma&msg=1&id={$id}"");
-                               } else {
-                                       header(""Location: ./?action=norma&msg=2&id=$_POST[id]"");
-                               }
-                       }
-                       break;
-                       case ""del_norma"":
-                       if (checkskey($_POST[id])) {
-                               seveLog(""norma"");
-                               mysql_query(""delete from norma WHERE id='$_POST[id]'"");
-                               header(""Location: ./?action=norma"");
-                       }
-                       break;
-                       case ""add_instrument"":
-                       if (checkskey('')) {
-                               seveLog(""instrument"");
-                               $res = mysql_query(""INSERT INTO instrument (name, circles_before_to, divider, publish) VALUES ('$_POST[name]', '$_POST[circles_before_to]', '$_POST[divider]', '"".($_POST[publish] ? 1 : 0).""')"");
-                               $k = mysql_affected_rows();
-                               if ($res and $k>-1) {
-                                       $id = mysql_insert_id();
-                                       foreach($_POST[material] as $k => $v){
-                                               // записываем роли
-                                               mysql_query(""insert instrument_material_bind (id, material) values ('$id', '$v')"");
-                                       }
-                                       foreach($_POST[equipments] as $k => $v){
-                                               // записываем группы оборудования
-                                               mysql_query(""insert instrument_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
-                                       }
-                                       header(""Location: ./?action=instrument&msg=1&id=$id&$k"");
-                               } else {
-                                       header(""Location: ./?action=instrument&msg=2&$k"");
-                               }
-                       }
-                       break;
-                       case ""update_instrument"":
-                       if (checkskey($_POST['id'])) {
-                               seveLog(""instrument"");
-                               $res = mysql_query(""UPDATE instrument
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                header(""Location: ./?action=norma&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=norma&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""add_norma"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""norma"");
+            $res = mysql_query(""INSERT INTO norma (time, percent, material, instrument, product) VALUES ('$_POST[time]', '{$_POST['percent']}', '$_POST[material]', '$_POST[instrument]', '$_POST[product]')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=norma&msg=1&id={$id}"");
+            } else {
+                header(""Location: ./?action=norma&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""del_norma"":
+        if (checkskey($_POST[id])) {
+            seveLog(""norma"");
+            mysql_query(""delete from norma WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=norma"");
+        }
+        break;
+    case ""add_instrument"":
+        if (checkskey('')) {
+            seveLog(""instrument"");
+            $res = mysql_query(""INSERT INTO instrument (name, circles_before_to, divider, publish) VALUES ('$_POST[name]', '$_POST[circles_before_to]', '$_POST[divider]', '"" . ($_POST[publish] ? 1 : 0) . ""')"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[material] as $k => $v) {
+                    // записываем роли
+                    mysql_query(""insert instrument_material_bind (id, material) values ('$id', '$v')"");
+                }
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем группы оборудования
+                    mysql_query(""insert instrument_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=instrument&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=instrument&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_instrument"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""instrument"");
+            $res = mysql_query(""UPDATE instrument
                                        SET name='$_POST[name]',
                                        circles_before_to='$_POST[circles_before_to]',
                                        divider='$_POST[divider]',
-                                       publish='"".($_POST[publish] ? 1 : 0).""'
+                                       publish='"" . ($_POST[publish] ? 1 : 0) . ""'
                                        WHERE id='$_POST[id]'"");
-                                       $k = mysql_affected_rows();
-                                       if ($res and $k>-1) {
-                                               mysql_query(""delete from instrument_material_bind where id='$_POST[id]'"");
-                                               foreach($_POST[material] as $k => $v){
-                                                       mysql_query(""insert instrument_material_bind (id, material) values ('$_POST[id]', '$v')"");
-                                               }
-                                               // обнуляем группы оборудования
-                                               mysql_query(""delete from instrument_equipment_group_bind where id='$_POST[id]'"");
-                                               foreach($_POST[equipments] as $k => $v){
-                                                       // записываем новые роли
-                                                       mysql_query(""insert instrument_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
-                                               }
-                                               header(""Location: ./?action=instrument&msg=1&id=$_POST[id]"");
-                                       } else {
-                                               header(""Location: ./?action=instrument&msg=2&id=$_POST[id]"");
-                                       }
-                               }
-                               break;
-                               case ""del_instrument"":
-                               if (checkskey($_POST[id])) {
-                                       seveLog(""instrument"");
-                                       mysql_query(""delete from instrument WHERE id='$_POST[id]'"");
-                                       header(""Location: ./?action=instrument"");
-                               }
-                               break;
-                               case ""add_reason"":
-                               if (checkskey('')) {
-                                       seveLog(""reasons"");
-                                       $res = mysql_query(""INSERT INTO reasons (name, color, publish, plan, autostop) VALUES ('{$_POST[name]}', '{$_POST[color]}', '"".($_POST[publish] ? 1 : 0).""', '"".($_POST[plan] ? 1 : 0).""', '"".($_POST
-                                       $k = mysql_affected_rows();
-                                       if ($res and $k>-1) {
-                                               $id = mysql_insert_id();
-                                               foreach($_POST[role] as $k => $v){
-                                                       // записываем роли
-                                                       mysql_query(""insert reasons_roles_bind (id, role) values ('$id', '$v')"");
-                                               }
-                                               foreach($_POST[equipments] as $k => $v){
-                                                       // записываем группы оборудования
-                                                       mysql_query(""insert reasons_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
-                                               }
-                                               header(""Location: ./?action=reasons&msg=1&id=$id&$k"");
-                                       } else {
-                                               header(""Location: ./?action=reasons&msg=2&$k"");
-                                       }
-                               }
-                               break;
-                               case ""update_reason"":
-                               if (checkskey($_POST['id'])) {
-                                       seveLog(""reasons"");
-                                       $res = mysql_query(""UPDATE reasons
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""delete from instrument_material_bind where id='$_POST[id]'"");
+                foreach ($_POST[material] as $k => $v) {
+                    mysql_query(""insert instrument_material_bind (id, material) values ('$_POST[id]', '$v')"");
+                }
+                // обнуляем группы оборудования
+                mysql_query(""delete from instrument_equipment_group_bind where id='$_POST[id]'"");
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert instrument_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=instrument&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=instrument&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""del_instrument"":
+        if (checkskey($_POST[id])) {
+            seveLog(""instrument"");
+            mysql_query(""delete from instrument WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=instrument"");
+        }
+        break;
+    case ""add_reason"":
+        if (checkskey('')) {
+            seveLog(""reasons"");
+            $res = mysql_query(""INSERT INTO reasons (name, color, publish, plan, autostop) VALUES ('{$_POST[name]}', '{$_POST[color]}', '"" . ($_POST[publish] ? 1 : 0) . ""', '"" . ($_POST[plan] ? 1 : 0) . ""', '"" . ($_POST[autostop] ? 1 :
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                foreach ($_POST[role] as $k => $v) {
+                    // записываем роли
+                    mysql_query(""insert reasons_roles_bind (id, role) values ('$id', '$v')"");
+                }
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем группы оборудования
+                    mysql_query(""insert reasons_equipment_group_bind (id, equipment_group) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=reasons&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=reasons&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_reason"":
+        if (checkskey($_POST['id'])) {
+            seveLog(""reasons"");
+            $res = mysql_query(""UPDATE reasons
                                                SET name='$_POST[name]',
                                                color='$_POST[color]',
-                                               publish='"".($_POST[publish] ? 1 : 0).""',
-                                               autostop='"".($_POST[autostop] ? 1 : 0).""',
-                                               plan='"".($_POST[plan] ? 1 : 0).""'
+                                               publish='"" . ($_POST[publish] ? 1 : 0) . ""',
+                                               autostop='"" . ($_POST[autostop] ? 1 : 0) . ""',
+                                               plan='"" . ($_POST[plan] ? 1 : 0) . ""'
                                                WHERE id='$_POST[id]'"");
-                                               $k = mysql_affected_rows();
-                                               if ($res and $k>-1) {
-                                                       // обнуляем роли
-                                                       mysql_query(""delete from reasons_roles_bind where id='$_POST[id]'"");
-                                                       foreach($_POST[role] as $k => $v){
-                                                               // записываем новые роли
-                                                               mysql_query(""insert reasons_roles_bind (id, role) values ('$_POST[id]', '$v')"");
-                                                       }
-                                                       // обнуляем группы оборудования
-                                                       mysql_query(""delete from reasons_equipment_group_bind where id='$_POST[id]'"");
-                                                       foreach($_POST[equipments] as $k => $v){
-                                                               // записываем новые роли
-                                                               mysql_query(""insert reasons_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
-                                                       }
-                                                       header(""Location: ./?action=reasons&msg=1&id=$_POST[id]"");
-                                               } else {
-                                                       header(""Location: ./?action=reasons&msg=2&id=$_POST[id]"");
-                                               }
-                                       }
-                                       break;
-                                       case ""del_reason"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""reasons"");
-                                               mysql_query(""delete from reasons WHERE id='$_POST[id]'"");
-                                               header(""Location: ./?action=reasons"");
-                                       }
-                                       break;
-                                       case ""add_material"":
-                                       if (checkskey('')) {
-                                               seveLog(""material"");
-                                               $sql = ""INSERT INTO material (name, publish) VALUES ('{$_POST[name]}', "".($_POST[publish] ? 1 : 0)."")"";
-                                               $res = mysql_query($sql);
-                                               $k = mysql_affected_rows();
-                                               if ($res and $k>-1) {
-                                                       $id = mysql_insert_id();
-                                                       header(""Location: ./?action=material&msg=1&id=$id&$k"");
-                                               } else {
-                                                       header(""Location: ./?action=material&msg=2&$k"");
-                                               }
-                                       }
-                                       break;
-                                       case ""del_material"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""material"");
-                                               $sql = ""delete from material where id = {$_POST[id]}"";
-                                               $res = mysql_query($sql);
-                                               header(""Location: ./?action=material&msg=1"");
-                                       }
-                                       break;
-                                       case ""update_material"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""material"");
-                                               $sql = ""update material set name='{$_POST[name]}', publish="".($_POST[publish] ? 1 : 0)."" where id = {$_POST[id]}"";
-                                               $res = mysql_query($sql);
-                                               header(""Location: ./?action=material&msg=1&id={$_POST[id]}"");
-                                       }
-                                       break;
-                                       case ""del_employe"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""employees"");
-                                               mysql_query(""delete from employees WHERE id='$_POST[id]'"");
-                                               header(""Location: ./?action=employees"");
-                                       }
-                                       break;
-                                       case ""add_equipment"": // добавление нового оборудования
-                                       if (checkskey('')) {
-                                               seveLog(""equipment"");
-                                               if ($_POST[now]) {
-                                                       $wts = ""now()"";
-                                               } else {
-                                                       $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
-                                               }
-                                               if ($_POST[arm]) {
-                                                       mysql_query(""update equipment_list set arm=0 where arm='{$_POST[arm]}'"");
-                                               }
-                                               $res = mysql_query(""insert equipment_list (name, arm, publish, time_tracking, camera, camera_token, can_plan, no_notifications, work_time_start, average_working_time, downtime_limit) values
-                                               mysql_query(""insert equipment_condition (timestamp, equipment, status) values ('1970-01-01 00:00:00', '{$_POST[id]}', 0)"");
-                                               $k = mysql_affected_rows();
-                                               if ($res and $k>-1) {
-                                                       $id = mysql_insert_id();
-                                                       mysql_query(""update devices set equipment_id='$id' where id='$_POST[newdevice]'"");
-                                                       mysql_query(""update devices set equipment_id=0 where equipment_id='$id' and id<>'$_POST[newdevice]'"");
-                                                       foreach($_POST[group] as $k => $v){
-                                                               mysql_query(""insert equipment_group (equipmentID, groupID) values ('$id', '$v')"");
-                                                       }
-                                                       header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=1&id=$id&$k"");
-                                               } else {
-                                                       header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=2&$k"");
-                                               }
-                                       }
-                                       break;
-                                       case ""update_equipment"":
-                                       if (checkskey($_POST[id])) {
-                                               seveLog(""equipment"");
-                                               if ($_POST[now]) {
-                                                       $wts = ""now()"";
-                                               } else {
-                                                       $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
-                                               }
-                                               if ($_POST[arm]) {
-                                                       mysql_query(""update equipment_list set arm=0 where arm='{$_POST[arm]}' and id != '{$_POST[id]}'"");
-                                               }
-                                               mysql_query(""delete from equipment_sensors where equipment_id='{$_POST[id]}'"");
-                                               foreach($_POST[connected_sensor] as $key => $val){
-                                                       $sql = ""insert equipment_sensors (equipment_id, sensor_id, is_units_counter, is_cirquit_channel, is_counter_to_circle) values ('{$_POST[id]}', '{$key}', '"".($key == $_POST['units_co
-                                                       //echo $sql.""\n"";
-                                                       mysql_query($sql);
-                                               }
-                                               //exit;
-                                               $res = mysql_query(""update equipment_list set arm='{$_POST[arm]}', work_time_start={$wts}, average_working_time='{$_POST[average_working_time]}', can_plan='"".($_POST[can_plan] ? 1 : 0).""',
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                // обнуляем роли
+                mysql_query(""delete from reasons_roles_bind where id='$_POST[id]'"");
+                foreach ($_POST[role] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert reasons_roles_bind (id, role) values ('$_POST[id]', '$v')"");
+                }
+                // обнуляем группы оборудования
+                mysql_query(""delete from reasons_equipment_group_bind where id='$_POST[id]'"");
+                foreach ($_POST[equipments] as $k => $v) {
+                    // записываем новые роли
+                    mysql_query(""insert reasons_equipment_group_bind (id, equipment_group) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=reasons&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=reasons&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""del_reason"":
+        if (checkskey($_POST[id])) {
+            seveLog(""reasons"");
+            mysql_query(""delete from reasons WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=reasons"");
+        }
+        break;
+    case ""add_material"":
+        if (checkskey('')) {
+            seveLog(""material"");
+            $sql = ""INSERT INTO material (name, publish) VALUES ('{$_POST[name]}', "" . ($_POST[publish] ? 1 : 0) . "")"";
+            $res = mysql_query($sql);
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                header(""Location: ./?action=material&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=material&msg=2&$k"");
+            }
+        }
+        break;
+    case ""del_material"":
+        if (checkskey($_POST[id])) {
+            seveLog(""material"");
+            $sql = ""delete from material where id = {$_POST[id]}"";
+            $res = mysql_query($sql);
+            header(""Location: ./?action=material&msg=1"");
+        }
+        break;
+    case ""update_material"":
+        if (checkskey($_POST[id])) {
+            seveLog(""material"");
+            $sql = ""update material set name='{$_POST[name]}', publish="" . ($_POST[publish] ? 1 : 0) . "" where id = {$_POST[id]}"";
+            $res = mysql_query($sql);
+            header(""Location: ./?action=material&msg=1&id={$_POST[id]}"");
+        }
+        break;
+    case ""del_employe"":
+        if (checkskey($_POST[id])) {
+            seveLog(""employees"");
+            mysql_query(""delete from employees WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=employees"");
+        }
+        break;
+    case ""add_equipment"": // добавление нового оборудования
+        if (checkskey('')) {
+            seveLog(""equipment"");
+            if ($_POST[now]) {
+                $wts = ""now()"";
+            } else {
+                $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
+            }
+            if ($_POST[arm]) {
+                mysql_query(""update equipment_list set arm=0 where arm='{$_POST[arm]}'"");
+            }
+            $res = mysql_query(""insert equipment_list (name, arm, publish, time_tracking, camera, camera_token, can_plan, no_notifications, work_time_start, average_working_time, downtime_limit) values ('$_POST[name]', '$_POST[arm]', '""
+            mysql_query(""insert equipment_condition (timestamp, equipment, status) values ('1970-01-01 00:00:00', '{$_POST[id]}', 0)"");
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                $id = mysql_insert_id();
+                mysql_query(""update devices set equipment_id='$id' where id='$_POST[newdevice]'"");
+                mysql_query(""update devices set equipment_id=0 where equipment_id='$id' and id<>'$_POST[newdevice]'"");
+                foreach ($_POST[group] as $k => $v) {
+                    mysql_query(""insert equipment_group (equipmentID, groupID) values ('$id', '$v')"");
+                }
+                header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=1&id=$id&$k"");
+            } else {
+                header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=2&$k"");
+            }
+        }
+        break;
+    case ""update_equipment"":
+        if (checkskey($_POST[id])) {
+            seveLog(""equipment"");
+            if ($_POST[now]) {
+                $wts = ""now()"";
+            } else {
+                $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
+            }
+            if ($_POST[arm]) {
+                mysql_query(""update equipment_list set arm=0 where arm='{$_POST[arm]}' and id != '{$_POST[id]}'"");
+            }
+            mysql_query(""delete from equipment_sensors where equipment_id='{$_POST[id]}'"");
+            foreach ($_POST[connected_sensor] as $key => $val) {
+                $sql = ""insert equipment_sensors (equipment_id, sensor_id, is_units_counter, is_cirquit_channel, is_counter_to_circle) values ('{$_POST[id]}', '{$key}', '"" . ($key == $_POST['units_counter'] ? 1 : 0) . ""', '"" . ($key ==
+                //echo $sql.""\n"";
+                mysql_query($sql);
+            }
+            //exit;
+            $res = mysql_query(""update equipment_list set arm='{$_POST[arm]}', work_time_start={$wts}, average_working_time='{$_POST[average_working_time]}', can_plan='"" . ($_POST[can_plan] ? 1 : 0) . ""', no_notifications='"" . ($_POST[n

-                                               $k = mysql_affected_rows();
-                                               if ($res and $k>-1) {
-                                                       mysql_query(""insert equipment_condition (timestamp, equipment, status) values ('1970-01-01 00:00:00', '{$_POST[id]}', 0)"");
-                                                       mysql_query(""update devices set equipment_id='$_POST[id]' where id='$_POST[device]'"");
-                                                       mysql_query(""update devices set equipment_id=0 where equipment_id='$_POST[id]' and id<>'$_POST[device]'"");
-                                                       mysql_query(""delete from equipment_group where equipmentID='$_POST[id]'"");
-                                                       foreach($_POST[group] as $k => $v){
-                                                               mysql_query(""insert equipment_group (equipmentID, groupID) values ('$_POST[id]', '$v')"");
-                                                       }
-                                                       header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=1&id=$_POST[id]"");
-                                               } else {
-                                                       header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=2&id=$_POST[id]"");
-                                               }
-                                       }
-                                       break;
-                                       case ""update_equipment_worked"":
-                                       seveLog(""equipment_worked"");
-                                       if ($_POST[now]) {
-                                               $wts = ""now()"";
-                                       } else {
-                                               $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
-                                       }
-                                       $res = mysql_query(""update equipment_list set work_time_start={$wts}, average_working_time='{$_POST[average_working_time]}' where id='$_POST[id]'"");
-                                       header(""Location: ./?action=equipment_worked&active_only={$_POST[active_only]}&id=$_POST[id]"");
-                                       break;
-                                       case ""del_equipment"":
-                                       if (checkskey($_POST[id])) {
-                                               mysql_query(""delete from equipment_list WHERE id='$_POST[id]'"");
-                                               header(""Location: ./?action=equipment&active_only={$_POST[active_only]}"");
-                                       }
-                                       break;
-                                       case ""del_group"":
-                                       if (checkskey($_POST[id])) {
-                                               mysql_query(""delete from equipment_group_list where id='$_POST[id]'"");
-                                               mysql_query(""delete from equipment_group where groupID='$_POST[id]'"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""add_group"":
-                                       if (trim($_POST[newgroupname]) and checkskey($_POST[newgroupname])) {
-                                               mysql_query(""insert equipment_group_list (name) values ('$_POST[newgroupname]')"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""update_group"":
-                                       if (trim($_POST[name]) and checkskey($_POST[id])) {
-                                               mysql_query(""update equipment_group_list set name='$_POST[name]' where id='$_POST[id]'"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""save_equipment_coord"":
-                                       if (checkskey($_POST[id])) {
-                                               mysql_query(""update equipment_list set department='$_POST[department]', y='$_POST[y]', x='$_POST[x]', x2='$_POST[x2]', y2='$_POST[y2]' where id='$_POST[id]'"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""del_equipment_coord"":
-                                       if (checkskey($_POST[id])) {
-                                               mysql_query(""update equipment_list set department='0', y='0', x='0', x2='0', y2='0' where id='$_POST[id]'"");
-                                               echo '{""ok"" : ""1""}';
-                                       }
-                                       break;
-                                       case ""copy_formula"":
-                                               if (checkskey($_POST[IDto])) {
-                                                       seveLog(""formula"");
-                                                       $res = mysql_query(""select * from formuls where device_id='$_POST[IDfrom]'"");
-                                                       if ($res and mysql_num_rows($res)>0) {
-                                                               while ($r = mysql_fetch_array($res)) {
-                                                                       mysql_query(""insert formuls (title, device_id, status_id, formula) values ('$r[title]', '$_POST[IDto]', '$r[status_id]', '$r[formula]')"");
-                                                               }
-                                                       }
-                                                       header(""Location: ./?action=formula&device_id=$_POST[IDto]"");
-                                               }
-                                               break;
-                                               case ""copy_formula_energy"":
-                                                       if (checkskey($_POST[IDto])) {
-                                                               seveLog(""formula_energy"");
-                                                               $res = mysql_query(""select * from formuls_energy where equipment_id='$_POST[IDfrom]'"");
-                                                               if ($res and mysql_num_rows($res)>0) {
-                                                                       while ($r = mysql_fetch_array($res)) {
-                                                                               mysql_query(""insert formuls_energy (title, equipment_id, formula, resource_id) values ('$r[title]', '$_POST[IDto]', '$r[formula]', '$r[resource_id]')"");
-                                                                       }
-                                                               }
-                                                               header(""Location: ./?action=formula_energy&equipment_id=$_POST[IDto]&resource_id=$_POST[resource_id]"");
-                                                       }
-                                                       break;
-                                                       case ""del_formula"":
-                                                               if (checkskey($_POST[device_id])) {
-                                                                       seveLog(""formula"");
-                                                                       mysql_query(""DELETE FROM formuls WHERE id='$_POST[id]' LIMIT 1"");
-                                                               }
-                                                               header(""Location: ./?action=formula&device_id=$_POST[device_id]"");
-                                                               break;
-                                                               case ""del_formula_energy"":
-                                                                       if (checkskey($_POST[device_id])) {
-                                                                               seveLog(""formula_energy"");
-                                                                               mysql_query(""DELETE FROM formuls_energy WHERE id='$_POST[id]' LIMIT 1"");
-                                                                       }
-                                                                       header(""Location: ./?action=formula_energy&device_id=$_POST[device_id]"");
-                                                                       break;
-                                                                       case ""add_status"":
-                                                                       case ""update_status"":
-                                                                       seveLog(""statuses"");
-                                                                       include_once '../models/Status.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               $data = [
-                                                                                       'title' => htmlspecialchars($_POST['title']),
-                                                                                       'is_it_work' => (!empty($_POST['is_it_work'])) ? 1 : 0,
-                                                                                       'subtitle' => (!empty($_POST['subtitle'])) ? 1 : 0,
-                                                                                       'color' => htmlspecialchars($_POST['color']),
-                                                                               ];
-                                                                               if ($_POST['action'] == 'add_status') {
-                                                                                       Status::insert($data);
-                                                                                       $id = Status::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_status') {
-                                                                                       Status::update($data, $id);
-                                                                               }
-                                                                               header(""Location: ./?action=statuses&id={$id}"");
-                                                                       }
-                                                                       break;
-                                                                       case 'change_status' :
-                                                                       if (checkskey()) {
-                                                                               $equipment = isset($_POST['equipment']) ? intval($_POST['equipment']) : null;
-                                                                               $status = isset($_POST['status']) ? intval($_POST['status']) : null;
-                                                                               if ($equipment !== null && $status !== null) {
-                                                                                       $time = date('Y-m-d H:i:s');
-                                                                                       DB::query(""INSERT INTO `equipment_condition` (`timestamp`, `equipment`, `status`, `source`)
+            $k = mysql_affected_rows();
+            if ($res and $k > -1) {
+                mysql_query(""insert equipment_condition (timestamp, equipment, status) values ('1970-01-01 00:00:00', '{$_POST[id]}', 0)"");
+                mysql_query(""update devices set equipment_id='$_POST[id]' where id='$_POST[device]'"");
+                mysql_query(""update devices set equipment_id=0 where equipment_id='$_POST[id]' and id<>'$_POST[device]'"");
+                mysql_query(""delete from equipment_group where equipmentID='$_POST[id]'"");
+                foreach ($_POST[group] as $k => $v) {
+                    mysql_query(""insert equipment_group (equipmentID, groupID) values ('$_POST[id]', '$v')"");
+                }
+                header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=1&id=$_POST[id]"");
+            } else {
+                header(""Location: ./?action=equipment&active_only={$_POST[active_only]}&msg=2&id=$_POST[id]"");
+            }
+        }
+        break;
+    case ""update_equipment_worked"":
+        seveLog(""equipment_worked"");
+        if ($_POST[now]) {
+            $wts = ""now()"";
+        } else {
+            $wts = ($_POST[work_time_start] ? ""'{$_POST[work_time_start]}'"" : ""NULL"");
+        }
+        $res = mysql_query(""update equipment_list set work_time_start={$wts}, average_working_time='{$_POST[average_working_time]}' where id='$_POST[id]'"");
+        header(""Location: ./?action=equipment_worked&active_only={$_POST[active_only]}&id=$_POST[id]"");
+        break;
+    case ""del_equipment"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""delete from equipment_list WHERE id='$_POST[id]'"");
+            header(""Location: ./?action=equipment&active_only={$_POST[active_only]}"");
+        }
+        break;
+    case ""del_group"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""delete from equipment_group_list where id='$_POST[id]'"");
+            mysql_query(""delete from equipment_group where groupID='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""add_group"":
+        if (trim($_POST[newgroupname]) and checkskey($_POST[newgroupname])) {
+            mysql_query(""insert equipment_group_list (name) values ('$_POST[newgroupname]')"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""update_group"":
+        if (trim($_POST[name]) and checkskey($_POST[id])) {
+            mysql_query(""update equipment_group_list set name='$_POST[name]' where id='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""save_equipment_coord"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""update equipment_list set department='$_POST[department]', y='$_POST[y]', x='$_POST[x]', x2='$_POST[x2]', y2='$_POST[y2]' where id='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""del_equipment_coord"":
+        if (checkskey($_POST[id])) {
+            mysql_query(""update equipment_list set department='0', y='0', x='0', x2='0', y2='0' where id='$_POST[id]'"");
+            echo '{""ok"" : ""1""}';
+        }
+        break;
+    case ""copy_formula"":
+        if (checkskey($_POST[IDto])) {
+            seveLog(""formula"");
+            $res = mysql_query(""select * from formuls where device_id='$_POST[IDfrom]'"");
+            if ($res and mysql_num_rows($res) > 0) {
+                while ($r = mysql_fetch_array($res)) {
+                    mysql_query(""insert formuls (title, device_id, status_id, formula) values ('$r[title]', '$_POST[IDto]', '$r[status_id]', '$r[formula]')"");
+                }
+            }
+            header(""Location: ./?action=formula&device_id=$_POST[IDto]"");
+        }
+        break;
+    case ""copy_formula_energy"":
+        if (checkskey($_POST[IDto])) {
+            seveLog(""formula_energy"");
+            $res = mysql_query(""select * from formuls_energy where equipment_id='$_POST[IDfrom]'"");
+            if ($res and mysql_num_rows($res) > 0) {
+                while ($r = mysql_fetch_array($res)) {
+                    mysql_query(""insert formuls_energy (title, equipment_id, formula, resource_id) values ('$r[title]', '$_POST[IDto]', '$r[formula]', '$r[resource_id]')"");
+                }
+            }
+            header(""Location: ./?action=formula_energy&equipment_id=$_POST[IDto]&resource_id=$_POST[resource_id]"");
+        }
+        break;
+    case ""del_formula"":
+        if (checkskey($_POST[device_id])) {
+            seveLog(""formula"");
+            mysql_query(""DELETE FROM formuls WHERE id='$_POST[id]' LIMIT 1"");
+        }
+        header(""Location: ./?action=formula&device_id=$_POST[device_id]"");
+        break;
+    case ""del_formula_energy"":
+        if (checkskey($_POST[device_id])) {
+            seveLog(""formula_energy"");
+            mysql_query(""DELETE FROM formuls_energy WHERE id='$_POST[id]' LIMIT 1"");
+        }
+        header(""Location: ./?action=formula_energy&device_id=$_POST[device_id]"");
+        break;
+    case ""add_status"":
+    case ""update_status"":
+        seveLog(""statuses"");
+        include_once '../models/Status.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            $data = [
+                'title' => htmlspecialchars($_POST['title']),
+                'is_it_work' => (!empty($_POST['is_it_work'])) ? 1 : 0,
+                'subtitle' => (!empty($_POST['subtitle'])) ? 1 : 0,
+                'color' => htmlspecialchars($_POST['color']),
+            ];
+            if ($_POST['action'] == 'add_status') {
+                Status::insert($data);
+                $id = Status::insertId();
+            }
+            if ($_POST['action'] == 'update_status') {
+                Status::update($data, $id);
+            }
+            header(""Location: ./?action=statuses&id={$id}"");
+        }
+        break;
+    case 'change_status' :
+        if (checkskey()) {
+            $equipment = isset($_POST['equipment']) ? intval($_POST['equipment']) : null;
+            $status = isset($_POST['status']) ? intval($_POST['status']) : null;
+            if ($equipment !== null && $status !== null) {
+                $time = date('Y-m-d H:i:s');
+                DB::query(""INSERT INTO `equipment_condition` (`timestamp`, `equipment`, `status`, `source`)
                                                                                        VALUES('$time', '$equipment', '$status', 'change_status')"");
-                                                                               }
-                                                                               echo json_encode('OK');
-                                                                       }
-                                                                       break;
+            }
+            echo json_encode('OK');
+        }
+        break;

-                                                                       // Технологические этапы
-                                                                       case ""add_tplan_stage"":
-                                                                       case ""update_tplan_stage"":
-                                                                       include_once '../models/TplanStage.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               $data = [
-                                                                                       'name' => htmlspecialchars($_POST['name']),
-                                                                                       'equipment_count' => count($_POST['equipment']),
-                                                                                       'sort' => intval($_POST['sort']),
-                                                                                       'active' => (!empty($_POST['active'])) ? 1 : 0,
-                                                                                       'color' => htmlspecialchars($_POST['color']),
-                                                                                       'bg_color' => htmlspecialchars($_POST['bg_color'])
-                                                                               ];
+    // Технологические этапы
+    case ""add_tplan_stage"":
+    case ""update_tplan_stage"":
+        include_once '../models/TplanStage.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            $data = [
+                'name' => htmlspecialchars($_POST['name']),
+                'equipment_count' => count($_POST['equipment']),
+                'sort' => intval($_POST['sort']),
+                'active' => (!empty($_POST['active'])) ? 1 : 0,
+                'color' => htmlspecialchars($_POST['color']),
+                'bg_color' => htmlspecialchars($_POST['bg_color'])
+            ];

-                                                                               if ($_POST['action'] == 'add_tplan_stage') {
-                                                                                       TplanStage::insert($data);
-                                                                                       $id = TplanStage::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_tplan_stage') {
-                                                                                       TplanStage::update($data, $id);
-                                                                               }
+            if ($_POST['action'] == 'add_tplan_stage') {
+                TplanStage::insert($data);
+                $id = TplanStage::insertId();
+            }
+            if ($_POST['action'] == 'update_tplan_stage') {
+                TplanStage::update($data, $id);
+            }

-                                                                               // Обновляем оборудования
-                                                                               TplanStage::updateEquipments($id, $_POST['equipment']);
+            // Обновляем оборудования
+            TplanStage::updateEquipments($id, $_POST['equipment']);

-                                                                               header(""Location: ./?action=tplan_stage&id={$id}"");
-                                                                       }
-                                                                       break;
+            header(""Location: ./?action=tplan_stage&id={$id}"");
+        }
+        break;

-                                                                       // Технологические цепочки
-                                                                       case ""add_tplan_line"":
-                                                                       case ""update_tplan_line"":
-                                                                       include_once '../models/TplanLine.php';
-                                                                       include_once '../models/TplanLineTime.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               $data = [
-                                                                                       'name' => htmlspecialchars($_POST['name']),
-                                                                                       'active' => (!empty($_POST['active'])) ? 1 : 0,
-                                                                               ];
-                                                                               if ($_POST['action'] == 'add_tplan_line') {
-                                                                                       TplanLine::insert($data);
-                                                                                       $id = TplanLine::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_tplan_line') {
-                                                                                       TplanLine::update($data, $id);
-                                                                               }
+    // Технологические цепочки
+    case ""add_tplan_line"":
+    case ""update_tplan_line"":
+        include_once '../models/TplanLine.php';
+        include_once '../models/TplanLineTime.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            $data = [
+                'name' => htmlspecialchars($_POST['name']),
+                'active' => (!empty($_POST['active'])) ? 1 : 0,
+            ];
+            if ($_POST['action'] == 'add_tplan_line') {
+                TplanLine::insert($data);
+                $id = TplanLine::insertId();
+            }
+            if ($_POST['action'] == 'update_tplan_line') {
+                TplanLine::update($data, $id);
+            }

-                                                                               // Обновляем этапы
-                                                                               TplanLine::updateStages($id, $_POST);
+            // Обновляем этапы
+            TplanLine::updateStages($id, $_POST);

-                                                                               header(""Location: ./?action=tplan_line&id={$id}"");
-                                                                       }
-                                                                       break;
+            header(""Location: ./?action=tplan_line&id={$id}"");
+        }
+        break;

-                                                                       // Роли пользователей
-                                                                       case ""add_role"":
-                                                                       case ""update_role"":
-                                                                       include_once '../models/Role.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               seveLog(""role"");
-                                                                               $data = [
-                                                                                       'name' => htmlspecialchars($_POST['name']),
-                                                                               ];
+    // Роли пользователей
+    case ""add_role"":
+    case ""update_role"":
+        include_once '../models/Role.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            seveLog(""role"");
+            $data = [
+                'name' => htmlspecialchars($_POST['name']),
+            ];

-                                                                               if ($_POST['action'] == 'add_role') {
-                                                                                       Role::insert($data);
-                                                                                       $id = Role::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_role') {
-                                                                                       Role::update($data, $id);
-                                                                               }
+            if ($_POST['action'] == 'add_role') {
+                Role::insert($data);
+                $id = Role::insertId();
+            }
+            if ($_POST['action'] == 'update_role') {
+                Role::update($data, $id);
+            }

-                                                                               // Обновляем разрешенные действия
-                                                                               Role::updateActions($id, $_POST['actions']);
+            // Обновляем разрешенные действия
+            Role::updateActions($id, $_POST['actions']);

-                                                                               header(""Location: ./?action=role&id={$id}"");
-                                                                       }
-                                                                       break;
+            header(""Location: ./?action=role&id={$id}"");
+        }
+        break;

-                                                                       case ""add_tplan_order"":
-                                                                       case ""update_tplan_order"":
-                                                                       include_once '../models/TplanOrder.php';
-                                                                       include_once '../models/TplanOrderLine.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               $data = [
-                                                                                       'name' => htmlspecialchars($_POST['name']),
-                                                                                       'date_plan' => htmlspecialchars($_POST['date_plan']),
-                                                                                       'date_extra' => htmlspecialchars($_POST['date_extra']),
-                                                                               ];
-                                                                               if ($_POST['action'] == 'add_tplan_order') {
-                                                                                       TplanOrder::insert($data);
-                                                                                       $id = TplanOrder::insertId();
-                                                                               }
-                                                                               if ($_POST['action'] == 'update_tplan_order') {
-                                                                                       TplanOrder::update($data, $id);
-                                                                               }
+    case ""add_tplan_order"":
+    case ""update_tplan_order"":
+        include_once '../models/TplanOrder.php';
+        include_once '../models/TplanOrderLine.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            $data = [
+                'name' => htmlspecialchars($_POST['name']),
+                'date_plan' => htmlspecialchars($_POST['date_plan']),
+                'date_extra' => htmlspecialchars($_POST['date_extra']),
+            ];
+            if ($_POST['action'] == 'add_tplan_order') {
+                TplanOrder::insert($data);
+                $id = TplanOrder::insertId();
+            }
+            if ($_POST['action'] == 'update_tplan_order') {
+                TplanOrder::update($data, $id);
+            }

-                                                                               // Обновляем детали
-                                                                               TplanOrder::updateLines($id, $_POST['lines'], $_POST);
+            // Обновляем детали
+            TplanOrder::updateLines($id, $_POST['lines'], $_POST);

-                                                                               header(""Location: ./?action=tplan_order&id={$id}"");
-                                                                       }
-                                                                       break;
+            header(""Location: ./?action=tplan_order&id={$id}"");
+        }
+        break;

-                                                                       // Перемещение деталей
-                                                                       case ""update_tplan_matrix"":
-                                                                       include_once '../models/TplanMatrix.php';
-                                                                       $id = isset($_POST['id']) ? intval($_POST['id']) : '';
-                                                                       if (checkskey($id)) {
-                                                                               TplanMatrix::save($id, $_POST['equipments']);
-                                                                               header(""Location: ./?action=tplan_matrix_input&id={$id}"");
-                                                                       }
-                                                                       break;
+    // Перемещение деталей
+    case ""update_tplan_matrix"":
+        include_once '../models/TplanMatrix.php';
+        $id = isset($_POST['id']) ? intval($_POST['id']) : '';
+        if (checkskey($id)) {
+            TplanMatrix::save($id, $_POST['equipments']);
+            header(""Location: ./?action=tplan_matrix_input&id={$id}"");
+        }
+        break;

-                                                                       // Сохранение времени перемещения детали
-                                                                       case ""update_tplan_matrix_time"":
-                                                                       include_once '../models/TplanMatrix.php';
-                                                                       if (checkskey()) {
-                                                                               TplanMatrix::updateTime($_POST);
-                                                                               echo json_encode(['value'=>$_POST['value']]);
-                                                                       }
-                                                                       break;
+    // Сохранение времени перемещения детали
+    case ""update_tplan_matrix_time"":
+        include_once '../models/TplanMatrix.php';
+        if (checkskey()) {
+            TplanMatrix::updateTime($_POST);
+            echo json_encode(['value' => $_POST['value']]);
+        }
+        break;

-                                                                       // Сохранение отрезка сетки плана
-                                                                       case ""update_tplan"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               $noSave = $_POST['no_save'] ?? null;
-                                                                               $error = 0; // по умолчанию - нет ошибок
-                                                                               // Данные отрезка до перемещения
-                                                                               $barData = Tplan::getBarData(
-                                                                                       intval($_POST['order_line_id']),
-                                                                                       intval($_POST['stage_id']),
-                                                                                       htmlspecialchars($_POST['grid_date_start'])
-                                                                               );
-                                                                               // Если нужно сохранять
-                                                                               if (!$noSave) {
-                                                                                       // Если без ошибок, в barData возвращаем новые данные отрезка
-                                                                                       if (!$error = Tplan::save($_POST)) {
-                                                                                               $barData = Tplan::getBarData(
-                                                                                                       intval($_POST['order_line_id']),
-                                                                                                       intval($_POST['stage_id']),
-                                                                                                       htmlspecialchars($_POST['grid_date_start'])
-                                                                                               );
-                                                                                       }
-                                                                               }
-                                                                               echo json_encode([
-                                                                                       'error' => $error,
-                                                                                       'bar' => $barData,
-                                                                               ]);
-                                                                       }
-                                                                       break;
+    // Сохранение отрезка сетки плана
+    case ""update_tplan"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            $noSave = $_POST['no_save'] ?? null;
+            $error = 0; // по умолчанию - нет ошибок
+            // Данные отрезка до перемещения
+            $barData = Tplan::getBarData(
+                intval($_POST['order_line_id']),
+                intval($_POST['stage_id']),
+                htmlspecialchars($_POST['grid_date_start'])
+            );
+            // Если нужно сохранять
+            if (!$noSave) {
+                // Если без ошибок, в barData возвращаем новые данные отрезка
+                if (!$error = Tplan::save($_POST)) {
+                    $barData = Tplan::getBarData(
+                        intval($_POST['order_line_id']),
+                        intval($_POST['stage_id']),
+                        htmlspecialchars($_POST['grid_date_start'])
+                    );
+                }
+            }
+            echo json_encode([
+                'error' => $error,
+                'bar' => $barData,
+            ]);
+        }
+        break;

-                                                                       // Удаление отрезков сетки плана указанной детали и заказа
-                                                                       case ""delete_tplan"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               Tplan::deleteOrderLine(intval($_POST['order_line_id']), $_POST['with_order_line']??false);
-                                                                               echo json_encode(['ok'=>1]);
-                                                                       }
-                                                                       break;
+    // Удаление отрезков сетки плана указанной детали и заказа
+    case ""delete_tplan"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            Tplan::deleteOrderLine(intval($_POST['order_line_id']), $_POST['with_order_line'] ?? false);
+            echo json_encode(['ok' => 1]);
+        }
+        break;

-                                                                       // Удаление одного отрезка сетки плана указанной детали и заказа
-                                                                       case ""delete_one_bar"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               Tplan::delete(intval($_POST['order_line_id']), intval($_POST['stage_id']) );
-                                                                               echo json_encode(['ok'=>1]);
-                                                                       }
-                                                                       break;
+    // Удаление одного отрезка сетки плана указанной детали и заказа
+    case ""delete_one_bar"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            Tplan::delete(intval($_POST['order_line_id']), intval($_POST['stage_id']));
+            echo json_encode(['ok' => 1]);
+        }
+        break;

-                                                                       // Добавление на сетку отрезков в первые попавшиеся позиции
-                                                                       case ""insert_tplan"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               $result = Tplan::insertBarsGrid($_POST['date_start'], intval($_POST['order_line_id']));
-                                                                               echo json_encode(['ok' => $result]);
-                                                                       }
-                                                                       break;
+    // Добавление на сетку отрезков в первые попавшиеся позиции
+    case ""insert_tplan"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            $result = Tplan::insertBarsGrid($_POST['date_start'], intval($_POST['order_line_id']));
+            echo json_encode(['ok' => $result]);
+        }
+        break;

-                                                                       // Освобождаем время
-                                                                       case ""empty_time"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               $result = Tplan::emptyTime($_POST['date_start'], $_POST['date_end']);
-                                                                               echo json_encode(['ok' => $result]);
-                                                                       }
-                                                                       break;
+    // Освобождаем время
+    case ""empty_time"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            $result = Tplan::emptyTime($_POST['date_start'], $_POST['date_end']);
+            echo json_encode(['ok' => $result]);
+        }
+        break;

-                                                                       // Чистим сетку
-                                                                       case ""clear_matrix"":
-                                                                       include_once '../models/Tplan.php';
-                                                                       if (checkskey()) {
-                                                                               $result = Tplan::clearMatrix($_POST['from']);
-                                                                               echo json_encode(['ok' => $result]);
-                                                                       }
-                                                                       break;
-                                                               }
+    // Чистим сетку
+    case ""clear_matrix"":
+        include_once '../models/Tplan.php';
+        if (checkskey()) {
+            $result = Tplan::clearMatrix($_POST['from']);
+            echo json_encode(['ok' => $result]);
+        }
+        break;
+}
"
AnFTFu3f,🤑 G2A.com Free Gift Card Guide Apr 2024 FIX 🤑,jusst2k4,GetText,Monday 1st of April 2024 12:13:00 PM CDT,"G2A.com free gift card & games updated guide.
Any item for free on G2A.com including Amazon, Steam, Xbox, Playstation gift cards & everything else offered.

This is the most up to date version of this script. Any other one posted will not work!
 
PDF guide here:
https://drive.google.com/file/d/1thJ3r_goEZ3BA-wE8sNYbGUhGv6gTnXz/view?usp=g2a_refund_exploit_470940.pdf

Working as of:
01 April 2024"
ERR7wdid,🤑 G2A.com Free Gift Card Guide Apr 2024 FIX 🤑,ssss50w,GetText,Monday 1st of April 2024 12:02:16 PM CDT,"G2A.com free gift card & games updated guide.
Any item for free on G2A.com including Amazon, Steam, Xbox, Playstation gift cards & everything else offered.
 
If you use this make sure to use the English version of G2A.com otherwise this will not work!
 
PDF guide here:
https://drive.google.com/file/d/1KMb0fLkKHIC2qdjR4vCSRH9rVSjJVMdX/view?usp=sharing
 
Working as of:
01 April 2024

















































"
SiR4gbJE,ClientConnectorError: Cannot connect to host lemmy.basedcount.com:443 ssl:default [None],basedcount_bot,Python,Monday 1st of April 2024 11:55:21 AM CDT,"Traceback (most recent call last):
  File ""/root/Bots/basedcount_bot_lemmy/.venv/lib/python3.11/site-packages/aiohttp/connector.py"", line 992, in _wrap_create_connection
    return await self._loop.create_connection(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/root/.pyenv/versions/3.11.7/lib/python3.11/asyncio/base_events.py"", line 1112, in create_connection
    transport, protocol = await self._create_connection_transport(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/root/.pyenv/versions/3.11.7/lib/python3.11/asyncio/base_events.py"", line 1145, in _create_connection_transport
    await waiter
ConnectionAbortedError: SSL handshake is taking longer than 60.0 seconds: aborting the connection

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/root/Bots/basedcount_bot_lemmy/basedcount_bot.py"", line 46, in wrapper
    await func(lemmy_instance, databased)
  File ""/root/Bots/basedcount_bot_lemmy/basedcount_bot.py"", line 228, in read_comments
    async for comment in lemmy_instance.stream_comments(skip_existing=True):  # Comment
  File ""/root/Bots/basedcount_bot_lemmy/async_lemmy_py/async_lemmy.py"", line 64, in stream_comments
    comments = await self.request_builder.get(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/root/Bots/basedcount_bot_lemmy/async_lemmy_py/request_builder.py"", line 57, in get
    async with self.client_session.get(url, headers=headers, params=params) as resp:
  File ""/root/Bots/basedcount_bot_lemmy/.venv/lib/python3.11/site-packages/aiohttp/client.py"", line 1194, in __aenter__
    self._resp = await self._coro
                 ^^^^^^^^^^^^^^^^
  File ""/root/Bots/basedcount_bot_lemmy/.venv/lib/python3.11/site-packages/aiohttp/client.py"", line 578, in _request
    conn = await self._connector.connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/root/Bots/basedcount_bot_lemmy/.venv/lib/python3.11/site-packages/aiohttp/connector.py"", line 544, in connect
    proto = await self._create_connection(req, traces, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/root/Bots/basedcount_bot_lemmy/.venv/lib/python3.11/site-packages/aiohttp/connector.py"", line 911, in _create_connection
    _, proto = await self._create_direct_connection(req, traces, timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/root/Bots/basedcount_bot_lemmy/.venv/lib/python3.11/site-packages/aiohttp/connector.py"", line 1235, in _create_direct_connection
    raise last_exc
  File ""/root/Bots/basedcount_bot_lemmy/.venv/lib/python3.11/site-packages/aiohttp/connector.py"", line 1204, in _create_direct_connection
    transp, proto = await self._wrap_create_connection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/root/Bots/basedcount_bot_lemmy/.venv/lib/python3.11/site-packages/aiohttp/connector.py"", line 1000, in _wrap_create_connection
    raise client_error(req.connection_key, exc) from exc
aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host lemmy.basedcount.com:443 ssl:default [None]
"
xD2nPqcv,AutoKey Dice Roll Script,najjah,Python,Monday 1st of April 2024 11:47:07 AM CDT,"# Enter script code

retCode, dice_formula = dialog.input_dialog(title='Dice Roller', message='Digite a fórmula')

if retCode > 0:
    dialog.info_dialog(title='Unknown Error!', message=f""Rolagem cancelada. Ret code {retcode}, mensagem {dice_formula}."")
    exit()

dice_formula = dice_formula.lower().replace(' ', '')

TITLE_FORMULA_ERROR = 'Dice Formula Error!'
FORMULA_EXAMPLE = '2d10+5'

index_of_d = dice_formula.find('d')
if index_of_d < 0:
    dialog.info_dialog(title=TITLE_FORMULA_ERROR, message=f""Fórmula inválida. A fórmula deve ser similar a este exemplo: {FORMULA_EXAMPLE}"")
    exit()

number_of_dice = dice_formula[:index_of_d]
try:
    number_of_dice = int(number_of_dice)
except ValueError:
    dialog.info_dialog(title=TITLE_FORMULA_ERROR, message=f""Fórmula inválida. Antes da letra 'd' deve ser inserido um número. Você inseriu {number_of_dice}."")
    exit()

import re
match_of_modifier = re.search(r""[+-]"", dice_formula)
if match_of_modifier:
    index_of_modifier = match_of_modifier.start()
    modifier = match_of_modifier.group(0)
    modifier_amount = dice_formula[index_of_modifier +1 :]
    try:
        modifier_amount = int(modifier_amount)
    except ValueError:
        dialog.info_dialog(title=TITLE_FORMULA_ERROR, message=f""Fórmula inválida. O modificador deve ser um número. Você inseriu {modifier_amount}."")
        exit()
    if modifier == '-':
        modifier_amount = -modifier_amount
    number_of_sides = dice_formula[index_of_d +1 : index_of_modifier]
else:
    modifier_amount = 0
    number_of_sides = dice_formula[index_of_d +1 :]

try:
    number_of_sides = int(number_of_sides)
except ValueError:
    dialog.info_dialog(title=TITLE_FORMULA_ERROR, message=f""Fórmula inválida. Depois da letra 'd' deve ser inserido um número. Você inseriu {number_of_sides}."")
    exit()

all_rolls = []
import random
for roll in range(number_of_dice):
    all_rolls.append(random.randint(1, number_of_sides))

individual_rolls = '[' + ', '.join(list(map(str, all_rolls))) + ']'
total_roll = sum(all_rolls) + modifier_amount
dialog.info_dialog(title=f""Resultado:"", message=f""Total: {total_roll}\r\n{individual_rolls}\r\nFórmula: {dice_formula}"")
"
GG94VhxF,RS Minimap capture tool,WarPie90,Delphi,Monday 1st of April 2024 11:45:45 AM CDT,"program MinimapCapture;
(*
  Simple program to capture the minimap at 400x400 from the memory of RS.
  Requires: https://github.com/slackydev/Simba-MemScan/releases/tag/1.1

  Download the plugin (dll) named `memscan32`, add it to your ""Plugins"" folder in Simba

  Start RS, target RS, start the script
*)
{$loadlib memscan32.dll}

type
  PInt32 = ^Int32;

var
  mem: TMemScan;

const
  _512: array of Int64 = [0,0,0,0,0,0,0,0];

function BytesToTIA(data:TByteArray): TIntegerArray;
begin
  SetLength(result, length(data) div 4);
  MemMove(data[0], result[0], Length(data));
end;

function ValidMapAddr(address:PtrUInt): Boolean;
var
  data:Int32;
  tmp: TByteArray;
begin
  data := PInt32(mem.CopyMem(address+8,4))^;
  if (data = 512 * 512) then
  begin
    tmp := mem.CopyMem(address+12, 64);
    Result := CompareMem(_512[0], tmp[0], 64); //row of black
  end;
end;

function GetMemBufferImage(scan:TMemScan; loc:PtrUInt; W,H:Int32): TMufasaBitmap;
var
  data:TByteArray;
  ptr: PRGB32;
begin
  data := scan.CopyMem(loc, W*H*SizeOf(TRGB32));
  Result.Init();
  Result.SetSize(W,H);
  ptr := Result.getData();
  MemMove(data[0], ptr^, Length(data));
end;

var
  res: TPtrIntArray;
  ptr: PtrUInt;
  raw: TByteArray;
  i,c: Int32;
  ints: TIntegerArray;
  image: TMufasaBitmap;
begin
  mem.Init(GetTargetPID());

  while True do
  begin
    res := mem.FindInt32(512, 4);

    image := nil;
    for ptr in res do
    begin
      c   := 0;
      raw := mem.CopyMem(ptr, 48);

      for i:=0 to 44 with 4 do
        if PInt32(raw+i)^ = 512 then Inc(c);

      if c >= 4 then
      begin
        ints := BytesToTIA(raw);
        for i in ints do
          if (i > $FFF) and ValidMapAddr(i) then begin
            image := GetMemBufferImage(mem, i+12, 512, 512);
            break;
          end;
      end;
    end;

    if image <> nil then
      ShowBitmap(image)
    else
      WriteLn('Process access error');

    image.Free();
  end;
end."
39M9dgaZ,url2,beigeworm,PHP,Monday 1st of April 2024 11:26:42 AM CDT,cTTuNajLrEytBv3tt5hYkQlNrZ4LiRKHtMyxCs
FqWdbKWm,url1,beigeworm,PHP,Monday 1st of April 2024 11:26:26 AM CDT,MTIxNTQwNzExNDEwOTk3NjY4Nw
aGqU7fxb,Generating compressor test data,Omnifarious,Python,Monday 1st of April 2024 11:18:12 AM CDT,"import itertools, random
pl = [''.join(p) for p in itertools.permutations([chr(65 + x) for x in range(11)])]
sections = set()
while len(sections) < 3500:
    sections.add(random.randint(0, 480924 * 83))
sectstrs = ['\n'.join(pl[x:x+83]) for x in sections]
with open('permutes.txt', 'w') as pf:
    for _ in range(19):
        random.shuffle(sectstrs)
        pf.write('\n'.join(sectstrs) + '\n')"
HBBLVB8t,Untitled,CalinBedea,C#,Monday 1st of April 2024 10:38:20 AM CDT,"using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Data.SqlClient;
using System.IO;
namespace _2019Rezolvare
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public static int count;
        public static string constr = @""Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\FreeBook.mdf;Integrated Security=True"";
        private void stergere()
        {
            SqlConnection con = new SqlConnection(constr);
            con.Open();
            SqlCommand cmd = new SqlCommand(@""Delete from imprumut"",con);
            cmd.ExecuteNonQuery();
            cmd.Dispose();
            cmd = new SqlCommand(@""Delete from utilizatori"", con);
            cmd.ExecuteNonQuery();
            cmd.Dispose();
            cmd = new SqlCommand(@""Delete from carti"", con);
            cmd.ExecuteNonQuery();
            cmd.Dispose();
        }
        public void initializare()
        {
            SqlConnection con = new SqlConnection(constr);
            string sir;
            char[] split = { '*' };
            StreamReader carti = new StreamReader(Application.StartupPath + ""/carti.txt"");
            StreamReader imprumuturi = new StreamReader(Application.StartupPath + ""/imprumuturi.txt"");
            StreamReader utilizatori = new StreamReader(Application.StartupPath + ""/utilizatori.txt"");
            DateTime dt = new DateTime();
            string data;
            while((sir = carti.ReadLine()) != null)
             {
                string[] siruri = sir.Split(split);
                con.Open();
                SqlCommand cmd = new SqlCommand(@""INSERT INTO carti(titlu,autor,gen) values(@1,@2,@3)"", con);
                cmd.Parameters.AddWithValue(""1"", siruri[0].Trim());
                cmd.Parameters.AddWithValue(""2"", siruri[1].Trim());
                cmd.Parameters.AddWithValue(""3"", siruri[2].Trim());
                cmd.ExecuteNonQuery();
                cmd.Dispose();
                con.Close();

            }
            while((sir= utilizatori.ReadLine()) !=null)
            {
                string[] siruri = sir.Split(split);
                con.Open();
                SqlCommand cmd = new SqlCommand(@""INSERT INTO utilizatori(email,parola,nume,prenume) values(@1,@2,@3,@4)"", con);
                cmd.Parameters.AddWithValue(""1"", siruri[0].Trim());
                cmd.Parameters.AddWithValue(""2"", siruri[1].Trim());
                cmd.Parameters.AddWithValue(""3"", siruri[2].Trim());
                cmd.Parameters.AddWithValue(""4"", siruri[3].Trim());
                cmd.ExecuteNonQuery();
                cmd.Dispose();
                con.Close();
            }
            while ((sir = imprumuturi.ReadLine()) != null)
            {
                string[] siruri = sir.Split(split);
                data = siruri[2].Trim();
                dt = DateTime.Parse(data.Trim(), System.Globalization.CultureInfo.InvariantCulture);
                con.Open();

                SqlDataAdapter sda = new SqlDataAdapter(@""Select id_carte from carti where titlu ='"" + siruri[0].Trim() + ""'"", con);
                DataTable d = new DataTable();
                sda.Fill(d);
                DataRow dr = d.Rows[0];
                SqlCommand cmd = new SqlCommand(@""INSERT INTO imprumut(id_carte,email,data_imprumut) values (@1,@2,@3)"", con);
                cmd.Parameters.AddWithValue(""1"", int.Parse(dr[""id_carte""].ToString()));
                cmd.Parameters.AddWithValue(""2"", siruri[1].Trim());
                cmd.Parameters.AddWithValue(""3"", dt);
                cmd.ExecuteNonQuery();
                cmd.Dispose();
                con.Close();
                
            }
        }
        
        private void Form1_Load(object sender, EventArgs e)
        {
            if (count == 0)
            {
                stergere();
                initializare();
            }
            pictureBox1.Image = Image.FromFile(""sila_Biblioteca.jpg"");
            richTextBox1.ReadOnly = true;
            richTextBox1.AppendText(""Free book este o platforma care faciliteaza imprumutul de carti"");
            richTextBox1.AppendText(Environment.NewLine);
            richTextBox1.AppendText(Environment.NewLine);
            richTextBox1.AppendText(""Fiecare utilizator are la dispozitie un numar de 3 carti pe care le poate imprumuta"");
            richTextBox1.AppendText(Environment.NewLine);
            richTextBox1.AppendText(Environment.NewLine);
            richTextBox1.AppendText(""Fiecare carte poate fi cititia in decursul a 30 de zile"");
            
        }
        
        private void button2_Click(object sender, EventArgs e)
        {
            count++;
            this.Hide();
            Form2 f = new Form2();
            f.Show();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            count++;
            this.Hide();
            Form3 f = new Form3();
            f.Show();
        }
    }
}
"
usutiDgm,Blossom No.1 | ห้องส่วนตัว,Kelly-B9978,HTML,Monday 1st of April 2024 10:00:35 AM CDT,"<!--คู่มือการใช้งาน
สีพื้นหลัง/สีตัวอักษร tag ชื่อบ้าน (มุมซ้ายบนของรูป)/สีตัวอักษร tab ที่คลิกแล้ว : --bls-bg: #594e36;
สีตัวอักษรหลัก/สีพื้นหลัง tag ชื่อบ้าน (มุมซ้ายบนของรูป) : --bls-txtcolor: #fbf5f3;
สีขอบ/สีพื้นหลัง tab ที่คลิกแล้ว : --bls-bdcolor: #fbf5f3;
สีรอง : --bls-subtxtcolor: #b29459;
แสดง tag (มุมซ้ายบนของรูป) : --bls-show: block; ถ้ายังไม่มีรูปโลโก้ให้ใส่ --bls-show: none;
รูปโลโก้บ้าน : --bls-logo: transparent; ถ้าต้องการใส่รูปให้แก้ไขเป็น --bls-logo: url(--ลิงก์รูปภาพ);
ฟอนต์ภาษาไทย : --bls-fontth: 'Bai Jamjuree';
ฟอนต์ภาษาอังกฤษ : --bls-fonten: 'Dosis';
*ฟังก์ชัน Slideshow : --bls-animation: bls-slideshow3;
**รูปห้อง : --bls-room: transparent;
รูปเจ้าของห้อง : --bls-ownerpic: transparent; ถ้าต้องการใส่รูปให้แก้ไขเป็น --bls-ownerpic: url(--ลิงก์รูปภาพ);

*ฟังก์ชัน Slideshow จะโชว์รูปห้องในมุมต่าง ๆ ในค่าเริ่มต้นจะเป็นลูป 3 รูป
- ถ้ามี 4 รูป 
   - ให้ใส่เป็น --bls-animation: bls-slideshow4; 
   - เพิ่ม <div class=""blsimg""><img src=""--รูปที่ 4--""></div> ต่อจากรูปที่ 3
- ถ้ามี 3 รูป ไม่ต้องแก้ไขอะไร
- ถ้ามี 2 รูป 
   - ให้ใส่เป็น --bls-animation: bls-slideshow2; 
   - ลบ <div class=""blsimg""><img src=""--รูปที่ 3--""></div> ออก
- ถ้ามี 1 รูป 
   - ให้ลบ --bls-animation: bls-slideshow3; ทิ้ง 
   - ลบ <div class=""blspic-wrap"">
        <div class=""blsimg""><img src=""--รูปที่ 1--""></div>
        <div class=""blsimg""><img src=""--รูปที่ 2--""></div>
        <div class=""blsimg""><img src=""--รูปที่ 3--""></div>
        <div class=""blsimg""><img src=""--รูปที่ 1--""></div></div>
     ออกให้หมด

**รูปห้อง สำหรับโชว์รูปเดียว ให้แก้ไข --bls-room: transparent; เป็น --bls-room: url(--ลิงก์รูปภาพ);
-->

<link href=""https://dl.dropbox.com/scl/fi/1ajury4qrpunl9pdz347l/blossom1-private.css?rlkey=nslryzsd391w88dsor2lb5jco"" rel=""stylesheet"">
<div id=""zzzcode""><a href=""https://discord.com/users/625292873914515456/"" target=""_blank""></a><div class=""blspcontainer"" style=""--bls-bg: #594e36;--bls-txtcolor: #fbf5f3;--bls-bdcolor: #fbf5f3;--bls-subtxtcolor: #b29459;--bls-show: block;--bls-logo: transparent;--bls-fontth: 'Bai Jamjuree';--bls-fonten: 'Dosis';--bls-animation: bls-slideshow3;--bls-room: transparent;--bls-ownerpic: transparent;"">
<input class=""blsphide"" id=""blsroom"" name=""bls1"" type=""radio"" checked>
<input class=""blsphide"" id=""blsowner"" name=""bls1"" type=""radio"">
<input class=""blsphide"" id=""blsplan"" name=""bls1"" type=""radio"">
<div class=""blsplabels""><label id=""blsroom-tab"" for=""blsroom"">room</label>
<label id=""blsowner-tab"" for=""blsowner"">owner</label>
<label id=""blsplan-tab"" for=""blsplan"">plan</label></div>
<div class=""blspflex""><div class=""blspleft"">
<div class=""blspheader-res""><div class=""blsproomname"">XXX's Room</div>
<div class=""blsproomflex""><div class=""blspfloor"">02</div><div class=""blspowner"">--ชื่อเจ้าของห้อง--</div></div></div>
<div class=""blsppic""><div class=""blsppic-wrap"">
<div class=""blspimg""><img src=""--รูปที่ 1--""></div>
<div class=""blspimg""><img src=""--รูปที่ 2--""></div>
<div class=""blspimg""><img src=""--รูปที่ 3--""></div>
<div class=""blspimg""><img src=""--รูปที่ 1--""></div></div>
<div class=""blsptag""><div class=""blsplogo""></div><div class=""blsphouse""></div></div>
</div></div>
<div class=""blspright"">
<div class=""blspheader""><div class=""blsproomname"">XXX's Room</div>
<div class=""blsproomflex""><div class=""blspfloor"">02</div><div class=""blspowner"">--ชื่อเจ้าของห้อง--</div></div></div>
<div class=""blspdesc"">
<div class=""blspwarning"">--คำเตือนคำเตือนคำเตือน--</div>
<div id=""blsroom-content"">--คำบรรยายห้อง--</div>
<div id=""blsowner-content""><div class=""blspownpic""></div>
<div class=""blspowntxt""><div class=""blspownname"">--ชื่อเจ้าของห้อง--</div>
--คำอธิบายเพิ่มเติมเกี่ยวกับเจ้าของห้อง--
</div></div>
<div id=""blsplan-content"">[img]--รูปแปลนห้อง--[/img]</div></div>
</div></div></div></div>"
Cb1Eh1uU,AutomaticPlay.uc,AlisaCodeDragon,UnrealScript,Monday 1st of April 2024 09:52:20 AM CDT,"Class AutomaticPlay  Extends UICommonAPI
	dependson(YetiQuickSlotWnd)
	dependson(YetiQuickSlotWnd);
var WindowHandle AutoTargetWnd;
var TextBoxHandle AutoTargetTitle_text;
var AnimTextureHandle AutoTargetAllON_ToggleEffect_Anim;
var AnimTextureHandle AutoTargetAllON_ToggleEffect_Anim2;
var ButtonHandle WinMinBTN;
var TextureHandle AutoCircleFrameExpand;
var TextureHandle LineBG;
var ButtonHandle TargetNext_BTN;
var ButtonHandle TargetSwap_BTN;
var ButtonHandle TargetPickupToggle_BTN;
var ButtonHandle TargetMannerToggle_BTN;
var ButtonHandle Combat_BTN;
var WindowHandle AutoTargetAllON_Win;
var WindowHandle AutoTargetAllOFF_Win;
var ButtonHandle AutoTargetAll_BTN;
var bool autotarget_bShortTarget;
var bool autotarget_bUseAutoTarget;
var bool autotarget_bIsPickupOn;
var NWindow.UIEventManager.EAutoNextTargetMode autotarget_nTargetMode;
var int autotarget_nHPPotionPercent;
var bool autotarget_bIsMannerModeOn;
var bool bActivateAll;
var int nCombatOnOff;
var int autotarget_nHPPetPotionPercent;
var YetiQuickSlotWnd YetiQuickSlotwndScript;
var Rect rectWndLDowned;
function OnRegisterEvent()
{
	RegisterEvent(9750);
	RegisterEvent(40);
	RegisterEvent(11170);
	RegisterEvent(11030);
	RegisterEvent(5720);
	RegisterEvent(11152);
	RegisterEvent(11280);
	RegisterEvent(11620);
	return;
}
function OnLoad()
{
	Initialize();
	return;
}
function Initialize()
{
	AutoTargetWnd = GetWindowHandle(""AutomaticPlay.AutoTargetWnd"");
	AutoTargetTitle_text = GetTextBoxHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetTitle_text"");
	AutoTargetAllON_ToggleEffect_Anim = GetAnimTextureHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllON_Win.ToggleEffect_Anim"");
	AutoTargetAllON_ToggleEffect_Anim2 = GetAnimTextureHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllON_Win.AutoAllArrowOn_texture"");
	AutoTargetAllON_Win = GetWindowHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllON_Win"");
	WinMinBTN = GetButtonHandle(""AutomaticPlay.WinMinBTN"");
	LineBG = GetTextureHandle(""AutomaticPlay.LineBgTex"");
	AutoCircleFrameExpand = GetTextureHandle(""AutomaticPlay.AutoTargetWnd.AutoCircleFrameExpand"");
	TargetNext_BTN = GetButtonHandle(""AutomaticPlay.AutoTargetWnd.TargetNext_BTN"");
	TargetSwap_BTN = GetButtonHandle(""AutomaticPlay.AutoTargetWnd.TargetSwap_BTN"");
	TargetPickupToggle_BTN = GetButtonHandle(""AutomaticPlay.AutoTargetWnd.TargetPickupToggle_BTN"");
	TargetMannerToggle_BTN = GetButtonHandle(""AutomaticPlay.AutoTargetWnd.TargetMannerToggle_BTN"");
	AutoTargetAllOFF_Win = GetWindowHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllOFF_Win"");
	AutoTargetAll_BTN = GetButtonHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAll_BTN"");
	Combat_BTN = GetButtonHandle(""AutomaticPlay.AutoTargetWnd.Combat_BTN"");
	setCombatTooltip();
	Autotarget_updateCombatButton();
	YetiQuickSlotwndScript = YetiQuickSlotWnd(GetScript(""YetiQuickSlotwnd""));
	WinMinBTN.SetButtonValue(0);
	return;
}
function OnShow()
{
	if(getInstanceUIData().getIsLiveServer())
	{
		m_hOwnerWnd.HideWindow();
		return;
	}
	OptionIniLoad();
	updateElements();
	return;
}
function updateElements()
{
	Autotarget_UpdateAutoTargetState();
	Autotarget_updateSwapTargetButton();
	Autotarget_SwapTargetSetCusomTooltip();
	Autotarget_updatePickupButton();
	Autotarget_PickupSetCusomTooltip();
	Autotarget_updateMannerModeButton();
	Autotarget_MannerModeSetCusomTooltip();
	Autotarget_updateNextTargetButton();
	Autotarget_NextTargetSetCusomTooltip();
	return;
}
function OnEvent(int Event_ID, string param)
{
	if(getInstanceUIData().getIsLiveServer())
	{
		return;
	}
	switch(Event_ID)
	{
		case 9750:
			initAll();
			break;
		case 40:
			bActivateAll = False;
			nCombatOnOff = 0;
			setCombatTooltip();
			Autotarget_updateCombatButton();
			Autotarget_Init();
			break;
		case 11170:
			AutoplaySettingHandler(param);
			break;
		case 11030:
		case 5720:
			NextTargetModeHandler();
			break;
		case 11152:
			if(autotarget_bUseAutoTarget)
			{
				requestAutoPlay(False);
			}
			break;
		case 11280:
			ParseInt(param, ""OnOff"", nCombatOnOff);
			setCombatTooltip();
			Autotarget_updateCombatButton();
			break;
		case 11620:
			HandleUpdatePlayerAutoAttacking();
			break;
		default:
			break;
	}
	return;
}
function setCombatTooltip()
{
	local array<DrawItemInfo> drawListArr;
	if(nCombatOnOff > 0)
	{
		drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(13263), getInstanceL2Util().PKNameColor, """", True, True);
		drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(13264), getInstanceL2Util().White, """", True, True);
	}
	else
	{
		drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(13263), getInstanceL2Util().White, """", True, True);
		drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(13264), getInstanceL2Util().PKNameColor, """", True, True);
	}
	Combat_BTN.SetTooltipCustomType(MakeTooltipMultiTextByArray(drawListArr));
	return;
}
function initAll()
{
	m_hOwnerWnd.ShowWindow();
	bActivateAll = False;
	YetiQuickSlotwndScript.setPlayAutoTargetActiveAnim();
	return;
}
function NextTargetModeHandler()
{
	local NWindow.UIEventManager.EAutoNextTargetMode nTargetMode;
	nTargetMode = GetNextTargetModeOption();
	if(int(autotarget_nTargetMode) != int(nTargetMode))
	{
		if(autotarget_bUseAutoTarget)
		{
			requestAutoPlay(autotarget_bUseAutoTarget);
		}
	}
	Autotarget_NextTargetSetCusomTooltip();
	return;
}
function AutoplaySettingHandler(string param)
{
	local int nIsAutoPlayOn, nNextTargetMode, nIsNearTargetMode, nIsPickupOn, nHPPotionPercent, nIsMannerModeOn,
		nHPPetPotionPercent;
	ParseInt(param, ""IsPickupOn"", nIsPickupOn);
	ParseInt(param, ""IsAutoPlayOn"", nIsAutoPlayOn);
	ParseInt(param, ""NextTargetMode"", nNextTargetMode);
	ParseInt(param, ""IsNearTargetMode"", nIsNearTargetMode);
	ParseInt(param, ""HPPotionPercent"", nHPPotionPercent);
	ParseInt(param, ""HPPetPotionPercent"", nHPPetPotionPercent);
	ParseInt(param, ""IsMannerModeOn"", nIsMannerModeOn);
	autotarget_bUseAutoTarget = numToBool(nIsAutoPlayOn);
	autotarget_bShortTarget = numToBool(nIsNearTargetMode);
	autotarget_bIsPickupOn = numToBool(nIsPickupOn);
	autotarget_bIsMannerModeOn = numToBool(nIsMannerModeOn);
	autotarget_nHPPotionPercent = nHPPotionPercent;
	autotarget_nHPPetPotionPercent = nHPPetPotionPercent;
	updateElements();
	return;
}
function bool getActivateAll()
{
	return bActivateAll;
}
function OnClickButton(string Name)
{
	if(CheckDrag())
	{
		return;
	}
	switch(Name)
	{
		case ""WinMinBTN"":
			WinMinMax();
			break;
		case ""AutoAll_BTN"":
			Class'ShortcutWndAPI'.static.RequestAutomaticUseItemActivateAll(!bActivateAll);
			break;
		case ""TargetSwap_BTN"":
			Autotarget_OnSwap_Target_BTNClick();
			requestAutoPlay(autotarget_bUseAutoTarget);
			break;
		case ""TargetPickupToggle_BTN"":
			Autotarget_TargetPickupToggle_BTNClick();
			requestAutoPlay(autotarget_bUseAutoTarget);
			break;
		case ""TargetMannerToggle_BTN"":
			Autotarget_TargetMannerToggle_BTNClick();
			requestAutoPlay(autotarget_bUseAutoTarget);
			break;
		case ""AutoTargetAll_BTN"":
			requestAutoPlay(!autotarget_bUseAutoTarget);
			break;
		case ""Combat_BTN"":
			ExecuteCommand(""/combatmode"");
			break;
		case ""TargetNext_BTN"":
			Autotarget_OnNext_Target_BTNClick();
			break;
		default:
			break;
	}
	return;
}
function OnRButtonDown(WindowHandle a_WindowHandle, int X, int Y)
{
	if(""AutoAll_BTN"" == a_WindowHandle.GetWindowName())
	{
		OnClickButton(a_WindowHandle.GetWindowName());
	}
	return;
}
function bool CheckDrag()
{
	local Rect rectWnd;
	rectWnd = m_hOwnerWnd.GetRect();
	return ((GetAbs(rectWndLDowned.nX - rectWnd.nX)) > 5) || (GetAbs(rectWndLDowned.nY - rectWnd.nY)) > 5;
}
event OnLButtonDown(WindowHandle a_WindowHandle, int X, int Y)
{
	rectWndLDowned = m_hOwnerWnd.GetRect();
	return;
}
function OptionIniLoad()
{
	local int nLongTarget, nIsPickupOn, nIsMannerModeOn, nMinimize;
	if(!GetINIBool(""AutomaticPlay"", ""e"", nIsPickupOn, ""windowsInfo.ini""))
	{
		nIsPickupOn = 1;
		SetINIBool(""AutomaticPlay"", ""e"", numToBool(nIsPickupOn), ""windowsInfo.ini"");
	}
	if(!GetINIBool(""AutomaticPlay"", ""a"", nLongTarget, ""windowsInfo.ini""))
	{
		nLongTarget = 1;
		SetINIBool(""AutomaticPlay"", ""a"", numToBool(nLongTarget), ""windowsInfo.ini"");
	}
	if(!GetINIBool(""AutomaticPlay"", ""p"", nIsMannerModeOn, ""windowsInfo.ini""))
	{
		nIsMannerModeOn = 1;
		SetINIBool(""AutomaticPlay"", ""p"", numToBool(nIsMannerModeOn), ""windowsInfo.ini"");
	}
	GetINIBool(""AutomaticPlay"", ""v"", nMinimize, ""windowsInfo.ini"");
	if(nMinimize == 1)
	{
		SetMin();
	}
	else
	{
		SetMax();
	}
	autotarget_bIsPickupOn = numToBool(nIsPickupOn);
	autotarget_bShortTarget = !numToBool(nLongTarget);
	autotarget_bIsMannerModeOn = numToBool(nIsMannerModeOn);
	return;
}
function Autotarget_Init()
{
	autotarget_bUseAutoTarget = False;
	return;
}
function executeTarget()
{
	if(autotarget_bShortTarget)
	{
		ExecuteCommand(""/targetnext"");
	}
	else
	{
		ExecuteCommand(""/targetnext2"");
	}
	return;
}
function setShortcutTooltip(string tooltipStr)
{
	AutoTargetAll_BTN.SetTooltipCustomType(MakeTooltipMultiText(GetSystemString(2165), getInstanceL2Util().White,, True, tooltipStr, getInstanceL2Util().BWhite,, True));
	return;
}
function Autotarget_SwapTargetSetCusomTooltip()
{
	local Color b0, b1;
	local array<DrawItemInfo> drawListArr;
	b0 = getInstanceL2Util().Gray;
	b1 = getInstanceL2Util().Gray;
	if(autotarget_bShortTarget)
	{
		b0 = getInstanceL2Util().Yellow;
	}
	else
	{
		b1 = getInstanceL2Util().Yellow;
	}
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(3956), b0, """", True, True);
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(3957), b1, """", True, True);
	TargetSwap_BTN.SetTooltipCustomType(MakeTooltipMultiTextByArray(drawListArr));
	return;
}
function Autotarget_PickupSetCusomTooltip()
{
	local Color b0, b1;
	local array<DrawItemInfo> drawListArr;
	b0 = getInstanceL2Util().Gray;
	b1 = getInstanceL2Util().Gray;
	TargetPickupToggle_BTN.ClearTooltip();
	TargetPickupToggle_BTN.SetTooltipType(""text"");
	if(autotarget_bIsPickupOn)
	{
		b0 = getInstanceL2Util().Yellow;
	}
	else
	{
		b1 = getInstanceL2Util().Yellow;
	}
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(3993), b0, """", True, True);
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(3992), b1, """", True, True);
	TargetPickupToggle_BTN.SetTooltipCustomType(MakeTooltipMultiTextByArray(drawListArr));
	return;
}
function Autotarget_MannerModeSetCusomTooltip()
{
	local Color b0, b1;
	local array<DrawItemInfo> drawListArr;
	b0 = getInstanceL2Util().Gray;
	b1 = getInstanceL2Util().Gray;
	TargetMannerToggle_BTN.ClearTooltip();
	TargetMannerToggle_BTN.SetTooltipType(""text"");
	if(autotarget_bIsMannerModeOn)
	{
		b0 = getInstanceL2Util().Yellow;
	}
	else
	{
		b1 = getInstanceL2Util().Yellow;
	}
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(13080), b0, """", True, True);
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(13081), b1, """", True, True);
	TargetMannerToggle_BTN.SetTooltipCustomType(MakeTooltipMultiTextByArray(drawListArr));
	return;
}
function Autotarget_NextTargetSetCusomTooltip()
{
	local int N;
	local Color b0, b1, b2, b3, b4;
	local array<DrawItemInfo> drawListArr;
	local string toolString;
	b0 = getInstanceL2Util().Gray;
	b1 = getInstanceL2Util().Gray;
	b2 = getInstanceL2Util().Gray;
	b3 = getInstanceL2Util().Gray;
	b4 = getInstanceL2Util().Gray;
	TargetNext_BTN.ClearTooltip();
	TargetNext_BTN.SetTooltipType(""text"");
	N = GetOptionInt(""Communication"", ""NextTargetModeClassic"");
	if(N == 0)
	{
		TargetNext_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.L2UI_NewTex.Automaticplay.TargetBTN_threat"", ""L2UI_NewTex.Automaticplay.TargetBTN_threat_Over"", ""L2UI_NewTex.Automaticplay.TargetBTN_threat_Down"");
		b0 = getInstanceL2Util().Yellow;
	}
	else
	{
		if(N == 1)
		{
			TargetNext_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.TargetBTN_Next_Normal"", ""L2UI_NewTex.AutomaticPlay.TargetBTN_Next_Over"", ""L2UI_NewTex.AutomaticPlay.TargetBTN_Next_Normal"");
			b2 = getInstanceL2Util().Yellow;
		}
		else
		{
			if(N == 2)
			{
				TargetNext_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.TargetBTN_pc"", ""L2UI_NewTex.Automaticplay.TargetBTN_pc_Over"", ""L2UI_NewTex.Automaticplay.TargetBTN_pc_Down"");
				b3 = getInstanceL2Util().Yellow;
			}
			else
			{
				if(N == 3)
				{
					TargetNext_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.TargetBTN_Next_Normal"", ""L2UI_NewTex.AutomaticPlay.TargetBTN_Next_Over"", ""L2UI_NewTex.AutomaticPlay.TargetBTN_Next_Normal"");
					b4 = getInstanceL2Util().Yellow;
				}
				else
				{
					if(N == 4)
					{
						TargetNext_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.L2UI_NewTex.Automaticplay.TargetBTN_threat"", ""L2UI_NewTex.Automaticplay.TargetBTN_threat_Over"", ""L2UI_NewTex.Automaticplay.TargetBTN_threat_Down"");
						b1 = getInstanceL2Util().Yellow;
					}
				}
			}
		}
	}
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(3862), b0, """", True, True);
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(13732), b1, """", True, True);
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(3863), b2, """", True, True);
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(3864), b3, """", True, True);
	drawListArr[drawListArr.Length] = addDrawItemText(GetSystemString(3865), b4, """", True, True);
	drawListArr[drawListArr.Length] = addDrawItemBlank(4);
	drawListArr[drawListArr.Length] = AddCrossLineForCustomToolTip(130);
	drawListArr[drawListArr.Length] = addDrawItemBlank(4);
	toolString = MenuEntireWnd(GetScript(""MenuEntireWnd"")).setMainShortcutString(MenuEntireWnd(GetScript(""MenuEntireWnd"")).getAssignedKeyGroup(), ""NextTargetModeChange"");
	drawListArr[drawListArr.Length] = addDrawItemText(toolString, getInstanceL2Util().White, """", True, True);
	TargetNext_BTN.SetTooltipCustomType(MakeTooltipMultiTextByArray(drawListArr));
	return;
}
function OnRButtonUp(WindowHandle a_WindowHandle, int X, int Y)
{
	switch(a_WindowHandle.GetWindowName())
	{
		case ""AutoTargetAll_BTN"":
		case ""MacroShortcutItem"":
			requestAutoPlay(!autotarget_bUseAutoTarget);
			break;
		default:
			break;
	}
	return;
}
function bool getUseAutoTarget()
{
	return autotarget_bUseAutoTarget;
}
function Autotarget_OnNext_Target_BTNClick()
{
	local string strParam;
	local int targetMode;
	strParam = """";
	switch(GetOptionInt(""CommunIcation"", ""NextTargetModeClassic""))
	{
		case 0:
			targetMode = 4;
			break;
		case 1:
			targetMode = 2;
			break;
		case 2:
			targetMode = 3;
			break;
		case 3:
			targetMode = 0;
			break;
		case 4:
			targetMode = 1;
			break;
		default:
			break;
	}
	SetOptionInt(""Communication"", ""NextTargetModeClassic"", targetMode);
	ParamAdd(strParam, ""NextTargetMode"", string(targetMode));
	ExecuteEvent(11030, strParam);
	Autotarget_NextTargetSetCusomTooltip();
	Autotarget_updateNextTargetButton();
	return;
}
function Autotarget_OnSwap_Target_BTNClick()
{
	autotarget_bShortTarget = !autotarget_bShortTarget;
	SetINIBool(""AutomaticPlay"", ""a"", !autotarget_bShortTarget, ""windowsInfo.ini"");
	if(autotarget_bShortTarget)
	{
		getInstanceL2Util().showGfxScreenMessage(GetSystemString(3956));
	}
	else
	{
		getInstanceL2Util().showGfxScreenMessage(GetSystemString(3957));
	}
	Autotarget_SwapTargetSetCusomTooltip();
	Autotarget_updateSwapTargetButton();
	return;
}
function Autotarget_TargetMannerToggle_BTNClick()
{
	autotarget_bIsMannerModeOn = !autotarget_bIsMannerModeOn;
	SetINIBool(""AutomaticPlay"", ""p"", autotarget_bIsMannerModeOn, ""windowsInfo.ini"");
	if(autotarget_bIsMannerModeOn)
	{
		getInstanceL2Util().showGfxScreenMessage(GetSystemString(13080));
	}
	else
	{
		getInstanceL2Util().showGfxScreenMessage(GetSystemString(13081));
	}
	Autotarget_updateMannerModeButton();
	Autotarget_MannerModeSetCusomTooltip();
	return;
}
function Autotarget_TargetPickupToggle_BTNClick()
{
	autotarget_bIsPickupOn = !autotarget_bIsPickupOn;
	SetINIBool(""AutomaticPlay"", ""e"", autotarget_bIsPickupOn, ""windowsInfo.ini"");
	if(autotarget_bIsPickupOn)
	{
		getInstanceL2Util().showGfxScreenMessage(GetSystemString(3993));
	}
	else
	{
		getInstanceL2Util().showGfxScreenMessage(GetSystemString(3992));
	}
	Autotarget_updatePickupButton();
	Autotarget_PickupSetCusomTooltip();
	return;
}
function Autotarget_updateSwapTargetButton()
{
	if(autotarget_bShortTarget)
	{
		TargetSwap_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.TargetBTN_ShotD_Normal"", ""L2UI_NewTex.AutomaticPlay.TargetBTN_ShotD_Normal"", ""L2UI_NewTex.AutomaticPlay.TargetBTN_ShotD_Over"");
	}
	else
	{
		TargetSwap_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.TargetBTN_LongD_Normal"", ""L2UI_NewTex.AutomaticPlay.TargetBTN_LongD_Normal"", ""L2UI_NewTex.AutomaticPlay.TargetBTN_LongD_Over"");
	}
	return;
}
function Autotarget_updateNextTargetButton()
{
	return;
}
function Autotarget_updatePickupButton()
{
	if(autotarget_bIsPickupOn)
	{
		TargetPickupToggle_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.GetBTNON_Normal"", ""L2UI_NewTex.AutomaticPlay.GetBTNON_Normal"", ""L2UI_NewTex.AutomaticPlay.GetBTNON_Over"");
	}
	else
	{
		TargetPickupToggle_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.GetBTNOff_Normal"", ""L2UI_NewTex.AutomaticPlay.GetBTNOff_Normal"", ""L2UI_NewTex.AutomaticPlay.GetBTNOff_Over"");
	}
	return;
}
function Autotarget_updateMannerModeButton()
{
	if(autotarget_bIsMannerModeOn)
	{
		TargetMannerToggle_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.MannerBTNON_Normal"", ""L2UI_NewTex.AutomaticPlay.MannerBTNON_Normal"", ""L2UI_NewTex.AutomaticPlay.MannerBTNON_over"");
	}
	else
	{
		TargetMannerToggle_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.MannerBTNOff_Normal"", ""L2UI_NewTex.AutomaticPlay.MannerBTNOff_Normal"", ""L2UI_NewTex.AutomaticPlay.MannerBTNOff_over"");
	}
	return;
}
function Autotarget_updateCombatButton()
{
	if(nCombatOnOff > 0)
	{
		Combat_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.CombatBTNON_Normal"", ""L2UI_NewTex.AutomaticPlay.CombatBTNON_Normal"", ""L2UI_NewTex.AutomaticPlay.CombatBTNON_Over"");
	}
	else
	{
		Combat_BTN.SetTexture(""L2UI_NewTex.AutomaticPlay.CombatBTNOff_Normal"", ""L2UI_NewTex.AutomaticPlay.CombatBTNOff_Normal"", ""L2UI_NewTex.AutomaticPlay.CombatBTNOff_Over"");
	}
	return;
}
function Autotarget_UpdateAutoTargetState()
{
	if(autotarget_bUseAutoTarget)
	{
		AnimTexturePlay(AutoTargetAllON_ToggleEffect_Anim, True);
		AnimTexturePlay(AutoTargetAllON_ToggleEffect_Anim2, True);
		GetWindowHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllON_Win"").ShowWindow();
		GetWindowHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllOFF_Win"").HideWindow();
	}
	else
	{
		AnimTextureStop(AutoTargetAllON_ToggleEffect_Anim, True);
		AnimTextureStop(AutoTargetAllON_ToggleEffect_Anim2, True);
		GetWindowHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllON_Win"").HideWindow();
		GetWindowHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllOFF_Win"").ShowWindow();
	}
	YetiQuickSlotwndScript.setPlayAutoTargetActiveAnim();
	return;
}
function requestAutoPlay(bool bUseAutoTarget, optional int nHPPotionPercent, optional int nHPPetPotionPercent)
{
	local AutoplaySettingData pAutoplaySettingData;
	autotarget_nTargetMode = GetNextTargetModeOption();
	pAutoplaySettingData.IsAutoPlayOn = bUseAutoTarget;
	pAutoplaySettingData.IsPickupOn = autotarget_bIsPickupOn;
	pAutoplaySettingData.NextTargetMode = autotarget_nTargetMode;
	pAutoplaySettingData.IsNearTargetMode = autotarget_bShortTarget;
	pAutoplaySettingData.IsMannerModeOn = autotarget_bIsMannerModeOn;
	if(nHPPotionPercent > 0)
	{
		pAutoplaySettingData.HPPotionPercent = nHPPotionPercent;
	}
	else
	{
		pAutoplaySettingData.HPPotionPercent = autotarget_nHPPotionPercent;
	}
	if(nHPPetPotionPercent > 0)
	{
		pAutoplaySettingData.HPPetPotionPercent = nHPPetPotionPercent;
	}
	else
	{
		pAutoplaySettingData.HPPetPotionPercent = autotarget_nHPPetPotionPercent;
	}
	UpdateAutoplaySetting(pAutoplaySettingData);
	return;
}
function requestAutoPlayForAutoPotion(int nHPPotionPercent)
{
	requestAutoPlay(autotarget_bUseAutoTarget, nHPPotionPercent);
	return;
}
function requestAutoPlayForAutoPotionPet(int nHPPetPotionPercent)
{
	requestAutoPlay(autotarget_bUseAutoTarget, autotarget_nHPPotionPercent, nHPPetPotionPercent);
	return;
}
function requestAutoPlayForAutoPotionWithPet(int nHPPotionPercent, int nHPPetPotionPercent)
{
	requestAutoPlay(autotarget_bUseAutoTarget, nHPPotionPercent, nHPPetPotionPercent);
	return;
}
function showHideForYeti(bool bShow)
{
	if(bShow)
	{
		m_hOwnerWnd.ShowWindow();
	}
	else
	{
		m_hOwnerWnd.HideWindow();
	}
	return;
}
function WinMinMax()
{
	if(WinMinBTN.GetButtonValue() == 0)
	{
		SetMin();
	}
	else
	{
		SetMax();
	}
	return;
}
private function SetMin()
{
	SetINIBool(""AutomaticPlay"", ""v"", True, ""windowsInfo.ini"");
	WinMinBTN.SetButtonValue(1);
	WinMinBTN.SetTexture(""L2UI_NewTex.AutomaticPlay.WinExpandButton_Normal"", ""L2UI_NewTex.AutomaticPlay.WinExpandButton_Down"", ""L2UI_NewTex.AutomaticPlay.WinExpandButton_Over"");
	LineBG.SetTexture("""");
	AutoCircleFrameExpand.SetTexture(""L2UI_NewTex.AutomaticPlay.AutoCircleFrameSmall"");
	TargetNext_BTN.HideWindow();
	TargetSwap_BTN.HideWindow();
	TargetPickupToggle_BTN.HideWindow();
	TargetMannerToggle_BTN.HideWindow();
	Combat_BTN.HideWindow();
	return;
}
private function SetMax()
{
	SetINIBool(""AutomaticPlay"", ""v"", False, ""windowsInfo.ini"");
	WinMinBTN.SetButtonValue(0);
	WinMinBTN.SetTexture(""L2UI_NewTex.AutomaticPlay.WinMinButton_Normal"", ""L2UI_NewTex.AutomaticPlay.WinMinButton_Down"", ""L2UI_NewTex.AutomaticPlay.WinMinButton_Over"");
	LineBG.SetTexture(""L2UI_NewTex.AutomaticPlay.LineBG"");
	AutoCircleFrameExpand.SetTexture(""L2UI_NewTex.AutomaticPlay.AutoCircleFrameExpand"");
	TargetNext_BTN.ShowWindow();
	TargetSwap_BTN.ShowWindow();
	TargetPickupToggle_BTN.ShowWindow();
	TargetMannerToggle_BTN.ShowWindow();
	Combat_BTN.ShowWindow();
	return;
}
private function HandleUpdatePlayerAutoAttacking()
{
	if(API_IsAutoAttacking())
	{
		GetTextureHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllOFF_Win.AutoAllIcon_Off_texture"").SetTexture(""L2UI_NewTex.AutomaticPlay.FightOn"");
		GetTextureHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllON_Win.AutoAllIcon_On_texture"").SetTexture(""L2UI_NewTex.AutomaticPlay.FightOn_Auto"");
	}
	else
	{
		GetTextureHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllOFF_Win.AutoAllIcon_Off_texture"").SetTexture(""L2UI_NewTex.AutomaticPlay.FightOff"");
		GetTextureHandle(""AutomaticPlay.AutoTargetWnd.AutoTargetAllON_Win.AutoAllIcon_On_texture"").SetTexture(""L2UI_NewTex.AutomaticPlay.FightOff_Auto"");
	}
	return;
}
private function bool API_IsAutoAttacking()
{
	return Class'UIDATA_PLAYER'.static.IsAutoAttacking();
}
function int GetAbs(int Num)
{
	if(Num < 0)
	{
		return -Num;
	}
	return Num;
}"
ujYwa7kn,RoboMarkets Announces Platinum Partnership with Team AutoLife,fxvnpro,PHP,Monday 1st of April 2024 09:39:28 AM CDT,https://www.fxvnpro.com/robomarkets-announces-platinum-partnership-with-team-autolife/
8qGP5DvG,Modsec CRS4 Audit Logs (second try),danrancan,Bash,Monday 1st of April 2024 09:32:21 AM CDT,"---Qa6rO5fQ---A--
[01/Apr/2024:09:30:38 -0500] 171198183845.393352 108.231.125.253 54054 10.10.10.2 443
---Qa6rO5fQ---B--
GET /wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---Qa6rO5fQ---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---Qa6rO5fQ---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:38 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---Qa6rO5fQ---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198183845.393352""] [ref ""o0,2v741,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198183845.393352""] [ref """"]

---Qa6rO5fQ---J--

---Qa6rO5fQ---K--

---Qa6rO5fQ---Z--

---PscekrQt---A--
[01/Apr/2024:09:30:38 -0500] 171198183814.412138 108.231.125.253 54054 10.10.10.2 443
---PscekrQt---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---PscekrQt---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---PscekrQt---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:38 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---PscekrQt---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198183814.412138""] [ref ""o0,2v774,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198183814.412138""] [ref """"]

---PscekrQt---J--

---PscekrQt---K--

---PscekrQt---Z--

---j3mimgln---A--
[01/Apr/2024:09:30:38 -0500] 171198183894.489757 108.231.125.253 54054 10.10.10.2 443
---j3mimgln---B--
GET /wp-content/plugins/newsletter-manager/images/close.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---j3mimgln---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---j3mimgln---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:38 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---j3mimgln---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/newsletter-manager/images/close.png""] [unique_id ""171198183894.489757""] [ref ""o0,2v728,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/newsletter-manager/images/close.png""] [unique_id ""171198183894.489757""] [ref """"]

---j3mimgln---J--

---j3mimgln---K--

---j3mimgln---Z--

---BXliNKtn---A--
[01/Apr/2024:09:30:38 -0500] 171198183879.882769 108.231.125.253 54054 10.10.10.2 443
---BXliNKtn---B--
GET /wp-content/plugins/contact-form-manager/images/arrow-refresh.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---BXliNKtn---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---BXliNKtn---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:38 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---BXliNKtn---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/images/arrow-refresh.png""] [unique_id ""171198183879.882769""] [ref ""o0,2v738,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/images/arrow-refresh.png""] [unique_id ""171198183879.882769""] [ref """"]

---BXliNKtn---J--

---BXliNKtn---K--

---BXliNKtn---Z--

---uzcJ2HjP---A--
[01/Apr/2024:09:30:38 -0500] 171198183815.515456 108.231.125.253 54054 10.10.10.2 443
---uzcJ2HjP---B--
GET /wp-content/themes/h-code/assets/images/icon-zoom-white.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---uzcJ2HjP---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---uzcJ2HjP---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:38 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---uzcJ2HjP---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198183815.515456""] [ref ""o0,2v732,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198183815.515456""] [ref """"]

---uzcJ2HjP---J--

---uzcJ2HjP---K--

---uzcJ2HjP---Z--

---7L4pBSiu---A--
[01/Apr/2024:09:30:38 -0500] 171198183866.254892 108.231.125.253 54054 10.10.10.2 443
---7L4pBSiu---B--
GET /wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---7L4pBSiu---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---7L4pBSiu---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:38 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---7L4pBSiu---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198183866.254892""] [ref ""o0,2v738,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198183866.254892""] [ref """"]

---7L4pBSiu---J--

---7L4pBSiu---K--

---7L4pBSiu---Z--

---TSaD6J0H---A--
[01/Apr/2024:09:30:38 -0500] 171198183880.063040 108.231.125.253 54054 10.10.10.2 443
---TSaD6J0H---B--
GET /wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---TSaD6J0H---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---TSaD6J0H---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:38 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---TSaD6J0H---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198183880.063040""] [ref ""o0,2v741,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198183880.063040""] [ref """"]

---TSaD6J0H---J--

---TSaD6J0H---K--

---TSaD6J0H---Z--

---olz96txy---A--
[01/Apr/2024:09:30:39 -0500] 171198183965.096407 108.231.125.253 54054 10.10.10.2 443
---olz96txy---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---olz96txy---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---olz96txy---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:39 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---olz96txy---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198183965.096407""] [ref ""o0,2v746,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198183965.096407""] [ref """"]

---olz96txy---J--

---olz96txy---K--

---olz96txy---Z--

---qXHtpyIu---A--
[01/Apr/2024:09:30:39 -0500] 171198183993.733166 108.231.125.253 54054 10.10.10.2 443
---qXHtpyIu---B--
GET /wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---qXHtpyIu---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---qXHtpyIu---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:39 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---qXHtpyIu---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198183993.733166""] [ref ""o0,2v783,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198183993.733166""] [ref """"]

---qXHtpyIu---J--

---qXHtpyIu---K--

---qXHtpyIu---Z--

---KKkTkSLE---A--
[01/Apr/2024:09:30:39 -0500] 171198183937.445822 108.231.125.253 54054 10.10.10.2 443
---KKkTkSLE---B--
GET /wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---KKkTkSLE---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---KKkTkSLE---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:39 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---KKkTkSLE---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198183937.445822""] [ref ""o0,2v784,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198183937.445822""] [ref """"]

---KKkTkSLE---J--

---KKkTkSLE---K--

---KKkTkSLE---Z--

---vuRzBQH0---A--
[01/Apr/2024:09:30:39 -0500] 171198183927.467682 108.231.125.253 54054 10.10.10.2 443
---vuRzBQH0---B--
GET /wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---vuRzBQH0---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---vuRzBQH0---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:39 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---vuRzBQH0---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198183927.467682""] [ref ""o0,2v783,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198183927.467682""] [ref """"]

---vuRzBQH0---J--

---vuRzBQH0---K--

---vuRzBQH0---Z--

---BG9F74Cy---A--
[01/Apr/2024:09:30:39 -0500] 171198183921.426360 108.231.125.253 54054 10.10.10.2 443
---BG9F74Cy---B--
GET /wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---BG9F74Cy---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---BG9F74Cy---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:39 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---BG9F74Cy---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198183921.426360""] [ref ""o0,2v741,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198183921.426360""] [ref """"]

---BG9F74Cy---J--

---BG9F74Cy---K--

---BG9F74Cy---Z--

---cTpPQ5Jk---A--
[01/Apr/2024:09:30:39 -0500] 171198183918.963896 108.231.125.253 54054 10.10.10.2 443
---cTpPQ5Jk---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---cTpPQ5Jk---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---cTpPQ5Jk---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:39 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---cTpPQ5Jk---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198183918.963896""] [ref ""o0,2v774,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198183918.963896""] [ref """"]

---cTpPQ5Jk---J--

---cTpPQ5Jk---K--

---cTpPQ5Jk---Z--

---O1B8UWMN---A--
[01/Apr/2024:09:30:39 -0500] 171198183927.874291 108.231.125.253 54054 10.10.10.2 443
---O1B8UWMN---B--
GET /wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---O1B8UWMN---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---O1B8UWMN---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:39 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---O1B8UWMN---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198183927.874291""] [ref ""o0,2v738,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198183927.874291""] [ref """"]

---O1B8UWMN---J--

---O1B8UWMN---K--

---O1B8UWMN---Z--

---QmKcCbaL---A--
[01/Apr/2024:09:30:39 -0500] 171198183989.477521 108.231.125.253 54054 10.10.10.2 443
---QmKcCbaL---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---QmKcCbaL---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---QmKcCbaL---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:39 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---QmKcCbaL---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198183989.477521""] [ref ""o0,2v746,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198183989.477521""] [ref """"]

---QmKcCbaL---J--

---QmKcCbaL---K--

---QmKcCbaL---Z--

---qjbvmlrO---A--
[01/Apr/2024:09:30:40 -0500] 17119818402.544401 108.231.125.253 54054 10.10.10.2 443
---qjbvmlrO---B--
GET /wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---qjbvmlrO---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---qjbvmlrO---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:40 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---qjbvmlrO---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""17119818402.544401""] [ref ""o0,2v783,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""17119818402.544401""] [ref """"]

---qjbvmlrO---J--

---qjbvmlrO---K--

---qjbvmlrO---Z--

---Eglck4M8---A--
[01/Apr/2024:09:30:40 -0500] 171198184064.539410 108.231.125.253 54054 10.10.10.2 443
---Eglck4M8---B--
GET /wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---Eglck4M8---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---Eglck4M8---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:40 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---Eglck4M8---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198184064.539410""] [ref ""o0,2v784,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198184064.539410""] [ref """"]

---Eglck4M8---J--

---Eglck4M8---K--

---Eglck4M8---Z--

---6VGY2btQ---A--
[01/Apr/2024:09:30:40 -0500] 171198184025.637527 108.231.125.253 54054 10.10.10.2 443
---6VGY2btQ---B--
GET /wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---6VGY2btQ---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---6VGY2btQ---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:40 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---6VGY2btQ---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198184025.637527""] [ref ""o0,2v783,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198184025.637527""] [ref """"]

---6VGY2btQ---J--

---6VGY2btQ---K--

---6VGY2btQ---Z--

---ND0ZnYud---A--
[01/Apr/2024:09:30:40 -0500] 171198184073.200713 108.231.125.253 54054 10.10.10.2 443
---ND0ZnYud---B--
GET /wp-content/themes/h-code/assets/images/icon-zoom-white.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---ND0ZnYud---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---ND0ZnYud---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:40 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---ND0ZnYud---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198184073.200713""] [ref ""o0,2v732,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198184073.200713""] [ref """"]

---ND0ZnYud---J--

---ND0ZnYud---K--

---ND0ZnYud---Z--

---GTY2EQQR---A--
[01/Apr/2024:09:30:40 -0500] 171198184036.978040 108.231.125.253 54054 10.10.10.2 443
---GTY2EQQR---B--
GET /wp-content/uploads/2023/08/img_4584-825x510.jpg HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---GTY2EQQR---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---GTY2EQQR---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:40 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---GTY2EQQR---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4584-825x510.jpg""] [unique_id ""171198184036.978040""] [ref ""o0,2v721,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4584-825x510.jpg""] [unique_id ""171198184036.978040""] [ref """"]

---GTY2EQQR---J--

---GTY2EQQR---K--

---GTY2EQQR---Z--

---4B3mDOuH---A--
[01/Apr/2024:09:30:40 -0500] 171198184035.175363 108.231.125.253 54054 10.10.10.2 443
---4B3mDOuH---B--
GET /wp-content/uploads/2023/08/img_4626-825x510.jpg HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---4B3mDOuH---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---4B3mDOuH---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:40 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---4B3mDOuH---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4626-825x510.jpg""] [unique_id ""171198184035.175363""] [ref ""o0,2v721,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4626-825x510.jpg""] [unique_id ""171198184035.175363""] [ref """"]

---4B3mDOuH---J--

---4B3mDOuH---K--

---4B3mDOuH---Z--

---t9ntkeI5---A--
[01/Apr/2024:09:30:40 -0500] 171198184057.282076 108.231.125.253 54054 10.10.10.2 443
---t9ntkeI5---B--
GET /wp-content/uploads/2023/08/img_4495-825x510.jpg HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---t9ntkeI5---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---t9ntkeI5---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:40 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---t9ntkeI5---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4495-825x510.jpg""] [unique_id ""171198184057.282076""] [ref ""o0,2v721,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4495-825x510.jpg""] [unique_id ""171198184057.282076""] [ref """"]

---t9ntkeI5---J--

---t9ntkeI5---K--

---t9ntkeI5---Z--

---sGcfpUG5---A--
[01/Apr/2024:09:30:42 -0500] 171198184250.112249 108.231.125.253 54054 10.10.10.2 443
---sGcfpUG5---B--
GET /wp-content/plugins/contact-form-manager/captcha/random.php?formName=1&formId=_1 HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: iframe
sec-fetch-mode: navigate
accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---sGcfpUG5---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---sGcfpUG5---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:42 GMT
Content-Type: text/html
X-Content-Type-Options: nosniff
Connection: close
X-XSS-Protection: 1; mode=block
Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
Content-Encoding: br
Content-Security-Policy: default-src * data: 'unsafe-eval' 'unsafe-inline'
Referrer-Policy: no-referrer-when-downgrade
x-frame-options: SAMEORIGIN

---sGcfpUG5---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/captcha/random.php""] [unique_id ""171198184250.112249""] [ref ""o0,2v694,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/captcha/random.php""] [unique_id ""171198184250.112249""] [ref """"]

---sGcfpUG5---J--

---sGcfpUG5---K--

---sGcfpUG5---Z--

---ym7AAVbD---A--
[01/Apr/2024:09:30:44 -0500] 171198184495.361272 108.231.125.253 54054 10.10.10.2 443
---ym7AAVbD---B--
GET /wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---ym7AAVbD---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---ym7AAVbD---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:44 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---ym7AAVbD---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198184495.361272""] [ref ""o0,2v741,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198184495.361272""] [ref """"]

---ym7AAVbD---J--

---ym7AAVbD---K--

---ym7AAVbD---Z--

---edzrzu7q---A--
[01/Apr/2024:09:30:44 -0500] 171198184471.820517 108.231.125.253 54054 10.10.10.2 443
---edzrzu7q---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---edzrzu7q---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---edzrzu7q---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:44 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---edzrzu7q---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198184471.820517""] [ref ""o0,2v774,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198184471.820517""] [ref """"]

---edzrzu7q---J--

---edzrzu7q---K--

---edzrzu7q---Z--

---1uijX0oP---A--
[01/Apr/2024:09:30:44 -0500] 171198184469.990100 108.231.125.253 54054 10.10.10.2 443
---1uijX0oP---B--
GET /wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---1uijX0oP---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---1uijX0oP---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:44 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---1uijX0oP---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198184469.990100""] [ref ""o0,2v738,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198184469.990100""] [ref """"]

---1uijX0oP---J--

---1uijX0oP---K--

---1uijX0oP---Z--

---EO21sG6q---A--
[01/Apr/2024:09:30:44 -0500] 171198184427.848616 108.231.125.253 54054 10.10.10.2 443
---EO21sG6q---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---EO21sG6q---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---EO21sG6q---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:44 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---EO21sG6q---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198184427.848616""] [ref ""o0,2v746,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198184427.848616""] [ref """"]

---EO21sG6q---J--

---EO21sG6q---K--

---EO21sG6q---Z--

---2BzDgaQI---A--
[01/Apr/2024:09:30:45 -0500] 171198184575.937852 108.231.125.253 54054 10.10.10.2 443
---2BzDgaQI---B--
GET /wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---2BzDgaQI---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---2BzDgaQI---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:44 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---2BzDgaQI---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198184575.937852""] [ref ""o0,2v783,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198184575.937852""] [ref """"]

---2BzDgaQI---J--

---2BzDgaQI---K--

---2BzDgaQI---Z--

---BP88HFzI---A--
[01/Apr/2024:09:30:45 -0500] 171198184558.780073 108.231.125.253 54054 10.10.10.2 443
---BP88HFzI---B--
GET /wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---BP88HFzI---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---BP88HFzI---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:44 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---BP88HFzI---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198184558.780073""] [ref ""o0,2v784,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198184558.780073""] [ref """"]

---BP88HFzI---J--

---BP88HFzI---K--

---BP88HFzI---Z--

---7hzefn1r---A--
[01/Apr/2024:09:30:45 -0500] 171198184572.842638 108.231.125.253 54054 10.10.10.2 443
---7hzefn1r---B--
GET /wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=6d21b19886310670.1711981838.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---7hzefn1r---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---7hzefn1r---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:30:44 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---7hzefn1r---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_current_add' (Value: `fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: fd found within REQUEST_COOKIES:sbjs_current_add: fd%3D2024-04-01%2014%3A30%3A37%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198184572.842638""] [ref ""o0,2v783,97""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `5' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 5)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198184572.842638""] [ref """"]

---7hzefn1r---J--

---7hzefn1r---K--

---7hzefn1r---Z--"
iY1783zr,modsec crs4 audit log for mcmo.xyz,danrancan,Bash,Monday 1st of April 2024 09:20:33 AM CDT,"---cT9nc6R6---A--
[01/Apr/2024:09:18:13 -0500] 171198109317.845861 108.231.125.253 53514 10.10.10.2 443
---cT9nc6R6---B--
GET /wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---cT9nc6R6---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---cT9nc6R6---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---cT9nc6R6---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198109317.845861""] [ref ""o0,2v741,97o0,2v1178,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198109317.845861""] [ref ""o13,4v851,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198109317.845861""] [ref """"]

---cT9nc6R6---J--

---cT9nc6R6---K--

---cT9nc6R6---Z--

---BC4XHtUY---A--
[01/Apr/2024:09:18:13 -0500] 17119810933.848267 108.231.125.253 53514 10.10.10.2 443
---BC4XHtUY---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---BC4XHtUY---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---BC4XHtUY---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---BC4XHtUY---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""17119810933.848267""] [ref ""o0,2v774,97o0,2v1211,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""17119810933.848267""] [ref ""o13,4v884,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""17119810933.848267""] [ref """"]

---BC4XHtUY---J--

---BC4XHtUY---K--

---BC4XHtUY---Z--

---HVj9BKHq---A--
[01/Apr/2024:09:18:13 -0500] 17119810939.439168 108.231.125.253 53514 10.10.10.2 443
---HVj9BKHq---B--
GET /wp-content/plugins/newsletter-manager/images/close.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---HVj9BKHq---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---HVj9BKHq---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---HVj9BKHq---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/newsletter-manager/images/close.png""] [unique_id ""17119810939.439168""] [ref ""o0,2v728,97o0,2v1165,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/newsletter-manager/images/close.png""] [unique_id ""17119810939.439168""] [ref ""o13,4v838,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/newsletter-manager/images/close.png""] [unique_id ""17119810939.439168""] [ref """"]

---HVj9BKHq---J--

---HVj9BKHq---K--

---HVj9BKHq---Z--

---eSdPvCiW---A--
[01/Apr/2024:09:18:13 -0500] 171198109354.079798 108.231.125.253 53514 10.10.10.2 443
---eSdPvCiW---B--
GET /wp-content/plugins/contact-form-manager/images/arrow-refresh.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---eSdPvCiW---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---eSdPvCiW---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---eSdPvCiW---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/images/arrow-refresh.png""] [unique_id ""171198109354.079798""] [ref ""o0,2v738,97o0,2v1175,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/images/arrow-refresh.png""] [unique_id ""171198109354.079798""] [ref ""o13,4v848,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/images/arrow-refresh.png""] [unique_id ""171198109354.079798""] [ref """"]

---eSdPvCiW---J--

---eSdPvCiW---K--

---eSdPvCiW---Z--

---dpJGtjK5---A--
[01/Apr/2024:09:18:13 -0500] 171198109340.313719 108.231.125.253 53514 10.10.10.2 443
---dpJGtjK5---B--
GET /wp-content/themes/h-code/assets/images/icon-zoom-white.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---dpJGtjK5---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---dpJGtjK5---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---dpJGtjK5---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109340.313719""] [ref ""o0,2v732,97o0,2v1169,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109340.313719""] [ref ""o13,4v842,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109340.313719""] [ref """"]

---dpJGtjK5---J--

---dpJGtjK5---K--

---dpJGtjK5---Z--

---vOaAG4gV---A--
[01/Apr/2024:09:18:13 -0500] 171198109363.485168 108.231.125.253 53514 10.10.10.2 443
---vOaAG4gV---B--
GET /wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---vOaAG4gV---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---vOaAG4gV---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---vOaAG4gV---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198109363.485168""] [ref ""o0,2v738,97o0,2v1175,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198109363.485168""] [ref ""o13,4v848,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198109363.485168""] [ref """"]

---vOaAG4gV---J--

---vOaAG4gV---K--

---vOaAG4gV---Z--

---XPeijtXN---A--
[01/Apr/2024:09:18:13 -0500] 171198109344.431967 108.231.125.253 53514 10.10.10.2 443
---XPeijtXN---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---XPeijtXN---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---XPeijtXN---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---XPeijtXN---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198109344.431967""] [ref ""o0,2v746,97o0,2v1183,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198109344.431967""] [ref ""o13,4v856,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198109344.431967""] [ref """"]

---XPeijtXN---J--

---XPeijtXN---K--

---XPeijtXN---Z--

---MAnFKTly---A--
[01/Apr/2024:09:18:13 -0500] 171198109333.745325 108.231.125.253 53514 10.10.10.2 443
---MAnFKTly---B--
GET /wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---MAnFKTly---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---MAnFKTly---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---MAnFKTly---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198109333.745325""] [ref ""o0,2v783,97o0,2v1220,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198109333.745325""] [ref ""o13,4v893,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198109333.745325""] [ref """"]

---MAnFKTly---J--

---MAnFKTly---K--

---MAnFKTly---Z--

---G3CAkWDd---A--
[01/Apr/2024:09:18:13 -0500] 171198109324.025836 108.231.125.253 53514 10.10.10.2 443
---G3CAkWDd---B--
GET /wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---G3CAkWDd---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---G3CAkWDd---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---G3CAkWDd---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198109324.025836""] [ref ""o0,2v784,97o0,2v1221,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198109324.025836""] [ref ""o13,4v894,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198109324.025836""] [ref """"]

---G3CAkWDd---J--

---G3CAkWDd---K--

---G3CAkWDd---Z--

---snl6pRcK---A--
[01/Apr/2024:09:18:13 -0500] 171198109317.525589 108.231.125.253 53514 10.10.10.2 443
---snl6pRcK---B--
GET /wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---snl6pRcK---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---snl6pRcK---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---snl6pRcK---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198109317.525589""] [ref ""o0,2v783,97o0,2v1220,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198109317.525589""] [ref ""o13,4v893,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198109317.525589""] [ref """"]

---snl6pRcK---J--

---snl6pRcK---K--

---snl6pRcK---Z--

---qG3Z8YuU---A--
[01/Apr/2024:09:18:13 -0500] 17119810932.948357 108.231.125.253 53514 10.10.10.2 443
---qG3Z8YuU---B--
GET /wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---qG3Z8YuU---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---qG3Z8YuU---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---qG3Z8YuU---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""17119810932.948357""] [ref ""o0,2v741,97o0,2v1178,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""17119810932.948357""] [ref ""o13,4v851,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""17119810932.948357""] [ref """"]

---qG3Z8YuU---J--

---qG3Z8YuU---K--

---qG3Z8YuU---Z--

---ifj08TyN---A--
[01/Apr/2024:09:18:14 -0500] 171198109430.038655 108.231.125.253 53514 10.10.10.2 443
---ifj08TyN---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---ifj08TyN---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---ifj08TyN---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---ifj08TyN---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198109430.038655""] [ref ""o0,2v774,97o0,2v1211,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198109430.038655""] [ref ""o13,4v884,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198109430.038655""] [ref """"]

---ifj08TyN---J--

---ifj08TyN---K--

---ifj08TyN---Z--

---U8XCekpV---A--
[01/Apr/2024:09:18:14 -0500] 171198109481.136445 108.231.125.253 53514 10.10.10.2 443
---U8XCekpV---B--
GET /wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---U8XCekpV---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---U8XCekpV---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---U8XCekpV---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198109481.136445""] [ref ""o0,2v738,97o0,2v1175,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198109481.136445""] [ref ""o13,4v848,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198109481.136445""] [ref """"]

---U8XCekpV---J--

---U8XCekpV---K--

---U8XCekpV---Z--

---VabIzDcp---A--
[01/Apr/2024:09:18:14 -0500] 171198109494.145333 108.231.125.253 53514 10.10.10.2 443
---VabIzDcp---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---VabIzDcp---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---VabIzDcp---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---VabIzDcp---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198109494.145333""] [ref ""o0,2v746,97o0,2v1183,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198109494.145333""] [ref ""o13,4v856,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198109494.145333""] [ref """"]

---VabIzDcp---J--

---VabIzDcp---K--

---VabIzDcp---Z--

---SdMaBG4r---A--
[01/Apr/2024:09:18:14 -0500] 171198109447.173825 108.231.125.253 53514 10.10.10.2 443
---SdMaBG4r---B--
GET /wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---SdMaBG4r---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---SdMaBG4r---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:13 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---SdMaBG4r---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198109447.173825""] [ref ""o0,2v783,97o0,2v1220,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198109447.173825""] [ref ""o13,4v893,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198109447.173825""] [ref """"]

---SdMaBG4r---J--

---SdMaBG4r---K--

---SdMaBG4r---Z--

---wls2CoPe---A--
[01/Apr/2024:09:18:15 -0500] 171198109533.225357 108.231.125.253 53514 10.10.10.2 443
---wls2CoPe---B--
GET /wp-content/themes/h-code/assets/images/icon-zoom-white.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---wls2CoPe---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---wls2CoPe---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:15 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---wls2CoPe---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109533.225357""] [ref ""o0,2v732,97o0,2v1169,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109533.225357""] [ref ""o13,4v842,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109533.225357""] [ref """"]

---wls2CoPe---J--

---wls2CoPe---K--

---wls2CoPe---Z--

---xuqZed47---A--
[01/Apr/2024:09:18:16 -0500] 171198109660.052163 108.231.125.253 53514 10.10.10.2 443
---xuqZed47---B--
GET /wp-content/uploads/2023/08/img_4584-825x510.jpg HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---xuqZed47---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---xuqZed47---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:16 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---xuqZed47---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4584-825x510.jpg""] [unique_id ""171198109660.052163""] [ref ""o0,2v721,97o0,2v1158,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4584-825x510.jpg""] [unique_id ""171198109660.052163""] [ref ""o13,4v831,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4584-825x510.jpg""] [unique_id ""171198109660.052163""] [ref """"]

---xuqZed47---J--

---xuqZed47---K--

---xuqZed47---Z--

---BgNAr0zJ---A--
[01/Apr/2024:09:18:16 -0500] 171198109669.680396 108.231.125.253 53514 10.10.10.2 443
---BgNAr0zJ---B--
GET /wp-content/uploads/2023/08/img_4626-825x510.jpg HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---BgNAr0zJ---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---BgNAr0zJ---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:16 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---BgNAr0zJ---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4626-825x510.jpg""] [unique_id ""171198109669.680396""] [ref ""o0,2v721,97o0,2v1158,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4626-825x510.jpg""] [unique_id ""171198109669.680396""] [ref ""o13,4v831,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4626-825x510.jpg""] [unique_id ""171198109669.680396""] [ref """"]

---BgNAr0zJ---J--

---BgNAr0zJ---K--

---BgNAr0zJ---Z--

---bLtnaveU---A--
[01/Apr/2024:09:18:16 -0500] 171198109647.257418 108.231.125.253 53514 10.10.10.2 443
---bLtnaveU---B--
GET /wp-content/uploads/2023/08/img_4495-825x510.jpg HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---bLtnaveU---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---bLtnaveU---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:16 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---bLtnaveU---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4495-825x510.jpg""] [unique_id ""171198109647.257418""] [ref ""o0,2v721,97o0,2v1158,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4495-825x510.jpg""] [unique_id ""171198109647.257418""] [ref ""o13,4v831,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/08/img_4495-825x510.jpg""] [unique_id ""171198109647.257418""] [ref """"]

---bLtnaveU---J--

---bLtnaveU---K--

---bLtnaveU---Z--

---hUWrJuWE---A--
[01/Apr/2024:09:18:16 -0500] 171198109695.156262 108.231.125.253 53514 10.10.10.2 443
---hUWrJuWE---B--
GET /wp-content/themes/h-code/assets/images/icon-zoom-white.png HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---hUWrJuWE---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---hUWrJuWE---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:16 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---hUWrJuWE---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109695.156262""] [ref ""o0,2v732,97o0,2v1169,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109695.156262""] [ref ""o13,4v842,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/themes/h-code/assets/images/icon-zoom-white.png""] [unique_id ""171198109695.156262""] [ref """"]

---hUWrJuWE---J--

---hUWrJuWE---K--

---hUWrJuWE---Z--

---oKnRyqW9---A--
[01/Apr/2024:09:18:19 -0500] 171198109980.154441 108.231.125.253 53514 10.10.10.2 443
---oKnRyqW9---B--
GET /wp-content/plugins/contact-form-manager/captcha/random.php?formName=1&formId=_1 HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: iframe
sec-fetch-mode: navigate
accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---oKnRyqW9---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---oKnRyqW9---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:19 GMT
Content-Type: text/html
X-Content-Type-Options: nosniff
Connection: close
X-XSS-Protection: 1; mode=block
Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
Content-Encoding: br
Content-Security-Policy: default-src * data: 'unsafe-eval' 'unsafe-inline'
Referrer-Policy: no-referrer-when-downgrade
x-frame-options: SAMEORIGIN

---oKnRyqW9---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/captcha/random.php""] [unique_id ""171198109980.154441""] [ref ""o0,2v694,97o0,2v1131,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/captcha/random.php""] [unique_id ""171198109980.154441""] [ref ""o13,4v804,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/plugins/contact-form-manager/captcha/random.php""] [unique_id ""171198109980.154441""] [ref """"]

---oKnRyqW9---J--

---oKnRyqW9---K--

---oKnRyqW9---Z--

---WuKNuHfV---A--
[01/Apr/2024:09:18:20 -0500] 171198110016.911398 108.231.125.253 53514 10.10.10.2 443
---WuKNuHfV---B--
GET /wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---WuKNuHfV---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---WuKNuHfV---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:20 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---WuKNuHfV---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198110016.911398""] [ref ""o0,2v741,97o0,2v1178,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198110016.911398""] [ref ""o13,4v851,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Tryclops-1-scaled-768x1012.webp""] [unique_id ""171198110016.911398""] [ref """"]

---WuKNuHfV---J--

---WuKNuHfV---K--

---WuKNuHfV---Z--

---bYGBUtf9---A--
[01/Apr/2024:09:18:20 -0500] 171198110016.769517 108.231.125.253 53514 10.10.10.2 443
---bYGBUtf9---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---bYGBUtf9---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---bYGBUtf9---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:20 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---bYGBUtf9---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198110016.769517""] [ref ""o0,2v774,97o0,2v1211,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198110016.769517""] [ref ""o13,4v884,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Shape-of-Things-The-Shape-of-Things-Exhibit-1-4-768x400.webp""] [unique_id ""171198110016.769517""] [ref """"]

---bYGBUtf9---J--

---bYGBUtf9---K--

---bYGBUtf9---Z--

---N9ye3Uqq---A--
[01/Apr/2024:09:18:20 -0500] 171198110042.230080 108.231.125.253 53514 10.10.10.2 443
---N9ye3Uqq---B--
GET /wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---N9ye3Uqq---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---N9ye3Uqq---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:20 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---N9ye3Uqq---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198110042.230080""] [ref ""o0,2v738,97o0,2v1175,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198110042.230080""] [ref ""o13,4v848,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-Stoned-Totem-2-768x1010.webp""] [unique_id ""171198110042.230080""] [ref """"]

---N9ye3Uqq---J--

---N9ye3Uqq---K--

---N9ye3Uqq---Z--

---ncHlSnsy---A--
[01/Apr/2024:09:18:20 -0500] 171198110075.322682 108.231.125.253 53514 10.10.10.2 443
---ncHlSnsy---B--
GET /wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---ncHlSnsy---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---ncHlSnsy---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:20 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---ncHlSnsy---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198110075.322682""] [ref ""o0,2v746,97o0,2v1183,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198110075.322682""] [ref ""o13,4v856,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2022/05/McMo-Art-The-Beautiful-People-2-768x1010.webp""] [unique_id ""171198110075.322682""] [ref """"]

---ncHlSnsy---J--

---ncHlSnsy---K--

---ncHlSnsy---Z--

---fAJZSy33---A--
[01/Apr/2024:09:18:20 -0500] 171198110071.593070 108.231.125.253 53514 10.10.10.2 443
---fAJZSy33---B--
GET /wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---fAJZSy33---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---fAJZSy33---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:20 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---fAJZSy33---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198110071.593070""] [ref ""o0,2v783,97o0,2v1220,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198110071.593070""] [ref ""o13,4v893,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2023/06/McMo-Earthworks-Art-Products-Red-Touches-Yellow-Cropped-17-600px-X-500px-WebP.webp""] [unique_id ""171198110071.593070""] [ref """"]

---fAJZSy33---J--

---fAJZSy33---K--

---fAJZSy33---Z--

---VJCzAp6W---A--
[01/Apr/2024:09:18:21 -0500] 171198110198.973715 108.231.125.253 53514 10.10.10.2 443
---VJCzAp6W---B--
GET /wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---VJCzAp6W---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---VJCzAp6W---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:20 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---VJCzAp6W---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198110198.973715""] [ref ""o0,2v784,97o0,2v1221,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198110198.973715""] [ref ""o13,4v894,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/02/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Neolithic-Family-8-768x1013.webp""] [unique_id ""171198110198.973715""] [ref """"]

---VJCzAp6W---J--

---VJCzAp6W---K--

---VJCzAp6W---Z--

---y480XzoK---A--
[01/Apr/2024:09:18:21 -0500] 171198110131.698567 108.231.125.253 53514 10.10.10.2 443
---y480XzoK---B--
GET /wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp HTTP/2.0
host: www.mcmo.xyz
sec-fetch-dest: image
sec-fetch-mode: no-cors
accept: image/webp,image/avif,image/jxl,image/heic,image/heic-sequence,video/*;q=0.8,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5
sec-fetch-site: same-origin
accept-language: en-US,en;q=0.9
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15
cookie: sbjs_current=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_current_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_first=typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccnt%3D%28none%29%7C%7C%7Ctrm%3D%28none%29%7C%7C%7Cid%3D%28none%29; sbjs_first_add=fd%3D2024-04-01%2014%3A18%3A12%7C%7C%7Cep%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F%7C%7C%7Crf%3D%28none%29; sbjs_migrations=1418474375998%3D1; sbjs_session=pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F; sbjs_udata=vst%3D1%7C%7C%7Cuip%3D%28none%29%7C%7C%7Cuag%3DMozilla%2F5.0%20%28Macintosh%3B%20Intel%20Mac%20OS%20X%2010_15_7%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Version%2F17.4.1%20Safari%2F605.1.15; _pk_id.1.b754=de6c8ce9846b1c9f.1711981092.; _pk_ses.1.b754=1
referer: https://www.mcmo.xyz/
accept-encoding: gzip, deflate, br

---y480XzoK---E--
\xa1\x88\x04\x00 :\xb7\xceF\xe8\x84\x06\x0c\xf2\xa3)X\xc4\x82\x1bI=Y\xc8\x99]2\x92L\x0a\x0aZ\xa37|\xdc\xbe5I\xe4bPIXo\xd5\x05mi!\xeb\xcdn\xd3!\x14&\xcb$\x98d!\xd8Q\x19\xc5\x95\xca\xc5\xaar\x8c\x1bY\xd6\x80\xf0\xfa\xdc\xfe\xb8kD\xd3l\x00

---y480XzoK---F--
HTTP/2.0 403
Server: nginx
Date: Mon, 01 Apr 2024 14:18:20 GMT
Content-Type: text/html
Connection: close
Content-Encoding: br

---y480XzoK---H--
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)(?:^|b[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?u[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\$[!#\(\*\-0-9\?-@_a-\{]*)?\x5c?s[\""'\)\[-\x5c]*(?:(?:(?:\|\||&&)[\s\v]*)?\ (8043 characters omitted)' against variable `REQUEST_COOKIES:sbjs_session' (Value: `pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf""] [line ""1348""] [id ""932236""] [rev """"] [msg ""Remote Command Execution: Unix Command Injection (command without evasion)""] [data ""Matched Data: pg found within REQUEST_COOKIES:sbjs_session: pgs%3D1%7C%7C%7Ccpg%3Dhttps%3A%2F%2Fwww.mcmo.xyz%2F""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-shell""] [tag ""platform-unix""] [tag ""attack-rce""] [tag ""paranoia-level/2""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/248/88""] [tag ""PCI/6.5.2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198110131.698567""] [ref ""o0,2v783,97o0,2v1220,51""]
ModSecurity: Warning. Matched ""Operator `Rx' with parameter `(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=' against variable `REQUEST_COOKIES:sbjs_first' (Value: `typ%3Dtypein%7C%7C%7Csrc%3D%28direct%29%7C%7C%7Cmdm%3D%28none%29%7C%7C%7Ccmp%3D%28none%29%7C%7C%7Ccn (63 characters omitted)' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf""] [line ""832""] [id ""941150""] [rev """"] [msg ""XSS Filter - Category 5: Disallowed HTML Attributes""] [data ""Matched Data: src= found within REQUEST_COOKIES:sbjs_first: typ=typein|||src=(direct)|||mdm=(none)|||cmp=(none)|||cnt=(none)|||trm=(none)|||id=(none)""] [severity ""2""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""application-multi""] [tag ""language-multi""] [tag ""platform-multi""] [tag ""attack-xss""] [tag ""xss-perf-disable""] [tag ""OWASP_CRS""] [tag ""capec/1000/152/242""] [tag ""paranoia-level/2""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198110131.698567""] [ref ""o13,4v893,163t:utf8toUnicode,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,t:removeNulls""]
ModSecurity: Access denied with code 403 (phase 2). Matched ""Operator `Ge' with parameter `5' against variable `TX:BLOCKING_INBOUND_ANOMALY_SCORE' (Value: `15' ) [file ""/etc/nginx/modsec/crs4.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf""] [line ""176""] [id ""949110""] [rev """"] [msg ""Inbound Anomaly Score Exceeded (Total Score: 15)""] [data """"] [severity ""0""] [ver ""OWASP_CRS/4.0.0""] [maturity ""0""] [accuracy ""0""] [tag ""anomaly-evaluation""] [hostname ""10.10.10.2""] [uri ""/wp-content/uploads/2024/03/McMo-is-Art-On-Lincoln-Memorial-Drive-in-Milwaukee-Athenas-Necklace-3-768x488.webp""] [unique_id ""171198110131.698567""] [ref """"]

---y480XzoK---J--

---y480XzoK---K--

---y480XzoK---Z--"
g7BWbbpr,Draft pseudocode for database differencing,chadjoan,C#,Monday 1st of April 2024 09:19:28 AM CDT,"conn = new SQLConnection();

make_vcs_db_query = file_read(\Kickback\SCRIPT_ROOT . ""/../meta/schema/kickback-kingdom-schema.mysql"");

// Replace the schema name: `kickbackdb` -> `kickbackdb_vcs`
// (Ideally, we'd do this in a more syntax-aware way.
// Perhaps we could get mysqldump to parameterize the database name?
// Then we could parameterize the query instead of using fragile hacky regex stuff.)
make_vcs_db_query ~= s/\bkickbackdb\b/kickbackdb_vcs/g;

// Create the `kickbackdb_vcs` database.
conn.execute(make_vcs_db_query);

// Query that finds tables that exist in local database (kickbackdb) but not in VCS database (kickbackdb_vcs).
results = conn.execute(""..."");
diff.add_to_tables_removed(results);

// Query that finds tables that exist in VCS database (kickbackdb_vcs) but not in local database (kickbackdb).
results = conn.execute(""..."");
diff.add_to_tables_added(results);

// Query that finds tables that exist in BOTH databases.
table_list = conn.execute(""..."");
foreach( table in table_list )
{
  // Query that finds columns that exist in the local table, but not in the VCS table.
  results = conn.execute(""..."");
  diff.add_to_columns_removed(table, results);

  // Query that finds columns that exist in the VCS table, but not in the local table.
  results = conn.execute(""..."");
  diff.add_to_columns_added(table, results);

  // Query that finds keys that exist in the local table, but not in the VCS table.
  results = conn.execute(""..."");
  diff.add_to_keys_removed(table, results);

  // Query that finds keys that exist in the VCS table, but not in the local table.
  results = conn.execute(""..."");
  diff.add_to_keys_added(table, results);

  // ditto for any other table-level entities

  // Also you may want to diff for any data-level differences if the data
  // is something semantically significant in code.
  // (We should avoid semantically-signficant data as much as possible,
  // though things like badges in the current site ARE this kind of thing.)
  // So, like, adding a new badge type should probably appear in the diff.
}

// ditto for things like triggers, views, etc

// Query that deletes kickbackdb_vcs
conn.execute(""..."");

// Present the difference to the admin
display_diff(diff);"
ALcmjy3S,Error al re instalar : invoice_payment_due_by_picking_validate,ego201982,Python,Monday 1st of April 2024 09:12:26 AM CDT,"RPC_ERROR
Odoo Server Error
Traceback (most recent call last):
  File ""/home/odoo/src/odoo/odoo/fields.py"", line 790, in resolve_depends
    field = Model._fields[fname]
KeyError: 'picking_ids'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/odoo/src/odoo/odoo/http.py"", line 1633, in _serve_db
    return service_model.retrying(self._serve_ir_http, self.env)
  File ""/home/odoo/src/odoo/odoo/service/model.py"", line 133, in retrying
    result = func()
  File ""/home/odoo/src/odoo/odoo/http.py"", line 1660, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
  File ""/home/odoo/src/odoo/odoo/http.py"", line 1864, in dispatch
    result = self.request.registry['ir.http']._dispatch(endpoint)
  File ""/home/odoo/src/odoo/odoo/addons/base/models/ir_http.py"", line 154, in _dispatch
    result = endpoint(**request.params)
  File ""/home/odoo/src/odoo/odoo/http.py"", line 697, in route_wrapper
    result = endpoint(self, *args, **params_ok)
  File ""/home/odoo/src/odoo/addons/web/controllers/dataset.py"", line 46, in call_button
    action = self._call_kw(model, method, args, kwargs)
  File ""/home/odoo/src/odoo/addons/web/controllers/dataset.py"", line 33, in _call_kw
    return call_kw(request.env[model], method, args, kwargs)
  File ""/home/odoo/src/odoo/odoo/api.py"", line 468, in call_kw
    result = _call_kw_multi(method, model, args, kwargs)
  File ""/home/odoo/src/odoo/odoo/api.py"", line 453, in _call_kw_multi
    result = method(recs, *args, **kwargs)
  File ""<decorator-gen-83>"", line 2, in button_immediate_upgrade
  File ""/home/odoo/src/odoo/odoo/addons/base/models/ir_module.py"", line 74, in check_and_log
    return method(self, *args, **kwargs)
  File ""/home/odoo/src/odoo/odoo/addons/base/models/ir_module.py"", line 666, in button_immediate_upgrade
    return self._button_immediate_function(self.env.registry[self._name].button_upgrade)
  File ""/home/odoo/src/odoo/odoo/addons/base/models/ir_module.py"", line 599, in _button_immediate_function
    registry = modules.registry.Registry.new(self._cr.dbname, update_module=True)
  File ""<decorator-gen-16>"", line 2, in new
  File ""/home/odoo/src/odoo/odoo/tools/func.py"", line 87, in locked
    return func(inst, *args, **kwargs)
  File ""/home/odoo/src/odoo/odoo/modules/registry.py"", line 90, in new
    odoo.modules.load_modules(registry, force_demo, status, update_module)
  File ""/home/odoo/src/odoo/odoo/modules/loading.py"", line 484, in load_modules
    processed_modules += load_marked_modules(cr, graph,
  File ""/home/odoo/src/odoo/odoo/modules/loading.py"", line 372, in load_marked_modules
    loaded, processed = load_module_graph(
  File ""/home/odoo/src/odoo/odoo/modules/loading.py"", line 208, in load_module_graph
    registry.init_models(cr, model_names, {'module': package.name}, new_install)
  File ""/home/odoo/src/odoo/odoo/modules/registry.py"", line 542, in init_models
    func()
  File ""/home/odoo/src/odoo/odoo/addons/base/models/ir_model.py"", line 47, in mark_modified
    records.modified(fnames)
  File ""/home/odoo/src/odoo/odoo/models.py"", line 6076, in modified
    todo = [self._modified([self._fields[fname] for fname in fnames], create)]
  File ""/home/odoo/src/odoo/odoo/models.py"", line 6127, in _modified
    tree = self.pool.get_trigger_tree(fields, select=select)
  File ""/home/odoo/src/odoo/odoo/modules/registry.py"", line 346, in get_trigger_tree
    trees = [
  File ""/home/odoo/src/odoo/odoo/modules/registry.py"", line 349, in <listcomp>
    if field in self._field_triggers
  File ""/home/odoo/src/odoo/odoo/tools/func.py"", line 28, in __get__
    value = self.fget(obj)
  File ""/home/odoo/src/odoo/odoo/modules/registry.py"", line 443, in _field_triggers
    dependencies = list(field.resolve_depends(self))
  File ""/home/odoo/src/odoo/odoo/fields.py"", line 792, in resolve_depends
    raise ValueError(
ValueError: Wrong @depends on '_compute_delivery_status' (compute method of field sale.order.delivery_date_due_by_picking). Dependency field 'picking_ids' not found in model sale.order.

The above server error caused the following client error:
RPC_ERROR: Odoo Server Error
    at makeErrorFromResponse (https://vcomercial-staging-12356396.dev.odoo.com/web/assets/2191-9a79165/web.assets_backend.min.js:1001:163)
    at XMLHttpRequest.<anonymous> (https://vcomercial-staging-12356396.dev.odoo.com/web/assets/2191-9a79165/web.assets_backend.min.js:1009:13)"
tSKe0UQp,GPT Turtle code test,Randomaytion13,Lua,Monday 1st of April 2024 09:06:37 AM CDT,"local modemSide = ""left""  -- Side where the modem is attached
local webServerID = 12345  -- Unique ID to filter modem messages
local apiEndpoint = ""http://localhost:8080/api/command""  -- Web server API endpoint

-- Initialize modem
if peripheral.getType(modemSide) == ""modem"" then
    rednet.open(modemSide)
else
    error(""No modem attached to the specified side"")
end

-- Function to send state to web server
local function sendState()
    local state = {
        position = {xPos, yPos, zPos},
        blocks = knownBlocks
    }
    local response = http.post(apiEndpoint, textutils.serializeJSON(state))
    if response and response.getResponseCode() == 200 then
        local responseBody = response.readAll()
        local parsedResponse = textutils.unserializeJSON(responseBody)
        if parsedResponse and parsedResponse.command then
            executeCommand(parsedResponse.command)
        end
    end
end

-- Function to execute command
local function executeCommand(command)
    if command == ""moveForward"" then
        if turtle.forward() then
            xPos = xPos + 1
            sendState()
        end
    elseif command == ""turnLeft"" then
        turtle.turnLeft()
        sendState()
    elseif command == ""turnRight"" then
        turtle.turnRight()
        sendState()
    end
end

-- Main loop
while true do
    local senderID, message = rednet.receive(webServerID)
    if senderID == webServerID then
        local parsedMessage = textutils.unserializeJSON(message)
        if parsedMessage and parsedMessage.command then
            executeCommand(parsedMessage.command)
        end
    end
end
"
jLJJQEKf,News April1 24,Newscaster_Ned,Email,Monday 1st of April 2024 08:59:45 AM CDT,".‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎T‎e‎s‎t‎ ‎1‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎
.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎T‎e‎s‎t‎ ‎2‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎
.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎T‎e‎s‎t‎ ‎3‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎
.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎ ‎T‎e‎s‎t‎ ‎c‎o‎m‎p‎l‎e‎t‎e‎.‎

H‎e‎y‎,‎ ‎g‎u‎y‎s‎.‎ ‎N‎e‎w‎s‎c‎a‎s‎t‎e‎r‎ ‎N‎e‎d‎ ‎j‎u‎s‎t‎ ‎t‎e‎l‎l‎i‎n‎g‎ ‎y‎o‎u‎ ‎S‎o‎n‎i‎c‎ ‎t‎h‎e‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎ ‎i‎s‎ ‎a‎w‎e‎s‎o‎m‎e‎.‎

S‎o‎n‎i‎c‎

C‎o‎n‎c‎e‎p‎t‎ ‎a‎n‎d‎ ‎c‎r‎e‎a‎t‎i‎o‎n‎
S‎1‎ ‎n‎e‎e‎d‎l‎e‎m‎o‎u‎s‎e‎ ‎s‎u‎p‎e‎r‎
S‎k‎e‎t‎c‎h‎e‎s‎ ‎o‎f‎ ‎""‎M‎r‎.‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎""‎,‎ ‎t‎h‎e‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎ ‎t‎h‎a‎t‎ ‎w‎o‎u‎l‎d‎ ‎b‎e‎c‎o‎m‎e‎ ‎S‎o‎n‎i‎c‎ ‎t‎h‎e‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎.‎

W‎h‎i‎l‎e‎ ‎s‎e‎v‎e‎r‎a‎l‎ ‎p‎e‎o‎p‎l‎e‎ ‎h‎a‎v‎e‎ ‎b‎e‎e‎n‎ ‎i‎n‎v‎o‎l‎v‎e‎d‎ ‎i‎n‎ ‎t‎h‎e‎ ‎c‎r‎e‎a‎t‎i‎o‎n‎ ‎o‎f‎ ‎S‎o‎n‎i‎c‎,‎ ‎t‎h‎e‎ ‎a‎r‎t‎i‎s‎t‎ ‎N‎a‎o‎t‎o‎ ‎O‎h‎s‎h‎i‎m‎a‎,‎ ‎p‎r‎o‎g‎r‎a‎m‎m‎e‎r‎ ‎Y‎u‎j‎i‎ ‎N‎a‎k‎a‎,‎ ‎a‎n‎d‎ ‎d‎e‎s‎i‎g‎n‎e‎r‎ ‎H‎i‎r‎o‎k‎a‎z‎u‎ ‎Y‎a‎s‎u‎h‎a‎r‎a‎ ‎a‎r‎e‎ ‎g‎e‎n‎e‎r‎a‎l‎l‎y‎ ‎c‎r‎e‎d‎i‎t‎e‎d‎ ‎w‎i‎t‎h‎ ‎t‎h‎e‎ ‎c‎r‎e‎a‎t‎i‎o‎n‎ ‎o‎f‎ ‎t‎h‎e‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎.‎

I‎n‎ ‎A‎p‎r‎i‎l‎ ‎1‎9‎9‎0‎,‎ ‎S‎e‎g‎a‎ ‎r‎e‎q‎u‎e‎s‎t‎e‎d‎ ‎a‎ ‎g‎a‎m‎e‎ ‎t‎h‎a‎t‎ ‎i‎n‎v‎o‎l‎v‎e‎d‎ ‎a‎ ‎m‎a‎s‎c‎o‎t‎ ‎f‎o‎r‎ ‎t‎h‎e‎i‎r‎ ‎c‎o‎m‎p‎a‎n‎y‎.‎[‎2‎7‎]‎[‎2‎8‎]‎ ‎T‎h‎e‎y‎ ‎w‎a‎n‎t‎e‎d‎ ‎a‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎ ‎t‎o‎ ‎r‎i‎v‎a‎l‎ ‎N‎i‎n‎t‎e‎n‎d‎o‎'‎s‎ ‎f‎l‎a‎g‎s‎h‎i‎p‎ ‎m‎a‎s‎c‎o‎t‎ ‎M‎a‎r‎i‎o‎;‎ ‎S‎e‎g‎a‎ ‎p‎r‎e‎s‎i‎d‎e‎n‎t‎ ‎H‎a‎y‎a‎o‎ ‎N‎a‎k‎a‎y‎a‎m‎a‎ ‎i‎n‎ ‎p‎a‎r‎t‎i‎c‎u‎l‎a‎r‎ ‎w‎a‎n‎t‎e‎d‎ ‎a‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎ ‎a‎s‎ ‎i‎c‎o‎n‎i‎c‎ ‎a‎s‎ ‎M‎i‎c‎k‎e‎y‎ ‎M‎o‎u‎s‎e‎.‎[‎2‎9‎]‎ ‎S‎e‎g‎a‎ ‎h‎a‎d‎ ‎p‎r‎e‎v‎i‎o‎u‎s‎l‎y‎ ‎u‎s‎e‎d‎ ‎A‎l‎e‎x‎ ‎K‎i‎d‎d‎ ‎a‎s‎ ‎t‎h‎e‎i‎r‎ ‎m‎a‎s‎c‎o‎t‎,‎ ‎b‎u‎t‎ ‎b‎e‎c‎a‎u‎s‎e‎ ‎h‎e‎ ‎w‎a‎s‎ ‎c‎o‎n‎s‎i‎d‎e‎r‎e‎d‎ ‎t‎o‎o‎ ‎s‎i‎m‎i‎l‎a‎r‎ ‎t‎o‎ ‎M‎a‎r‎i‎o‎,‎ ‎h‎e‎ ‎w‎a‎s‎ ‎d‎e‎e‎m‎e‎d‎ ‎u‎n‎s‎a‎t‎i‎s‎f‎a‎c‎t‎o‎r‎y‎.‎[‎2‎7‎]‎ ‎S‎e‎v‎e‎r‎a‎l‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎ ‎d‎e‎s‎i‎g‎n‎s‎ ‎w‎e‎r‎e‎ ‎s‎u‎b‎m‎i‎t‎t‎e‎d‎ ‎b‎y‎ ‎i‎t‎s‎ ‎A‎M‎8‎ ‎r‎e‎s‎e‎a‎r‎c‎h‎ ‎a‎n‎d‎ ‎d‎e‎v‎e‎l‎o‎p‎m‎e‎n‎t‎ ‎d‎e‎p‎a‎r‎t‎m‎e‎n‎t‎.‎ ‎T‎h‎e‎s‎e‎ ‎i‎n‎c‎l‎u‎d‎e‎d‎ ‎a‎ ‎w‎o‎l‎f‎,‎ ‎a‎ ‎b‎u‎l‎l‎d‎o‎g‎,‎ ‎a‎ ‎r‎o‎b‎o‎t‎,‎ ‎a‎n‎d‎ ‎a‎ ‎w‎a‎r‎r‎i‎o‎r‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎.‎ ‎H‎o‎w‎e‎v‎e‎r‎,‎ ‎t‎h‎e‎ ‎t‎e‎a‎m‎ ‎p‎u‎t‎ ‎e‎m‎p‎h‎a‎s‎i‎s‎ ‎o‎n‎ ‎s‎p‎e‎e‎d‎ ‎f‎o‎r‎ ‎t‎h‎e‎ ‎g‎a‎m‎e‎,‎ ‎w‎h‎i‎c‎h‎ ‎c‎a‎m‎e‎ ‎f‎r‎o‎m‎ ‎Y‎u‎j‎i‎ ‎N‎a‎k‎a‎ ‎a‎t‎t‎e‎m‎p‎t‎i‎n‎g‎ ‎t‎o‎ ‎g‎e‎t‎ ‎t‎h‎r‎o‎u‎g‎h‎ ‎S‎u‎p‎e‎r‎ ‎M‎a‎r‎i‎o‎ ‎B‎r‎o‎s‎.‎'‎ ‎W‎o‎r‎l‎d‎ ‎1‎-‎1‎ ‎a‎s‎ ‎f‎a‎s‎t‎ ‎a‎s‎ ‎h‎e‎ ‎c‎o‎u‎l‎d‎.‎[‎3‎0‎]‎ ‎D‎u‎e‎ ‎t‎o‎ ‎t‎h‎i‎s‎,‎ ‎S‎e‎g‎a‎ ‎s‎t‎a‎r‎t‎e‎d‎ ‎t‎o‎ ‎o‎n‎l‎y‎ ‎c‎o‎n‎s‎i‎d‎e‎r‎ ‎f‎a‎s‎t‎ ‎c‎r‎e‎a‎t‎u‎r‎e‎s‎,‎ ‎s‎u‎c‎h‎ ‎a‎s‎ ‎k‎a‎n‎g‎a‎r‎o‎o‎s‎ ‎a‎n‎d‎ ‎s‎q‎u‎i‎r‎r‎e‎l‎s‎,‎ ‎w‎h‎i‎l‎e‎ ‎s‎c‎r‎a‎p‎p‎i‎n‎g‎ ‎d‎e‎s‎i‎g‎n‎s‎ ‎n‎o‎t‎ ‎a‎s‎s‎o‎c‎i‎a‎t‎e‎d‎ ‎w‎i‎t‎h‎ ‎f‎a‎s‎t‎ ‎a‎n‎i‎m‎a‎l‎s‎.‎[‎2‎7‎]‎ ‎O‎n‎e‎ ‎o‎f‎ ‎t‎h‎e‎s‎e‎ ‎i‎d‎e‎a‎s‎ ‎i‎n‎v‎o‎l‎v‎e‎d‎ ‎a‎ ‎r‎a‎b‎b‎i‎t‎ ‎w‎h‎o‎ ‎c‎o‎u‎l‎d‎ ‎g‎r‎a‎b‎ ‎o‎b‎j‎e‎c‎t‎s‎ ‎w‎i‎t‎h‎ ‎p‎r‎e‎h‎e‎n‎s‎i‎l‎e‎ ‎e‎a‎r‎s‎.‎ ‎I‎t‎ ‎s‎h‎o‎w‎e‎d‎ ‎p‎o‎t‎e‎n‎t‎i‎a‎l‎,‎ ‎b‎u‎t‎ ‎w‎a‎s‎ ‎t‎o‎o‎ ‎c‎o‎m‎p‎l‎e‎x‎ ‎f‎o‎r‎ ‎t‎h‎e‎ ‎S‎e‎g‎a‎ ‎M‎e‎g‎a‎ ‎D‎r‎i‎v‎e‎'‎s‎ ‎h‎a‎r‎d‎w‎a‎r‎e‎.‎ ‎A‎f‎t‎e‎r‎w‎a‎r‎d‎,‎ ‎t‎h‎e‎ ‎t‎e‎a‎m‎ ‎n‎a‎r‎r‎o‎w‎e‎d‎ ‎i‎t‎s‎ ‎s‎e‎a‎r‎c‎h‎ ‎d‎o‎w‎n‎ ‎t‎o‎ ‎a‎n‎i‎m‎a‎l‎s‎ ‎t‎h‎a‎t‎ ‎c‎o‎u‎l‎d‎ ‎r‎o‎l‎l‎ ‎i‎n‎t‎o‎ ‎a‎ ‎b‎a‎l‎l‎,‎ ‎b‎a‎s‎e‎d‎ ‎o‎n‎ ‎t‎h‎e‎ ‎i‎d‎e‎a‎ ‎f‎o‎r‎ ‎a‎n‎ ‎a‎t‎t‎a‎c‎k‎-‎b‎a‎s‎e‎d‎ ‎m‎o‎v‎e‎,‎ ‎w‎h‎i‎c‎h‎ ‎l‎e‎d‎ ‎t‎h‎e‎m‎ ‎t‎o‎ ‎c‎o‎n‎s‎i‎d‎e‎r‎ ‎a‎r‎m‎a‎d‎i‎l‎l‎o‎s‎ ‎a‎n‎d‎ ‎h‎e‎d‎g‎e‎h‎o‎g‎s‎.‎[‎2‎9‎]‎[‎3‎1‎]‎ ‎T‎h‎e‎ ‎h‎e‎d‎g‎e‎h‎o‎g‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎,‎ ‎w‎h‎i‎c‎h‎ ‎w‎a‎s‎ ‎p‎r‎o‎p‎o‎s‎e‎d‎ ‎b‎y‎ ‎N‎a‎o‎t‎o‎ ‎O‎h‎s‎h‎i‎m‎a‎,‎[‎2‎8‎]‎ ‎u‎l‎t‎i‎m‎a‎t‎e‎l‎y‎ ‎p‎r‎e‎v‎a‎i‎l‎e‎d‎.‎ ‎A‎f‎t‎e‎r‎ ‎t‎h‎a‎t‎,‎ ‎O‎h‎s‎h‎i‎m‎a‎ ‎w‎e‎n‎t‎ ‎o‎n‎ ‎v‎a‎c‎a‎t‎i‎o‎n‎ ‎t‎o‎ ‎N‎e‎w‎ ‎Y‎o‎r‎k‎,‎ ‎t‎a‎k‎i‎n‎g‎ ‎s‎k‎e‎t‎c‎h‎e‎s‎ ‎w‎i‎t‎h‎ ‎h‎i‎m‎.‎ ‎T‎h‎e‎r‎e‎,‎ ‎h‎e‎ ‎w‎e‎n‎t‎ ‎t‎o‎ ‎C‎e‎n‎t‎r‎a‎l‎ ‎P‎a‎r‎k‎,‎ ‎w‎h‎e‎r‎e‎ ‎h‎e‎ ‎w‎o‎u‎l‎d‎ ‎a‎s‎k‎ ‎l‎o‎c‎a‎l‎s‎ ‎f‎o‎r‎ ‎t‎h‎e‎i‎r‎ ‎o‎p‎i‎n‎i‎o‎n‎s‎ ‎o‎n‎ ‎t‎h‎e‎m‎,‎ ‎w‎h‎i‎c‎h‎ ‎l‎e‎d‎ ‎t‎o‎ ‎t‎h‎e‎ ‎h‎e‎d‎g‎e‎h‎o‎g‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎ ‎b‎e‎i‎n‎g‎ ‎d‎e‎e‎m‎e‎d‎ ‎t‎h‎e‎ ‎f‎a‎v‎o‎r‎i‎t‎e‎.‎[‎3‎2‎]‎

T‎h‎e‎ ‎n‎e‎w‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎ ‎w‎a‎s‎ ‎o‎r‎i‎g‎i‎n‎a‎l‎l‎y‎ ‎n‎a‎m‎e‎d‎ ‎""‎M‎i‎s‎t‎e‎r‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎""‎ ‎(‎ミ‎ス‎タ‎ー‎ハ‎リ‎ネ‎ズ‎ミ‎ ‎M‎i‎s‎u‎t‎ā‎ ‎H‎a‎r‎i‎n‎e‎z‎u‎m‎i‎?‎)‎.‎ ‎H‎o‎w‎e‎v‎e‎r‎,‎ ‎d‎u‎e‎ ‎t‎o‎ ‎a‎ ‎m‎i‎s‎t‎r‎a‎n‎s‎l‎a‎t‎i‎o‎n‎ ‎o‎f‎ ‎O‎h‎s‎h‎i‎m‎a‎'‎s‎ ‎n‎o‎t‎e‎s‎ ‎b‎y‎ ‎E‎n‎g‎l‎i‎s‎h‎-‎s‎p‎e‎a‎k‎i‎n‎g‎ ‎f‎a‎n‎s‎,‎ ‎i‎t‎ ‎w‎a‎s‎ ‎b‎e‎l‎i‎e‎v‎e‎d‎ ‎t‎h‎a‎t‎ ‎S‎o‎n‎i‎c‎'‎s‎ ‎o‎r‎i‎g‎i‎n‎a‎l‎ ‎d‎e‎v‎e‎l‎o‎p‎m‎e‎n‎t‎ ‎n‎a‎m‎e‎ ‎w‎a‎s‎ ‎""‎M‎i‎s‎t‎e‎r‎ ‎N‎e‎e‎d‎l‎e‎m‎o‎u‎s‎e‎""‎ ‎u‎n‎t‎i‎l‎ ‎i‎t‎ ‎w‎a‎s‎ ‎c‎o‎r‎r‎e‎c‎t‎e‎d‎ ‎b‎y‎ ‎Y‎u‎j‎i‎ ‎N‎a‎k‎a‎ ‎i‎n‎ ‎J‎a‎n‎u‎a‎r‎y‎ ‎2‎0‎2‎1‎.‎[‎3‎3‎]‎ ‎W‎a‎n‎t‎i‎n‎g‎ ‎a‎ ‎n‎a‎m‎e‎ ‎t‎h‎a‎t‎ ‎c‎o‎u‎l‎d‎ ‎c‎o‎n‎v‎e‎y‎ ‎a‎n‎ ‎i‎m‎a‎g‎e‎ ‎o‎f‎ ‎s‎p‎e‎e‎d‎,‎ ‎t‎h‎e‎ ‎t‎e‎a‎m‎ ‎i‎n‎i‎t‎i‎a‎l‎l‎y‎ ‎w‎e‎n‎t‎ ‎f‎o‎r‎ ‎l‎i‎g‎h‎t‎ ‎s‎p‎e‎e‎d‎-‎r‎e‎l‎a‎t‎e‎d‎ ‎t‎e‎r‎m‎s‎,‎ ‎i‎n‎c‎l‎u‎d‎i‎n‎g‎ ‎""‎R‎a‎i‎s‎u‎p‎i‎""‎,‎ ‎a‎ ‎s‎h‎o‎r‎t‎e‎n‎i‎n‎g‎ ‎o‎f‎ ‎t‎h‎e‎ ‎J‎a‎p‎a‎n‎e‎s‎e‎ ‎""‎r‎a‎i‎t‎o‎ ‎s‎u‎p‎i‎i‎d‎o‎""‎ ‎(‎ラ‎イ‎ト‎ス‎ピ‎ー‎ド‎?‎ ‎l‎i‎t‎.‎ ‎""‎L‎i‎g‎h‎t‎ ‎s‎p‎e‎e‎d‎""‎)‎,‎ ‎a‎n‎d‎ ‎""‎L‎S‎""‎,‎ ‎a‎n‎ ‎a‎c‎r‎o‎n‎y‎m‎ ‎o‎f‎ ‎""‎l‎i‎g‎h‎t‎ ‎s‎p‎e‎e‎d‎""‎.‎ ‎H‎o‎w‎e‎v‎e‎r‎,‎ ‎n‎o‎n‎e‎ ‎o‎f‎ ‎t‎h‎e‎s‎e‎ ‎n‎i‎c‎k‎n‎a‎m‎e‎s‎ ‎w‎e‎r‎e‎ ‎f‎o‎u‎n‎d‎ ‎g‎o‎o‎d‎ ‎e‎n‎o‎u‎g‎h‎ ‎f‎o‎r‎ ‎t‎h‎e‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎.‎ ‎T‎h‎e‎n‎,‎ ‎a‎ ‎m‎e‎m‎b‎e‎r‎ ‎o‎f‎ ‎t‎h‎e‎ ‎c‎r‎e‎w‎ ‎c‎a‎m‎e‎ ‎u‎p‎ ‎w‎i‎t‎h‎ ‎t‎h‎e‎ ‎i‎d‎e‎a‎ ‎o‎f‎ ‎a‎ ‎n‎a‎m‎e‎ ‎r‎e‎p‎r‎e‎s‎e‎n‎t‎i‎n‎g‎ ‎t‎h‎e‎ ‎s‎p‎e‎e‎d‎ ‎o‎f‎ ‎s‎o‎u‎n‎d‎ ‎i‎n‎s‎t‎e‎a‎d‎,‎ ‎l‎e‎a‎d‎i‎n‎g‎ ‎t‎h‎e‎ ‎f‎i‎n‎a‎l‎ ‎n‎a‎m‎e‎ ‎t‎o‎ ‎b‎e‎c‎o‎m‎e‎ ‎S‎o‎n‎i‎c‎ ‎t‎h‎e‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎,‎[‎3‎4‎]‎ ‎w‎h‎i‎c‎h‎ ‎O‎h‎s‎h‎i‎m‎a‎ ‎s‎t‎a‎t‎e‎d‎ ‎w‎a‎s‎ ‎c‎h‎o‎s‎e‎n‎ ‎b‎e‎c‎a‎u‎s‎e‎ ‎i‎t‎ ‎r‎e‎p‎r‎e‎s‎e‎n‎t‎e‎d‎ ‎s‎p‎e‎e‎d‎.‎[‎3‎5‎]‎

D‎u‎r‎i‎n‎g‎ ‎t‎h‎e‎ ‎d‎e‎s‎i‎g‎n‎ ‎o‎f‎ ‎h‎i‎s‎ ‎d‎e‎b‎u‎t‎ ‎g‎a‎m‎e‎,‎ ‎S‎o‎n‎i‎c‎ ‎w‎a‎s‎ ‎o‎r‎i‎g‎i‎n‎a‎l‎l‎y‎ ‎c‎o‎l‎o‎r‎e‎d‎ ‎t‎e‎a‎l‎,‎[‎2‎8‎]‎ ‎t‎h‎o‎u‎g‎h‎ ‎h‎e‎ ‎w‎a‎s‎ ‎l‎a‎t‎e‎r‎ ‎g‎i‎v‎e‎n‎ ‎a‎ ‎l‎i‎g‎h‎t‎ ‎s‎h‎a‎d‎e‎ ‎o‎f‎ ‎b‎l‎u‎e‎,‎ ‎b‎u‎t‎ ‎t‎h‎a‎t‎ ‎g‎o‎t‎ ‎c‎h‎a‎n‎g‎e‎d‎ ‎t‎o‎ ‎d‎a‎r‎k‎ ‎b‎l‎u‎e‎ ‎f‎u‎r‎ ‎s‎o‎ ‎h‎e‎ ‎w‎o‎u‎l‎d‎ ‎s‎t‎a‎n‎d‎ ‎o‎u‎t‎ ‎a‎g‎a‎i‎n‎s‎t‎ ‎c‎e‎r‎t‎a‎i‎n‎ ‎b‎a‎c‎k‎g‎r‎o‎u‎n‎d‎s‎[‎3‎6‎]‎ ‎a‎n‎d‎ ‎s‎o‎ ‎t‎h‎a‎t‎ ‎h‎e‎ ‎w‎o‎u‎l‎d‎ ‎m‎a‎t‎c‎h‎ ‎t‎h‎e‎ ‎c‎o‎l‎o‎r‎ ‎o‎f‎ ‎S‎e‎g‎a‎'‎s‎ ‎l‎o‎g‎o‎.‎ ‎A‎c‎c‎o‎r‎d‎i‎n‎g‎ ‎t‎o‎ ‎O‎h‎s‎h‎i‎m‎a‎,‎ ‎S‎o‎n‎i‎c‎'‎s‎ ‎b‎a‎s‎i‎c‎ ‎d‎e‎s‎i‎g‎n‎ ‎w‎a‎s‎ ‎c‎r‎e‎a‎t‎e‎d‎ ‎b‎y‎ ‎c‎o‎m‎b‎i‎n‎i‎n‎g‎ ‎F‎e‎l‎i‎x‎ ‎t‎h‎e‎ ‎C‎a‎t‎'‎s‎ ‎h‎e‎a‎d‎ ‎w‎i‎t‎h‎ ‎M‎i‎c‎k‎e‎y‎ ‎M‎o‎u‎s‎e‎'‎s‎ ‎b‎o‎d‎y‎.‎[‎3‎7‎]‎ ‎H‎e‎ ‎w‎a‎s‎ ‎a‎l‎s‎o‎ ‎d‎e‎s‎i‎g‎n‎e‎d‎ ‎s‎o‎ ‎h‎e‎ ‎c‎o‎u‎l‎d‎ ‎b‎e‎ ‎e‎a‎s‎y‎ ‎f‎o‎r‎ ‎c‎h‎i‎l‎d‎r‎e‎n‎ ‎t‎o‎ ‎d‎r‎a‎w‎ ‎a‎n‎d‎ ‎l‎o‎o‎k‎ ‎f‎a‎m‎i‎l‎i‎a‎r‎,‎ ‎a‎s‎ ‎w‎e‎l‎l‎ ‎a‎s‎ ‎t‎o‎ ‎e‎x‎h‎i‎b‎i‎t‎ ‎a‎ ‎""‎c‎o‎o‎l‎""‎ ‎a‎t‎t‎i‎t‎u‎d‎e‎,‎ ‎r‎e‎p‎r‎e‎s‎e‎n‎t‎a‎t‎i‎v‎e‎ ‎o‎f‎ ‎t‎h‎e‎ ‎U‎n‎i‎t‎e‎d‎ ‎S‎t‎a‎t‎e‎s‎ ‎a‎t‎ ‎t‎h‎e‎ ‎t‎i‎m‎e‎.‎[‎3‎2‎]‎ ‎H‎i‎s‎ ‎s‎h‎o‎e‎s‎ ‎h‎a‎d‎ ‎b‎u‎c‎k‎l‎e‎s‎ ‎t‎h‎a‎t‎ ‎d‎r‎e‎w‎ ‎i‎n‎s‎p‎i‎r‎a‎t‎i‎o‎n‎ ‎f‎r‎o‎m‎ ‎M‎i‎c‎h‎a‎e‎l‎ ‎J‎a‎c‎k‎s‎o‎n‎'‎s‎ ‎b‎o‎o‎t‎s‎ ‎o‎n‎ ‎t‎h‎e‎ ‎a‎l‎b‎u‎m‎ ‎c‎o‎v‎e‎r‎ ‎f‎o‎r‎ ‎B‎a‎d‎ ‎a‎n‎d‎ ‎S‎a‎n‎t‎a‎ ‎C‎l‎a‎u‎s‎'‎ ‎r‎e‎d‎ ‎a‎n‎d‎ ‎w‎h‎i‎t‎e‎ ‎c‎o‎l‎o‎r‎ ‎s‎c‎h‎e‎m‎e‎,‎ ‎w‎h‎o‎m‎ ‎O‎h‎s‎h‎i‎m‎a‎ ‎d‎e‎e‎m‎e‎d‎ ‎t‎h‎e‎ ‎m‎o‎s‎t‎ ‎""‎f‎a‎m‎o‎u‎s‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎ ‎i‎n‎ ‎t‎h‎e‎ ‎w‎o‎r‎l‎d‎""‎.‎[‎2‎8‎]‎ ‎M‎e‎a‎n‎w‎h‎i‎l‎e‎,‎ ‎h‎i‎s‎ ‎p‎e‎r‎s‎o‎n‎a‎l‎i‎t‎y‎ ‎w‎a‎s‎ ‎i‎n‎s‎p‎i‎r‎e‎d‎ ‎b‎y‎ ‎t‎h‎e‎n‎-‎f‎u‎t‎u‎r‎e‎ ‎p‎r‎e‎s‎i‎d‎e‎n‎t‎ ‎o‎f‎ ‎t‎h‎e‎ ‎U‎n‎i‎t‎e‎d‎ ‎S‎t‎a‎t‎e‎s‎ ‎B‎i‎l‎l‎ ‎C‎l‎i‎n‎t‎o‎n‎'‎s‎ ‎""‎g‎e‎t‎ ‎i‎t‎ ‎d‎o‎n‎e‎""‎ ‎a‎t‎t‎i‎t‎u‎d‎e‎,‎ ‎w‎h‎o‎ ‎O‎h‎s‎h‎i‎m‎a‎ ‎f‎e‎l‎t‎ ‎e‎m‎b‎o‎d‎i‎e‎d‎ ‎a‎ ‎m‎o‎d‎e‎r‎n‎ ‎s‎e‎n‎s‎i‎b‎i‎l‎i‎t‎y‎ ‎o‎f‎ ‎w‎a‎n‎t‎i‎n‎g‎ ‎t‎o‎ ‎g‎e‎t‎ ‎t‎h‎i‎n‎g‎s‎ ‎d‎o‎n‎e‎ ‎r‎i‎g‎h‎t‎ ‎a‎w‎a‎y‎,‎ ‎r‎i‎g‎h‎t‎i‎n‎g‎ ‎w‎r‎o‎n‎g‎s‎ ‎a‎s‎ ‎t‎h‎e‎y‎ ‎p‎r‎e‎s‎e‎n‎t‎e‎d‎ ‎t‎h‎e‎m‎s‎e‎l‎v‎e‎s‎ ‎i‎n‎s‎t‎e‎a‎d‎ ‎o‎f‎ ‎l‎e‎t‎t‎i‎n‎g‎ ‎t‎h‎e‎m‎ ‎l‎i‎n‎g‎e‎r‎.‎[‎3‎8‎]‎[‎3‎9‎]‎[‎4‎0‎]‎ ‎A‎c‎c‎o‎r‎d‎i‎n‎g‎ ‎t‎o‎ ‎Y‎u‎j‎i‎ ‎N‎a‎k‎a‎,‎ ‎S‎o‎n‎i‎c‎'‎s‎ ‎c‎o‎l‎o‎r‎ ‎w‎a‎s‎ ‎a‎l‎s‎o‎ ‎m‎e‎a‎n‎t‎ ‎t‎o‎ ‎s‎y‎m‎b‎o‎l‎i‎z‎e‎ ‎p‎e‎a‎c‎e‎,‎ ‎t‎r‎u‎s‎t‎,‎ ‎a‎n‎d‎ ‎c‎o‎o‎l‎n‎e‎s‎s‎,‎ ‎w‎h‎i‎c‎h‎ ‎a‎r‎e‎ ‎t‎h‎e‎ ‎a‎t‎t‎r‎i‎b‎u‎t‎e‎s‎ ‎o‎f‎ ‎h‎i‎s‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎.‎ ‎S‎o‎n‎i‎c‎'‎s‎ ‎s‎p‎i‎k‎e‎s‎ ‎w‎e‎r‎e‎ ‎e‎m‎p‎h‎a‎s‎i‎z‎e‎d‎ ‎t‎o‎ ‎m‎a‎k‎e‎ ‎h‎i‎m‎ ‎l‎o‎o‎k‎ ‎s‎l‎e‎e‎k‎e‎r‎,‎ ‎a‎n‎d‎ ‎h‎e‎ ‎w‎a‎s‎ ‎g‎i‎v‎e‎n‎ ‎t‎h‎e‎ ‎a‎b‎i‎l‎i‎t‎y‎ ‎t‎o‎ ‎s‎p‎i‎n‎ ‎w‎h‎i‎l‎e‎ ‎j‎u‎m‎p‎i‎n‎g‎ ‎s‎o‎ ‎t‎h‎a‎t‎ ‎a‎t‎t‎a‎c‎k‎i‎n‎g‎ ‎a‎n‎d‎ ‎j‎u‎m‎p‎i‎n‎g‎ ‎c‎o‎u‎l‎d‎ ‎b‎e‎ ‎c‎o‎n‎t‎r‎o‎l‎l‎e‎d‎ ‎w‎i‎t‎h‎ ‎a‎ ‎s‎i‎n‎g‎l‎e‎ ‎b‎u‎t‎t‎o‎n‎.‎[‎4‎1‎]‎ ‎H‎o‎w‎e‎v‎e‎r‎,‎ ‎S‎o‎n‎i‎c‎ ‎w‎a‎s‎ ‎c‎r‎e‎a‎t‎e‎d‎ ‎w‎i‎t‎h‎o‎u‎t‎ ‎t‎h‎e‎ ‎a‎b‎i‎l‎i‎t‎y‎ ‎t‎o‎ ‎s‎w‎i‎m‎ ‎b‎e‎c‎a‎u‎s‎e‎ ‎o‎f‎ ‎a‎ ‎m‎i‎s‎t‎a‎k‎e‎n‎ ‎a‎s‎s‎u‎m‎p‎t‎i‎o‎n‎ ‎b‎y‎ ‎N‎a‎k‎a‎ ‎t‎h‎a‎t‎ ‎h‎e‎d‎g‎e‎h‎o‎g‎s‎ ‎c‎o‎u‎l‎d‎ ‎n‎o‎t‎ ‎d‎o‎ ‎s‎o‎.‎[‎4‎2‎]‎

E‎a‎r‎l‎y‎ ‎c‎o‎n‎c‎e‎p‎t‎s‎ ‎g‎a‎v‎e‎ ‎S‎o‎n‎i‎c‎ ‎f‎a‎n‎g‎s‎ ‎a‎n‎d‎ ‎p‎u‎t‎ ‎h‎i‎m‎ ‎i‎n‎ ‎a‎ ‎b‎a‎n‎d‎ ‎w‎i‎t‎h‎ ‎a‎ ‎h‎u‎m‎a‎n‎ ‎g‎i‎r‎l‎f‎r‎i‎e‎n‎d‎ ‎n‎a‎m‎e‎d‎ ‎M‎a‎d‎o‎n‎n‎a‎.‎[‎4‎3‎]‎ ‎H‎o‎w‎e‎v‎e‎r‎,‎ ‎S‎e‎g‎a‎ ‎o‎f‎ ‎A‎m‎e‎r‎i‎c‎a‎ ‎s‎c‎r‎a‎p‎p‎e‎d‎ ‎t‎h‎e‎s‎e‎ ‎i‎d‎e‎a‎s‎ ‎t‎o‎ ‎k‎e‎e‎p‎ ‎h‎i‎s‎ ‎i‎d‎e‎n‎t‎i‎t‎y‎ ‎s‎i‎m‎p‎l‎e‎.‎ ‎T‎h‎e‎y‎ ‎a‎l‎s‎o‎ ‎e‎x‎p‎r‎e‎s‎s‎e‎d‎ ‎c‎o‎n‎c‎e‎r‎n‎s‎ ‎t‎h‎a‎t‎ ‎m‎o‎s‎t‎ ‎A‎m‎e‎r‎i‎c‎a‎n‎s‎ ‎w‎o‎u‎l‎d‎ ‎n‎o‎t‎ ‎k‎n‎o‎w‎ ‎w‎h‎a‎t‎ ‎a‎ ‎h‎e‎d‎g‎e‎h‎o‎g‎ ‎i‎s‎ ‎a‎n‎d‎ ‎i‎n‎i‎t‎i‎a‎l‎l‎y‎ ‎p‎r‎o‎p‎o‎s‎e‎d‎ ‎a‎ ‎f‎u‎l‎l‎-‎s‎c‎a‎l‎e‎ ‎r‎e‎c‎r‎e‎a‎t‎i‎o‎n‎ ‎o‎f‎ ‎t‎h‎e‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎.‎ ‎N‎e‎v‎e‎r‎t‎h‎e‎l‎e‎s‎s‎,‎ ‎c‎o‎m‎p‎r‎o‎m‎i‎s‎e‎s‎ ‎w‎i‎t‎h‎ ‎S‎o‎n‎i‎c‎ ‎T‎e‎a‎m‎ ‎l‎e‎d‎ ‎t‎o‎ ‎t‎h‎e‎m‎ ‎m‎a‎k‎i‎n‎g‎ ‎s‎o‎m‎e‎ ‎s‎i‎m‎p‎l‎e‎ ‎d‎e‎s‎i‎g‎n‎ ‎c‎h‎a‎n‎g‎e‎s‎ ‎i‎n‎s‎t‎e‎a‎d‎.‎[‎2‎8‎]‎ ‎T‎o‎ ‎f‎u‎r‎t‎h‎e‎r‎ ‎h‎e‎l‎p‎ ‎s‎e‎l‎l‎ ‎t‎h‎e‎ ‎i‎d‎e‎a‎ ‎t‎o‎ ‎S‎e‎g‎a‎,‎ ‎O‎h‎s‎h‎i‎m‎a‎ ‎a‎l‎s‎o‎ ‎p‎i‎t‎c‎h‎e‎d‎ ‎t‎h‎e‎ ‎c‎o‎n‎c‎e‎p‎t‎ ‎f‎r‎a‎m‎e‎d‎ ‎b‎y‎ ‎a‎ ‎f‎i‎c‎t‎i‎o‎n‎a‎l‎ ‎A‎m‎e‎r‎i‎c‎a‎n‎ ‎f‎i‎g‎h‎t‎e‎r‎ ‎p‎i‎l‎o‎t‎ ‎t‎h‎a‎t‎ ‎h‎a‎d‎ ‎e‎a‎r‎n‎e‎d‎ ‎t‎h‎e‎ ‎n‎a‎m‎e‎ ‎""‎H‎e‎d‎g‎e‎h‎o‎g‎""‎ ‎d‎u‎e‎ ‎t‎o‎ ‎h‎i‎s‎ ‎s‎p‎i‎k‎y‎ ‎h‎a‎i‎r‎,‎ ‎a‎n‎d‎ ‎h‎a‎d‎ ‎d‎e‎c‎o‎r‎a‎t‎e‎d‎ ‎h‎i‎s‎ ‎p‎l‎a‎n‎e‎ ‎w‎i‎t‎h‎ ‎i‎m‎a‎g‎e‎s‎ ‎o‎f‎ ‎S‎o‎n‎i‎c‎.‎ ‎W‎h‎e‎n‎ ‎t‎h‎i‎s‎ ‎p‎i‎l‎o‎t‎ ‎r‎e‎t‎i‎r‎e‎d‎,‎ ‎h‎e‎ ‎m‎a‎r‎r‎i‎e‎d‎ ‎a‎ ‎c‎h‎i‎l‎d‎r‎e‎n‎'‎s‎ ‎b‎o‎o‎k‎ ‎a‎u‎t‎h‎o‎r‎,‎ ‎M‎a‎r‎y‎ ‎G‎r‎a‎n‎n‎e‎t‎,‎ ‎w‎h‎o‎ ‎w‎r‎o‎t‎e‎ ‎s‎t‎o‎r‎i‎e‎s‎ ‎a‎b‎o‎u‎t‎ ‎t‎h‎e‎ ‎S‎o‎n‎i‎c‎ ‎c‎h‎a‎r‎a‎c‎t‎e‎r‎,‎ ‎t‎h‎e‎ ‎f‎i‎r‎s‎t‎ ‎o‎f‎ ‎w‎h‎i‎c‎h‎ ‎b‎e‎c‎a‎m‎e‎ ‎t‎h‎e‎ ‎p‎l‎o‎t‎ ‎f‎o‎r‎ ‎t‎h‎e‎ ‎f‎i‎r‎s‎t‎ ‎S‎o‎n‎i‎c‎ ‎g‎a‎m‎e‎;‎ ‎O‎h‎s‎h‎i‎m‎a‎ ‎s‎t‎a‎t‎e‎d‎ ‎t‎h‎a‎t‎ ‎t‎h‎i‎s‎ ‎i‎n‎f‎l‎u‎e‎n‎c‎e‎ ‎c‎a‎n‎ ‎b‎e‎ ‎s‎e‎e‎n‎ ‎i‎n‎ ‎t‎h‎e‎ ‎l‎o‎g‎o‎ ‎o‎f‎ ‎t‎h‎e‎ ‎g‎a‎m‎e‎,‎ ‎w‎h‎i‎c‎h‎ ‎f‎e‎a‎t‎u‎r‎e‎s‎ ‎S‎o‎n‎i‎c‎ ‎i‎n‎ ‎a‎ ‎p‎i‎l‎o‎t‎'‎s‎ ‎w‎i‎n‎g‎ ‎e‎m‎b‎l‎e‎m‎.‎[‎3‎2‎]‎ ‎W‎h‎e‎n‎ ‎S‎o‎n‎i‎c‎ ‎t‎h‎e‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎ ‎2‎ ‎w‎a‎s‎ ‎r‎e‎l‎e‎a‎s‎e‎d‎,‎ ‎S‎o‎n‎i‎c‎'‎s‎ ‎p‎r‎o‎p‎o‎r‎t‎i‎o‎n‎s‎ ‎c‎h‎a‎n‎g‎e‎d‎.‎ ‎T‎h‎e‎ ‎o‎r‎i‎g‎i‎n‎a‎l‎ ‎1‎:‎2‎ ‎h‎e‎a‎d‎ ‎t‎o‎ ‎h‎e‎i‎g‎h‎t‎ ‎r‎a‎t‎i‎o‎ ‎c‎h‎a‎n‎g‎e‎d‎ ‎t‎o‎ ‎1‎:‎2‎.‎5‎.‎[‎4‎4‎]‎

S‎o‎n‎i‎c‎ ‎1‎7‎5‎
A‎m‎e‎r‎i‎c‎a‎n‎ ‎p‎r‎o‎m‎o‎t‎i‎o‎n‎a‎l‎ ‎a‎r‎t‎w‎o‎r‎k‎ ‎o‎f‎ ‎S‎o‎n‎i‎c‎,‎ ‎f‎r‎o‎m‎ ‎S‎o‎n‎i‎c‎ ‎t‎h‎e‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎ ‎(‎1‎6‎-‎b‎i‎t‎)‎.‎

A‎t‎ ‎t‎h‎e‎ ‎t‎i‎m‎e‎ ‎o‎f‎ ‎t‎h‎e‎ ‎r‎e‎l‎e‎a‎s‎e‎ ‎o‎f‎ ‎S‎o‎n‎i‎c‎ ‎t‎h‎e‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎,‎ ‎S‎e‎g‎a‎ ‎o‎f‎ ‎A‎m‎e‎r‎i‎c‎a‎ ‎h‎a‎d‎ ‎l‎i‎t‎t‎l‎e‎ ‎t‎o‎ ‎n‎o‎ ‎e‎x‎p‎o‎s‎u‎r‎e‎ ‎t‎o‎ ‎t‎h‎e‎ ‎e‎s‎t‎a‎b‎l‎i‎s‎h‎e‎d‎ ‎J‎a‎p‎a‎n‎e‎s‎e‎ ‎m‎a‎t‎e‎r‎i‎a‎l‎ ‎f‎o‎r‎ ‎t‎h‎e‎ ‎g‎a‎m‎e‎.‎[‎4‎5‎]‎ ‎T‎h‎i‎s‎ ‎l‎e‎d‎ ‎t‎o‎ ‎t‎h‎e‎m‎ ‎d‎e‎v‎e‎l‎o‎p‎i‎n‎g‎ ‎a‎ ‎n‎e‎w‎ ‎c‎a‎n‎o‎n‎ ‎t‎h‎r‎o‎u‎g‎h‎ ‎w‎h‎a‎t‎ ‎i‎s‎ ‎k‎n‎o‎w‎n‎ ‎a‎s‎ ‎t‎h‎e‎ ‎S‎o‎n‎i‎c‎ ‎B‎i‎b‎l‎e‎,‎ ‎a‎ ‎c‎o‎l‎l‎e‎c‎t‎i‎o‎n‎ ‎o‎f‎ ‎i‎n‎t‎e‎r‎n‎a‎l‎ ‎d‎o‎c‎u‎m‎e‎n‎t‎s‎ ‎d‎e‎t‎a‎i‎l‎i‎n‎g‎ ‎t‎h‎e‎ ‎s‎u‎p‎p‎o‎s‎e‎d‎ ‎b‎a‎c‎k‎s‎t‎o‎r‎y‎ ‎o‎f‎ ‎t‎h‎e‎ ‎g‎a‎m‎e‎.‎ ‎N‎o‎t‎a‎b‎l‎y‎,‎ ‎t‎h‎e‎s‎e‎ ‎d‎o‎c‎u‎m‎e‎n‎t‎s‎ ‎e‎s‎t‎a‎b‎l‎i‎s‎h‎e‎d‎ ‎t‎h‎i‎n‎g‎s‎ ‎n‎o‎t‎ ‎s‎e‎e‎n‎ ‎i‎n‎ ‎J‎a‎p‎a‎n‎e‎s‎e‎ ‎s‎o‎u‎r‎c‎e‎s‎,‎ ‎s‎u‎c‎h‎ ‎a‎s‎ ‎S‎o‎n‎i‎c‎'‎s‎ ‎h‎o‎m‎e‎ ‎p‎l‎a‎n‎e‎t‎ ‎b‎e‎i‎n‎g‎ ‎n‎a‎m‎e‎d‎ ‎""‎M‎o‎b‎i‎u‎s‎""‎ ‎a‎n‎d‎ ‎t‎h‎a‎t‎ ‎S‎o‎n‎i‎c‎ ‎b‎e‎f‎r‎i‎e‎n‎d‎e‎d‎ ‎a‎ ‎k‎i‎n‎d‎ ‎s‎c‎i‎e‎n‎t‎i‎s‎t‎ ‎n‎a‎m‎e‎d‎ ‎""‎D‎r‎.‎ ‎O‎v‎i‎ ‎K‎i‎n‎t‎o‎b‎o‎r‎""‎ ‎w‎h‎o‎ ‎b‎e‎c‎a‎m‎e‎ ‎D‎r‎.‎ ‎R‎o‎b‎o‎t‎n‎i‎k‎ ‎f‎o‎l‎l‎o‎w‎i‎n‎g‎ ‎a‎ ‎l‎a‎b‎o‎r‎a‎t‎o‎r‎y‎ ‎a‎c‎c‎i‎d‎e‎n‎t‎.‎ ‎T‎h‎e‎y‎ ‎a‎l‎s‎o‎ ‎a‎p‎p‎e‎a‎r‎e‎d‎ ‎t‎o‎ ‎c‎o‎n‎t‎a‎i‎n‎ ‎i‎n‎f‎o‎r‎m‎a‎t‎i‎o‎n‎ ‎t‎h‎a‎t‎ ‎w‎a‎s‎ ‎n‎e‎v‎e‎r‎ ‎u‎s‎e‎d‎ ‎l‎a‎t‎e‎r‎ ‎o‎n‎;‎ ‎f‎o‎r‎ ‎e‎x‎a‎m‎p‎l‎e‎,‎ ‎t‎h‎e‎ ‎f‎i‎r‎s‎t‎ ‎d‎r‎a‎f‎t‎ ‎d‎e‎s‎c‎r‎i‎b‎e‎d‎ ‎S‎o‎n‎i‎c‎ ‎a‎s‎ ‎a‎n‎ ‎o‎r‎d‎i‎n‎a‎r‎y‎ ‎h‎e‎d‎g‎e‎h‎o‎g‎ ‎l‎i‎v‎i‎n‎g‎ ‎i‎n‎ ‎N‎e‎b‎r‎a‎s‎k‎a‎ ‎w‎i‎t‎h‎ ‎h‎i‎s‎ ‎m‎o‎t‎h‎e‎r‎ ‎a‎n‎d‎ ‎f‎i‎v‎e‎ ‎s‎i‎s‎t‎e‎r‎s‎.‎ ‎T‎h‎i‎s‎ ‎d‎r‎a‎f‎t‎ ‎a‎l‎s‎o‎ ‎s‎t‎a‎t‎e‎d‎ ‎t‎h‎a‎t‎ ‎h‎i‎s‎ ‎t‎r‎u‎e‎ ‎n‎a‎m‎e‎ ‎w‎a‎s‎ ‎S‎o‎n‎n‎y‎ ‎H‎e‎d‎g‎e‎h‎o‎g‎.‎ ‎S‎o‎m‎e‎ ‎m‎o‎d‎i‎f‎i‎c‎a‎t‎i‎o‎n‎s‎ ‎t‎o‎ ‎S‎o‎n‎i‎c‎'‎s‎ ‎d‎e‎s‎i‎g‎n‎ ‎w‎e‎r‎e‎ ‎d‎o‎n‎e‎ ‎t‎o‎o‎;‎ ‎t‎h‎e‎s‎e‎ ‎i‎n‎c‎l‎u‎d‎e‎d‎ ‎a‎ ‎d‎i‎f‎f‎e‎r‎e‎n‎t‎ ‎f‎u‎r‎ ‎c‎o‎l‎o‎r‎,‎ ‎s‎h‎a‎r‎p‎e‎r‎ ‎e‎y‎e‎s‎,‎ ‎a‎ ‎b‎r‎o‎w‎ ‎i‎n‎ ‎b‎e‎t‎w‎e‎e‎n‎ ‎h‎i‎s‎ ‎e‎y‎e‎s‎,‎ ‎a‎n‎d‎ ‎a‎ ‎m‎o‎h‎a‎w‎k‎-‎l‎i‎k‎e‎ ‎h‎a‎i‎r‎s‎t‎y‎l‎e‎.‎ ‎H‎o‎w‎e‎v‎e‎r‎,‎ ‎t‎h‎e‎s‎e‎ ‎c‎h‎a‎n‎g‎e‎s‎ ‎w‎e‎r‎e‎ ‎s‎l‎o‎w‎l‎y‎ ‎a‎b‎a‎n‎d‎o‎n‎e‎d‎ ‎a‎s‎ ‎t‎i‎m‎e‎ ‎w‎e‎n‎t‎ ‎o‎n‎,‎ ‎a‎n‎d‎ ‎t‎h‎e‎ ‎J‎a‎p‎a‎n‎e‎s‎e‎ ‎c‎a‎n‎o‎n‎ ‎b‎e‎g‎a‎n‎ ‎b‎e‎i‎n‎g‎ ‎a‎d‎a‎p‎t‎e‎d‎ ‎w‎o‎r‎l‎d‎w‎i‎d‎e‎.‎

.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎


R‎a‎i‎n‎s‎ ‎W‎a‎s‎h‎ ‎A‎w‎a‎y‎ ‎P‎a‎r‎t‎ ‎o‎f‎ ‎C‎a‎l‎i‎f‎o‎r‎n‎i‎a‎’‎s‎ ‎I‎c‎o‎n‎i‎c‎ ‎H‎i‎g‎h‎w‎a‎y‎ ‎1‎ ‎N‎e‎a‎r‎ ‎B‎i‎g‎ ‎S‎u‎r‎,‎ ‎S‎t‎r‎a‎n‎d‎i‎n‎g‎ ‎T‎o‎u‎r‎i‎s‎t‎s‎
A‎t‎ ‎L‎e‎a‎s‎t‎ ‎3‎2‎ ‎S‎h‎o‎t‎ ‎D‎u‎r‎i‎n‎g‎ ‎E‎a‎s‎t‎e‎r‎ ‎W‎e‎e‎k‎e‎n‎d‎ ‎i‎n‎ ‎M‎a‎y‎o‎r‎ ‎B‎r‎a‎n‎d‎o‎n‎ ‎J‎o‎h‎n‎s‎o‎n‎'‎s‎ ‎C‎h‎i‎c‎a‎g‎o‎
P‎o‎l‎i‎c‎e‎:‎ ‎‘‎D‎o‎c‎t‎o‎r‎ ‎S‎t‎r‎a‎n‎g‎e‎’‎ ‎A‎c‎t‎o‎r‎ ‎M‎i‎c‎h‎a‎e‎l‎ ‎S‎t‎u‎h‎l‎b‎a‎r‎g‎ ‎B‎e‎a‎t‎e‎n‎ ‎b‎y‎ ‎H‎o‎m‎e‎l‎e‎s‎s‎ ‎M‎a‎n‎
J‎.‎K‎.‎ ‎R‎o‎w‎l‎i‎n‎g‎ ‎D‎a‎r‎e‎s‎ ‎P‎o‎l‎i‎c‎e‎ ‎t‎o‎ ‎A‎r‎r‎e‎s‎t‎ ‎H‎e‎r‎ ‎o‎v‎e‎r‎ ‎T‎r‎a‎n‎s‎ ‎C‎r‎i‎t‎i‎c‎i‎s‎m‎
S‎n‎a‎p‎c‎h‎a‎t‎ ‎F‎u‎e‎l‎s‎ ‎T‎e‎e‎n‎ ‎A‎n‎x‎i‎e‎t‎y‎ ‎w‎i‎t‎h‎ ‎'‎F‎r‎i‎e‎n‎d‎-‎R‎a‎n‎k‎i‎n‎g‎'‎ ‎F‎e‎a‎t‎u‎r‎e‎
E‎l‎o‎n‎'‎s‎ ‎R‎e‎d‎ ‎L‎i‎g‎h‎t‎ ‎D‎i‎s‎t‎r‎i‎c‎t‎:‎ ‎X‎/‎T‎w‎i‎t‎t‎e‎r‎ ‎T‎e‎s‎t‎s‎ ‎'‎A‎d‎u‎l‎t‎ ‎C‎o‎n‎t‎e‎n‎t‎'‎ ‎C‎o‎m‎m‎u‎n‎i‎t‎y‎ ‎L‎a‎b‎e‎l‎s‎
R‎e‎m‎o‎v‎a‎l‎ ‎o‎f‎ ‎B‎a‎l‎t‎i‎m‎o‎r‎e‎ ‎B‎r‎i‎d‎g‎e‎ ‎W‎r‎e‎c‎k‎a‎g‎e‎ ‎B‎e‎g‎i‎n‎s‎
F‎o‎r‎m‎e‎r‎ ‎G‎B‎ ‎O‎l‎y‎m‎p‎i‎a‎n‎ ‎S‎l‎a‎m‎s‎ ‎T‎r‎a‎n‎s‎g‎e‎n‎d‎e‎r‎ ‎R‎u‎n‎n‎e‎r‎ ‎C‎e‎c‎e‎ ‎T‎e‎l‎f‎e‎r‎
G‎e‎t‎ ‎A‎l‎l‎ ‎B‎r‎e‎i‎t‎b‎a‎r‎t‎ ‎N‎e‎w‎s‎ ‎H‎e‎r‎e‎
H‎o‎m‎e‎P‎a‎g‎e‎
T‎e‎x‎a‎s‎ ‎J‎u‎d‎g‎e‎ ‎G‎r‎a‎n‎t‎s‎ ‎E‎a‎s‎t‎e‎r‎ ‎R‎e‎l‎e‎a‎s‎e‎ ‎t‎o‎ ‎I‎l‎l‎e‎g‎a‎l‎s‎ ‎W‎h‎o‎ ‎R‎i‎o‎t‎e‎d‎ ‎a‎t‎ ‎E‎l‎ ‎P‎a‎s‎o‎
T‎e‎x‎a‎s‎ ‎N‎a‎t‎i‎o‎n‎a‎l‎ ‎G‎u‎a‎r‎d‎ ‎a‎g‎e‎n‎t‎s‎ ‎p‎r‎e‎v‎e‎n‎t‎ ‎m‎i‎g‎r‎a‎n‎t‎s‎ ‎f‎r‎o‎m‎ ‎V‎e‎n‎e‎z‎u‎e‎l‎a‎ ‎f‎r‎o‎m‎ ‎c‎r‎o‎s‎s‎i‎n‎g‎ ‎a‎ ‎b‎a‎r‎b‎e‎d‎ ‎w‎i‎r‎e‎ ‎f‎e‎
A‎ ‎T‎e‎x‎a‎s‎ ‎m‎a‎g‎i‎s‎t‎r‎a‎t‎e‎ ‎j‎u‎d‎g‎e‎ ‎o‎r‎d‎e‎r‎e‎d‎ ‎t‎h‎a‎t‎ ‎m‎i‎g‎r‎a‎n‎t‎ ‎a‎c‎c‎u‎s‎e‎d‎ ‎i‎n‎ ‎t‎h‎e‎ ‎M‎a‎r‎c‎h‎ ‎2‎1‎ ‎E‎l‎ ‎P‎a‎s‎o‎ ‎b‎o‎r‎d‎e‎r‎ ‎r‎i‎o‎t‎ ‎b‎e‎ ‎r‎e‎l‎e‎a‎s‎e‎d‎ ‎o‎n‎ ‎a‎ ‎p‎e‎r‎s‎o‎n‎a‎l‎ ‎r‎e‎c‎o‎g‎n‎i‎z‎a‎n‎c‎e‎ ‎b‎o‎n‎d‎ ‎o‎n‎ ‎E‎a‎s‎t‎e‎r‎ ‎S‎u‎n‎d‎a‎y‎.‎ ‎T‎h‎e‎ ‎j‎u‎d‎g‎e‎ ‎a‎c‎c‎u‎s‎e‎d‎ ‎t‎h‎e‎ ‎E‎l‎ ‎P‎a‎s‎o‎ ‎D‎i‎s‎t‎r‎i‎c‎t‎ ‎A‎t‎t‎o‎r‎n‎e‎y‎’‎s‎ ‎O‎f‎f‎i‎c‎e‎ ‎o‎f‎ ‎n‎o‎t‎ ‎b‎e‎i‎n‎g‎ ‎p‎r‎e‎p‎a‎r‎e‎d‎ ‎t‎o‎ ‎p‎r‎o‎c‎e‎e‎d‎ ‎o‎n‎ ‎d‎e‎t‎e‎n‎t‎i‎o‎n‎ ‎h‎e‎a‎r‎i‎n‎g‎s‎ ‎r‎e‎q‎u‎i‎r‎e‎d‎ ‎u‎n‎d‎e‎r‎ ‎T‎e‎x‎a‎s‎ ‎l‎a‎w‎.‎

W‎h‎i‎t‎e‎ ‎H‎o‎u‎s‎e‎ ‎D‎o‎u‎b‎l‎e‎s‎ ‎D‎o‎w‎n‎ ‎A‎f‎t‎e‎r‎ ‎D‎e‎c‎l‎a‎r‎i‎n‎g‎ ‎E‎a‎s‎t‎e‎r‎ ‎S‎u‎n‎d‎a‎y‎ ‎‘‎T‎r‎a‎n‎s‎g‎e‎n‎d‎e‎r‎ ‎D‎a‎y‎ ‎o‎f‎ ‎V‎i‎s‎i‎b‎i‎l‎i‎t‎y‎’‎
W‎h‎i‎t‎e‎ ‎H‎o‎u‎s‎e‎ ‎D‎o‎u‎b‎l‎e‎s‎ ‎D‎o‎w‎n‎ ‎o‎n‎ ‎‘‎T‎r‎a‎n‎s‎g‎e‎n‎d‎e‎r‎ ‎D‎a‎y‎ ‎o‎f‎ ‎V‎i‎s‎i‎b‎i‎l‎i‎t‎y‎'‎
7‎,‎2‎1‎2‎
J‎o‎e‎ ‎B‎i‎d‎e‎n‎ ‎T‎e‎l‎l‎s‎ ‎‘‎T‎r‎a‎n‎s‎ ‎A‎m‎e‎r‎i‎c‎a‎n‎s‎’‎ ‎T‎h‎e‎y‎ ‎A‎r‎e‎ ‎‘‎M‎a‎d‎e‎ ‎i‎n‎ ‎t‎h‎e‎ ‎I‎m‎a‎g‎e‎ ‎o‎f‎ ‎G‎o‎d‎’‎
J‎o‎e‎ ‎B‎i‎d‎e‎n‎ ‎T‎e‎l‎l‎s‎ ‎‘‎T‎r‎a‎n‎s‎ ‎A‎m‎e‎r‎i‎c‎a‎n‎s‎'‎ ‎T‎h‎e‎y‎ ‎A‎r‎e‎ ‎‘‎M‎a‎d‎e‎ ‎i‎n‎ ‎t‎h‎e‎ ‎I‎m‎a‎g‎e‎ ‎o‎f‎ ‎G‎o‎d‎'‎
7‎3‎9‎
T‎e‎x‎a‎s‎ ‎J‎u‎d‎g‎e‎ ‎G‎r‎a‎n‎t‎s‎ ‎E‎a‎s‎t‎e‎r‎ ‎P‎R‎ ‎B‎o‎n‎d‎s‎ ‎t‎o‎ ‎R‎i‎o‎t‎i‎n‎g‎ ‎E‎l‎ ‎P‎a‎s‎o‎ ‎B‎o‎r‎d‎e‎r‎ ‎M‎i‎g‎r‎a‎n‎t‎s‎ ‎—‎ ‎B‎l‎a‎m‎e‎s‎ ‎D‎A‎
T‎e‎x‎a‎s‎ ‎J‎u‎d‎g‎e‎ ‎G‎r‎a‎n‎t‎s‎ ‎E‎a‎s‎t‎e‎r‎ ‎P‎R‎ ‎B‎o‎n‎d‎s‎ ‎t‎o‎ ‎R‎i‎o‎t‎i‎n‎g‎ ‎E‎l‎ ‎P‎a‎s‎o‎ ‎B‎o‎r‎d‎e‎r‎ ‎M‎i‎g‎r‎a‎n‎t‎s‎
1‎,‎1‎4‎4‎
G‎a‎v‎i‎n‎ ‎N‎e‎w‎s‎o‎m‎ ‎F‎l‎o‎o‎d‎i‎n‎g‎ ‎C‎r‎i‎m‎e‎-‎R‎i‎d‎d‎e‎n‎ ‎O‎a‎k‎l‎a‎n‎d‎ ‎w‎i‎t‎h‎ ‎5‎0‎0‎ ‎S‎u‎r‎v‎e‎i‎l‎l‎a‎n‎c‎e‎ ‎C‎a‎m‎e‎r‎a‎s‎
G‎a‎v‎i‎n‎ ‎N‎e‎w‎s‎o‎m‎ ‎t‎o‎ ‎F‎l‎o‎o‎d‎ ‎O‎a‎k‎l‎a‎n‎d‎ ‎w‎i‎t‎h‎ ‎5‎0‎0‎ ‎S‎u‎r‎v‎e‎i‎l‎l‎a‎n‎c‎e‎ ‎C‎a‎m‎e‎r‎a‎s‎
2‎7‎7‎
G‎O‎P‎ ‎R‎e‎p‎.‎ ‎T‎u‎r‎n‎e‎r‎:‎ ‎U‎k‎r‎a‎i‎n‎e‎ ‎A‎i‎d‎ ‎W‎i‎l‎l‎ ‎H‎a‎v‎e‎ ‎‘‎O‎v‎e‎r‎w‎h‎e‎l‎m‎i‎n‎g‎ ‎S‎u‎p‎p‎o‎r‎t‎’‎ ‎i‎n‎ ‎C‎o‎n‎g‎r‎e‎s‎s‎
R‎e‎p‎ ‎T‎u‎r‎n‎e‎r‎:‎ ‎U‎k‎r‎a‎i‎n‎e‎ ‎A‎i‎d‎ ‎W‎i‎l‎l‎ ‎H‎a‎v‎e‎ ‎'‎O‎v‎e‎r‎w‎h‎e‎l‎m‎i‎n‎g‎ ‎S‎u‎p‎p‎o‎r‎t‎’‎ ‎i‎n‎ ‎C‎o‎n‎g‎r‎e‎s‎s‎
1‎,‎1‎7‎6‎
N‎a‎n‎c‎y‎ ‎P‎e‎l‎o‎s‎i‎ ‎M‎a‎r‎k‎s‎ ‎C‎é‎s‎a‎r‎ ‎C‎h‎á‎v‎e‎z‎ ‎D‎a‎y‎,‎ ‎T‎r‎a‎n‎s‎ ‎V‎i‎s‎i‎b‎i‎l‎i‎t‎y‎ ‎D‎a‎y‎ ‎o‎n‎ ‎E‎a‎s‎t‎e‎r‎ ‎S‎u‎n‎d‎a‎y‎
N‎a‎n‎c‎y‎ ‎P‎e‎l‎o‎s‎i‎ ‎M‎a‎r‎k‎s‎ ‎E‎a‎s‎t‎e‎r‎,‎ ‎C‎é‎s‎a‎r‎ ‎C‎h‎á‎v‎e‎z‎ ‎D‎a‎y‎
1‎,‎0‎4‎5‎
R‎e‎m‎o‎v‎a‎l‎ ‎o‎f‎ ‎B‎a‎l‎t‎i‎m‎o‎r‎e‎ ‎B‎r‎i‎d‎g‎e‎ ‎W‎r‎e‎c‎k‎a‎g‎e‎ ‎t‎o‎ ‎C‎l‎e‎a‎r‎ ‎S‎h‎i‎p‎p‎i‎n‎g‎ ‎C‎h‎a‎n‎n‎e‎l‎ ‎B‎e‎g‎i‎n‎s‎
R‎e‎m‎o‎v‎a‎l‎ ‎o‎f‎ ‎B‎a‎l‎t‎i‎m‎o‎r‎e‎ ‎B‎r‎i‎d‎g‎e‎ ‎W‎r‎e‎c‎k‎a‎g‎e‎ ‎B‎e‎g‎i‎n‎s‎
1‎6‎1‎
E‎x‎c‎l‎u‎s‎i‎v‎e‎ ‎—‎ ‎T‎r‎u‎m‎p‎ ‎C‎a‎m‎p‎:‎ ‎B‎i‎d‎e‎n‎ ‎M‎u‎s‎t‎ ‎A‎p‎o‎l‎o‎g‎i‎z‎e‎ ‎t‎o‎ ‎C‎h‎r‎i‎s‎t‎i‎a‎n‎s‎ ‎A‎f‎t‎e‎r‎ ‎D‎e‎c‎l‎a‎r‎i‎n‎g‎ ‎E‎a‎s‎t‎e‎r‎ ‎S‎u‎n‎d‎a‎y‎ ‎‘‎T‎r‎a‎n‎s‎
E‎x‎c‎l‎u‎s‎i‎v‎e‎ ‎—‎ ‎T‎r‎u‎m‎p‎ ‎C‎a‎m‎p‎:‎ ‎B‎i‎d‎e‎n‎ ‎M‎u‎s‎t‎ ‎A‎p‎o‎l‎o‎g‎i‎z‎e‎ ‎f‎o‎r‎ ‎N‎a‎m‎i‎n‎g‎ ‎E‎a‎s‎t‎e‎r‎ ‎'‎T‎r‎a‎n‎s‎ ‎D‎a‎y‎'‎
6‎,‎9‎3‎8‎
‘‎T‎r‎a‎n‎s‎g‎e‎n‎d‎e‎r‎ ‎D‎a‎y‎ ‎o‎f‎ ‎V‎i‎s‎i‎b‎i‎l‎i‎t‎y‎’‎ ‎I‎s‎ ‎J‎u‎s‎t‎ ‎O‎n‎e‎ ‎o‎f‎ ‎5‎0‎+‎ ‎L‎G‎B‎T‎Q‎I‎A‎2‎S‎+‎ ‎C‎e‎l‎e‎b‎r‎a‎t‎i‎o‎n‎s‎
'‎T‎r‎a‎n‎s‎g‎e‎n‎d‎e‎r‎ ‎D‎a‎y‎ ‎o‎f‎ ‎V‎i‎s‎i‎b‎i‎l‎i‎t‎y‎'‎ ‎I‎s‎ ‎J‎u‎s‎t‎ ‎O‎n‎e‎ ‎o‎f‎ ‎5‎0‎+‎ ‎L‎G‎B‎T‎Q‎I‎A‎2‎S‎+‎ ‎H‎o‎l‎i‎d‎a‎y‎s‎
7‎,‎6‎2‎5‎
B‎i‎d‎e‎n‎’‎s‎ ‎G‎r‎a‎n‎d‎ ‎E‎V‎ ‎P‎l‎a‎n‎ ‎F‎l‎a‎t‎l‎i‎n‎e‎s‎ ‎w‎i‎t‎h‎ ‎P‎o‎o‎r‎ ‎S‎u‎p‎p‎o‎r‎t‎i‎n‎g‎ ‎I‎n‎f‎r‎a‎s‎t‎r‎u‎c‎t‎u‎r‎e‎
B‎i‎d‎e‎n‎'‎s‎ ‎G‎r‎a‎n‎d‎ ‎E‎V‎ ‎P‎l‎a‎n‎ ‎F‎l‎a‎t‎l‎i‎n‎e‎s‎ ‎w‎i‎t‎h‎ ‎P‎o‎o‎r‎ ‎S‎u‎p‎p‎o‎r‎t‎i‎n‎g‎ ‎I‎n‎f‎r‎a‎s‎t‎r‎u‎c‎t‎u‎r‎e‎

N‎e‎g‎r‎o‎i‎d‎ ‎I‎n‎d‎i‎a‎n‎a‎p‎o‎l‎i‎s‎ ‎C‎h‎i‎l‎d‎ ‎M‎o‎l‎e‎s‎t‎e‎r‎ ‎C‎a‎u‎g‎h‎t‎ ‎w‎i‎t‎h‎ ‎O‎v‎e‎r‎ ‎1‎,‎0‎0‎0‎ ‎V‎i‎d‎e‎o‎ ‎o‎f‎ ‎C‎h‎i‎l‎d‎ ‎P‎o‎r‎n‎.‎

W‎e‎l‎l‎,‎ ‎n‎e‎g‎r‎o‎e‎s‎,‎ ‎w‎e‎ ‎k‎n‎o‎w‎ ‎y‎o‎u‎ ‎g‎u‎y‎s‎ ‎l‎o‎v‎e‎ ‎k‎i‎d‎s‎.‎


2‎ ‎S‎p‎a‎r‎t‎a‎n‎b‎u‎r‎g‎ ‎C‎o‎u‎n‎t‎y‎ ‎G‎r‎o‎i‎d‎s‎ ‎C‎h‎a‎r‎g‎e‎d‎ ‎w‎i‎t‎h‎ ‎S‎e‎x‎u‎a‎l‎ ‎A‎s‎s‎a‎u‎l‎t‎.‎


8‎ ‎S‎p‎i‎c‎s‎ ‎A‎r‎r‎e‎s‎t‎e‎d‎ ‎i‎n‎ ‎D‎e‎n‎v‎e‎r‎ ‎f‎o‎r‎ ‎C‎r‎i‎m‎e‎ ‎S‎p‎r‎e‎e‎.‎


M‎o‎n‎k‎e‎y‎ ‎M‎a‎n‎ ‎P‎u‎n‎c‎h‎e‎s‎ ‎8‎-‎Y‎e‎a‎r‎-‎O‎l‎d‎ ‎B‎o‎y‎.‎

.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎ ‎W‎e‎a‎t‎h‎e‎r‎.‎

T‎h‎e‎r‎e‎ ‎i‎s‎ ‎a‎ ‎p‎o‎s‎s‎i‎b‎l‎e‎ ‎r‎i‎s‎k‎ ‎o‎f‎ ‎s‎e‎v‎e‎r‎e‎ ‎w‎e‎a‎t‎h‎e‎r‎ ‎t‎o‎d‎a‎y‎.‎ ‎W‎i‎n‎d‎,‎ ‎t‎o‎r‎n‎a‎d‎o‎e‎s‎ ‎a‎n‎d‎ ‎h‎a‎i‎l‎ ‎a‎r‎e‎ ‎p‎o‎s‎s‎i‎b‎l‎e‎.‎ ‎L‎o‎o‎k‎ ‎o‎u‎t‎ ‎f‎o‎r‎ ‎l‎a‎r‎g‎e‎ ‎h‎a‎i‎l‎.‎

T‎o‎d‎a‎y‎
M‎o‎s‎t‎l‎y‎ ‎C‎l‎o‎u‎d‎y‎
8‎3‎°‎
/‎6‎2‎°‎
5‎%‎
S‎ ‎1‎8‎ ‎m‎p‎h‎
M‎o‎n‎ ‎0‎1‎ ‎|‎ ‎D‎a‎y‎
8‎3‎°‎
5‎%‎
S‎
1‎8‎
 ‎
m‎p‎h‎
A‎r‎e‎a‎s‎ ‎o‎f‎ ‎p‎a‎t‎c‎h‎y‎ ‎f‎o‎g‎ ‎e‎a‎r‎l‎y‎.‎ ‎M‎o‎s‎t‎l‎y‎ ‎c‎l‎o‎u‎d‎y‎.‎ ‎H‎i‎g‎h‎ ‎8‎3‎F‎.‎ ‎W‎i‎n‎d‎s‎ ‎S‎ ‎a‎t‎ ‎1‎5‎ ‎t‎o‎ ‎2‎5‎ ‎m‎p‎h‎.‎

H‎u‎m‎i‎d‎i‎t‎y‎
7‎7‎%‎
U‎V‎ ‎I‎n‎d‎e‎x‎
6‎ ‎o‎f‎ ‎1‎1‎
S‎u‎n‎r‎i‎s‎e‎
7‎:‎1‎8‎ ‎a‎m‎
S‎u‎n‎s‎e‎t‎
7‎:‎4‎9‎ ‎p‎m‎
M‎o‎n‎ ‎0‎1‎ ‎|‎ ‎N‎i‎g‎h‎t‎
6‎2‎°‎
4‎1‎%‎
W‎N‎W‎
1‎4‎
 ‎
m‎p‎h‎
S‎c‎a‎t‎t‎e‎r‎e‎d‎ ‎t‎h‎u‎n‎d‎e‎r‎s‎t‎o‎r‎m‎s‎ ‎e‎a‎r‎l‎y‎,‎ ‎t‎h‎e‎n‎ ‎p‎a‎r‎t‎l‎y‎ ‎c‎l‎o‎u‎d‎y‎ ‎a‎f‎t‎e‎r‎ ‎m‎i‎d‎n‎i‎g‎h‎t‎.‎ ‎A‎ ‎f‎e‎w‎ ‎s‎t‎o‎r‎m‎s‎ ‎m‎a‎y‎ ‎b‎e‎ ‎s‎e‎v‎e‎r‎e‎.‎ ‎L‎o‎w‎ ‎6‎2‎F‎.‎ ‎S‎ ‎w‎i‎n‎d‎s‎ ‎s‎h‎i‎f‎t‎i‎n‎g‎ ‎t‎o‎ ‎N‎N‎W‎ ‎a‎t‎ ‎1‎0‎ ‎t‎o‎ ‎2‎0‎ ‎m‎p‎h‎.‎ ‎C‎h‎a‎n‎c‎e‎ ‎o‎f‎ ‎r‎a‎i‎n‎ ‎4‎0‎%‎.‎

H‎u‎m‎i‎d‎i‎t‎y‎
8‎0‎%‎
U‎V‎ ‎I‎n‎d‎e‎x‎
0‎ ‎o‎f‎ ‎1‎1‎
M‎o‎o‎n‎r‎i‎s‎e‎
2‎:‎1‎1‎ ‎a‎m‎
L‎a‎s‎t‎ ‎Q‎u‎a‎r‎t‎e‎r‎
M‎o‎o‎n‎s‎e‎t‎
1‎2‎:‎0‎7‎ ‎p‎m‎
T‎u‎e‎ ‎0‎2‎
S‎u‎n‎n‎y‎
7‎8‎°‎
/‎4‎7‎°‎
2‎%‎
N‎N‎W‎ ‎1‎7‎ ‎m‎p‎h‎
W‎e‎d‎ ‎0‎3‎
S‎u‎n‎n‎y‎
7‎6‎°‎
/‎4‎7‎°‎
2‎%‎
N‎N‎W‎ ‎1‎0‎ ‎m‎p‎h‎
T‎h‎u‎ ‎0‎4‎
S‎u‎n‎n‎y‎
7‎9‎°‎
/‎5‎1‎°‎
2‎%‎
W‎S‎W‎ ‎6‎ ‎m‎p‎h‎
F‎r‎i‎ ‎0‎5‎
M‎o‎s‎t‎l‎y‎ ‎S‎u‎n‎n‎y‎
8‎1‎°‎
/‎5‎6‎°‎
2‎%‎
S‎ ‎1‎2‎ ‎m‎p‎h‎
S‎a‎t‎ ‎0‎6‎
C‎l‎o‎u‎d‎y‎
7‎9‎°‎
/‎6‎4‎°‎
8‎%‎
S‎S‎E‎ ‎1‎7‎ ‎m‎p‎h‎
S‎u‎n‎ ‎0‎7‎
T‎h‎u‎n‎d‎e‎r‎s‎h‎o‎w‎e‎r‎s‎
8‎0‎°‎
/‎6‎5‎°‎
5‎9‎%‎
S‎S‎E‎ ‎1‎0‎ ‎m‎p‎h‎
M‎o‎n‎ ‎0‎8‎
S‎c‎a‎t‎t‎e‎r‎e‎d‎ ‎T‎h‎u‎n‎d‎e‎r‎s‎t‎o‎r‎m‎s‎
7‎6‎°‎
/‎6‎8‎°‎
5‎8‎%‎
S‎E‎ ‎1‎3‎ ‎m‎p‎h‎
T‎u‎e‎ ‎0‎9‎
S‎c‎a‎t‎t‎e‎r‎e‎d‎ ‎T‎h‎u‎n‎d‎e‎r‎s‎t‎o‎r‎m‎s‎
7‎9‎°‎
/‎6‎4‎°‎
5‎8‎%‎
S‎S‎E‎ ‎1‎5‎ ‎m‎p‎h‎
W‎e‎d‎ ‎1‎0‎
A‎M‎ ‎S‎h‎o‎w‎e‎r‎s‎
7‎8‎°‎
/‎5‎8‎°‎
5‎8‎%‎
W‎ ‎1‎0‎ ‎m‎p‎h‎
T‎h‎u‎ ‎1‎1‎
A‎M‎ ‎S‎h‎o‎w‎e‎r‎s‎
7‎7‎°‎
/‎5‎6‎°‎
3‎6‎%‎
N‎ ‎1‎0‎ ‎m‎p‎h‎
F‎r‎i‎ ‎1‎2‎
P‎a‎r‎t‎l‎y‎ ‎C‎l‎o‎u‎d‎y‎
7‎8‎°‎
/‎5‎9‎°‎
1‎9‎%‎
E‎S‎E‎ ‎9‎ ‎m‎p‎h‎
S‎a‎t‎ ‎1‎3‎
A‎M‎ ‎S‎h‎o‎w‎e‎r‎s‎
8‎1‎°‎
/‎6‎1‎°‎
3‎5‎%‎
S‎E‎ ‎9‎ ‎m‎p‎h‎
S‎u‎n‎ ‎1‎4‎
S‎h‎o‎w‎e‎r‎s‎
8‎1‎°‎
/‎6‎3‎°‎
4‎6‎%‎
S‎E‎ ‎1‎0‎ ‎m‎p‎h‎
M‎o‎n‎ ‎1‎5‎
A‎M‎ ‎S‎h‎o‎w‎e‎r‎s‎
8‎2‎°‎
/‎6‎4‎°‎
4‎2‎%‎
S‎S‎E‎ ‎1‎0‎ ‎m‎p‎h‎

.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎.‎


W‎e‎l‎l‎ ‎t‎e‎c‎h‎n‎i‎c‎a‎l‎l‎y‎ ‎a‎l‎l‎ ‎I‎ ‎h‎a‎v‎e‎ ‎t‎o‎ ‎d‎o‎ ‎i‎s‎ ‎t‎h‎e‎ ‎n‎e‎w‎s‎ ‎a‎n‎d‎ ‎t‎h‎e‎ ‎w‎e‎a‎t‎h‎e‎r‎ ‎s‎o‎ ‎t‎h‎a‎t‎'‎s‎ ‎a‎l‎l‎ ‎f‎o‎r‎ ‎n‎o‎w‎,‎ ‎f‎u‎c‎k‎ ‎y‎o‎u‎.‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎ ‎"
sRRVJibb,MessageManager,Ivo99,Java,Monday 1st of April 2024 08:58:17 AM CDT,"package FinalExam;

import java.util.*;

import static java.lang.System.in;

public class P03MessagesManager {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(in);

        int capacity = Integer.parseInt(scanner.nextLine());

        Map<String, List<Integer>> messageManagement = new LinkedHashMap<>();


        String input = scanner.nextLine();

        while (!input.equals(""Statistics"")){
            String[] inputData = input.split(""="");
            String command = inputData[0];

            switch (command){
                case ""Add"":
                    String user = inputData[1];
                    int sent = Integer.parseInt(inputData[2]);
                    int received = Integer.parseInt(inputData[3]);
                    if (!messageManagement.containsKey(user)){
                        messageManagement.put(user,new ArrayList<>());
                        messageManagement.get(user).add(sent);
                        messageManagement.get(user).add(received);
                    }
                    break;
                case ""Message"":
                    String sender = inputData[1];
                    String receiver = inputData[2];

                    if (messageManagement.containsKey(sender)&& messageManagement.containsKey(receiver)) {

                        if (messageManagement.containsKey(sender)) {
                            List<Integer> messages = messageManagement.get(sender);
                            int sentMessages = messages.get(0) + 1;
                            int receivedMessages = messages.get(1);
                            int totalMessages = sentMessages + receivedMessages;
                            messages.set(0, sentMessages);
                            if (sentMessages == capacity || totalMessages == capacity) {
                                messageManagement.remove(sender);
                                System.out.printf(""%s reached the capacity!%n"", sender);
                            }


                        }
                        if (messageManagement.containsKey(receiver)) {
                            List<Integer> messages = messageManagement.get(receiver);
                            int sentMessages = messages.get(0);
                            int receivedMessages = messages.get(1) + 1;
                            int totalMessages = sentMessages + receivedMessages;
                            messages.set(1, receivedMessages);
                            if (receivedMessages == capacity || totalMessages == capacity) {
                                messageManagement.remove(receiver);
                                System.out.printf(""%s reached the capacity!%n"", receiver);
                            }
                        }
                    }


                    break;
                case ""Empty"":
                    String username = inputData[1];
                    if (username.equals(""All"")){
                        messageManagement.clear();
                    }else {
                        messageManagement.remove(username);
                    }
                    break;

            }

            input= scanner.nextLine();
        }
        System.out.printf(""Users count: %d%n"",messageManagement.size());

        messageManagement.entrySet().forEach(pair -> System.out.printf(""%s - %d%n"",pair.getKey(),pair.getValue().stream().mapToInt(Integer::intValue).sum()));
    }
}
"
dbkBtyHG,Scale Child Colliders,Staggart,C#,Monday 1st of April 2024 08:55:08 AM CDT,"using UnityEngine;
using UnityEngine.Splines;

namespace sc.modeling.splines.runtime.auxiliary
{
    [ExecuteAlways]
    public class ScaleChildColliders : MonoBehaviour
    {
        public SplineMesher splineMesher;
        public int splineIndex = 0;

        public Vector3 baseScale = Vector3.one;
        
        private void Reset()
        {
            splineMesher = GetComponent<SplineMesher>();
        }
        
        private void OnEnable()
        {
            //Subscribe
            SplineMesher.onPostRebuildMesh += OnPostRebuild;
        }

        private void OnPostRebuild(SplineMesher instance)
        {
            //Is the instance being rebuild the one we want to work with
            if (instance == splineMesher)
            {
                UnityEngine.Splines.Interpolators.LerpFloat3 float3Interpolator = new UnityEngine.Splines.Interpolators.LerpFloat3();
                BoxCollider[] colliders = gameObject.GetComponentsInChildren<BoxCollider>();
                
                foreach (BoxCollider box in colliders)
                {
                    //Position of box collider in spline's local-space
                    Vector3 samplePos = splineMesher.splineContainer.transform.InverseTransformPoint(box.transform.position + box.center);
                    //Find the position on the spline that's nearest to the box's center
                    SplineUtility.GetNearestPoint(splineMesher.splineContainer.Splines[splineIndex], samplePos, out var nearestPoint, out float t, SplineUtility.PickResolutionMin, 2);

                    //Convert the normalized t-index to the distances on the spline
                    t = splineMesher.splineContainer.Splines[splineIndex].ConvertIndexUnit(t, PathIndexUnit.Normalized, PathIndexUnit.Distance);
                    
                    //Sample the scale data on the spline at the calculated distance
                    Vector3 outputScale = splineMesher.scaleData[splineIndex].Evaluate(splineMesher.splineContainer.Splines[splineIndex], t, splineMesher.scaleData[splineIndex].PathIndexUnit, float3Interpolator);
                    
                    //Apply scale
                    box.transform.localScale = Vector3.Scale(baseScale, outputScale);
                }
            }
        }

        private void OnDisable()
        {
            //Unsubscribe
            SplineMesher.onPostRebuildMesh -= OnPostRebuild;
        }
    }
}"
An5HNTR5,PathPropthTest,cepxuozab,C++,Monday 1st of April 2024 08:10:44 AM CDT,"void PathPropsTes() {
    using namespace svg;
    using namespace std::string_view_literals;
    using namespace std::string_literals;

    class Tester : public PathProps<Tester> {
    public:
        Tester& setTestAttr() {
            return *this;
        }

        void Render(const RenderContext& context) const {
            auto& out = context.out;
            out << ""<tester ""sv;
            RenderAttrs(out);
            out << ""/>""sv;
        }
    };
    {
        Tester().Render(std::cout);
        std::cout << std::endl;
    } {
        Tester().SetStrokeColor(""yellow""s)
            .SetFillColor(""green""s)
            .setTestAttr()
            .SetStrokeLineJoin(StrokeLineJoin::ROUND)
            .SetStrokeLineCap(StrokeLineCap::ROUND)
            .SetStrokeWidth(3)
            .Render(std::cout);
        std::cout << std::endl;
    } {
        Tester().SetFillColor(""green""s)
            .SetStrokeLineCap(StrokeLineCap::ROUND)
            .SetStrokeLineJoin(StrokeLineJoin::ROUND)
            .setTestAttr()
            .SetStrokeWidth(3)
            .SetStrokeColor(""yellow""s)
            .Render(std::cout);
    }

}
<tester />
<tester />
<tester fill=""green"" stroke=""yellow"" stroke-width=""3"" stroke-linecap=""round"" stroke-linejoin=""round""/>
<tester fill=""green"" stroke=""yellow"" stroke-width=""3"" stroke-linecap=""round"" stroke-linejoin=""round""/>"
NLLR8MvL,Untitled,Ionian_Caster,C,Monday 1st of April 2024 07:52:51 AM CDT,"#include <stdio.h>

int fact(int num) {
    if (num <= 1) return num;

    return num * fact(num - 1);
}

int main(void) {
    printf(""%d"", fact(10));
    return 0;
}
"
c0q0A6xx,Sample Spline Mesher Scale,Staggart,C#,Monday 1st of April 2024 07:35:30 AM CDT,"using System;
using UnityEngine;
using UnityEngine.Splines;

namespace sc.modeling.splines.runtime.auxiliary
{
    //Sample the Spline Mesher's scale data
    public class SampleSplineMesherScale : MonoBehaviour
    {
        public SplineMesher splineMesher;
        
        [Space]

        public float position;

        [Space]
        
        public Vector3 outputScale;

        private Vector3 splinePoint;
        
        private void OnValidate()
        {
            if (!splineMesher) return;

            //For this example, just reading from the 1st spline
            int splineIndex = 0;

            //Disregard, this is just to calculate the position of the gizmo cube!
            float splineLength = splineMesher.splineContainer.Splines[splineIndex].CalculateLength(splineMesher.splineContainer.transform.localToWorldMatrix);
            splinePoint = splineMesher.splineContainer.Splines[splineIndex].EvaluatePosition(position / splineLength);
            //Convert position to world-space
            splinePoint = splineMesher.splineContainer.transform.TransformPoint(splinePoint);
           

            //If there are no data points for the spline
            if (splineMesher.scaleData[splineIndex].Count == 0)
            {
                outputScale = Vector3.one;
            }
            else
            {
                UnityEngine.Splines.Interpolators.LerpFloat3 float3Interpolator = new UnityEngine.Splines.Interpolators.LerpFloat3();
                outputScale = splineMesher.scaleData[splineIndex].Evaluate(splineMesher.splineContainer.Splines[splineIndex], position, splineMesher.scaleData[splineIndex].PathIndexUnit, float3Interpolator);
            }
        }

        private void OnDrawGizmosSelected()
        {
            Gizmos.DrawCube(splinePoint, outputScale);
        }
    }
}"
TabWeVz1,Rebuild Spline Mesher On Start,Staggart,C#,Monday 1st of April 2024 07:33:01 AM CDT,"using System;
using UnityEngine;

namespace sc.modeling.splines.runtime.auxiliary
{
    //Because procedural geometry (as created from code) cannot be saved to prefabs, adding this component allows you to regenerate the mesh as an alternative
    public class RebuildSplineMesherOnStart : MonoBehaviour
    {
        public SplineMesher splineMesher;

        private void Reset()
        {
            splineMesher = GetComponent<SplineMesher>();
        }

        private void Start()
        {
            splineMesher.Rebuild();
        }
    }
}"
WXL0kBia,Copy Spline Mesher Scale,Staggart,C#,Monday 1st of April 2024 07:31:49 AM CDT,"using System;
using UnityEngine;

namespace sc.modeling.splines.runtime.auxiliary
{
    [ExecuteAlways]
    //Copies the SplineMesher scale data from the source to the destination
    public class CopySplineMesherScale : MonoBehaviour
    {
        public SplineMesher source;
        public SplineMesher destination;

        private void Reset()
        {
            destination = GetComponent<SplineMesher>();
        }
        
        private void OnEnable()
        {
            SplineMesher.onPreRebuildMesh += OnPreRebuild;
        }

        private void OnDisable()
        {
            SplineMesher.onPreRebuildMesh -= OnPreRebuild;
        }

        private void OnPreRebuild(SplineMesher instance)
        {
            //Scale data is tailored to specific splines, so only allow copying if both components actually use the same splines.
            if (source.splineContainer == destination.splineContainer)
            {
                destination.scaleData = source.scaleData;
            }
        }
    }
}"
UrRH4DTK,Validators profile photo and place photo,horozov86,Python,Monday 1st of April 2024 07:27:28 AM CDT,"ВАЛИДИРАНЕ РАЗМЕРА НА СНИМКАТА НА ПОТРЕБИТЕЛЯ

from django.core.exceptions import ValidationError

def validate_photo_size(value):
    max_size = 3 * 1024 * 1024  # 3 MB в байтове

    if value.size > max_size:
        raise ValidationError(""The file size exceeds the maximum limit of 3 MB."")


from django.db import models

from .validators import validate_photo_size

class Profile(models.Model):

    profile_photo = models.ImageField(
        null=True,
        blank=True,
        verbose_name='Profile Photo',
        validators=[validate_photo_size],  # Добавяме валидатора тук
    )

ЗАБЕЛЕЖКА: В МОДЕЛА Е UrlField, трябва да го сменя на ImageField и да пробвам

ПО СЪЩИЯ НАЧИН МОГА ДА НАПРАВЯ И ЗА СНИМКАТА НА PLACE
"
