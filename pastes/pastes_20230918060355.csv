id,title,username,language,date,content
5MSnYsLe,KeePass Key File,AnkitVarma,XML,Monday 18th of September 2023 12:12:32 AM CDT,"<?xml version=""1.0"" encoding=""utf-8""?>
<KeyFile>
	<Meta>
		<Version>2.0</Version>
	</Meta>
	<Key>
		<Data Hash=""2EFD86C6"">
			1735E576 153D3B46 BCFB053A 3318AA73
			81F6BEA4 5FD508CE 493EC251 580C51BD
		</Data>
	</Key>
</KeyFile>"
qeQZ4uqs,Log ISO Bit 75 BJB 18/09/2023 12:00,Abikayusri19,Bash,Monday 18th of September 2023 12:06:05 AM CDT,"12:01:32.886 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ===========================request begin================================================
12:01:32.886 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - URI         : http://bjb-hsm/bjb/hsm/pin
12:01:32.886 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Headers     : [Accept:""application/json, application/*+json"", Content-Type:""application/json"", Content-Length:""88""]
12:01:32.886 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Request body: {""terminalId"":""70040001"",""pinUnderTpk"":""AA5F0C02809ABE27"",""cardNo"":""622011020020638074""}
12:01:32.886 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ==========================request end================================================
12:01:32.909 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ============================response begin==========================================
12:01:32.909 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status code  : 200 OK
12:01:32.909 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status text  : 
12:01:32.909 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Response body: {""pinBlock"":""AD2328F44C34CA75""}
12:01:32.909 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - =======================response end=================================================
12:01:32.912 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Updated bitmap: {32=110, 33=000110, 2=622011020020638074, 3=319900, 35=622011020020638074D2802221, 4=0, 37=000000209352, 7=0918050132, 41=70040001, 42=700400010001, 43=Menara BCA Lt 39      KABUPATEN TOLIJBID, 11=209352, 12=120132, 13=0918, 14=2802, 15=0919, 49=360, 18=6012, 52=AD2328F44C34CA75, 22=051, 90=020020935209180501320000000011000000000110}
12:01:32.914 [http-nio-9872-exec-2] DEBUG i.b.n.c.c.c.s.RedisBackedCacheService - puts key: /j8583_000000209352, object: {""dataB64"":""MDIwMEYyM0U0NDAxQThFMDkwMDAwMDAwMDA0MDAwMDAwMDIwMTg2MjIwMTEwMjAwMjA2MzgwNzQzMTk5MDAwMDAwMDAwMDAwMDAwOTE4MDUwMTMyMjA5MzUyMTIwMTMyMDkxODI4MDIwOTE5NjAxMjA1MTAzMTEwMDYwMDAxMTAyNjYyMjAxMTAyMDAyMDYzODA3NEQyODAyMjIxMDAwMDAwMjA5MzUyNzAwNDAwMDE3MDA0MDAwMTAwMDEgICBNZW5hcmEgQkNBIEx0IDM5ICAgICAgS0FCVVBBVEVOIFRPTElKQklEMzYwQUQyMzI4RjQ0QzM0Q0E3NTAyMDAyMDkzNTIwOTE4MDUwMTMyMDAwMDAwMDAxMTAwMDAwMDAwMDExMDAyMDAwMDAyMDkzNTIwMDAwMjA5MzUy"",""binaryHeader"":false,""isoHeader"":null,""binaryHeaderB64"":null}, timeout: 10, timeunit: MINUTES
12:01:32.914 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] WRITE: Message: 0200F23E4401A8E0900000000040000000201862201102002063807431990000000000000009180501322093521201320918280209196012051031100600011026622011020020638074D280222100000020935270040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID360AD2328F44C34CA7502002093520918050132000000001100000000011002000002093520000209352
MTI: 0x0200
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '319900'
  4: [NUMERIC(12)] = '000000000000'
  7: [NUMERIC(10)] = '0918050132'
  11: [NUMERIC(6)] = '209352'
  12: [NUMERIC(6)] = '120132'
  13: [DATE4(4)] = '0918'
  14: [NUMERIC(4)] = '2802'
  15: [NUMERIC(4)] = '0919'
  18: [NUMERIC(4)] = '6012'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLBCDBIN(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209352'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = 'AD2328F44C34CA75'
  90: [NUMERIC(42)] = '020020935209180501320000000011000000000110'
  123: [LLLVAR(20)] = '00002093520000209352'
12:01:32.914 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] FLUSH
12:01:32.917 [http-nio-9872-exec-2] DEBUG id.basys.ntt.edc.iso.MbIsoListener - RRN: 209352, Waiting for 70
12:01:33.087 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - INCOMING: 3032313037323332303430314141453039303030313836323230313130323030323036333830373433313939303030303030303030303030303030393138303530313332323039333532313230313332303931393035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333532353537303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a42494433363041443233323846343443333443413735
12:01:33.087 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - CUTS: 3032313037323332303430314141453039303030313836323230313130323030323036333830373433313939303030303030303030303030303030393138303530313332323039333532313230313332303931393035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333532353537303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a42494433363041443233323846343443333443413735
12:01:33.088 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ: Message: 021072320401AAE090001862201102002063807431990000000000000009180501322093521201320919051031100600011026622011020020638074D28022210000002093525570040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID360AD2328F44C34CA75
MTI: 0x0210
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '319900'
  4: [NUMERIC(12)] = '000000000000'
  7: [NUMERIC(10)] = '0918050132'
  11: [NUMERIC(6)] = '209352'
  12: [TIME(6)] = '120132'
  15: [NUMERIC(4)] = '0919'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLVAR(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209352'
  39: [ALPHA(2)] = '55'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = 'AD2328F44C34CA75'
12:01:33.088 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ COMPLETE
12:01:33.088 [pool-1-thread-70] INFO  i.b.n.e.iso.IsoListenerProcessorImpl - handling 0210, rrn:209352
12:01:33.089 [pool-1-thread-70] DEBUG id.basys.ntt.edc.iso.MbIsoListener - Received response of 209352
12:01:33.092 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.CensorCommonsRequestLoggingFilter - After request [POST /trx, payload={""dataMap"":{""32"":""110"",""33"":""000110"",""2"":""622011020020638074"",""3"":""319900"",""35"":""622011******638074D2802221"",""4"":""0"",""7"":""0918050132"",""41"":""70040001"",""42"":""700400010001"",""43"":""Menara BCA Lt 39      KABUPATEN TOLIJBID"",""12"":""120132"",""13"":""0918"",""14"":""2802"",""15"":""0919"",""49"":""360"",""18"":""6012"",""52"":""AA5F0C02809ABE27"",""22"":""051""},""rc"":null,""rrn"":null,""tracenum"":null,""mti"":512}]
12:01:47.966 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.CensorCommonsRequestLoggingFilter - REQUEST DATA : POST /trx]
12:01:47.967 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Original bitmap: {32=110, 33=000110, 2=622011020020638074, 3=319900, 35=622011020020638074D2802221, 4=0, 7=0918050147, 41=70040001, 42=700400010001, 43=Menara BCA Lt 39      KABUPATEN TOLIJBID, 12=120147, 13=0918, 14=2802, 15=0919, 49=360, 18=6012, 52=DEF003DA38B653FA, 22=051}
12:01:47.967 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ===========================request begin================================================
12:01:47.967 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - URI         : http://bjb-hsm/bjb/hsm/pin
12:01:47.967 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Headers     : [Accept:""application/json, application/*+json"", Content-Type:""application/json"", Content-Length:""88""]
12:01:47.967 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Request body: {""terminalId"":""70040001"",""pinUnderTpk"":""DEF003DA38B653FA"",""cardNo"":""622011020020638074""}
12:01:47.967 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ==========================request end================================================
12:01:47.985 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ============================response begin==========================================
12:01:47.985 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status code  : 200 OK
12:01:47.985 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status text  : 
12:01:47.986 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Response body: {""pinBlock"":""28F473B89438F720""}
12:01:47.986 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - =======================response end=================================================
12:01:47.987 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Updated bitmap: {32=110, 33=000110, 2=622011020020638074, 3=319900, 35=622011020020638074D2802221, 4=0, 37=000000209354, 7=0918050147, 41=70040001, 42=700400010001, 43=Menara BCA Lt 39      KABUPATEN TOLIJBID, 11=209354, 12=120147, 13=0918, 14=2802, 15=0919, 49=360, 18=6012, 52=28F473B89438F720, 22=051, 90=020020935409180501470000000011000000000110}
12:01:47.989 [http-nio-9872-exec-3] DEBUG i.b.n.c.c.c.s.RedisBackedCacheService - puts key: /j8583_000000209354, object: {""dataB64"":""MDIwMEYyM0U0NDAxQThFMDkwMDAwMDAwMDA0MDAwMDAwMDIwMTg2MjIwMTEwMjAwMjA2MzgwNzQzMTk5MDAwMDAwMDAwMDAwMDAwOTE4MDUwMTQ3MjA5MzU0MTIwMTQ3MDkxODI4MDIwOTE5NjAxMjA1MTAzMTEwMDYwMDAxMTAyNjYyMjAxMTAyMDAyMDYzODA3NEQyODAyMjIxMDAwMDAwMjA5MzU0NzAwNDAwMDE3MDA0MDAwMTAwMDEgICBNZW5hcmEgQkNBIEx0IDM5ICAgICAgS0FCVVBBVEVOIFRPTElKQklEMzYwMjhGNDczQjg5NDM4RjcyMDAyMDAyMDkzNTQwOTE4MDUwMTQ3MDAwMDAwMDAxMTAwMDAwMDAwMDExMDAyMDAwMDAyMDkzNTQwMDAwMjA5MzU0"",""binaryHeader"":false,""isoHeader"":null,""binaryHeaderB64"":null}, timeout: 10, timeunit: MINUTES
12:01:47.989 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] WRITE: Message: 0200F23E4401A8E0900000000040000000201862201102002063807431990000000000000009180501472093541201470918280209196012051031100600011026622011020020638074D280222100000020935470040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID36028F473B89438F72002002093540918050147000000001100000000011002000002093540000209354
MTI: 0x0200
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '319900'
  4: [NUMERIC(12)] = '000000000000'
  7: [NUMERIC(10)] = '0918050147'
  11: [NUMERIC(6)] = '209354'
  12: [NUMERIC(6)] = '120147'
  13: [DATE4(4)] = '0918'
  14: [NUMERIC(4)] = '2802'
  15: [NUMERIC(4)] = '0919'
  18: [NUMERIC(4)] = '6012'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLBCDBIN(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209354'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = '28F473B89438F720'
  90: [NUMERIC(42)] = '020020935409180501470000000011000000000110'
  123: [LLLVAR(20)] = '00002093540000209354'
12:01:47.989 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] FLUSH
12:01:47.990 [http-nio-9872-exec-3] DEBUG id.basys.ntt.edc.iso.MbIsoListener - RRN: 209354, Waiting for 70
12:01:48.107 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - INCOMING: 3032313037323332303430314141453039303030313836323230313130323030323036333830373433313939303030303030303030303030303030393138303530313437323039333534313230313437303931393035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333534353537303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a42494433363032384634373342383934333846373230
12:01:48.107 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - CUTS: 3032313037323332303430314141453039303030313836323230313130323030323036333830373433313939303030303030303030303030303030393138303530313437323039333534313230313437303931393035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333534353537303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a42494433363032384634373342383934333846373230
12:01:48.107 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ: Message: 021072320401AAE090001862201102002063807431990000000000000009180501472093541201470919051031100600011026622011020020638074D28022210000002093545570040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID36028F473B89438F720
MTI: 0x0210
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '319900'
  4: [NUMERIC(12)] = '000000000000'
  7: [NUMERIC(10)] = '0918050147'
  11: [NUMERIC(6)] = '209354'
  12: [TIME(6)] = '120147'
  15: [NUMERIC(4)] = '0919'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLVAR(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209354'
  39: [ALPHA(2)] = '55'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = '28F473B89438F720'
12:01:48.107 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ COMPLETE
12:01:48.108 [pool-1-thread-70] INFO  i.b.n.e.iso.IsoListenerProcessorImpl - handling 0210, rrn:209354
12:01:48.108 [pool-1-thread-70] DEBUG id.basys.ntt.edc.iso.MbIsoListener - Received response of 209354
12:01:48.112 [http-nio-9872-exec-3] DEBUG i.b.n.e.i.CensorCommonsRequestLoggingFilter - After request [POST /trx, payload={""dataMap"":{""32"":""110"",""33"":""000110"",""2"":""622011020020638074"",""3"":""319900"",""35"":""622011******638074D2802221"",""4"":""0"",""7"":""0918050147"",""41"":""70040001"",""42"":""700400010001"",""43"":""Menara BCA Lt 39      KABUPATEN TOLIJBID"",""12"":""120147"",""13"":""0918"",""14"":""2802"",""15"":""0919"",""49"":""360"",""18"":""6012"",""52"":""DEF003DA38B653FA"",""22"":""051""},""rc"":null,""rrn"":null,""tracenum"":null,""mti"":512}]
12:01:59.773 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.CensorCommonsRequestLoggingFilter - REQUEST DATA : POST /trx]
12:01:59.774 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Original bitmap: {32=110, 33=000110, 2=622011020020638074, 3=319900, 35=622011020020638074D2802221, 4=0, 7=0918050159, 41=70040001, 42=700400010001, 43=Menara BCA Lt 39      KABUPATEN TOLIJBID, 12=120159, 13=0918, 14=2802, 15=0919, 49=360, 18=6012, 52=C8BE40AE30C8448B, 22=051}
12:01:59.774 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ===========================request begin================================================
12:01:59.774 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - URI         : http://bjb-hsm/bjb/hsm/pin
12:01:59.775 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Headers     : [Accept:""application/json, application/*+json"", Content-Type:""application/json"", Content-Length:""88""]
12:01:59.775 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Request body: {""terminalId"":""70040001"",""pinUnderTpk"":""C8BE40AE30C8448B"",""cardNo"":""622011020020638074""}
12:01:59.775 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ==========================request end================================================
12:01:59.819 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ============================response begin==========================================
12:01:59.819 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status code  : 200 OK
12:01:59.819 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status text  : 
12:01:59.820 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Response body: {""pinBlock"":""D81C8E948A3B93A6""}
12:01:59.820 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - =======================response end=================================================
12:01:59.844 [http-nio-9872-exec-4] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Updated bitmap: {32=110, 33=000110, 2=622011020020638074, 3=319900, 35=622011020020638074D2802221, 4=0, 37=000000209356, 7=0918050159, 41=70040001, 42=700400010001, 43=Menara BCA Lt 39      KABUPATEN TOLIJBID, 11=209356, 12=120159, 13=0918, 14=2802, 15=0919, 49=360, 18=6012, 52=D81C8E948A3B93A6, 22=051, 90=020020935609180501590000000011000000000110}
12:01:59.846 [http-nio-9872-exec-4] DEBUG i.b.n.c.c.c.s.RedisBackedCacheService - puts key: /j8583_000000209356, object: {""dataB64"":""MDIwMEYyM0U0NDAxQThFMDkwMDAwMDAwMDA0MDAwMDAwMDIwMTg2MjIwMTEwMjAwMjA2MzgwNzQzMTk5MDAwMDAwMDAwMDAwMDAwOTE4MDUwMTU5MjA5MzU2MTIwMTU5MDkxODI4MDIwOTE5NjAxMjA1MTAzMTEwMDYwMDAxMTAyNjYyMjAxMTAyMDAyMDYzODA3NEQyODAyMjIxMDAwMDAwMjA5MzU2NzAwNDAwMDE3MDA0MDAwMTAwMDEgICBNZW5hcmEgQkNBIEx0IDM5ICAgICAgS0FCVVBBVEVOIFRPTElKQklEMzYwRDgxQzhFOTQ4QTNCOTNBNjAyMDAyMDkzNTYwOTE4MDUwMTU5MDAwMDAwMDAxMTAwMDAwMDAwMDExMDAyMDAwMDAyMDkzNTYwMDAwMjA5MzU2"",""binaryHeader"":false,""isoHeader"":null,""binaryHeaderB64"":null}, timeout: 10, timeunit: MINUTES
12:01:59.847 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] WRITE: Message: 0200F23E4401A8E0900000000040000000201862201102002063807431990000000000000009180501592093561201590918280209196012051031100600011026622011020020638074D280222100000020935670040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID360D81C8E948A3B93A602002093560918050159000000001100000000011002000002093560000209356
MTI: 0x0200
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '319900'
  4: [NUMERIC(12)] = '000000000000'
  7: [NUMERIC(10)] = '0918050159'
  11: [NUMERIC(6)] = '209356'
  12: [NUMERIC(6)] = '120159'
  13: [DATE4(4)] = '0918'
  14: [NUMERIC(4)] = '2802'
  15: [NUMERIC(4)] = '0919'
  18: [NUMERIC(4)] = '6012'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLBCDBIN(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209356'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = 'D81C8E948A3B93A6'
  90: [NUMERIC(42)] = '020020935609180501590000000011000000000110'
  123: [LLLVAR(20)] = '00002093560000209356'
12:01:59.847 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] FLUSH
12:01:59.848 [http-nio-9872-exec-4] DEBUG id.basys.ntt.edc.iso.MbIsoListener - RRN: 209356, Waiting for 70
12:01:59.949 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - INCOMING: 3032313037323332303430314141453039303030313836323230313130323030323036333830373433313939303030303030303030303030303030393138303530313539323039333536313230313539303931393035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333536373537303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a42494433363044383143384539343841334239334136
12:01:59.949 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - CUTS: 3032313037323332303430314141453039303030313836323230313130323030323036333830373433313939303030303030303030303030303030393138303530313539323039333536313230313539303931393035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333536373537303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a42494433363044383143384539343841334239334136
12:01:59.950 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ: Message: 021072320401AAE090001862201102002063807431990000000000000009180501592093561201590919051031100600011026622011020020638074D28022210000002093567570040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID360D81C8E948A3B93A6
MTI: 0x0210
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '319900'
  4: [NUMERIC(12)] = '000000000000'
  7: [NUMERIC(10)] = '0918050159'
  11: [NUMERIC(6)] = '209356'
  12: [TIME(6)] = '120159'
  15: [NUMERIC(4)] = '0919'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLVAR(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209356'
  39: [ALPHA(2)] = '75'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = 'D81C8E948A3B93A6'
12:01:59.950 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ COMPLETE
12:01:59.950 [pool-1-thread-70] INFO  i.b.n.e.iso.IsoListenerProcessorImpl - handling 0210, rrn:209356
12:01:59.950 [pool-1-thread-70] DEBUG id.basys.ntt.edc.iso.MbIsoListener - Received response of 209356"
2ERbmGGh,DistanceTransform,WarPie90,Delphi,Sunday 17th of September 2023 11:58:26 PM CDT,"{*
 Distance transform
*}

type EDistUnit = (duEuclidean, duManhatten, duChebyshev);

function dtEucDist(x1,x2:Int32): Int32;
begin
  Result := Sqr(x1) + Sqr(x2);
end;

function dtEucSep(i,j, ii,jj:Int32): Int32;
begin
  Result := Round((sqr(j) - sqr(i) + sqr(jj) - sqr(ii))/(2*(j-i)));
end;


function dtMtnDist(x1, x2: Int32): Int32;
begin
  Result := Abs(x1) + x2
end;

function dtMtnSep(i,j, ii, jj: Int32): Int32;
begin
  if (jj >= (ii + j - i)) then
    Exit($FFFFFF);
  if (ii > (jj + j - i)) then
    Exit(-$FFFFFF);
  Result := (jj-ii+j+i) shr 1;
end;

function dtChbDist(x1, x2: Int32): Int32;
begin
  Result := Max(Abs(x1), x2);
end;


function dtChbSep(i,j, ii,jj: Int32): Int32;
begin
  if (ii <= jj) then
    Result := Max(i+jj, Trunc((i+j) / 2))
  else
    Result := Min(j-ii, Trunc((i+j) / 2));
end;


function DistanceTransform(const binIm:TIntegerArray; m,n:Int32; distanceUnit:EDistUnit): TSingleMatrix;
type
  TSepFunc = function(i,j, ii,jj: Int32): Int32;
  TDistFunc = function(x1,x2: Int32): Int32;
var
  x,y,h,w,i,wid:Int32;
  dist: single;
  tmp,s,t:TIntegerArray;
  sf: TSepFunc;
  df: TDistFunc;
begin
  // first pass
  SetLength(tmp, m*n);
  h := n-1;
  w := m-1;
  for x:=0 to w do
  begin
    if binIm[x] = 0 then
      tmp[x] := 0
    else
      tmp[x] := m+n;

    for y:=1 to h do
      if (binIm[y*m+x] = 0) then
        tmp[y*m+x] := 0
      else
        tmp[y*m+x] := 1 + tmp[(y-1)*m+x];

    for y:=h-1 downto 0 do
      if (tmp[(y+1)*m+x] < tmp[y*m+x]) then
        tmp[y*m+x] := 1 + tmp[(y+1)*m+x]
  end;


  case distanceUnit of
    duEuclidean:
    begin
      df := @dtEucDist;
      sf := @dtEucSep;
    end;
    duManhatten:
    begin
      df := @dtMtnDist;
      sf := @dtMtnSep;
    end;
    duChebyshev:
    begin
      df := @dtChbDist;
      sf := @dtChbSep;
    end;
  end;

  // second pass
  SetLength(Result,n,m);
  SetLength(s,m);
  SetLength(t,m);
  wid := 0;
  for y:=0 to h do
  begin
    i := 0;
    s[0] := 0;
    t[0] := 0;

    for x:=1 to W do
    begin
      while (i >= 0) and (df(t[i]-s[i], tmp[y*m+s[i]]) > df(t[i]-x, tmp[y*m+x])) do
        Dec(i);
      if (i < 0) then
      begin
        i := 0;
        s[0] := x;
      end else
      begin
        wid := 1 + sf(s[i], x, tmp[y*m+s[i]], tmp[y*m+x]);
        if (wid < m) then
        begin
          Inc(i);
          s[i] := x;
          t[i] := wid;
        end;
      end;
    end;

    for x:=W downto 0 do
    begin
      dist := df(x-s[i], tmp[y*m+s[i]]);
      if distanceUnit = duEuclidean then dist := Sqrt(dist);

      Result[y,x] := dist;
      if (x = t[i]) then Dec(i);
    end;
  end;
end;


function DistanceTransform(const TPA:TPointArray; distanceUnit:EDistUnit): TSingleMatrix; overload;
var
  data:TIntegerArray;
  w,h,n,i:Int32;
  area:TBox;
begin
  n := Length(TPA);
  if (n = 0) then Exit;
  area := GetTPABounds(TPA);
  area.y1 -= 1;
  area.x1 -= 1;
  w := (area.x2 - area.x1) + 2;
  h := (area.y2 - area.y1) + 2;
  SetLength(data, h*w);
  for i:=0 to n-1 do
    data[(TPA[i].y-area.y1)*w+(TPA[i].x-area.x1)] := 1;

  Result := DistanceTransform(data,w,h,distanceUnit);
end;"
tDmqFTTQ,Log ISO Bit 51 Miniatm BJB 18/09/2023 11:27,Abikayusri19,Bash,Sunday 17th of September 2023 11:29:01 PM CDT,"11:27:11.051 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ===========================request begin================================================11:27:11.051 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - URI         : http://bjb-hsm/bjb/hsm/pin
11:27:11.051 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Headers     : [Accept:""application/json, application/*+json"", Content-Type:""application/json"", Content-Length:""88""]
11:27:11.051 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Request body: {""terminalId"":""70040001"",""pinUnderTpk"":""D468ACCD6373A494"",""cardNo"":""622011020020638074""}
11:27:11.051 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ==========================request end================================================
11:27:11.058 [AsyncResolver-bootstrap-executor-0] INFO  c.n.d.s.r.aws.ConfigClusterResolver - Resolving eureka endpoints via configuration
11:27:11.071 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ============================response begin==========================================
11:27:11.071 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status code  : 200 OK
11:27:11.071 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status text  : 
11:27:11.071 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Response body: {""pinBlock"":""2AB05243A6BE24C5""}
11:27:11.071 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - =======================response end=================================================
11:27:11.072 [http-nio-9872-exec-10] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Updated bitmap: {32=110, 33=360001, 2=622011020020638074, 3=000000, 35=622011020020638074D2802221, 4=5100000, 37=000000209350, 102=0128048839107, 7=0918042711, 41=70040001, 42=700400010001, 43=Menara BCA 39th Floor Kota Palu     JBID, 11=209350, 12=112711, 13=0918, 14=2802, 49=360, 18=6012, 52=2AB05243A6BE24C5, 22=051, 55=820274009F360203179F260865037DFF593D089F9F2701809F34030200009F101C0101A000800000864F7E3600000000000000000000000000000000009F3303E0F8C89F350114950508800410009F3704EBF8509D9F02060000000000005A096220110200206380745F3401009F1A0203605F2A0203609A032309189C01009F090200009F1E0830303030303930354F07A00000060210108407A00000060210109F410400000516, 25=00, 90=020020935009180427110000000011000000360001}
11:27:11.073 [http-nio-9872-exec-10] DEBUG i.b.n.c.c.c.s.RedisBackedCacheService - puts key: /j8583_000000209350/bjb/55, object: ""820274009F360203179F260865037DFF593D089F9F2701809F34030200009F101C0101A000800000864F7E3600000000000000000000000000000000009F3303E0F8C89F350114950508800410009F3704EBF8509D9F02060000000000005A096220110200206380745F3401009F1A0203605F2A0203609A032309189C01009F090200009F1E0830303030303930354F07A00000060210108407A00000060210109F410400000516"", timeout: 15, timeunit: MINUTES
11:27:11.074 [http-nio-9872-exec-10] DEBUG i.b.n.c.c.c.s.RedisBackedCacheService - puts key: /j8583_000000209350, object: {""dataB64"":""MDIwMEYyM0M0NDgxQThFMDkyMDAwMDAwMDA0MDA0MDAwMDIwMTg2MjIwMTEwMjAwMjA2MzgwNzQwMDAwMDAwMDAwMDUxMDAwMDAwOTE4MDQyNzExMjA5MzUwMTEyNzExMDkxODI4MDI2MDEyMDUxMDAwMzExMDA2MzYwMDAxMjY2MjIwMTEwMjAwMjA2MzgwNzREMjgwMjIyMTAwMDAwMDIwOTM1MDcwMDQwMDAxNzAwNDAwMDEwMDAxICAgTWVuYXJhIEJDQSAzOXRoIEZsb29yIEtvdGEgUGFsdSAgICAgSkJJRDM2MDJBQjA1MjQzQTZCRTI0QzUxNjiCAnQAnzYCAxefJghlA33/WT0In58nAYCfNAMCAACfEBwBAaAAgAAAhk9+NgAAAAAAAAAAAAAAAAAAAAAAnzMD4PjInzUBFJUFCIAEEACfNwTr+FCdnwIGAAAAAAAAWgliIBECACBjgHRfNAEAnxoCA2BfKgIDYJoDIwkYnAEAnwkCAACfHggwMDAwMDkwNU8HoAAABgIQEIQHoAAABgIQEJ9BBAAABRYwMjAwMjA5MzUwMDkxODA0MjcxMTAwMDAwMDAwMTEwMDAwMDAzNjAwMDExMzAxMjgwNDg4MzkxMDcwMjAwMDAwMjA5MzUwMDAwMDIwOTM1MA=="",""binaryHeader"":false,""isoHeader"":null,""binaryHeaderB64"":null}, timeout: 10, timeunit: MINUTES
11:27:11.075 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] WRITE: Message: 0200F23C4481A8E09200000000400400002018622011020020638074000000000005100000091804271120935011271109182802601205100031100636000126622011020020638074D280222100000020935070040001700400010001   Menara BCA 39th Floor Kota Palu     JBID3602AB05243A6BE24C5336820274009F360203179F260865037DFF593D089F9F2701809F34030200009F101C0101A000800000864F7E3600000000000000000000000000000000009F3303E0F8C89F350114950508800410009F3704EBF8509D9F02060000000000005A096220110200206380745F3401009F1A0203605F2A0203609A032309189C01009F090200009F1E0830303030303930354F07A00000060210108407A00000060210109F41040000051602002093500918042711000000001100000036000113012804883910702000002093500000209350
MTI: 0x0200
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '000000'
  4: [NUMERIC(12)] = '000005100000'
  7: [NUMERIC(10)] = '0918042711'
  11: [NUMERIC(6)] = '209350'
  12: [NUMERIC(6)] = '112711'
  13: [DATE4(4)] = '0918'
  14: [NUMERIC(4)] = '2802'
  18: [NUMERIC(4)] = '6012'
  22: [NUMERIC(3)] = '051'
  25: [NUMERIC(2)] = '00'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '360001'
  35: [LLBCDBIN(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209350'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA 39th Floor Kota Palu     JBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = '2AB05243A6BE24C5'
  55: [LLLBIN(168)] = '820274009F360203179F260865037DFF593D089F9F2701809F34030200009F101C0101A000800000864F7E3600000000000000000000000000000000009F3303E0F8C89F350114950508800410009F3704EBF8509D9F02060000000000005A096220110200206380745F3401009F1A0203605F2A0203609A032309189C01009F090200009F1E0830303030303930354F07A00000060210108407A00000060210109F410400000516'
  90: [NUMERIC(42)] = '020020935009180427110000000011000000360001'
  102: [LLVAR(13)] = '0128048839107'
  123: [LLLVAR(20)] = '00002093500000209350'
11:27:11.075 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] FLUSH
11:27:11.076 [http-nio-9872-exec-10] DEBUG id.basys.ntt.edc.iso.MbIsoListener - RRN: 209350, Waiting for 70
11:27:11.775 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - INCOMING: 303231303732333834343031414145303932303031383632323031313032303032303633383037343030303030303030303030353130303030303039313830343237313132303933353031313237313130393138363031323035313033313130303633363030303132363632323031313032303032303633383037344432383032323231303030303030323039333530353137303034303030313730303430303031303030312020204d656e61726120424341203339746820466c6f6f72204b6f74612050616c7520202020204a424944333630324142303532343341364245323443353032309f2701805f340100910ac030674a2417da9f3531
11:27:11.775 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - CUTS: 303231303732333834343031414145303932303031383632323031313032303032303633383037343030303030303030303030353130303030303039313830343237313132303933353031313237313130393138363031323035313033313130303633363030303132363632323031313032303032303633383037344432383032323231303030303030323039333530353137303034303030313730303430303031303030312020204d656e61726120424341203339746820466c6f6f72204b6f74612050616c7520202020204a424944333630324142303532343341364245323443353032309f2701805f340100910ac030674a2417da9f3531
11:27:11.776 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ: Message: 021072384401AAE0920018622011020020638074000000000005100000091804271120935011271109186012051031100636000126622011020020638074D28022210000002093505170040001700400010001   Menara BCA 39th Floor Kota Palu     JBID3602AB05243A6BE24C50409F2701805F340100910AC030674A2417DA9F3531
MTI: 0x0210
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '000000'
  4: [NUMERIC(12)] = '000005100000'
  7: [NUMERIC(10)] = '0918042711'
  11: [NUMERIC(6)] = '209350'
  12: [TIME(6)] = '112711'
  13: [DATE4(4)] = '0918'
  18: [NUMERIC(4)] = '6012'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '360001'
  35: [LLVAR(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209350'
  39: [ALPHA(2)] = '51'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA 39th Floor Kota Palu     JBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = '2AB05243A6BE24C5'
  55: [LLLBIN(40)] = '9F2701805F340100910AC030674A2417DA9F3531'
11:27:11.776 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ COMPLETE
11:27:11.776 [pool-1-thread-69] INFO  i.b.n.e.iso.IsoListenerProcessorImpl - handling 0210, rrn:209350
11:27:11.776 [pool-1-thread-69] DEBUG id.basys.ntt.edc.iso.MbIsoListener - Received response of 209350"
h4snXf8E,MUNFAQQIHA's List of Twitter Post Links,Munfaqqiha,C++,Sunday 17th of September 2023 11:28:23 PM CDT,"https://twitter.com/petasangu/status/1703418405288808881
https://twitter.com/petasangu/status/1703409650778202122
https://twitter.com/petasangu/status/1703377781676245085
https://twitter.com/petasangu/status/1703348736091734158
https://twitter.com/petasangu/status/1703328786962677771
https://twitter.com/petasangu/status/1703315764206571693
https://twitter.com/petasangu/status/1703313015553348039
https://twitter.com/petasangu/status/1703308761073639820
https://twitter.com/petasangu/status/1703306169757151654
https://twitter.com/petasangu/status/1703299413450674379
https://twitter.com/petasangu/status/1703295963664937091
https://twitter.com/petasangu/status/1703293451666948435
https://twitter.com/petasangu/status/1703290756390326607
https://twitter.com/petasangu/status/1703287076542943474
https://twitter.com/petasangu/status/1703284467404878235
https://twitter.com/petasangu/status/1703281144081592378
https://twitter.com/petasangu/status/1703277293874118994
https://twitter.com/petasangu/status/1703273424280514571
https://twitter.com/petasangu/status/1703272232993313134
https://twitter.com/petasangu/status/1703265384349221337
https://twitter.com/petasangu/status/1703251890728046675
https://twitter.com/petasangu/status/1703263248320201212
https://twitter.com/petasangu/status/1703249037770866712
https://twitter.com/petasangu/status/1703240648055558414
https://twitter.com/petasangu/status/1703232953869119732
https://twitter.com/petasangu/status/1703230224606044342
https://twitter.com/petasangu/status/1703223415791083763
https://twitter.com/petasangu/status/1703215206468600227
https://twitter.com/petasangu/status/1703216265295528213
https://twitter.com/petasangu/status/1703196752541819247
https://twitter.com/petasangu/status/1703192509822992713
https://twitter.com/petasangu/status/1703188871482327213
https://twitter.com/petasangu/status/1703186288256705019
https://twitter.com/petasangu/status/1702644769581924692
https://twitter.com/petasangu/status/1703245731577188571
https://twitter.com/petasangu/status/1701911045097550013
https://twitter.com/petasangu/status/1701950596956258419
https://twitter.com/petasangu/status/1701909505217564920
https://twitter.com/petasangu/status/1701908957475008515
https://twitter.com/petasangu/status/1701416256912687601
https://twitter.com/petasangu/status/1701415227374682430
https://twitter.com/petasangu/status/1701414238156468651
https://twitter.com/petasangu/status/1701411914641998148
https://twitter.com/petasangu/status/1701411238222414107
https://twitter.com/petasangu/status/1701291449453781243
https://twitter.com/petasangu/status/1700950399497519311
https://twitter.com/petasangu/status/1700946810137907651
https://twitter.com/petasangu/status/1700942687590048014
https://twitter.com/petasangu/status/1700937960861102473"
cNvyKfpJ,Log ISO Bit 51 Pos BJB 18/09/2023 11:24,Abikayusri19,Bash,Sunday 17th of September 2023 11:26:21 PM CDT,"11:24:37.982 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ===========================request begin================================================
11:24:37.982 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - URI         : http://bjb-hsm/bjb/hsm/pin
11:24:37.982 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Headers     : [Accept:""application/json, application/*+json"", Content-Type:""application/json"", Content-Length:""88""]
11:24:37.982 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Request body: {""terminalId"":""70040001"",""pinUnderTpk"":""D468ACCD6373A494"",""cardNo"":""622011020020638074""}
11:24:37.982 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ==========================request end================================================
11:24:38.023 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ============================response begin==========================================
11:24:38.023 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status code  : 200 OK
11:24:38.023 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status text  : 
11:24:38.023 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Response body: {""pinBlock"":""2AB05243A6BE24C5""}
11:24:38.023 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - =======================response end=================================================
11:24:38.025 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Updated bitmap: {32=110, 33=000110, 2=622011020020638074, 3=000000, 35=622011020020638074D2802221, 4=5500000, 37=000000209346, 102=0128048839107, 7=0918042437, 41=70040001, 42=700400010001, 43=Menara BCA Lt 39      KABUPATEN TOLIJBID, 11=209346, 12=112437, 13=0918, 14=2802, 49=360, 18=6012, 52=2AB05243A6BE24C5, 22=051, 55=820274009F360203159F2608F8EFDF315DFF53079F2701809F34030200009F101C0101A000800000BC853A9300000000000000000000000000000000009F3303E0F8C89F350114950508800480009F37043523AB0B9F02060000055000005A096220110200206380745F3401009F1A0203605F2A0203609A032309189C01009F090200009F1E0830303030303930354F07A00000060210108407A00000060210109F410400000515, 25=00, 90=020020934609180424370000000011000000000110}
11:24:38.026 [http-nio-9872-exec-7] DEBUG i.b.n.c.c.c.s.RedisBackedCacheService - puts key: /j8583_000000209346/bjb/55, object: ""820274009F360203159F2608F8EFDF315DFF53079F2701809F34030200009F101C0101A000800000BC853A9300000000000000000000000000000000009F3303E0F8C89F350114950508800480009F37043523AB0B9F02060000055000005A096220110200206380745F3401009F1A0203605F2A0203609A032309189C01009F090200009F1E0830303030303930354F07A00000060210108407A00000060210109F410400000515"", timeout: 15, timeunit: MINUTES
11:24:38.027 [http-nio-9872-exec-7] DEBUG i.b.n.c.c.c.s.RedisBackedCacheService - puts key: /j8583_000000209346, object: {""dataB64"":""MDIwMEYyM0M0NDgxQThFMDkyMDAwMDAwMDA0MDA0MDAwMDIwMTg2MjIwMTEwMjAwMjA2MzgwNzQwMDAwMDAwMDAwMDU1MDAwMDAwOTE4MDQyNDM3MjA5MzQ2MTEyNDM3MDkxODI4MDI2MDEyMDUxMDAwMzExMDA2MDAwMTEwMjY2MjIwMTEwMjAwMjA2MzgwNzREMjgwMjIyMTAwMDAwMDIwOTM0NjcwMDQwMDAxNzAwNDAwMDEwMDAxICAgTWVuYXJhIEJDQSBMdCAzOSAgICAgIEtBQlVQQVRFTiBUT0xJSkJJRDM2MDJBQjA1MjQzQTZCRTI0QzUxNjiCAnQAnzYCAxWfJgj4798xXf9TB58nAYCfNAMCAACfEBwBAaAAgAAAvIU6kwAAAAAAAAAAAAAAAAAAAAAAnzMD4PjInzUBFJUFCIAEgACfNwQ1I6sLnwIGAAAFUAAAWgliIBECACBjgHRfNAEAnxoCA2BfKgIDYJoDIwkYnAEAnwkCAACfHggwMDAwMDkwNU8HoAAABgIQEIQHoAAABgIQEJ9BBAAABRUwMjAwMjA5MzQ2MDkxODA0MjQzNzAwMDAwMDAwMTEwMDAwMDAwMDAxMTAxMzAxMjgwNDg4MzkxMDcwMjAwMDAwMjA5MzQ2MDAwMDIwOTM0Ng=="",""binaryHeader"":false,""isoHeader"":null,""binaryHeaderB64"":null}, timeout: 10, timeunit: MINUTES
11:24:38.027 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] WRITE: Message: 0200F23C4481A8E09200000000400400002018622011020020638074000000000005500000091804243720934611243709182802601205100031100600011026622011020020638074D280222100000020934670040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID3602AB05243A6BE24C5336820274009F360203159F2608F8EFDF315DFF53079F2701809F34030200009F101C0101A000800000BC853A9300000000000000000000000000000000009F3303E0F8C89F350114950508800480009F37043523AB0B9F02060000055000005A096220110200206380745F3401009F1A0203605F2A0203609A032309189C01009F090200009F1E0830303030303930354F07A00000060210108407A00000060210109F41040000051502002093460918042437000000001100000000011013012804883910702000002093460000209346
MTI: 0x0200
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '000000'
  4: [NUMERIC(12)] = '000005500000'
  7: [NUMERIC(10)] = '0918042437'
  11: [NUMERIC(6)] = '209346'
  12: [NUMERIC(6)] = '112437'
  13: [DATE4(4)] = '0918'
  14: [NUMERIC(4)] = '2802'
  18: [NUMERIC(4)] = '6012'
  22: [NUMERIC(3)] = '051'
  25: [NUMERIC(2)] = '00'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLBCDBIN(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209346'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = '2AB05243A6BE24C5'
  55: [LLLBIN(168)] = '820274009F360203159F2608F8EFDF315DFF53079F2701809F34030200009F101C0101A000800000BC853A9300000000000000000000000000000000009F3303E0F8C89F350114950508800480009F37043523AB0B9F02060000055000005A096220110200206380745F3401009F1A0203605F2A0203609A032309189C01009F090200009F1E0830303030303930354F07A00000060210108407A00000060210109F410400000515'
  90: [NUMERIC(42)] = '020020934609180424370000000011000000000110'
  102: [LLVAR(13)] = '0128048839107'
  123: [LLLVAR(20)] = '00002093460000209346'
11:24:38.027 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] FLUSH
11:24:38.028 [http-nio-9872-exec-7] DEBUG id.basys.ntt.edc.iso.MbIsoListener - RRN: 209346, Waiting for 70
11:24:39.606 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - INCOMING: 303231303732333834343031414145303932303031383632323031313032303032303633383037343030303030303030303030353530303030303039313830343234333732303933343631313234333730393138363031323035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333436353137303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a424944333630324142303532343341364245323443353032309f2701805f340100910a364ceac9533f11ae3531
11:24:39.606 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - CUTS: 303231303732333834343031414145303932303031383632323031313032303032303633383037343030303030303030303030353530303030303039313830343234333732303933343631313234333730393138363031323035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333436353137303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a424944333630324142303532343341364245323443353032309f2701805f340100910a364ceac9533f11ae3531
11:24:39.606 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ: Message: 021072384401AAE0920018622011020020638074000000000005500000091804243720934611243709186012051031100600011026622011020020638074D28022210000002093465170040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID3602AB05243A6BE24C50409F2701805F340100910A364CEAC9533F11AE3531
MTI: 0x0210
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '000000'
  4: [NUMERIC(12)] = '000005500000'
  7: [NUMERIC(10)] = '0918042437'
  11: [NUMERIC(6)] = '209346'
  12: [TIME(6)] = '112437'
  13: [DATE4(4)] = '0918'
  18: [NUMERIC(4)] = '6012'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLVAR(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209346'
  39: [ALPHA(2)] = '51'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = '2AB05243A6BE24C5'
  55: [LLLBIN(40)] = '9F2701805F340100910A364CEAC9533F11AE3531'
11:24:39.606 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ COMPLETE
11:24:39.607 [pool-1-thread-68] INFO  i.b.n.e.iso.IsoListenerProcessorImpl - handling 0210, rrn:209346
11:24:39.607 [pool-1-thread-68] DEBUG id.basys.ntt.edc.iso.MbIsoListener - Received response of 209346
11:24:39.628 [http-nio-9872-exec-7] DEBUG i.b.n.e.i.CensorCommonsRequestLoggingFilter - After request [POST /trx, payload={""dataMap"":{""32"":""110"",""33"":""000110"",""2"":""622011020020638074"",""3"":""000000"",""35"":""622011******638074D2802221"",""4"":""5500000"",""102"":""0128048839107"",""7"":""0918042437"",""41"":""70040001"",""42"":""700400010001"",""43"":""Menara BCA Lt 39      KABUPATEN TOLIJBID"",""12"":""112437"",""13"":""0918"",""14"":""2802"",""49"":""360"",""18"":""6012"",""52"":""D468ACCD6373A494"",""22"":""051"",""55"":""622011"",""25"":""00""},""rc"":null,""rrn"":null,""tracenum"":null,""mti"":512}]"
tQqqBGPs,TooManyRequests: received 429 HTTP response,Vault-TecTradingCo,Python,Sunday 17th of September 2023 11:20:00 PM CDT,"Traceback (most recent call last):
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/main.py"", line 258, in main
    for comment in comment_stream:
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/praw/models/util.py"", line 138, in stream_generator
    for item in reversed(list(function(limit=limit, **function_kwargs))):
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/praw/models/listing/generator.py"", line 63, in __next__
    self._next_batch()
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/praw/models/listing/generator.py"", line 89, in _next_batch
    self._listing = self._reddit.get(self.url, params=self.params)
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/praw/util/deprecate_args.py"", line 43, in wrapped
    return func(**dict(zip(_old_args, args)), **kwargs)
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/praw/reddit.py"", line 712, in get
    return self._objectify_request(method=""GET"", params=params, path=path)
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/praw/reddit.py"", line 517, in _objectify_request
    self.request(
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/praw/util/deprecate_args.py"", line 43, in wrapped
    return func(**dict(zip(_old_args, args)), **kwargs)
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/praw/reddit.py"", line 941, in request
    return self._core.request(
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/prawcore/sessions.py"", line 330, in request
    return self._request_with_retries(
  File ""/root/Bots/Fallout76MarketplaceKarmaTransferBot/venv/lib/python3.10/site-packages/prawcore/sessions.py"", line 266, in _request_with_retries
    raise self.STATUS_EXCEPTIONS[response.status_code](response)
prawcore.exceptions.TooManyRequests: received 429 HTTP response
"
6VJgTcMe,Untitled,Ethan-ZYF,C++,Sunday 17th of September 2023 11:17:45 PM CDT,"#include <bits/stdc++.h>
using namespace std;
using i64 = long long;

void solve() {
    int N, Q;
    cin >> N;

    vector<int> A(N);
    for (int i = 0; i < N; i++) {
        cin >> A[i];
    }
    const int M = *max_element(A.begin(), A.end()) + 1;

    vector<int> freq(M);
    const int B = sqrtl(N);
    cin >> Q;
    vector<array<int, 3>> query(Q);
    for (int i = 0; i < Q; i++) {
        int l, r;
        cin >> l >> r;
        l--;
        query[i] = {l, r, i};
    }
    sort(query.begin(), query.end(), [&](auto a, auto b) {
        if (a[0] / B != b[0] / B) {
            return a[0] < b[0];
        } else {
            return a[1] < b[1];
        }
    });
    i64 res = 0;
    vector<i64> ans(Q);

    auto add = [&](int x) {
        res += freq[x] == 0;
        freq[x] += 1;
    };
    auto del = [&](int x) {
        freq[x] -= 1;
        res -= freq[x] == 0;
    };

    int L = 0, R = 0;
    for (auto [l, r, i] : query) {
        while (R < r) {
            add(A[R++]);
        }
        while (L > l) {
            add(A[--L]);
        }
        while (R > r) {
            del(A[--R]);
        }
        while (L < l) {
            del(A[L++]);
        }
        ans[i] = res;
    }
    for (int i = 0; i < Q; i++) {
        cout << ans[i] << ""\n"";
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    int T = 1;
    // cin >> T;
    for (int Task = 1; Task <= T; Task++) {
        solve();
    }

    return 0;
}"
u46sFATs,ID,Peluchecoman,Lua,Sunday 17th of September 2023 10:35:37 PM CDT,"3115954513,
1581870246,"
vzS0uaHb,News Sep17 23,Newscaster_Ned,Email,Sunday 17th of September 2023 10:28:18 PM CDT,".‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎T‎‎‎e‎‎‎s‎‎‎t‎‎‎ ‎‎‎1‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎
.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎T‎‎‎e‎‎‎s‎‎‎t‎‎‎ ‎‎‎2‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎
.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎T‎‎‎e‎‎‎s‎‎‎t‎‎‎ ‎‎‎3‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎
.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎ ‎‎‎T‎‎‎e‎‎‎s‎‎‎t‎‎‎ ‎‎‎c‎‎‎o‎‎‎m‎‎‎p‎‎‎l‎‎‎e‎‎‎t‎‎‎e‎‎‎.‎‎‎

H‎‎‎e‎‎‎r‎‎‎e‎‎‎'‎‎‎s‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎n‎‎‎e‎‎‎w‎‎‎s‎‎‎,‎‎‎ ‎‎‎y‎‎‎o‎‎‎u‎‎‎ ‎‎‎p‎‎‎u‎‎‎b‎‎‎e‎‎‎h‎‎‎e‎‎‎a‎‎‎d‎‎‎.‎‎‎

W‎‎‎A‎‎‎T‎‎‎C‎‎‎H‎‎‎:‎‎‎ ‎‎‎H‎‎‎a‎‎‎n‎‎‎d‎‎‎c‎‎‎u‎‎‎f‎‎‎f‎‎‎e‎‎‎d‎‎‎ ‎‎‎B‎‎‎e‎‎‎n‎‎‎g‎‎‎a‎‎‎l‎‎‎s‎‎‎ ‎‎‎F‎‎‎a‎‎‎n‎‎‎ ‎‎‎D‎‎‎e‎‎‎l‎‎‎i‎‎‎v‎‎‎e‎‎‎r‎‎‎s‎‎‎ ‎‎‎P‎‎‎e‎‎‎r‎‎‎f‎‎‎e‎‎‎c‎‎‎t‎‎‎ ‎‎‎H‎‎‎e‎‎‎a‎‎‎d‎‎‎ ‎‎‎B‎‎‎u‎‎‎t‎‎‎t‎‎‎ ‎‎‎A‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎L‎‎‎o‎‎‎s‎‎‎s‎‎‎
N‎‎‎F‎‎‎L‎‎‎ ‎‎‎R‎‎‎e‎‎‎f‎‎‎e‎‎‎r‎‎‎e‎‎‎e‎‎‎ ‎‎‎R‎‎‎e‎‎‎f‎‎‎u‎‎‎s‎‎‎e‎‎‎s‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎B‎‎‎e‎‎‎ ‎‎‎I‎‎‎n‎‎‎t‎‎‎e‎‎‎r‎‎‎r‎‎‎u‎‎‎p‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎b‎‎‎y‎‎‎ ‎‎‎P‎‎‎l‎‎‎a‎‎‎y‎‎‎e‎‎‎r‎‎‎:‎‎‎ ‎‎‎'‎‎‎I‎‎‎'‎‎‎m‎‎‎ ‎‎‎T‎‎‎a‎‎‎l‎‎‎k‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎A‎‎‎m‎‎‎e‎‎‎r‎‎‎i‎‎‎c‎‎‎a‎‎‎'‎‎‎
R‎‎‎u‎‎‎s‎‎‎s‎‎‎e‎‎‎l‎‎‎l‎‎‎ ‎‎‎B‎‎‎r‎‎‎a‎‎‎n‎‎‎d‎‎‎'‎‎‎s‎‎‎ ‎‎‎A‎‎‎g‎‎‎e‎‎‎n‎‎‎t‎‎‎s‎‎‎ ‎‎‎D‎‎‎r‎‎‎o‎‎‎p‎‎‎ ‎‎‎A‎‎‎c‎‎‎t‎‎‎o‎‎‎r‎‎‎ ‎‎‎A‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎R‎‎‎a‎‎‎p‎‎‎e‎‎‎,‎‎‎ ‎‎‎S‎‎‎e‎‎‎x‎‎‎u‎‎‎a‎‎‎l‎‎‎ ‎‎‎A‎‎‎s‎‎‎s‎‎‎a‎‎‎u‎‎‎l‎‎‎t‎‎‎ ‎‎‎C‎‎‎l‎‎‎a‎‎‎i‎‎‎m‎‎‎s‎‎‎
K‎‎‎a‎‎‎r‎‎‎e‎‎‎e‎‎‎m‎‎‎ ‎‎‎J‎‎‎a‎‎‎c‎‎‎k‎‎‎s‎‎‎o‎‎‎n‎‎‎ ‎‎‎E‎‎‎j‎‎‎e‎‎‎c‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎A‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎V‎‎‎i‎‎‎c‎‎‎i‎‎‎o‎‎‎u‎‎‎s‎‎‎ ‎‎‎H‎‎‎i‎‎‎t‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎C‎‎‎o‎‎‎m‎‎‎m‎‎‎a‎‎‎n‎‎‎d‎‎‎e‎‎‎r‎‎‎s‎‎‎'‎‎‎ ‎‎‎L‎‎‎o‎‎‎g‎‎‎a‎‎‎n‎‎‎ ‎‎‎T‎‎‎h‎‎‎o‎‎‎m‎‎‎a‎‎‎s‎‎‎
G‎‎‎e‎‎‎t‎‎‎ ‎‎‎A‎‎‎l‎‎‎l‎‎‎ ‎‎‎B‎‎‎r‎‎‎e‎‎‎i‎‎‎t‎‎‎b‎‎‎a‎‎‎r‎‎‎t‎‎‎ ‎‎‎N‎‎‎e‎‎‎w‎‎‎s‎‎‎ ‎‎‎H‎‎‎e‎‎‎r‎‎‎e‎‎‎
E‎‎‎x‎‎‎c‎‎‎l‎‎‎u‎‎‎s‎‎‎i‎‎‎v‎‎‎e‎‎‎:‎‎‎ ‎‎‎S‎‎‎e‎‎‎n‎‎‎.‎‎‎ ‎‎‎J‎‎‎.‎‎‎D‎‎‎.‎‎‎ ‎‎‎V‎‎‎a‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎D‎‎‎e‎‎‎m‎‎‎a‎‎‎n‎‎‎d‎‎‎s‎‎‎ ‎‎‎B‎‎‎i‎‎‎d‎‎‎e‎‎‎n‎‎‎ ‎‎‎A‎‎‎d‎‎‎m‎‎‎i‎‎‎n‎‎‎ ‎‎‎R‎‎‎e‎‎‎v‎‎‎e‎‎‎a‎‎‎l‎‎‎ ‎‎‎i‎‎‎f‎‎‎ ‎‎‎A‎‎‎m‎‎‎e‎‎‎r‎‎‎i‎‎‎c‎‎‎a‎‎‎n‎‎‎ ‎‎‎T‎‎‎r‎‎‎a‎‎‎n‎‎‎s‎‎‎ ‎‎‎‘‎‎‎S‎‎‎p‎‎‎o‎‎‎k‎‎‎e‎‎‎s‎‎‎p‎‎‎e‎‎‎r‎‎‎s‎‎‎o‎‎‎n‎‎‎’‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎U‎‎‎k‎‎‎r‎‎‎a‎‎‎i‎‎‎n‎‎‎e‎‎‎ ‎‎‎M‎‎‎i‎‎‎l‎‎‎i‎‎‎t‎‎‎a‎‎‎r‎‎‎y‎‎‎ ‎‎‎H‎‎‎a‎‎‎s‎‎‎ ‎‎‎U‎‎‎.‎‎‎S‎‎‎.‎‎‎ ‎‎‎I‎‎‎n‎‎‎t‎‎‎e‎‎‎l‎‎‎l‎‎‎i‎‎‎g‎‎‎e‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎T‎‎‎i‎‎‎e‎‎‎s‎‎‎
S‎‎‎a‎‎‎r‎‎‎a‎‎‎h‎‎‎ ‎‎‎A‎‎‎s‎‎‎h‎‎‎t‎‎‎o‎‎‎n‎‎‎-‎‎‎C‎‎‎i‎‎‎r‎‎‎i‎‎‎l‎‎‎l‎‎‎o‎‎‎,‎‎‎ ‎‎‎T‎‎‎w‎‎‎i‎‎‎t‎‎‎t‎‎‎e‎‎‎r‎‎‎
S‎‎‎e‎‎‎n‎‎‎a‎‎‎t‎‎‎o‎‎‎r‎‎‎ ‎‎‎J‎‎‎.‎‎‎D‎‎‎.‎‎‎ ‎‎‎V‎‎‎a‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎(‎‎‎R‎‎‎-‎‎‎O‎‎‎H‎‎‎)‎‎‎ ‎‎‎h‎‎‎a‎‎‎s‎‎‎ ‎‎‎w‎‎‎r‎‎‎i‎‎‎t‎‎‎t‎‎‎e‎‎‎n‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎t‎‎‎o‎‎‎p‎‎‎ ‎‎‎B‎‎‎i‎‎‎d‎‎‎e‎‎‎n‎‎‎ ‎‎‎a‎‎‎d‎‎‎m‎‎‎i‎‎‎n‎‎‎i‎‎‎s‎‎‎t‎‎‎r‎‎‎a‎‎‎t‎‎‎i‎‎‎o‎‎‎n‎‎‎ ‎‎‎o‎‎‎f‎‎‎f‎‎‎i‎‎‎c‎‎‎i‎‎‎a‎‎‎l‎‎‎s‎‎‎ ‎‎‎d‎‎‎e‎‎‎m‎‎‎a‎‎‎n‎‎‎d‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎W‎‎‎h‎‎‎i‎‎‎t‎‎‎e‎‎‎ ‎‎‎H‎‎‎o‎‎‎u‎‎‎s‎‎‎e‎‎‎ ‎‎‎r‎‎‎e‎‎‎v‎‎‎e‎‎‎a‎‎‎l‎‎‎ ‎‎‎i‎‎‎f‎‎‎ ‎‎‎S‎‎‎a‎‎‎r‎‎‎a‎‎‎h‎‎‎ ‎‎‎A‎‎‎s‎‎‎h‎‎‎t‎‎‎o‎‎‎n‎‎‎-‎‎‎C‎‎‎i‎‎‎r‎‎‎i‎‎‎l‎‎‎l‎‎‎o‎‎‎,‎‎‎ ‎‎‎a‎‎‎ ‎‎‎t‎‎‎r‎‎‎a‎‎‎n‎‎‎s‎‎‎g‎‎‎e‎‎‎n‎‎‎d‎‎‎e‎‎‎r‎‎‎ ‎‎‎i‎‎‎n‎‎‎d‎‎‎i‎‎‎v‎‎‎i‎‎‎d‎‎‎u‎‎‎a‎‎‎l‎‎‎ ‎‎‎c‎‎‎l‎‎‎a‎‎‎i‎‎‎m‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎b‎‎‎e‎‎‎ ‎‎‎a‎‎‎ ‎‎‎s‎‎‎p‎‎‎o‎‎‎k‎‎‎e‎‎‎s‎‎‎p‎‎‎e‎‎‎r‎‎‎s‎‎‎o‎‎‎n‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎U‎‎‎k‎‎‎r‎‎‎a‎‎‎i‎‎‎n‎‎‎i‎‎‎a‎‎‎n‎‎‎ ‎‎‎m‎‎‎i‎‎‎l‎‎‎i‎‎‎t‎‎‎a‎‎‎r‎‎‎y‎‎‎,‎‎‎ ‎‎‎h‎‎‎a‎‎‎s‎‎‎ ‎‎‎t‎‎‎i‎‎‎e‎‎‎s‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎A‎‎‎m‎‎‎e‎‎‎r‎‎‎i‎‎‎c‎‎‎a‎‎‎n‎‎‎ ‎‎‎i‎‎‎n‎‎‎t‎‎‎e‎‎‎l‎‎‎l‎‎‎i‎‎‎g‎‎‎e‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎s‎‎‎e‎‎‎r‎‎‎v‎‎‎i‎‎‎c‎‎‎e‎‎‎s‎‎‎ ‎‎‎o‎‎‎r‎‎‎ ‎‎‎r‎‎‎e‎‎‎c‎‎‎e‎‎‎i‎‎‎v‎‎‎e‎‎‎s‎‎‎ ‎‎‎U‎‎‎.‎‎‎S‎‎‎.‎‎‎ ‎‎‎f‎‎‎u‎‎‎n‎‎‎d‎‎‎i‎‎‎n‎‎‎g‎‎‎.‎‎‎

W‎‎‎e‎‎‎s‎‎‎t‎‎‎ ‎‎‎M‎‎‎u‎‎‎s‎‎‎t‎‎‎ ‎‎‎P‎‎‎r‎‎‎e‎‎‎p‎‎‎a‎‎‎r‎‎‎e‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎a‎‎‎ ‎‎‎'‎‎‎L‎‎‎o‎‎‎n‎‎‎g‎‎‎ ‎‎‎W‎‎‎a‎‎‎r‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎U‎‎‎k‎‎‎r‎‎‎a‎‎‎i‎‎‎n‎‎‎e‎‎‎'‎‎‎ ‎‎‎S‎‎‎a‎‎‎y‎‎‎s‎‎‎ ‎‎‎N‎‎‎A‎‎‎T‎‎‎O‎‎‎ ‎‎‎C‎‎‎h‎‎‎i‎‎‎e‎‎‎f‎‎‎
W‎‎‎e‎‎‎s‎‎‎t‎‎‎ ‎‎‎M‎‎‎u‎‎‎s‎‎‎t‎‎‎ ‎‎‎P‎‎‎r‎‎‎e‎‎‎p‎‎‎a‎‎‎r‎‎‎e‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎a‎‎‎ ‎‎‎'‎‎‎L‎‎‎o‎‎‎n‎‎‎g‎‎‎ ‎‎‎W‎‎‎a‎‎‎r‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎U‎‎‎k‎‎‎r‎‎‎a‎‎‎i‎‎‎n‎‎‎e‎‎‎'‎‎‎ ‎‎‎S‎‎‎a‎‎‎y‎‎‎s‎‎‎ ‎‎‎N‎‎‎A‎‎‎T‎‎‎O‎‎‎ ‎‎‎C‎‎‎h‎‎‎i‎‎‎e‎‎‎f‎‎‎
3‎‎‎,‎‎‎1‎‎‎7‎‎‎3‎‎‎
E‎‎‎x‎‎‎c‎‎‎l‎‎‎u‎‎‎s‎‎‎i‎‎‎v‎‎‎e‎‎‎ ‎‎‎—‎‎‎ ‎‎‎M‎‎‎c‎‎‎C‎‎‎a‎‎‎r‎‎‎t‎‎‎h‎‎‎y‎‎‎ ‎‎‎C‎‎‎a‎‎‎l‎‎‎l‎‎‎s‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎A‎‎‎l‎‎‎l‎‎‎-‎‎‎M‎‎‎e‎‎‎m‎‎‎b‎‎‎e‎‎‎r‎‎‎s‎‎‎ ‎‎‎C‎‎‎l‎‎‎a‎‎‎s‎‎‎s‎‎‎i‎‎‎f‎‎‎i‎‎‎e‎‎‎d‎‎‎ ‎‎‎B‎‎‎r‎‎‎i‎‎‎e‎‎‎f‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎B‎‎‎o‎‎‎r‎‎‎d‎‎‎e‎‎‎r‎‎‎
E‎‎‎x‎‎‎c‎‎‎l‎‎‎u‎‎‎s‎‎‎i‎‎‎v‎‎‎e‎‎‎ ‎‎‎—‎‎‎ ‎‎‎M‎‎‎c‎‎‎C‎‎‎a‎‎‎r‎‎‎t‎‎‎h‎‎‎y‎‎‎ ‎‎‎C‎‎‎a‎‎‎l‎‎‎l‎‎‎s‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎A‎‎‎l‎‎‎l‎‎‎-‎‎‎M‎‎‎e‎‎‎m‎‎‎b‎‎‎e‎‎‎r‎‎‎s‎‎‎ ‎‎‎C‎‎‎l‎‎‎a‎‎‎s‎‎‎s‎‎‎i‎‎‎f‎‎‎i‎‎‎e‎‎‎d‎‎‎ ‎‎‎B‎‎‎r‎‎‎i‎‎‎e‎‎‎f‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎B‎‎‎o‎‎‎r‎‎‎d‎‎‎e‎‎‎r‎‎‎
3‎‎‎,‎‎‎3‎‎‎5‎‎‎6‎‎‎
M‎‎‎a‎‎‎r‎‎‎e‎‎‎n‎‎‎ ‎‎‎M‎‎‎o‎‎‎r‎‎‎r‎‎‎i‎‎‎s‎‎‎ ‎‎‎A‎‎‎n‎‎‎n‎‎‎o‎‎‎u‎‎‎n‎‎‎c‎‎‎e‎‎‎s‎‎‎ ‎‎‎S‎‎‎h‎‎‎e‎‎‎'‎‎‎s‎‎‎ ‎‎‎L‎‎‎e‎‎‎a‎‎‎v‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎'‎‎‎R‎‎‎a‎‎‎c‎‎‎i‎‎‎s‎‎‎t‎‎‎ ‎‎‎&‎‎‎ ‎‎‎H‎‎‎o‎‎‎m‎‎‎o‎‎‎p‎‎‎h‎‎‎o‎‎‎b‎‎‎i‎‎‎c‎‎‎'‎‎‎ ‎‎‎C‎‎‎o‎‎‎u‎‎‎n‎‎‎t‎‎‎r‎‎‎y‎‎‎ ‎‎‎M‎‎‎u‎‎‎s‎‎‎i‎‎‎c‎‎‎
M‎‎‎a‎‎‎r‎‎‎e‎‎‎n‎‎‎ ‎‎‎M‎‎‎o‎‎‎r‎‎‎r‎‎‎i‎‎‎s‎‎‎ ‎‎‎A‎‎‎n‎‎‎n‎‎‎o‎‎‎u‎‎‎n‎‎‎c‎‎‎e‎‎‎s‎‎‎ ‎‎‎S‎‎‎h‎‎‎e‎‎‎'‎‎‎s‎‎‎ ‎‎‎L‎‎‎e‎‎‎a‎‎‎v‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎'‎‎‎R‎‎‎a‎‎‎c‎‎‎i‎‎‎s‎‎‎t‎‎‎ ‎‎‎&‎‎‎ ‎‎‎H‎‎‎o‎‎‎m‎‎‎o‎‎‎p‎‎‎h‎‎‎o‎‎‎b‎‎‎i‎‎‎c‎‎‎'‎‎‎ ‎‎‎C‎‎‎o‎‎‎u‎‎‎n‎‎‎t‎‎‎r‎‎‎y‎‎‎ ‎‎‎M‎‎‎u‎‎‎s‎‎‎i‎‎‎c‎‎‎
2‎‎‎,‎‎‎5‎‎‎0‎‎‎8‎‎‎
E‎‎‎x‎‎‎c‎‎‎l‎‎‎u‎‎‎s‎‎‎i‎‎‎v‎‎‎e‎‎‎ ‎‎‎–‎‎‎ ‎‎‎M‎‎‎c‎‎‎C‎‎‎a‎‎‎r‎‎‎t‎‎‎h‎‎‎y‎‎‎:‎‎‎ ‎‎‎W‎‎‎h‎‎‎i‎‎‎t‎‎‎e‎‎‎ ‎‎‎H‎‎‎o‎‎‎u‎‎‎s‎‎‎e‎‎‎ ‎‎‎A‎‎‎l‎‎‎r‎‎‎e‎‎‎a‎‎‎d‎‎‎y‎‎‎ ‎‎‎O‎‎‎b‎‎‎s‎‎‎t‎‎‎r‎‎‎u‎‎‎c‎‎‎t‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎I‎‎‎m‎‎‎p‎‎‎e‎‎‎a‎‎‎c‎‎‎h‎‎‎m‎‎‎e‎‎‎n‎‎‎t‎‎‎ ‎‎‎I‎‎‎n‎‎‎q‎‎‎u‎‎‎i‎‎‎r‎‎‎y‎‎‎
E‎‎‎x‎‎‎c‎‎‎l‎‎‎u‎‎‎s‎‎‎i‎‎‎v‎‎‎e‎‎‎ ‎‎‎–‎‎‎ ‎‎‎M‎‎‎c‎‎‎C‎‎‎a‎‎‎r‎‎‎t‎‎‎h‎‎‎y‎‎‎:‎‎‎ ‎‎‎W‎‎‎h‎‎‎i‎‎‎t‎‎‎e‎‎‎ ‎‎‎H‎‎‎o‎‎‎u‎‎‎s‎‎‎e‎‎‎ ‎‎‎A‎‎‎l‎‎‎r‎‎‎e‎‎‎a‎‎‎d‎‎‎y‎‎‎ ‎‎‎O‎‎‎b‎‎‎s‎‎‎t‎‎‎r‎‎‎u‎‎‎c‎‎‎t‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎I‎‎‎m‎‎‎p‎‎‎e‎‎‎a‎‎‎c‎‎‎h‎‎‎m‎‎‎e‎‎‎n‎‎‎t‎‎‎ ‎‎‎I‎‎‎n‎‎‎q‎‎‎u‎‎‎i‎‎‎r‎‎‎y‎‎‎
2‎‎‎,‎‎‎2‎‎‎5‎‎‎7‎‎‎
V‎‎‎a‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎D‎‎‎e‎‎‎m‎‎‎a‎‎‎n‎‎‎d‎‎‎s‎‎‎ ‎‎‎I‎‎‎n‎‎‎f‎‎‎o‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎U‎‎‎k‎‎‎r‎‎‎a‎‎‎i‎‎‎n‎‎‎e‎‎‎'‎‎‎s‎‎‎ ‎‎‎A‎‎‎m‎‎‎e‎‎‎r‎‎‎i‎‎‎c‎‎‎a‎‎‎n‎‎‎ ‎‎‎T‎‎‎r‎‎‎a‎‎‎n‎‎‎s‎‎‎g‎‎‎e‎‎‎n‎‎‎d‎‎‎e‎‎‎r‎‎‎ ‎‎‎'‎‎‎S‎‎‎p‎‎‎o‎‎‎k‎‎‎e‎‎‎s‎‎‎p‎‎‎e‎‎‎r‎‎‎s‎‎‎o‎‎‎n‎‎‎'‎‎‎
V‎‎‎a‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎D‎‎‎e‎‎‎m‎‎‎a‎‎‎n‎‎‎d‎‎‎s‎‎‎ ‎‎‎I‎‎‎n‎‎‎f‎‎‎o‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎U‎‎‎k‎‎‎r‎‎‎a‎‎‎i‎‎‎n‎‎‎e‎‎‎'‎‎‎s‎‎‎ ‎‎‎A‎‎‎m‎‎‎e‎‎‎r‎‎‎i‎‎‎c‎‎‎a‎‎‎n‎‎‎ ‎‎‎T‎‎‎r‎‎‎a‎‎‎n‎‎‎s‎‎‎g‎‎‎e‎‎‎n‎‎‎d‎‎‎e‎‎‎r‎‎‎ ‎‎‎'‎‎‎S‎‎‎p‎‎‎o‎‎‎k‎‎‎e‎‎‎s‎‎‎p‎‎‎e‎‎‎r‎‎‎s‎‎‎o‎‎‎n‎‎‎'‎‎‎
1‎‎‎,‎‎‎0‎‎‎9‎‎‎1‎‎‎
P‎‎‎O‎‎‎L‎‎‎I‎‎‎T‎‎‎I‎‎‎C‎‎‎O‎‎‎'‎‎‎s‎‎‎ ‎‎‎P‎‎‎r‎‎‎z‎‎‎y‎‎‎b‎‎‎y‎‎‎l‎‎‎a‎‎‎:‎‎‎ ‎‎‎G‎‎‎O‎‎‎P‎‎‎'‎‎‎s‎‎‎ ‎‎‎O‎‎‎n‎‎‎l‎‎‎y‎‎‎ ‎‎‎P‎‎‎r‎‎‎o‎‎‎o‎‎‎f‎‎‎ ‎‎‎A‎‎‎g‎‎‎a‎‎‎i‎‎‎n‎‎‎s‎‎‎t‎‎‎ ‎‎‎J‎‎‎o‎‎‎e‎‎‎ ‎‎‎I‎‎‎s‎‎‎ ‎‎‎H‎‎‎u‎‎‎n‎‎‎t‎‎‎e‎‎‎r‎‎‎'‎‎‎s‎‎‎ ‎‎‎O‎‎‎w‎‎‎n‎‎‎ ‎‎‎W‎‎‎o‎‎‎r‎‎‎d‎‎‎s‎‎‎
P‎‎‎O‎‎‎L‎‎‎I‎‎‎T‎‎‎I‎‎‎C‎‎‎O‎‎‎'‎‎‎s‎‎‎ ‎‎‎P‎‎‎r‎‎‎z‎‎‎y‎‎‎b‎‎‎y‎‎‎l‎‎‎a‎‎‎:‎‎‎ ‎‎‎G‎‎‎O‎‎‎P‎‎‎'‎‎‎s‎‎‎ ‎‎‎O‎‎‎n‎‎‎l‎‎‎y‎‎‎ ‎‎‎P‎‎‎r‎‎‎o‎‎‎o‎‎‎f‎‎‎ ‎‎‎A‎‎‎g‎‎‎a‎‎‎i‎‎‎n‎‎‎s‎‎‎t‎‎‎ ‎‎‎J‎‎‎o‎‎‎e‎‎‎ ‎‎‎I‎‎‎s‎‎‎ ‎‎‎H‎‎‎u‎‎‎n‎‎‎t‎‎‎e‎‎‎r‎‎‎'‎‎‎s‎‎‎ ‎‎‎O‎‎‎w‎‎‎n‎‎‎ ‎‎‎W‎‎‎o‎‎‎r‎‎‎d‎‎‎s‎‎‎
2‎‎‎,‎‎‎6‎‎‎5‎‎‎7‎‎‎
M‎‎‎c‎‎‎C‎‎‎a‎‎‎r‎‎‎t‎‎‎h‎‎‎y‎‎‎:‎‎‎ ‎‎‎T‎‎‎r‎‎‎u‎‎‎m‎‎‎p‎‎‎ ‎‎‎W‎‎‎i‎‎‎l‎‎‎l‎‎‎ ‎‎‎B‎‎‎e‎‎‎ ‎‎‎2‎‎‎0‎‎‎2‎‎‎4‎‎‎ ‎‎‎G‎‎‎O‎‎‎P‎‎‎ ‎‎‎N‎‎‎o‎‎‎m‎‎‎i‎‎‎n‎‎‎e‎‎‎e‎‎‎,‎‎‎ ‎‎‎D‎‎‎e‎‎‎S‎‎‎a‎‎‎n‎‎‎t‎‎‎i‎‎‎s‎‎‎ ‎‎‎'‎‎‎N‎‎‎o‎‎‎t‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎S‎‎‎a‎‎‎m‎‎‎e‎‎‎ ‎‎‎L‎‎‎e‎‎‎v‎‎‎e‎‎‎l‎‎‎'‎‎‎
M‎‎‎c‎‎‎C‎‎‎a‎‎‎r‎‎‎t‎‎‎h‎‎‎y‎‎‎:‎‎‎ ‎‎‎T‎‎‎r‎‎‎u‎‎‎m‎‎‎p‎‎‎ ‎‎‎W‎‎‎i‎‎‎l‎‎‎l‎‎‎ ‎‎‎B‎‎‎e‎‎‎ ‎‎‎2‎‎‎0‎‎‎2‎‎‎4‎‎‎ ‎‎‎G‎‎‎O‎‎‎P‎‎‎ ‎‎‎N‎‎‎o‎‎‎m‎‎‎i‎‎‎n‎‎‎e‎‎‎e‎‎‎,‎‎‎ ‎‎‎D‎‎‎e‎‎‎S‎‎‎a‎‎‎n‎‎‎t‎‎‎i‎‎‎s‎‎‎ ‎‎‎'‎‎‎N‎‎‎o‎‎‎t‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎S‎‎‎a‎‎‎m‎‎‎e‎‎‎ ‎‎‎L‎‎‎e‎‎‎v‎‎‎e‎‎‎l‎‎‎'‎‎‎
1‎‎‎,‎‎‎4‎‎‎4‎‎‎2‎‎‎
T‎‎‎a‎‎‎l‎‎‎i‎‎‎b‎‎‎a‎‎‎n‎‎‎ ‎‎‎f‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎e‎‎‎r‎‎‎s‎‎‎ ‎‎‎s‎‎‎t‎‎‎a‎‎‎n‎‎‎d‎‎‎ ‎‎‎g‎‎‎u‎‎‎a‎‎‎r‎‎‎d‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎K‎‎‎a‎‎‎b‎‎‎u‎‎‎l‎‎‎,‎‎‎ ‎‎‎A‎‎‎f‎‎‎g‎‎‎h‎‎‎a‎‎‎n‎‎‎i‎‎‎s‎‎‎t‎‎‎a‎‎‎n‎‎‎,‎‎‎ ‎‎‎M‎‎‎o‎‎‎n‎‎‎d‎‎‎a‎‎‎y‎‎‎,‎‎‎ ‎‎‎D‎‎‎e‎‎‎c‎‎‎.‎‎‎ ‎‎‎2‎‎‎6‎‎‎,‎‎‎ ‎‎‎2‎‎‎0‎‎‎2‎‎‎2‎‎‎.‎‎‎ ‎‎‎R‎‎‎e‎‎‎c‎‎‎e‎‎‎n‎‎‎t‎‎‎ ‎‎‎T‎‎‎a‎‎‎l‎‎‎i‎‎‎b‎‎‎a‎‎‎n‎‎‎ ‎‎‎r‎‎‎u‎‎‎l‎‎‎i‎‎‎n‎‎‎g‎‎‎s‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎A‎‎‎f‎‎‎g‎‎‎h‎‎‎a‎‎‎n‎‎‎ ‎‎‎w‎‎‎o‎‎‎m‎‎‎e‎‎‎n‎‎‎ ‎‎‎i‎‎‎n‎‎‎c‎‎‎l‎‎‎u‎‎‎d‎‎‎e‎‎‎ ‎‎‎b‎‎‎a‎‎‎n‎‎‎s‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎u‎‎‎n‎‎‎i‎‎‎v‎‎‎e‎‎‎r‎‎‎s‎‎‎i‎‎‎t‎‎‎y‎‎‎ ‎‎‎e‎‎‎d‎‎‎u‎‎‎c‎‎‎a‎‎‎t‎‎‎i‎‎‎o‎‎‎n‎‎‎ ‎‎‎a‎‎‎n‎‎‎d‎‎‎ ‎‎‎w‎‎‎o‎‎‎r‎‎‎k‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎N‎‎‎G‎‎‎O‎‎‎s‎‎‎,‎‎‎ ‎‎‎s‎‎‎p‎‎‎a‎‎‎r‎‎‎k‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎p‎‎‎r‎‎‎o‎‎‎t‎‎‎e‎‎‎s‎‎‎t‎‎‎s‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎m‎‎‎a‎‎‎j‎‎‎o‎‎‎r‎‎‎ ‎‎‎c‎‎‎i‎‎‎t‎‎‎i‎‎‎e‎‎‎s‎‎‎.‎‎‎ ‎‎‎S‎‎‎e‎‎‎c‎‎‎u‎‎‎r‎‎‎i‎‎‎t‎‎‎y‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎c‎‎‎a‎‎‎p‎‎‎i‎‎‎t‎‎‎a‎‎‎l‎‎‎ ‎‎‎K‎‎‎a‎‎‎b‎‎‎u‎‎‎l‎‎‎ ‎‎‎h‎‎‎a‎‎‎s‎‎‎ ‎‎‎i‎‎‎n‎‎‎t‎‎‎e‎‎‎n‎‎‎s‎‎‎i‎‎‎f‎‎‎i‎‎‎e‎‎‎d‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎r‎‎‎e‎‎‎c‎‎‎e‎‎‎n‎‎‎t‎‎‎ ‎‎‎d‎‎‎a‎‎‎y‎‎‎s‎‎‎,‎‎‎ ‎‎‎w‎‎‎i‎‎‎t‎‎‎h‎‎‎ ‎‎‎m‎‎‎o‎‎‎r‎‎‎e‎‎‎ ‎‎‎c‎‎‎h‎‎‎e‎‎‎c‎‎‎k‎‎‎p‎‎‎o‎‎‎i‎‎‎n‎‎‎t‎‎‎s‎‎‎,‎‎‎ ‎‎‎a‎‎‎r‎‎‎m‎‎‎e‎‎‎d‎‎‎ ‎‎‎v‎‎‎e‎‎‎h‎‎‎i‎‎‎c‎‎‎l‎‎‎e‎‎‎s‎‎‎,‎‎‎ ‎‎‎a‎‎‎n‎‎‎d‎‎‎ ‎‎‎T‎‎‎a‎‎‎l‎‎‎i‎‎‎b‎‎‎a‎‎‎n‎‎‎ ‎‎‎s‎‎‎p‎‎‎e‎‎‎c‎‎‎i‎‎‎a‎‎‎l‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎c‎‎‎e‎‎‎s‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎s‎‎‎t‎‎‎r‎‎‎e‎‎‎e‎‎‎t‎‎‎s‎‎‎.‎‎‎ ‎‎‎A‎‎‎u‎‎‎t‎‎‎h‎‎‎o‎‎‎r‎‎‎i‎‎‎t‎‎‎i‎‎‎e‎‎‎s‎‎‎ ‎‎‎h‎‎‎a‎‎‎v‎‎‎e‎‎‎ ‎‎‎n‎‎‎o‎‎‎t‎‎‎ ‎‎‎g‎‎‎i‎‎‎v‎‎‎e‎‎‎n‎‎‎ ‎‎‎a‎‎‎ ‎‎‎r‎‎‎e‎‎‎a‎‎‎s‎‎‎o‎‎‎n‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎t‎‎‎o‎‎‎u‎‎‎g‎‎‎h‎‎‎e‎‎‎r‎‎‎ ‎‎‎s‎‎‎e‎‎‎c‎‎‎u‎‎‎r‎‎‎i‎‎‎t‎‎‎y‎‎‎.‎‎‎ ‎‎‎(‎‎‎A‎‎‎P‎‎‎ ‎‎‎P‎‎‎h‎‎‎o‎‎‎t‎‎‎o‎‎‎/‎‎‎E‎‎‎b‎‎‎r‎‎‎a‎‎‎h‎‎‎i‎‎‎m‎‎‎ ‎‎‎N‎‎‎o‎‎‎r‎‎‎o‎‎‎o‎‎‎z‎‎‎i‎‎‎)‎‎‎
R‎‎‎e‎‎‎p‎‎‎o‎‎‎r‎‎‎t‎‎‎:‎‎‎ ‎‎‎T‎‎‎a‎‎‎l‎‎‎i‎‎‎b‎‎‎a‎‎‎n‎‎‎ ‎‎‎A‎‎‎r‎‎‎r‎‎‎e‎‎‎s‎‎‎t‎‎‎s‎‎‎ ‎‎‎A‎‎‎m‎‎‎e‎‎‎r‎‎‎i‎‎‎c‎‎‎a‎‎‎n‎‎‎,‎‎‎ ‎‎‎1‎‎‎7‎‎‎ ‎‎‎O‎‎‎t‎‎‎h‎‎‎e‎‎‎r‎‎‎s‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎A‎‎‎f‎‎‎g‎‎‎h‎‎‎a‎‎‎n‎‎‎i‎‎‎s‎‎‎t‎‎‎a‎‎‎n‎‎‎
6‎‎‎1‎‎‎
I‎‎‎t‎‎‎a‎‎‎l‎‎‎y‎‎‎'‎‎‎s‎‎‎ ‎‎‎P‎‎‎M‎‎‎ ‎‎‎M‎‎‎e‎‎‎l‎‎‎o‎‎‎n‎‎‎i‎‎‎ ‎‎‎D‎‎‎e‎‎‎s‎‎‎p‎‎‎a‎‎‎i‎‎‎r‎‎‎s‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎I‎‎‎l‎‎‎l‎‎‎e‎‎‎g‎‎‎a‎‎‎l‎‎‎ ‎‎‎M‎‎‎i‎‎‎g‎‎‎r‎‎‎a‎‎‎n‎‎‎t‎‎‎ ‎‎‎S‎‎‎u‎‎‎r‎‎‎g‎‎‎e‎‎‎
I‎‎‎t‎‎‎a‎‎‎l‎‎‎y‎‎‎'‎‎‎s‎‎‎ ‎‎‎P‎‎‎M‎‎‎ ‎‎‎M‎‎‎e‎‎‎l‎‎‎o‎‎‎n‎‎‎i‎‎‎ ‎‎‎D‎‎‎e‎‎‎s‎‎‎p‎‎‎a‎‎‎i‎‎‎r‎‎‎s‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎I‎‎‎l‎‎‎l‎‎‎e‎‎‎g‎‎‎a‎‎‎l‎‎‎ ‎‎‎M‎‎‎i‎‎‎g‎‎‎r‎‎‎a‎‎‎n‎‎‎t‎‎‎ ‎‎‎S‎‎‎u‎‎‎r‎‎‎g‎‎‎e‎‎‎
2‎‎‎,‎‎‎3‎‎‎3‎‎‎2‎‎‎
T‎‎‎r‎‎‎u‎‎‎m‎‎‎p‎‎‎:‎‎‎ ‎‎‎N‎‎‎a‎‎‎n‎‎‎c‎‎‎y‎‎‎ ‎‎‎P‎‎‎e‎‎‎l‎‎‎o‎‎‎s‎‎‎i‎‎‎ ‎‎‎I‎‎‎s‎‎‎ ‎‎‎'‎‎‎R‎‎‎e‎‎‎s‎‎‎p‎‎‎o‎‎‎n‎‎‎s‎‎‎i‎‎‎b‎‎‎l‎‎‎e‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎J‎‎‎a‎‎‎n‎‎‎u‎‎‎a‎‎‎r‎‎‎y‎‎‎ ‎‎‎6‎‎‎'‎‎‎
T‎‎‎r‎‎‎u‎‎‎m‎‎‎p‎‎‎:‎‎‎ ‎‎‎N‎‎‎a‎‎‎n‎‎‎c‎‎‎y‎‎‎ ‎‎‎P‎‎‎e‎‎‎l‎‎‎o‎‎‎s‎‎‎i‎‎‎ ‎‎‎I‎‎‎s‎‎‎ ‎‎‎'‎‎‎R‎‎‎e‎‎‎s‎‎‎p‎‎‎o‎‎‎n‎‎‎s‎‎‎i‎‎‎b‎‎‎l‎‎‎e‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎J‎‎‎a‎‎‎n‎‎‎u‎‎‎a‎‎‎r‎‎‎y‎‎‎ ‎‎‎6‎‎‎'‎‎‎

N‎‎‎i‎‎‎g‎‎‎ ‎‎‎A‎‎‎r‎‎‎r‎‎‎e‎‎‎s‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎P‎‎‎a‎‎‎y‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎$‎‎‎1‎‎‎5‎‎‎0‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎H‎‎‎a‎‎‎v‎‎‎e‎‎‎ ‎‎‎S‎‎‎e‎‎‎x‎‎‎ ‎‎‎w‎‎‎i‎‎‎t‎‎‎h‎‎‎ ‎‎‎C‎‎‎h‎‎‎i‎‎‎l‎‎‎d‎‎‎.‎‎‎

T‎‎‎h‎‎‎i‎‎‎s‎‎‎ ‎‎‎n‎‎‎i‎‎‎g‎‎‎ ‎‎‎g‎‎‎o‎‎‎n‎‎‎ ‎‎‎h‎‎‎a‎‎‎v‎‎‎ ‎‎‎s‎‎‎e‎‎‎x‎‎‎ ‎‎‎w‎‎‎i‎‎‎v‎‎‎ ‎‎‎d‎‎‎a‎‎‎t‎‎‎ ‎‎‎c‎‎‎h‎‎‎a‎‎‎l‎‎‎.‎‎‎

N‎‎‎i‎‎‎g‎‎‎a‎‎‎b‎‎‎i‎‎‎t‎‎‎c‎‎‎h‎‎‎ ‎‎‎A‎‎‎r‎‎‎r‎‎‎e‎‎‎s‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎K‎‎‎i‎‎‎l‎‎‎l‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎G‎‎‎i‎‎‎r‎‎‎l‎‎‎ ‎‎‎b‎‎‎y‎‎‎ ‎‎‎S‎‎‎i‎‎‎t‎‎‎t‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎H‎‎‎e‎‎‎r‎‎‎.‎‎‎


N‎‎‎e‎‎‎g‎‎‎r‎‎‎o‎‎‎ ‎‎‎w‎‎‎i‎‎‎t‎‎‎h‎‎‎ ‎‎‎D‎‎‎i‎‎‎f‎‎‎f‎‎‎i‎‎‎c‎‎‎u‎‎‎l‎‎‎t‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎P‎‎‎r‎‎‎o‎‎‎n‎‎‎o‎‎‎u‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎N‎‎‎a‎‎‎m‎‎‎e‎‎‎ ‎‎‎A‎‎‎r‎‎‎r‎‎‎e‎‎‎s‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎F‎‎‎o‎‎‎r‎‎‎t‎‎‎ ‎‎‎S‎‎‎m‎‎‎i‎‎‎t‎‎‎h‎‎‎ ‎‎‎A‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎S‎‎‎u‎‎‎r‎‎‎r‎‎‎e‎‎‎n‎‎‎d‎‎‎e‎‎‎r‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎C‎‎‎o‎‎‎p‎‎‎s‎‎‎ ‎‎‎A‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎R‎‎‎o‎‎‎b‎‎‎b‎‎‎e‎‎‎r‎‎‎y‎‎‎.‎‎‎


N‎‎‎e‎‎‎g‎‎‎r‎‎‎e‎‎‎s‎‎‎s‎‎‎ ‎‎‎a‎‎‎n‎‎‎d‎‎‎ ‎‎‎S‎‎‎p‎‎‎i‎‎‎c‎‎‎ ‎‎‎B‎‎‎i‎‎‎t‎‎‎c‎‎‎h‎‎‎ ‎‎‎A‎‎‎r‎‎‎r‎‎‎e‎‎‎s‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎A‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎R‎‎‎e‎‎‎c‎‎‎o‎‎‎r‎‎‎d‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎V‎‎‎i‎‎‎d‎‎‎e‎‎‎o‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎T‎‎‎h‎‎‎e‎‎‎m‎‎‎s‎‎‎e‎‎‎l‎‎‎v‎‎‎e‎‎‎s‎‎‎ ‎‎‎G‎‎‎i‎‎‎v‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎S‎‎‎e‎‎‎x‎‎‎ ‎‎‎T‎‎‎o‎‎‎y‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎C‎‎‎h‎‎‎i‎‎‎l‎‎‎d‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎D‎‎‎a‎‎‎y‎‎‎c‎‎‎a‎‎‎r‎‎‎e‎‎‎ ‎‎‎C‎‎‎e‎‎‎n‎‎‎t‎‎‎e‎‎‎r‎‎‎.‎‎‎

.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎ ‎‎‎W‎‎‎e‎‎‎l‎‎‎l‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎ ‎‎‎H‎‎‎o‎‎‎w‎‎‎ ‎‎‎a‎‎‎b‎‎‎o‎‎‎u‎‎‎t‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎w‎‎‎e‎‎‎a‎‎‎t‎‎‎h‎‎‎e‎‎‎r‎‎‎?‎‎‎

T‎‎‎o‎‎‎d‎‎‎a‎‎‎y‎‎‎
I‎‎‎s‎‎‎o‎‎‎l‎‎‎a‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎T‎‎‎h‎‎‎u‎‎‎n‎‎‎d‎‎‎e‎‎‎r‎‎‎s‎‎‎t‎‎‎o‎‎‎r‎‎‎m‎‎‎s‎‎‎
8‎‎‎9‎‎‎°‎‎‎
/‎‎‎7‎‎‎0‎‎‎°‎‎‎
3‎‎‎1‎‎‎%‎‎‎
N‎‎‎N‎‎‎E‎‎‎ ‎‎‎1‎‎‎0‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
S‎‎‎a‎‎‎t‎‎‎ ‎‎‎1‎‎‎6‎‎‎ ‎‎‎|‎‎‎ ‎‎‎D‎‎‎a‎‎‎y‎‎‎
8‎‎‎9‎‎‎°‎‎‎
3‎‎‎1‎‎‎%‎‎‎
N‎‎‎N‎‎‎E‎‎‎
1‎‎‎0‎‎‎
 ‎‎‎
m‎‎‎p‎‎‎h‎‎‎
P‎‎‎a‎‎‎r‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎m‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎c‎‎‎l‎‎‎o‎‎‎u‎‎‎d‎‎‎y‎‎‎ ‎‎‎w‎‎‎i‎‎‎t‎‎‎h‎‎‎ ‎‎‎i‎‎‎s‎‎‎o‎‎‎l‎‎‎a‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎t‎‎‎h‎‎‎u‎‎‎n‎‎‎d‎‎‎e‎‎‎r‎‎‎s‎‎‎t‎‎‎o‎‎‎r‎‎‎m‎‎‎s‎‎‎ ‎‎‎d‎‎‎e‎‎‎v‎‎‎e‎‎‎l‎‎‎o‎‎‎p‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎t‎‎‎h‎‎‎i‎‎‎s‎‎‎ ‎‎‎a‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎n‎‎‎o‎‎‎o‎‎‎n‎‎‎.‎‎‎ ‎‎‎H‎‎‎i‎‎‎g‎‎‎h‎‎‎ ‎‎‎8‎‎‎9‎‎‎F‎‎‎.‎‎‎ ‎‎‎W‎‎‎i‎‎‎n‎‎‎d‎‎‎s‎‎‎ ‎‎‎N‎‎‎N‎‎‎E‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎5‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎1‎‎‎0‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎.‎‎‎ ‎‎‎C‎‎‎h‎‎‎a‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎r‎‎‎a‎‎‎i‎‎‎n‎‎‎ ‎‎‎3‎‎‎0‎‎‎%‎‎‎.‎‎‎
 ‎‎‎
H‎‎‎u‎‎‎m‎‎‎i‎‎‎d‎‎‎i‎‎‎t‎‎‎y‎‎‎
6‎‎‎8‎‎‎%‎‎‎
U‎‎‎V‎‎‎ ‎‎‎I‎‎‎n‎‎‎d‎‎‎e‎‎‎x‎‎‎
8‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎1‎‎‎1‎‎‎
S‎‎‎u‎‎‎n‎‎‎r‎‎‎i‎‎‎s‎‎‎e‎‎‎
7‎‎‎:‎‎‎1‎‎‎5‎‎‎ ‎‎‎a‎‎‎m‎‎‎
S‎‎‎u‎‎‎n‎‎‎s‎‎‎e‎‎‎t‎‎‎
7‎‎‎:‎‎‎3‎‎‎4‎‎‎ ‎‎‎p‎‎‎m‎‎‎
S‎‎‎a‎‎‎t‎‎‎ ‎‎‎1‎‎‎6‎‎‎ ‎‎‎|‎‎‎ ‎‎‎N‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎
7‎‎‎0‎‎‎°‎‎‎
2‎‎‎0‎‎‎%‎‎‎
N‎‎‎N‎‎‎W‎‎‎
9‎‎‎
 ‎‎‎
m‎‎‎p‎‎‎h‎‎‎
C‎‎‎l‎‎‎o‎‎‎u‎‎‎d‎‎‎y‎‎‎ ‎‎‎s‎‎‎k‎‎‎i‎‎‎e‎‎‎s‎‎‎ ‎‎‎e‎‎‎a‎‎‎r‎‎‎l‎‎‎y‎‎‎,‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎n‎‎‎ ‎‎‎p‎‎‎a‎‎‎r‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎c‎‎‎l‎‎‎o‎‎‎u‎‎‎d‎‎‎y‎‎‎ ‎‎‎a‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎m‎‎‎i‎‎‎d‎‎‎n‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎.‎‎‎ ‎‎‎A‎‎‎ ‎‎‎s‎‎‎t‎‎‎r‎‎‎a‎‎‎y‎‎‎ ‎‎‎s‎‎‎h‎‎‎o‎‎‎w‎‎‎e‎‎‎r‎‎‎ ‎‎‎o‎‎‎r‎‎‎ ‎‎‎t‎‎‎h‎‎‎u‎‎‎n‎‎‎d‎‎‎e‎‎‎r‎‎‎s‎‎‎t‎‎‎o‎‎‎r‎‎‎m‎‎‎ ‎‎‎i‎‎‎s‎‎‎ ‎‎‎p‎‎‎o‎‎‎s‎‎‎s‎‎‎i‎‎‎b‎‎‎l‎‎‎e‎‎‎.‎‎‎ ‎‎‎L‎‎‎o‎‎‎w‎‎‎ ‎‎‎n‎‎‎e‎‎‎a‎‎‎r‎‎‎ ‎‎‎7‎‎‎0‎‎‎F‎‎‎.‎‎‎ ‎‎‎W‎‎‎i‎‎‎n‎‎‎d‎‎‎s‎‎‎ ‎‎‎N‎‎‎N‎‎‎W‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎5‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎1‎‎‎0‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎.‎‎‎
 ‎‎‎
H‎‎‎u‎‎‎m‎‎‎i‎‎‎d‎‎‎i‎‎‎t‎‎‎y‎‎‎
8‎‎‎7‎‎‎%‎‎‎
U‎‎‎V‎‎‎ ‎‎‎I‎‎‎n‎‎‎d‎‎‎e‎‎‎x‎‎‎
0‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎1‎‎‎1‎‎‎
M‎‎‎o‎‎‎o‎‎‎n‎‎‎r‎‎‎i‎‎‎s‎‎‎e‎‎‎
8‎‎‎:‎‎‎3‎‎‎5‎‎‎ ‎‎‎a‎‎‎m‎‎‎
W‎‎‎a‎‎‎x‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎C‎‎‎r‎‎‎e‎‎‎s‎‎‎c‎‎‎e‎‎‎n‎‎‎t‎‎‎
M‎‎‎o‎‎‎o‎‎‎n‎‎‎s‎‎‎e‎‎‎t‎‎‎
8‎‎‎:‎‎‎3‎‎‎4‎‎‎ ‎‎‎p‎‎‎m‎‎‎
S‎‎‎u‎‎‎n‎‎‎ ‎‎‎1‎‎‎7‎‎‎
M‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎3‎‎‎°‎‎‎
/‎‎‎6‎‎‎8‎‎‎°‎‎‎
1‎‎‎2‎‎‎%‎‎‎
N‎‎‎ ‎‎‎8‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
M‎‎‎o‎‎‎n‎‎‎ ‎‎‎1‎‎‎8‎‎‎
M‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎5‎‎‎°‎‎‎
/‎‎‎6‎‎‎9‎‎‎°‎‎‎
5‎‎‎%‎‎‎
E‎‎‎S‎‎‎E‎‎‎ ‎‎‎5‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
T‎‎‎u‎‎‎e‎‎‎ ‎‎‎1‎‎‎9‎‎‎
M‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎3‎‎‎°‎‎‎
/‎‎‎7‎‎‎1‎‎‎°‎‎‎
6‎‎‎%‎‎‎
S‎‎‎ ‎‎‎1‎‎‎0‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
W‎‎‎e‎‎‎d‎‎‎ ‎‎‎2‎‎‎0‎‎‎
S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎3‎‎‎°‎‎‎
/‎‎‎7‎‎‎1‎‎‎°‎‎‎
2‎‎‎4‎‎‎%‎‎‎
S‎‎‎ ‎‎‎1‎‎‎0‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
T‎‎‎h‎‎‎u‎‎‎ ‎‎‎2‎‎‎1‎‎‎
P‎‎‎a‎‎‎r‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎C‎‎‎l‎‎‎o‎‎‎u‎‎‎d‎‎‎y‎‎‎
9‎‎‎4‎‎‎°‎‎‎
/‎‎‎7‎‎‎1‎‎‎°‎‎‎
1‎‎‎8‎‎‎%‎‎‎
S‎‎‎E‎‎‎ ‎‎‎9‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
F‎‎‎r‎‎‎i‎‎‎ ‎‎‎2‎‎‎2‎‎‎
P‎‎‎a‎‎‎r‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎C‎‎‎l‎‎‎o‎‎‎u‎‎‎d‎‎‎y‎‎‎
9‎‎‎4‎‎‎°‎‎‎
/‎‎‎7‎‎‎0‎‎‎°‎‎‎
1‎‎‎3‎‎‎%‎‎‎
S‎‎‎E‎‎‎ ‎‎‎8‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
S‎‎‎a‎‎‎t‎‎‎ ‎‎‎2‎‎‎3‎‎‎
M‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎5‎‎‎°‎‎‎
/‎‎‎7‎‎‎0‎‎‎°‎‎‎
7‎‎‎%‎‎‎
S‎‎‎S‎‎‎E‎‎‎ ‎‎‎1‎‎‎0‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
S‎‎‎u‎‎‎n‎‎‎ ‎‎‎2‎‎‎4‎‎‎
M‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎5‎‎‎°‎‎‎
/‎‎‎7‎‎‎1‎‎‎°‎‎‎
1‎‎‎9‎‎‎%‎‎‎
S‎‎‎ ‎‎‎9‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
M‎‎‎o‎‎‎n‎‎‎ ‎‎‎2‎‎‎5‎‎‎
M‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎6‎‎‎°‎‎‎
/‎‎‎7‎‎‎1‎‎‎°‎‎‎
2‎‎‎3‎‎‎%‎‎‎
S‎‎‎S‎‎‎E‎‎‎ ‎‎‎8‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
T‎‎‎u‎‎‎e‎‎‎ ‎‎‎2‎‎‎6‎‎‎
M‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎3‎‎‎°‎‎‎
/‎‎‎7‎‎‎0‎‎‎°‎‎‎
2‎‎‎4‎‎‎%‎‎‎
E‎‎‎ ‎‎‎8‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
W‎‎‎e‎‎‎d‎‎‎ ‎‎‎2‎‎‎7‎‎‎
M‎‎‎o‎‎‎s‎‎‎t‎‎‎l‎‎‎y‎‎‎ ‎‎‎S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎3‎‎‎°‎‎‎
/‎‎‎7‎‎‎0‎‎‎°‎‎‎
1‎‎‎4‎‎‎%‎‎‎
E‎‎‎ ‎‎‎8‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
T‎‎‎h‎‎‎u‎‎‎ ‎‎‎2‎‎‎8‎‎‎
S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎3‎‎‎°‎‎‎
/‎‎‎7‎‎‎0‎‎‎°‎‎‎
1‎‎‎4‎‎‎%‎‎‎
E‎‎‎S‎‎‎E‎‎‎ ‎‎‎8‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
F‎‎‎r‎‎‎i‎‎‎ ‎‎‎2‎‎‎9‎‎‎
S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎4‎‎‎°‎‎‎
/‎‎‎7‎‎‎0‎‎‎°‎‎‎
1‎‎‎5‎‎‎%‎‎‎
S‎‎‎E‎‎‎ ‎‎‎8‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎
S‎‎‎a‎‎‎t‎‎‎ ‎‎‎3‎‎‎0‎‎‎
S‎‎‎u‎‎‎n‎‎‎n‎‎‎y‎‎‎
9‎‎‎3‎‎‎°‎‎‎
/‎‎‎6‎‎‎9‎‎‎°‎‎‎
1‎‎‎2‎‎‎%‎‎‎
S‎‎‎E‎‎‎ ‎‎‎7‎‎‎ ‎‎‎m‎‎‎p‎‎‎h‎‎‎

.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎

C‎‎‎u‎‎‎r‎‎‎r‎‎‎e‎‎‎n‎‎‎t‎‎‎ ‎‎‎t‎‎‎h‎‎‎r‎‎‎e‎‎‎a‎‎‎t‎‎‎:‎‎‎ ‎‎‎F‎‎‎a‎‎‎l‎‎‎l‎‎‎.‎‎‎ ‎‎‎🍁

.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎

A‎‎‎n‎‎‎d‎‎‎r‎‎‎e‎‎‎w‎‎‎ ‎‎‎B‎‎‎r‎‎‎e‎‎‎i‎‎‎t‎‎‎b‎‎‎a‎‎‎r‎‎‎t‎‎‎
A‎‎‎n‎‎‎d‎‎‎r‎‎‎e‎‎‎w‎‎‎ ‎‎‎J‎‎‎a‎‎‎m‎‎‎e‎‎‎s‎‎‎ ‎‎‎B‎‎‎r‎‎‎e‎‎‎i‎‎‎t‎‎‎b‎‎‎a‎‎‎r‎‎‎t‎‎‎✡‎‎‎ ‎‎‎w‎‎‎a‎‎‎s‎‎‎ ‎‎‎s‎‎‎o‎‎‎ ‎‎‎u‎‎‎g‎‎‎l‎‎‎y‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎b‎‎‎i‎‎‎r‎‎‎t‎‎‎h‎‎‎,‎‎‎ ‎‎‎t‎‎‎h‎‎‎a‎‎‎t‎‎‎ ‎‎‎h‎‎‎e‎‎‎ ‎‎‎w‎‎‎a‎‎‎s‎‎‎ ‎‎‎l‎‎‎i‎‎‎t‎‎‎e‎‎‎r‎‎‎a‎‎‎l‎‎‎l‎‎‎y‎‎‎ ‎‎‎s‎‎‎h‎‎‎i‎‎‎p‎‎‎p‎‎‎e‎‎‎d‎‎‎ ‎‎‎a‎‎‎w‎‎‎a‎‎‎y‎‎‎ ‎‎‎f‎‎‎r‎‎‎o‎‎‎m‎‎‎ ‎‎‎a‎‎‎n‎‎‎c‎‎‎e‎‎‎s‎‎‎t‎‎‎r‎‎‎a‎‎‎l‎‎‎ ‎‎‎c‎‎‎o‎‎‎u‎‎‎n‎‎‎t‎‎‎r‎‎‎y‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎I‎‎‎r‎‎‎e‎‎‎l‎‎‎a‎‎‎n‎‎‎d‎‎‎,‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎b‎‎‎e‎‎‎ ‎‎‎r‎‎‎a‎‎‎i‎‎‎s‎‎‎e‎‎‎d‎‎‎ ‎‎‎b‎‎‎y‎‎‎ ‎‎‎J‎‎‎e‎‎‎w‎‎‎i‎‎‎s‎‎‎h‎‎‎ ‎‎‎p‎‎‎a‎‎‎r‎‎‎e‎‎‎n‎‎‎t‎‎‎s‎‎‎ ‎‎‎w‎‎‎h‎‎‎o‎‎‎ ‎‎‎b‎‎‎o‎‎‎t‎‎‎h‎‎‎ ‎‎‎m‎‎‎a‎‎‎n‎‎‎a‎‎‎g‎‎‎e‎‎‎d‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎o‎‎‎u‎‎‎t‎‎‎l‎‎‎i‎‎‎v‎‎‎e‎‎‎ ‎‎‎t‎‎‎h‎‎‎i‎‎‎s‎‎‎ ‎‎‎f‎‎‎a‎‎‎t‎‎‎,‎‎‎ ‎‎‎s‎‎‎y‎‎‎p‎‎‎h‎‎‎i‎‎‎l‎‎‎i‎‎‎s‎‎‎-‎‎‎r‎‎‎i‎‎‎d‎‎‎d‎‎‎e‎‎‎n‎‎‎,‎‎‎ ‎‎‎s‎‎‎l‎‎‎o‎‎‎b‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎a‎‎‎n‎‎‎ ‎‎‎i‎‎‎n‎‎‎t‎‎‎e‎‎‎r‎‎‎n‎‎‎e‎‎‎t‎‎‎ ‎‎‎h‎‎‎a‎‎‎c‎‎‎k‎‎‎.‎‎‎

B‎‎‎a‎‎‎c‎‎‎k‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎1‎‎‎9‎‎‎9‎‎‎1‎‎‎,‎‎‎ ‎‎‎A‎‎‎n‎‎‎d‎‎‎r‎‎‎e‎‎‎w‎‎‎ ‎‎‎b‎‎‎e‎‎‎c‎‎‎a‎‎‎m‎‎‎e‎‎‎ ‎‎‎a‎‎‎ ‎‎‎c‎‎‎o‎‎‎n‎‎‎s‎‎‎e‎‎‎r‎‎‎v‎‎‎a‎‎‎t‎‎‎a‎‎‎r‎‎‎d‎‎‎ ‎‎‎o‎‎‎v‎‎‎e‎‎‎r‎‎‎ ‎‎‎n‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎,‎‎‎ ‎‎‎a‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎a‎‎‎c‎‎‎t‎‎‎u‎‎‎a‎‎‎l‎‎‎l‎‎‎y‎‎‎ ‎‎‎b‎‎‎e‎‎‎l‎‎‎i‎‎‎e‎‎‎v‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎a‎‎‎ ‎‎‎n‎‎‎i‎‎‎g‎‎‎g‎‎‎e‎‎‎r‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎n‎‎‎o‎‎‎t‎‎‎ ‎‎‎s‎‎‎e‎‎‎x‎‎‎u‎‎‎a‎‎‎l‎‎‎l‎‎‎y‎‎‎ ‎‎‎a‎‎‎s‎‎‎s‎‎‎a‎‎‎u‎‎‎l‎‎‎t‎‎‎ ‎‎‎a‎‎‎ ‎‎‎g‎‎‎i‎‎‎r‎‎‎l‎‎‎.‎‎‎ ‎‎‎T‎‎‎h‎‎‎e‎‎‎n‎‎‎ ‎‎‎a‎‎‎f‎‎‎t‎‎‎e‎‎‎r‎‎‎ ‎‎‎r‎‎‎e‎‎‎l‎‎‎i‎‎‎g‎‎‎i‎‎‎o‎‎‎u‎‎‎s‎‎‎l‎‎‎y‎‎‎ ‎‎‎l‎‎‎i‎‎‎s‎‎‎t‎‎‎e‎‎‎n‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎b‎‎‎l‎‎‎o‎‎‎w‎‎‎h‎‎‎a‎‎‎r‎‎‎d‎‎‎ ‎‎‎R‎‎‎u‎‎‎s‎‎‎h‎‎‎ ‎‎‎L‎‎‎i‎‎‎m‎‎‎b‎‎‎a‎‎‎u‎‎‎g‎‎‎h‎‎‎ ‎‎‎e‎‎‎v‎‎‎e‎‎‎r‎‎‎y‎‎‎ ‎‎‎n‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎,‎‎‎ ‎‎‎h‎‎‎e‎‎‎ ‎‎‎s‎‎‎t‎‎‎a‎‎‎r‎‎‎t‎‎‎e‎‎‎d‎‎‎ ‎‎‎i‎‎‎n‎‎‎t‎‎‎e‎‎‎g‎‎‎r‎‎‎a‎‎‎t‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎R‎‎‎u‎‎‎s‎‎‎h‎‎‎'‎‎‎s‎‎‎ ‎‎‎s‎‎‎t‎‎‎u‎‎‎p‎‎‎i‎‎‎d‎‎‎ ‎‎‎i‎‎‎n‎‎‎a‎‎‎n‎‎‎e‎‎‎ ‎‎‎w‎‎‎i‎‎‎l‎‎‎d‎‎‎ ‎‎‎c‎‎‎o‎‎‎n‎‎‎s‎‎‎p‎‎‎i‎‎‎r‎‎‎a‎‎‎c‎‎‎i‎‎‎e‎‎‎s‎‎‎ ‎‎‎i‎‎‎n‎‎‎t‎‎‎o‎‎‎ ‎‎‎h‎‎‎i‎‎‎s‎‎‎ ‎‎‎o‎‎‎w‎‎‎n‎‎‎ ‎‎‎p‎‎‎o‎‎‎l‎‎‎i‎‎‎t‎‎‎i‎‎‎c‎‎‎s‎‎‎.‎‎‎

S‎‎‎o‎‎‎o‎‎‎n‎‎‎ ‎‎‎e‎‎‎n‎‎‎o‎‎‎u‎‎‎g‎‎‎h‎‎‎,‎‎‎ ‎‎‎t‎‎‎i‎‎‎m‎‎‎e‎‎‎ ‎‎‎h‎‎‎a‎‎‎d‎‎‎ ‎‎‎c‎‎‎o‎‎‎m‎‎‎e‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎l‎‎‎a‎‎‎u‎‎‎n‎‎‎c‎‎‎h‎‎‎ ‎‎‎h‎‎‎i‎‎‎s‎‎‎ ‎‎‎o‎‎‎w‎‎‎n‎‎‎ ‎‎‎s‎‎‎h‎‎‎i‎‎‎t‎‎‎t‎‎‎y‎‎‎ ‎‎‎w‎‎‎e‎‎‎b‎‎‎s‎‎‎i‎‎‎t‎‎‎e‎‎‎.‎‎‎

(‎‎‎(‎‎‎ ‎‎‎T‎‎‎H‎‎‎I‎‎‎S‎‎‎ ‎‎‎A‎‎‎R‎‎‎T‎‎‎I‎‎‎C‎‎‎L‎‎‎E‎‎‎ ‎‎‎D‎‎‎O‎‎‎E‎‎‎S‎‎‎ ‎‎‎N‎‎‎O‎‎‎T‎‎‎ ‎‎‎C‎‎‎O‎‎‎I‎‎‎N‎‎‎C‎‎‎I‎‎‎D‎‎‎E‎‎‎ ‎‎‎W‎‎‎I‎‎‎T‎‎‎H‎‎‎ ‎‎‎A‎‎‎N‎‎‎D‎‎‎R‎‎‎E‎‎‎W‎‎‎'‎‎‎S‎‎‎ ‎‎‎V‎‎‎I‎‎‎S‎‎‎I‎‎‎O‎‎‎N‎‎‎ ‎‎‎)‎‎‎)‎‎‎

.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎

T‎‎‎h‎‎‎e‎‎‎ ‎‎‎h‎‎‎u‎‎‎m‎‎‎m‎‎‎i‎‎‎n‎‎‎g‎‎‎b‎‎‎i‎‎‎r‎‎‎d‎‎‎ ‎‎‎h‎‎‎a‎‎‎w‎‎‎k‎‎‎-‎‎‎m‎‎‎o‎‎‎t‎‎‎h‎‎‎ ‎‎‎(‎‎‎M‎‎‎a‎‎‎c‎‎‎r‎‎‎o‎‎‎g‎‎‎l‎‎‎o‎‎‎s‎‎‎s‎‎‎u‎‎‎m‎‎‎ ‎‎‎s‎‎‎t‎‎‎e‎‎‎l‎‎‎l‎‎‎a‎‎‎t‎‎‎a‎‎‎r‎‎‎u‎‎‎m‎‎‎)‎‎‎ ‎‎‎i‎‎‎s‎‎‎ ‎‎‎a‎‎‎ ‎‎‎s‎‎‎p‎‎‎e‎‎‎c‎‎‎i‎‎‎e‎‎‎s‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎h‎‎‎a‎‎‎w‎‎‎k‎‎‎ ‎‎‎m‎‎‎o‎‎‎t‎‎‎h‎‎‎ ‎‎‎f‎‎‎o‎‎‎u‎‎‎n‎‎‎d‎‎‎ ‎‎‎a‎‎‎c‎‎‎r‎‎‎o‎‎‎s‎‎‎s‎‎‎ ‎‎‎t‎‎‎e‎‎‎m‎‎‎p‎‎‎e‎‎‎r‎‎‎a‎‎‎t‎‎‎e‎‎‎ ‎‎‎r‎‎‎e‎‎‎g‎‎‎i‎‎‎o‎‎‎n‎‎‎s‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎E‎‎‎u‎‎‎r‎‎‎a‎‎‎s‎‎‎i‎‎‎a‎‎‎,‎‎‎ ‎‎‎f‎‎‎r‎‎‎o‎‎‎m‎‎‎ ‎‎‎P‎‎‎o‎‎‎r‎‎‎t‎‎‎u‎‎‎g‎‎‎a‎‎‎l‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎J‎‎‎a‎‎‎p‎‎‎a‎‎‎n‎‎‎.‎‎‎ ‎‎‎I‎‎‎t‎‎‎s‎‎‎ ‎‎‎l‎‎‎o‎‎‎n‎‎‎g‎‎‎ ‎‎‎p‎‎‎r‎‎‎o‎‎‎b‎‎‎o‎‎‎s‎‎‎c‎‎‎i‎‎‎s‎‎‎ ‎‎‎(‎‎‎2‎‎‎5‎‎‎–‎‎‎2‎‎‎8‎‎‎ ‎‎‎m‎‎‎m‎‎‎;‎‎‎ ‎‎‎0‎‎‎.‎‎‎9‎‎‎8‎‎‎–‎‎‎1‎‎‎.‎‎‎1‎‎‎0‎‎‎ ‎‎‎i‎‎‎n‎‎‎)‎‎‎ ‎‎‎a‎‎‎n‎‎‎d‎‎‎ ‎‎‎i‎‎‎t‎‎‎s‎‎‎ ‎‎‎h‎‎‎o‎‎‎v‎‎‎e‎‎‎r‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎b‎‎‎e‎‎‎h‎‎‎a‎‎‎v‎‎‎i‎‎‎o‎‎‎r‎‎‎,‎‎‎ ‎‎‎a‎‎‎c‎‎‎c‎‎‎o‎‎‎m‎‎‎p‎‎‎a‎‎‎n‎‎‎i‎‎‎e‎‎‎d‎‎‎ ‎‎‎b‎‎‎y‎‎‎ ‎‎‎a‎‎‎n‎‎‎ ‎‎‎a‎‎‎u‎‎‎d‎‎‎i‎‎‎b‎‎‎l‎‎‎e‎‎‎ ‎‎‎h‎‎‎u‎‎‎m‎‎‎m‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎n‎‎‎o‎‎‎i‎‎‎s‎‎‎e‎‎‎,‎‎‎ ‎‎‎g‎‎‎i‎‎‎v‎‎‎e‎‎‎ ‎‎‎i‎‎‎t‎‎‎ ‎‎‎a‎‎‎ ‎‎‎r‎‎‎e‎‎‎s‎‎‎e‎‎‎m‎‎‎b‎‎‎l‎‎‎a‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎h‎‎‎u‎‎‎m‎‎‎m‎‎‎i‎‎‎n‎‎‎g‎‎‎b‎‎‎i‎‎‎r‎‎‎d‎‎‎.‎‎‎ ‎‎‎L‎‎‎i‎‎‎k‎‎‎e‎‎‎ ‎‎‎h‎‎‎u‎‎‎m‎‎‎m‎‎‎i‎‎‎n‎‎‎g‎‎‎b‎‎‎i‎‎‎r‎‎‎d‎‎‎s‎‎‎,‎‎‎ ‎‎‎i‎‎‎t‎‎‎ ‎‎‎f‎‎‎e‎‎‎e‎‎‎d‎‎‎s‎‎‎ ‎‎‎o‎‎‎n‎‎‎ ‎‎‎f‎‎‎l‎‎‎o‎‎‎w‎‎‎e‎‎‎r‎‎‎s‎‎‎ ‎‎‎w‎‎‎h‎‎‎i‎‎‎c‎‎‎h‎‎‎ ‎‎‎h‎‎‎a‎‎‎v‎‎‎e‎‎‎ ‎‎‎t‎‎‎u‎‎‎b‎‎‎e‎‎‎-‎‎‎s‎‎‎h‎‎‎a‎‎‎p‎‎‎e‎‎‎d‎‎‎ ‎‎‎c‎‎‎o‎‎‎r‎‎‎o‎‎‎l‎‎‎l‎‎‎a‎‎‎e‎‎‎;‎‎‎ ‎‎‎t‎‎‎h‎‎‎i‎‎‎s‎‎‎ ‎‎‎i‎‎‎s‎‎‎ ‎‎‎a‎‎‎n‎‎‎ ‎‎‎e‎‎‎x‎‎‎a‎‎‎m‎‎‎p‎‎‎l‎‎‎e‎‎‎ ‎‎‎o‎‎‎f‎‎‎ ‎‎‎c‎‎‎o‎‎‎n‎‎‎v‎‎‎e‎‎‎r‎‎‎g‎‎‎e‎‎‎n‎‎‎t‎‎‎ ‎‎‎e‎‎‎v‎‎‎o‎‎‎l‎‎‎u‎‎‎t‎‎‎i‎‎‎o‎‎‎n‎‎‎.‎‎‎ ‎‎‎T‎‎‎h‎‎‎e‎‎‎ ‎‎‎h‎‎‎u‎‎‎m‎‎‎m‎‎‎i‎‎‎n‎‎‎g‎‎‎b‎‎‎i‎‎‎r‎‎‎d‎‎‎ ‎‎‎h‎‎‎a‎‎‎w‎‎‎k‎‎‎-‎‎‎m‎‎‎o‎‎‎t‎‎‎h‎‎‎ ‎‎‎f‎‎‎l‎‎‎i‎‎‎e‎‎‎s‎‎‎ ‎‎‎d‎‎‎u‎‎‎r‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎d‎‎‎a‎‎‎y‎‎‎,‎‎‎ ‎‎‎e‎‎‎s‎‎‎p‎‎‎e‎‎‎c‎‎‎i‎‎‎a‎‎‎l‎‎‎l‎‎‎y‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎b‎‎‎r‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎ ‎‎‎s‎‎‎u‎‎‎n‎‎‎s‎‎‎h‎‎‎i‎‎‎n‎‎‎e‎‎‎,‎‎‎ ‎‎‎b‎‎‎u‎‎‎t‎‎‎ ‎‎‎a‎‎‎l‎‎‎s‎‎‎o‎‎‎ ‎‎‎a‎‎‎t‎‎‎ ‎‎‎d‎‎‎u‎‎‎s‎‎‎k‎‎‎,‎‎‎ ‎‎‎d‎‎‎a‎‎‎w‎‎‎n‎‎‎,‎‎‎ ‎‎‎a‎‎‎n‎‎‎d‎‎‎ ‎‎‎e‎‎‎v‎‎‎e‎‎‎n‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎t‎‎‎h‎‎‎e‎‎‎ ‎‎‎r‎‎‎a‎‎‎i‎‎‎n‎‎‎,‎‎‎ ‎‎‎w‎‎‎h‎‎‎i‎‎‎c‎‎‎h‎‎‎ ‎‎‎i‎‎‎s‎‎‎ ‎‎‎u‎‎‎n‎‎‎u‎‎‎s‎‎‎u‎‎‎a‎‎‎l‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎e‎‎‎v‎‎‎e‎‎‎n‎‎‎ ‎‎‎d‎‎‎i‎‎‎u‎‎‎r‎‎‎n‎‎‎a‎‎‎l‎‎‎ ‎‎‎h‎‎‎a‎‎‎w‎‎‎k‎‎‎m‎‎‎o‎‎‎t‎‎‎h‎‎‎s‎‎‎.‎‎‎ ‎‎‎I‎‎‎t‎‎‎ ‎‎‎e‎‎‎n‎‎‎g‎‎‎a‎‎‎g‎‎‎e‎‎‎s‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎f‎‎‎r‎‎‎e‎‎‎e‎‎‎ ‎‎‎h‎‎‎o‎‎‎v‎‎‎e‎‎‎r‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎f‎‎‎l‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎,‎‎‎ ‎‎‎w‎‎‎h‎‎‎i‎‎‎c‎‎‎h‎‎‎ ‎‎‎a‎‎‎l‎‎‎l‎‎‎o‎‎‎w‎‎‎s‎‎‎ ‎‎‎m‎‎‎o‎‎‎r‎‎‎e‎‎‎ ‎‎‎m‎‎‎a‎‎‎n‎‎‎e‎‎‎u‎‎‎v‎‎‎e‎‎‎r‎‎‎a‎‎‎b‎‎‎i‎‎‎l‎‎‎i‎‎‎t‎‎‎y‎‎‎ ‎‎‎a‎‎‎n‎‎‎d‎‎‎ ‎‎‎c‎‎‎o‎‎‎n‎‎‎t‎‎‎r‎‎‎o‎‎‎l‎‎‎ ‎‎‎t‎‎‎h‎‎‎a‎‎‎n‎‎‎ ‎‎‎f‎‎‎i‎‎‎x‎‎‎e‎‎‎d‎‎‎-‎‎‎w‎‎‎i‎‎‎n‎‎‎g‎‎‎ ‎‎‎f‎‎‎l‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎,‎‎‎ ‎‎‎d‎‎‎e‎‎‎s‎‎‎p‎‎‎i‎‎‎t‎‎‎e‎‎‎ ‎‎‎h‎‎‎i‎‎‎g‎‎‎h‎‎‎ ‎‎‎e‎‎‎n‎‎‎e‎‎‎r‎‎‎g‎‎‎e‎‎‎t‎‎‎i‎‎‎c‎‎‎ ‎‎‎c‎‎‎o‎‎‎s‎‎‎t‎‎‎.‎‎‎ ‎‎‎T‎‎‎h‎‎‎i‎‎‎s‎‎‎ ‎‎‎h‎‎‎u‎‎‎m‎‎‎m‎‎‎i‎‎‎n‎‎‎g‎‎‎b‎‎‎i‎‎‎r‎‎‎d‎‎‎ ‎‎‎h‎‎‎a‎‎‎w‎‎‎k‎‎‎-‎‎‎m‎‎‎o‎‎‎t‎‎‎h‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎f‎‎‎l‎‎‎i‎‎‎g‎‎‎h‎‎‎t‎‎‎ ‎‎‎w‎‎‎a‎‎‎s‎‎‎ ‎‎‎p‎‎‎h‎‎‎o‎‎‎t‎‎‎o‎‎‎g‎‎‎r‎‎‎a‎‎‎p‎‎‎h‎‎‎e‎‎‎d‎‎‎ ‎‎‎n‎‎‎e‎‎‎a‎‎‎r‎‎‎ ‎‎‎Y‎‎‎a‎‎‎s‎‎‎t‎‎‎r‎‎‎e‎‎‎b‎‎‎e‎‎‎t‎‎‎s‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎R‎‎‎i‎‎‎l‎‎‎a‎‎‎,‎‎‎ ‎‎‎a‎‎‎ ‎‎‎m‎‎‎o‎‎‎u‎‎‎n‎‎‎t‎‎‎a‎‎‎i‎‎‎n‎‎‎ ‎‎‎r‎‎‎a‎‎‎n‎‎‎g‎‎‎e‎‎‎ ‎‎‎i‎‎‎n‎‎‎ ‎‎‎B‎‎‎u‎‎‎l‎‎‎g‎‎‎a‎‎‎r‎‎‎i‎‎‎a‎‎‎.‎‎‎

P‎‎‎h‎‎‎o‎‎‎t‎‎‎o‎‎‎g‎‎‎r‎‎‎a‎‎‎p‎‎‎h‎‎‎ ‎‎‎c‎‎‎r‎‎‎e‎‎‎d‎‎‎i‎‎‎t‎‎‎:‎‎‎ ‎‎‎C‎‎‎h‎‎‎a‎‎‎r‎‎‎l‎‎‎e‎‎‎s‎‎‎ ‎‎‎J‎‎‎.‎‎‎ ‎‎‎S‎‎‎h‎‎‎a‎‎‎r‎‎‎p‎‎‎

.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎.‎‎‎

W‎‎‎e‎‎‎l‎‎‎l‎‎‎ ‎‎‎i‎‎‎t‎‎‎'‎‎‎s‎‎‎ ‎‎‎t‎‎‎i‎‎‎m‎‎‎e‎‎‎ ‎‎‎t‎‎‎o‎‎‎ ‎‎‎p‎‎‎r‎‎‎o‎‎‎v‎‎‎e‎‎‎ ‎‎‎o‎‎‎n‎‎‎c‎‎‎e‎‎‎ ‎‎‎a‎‎‎n‎‎‎d‎‎‎ ‎‎‎f‎‎‎o‎‎‎r‎‎‎ ‎‎‎a‎‎‎l‎‎‎l‎‎‎ ‎‎‎t‎‎‎h‎‎‎a‎‎‎t‎‎‎ ‎‎‎J‎‎‎e‎‎‎w‎‎‎s‎‎‎ ‎‎‎a‎‎‎r‎‎‎e‎‎‎ ‎‎‎b‎‎‎a‎‎‎g‎‎‎e‎‎‎l‎‎‎s‎‎‎e‎‎‎x‎‎‎u‎‎‎a‎‎‎l‎‎‎s‎‎‎.‎‎‎"
CZpFcZ51,Footnote Icons,_Pandora,CSS,Sunday 17th of September 2023 09:50:12 PM CDT,"/* Codes made by Pandora #144118  
Codes may be edited, used in commissions or for personal use
Please do not remove credit
*/

/* FOOTNOTE - MUT */
img[src$=""footmut.png""] {
    content:url('LINK')!important;
    width:20px!important;
 
}

/* FOOTNOTE - HUNT */
img[src$=""foothunt.png""] {
    content:url('LINK')!important;
    width:20px!important;
 
}

/* FOOTNOTE - HEIR */
img[src$=""footheir.png""] {
    content:url('LINK')!important;
    width:20px!important;
 
}

/* FOOTNOTE - BREED/HEART */
img[src$=""footbreed.png""] {
    content:url('LINK')!important;
    width:20px!important;
 
}

/* FOOTNOTE - CROSS/X */
img[src$=""footx.png""] {
    content:url('LINK')!important;
    width:20px!important;
 
}

/* FOOTNOTE - BIO/BOOK */
img[src$=""footbio.png""] {
    content:url('LINK')!important;
    width:20px!important;
 
}

/* FOOTNOTE - INFERTILE/BROKEN HEART*/
img[src$=""footinfertile.png""] {
    content:url('LINK')!important;
    width:20px!important;
 
}"
ZFgjTCjW,Log ISO Invalid PIN BJB 18/09/2023 10:23,Abikayusri19,Bash,Sunday 17th of September 2023 09:29:27 PM CDT,"10:23:44.620 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.CensorCommonsRequestLoggingFilter - REQUEST DATA : POST /trx]
10:23:44.620 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Original bitmap: {32=110, 33=000110, 2=622011020020638074, 3=319900, 35=622011020020638074D2802221, 4=0, 7=0918032344, 41=70040001, 42=700400010001, 43=Menara BCA Lt 39      KABUPATEN TOLIJBID, 12=102344, 13=0918, 14=2802, 15=0919, 49=360, 18=6012, 52=C8BE40AE30C8448B, 22=051}
10:23:44.621 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ===========================request begin================================================
10:23:44.621 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - URI         : http://bjb-hsm/bjb/hsm/pin
10:23:44.621 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Headers     : [Accept:""application/json, application/*+json"", Content-Type:""application/json"", Content-Length:""88""]
10:23:44.621 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Request body: {""terminalId"":""70040001"",""pinUnderTpk"":""C8BE40AE30C8448B"",""cardNo"":""622011020020638074""}
10:23:44.621 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ==========================request end================================================
10:23:44.717 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - ============================response begin==========================================
10:23:44.717 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status code  : 200 OK
10:23:44.717 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Status text  : 
10:23:44.717 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - Response body: {""pinBlock"":""D81C8E948A3B93A6""}
10:23:44.717 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.c.BjbHtcHsmConfig - =======================response end=================================================
10:23:44.719 [http-nio-9872-exec-2] DEBUG i.b.n.e.i.e.b.p.s.BjbTrxServiceImpl - Updated bitmap: {32=110, 33=000110, 2=622011020020638074, 3=319900, 35=622011020020638074D2802221, 4=0, 37=000000209312, 7=0918032344, 41=70040001, 42=700400010001, 43=Menara BCA Lt 39      KABUPATEN TOLIJBID, 11=209312, 12=102344, 13=0918, 14=2802, 15=0919, 49=360, 18=6012, 52=D81C8E948A3B93A6, 22=051, 90=020020931209180323440000000011000000000110}
10:23:44.721 [http-nio-9872-exec-2] DEBUG i.b.n.c.c.c.s.RedisBackedCacheService - puts key: /j8583_000000209312, object: {""dataB64"":""MDIwMEYyM0U0NDAxQThFMDkwMDAwMDAwMDA0MDAwMDAwMDIwMTg2MjIwMTEwMjAwMjA2MzgwNzQzMTk5MDAwMDAwMDAwMDAwMDAwOTE4MDMyMzQ0MjA5MzEyMTAyMzQ0MDkxODI4MDIwOTE5NjAxMjA1MTAzMTEwMDYwMDAxMTAyNjYyMjAxMTAyMDAyMDYzODA3NEQyODAyMjIxMDAwMDAwMjA5MzEyNzAwNDAwMDE3MDA0MDAwMTAwMDEgICBNZW5hcmEgQkNBIEx0IDM5ICAgICAgS0FCVVBBVEVOIFRPTElKQklEMzYwRDgxQzhFOTQ4QTNCOTNBNjAyMDAyMDkzMTIwOTE4MDMyMzQ0MDAwMDAwMDAxMTAwMDAwMDAwMDExMDAyMDAwMDAyMDkzMTIwMDAwMjA5MzEy"",""binaryHeader"":false,""isoHeader"":null,""binaryHeaderB64"":null}, timeout: 10, timeunit: MINUTES
10:23:44.721 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] WRITE: Message: 0200F23E4401A8E0900000000040000000201862201102002063807431990000000000000009180323442093121023440918280209196012051031100600011026622011020020638074D280222100000020931270040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID360D81C8E948A3B93A602002093120918032344000000001100000000011002000002093120000209312
MTI: 0x0200
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '319900'
  4: [NUMERIC(12)] = '000000000000'
  7: [NUMERIC(10)] = '0918032344'
  11: [NUMERIC(6)] = '209312'
  12: [NUMERIC(6)] = '102344'
  13: [DATE4(4)] = '0918'
  14: [NUMERIC(4)] = '2802'
  15: [NUMERIC(4)] = '0919'
  18: [NUMERIC(4)] = '6012'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLBCDBIN(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209312'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = 'D81C8E948A3B93A6'
  90: [NUMERIC(42)] = '020020931209180323440000000011000000000110'
  123: [LLLVAR(20)] = '00002093120000209312'
10:23:44.722 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] FLUSH
10:23:44.723 [http-nio-9872-exec-2] DEBUG id.basys.ntt.edc.iso.MbIsoListener - RRN: 209312, Waiting for 70
10:23:44.918 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - INCOMING: 3032313037323332303430314141453039303030313836323230313130323030323036333830373433313939303030303030303030303030303030393138303332333434323039333132313032333434303931393035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333132353537303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a42494433363044383143384539343841334239334136
10:23:44.918 [nioEventLoopGroup-4-3] DEBUG i.b.n.e.i.e.b.i.BJBCollegaJ8583MessageFactory - CUTS: 3032313037323332303430314141453039303030313836323230313130323030323036333830373433313939303030303030303030303030303030393138303332333434323039333132313032333434303931393035313033313130303630303031313032363632323031313032303032303633383037344432383032323231303030303030323039333132353537303034303030313730303430303031303030312020204d656e61726120424341204c742033392020202020204b414255504154454e20544f4c494a42494433363044383143384539343841334239334136
10:23:44.918 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ: Message: 021072320401AAE090001862201102002063807431990000000000000009180323442093121023440919051031100600011026622011020020638074D28022210000002093125570040001700400010001   Menara BCA Lt 39      KABUPATEN TOLIJBID360D81C8E948A3B93A6
MTI: 0x0210
  2: [LLVAR(18)] = '622011020020638074'
  3: [NUMERIC(6)] = '319900'
  4: [NUMERIC(12)] = '000000000000'
  7: [NUMERIC(10)] = '0918032344'
  11: [NUMERIC(6)] = '209312'
  12: [TIME(6)] = '102344'
  15: [NUMERIC(4)] = '0919'
  22: [NUMERIC(3)] = '051'
  32: [LLVAR(3)] = '110'
  33: [LLVAR(6)] = '000110'
  35: [LLVAR(26)] = '622011020020638074D2802221'
  37: [NUMERIC(12)] = '000000209312'
  39: [ALPHA(2)] = '55'
  41: [ALPHA(8)] = '70040001'
  42: [ALPHA(15)] = '700400010001   '
  43: [ALPHA(40)] = 'Menara BCA Lt 39      KABUPATEN TOLIJBID'
  49: [NUMERIC(3)] = '360'
  52: [BINARY(8)] = 'D81C8E948A3B93A6'
10:23:44.919 [nioEventLoopGroup-5-2] DEBUG i.b.n.e.i.c.CustomIsoLoggingHandler - [id: 0xa36f6e92, L:/10.19.52.7:47100 - R:/10.44.224.145:10608] READ COMPLETE
10:23:44.919 [pool-1-thread-62] INFO  i.b.n.e.iso.IsoListenerProcessorImpl - handling 0210, rrn:209312
10:23:44.919 [pool-1-thread-62] DEBUG id.basys.ntt.edc.iso.MbIsoListener - Received response of 209312"
4hcEjute,Ooma Scraper,jasonsf,Perl,Sunday 17th of September 2023 08:04:07 PM CDT,"#!/usr/bin/perl -w
#
#
# ooma.pl - Give me my mp3 voicemail in an email without paying for Ooma Premier
#
# @gitrc - summer 2010
#
# screen scraping still valuable

use LWP::Simple;
use LWP::UserAgent;
use HTTP::Request::Common;
use HTTP::Cookies;
use File::Slurp;
use MIME::Lite;
use Data::Dumper;
use strict;

my $time=localtime;
my ($day,$month,$date,$tm,$year)=split(/\s+/,$time);
my $stamp=$year.""_"".$month.""_"".$date;
my $logdir=""/g/code/ooma/logs/"".$stamp;
my $LOGFILE = ""$logdir.log"";
open( LOG, "">>"", $LOGFILE ) or die ""Can't open log "" . $LOGFILE . "" $!\n"";
PrintLogCon( $tm . "" Checking Ooma Voicemail\n"");

my $debug;
$debug = exists( $ENV{SSH_CLIENT} ) ? 1 : 0;
$debug = 1;
# Following line is endpoint for my healthcheck
my $healthcheck = 'http://HEALTHCHECK ENDPOINT';
my $hcresponse = get($healthcheck);
my $auth_url  = 'https://my.ooma.com/login';
my $inbox_url = 'https://my.ooma.com/phone/voicemail';
my $log_url   = 'https://my.ooma.com/phone/call_logs.xls?order_type=time&order=desc';

my $username     = 'OOMA USERNAME';
my $password     = 'OOMA PASSWORD';
my $submit_value = 'commit';

my $ua = LWP::UserAgent->new;
$ua->agent(""Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)"");
my $cookie_jar =     HTTP::Cookies->new(
        file           => ""ooma_cookies"",
        autosave       => 1,
        ignore_discard => 0
    );

$ua->cookie_jar($cookie_jar);

my $content = $ua->get($auth_url)->as_string;
PrintLogCon( $tm . "" Couldn't get $auth_url: $!\n"") unless defined $content;
die ""Couldn't get $auth_url"" unless defined $content;

$content =~ m/""authenticity_token""[^<]+value=""(.*?)""/;
my $token = $1;

$content = $ua->request(
    POST $auth_url ,
    [
        username           => $username,
        password           => $password,
        authenticity_token => $token
    ]
);
PrintLogCon( $tm . "" Couldn't get $auth_url: $!\n"") unless defined $content;
die ""Couldn't get $auth_url"" unless defined $content;

$content = $ua->get($inbox_url)->as_string;
PrintLogCon( $tm . "" Couldn't get $inbox_url: $!\n"") unless defined $content;
die ""Couldn't get $inbox_url"" unless defined $content;

$content =~ m/""csrf-token"" content=""(.*?)""/;
my $csrftoken = $1;

$content =~ 
  m/check_voice_label\"" for=\""chk_(\w+-\w+-\w+-\w+-\w+)/; 
#my $caller    = $1;
my $uidnumber = $1;
PrintLogCon( $tm . "" No voicemail: $!\n"") unless defined $uidnumber;
die ""No voicemail"" unless defined $uidnumber;
my $file_url =
""https://my.ooma.com/phone/voicemail/get_link?message[id]=$uidnumber&message[folder]=INBOX"";
#print ""DEBUG: caller=$caller uidnumber=$uidnumber file_url = $file_url\n""
#print ""DEBUG: file_url = $file_url\n"";

$content =~ m/data-name=\'(\w+)\' data-number=\'(.+)\' data-toggle/m;

my $caller;
$caller = $1;
my $callerphone;
$callerphone = $2;
if (!defined $callerphone) {
  #Number from contacts
  $content =~ m/href=\""\/phone\/contacts\/\d.+\""\>(.+)\</m;
  $caller = $1;
  $content =~ m/show-contact-link\"" data-toggle=\'tooltip\' data-original-title=\'(.+)/mg;
  $callerphone = $1;
}

PrintLogCon( $tm . "" No Voicemail: $!\n"") unless defined $callerphone;
die ""No voicemail"" unless defined $callerphone;
$content =~ m/data-date=\""(\w+)\""\>/m;

my $calldate = $1;

#print ""DEBUG: caller=$caller callerphone=$callerphone date=$calldate\n"";


$content = $ua->get($file_url)->as_string;
$content =~ m/{\""success\"":true,\""url\"":\""(https.*?mp3)\""}/;

my $vm_url = $1;
#print ""DEBUG: vm url = $vm_url"";

$content = $ua->get($vm_url)->as_string;
my $filename = $caller . ""_"" . $callerphone . ""_"" . $calldate;
write_file( 'PATH TO SAVE MP3'.$filename .'.mp3', { binmode => ':raw' }, $content );
PrintLogCon( $tm . "" Saving mp3 Voicemail: $filename: $!\n"");
#write_file( './'.$filename .'.mp3', { binmode => ':raw' }, $content );


my $delete_url = ""https://my.ooma.com/phone/voicemail/delete"";
my $formdata =  'messages%5Bid%5D%5B%5D=' . $uidnumber . '&messages%5Bfolder%5D=INBOX';

#print ""DEBUG: $formdata\n"";

my $req = HTTP::Request->new(DELETE => $delete_url); 
$req->content($formdata);

$ua->cookie_jar($cookie_jar);
$req->content_type('application/x-www-form-urlencoded; charset=UTF-8');
  $req->header('authority'=> 'my.ooma.com');
$req->header('origin'=> 'https://my.ooma.com' );
  $req->header('pragma'=> 'no-cache' );
  $req->header('referer'=> 'https://my.ooma.com/phone/voicemail' );
    $req->header('sec-fetch-mode'=> 'cors' );
  $req->header('sec-fetch-site'=> 'same-origin' );
  $req->header('accept-encoding'=> 'gzip, deflate, br' );
  $req->header('x-csrf-token'=> $csrftoken);
$content = $ua->request($req);
#print $content->content;
close LOG or die ""Error closing $LOGFILE: $!"";
sub PrintLogCon {
  print @_;
  print(LOG @_) or die ""Error printing to $LOGFILE: $!"";
  }
"
MZrY3XNC,Reborn shatters admin glitcher script,angrybirdice,Lua,Sunday 17th of September 2023 08:03:22 PM CDT,"local v0=tonumber;local v1=string.byte;local v2=string.char;local v3=string.sub;local v4=string.gsub;local v5=string.rep;local v6=table.concat;local v7=table.insert;local v8=math.ldexp;local v9=getfenv or function()return _ENV;end ;local v10=setmetatable;local v11=pcall;local v12=select;local v13=unpack or table.unpack ;local v14=tonumber;local function v15(v16,v17,...)local v18=1;local v19;v16=v4(v3(v16,5),"".."",function(v30)if (v1(v30,2)==79) then local v72=0;while true do if (v72==0) then v19=v0(v3(v30,1,1));return """";end end else local v73=v2(v0(v30,16));if v19 then local v82=0;local v83;while true do if (v82==1) then return v83;end if (v82==0) then v83=v5(v73,v19);v19=nil;v82=1;end end else return v73;end end end);local function v20(v31,v32,v33)if v33 then local v74=0 -0 ;local v75;while true do if (v74==(0 -0)) then v75=(v31/(2^(v32-(878 -(282 + 595)))))%(((1640 -(1523 + 114)) -1)^(((v33-(2 -1)) -(v32-(620 -(555 + 64)))) + (932 -(857 + 74)))) ;return v75-(v75%1) ;end end else local v76=(511 + 57) -(367 + 201) ;local v77;while true do if (v76==0) then v77=(929 -(214 + 713))^(v32-(1 + 0)) ;return (((v31%(v77 + v77))>=v77) and 1) or (0 + 0) ;end end end end local function v21()local v34=0;local v35;while true do if (v34==(1 -0)) then return v35;end if (v34==(1065 -(68 + 978 + 19))) then v35=v1(v16,v18,v18);v18=v18 + (118 -(32 + 85)) ;v34=1;end end end local function v22()local v36,v37=v1(v16,v18,v18 + 1 + 1 );v18=v18 + (959 -(892 + 65)) ;return (v37 * (610 -354)) + v36 ;end local function v23()local v38=(0 + 0) -0 ;local v39;local v40;local v41;local v42;while true do if (v38==(1 -0)) then return (v42 * 16777216) + (v41 * (65886 -(87 + 263))) + (v40 * (436 -(67 + 113))) + v39 ;end if (v38==(0 + 0)) then v39,v40,v41,v42=v1(v16,v18,v18 + 3 );v18=v18 + 4 ;v38=(7 -5) -1 ;end end end local function v24()local v43=952 -(802 + 150) ;local v44;local v45;local v46;local v47;local v48;local v49;while true do if (v43==(1486 -(998 + 488))) then v44=v23();v45=v23();v43=(1 + 1) -1 ;end if (v43==(5 -2)) then if (v48==(0 + 0 + 0)) then if (v47==(997 -(915 + 82))) then return v49 * (0 -0) ;else local v102=0 + 0 ;while true do if (v102==((772 -(201 + 571)) -0)) then v48=1;v46=1187 -(1069 + 118) ;break;end end end elseif (v48==(4643 -2596)) then return ((v47==(0 -0)) and (v49 * (1/(0 + 0)))) or (v49 * NaN) ;end return v8(v49,v48-(1817 -794) ) * (v46 + (v47/((2 + 0)^52))) ;end if (v43==2) then v48=v20(v45,21,822 -(368 + 423) );v49=((v20(v45,100 -68 )==(19 -((1148 -(116 + 1022)) + 8))) and  -(3 -2)) or (443 -(416 + 26)) ;v43=9 -(24 -18) ;end if (v43==(1 + 0)) then v46=1 -0 ;v47=(v20(v45,1,458 -(145 + 293) ) * (((254 + 178) -(44 + 386))^32)) + v44 ;v43=2;end end end local function v25(v50)local v51;if  not v50 then local v78=0;while true do if (v78==(0 -0)) then v50=v23();if (v50==0) then return """";end break;end end end v51=v3(v16,v18,(v18 + v50) -(3 -(4 -2)) );v18=v18 + v50 ;local v52={};for v70=(47 + 813) -(814 + 45) , #v51 do v52[v70]=v2(v1(v3(v51,v70,v70)));end return v6(v52);end local v26=v23;local function v27(...)return {...},v12(""#"",...);end local function v28()local v53=1690 -(209 + 1481) ;local v54;local v55;local v56;local v57;local v58;local v59;local v60;local v61;local v62;while true do if (1==v53) then v56=nil;v57=nil;v53=5 -3 ;end if (v53~=4) then else v62=nil;while true do if (v54~=1) then else v57=nil;v58=nil;v54=2;end if (4==v54) then while true do if (v55~=0) then else v56=0;v57=nil;v55=1;end if (v55~=2) then else local v109=0;while true do if (v109==1) then v55=3;break;end if (v109~=(1636 -(1373 + 263))) then else v60=nil;v61=nil;v109=1001 -(451 + 549) ;end end end if (v55~=3) then else v62=nil;while true do local v110=0 + 0 ;local v111;while true do if (v110==(0 -0)) then v111=0;while true do if (v111~=(0 -0)) then else local v112=0;local v113;while true do if (v112==0) then v113=1384 -(746 + 638) ;while true do if (1==v113) then v111=1;break;end if ((0 + 0)==v113) then if (2~=v56) then else local v264=0;local v265;local v266;while true do if (v264~=(1 -0)) then else while true do if (v265==(341 -(218 + 123))) then v266=0;while true do local v279=0;local v280;while true do if (v279==(1581 -(1535 + 46))) then v280=0 + 0 ;while true do if (v280==0) then if (v266==(0 + 0)) then local v288=560 -(306 + 254) ;local v289;while true do if (v288==0) then v289=0 + 0 ;while true do if (v289==(1 -0)) then v266=1;break;end if (v289~=0) then else for v292=1468 -(899 + 568) ,v23() do local v293=0 + 0 ;local v294;local v295;while true do if (v293~=1) then else while true do if (v294~=(0 -0)) then else v295=v21();if (v20(v295,604 -(268 + 335) ,1)~=(290 -(60 + 230))) then else local v298=572 -(426 + 146) ;local v299;local v300;local v301;local v302;local v303;while true do if (v298~=1) then else v301=nil;v302=nil;v298=2;end if (v298==(1 + 1)) then v303=nil;while true do if (v299==2) then while true do if (v300==1) then local v307=1456 -(282 + 1174) ;while true do if (v307==(812 -(569 + 242))) then v300=5 -3 ;break;end if (v307==0) then v303={v22(),v22(),nil,nil};if (v301==(1251 -(721 + 530))) then local v315=0;local v316;while true do if (v315==0) then v316=1271 -(945 + 326) ;while true do if (v316==(0 -0)) then v303[3]=v22();v303[4]=v22();break;end end break;end end elseif (v301==1) then v303[3]=v23();elseif (v301==2) then v303[3 + 0 ]=v23() -(2^(716 -(271 + 429))) ;elseif (v301==(3 + 0)) then local v321=0;local v322;while true do if (v321~=(1500 -(1408 + 92))) then else v322=0;while true do if (0==v322) then v303[3]=v23() -(2^16) ;v303[1090 -(461 + 625) ]=v22();break;end end break;end end end v307=1289 -(993 + 295) ;end end end if ((1 + 2)~=v300) then else if (v20(v302,1174 -(418 + 753) ,3)~=1) then else v303[4]=v62[v303[2 + 2 ]];end v57[v292]=v303;break;end if (v300~=0) then else local v309=0;while true do if (v309==1) then v300=1 + 0 ;break;end if (v309==(0 + 0)) then v301=v20(v295,1 + 1 ,532 -(406 + 123) );v302=v20(v295,4,6);v309=1;end end end if (v300==2) then local v310=0;local v311;local v312;while true do if (v310==(1769 -(1749 + 20))) then v311=0 + 0 ;v312=nil;v310=1;end if ((1323 -(1249 + 73))==v310) then while true do if (v311==0) then v312=0 + 0 ;while true do if (v312==1) then v300=1148 -(466 + 679) ;break;end if ((0 -0)~=v312) then else if (v20(v302,2 -1 ,1901 -(106 + 1794) )==1) then v303[1 + 1 ]=v62[v303[2]];end if (v20(v302,1 + 1 ,2)==1) then v303[8 -5 ]=v62[v303[3]];end v312=2 -1 ;end end break;end end break;end end end end break;end if (v299==0) then local v304=0;local v305;while true do if (v304==(114 -(4 + 110))) then v305=0;while true do if (v305~=(584 -(57 + 527))) then else v300=1427 -(41 + 1386) ;v301=nil;v305=1;end if (v305==(104 -(17 + 86))) then v299=1;break;end end break;end end end if (v299==(1 + 0)) then local v306=0 -0 ;while true do if (1==v306) then v299=5 -3 ;break;end if (v306==0) then v302=nil;v303=nil;v306=167 -(122 + 44) ;end end end end break;end if (v298==0) then v299=0 -0 ;v300=nil;v298=1;end end end break;end end break;end if (0==v293) then v294=0 -0 ;v295=nil;v293=1 + 0 ;end end end for v296=1,v23() do v58[v296-(1 + 0) ]=v28();end v289=1;end end break;end end end if (v266==1) then return v60;end break;end end break;end end end break;end end break;end if (v264==0) then v265=0 -0 ;v266=nil;v264=66 -(30 + 35) ;end end end if (v56~=(1 + 0)) then else local v267=0;local v268;while true do if ((1257 -(1043 + 214))~=v267) then else v268=0 -0 ;while true do if (v268~=2) then else v56=1214 -(323 + 889) ;break;end if (v268~=(0 -0)) then else local v277=0;while true do if (v277==(580 -(361 + 219))) then v61=v23();v62={};v277=1;end if (v277~=(321 -(53 + 267))) then else v268=1;break;end end end if (v268==(1 + 0)) then local v278=413 -(15 + 398) ;while true do if (v278~=(983 -(18 + 964))) then else v268=7 -5 ;break;end if (v278==0) then for v282=1 + 0 ,v61 do local v283=0 + 0 ;local v284;local v285;local v286;local v287;while true do if (v283==0) then v284=850 -(20 + 830) ;v285=nil;v283=1 + 0 ;end if ((127 -(116 + 10))==v283) then v286=nil;v287=nil;v283=1 + 1 ;end if ((740 -(542 + 196))~=v283) then else while true do if (v284==(1 -0)) then v287=nil;while true do if (v285==(1 + 0)) then if (v286==(1 + 0)) then v287=v21()~=(0 + 0) ;elseif (v286==2) then v287=v24();elseif (v286==3) then v287=v25();end v62[v282]=v287;break;end if (v285==(0 -0)) then local v291=0 -0 ;while true do if (v291==(1551 -(1126 + 425))) then v286=v21();v287=nil;v291=406 -(118 + 287) ;end if (v291==(3 -2)) then v285=1122 -(118 + 1003) ;break;end end end end break;end if (v284==(0 -0)) then v285=377 -(142 + 235) ;v286=nil;v284=4 -3 ;end end break;end end end v60[1 + 2 ]=v21();v278=1;end end end end break;end end end v113=978 -(553 + 424) ;end end break;end end end if (v111==(1 -0)) then if (v56==(0 + 0)) then local v122=0 + 0 ;local v123;while true do if (v122~=(0 + 0)) then else v123=0 + 0 ;while true do if (v123~=1) then else v59={};v60={v57,v58,nil,v59};v123=4 -2 ;end if (v123==(1 + 1)) then v56=4 -3 ;break;end if (v123==0) then v57={};v58={};v123=1;end end break;end end end break;end end break;end end end break;end if (v55~=1) then else v58=nil;v59=nil;v55=2;end end break;end if (v54==(753 -(239 + 514))) then v55=0;v56=nil;v54=1;end if (v54==2) then local v100=0;while true do if (v100==(1 + 0)) then v54=1332 -(797 + 532) ;break;end if (v100==(0 + 0)) then v59=nil;v60=nil;v100=1 + 0 ;end end end if (v54==3) then local v101=0;while true do if (v101==1) then v54=4;break;end if (v101==0) then v61=nil;v62=nil;v101=2 -1 ;end end end end break;end if (0==v53) then v54=1202 -(373 + 829) ;v55=nil;v53=1;end if (v53~=2) then else v58=nil;v59=nil;v53=3;end if (v53~=3) then else v60=nil;v61=nil;v53=4;end end end local function v29(v63,v64,v65)local v66=0;local v67;local v68;local v69;while true do if (0==v66) then v67=v63[1];v68=v63[2];v66=1;end if (v66==1) then v69=v63[3];return function(...)local v84=v67;local v85=v68;local v86=v69;local v87=v27;local v88=1;local v89= -1;local v90={};local v91={...};local v92=v12(""#"",...) -1 ;local v93={};local v94={};for v98=0,v92 do if (v98>=v86) then v90[v98-v86 ]=v91[v98 + 1 ];else v94[v98]=v91[v98 + 1 ];end end local v95=(v92-v86) + 1 ;local v96;local v97;while true do local v99=0;while true do if (0==v99) then v96=v84[v88];v97=v96[1];v99=1;end if (v99==1) then if (v97<=12) then if (v97<=5) then if (v97<=2) then if (v97<=0) then v94[v96[2]]=v65[v96[3]];elseif (v97==1) then local v124;v94[v96[2]]=v94[v96[3]];v88=v88 + 1 ;v96=v84[v88];v124=v96[2];v94[v124](v94[v124 + 1 ]);v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v94[v96[3]];v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v94[v96[3]];v88=v88 + 1 ;v96=v84[v88];v124=v96[2];v94[v124](v94[v124 + 1 ]);v88=v88 + 1 ;v96=v84[v88];v88=v96[3];else local v130=0;local v131;local v132;while true do if (v130==1) then v94[v131 + 1 ]=v132;v94[v131]=v132[v96[4]];break;end if (v130==0) then v131=v96[2];v132=v94[v96[3]];v130=1;end end end elseif (v97<=3) then v64[v96[3]]=v94[v96[2]];elseif (v97>4) then local v133=0;local v134;local v135;local v136;while true do if (v133==0) then v134=v85[v96[3]];v135=nil;v133=1;end if (v133==2) then for v243=1,v96[4] do v88=v88 + 1 ;local v244=v84[v88];if (v244[1]==25) then v136[v243-1 ]={v94,v244[3]};else v136[v243-1 ]={v64,v244[3]};end v93[ #v93 + 1 ]=v136;end v94[v96[2]]=v29(v134,v135,v65);break;end if (v133==1) then v136={};v135=v10({},{__index=function(v246,v247)local v248=v136[v247];return v248[1][v248[2]];end,__newindex=function(v249,v250,v251)local v252=v136[v250];v252[1][v252[2]]=v251;end});v133=2;end end else local v137=0;local v138;local v139;while true do if (v137==4) then v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v96[3];v88=v88 + 1 ;v137=5;end if (v137==1) then v94[v139 + 1 ]=v138;v94[v139]=v138[v96[4]];v88=v88 + 1 ;v96=v84[v88];v137=2;end if (v137==6) then v94[v96[2]]=v94[v96[3]][v94[v96[4]]];v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v94[v96[3]][v96[4]];v137=7;end if (v137==0) then v138=nil;v139=nil;v139=v96[2];v138=v94[v96[3]];v137=1;end if (v137==3) then v88=v88 + 1 ;v96=v84[v88];v139=v96[2];v94[v139]=v94[v139](v13(v94,v139 + 1 ,v96[3]));v137=4;end if (v137==5) then v96=v84[v88];v94[v96[2]]=v94[v96[3]][v94[v96[4]]];v88=v88 + 1 ;v96=v84[v88];v137=6;end if (v137==8) then v96=v84[v88];v94[v96[2]]=v94[v96[3]][v94[v96[4]]];break;end if (v137==2) then v94[v96[2]]=v94[v96[3]];v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v94[v96[3]];v137=3;end if (v137==7) then v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v94[v96[3]][v96[4]];v88=v88 + 1 ;v137=8;end end end elseif (v97<=8) then if (v97<=6) then local v118=v96[2];v94[v118]=v94[v118](v13(v94,v118 + 1 ,v96[3]));elseif (v97>7) then v94[v96[2]]=v94[v96[3]][v96[4]];else for v170=v96[2],v96[3] do v94[v170]=nil;end end elseif (v97<=10) then if (v97==9) then do return;end else local v142=0;local v143;local v144;while true do if (v142==3) then v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v94[v96[3]][v96[4]];v88=v88 + 1 ;v142=4;end if (v142==0) then v143=nil;v144=nil;v94[v96[2]]=v94[v96[3]][v94[v96[4]]];v88=v88 + 1 ;v142=1;end if (v142==2) then v94[v144]=v143[v96[4]];v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v94[v96[3]];v142=3;end if (v142==1) then v96=v84[v88];v144=v96[2];v143=v94[v96[3]];v94[v144 + 1 ]=v143;v142=2;end if (v142==4) then v96=v84[v88];if  not v94[v96[2]] then v88=v88 + 1 ;else v88=v96[3];end break;end end end elseif (v97>11) then local v145=0;local v146;local v147;local v148;while true do if (v145==0) then v146=v96[2];v147={v94[v146](v94[v146 + 1 ])};v145=1;end if (1==v145) then v148=0;for v254=v146,v96[4] do v148=v148 + 1 ;v94[v254]=v147[v148];end break;end end else v94[v96[2]]=v96[3];end elseif (v97<=18) then if (v97<=15) then if (v97<=13) then local v120=0;local v121;while true do if (0==v120) then v121=v96[2];v94[v121](v13(v94,v121 + 1 ,v96[3]));break;end end elseif (v97>14) then v94[v96[2]]=v96[3]~=0 ;else v94[v96[2]]=v64[v96[3]];end elseif (v97<=16) then if (v94[v96[2]]==v96[4]) then v88=v88 + 1 ;else v88=v96[3];end elseif (v97==17) then v94[v96[2]]=v65[v96[3]];v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v96[3]~=0 ;v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v96[3];v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v96[3];v88=v88 + 1 ;v96=v84[v88];for v173=v96[2],v96[3] do v94[v173]=nil;end v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v65[v96[3]];v88=v88 + 1 ;v96=v84[v88];v94[v96[2]]=v65[v96[3]];elseif v94[v96[2]] then v88=v88 + 1 ;else v88=v96[3];end elseif (v97<=21) then if (v97<=19) then if  not v94[v96[2]] then v88=v88 + 1 ;else v88=v96[3];end elseif (v97==20) then local v160=0;while true do if (v160==2) then v94[v96[2]]=v94[v96[3]][v94[v96[4]]];v88=v88 + 1 ;v96=v84[v88];v160=3;end if (v160==1) then v94[v96[2]]=v64[v96[3]];v88=v88 + 1 ;v96=v84[v88];v160=2;end if (v160==0) then v94[v96[2]]=v64[v96[3]];v88=v88 + 1 ;v96=v84[v88];v160=1;end if (v160==4) then do return;end break;end if (v160==3) then v64[v96[3]]=v94[v96[2]];v88=v88 + 1 ;v96=v84[v88];v160=4;end end else local v161=v96[2];local v162={};for v175=1, #v93 do local v176=0;local v177;while true do if (v176==0) then v177=v93[v175];for v259=0, #v177 do local v260=0;local v261;local v262;local v263;while true do if (v260==1) then v263=v261[2];if ((v262==v94) and (v263>=v161)) then v162[v263]=v262[v263];v261[1]=v162;end break;end if (v260==0) then v261=v177[v259];v262=v261[1];v260=1;end end end break;end end end end elseif (v97<=23) then if (v97==22) then local v163=0;local v164;while true do if (v163==0) then v164=v96[2];v94[v164](v94[v164 + 1 ]);break;end end else v88=v96[3];end elseif (v97>24) then v94[v96[2]]=v94[v96[3]];else v94[v96[2]]=v94[v96[3]][v94[v96[4]]];end v88=v88 + 1 ;break;end end end end;end end end return v29(v28(),{},v17)(...);end v15(""LOL!0D3O0003043O0067616D6503113O005265706C69636174656453746F7261676503053O00452O726F7203053O007072696E7403053O007063612O6C028O00031B3O004163746976617465486974626F7852656769737465726174696F6E030E3O0046696E6446697273744368696C6403073O00506C6179657273030B3O004C6F63616C506C6179657203043O004E616D65030A3O004669726553657276657203093O0043686172616374657200413O0012113O00016O000100013O00122O000200023O00122O000300036O000400043O00122O000500043O00122O000600053O00060500073O000100032O00193O00044O00198O00193O00024O000C0006000200070006120007002000013O0004173O0020000100120B000800064O0007000900093O00261000080010000100060004173O0010000100120B000900063O00261000090013000100060004173O001300012O0019000A00054O0001000B00036O000A000200014O000A00056O000B00076O000A0002000100044O002300010004173O001300010004173O002300010004173O001000010004173O002300012O0019000800054O0019000900014O001600080002000100120B000800073O0020040009000400084O000B00086O000C00016O0009000C000200122O000A00096O000B3O000A4O000C3O000A00202O000C000C000A00202O000C000C000B4O000B000B000C0006120009003C00013O0004173O003C0001000612000B003C00013O0004173O003C00012O0018000C3O00022O000A000C000C000800202O000C000C000C4O000E000B3O00202O000F000B000D00062O000F003A000100010004173O003A00012O0007000F000F4O000D000C000F00010004173O003F00012O0019000C00054O0019000D00034O0016000C000200012O00158O00093O00013O00018O00054O00143O00016O000100029O0000019O006O00017O00"",v9(),...);"
Mh4kB5tL,vterm.el top half,brickviking,Lisp,Sunday 17th of September 2023 07:24:54 PM CDT,";;; vterm.el --- Fully-featured terminal emulator -*- lexical-binding: t; -*-

;; Copyright (C) 2017-2020 by Lukas Fürmetz & Contributors
;;
;; Author: Lukas Fürmetz <fuermetz@mailbox.org>
;; Version: 0.0.2
;; URL: https://github.com/akermu/emacs-libvterm
;; Keywords: terminals
;; Package-Requires: ((emacs ""25.1""))


;; This file is not part of GNU Emacs.

;; This file is free software; you can redistribute it and/or modify
;; it under the terms of the GNU General Public License as published by
;; the Free Software Foundation; either version 2, or (at your option)
;; any later version.

;; This file is distributed in the hope that it will be useful,
;; but WITHOUT ANY WARRANTY; without even the implied warranty of
;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;; GNU General Public License for more details.

;; You should have received a copy of the GNU General Public License
;; along with GNU Emacs.  If not, see <https://www.gnu.org/licenses/>.


;;; Commentary:
;;
;; Emacs-libvterm (vterm) is fully-fledged terminal emulator based on an
;; external library (libvterm) loaded as a dynamic module.  As a result of using
;; compiled code (instead of elisp), emacs-libvterm is fully capable, fast, and
;; it can seamlessly handle large outputs.

;;; Installation

;; Emacs-libvterm requires support for loading modules.  You can check if your
;; Emacs supports modules by inspecting the variable module-file-suffix.  If it
;; nil, than, you need to recompile Emacs or obtain a copy of Emacs with this
;; option enabled.

;; Emacs-libvterm requires CMake and libvterm.  If libvterm is not available,
;; emacs-libvterm will downloaded and compiled.  In this case, libtool is
;; needed.

;; The reccomended way to install emacs-libvterm is from MELPA.

;;; Usage

;; To open a terminal, simply use the command M-x vterm.

;;; Tips and tricks

;; Adding some shell-side configuration enables a large set of additional
;; features, including, directory tracking, prompt recognition, message passing.

;;; Code:
"
khgvS3BA,2023-09-17_stats.json,rdp_snitch,JSON,Sunday 17th of September 2023 07:18:10 PM CDT,"{
  ""ip"": {
    ""74.235.152.128"": 9,
    ""194.5.82.131"": 6,
    ""170.187.229.182"": 12,
    ""106.116.169.71"": 3,
    ""35.244.85.121"": 6,
    ""205.210.31.51"": 9,
    ""77.65.29.51"": 3,
    ""45.143.201.62"": 9,
    ""141.98.11.128"": 9,
    ""87.236.197.21"": 3,
    ""87.251.75.145"": 6,
    ""167.94.138.35"": 3,
    ""178.128.59.3"": 36,
    ""87.251.75.120"": 3,
    ""58.218.204.183"": 12,
    ""198.235.24.123"": 9,
    ""146.190.118.195"": 6,
    ""136.144.35.93"": 3,
    ""62.122.184.166"": 12,
    ""54.38.99.202"": 6,
    ""62.122.184.168"": 12,
    ""85.195.99.170"": 9,
    ""193.142.146.17"": 9,
    ""193.142.147.9"": 9,
    ""103.218.240.168"": 3,
    ""194.165.16.111"": 3,
    ""84.232.175.122"": 3,
    ""205.210.31.184"": 9,
    ""185.234.216.63"": 3,
    ""64.227.136.135"": 12,
    ""87.251.75.64"": 3,
    ""139.99.68.96"": 3,
    ""185.73.125.22"": 6,
    ""187.0.56.25"": 3,
    ""62.204.41.134"": 12,
    ""198.235.24.113"": 9
  },
  ""asn"": {
    ""AS8075"": 9,
    ""AS137409"": 6,
    ""AS63949"": 12,
    ""AS4134"": 15,
    ""AS396982"": 42,
    ""AS13110"": 3,
    ""AS210950"": 9,
    ""AS209605"": 9,
    ""AS35592"": 3,
    ""AS208091"": 18,
    ""AS398324"": 3,
    ""AS14061"": 54,
    ""AS396356"": 3,
    ""AS57523"": 27,
    ""AS16276"": 9,
    ""AS20773"": 9,
    ""AS208046"": 18,
    ""AS135377"": 3,
    ""AS48721"": 3,
    ""AS8708"": 3,
    ""AS28352"": 3,
    ""AS59425"": 12
  },
  ""isp"": {
    ""Microsoft Corporation"": 9,
    ""GSL Networks Pty LTD"": 6,
    ""Akamai Technologies, Inc."": 12,
    ""Chinanet"": 15,
    ""Google LLC"": 42,
    ""INEA sp. z o.o."": 3,
    ""TOV E-RISHENNYA"": 9,
    ""UAB Host Baltic"": 9,
    ""Network of Coolhousing"": 3,
    ""Xhost Internet Solutions LP"": 18,
    ""Censys, Inc."": 3,
    ""DigitalOcean, LLC"": 54,
    ""Latitude.sh"": 3,
    ""Chang Way Technologies Co. Limited"": 27,
    ""OVH SAS"": 9,
    ""Host Europe GmbH"": 9,
    ""ColocationX Ltd."": 18,
    ""UCLOUD INFORMATION TECHNOLOGY (HK) LIMITED"": 3,
    ""Flyservers S.A."": 3,
    ""RCS & RDS"": 3,
    ""Netspeed Ltda"": 3,
    ""Horizon LLC"": 12
  },
  ""org"": {
    ""Microsoft Azure Cloud (eastus)"": 9,
    ""Unknown"": 15,
    ""Linode"": 12,
    ""Chinanet HE"": 3,
    ""Google Cloud (australia-southeast1)"": 6,
    ""Palo Alto Networks, Inc"": 36,
    ""Inea Sp. z o.o."": 3,
    ""TOV VAIZ PARTNER"": 9,
    ""Coolhousing s.r.o"": 3,
    ""Xhost Internet Solutions"": 12,
    ""Censys, Inc"": 3,
    ""Digitalocean"": 36,
    ""Chinanet JS"": 12,
    ""DigitalOcean, LLC"": 18,
    ""Panq B.V"": 3,
    ""Chang Way Technologies Co. Limited"": 27,
    ""BIN ABDULLAH Muhammad Ridhwan"": 6,
    ""Roaya Electronic"": 9,
    ""ColocationX Ltd"": 9,
    ""x33 Networks IBC"": 9,
    ""UCloud (HK) Holdings Group Limited"": 3,
    ""Flyservers S.A"": 3,
    ""RCS & RDS Business"": 3,
    ""OVH Singapore PTE. LTD"": 3,
    ""Xhostis"": 6,
    ""Netspeed Ltda"": 3,
    ""Horizon LLC"": 12
  },
  ""regionName"": {
    ""Virginia"": 9,
    ""North West"": 18,
    ""Hebei"": 3,
    ""New South Wales"": 6,
    ""California"": 42,
    ""Greater Poland"": 3,
    ""Kyiv City"": 9,
    ""Kaunas"": 12,
    ""Prague"": 3,
    ""England"": 18,
    ""Michigan"": 3,
    ""South West"": 36,
    ""Jiangsu"": 12,
    ""New Jersey"": 3,
    ""Moscow"": 39,
    ""Hauts-de-France"": 6,
    ""Hesse"": 9,
    ""North Holland"": 9,
    ""English River"": 9,
    ""Central and Western District"": 3,
    ""Ilfov"": 3,
    ""Karnataka"": 12,
    ""Central Singapore"": 3,
    ""Minas Gerais"": 3
  },
  ""country"": {
    ""United States"": 57,
    ""Singapore"": 57,
    ""China"": 15,
    ""Australia"": 6,
    ""Poland"": 3,
    ""Ukraine"": 9,
    ""Lithuania"": 12,
    ""Czechia"": 3,
    ""United Kingdom"": 18,
    ""Russia"": 39,
    ""France"": 6,
    ""Germany"": 9,
    ""Netherlands"": 9,
    ""Seychelles"": 9,
    ""Hong Kong"": 3,
    ""Romania"": 3,
    ""India"": 12,
    ""Brazil"": 3
  },
  ""account"": {
    ""Test"": 12,
    ""hello"": 114,
    ""(empty)"": 9,
    ""EigTuNned"": 3,
    ""uErfhv"": 3,
    ""rldCgd"": 3,
    ""Administr"": 42,
    ""UgWXsqwnb"": 3,
    ""sAydYx"": 3,
    ""bDlMYN"": 3,
    ""Domain"": 54,
    ""Administrator"": 6,
    ""YQGXNThQA"": 3,
    ""hRDPwC"": 3,
    ""YzDgBJ"": 3,
    ""FHCxAlHUP"": 3,
    ""cFvqla"": 3,
    ""RrFIUH"": 3
  },
  ""keyboard"": {
    ""Unknown"": 273
  },
  ""client_build"": {
    ""Unknown"": 273
  },
  ""client_name"": {
    ""Unknown"": 273
  },
  ""ip_type"": {
    ""hosting"": 141,
    ""proxy"": 12,
    ""Unknown"": 120
  }
}"
dGMkcuEz,Use sort-json-keys,Justman10000,Bash,Sunday 17th of September 2023 07:16:52 PM CDT,"// You need NodeJS (https://pastebin.com/Rf1vVKsR)

yarn global add sort-json-keys

// Replace PATH with the path, where are the JSON files
for file in $(ls PATH)
do
yarn sort-json-keys $file
done"
1br1xp5F,2023-09-17_stats.json,rdp_snitch,JSON,Sunday 17th of September 2023 07:16:04 PM CDT,"{
  ""ip"": {
    ""74.235.152.128"": 6,
    ""194.5.82.131"": 4,
    ""170.187.229.182"": 8,
    ""106.116.169.71"": 2,
    ""35.244.85.121"": 4,
    ""205.210.31.51"": 6,
    ""77.65.29.51"": 2,
    ""45.143.201.62"": 6,
    ""141.98.11.128"": 6,
    ""87.236.197.21"": 2,
    ""87.251.75.145"": 4,
    ""167.94.138.35"": 2,
    ""178.128.59.3"": 24,
    ""87.251.75.120"": 2,
    ""58.218.204.183"": 8,
    ""198.235.24.123"": 6,
    ""146.190.118.195"": 4,
    ""136.144.35.93"": 2,
    ""62.122.184.166"": 8,
    ""54.38.99.202"": 4,
    ""62.122.184.168"": 8,
    ""85.195.99.170"": 6,
    ""193.142.146.17"": 6,
    ""193.142.147.9"": 6,
    ""103.218.240.168"": 2,
    ""194.165.16.111"": 2,
    ""84.232.175.122"": 2,
    ""205.210.31.184"": 6,
    ""185.234.216.63"": 2,
    ""64.227.136.135"": 8,
    ""87.251.75.64"": 2,
    ""139.99.68.96"": 2,
    ""185.73.125.22"": 4,
    ""187.0.56.25"": 2,
    ""62.204.41.134"": 8,
    ""198.235.24.113"": 6
  },
  ""asn"": {
    ""AS8075"": 6,
    ""AS137409"": 4,
    ""AS63949"": 8,
    ""AS4134"": 10,
    ""AS396982"": 28,
    ""AS13110"": 2,
    ""AS210950"": 6,
    ""AS209605"": 6,
    ""AS35592"": 2,
    ""AS208091"": 12,
    ""AS398324"": 2,
    ""AS14061"": 36,
    ""AS396356"": 2,
    ""AS57523"": 18,
    ""AS16276"": 6,
    ""AS20773"": 6,
    ""AS208046"": 12,
    ""AS135377"": 2,
    ""AS48721"": 2,
    ""AS8708"": 2,
    ""AS28352"": 2,
    ""AS59425"": 8
  },
  ""isp"": {
    ""Microsoft Corporation"": 6,
    ""GSL Networks Pty LTD"": 4,
    ""Akamai Technologies, Inc."": 8,
    ""Chinanet"": 10,
    ""Google LLC"": 28,
    ""INEA sp. z o.o."": 2,
    ""TOV E-RISHENNYA"": 6,
    ""UAB Host Baltic"": 6,
    ""Network of Coolhousing"": 2,
    ""Xhost Internet Solutions LP"": 12,
    ""Censys, Inc."": 2,
    ""DigitalOcean, LLC"": 36,
    ""Latitude.sh"": 2,
    ""Chang Way Technologies Co. Limited"": 18,
    ""OVH SAS"": 6,
    ""Host Europe GmbH"": 6,
    ""ColocationX Ltd."": 12,
    ""UCLOUD INFORMATION TECHNOLOGY (HK) LIMITED"": 2,
    ""Flyservers S.A."": 2,
    ""RCS & RDS"": 2,
    ""Netspeed Ltda"": 2,
    ""Horizon LLC"": 8
  },
  ""org"": {
    ""Microsoft Azure Cloud (eastus)"": 6,
    ""Unknown"": 10,
    ""Linode"": 8,
    ""Chinanet HE"": 2,
    ""Google Cloud (australia-southeast1)"": 4,
    ""Palo Alto Networks, Inc"": 24,
    ""Inea Sp. z o.o."": 2,
    ""TOV VAIZ PARTNER"": 6,
    ""Coolhousing s.r.o"": 2,
    ""Xhost Internet Solutions"": 8,
    ""Censys, Inc"": 2,
    ""Digitalocean"": 24,
    ""Chinanet JS"": 8,
    ""DigitalOcean, LLC"": 12,
    ""Panq B.V"": 2,
    ""Chang Way Technologies Co. Limited"": 18,
    ""BIN ABDULLAH Muhammad Ridhwan"": 4,
    ""Roaya Electronic"": 6,
    ""ColocationX Ltd"": 6,
    ""x33 Networks IBC"": 6,
    ""UCloud (HK) Holdings Group Limited"": 2,
    ""Flyservers S.A"": 2,
    ""RCS & RDS Business"": 2,
    ""OVH Singapore PTE. LTD"": 2,
    ""Xhostis"": 4,
    ""Netspeed Ltda"": 2,
    ""Horizon LLC"": 8
  },
  ""regionName"": {
    ""Virginia"": 6,
    ""North West"": 12,
    ""Hebei"": 2,
    ""New South Wales"": 4,
    ""California"": 28,
    ""Greater Poland"": 2,
    ""Kyiv City"": 6,
    ""Kaunas"": 8,
    ""Prague"": 2,
    ""England"": 12,
    ""Michigan"": 2,
    ""South West"": 24,
    ""Jiangsu"": 8,
    ""New Jersey"": 2,
    ""Moscow"": 26,
    ""Hauts-de-France"": 4,
    ""Hesse"": 6,
    ""North Holland"": 6,
    ""English River"": 6,
    ""Central and Western District"": 2,
    ""Ilfov"": 2,
    ""Karnataka"": 8,
    ""Central Singapore"": 2,
    ""Minas Gerais"": 2
  },
  ""country"": {
    ""United States"": 38,
    ""Singapore"": 38,
    ""China"": 10,
    ""Australia"": 4,
    ""Poland"": 2,
    ""Ukraine"": 6,
    ""Lithuania"": 8,
    ""Czechia"": 2,
    ""United Kingdom"": 12,
    ""Russia"": 26,
    ""France"": 4,
    ""Germany"": 6,
    ""Netherlands"": 6,
    ""Seychelles"": 6,
    ""Hong Kong"": 2,
    ""Romania"": 2,
    ""India"": 8,
    ""Brazil"": 2
  },
  ""account"": {
    ""Test"": 8,
    ""hello"": 76,
    ""(empty)"": 6,
    ""EigTuNned"": 2,
    ""uErfhv"": 2,
    ""rldCgd"": 2,
    ""Administr"": 28,
    ""UgWXsqwnb"": 2,
    ""sAydYx"": 2,
    ""bDlMYN"": 2,
    ""Domain"": 36,
    ""Administrator"": 4,
    ""YQGXNThQA"": 2,
    ""hRDPwC"": 2,
    ""YzDgBJ"": 2,
    ""FHCxAlHUP"": 2,
    ""cFvqla"": 2,
    ""RrFIUH"": 2
  },
  ""keyboard"": {
    ""Unknown"": 182
  },
  ""client_build"": {
    ""Unknown"": 182
  },
  ""client_name"": {
    ""Unknown"": 182
  },
  ""ip_type"": {
    ""hosting"": 94,
    ""proxy"": 8,
    ""Unknown"": 80
  }
}"
FSFeNVxc,debugger output from M-x vterm,brickviking,Lisp,Sunday 17th of September 2023 07:15:57 PM CDT,"Debugger entered--Lisp error: (void-function t)
  t(#s(cl--generic :name gui-backend-get-selection :dispatches (((&context eq ... ...) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) ((&context terminal-parameter nil ...) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) ((&context . window-system) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) (1 #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) (0 #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>)))) :method-table (#s(cl--generic-method :specializers (t t ... ... ...) :qualifiers nil :call-con nil :function #f(compiled-function (type data-type) #<bytecode -0x8e728b870d1524>)) #s(cl--generic-method :specializers (t t ...) :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type &optional time-stamp terminal) #<bytecode -0x8a465bc80c3116d>)) #s(cl--generic-method :specializers (t t) :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type) #<bytecode -0x13a3c41c6f572f11>))) :options nil) (((&context terminal-parameter nil 'xterm--get-selection) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) ((&context . window-system) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) (1 #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) (0 #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>)))) (#s(cl--generic-method :specializers (t t (... eql ...) (... eql t) (... eql nil)) :qualifiers nil :call-con nil :function #f(compiled-function (type data-type) #<bytecode -0x8e728b870d1524>)) #s(cl--generic-method :specializers (t t (... eql ...)) :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type &optional time-stamp terminal) #<bytecode -0x8a465bc80c3116d>)) #s(cl--generic-method :specializers (t t) :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type) #<bytecode -0x13a3c41c6f572f11>))))
  cl--generic-make-next-function(#s(cl--generic :name gui-backend-get-selection :dispatches ((... ... ...) (... ... ...) (... ... ...) (1 ...) (0 ...)) :method-table (#s(cl--generic-method :specializers ... :qualifiers nil :call-con nil :function #f(compiled-function (type data-type) #<bytecode -0x8e728b870d1524>)) #s(cl--generic-method :specializers ... :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type &optional time-stamp terminal) #<bytecode -0x8a465bc80c3116d>)) #s(cl--generic-method :specializers ... :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type) #<bytecode -0x13a3c41c6f572f11>))) :options nil) (((&context eq ... ...) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) ((&context terminal-parameter nil ...) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) ((&context . window-system) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) (1 #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) (0 #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>)))) (#s(cl--generic-method :specializers (t t ... ... ...) :qualifiers nil :call-con nil :function #f(compiled-function (type data-type) #<bytecode -0x8e728b870d1524>)) #s(cl--generic-method :specializers (t t ...) :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type &optional time-stamp terminal) #<bytecode -0x8a465bc80c3116d>)) #s(cl--generic-method :specializers (t t) :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type) #<bytecode -0x13a3c41c6f572f11>))))
  cl--generic-make-function(#s(cl--generic :name gui-backend-get-selection :dispatches (((&context eq (terminal-parameter nil 'terminal-initted) 'terminal-init-screen) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) ((&context terminal-parameter nil 'xterm--get-selection) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) ((&context . window-system) #s(cl--generic-generalizer :name cl--generic-eql-generalizer :priority 100 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1e8d3505ab2928fc>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0xc2bce8c284e955a>)) #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) (1 #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>))) (0 #s(cl--generic-generalizer :name cl--generic-t-generalizer :priority 0 :tagcode-function #f(compiled-function (name &rest _) #<bytecode -0x1cba0b13a96764e4>) :specializers-function #f(compiled-function (tag &rest _) #<bytecode -0x2b662d08469105e>)))) :method-table (#s(cl--generic-method :specializers (t t ((&context . window-system) eql 'nil) ((&context terminal-parameter nil 'xterm--get-selection) eql t) ((&context eq (terminal-parameter nil ...) 'terminal-init-screen) eql nil)) :qualifiers nil :call-con nil :function #f(compiled-function (type data-type) #<bytecode -0x8e728b870d1524>)) #s(cl--generic-method :specializers (t t ((&context . window-system) eql 'x)) :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type &optional time-stamp terminal) #<bytecode -0x8a465bc80c3116d>)) #s(cl--generic-method :specializers (t t) :qualifiers nil :call-con nil :function #f(compiled-function (selection-symbol target-type) #<bytecode -0x13a3c41c6f572f11>))) :options nil))
  cl-generic-define-method(gui-backend-get-selection nil (type data-type &context (window-system nil) ((terminal-parameter nil 'xterm--get-selection) (eql t)) ((eq (terminal-parameter nil 'terminal-initted) 'terminal-init-screen) (eql nil))) nil #f(compiled-function (type data-type) #<bytecode -0x8e728b870d1524>))
  byte-code(""\300\301\302\303\302\304%\210\300\305\302\306\302\307%\207"" [cl-generic-define-method gui-backend-get-selection nil (type data-type &context (window-system nil) ((terminal-parameter nil 'xterm--get-selection) (eql t)) ((eq (terminal-parameter nil 'terminal-initted) 'terminal-init-screen) (eql nil))) #f(compiled-function (type data-type) #<bytecode -0x8e728b870d1524>) gui-backend-set-selection (type data &context (window-system nil) ((terminal-parameter nil 'xterm--set-selection) (eql t))) #f(compiled-function (type data) ""Copy DATA to the X selection using the OSC 52 escape sequence.\n\nTYPE specifies which selection to set; it must be either\n`PRIMARY' or `CLIPBOARD'.  DATA must be a string.\n\nThis can be used as a `gui-set-selection' method for\nxterm-compatible terminal emulators.  Then your system clipboard\nwill be updated whenever you copy a region of text in Emacs.\n\nIf the resulting OSC 52 sequence would be longer than\n`xterm-max-cut-length', then the TEXT is not sent to the system\nclipboard.\n\nThis function either sends a raw OSC 52 sequence or wraps the OSC\n52 in a Device Control String sequence.  This way, it will work\non a bare terminal emulators as well as inside the screen\nprogram.  When inside the screen program, this function also\nchops long DCS sequences into multiple smaller ones to avoid\nhitting screen's max DCS length."" #<bytecode -0x197de4b39a776193>)] 6)
  require(term/xterm)
  eval-buffer(#<buffer  *load*> nil ""/home/viking/.emacs.d/elpa/vterm-20230417.424/vter..."" nil t)  ; Reading at buffer position 2060
  load-with-code-conversion(""/home/viking/.emacs.d/elpa/vterm-20230417.424/vter..."" ""/home/viking/.emacs.d/elpa/vterm-20230417.424/vter..."" nil t)
  autoload-do-load((autoload ""vterm"" ""Create an interactive Vterm buffer.\nStart a new Vt..."" t nil) vterm)
  command-execute(vterm record)
  execute-extended-command(nil ""vterm"" ""vterm"")
  funcall-interactively(execute-extended-command nil ""vterm"" ""vterm"")
  call-interactively(execute-extended-command nil nil)
  command-execute(execute-extended-command)
"
FB6su3Hh,Spirally traversing a matrix,jayati,C++,Sunday 17th of September 2023 07:04:21 PM CDT,"//{ Driver Code Starts
#include <bits/stdc++.h> 
using namespace std; 

// } Driver Code Ends
class Solution
{   
    public: 
    //Function to return a list of integers denoting spiral traversal of matrix.
    vector<int> spirallyTraverse(vector<vector<int> > matrix, int r, int c) 
    {
        // code here 
        int total=r*c;
        int top=0;
        int right=c-1;
        int bottom=r-1;
        int left=0;
        int count=0;
        vector<int> a;
        while(count<total)
        {
            int ind=top;
            for(int i=left;count<total && i<=right;i++)
            {
                a.push_back(matrix[top][i]);
                count++;
                
            }
            
            top++;
            for(int i=top;count<total && i<=bottom;i++)
            {
                a.push_back(matrix[i][right]);
                count++;
               
            }
            right--;
            for(int i=right;count<total && i>=left;i--)
            {
                a.push_back(matrix[bottom][i]);
                count++;
            }
            bottom--;
            for(int i=bottom;count<total && i>=top;i--)
            {
                a.push_back(matrix[i][left]);
                count++;
            }
            left++;
            
            
        }
        return a;
    }
};

//{ Driver Code Starts.
int main() {
    int t;
    cin>>t;
    
    while(t--) 
    {
        int r,c;
        cin>>r>>c;
        vector<vector<int> > matrix(r); 

        for(int i=0; i<r; i++)
        {
            matrix[i].assign(c, 0);
            for( int j=0; j<c; j++)
            {
                cin>>matrix[i][j];
            }
        }

        Solution ob;
        vector<int> result = ob.spirallyTraverse(matrix, r, c);
        for (int i = 0; i < result.size(); ++i)
                cout<<result[i]<<"" "";
        cout<<endl;
    }
    return 0;
}
// } Driver Code Ends"
gnpnefzb,fun_input( ) desde cero,uclagyl,Python,Sunday 17th of September 2023 06:35:45 PM CDT,"import sys, os

# ============================================================================================================ #
def fun_SO_es_windows():
    from platform import system
    return system().lower()==""windows""  # Windows / Linux / Darwin

def fun_input(str_mensaje="""", typ_retorno=int, str_aceptar="""", str_omitir="""", int_longitud=0,
              lst_rango=[-9999999,9999999], str_default="""", str_mostrar="""" ):
    """"""fun_input............ Iniciado el 25/09/2020 by UCLA 
    Función fun_input() Captura datos desde el teclado
    Python en español (principiantes)
    Autor: Luis A. Urbalejo

    Parámetros:
    str_mensaje     tipo string, el mensaje a mostrar 
    typ_retorno     El valor a retornar
    str_aceptar     Caracteres que solo aceptará la captura
    str_omitir      Caracteres que omitirá al capturar
    int_longitud    Tamaño límite de la captura
    lst_rango       Una lista de 2 elementos, valor mínimo y máximo
    str_default:    (str)   Valor por defecto a aparecer en la captura
    str_mostrar     (str)   Caracter a mostrar en lugar del presionado
    """"""

    # Para que la función funcione O_o? para windows y linux    
    if fun_SO_es_windows():
        from msvcrt import getch, kbhit, putch
        # import msvcrt  # Para capturar las teclas presionadas
        int_tecla_enter = 13
        int_tecla_retroceso = 8
    else:   # para linux pip install getch
        from getch import getch     # , kbhit pta madre.. no existe kbhit en linux
        int_tecla_enter = 10
        int_tecla_retroceso = 127
        def kbhit():    # Así le vamos a hacer para usar kbhit en linux
            return True
# --------------------------------------------------------------------------------------------------- #
    def fun_teclazo():  # Función que captura una tecla presionada
        bol_espera = True   # bandera activa esperando se pulse una tecla...
        while bol_espera:   # esta bandera se usará después... paciencia
            if kbhit():     # Si se presionó una tecla
                tecla = getch() # Se guarda en variable tecla
                tecla = tecla.decode(""ascii"")  # tecla decodificada
                if ord(tecla) == int_tecla_enter or ord(tecla) == int_tecla_retroceso:
                    return tecla    # retorna enter o retroceso (luego veo flechas )
                elif tecla in str_aceptar or str_aceptar == """":    # es tecla válida?
                    if typ_retorno == int or typ_retorno == float:  # Si debe ser numérica, validamos
                        if tecla in ""+-"" and len(str_capturado) != 0:  continue
                        if tecla == ""."" and str_capturado.count(""."") != 0: continue
                    return tecla    # retornamos la tecla presionada
                else:
                    continue
# --------------------------------------------------------------------------------------------------- #
    def fun_sololetras():
        str_abc = """".join(chr(str_letra) for str_letra in range(65,91)) + "" .""
        str_abc += """".join(chr(str_letra) for str_letra in range(97,123))
        return str_abc
# --------------------------------------------------------------------------------------------------- #
    def fun_solonumeros():
        return ""0123456789.-+""
# --------------------------------------------------------------------------------------------------- #        
    if str_aceptar == str:  str_aceptar = fun_sololetras()
    if str_aceptar == int:  str_aceptar = fun_solonumeros()
    if str_omitir == str:   str_omitir = fun_sololetras()
    if str_omitir == int:   str_omitir = fun_solonumeros()

    if typ_retorno == int or typ_retorno == float:
        if str_aceptar == """":   # Si no se pasa parámetro de caracteres a aceptar
            str_aceptar = fun_solonumeros()   # Solo debe aceptar números
        if 2 < len(lst_rango) > 2:
            input(lst_rango)
            lst_rango = [-9999999,9999999]
    str_capturado = str(str_default)  # Inicializamos lo que se va a capturar
    
    while ""Mientras no se presione enter..."":
        if str_mostrar == """":
            str_captura2 = str_capturado
        else:
            str_captura2 = len(str_capturado) * str_mostrar
        print(""\r"" + (""  "" * len(str_mensaje + str_captura2)), end="""") # Limpia la línea
        print(f""\r{str_mensaje}{str_captura2}"", end="""")    # Imprime mensaje + lo capturado
        # La sgte línea verifica si hay parámetro de longitud y ha llegado al límite
        if int_longitud > 0 and len(str_capturado) == int_longitud: 
            tecla = chr(int_tecla_enter)
        else:
            tecla = fun_teclazo()      # Esperar que se presione una tecla
        if tecla in str_omitir: continue    # Si no es válido el caracter, regresa al inicio del while
        if ord(tecla) == int_tecla_enter:   
            if typ_retorno == int or typ_retorno == float: 
                if str_capturado == """": str_capturado = ""0""  # si nada capturado, ponemos cero
                str_capturado = typ_retorno(float(str_capturado))    # Convertimos entrada en entero o flotante según el caso
                if not (lst_rango[0] <= str_capturado <= lst_rango[1]):
                    str_capturado = str(str_capturado)[:-1]
                    continue
            break   # tecla enter presionada... fin
        if ord(tecla) == int_tecla_retroceso:       # tecla back space presionada
            str_capturado = str_capturado[:-1]  # Borramos el ultimo caracter
        else:    # de lo contrario se agregará la tecla preionada
            str_capturado += tecla
            
    print(f""\r{str_mensaje}{str_captura2}"", end="""")    
    print() # El salto de línea final
    return str_capturado    # Retorna la cadena capturada


str_NIP = fun_input(""NIP: "", typ_retorno=int, int_longitud=4, str_mostrar=""*"" )
print(str_NIP)


sys.exit()
# Pedir 4 calificaciones parciales
# Obtener Promedio General e imprimirlo

flt_promedio = 0
for i in range(4):
    flt_parcial = fun_input(f""Calificación parcial {i + 1} (5-10): "",
                            typ_retorno=float, lst_rango=[5,10], str_default=9 )
    flt_promedio += flt_parcial
flt_promedio /= 4
print(f""Promedio: {flt_promedio}"")
"
Ha4AKdZt,Bugged LaTeX,Laster_Alex,Latex,Sunday 17th of September 2023 06:28:12 PM CDT,\left[\begin{array}{l}\left\{\begin{array}{l}2-3x<0\\ -9{x}^{2}+9x+4\ge 0\end{array}\right.\\ \left\{\begin{array}{l}2-3x\ge 0\\ -9{x}^{2}+9x+4>{\left(2-3x\right)}^{2}\end{array}\right.\end{array}\right.\Rightarrow \left[\begin{array}{l}\left\{\begin{array}{l}\frac{2}{3}<x\\ -9\left(x+\frac{1}{3}\right)\left(x-\frac{1}{4}\right)\ge 0\end{array}\right.\\ \left\{\begin{array}{l}\frac{2}{3}\ge x\\ -9{x}^{2}+9x+4>4-6x+9x^2\end{array}\right.\end{array}\right.\Rightarrow \left[\begin{array}{l}\left\{\begin{array}{l}\frac{2}{3}<x\\ x\in \left[-\frac{1}{3};\frac{4}{3}\right]\end{array}\right.\\ \left\{\begin{array}{l}\frac{2}{3}\ge x\\ 0>18{x}^{2}-21x\end{array}\right.\end{array}\right.\Rightarrow \left[\begin{array}{c}x\in \left(\frac{2}{3};\frac{4}{3}\right]\\ \left\{\begin{array}{l}\frac{2}{3}\ge x\\ x\in \left(0;\frac{7}{6}\right)\end{array}\right.\end{array}\right.
7zPQTdrD,SCTEX,Zgragselus,C++,Sunday 17th of September 2023 05:53:44 PM CDT,"#include ""Main.h""
#include ""SkyeCuillin/ImguiSubsystem.h""
#include ""SkyeCuillin/RenderPassGUI.h""
#include ""Game/Loader/DevIL.h""
#include ""Game/Loader/Sctex.h""
#include ""Graphics/Common/Texture/TextureCompressor.h""
#include ""Core/Math/Numeric/Mat3.h""

class Main : public Engine::System
{
private:
	SkyeCuillin::ImguiSubsystem* mImgui;
	SkyeCuillin::RenderPassGUI* mTexturesPass;

	Engine::Log* mLog;
	Engine::Window* mWindow;
	Engine::Constants* mOptions;
	Engine::D3DRenderer* mRenderer;
	Engine::D3DSwapChain* mSwapChain;

	Engine::Texture* mUncompressed;
	Engine::Texture* mCompressed;

	float mUncompressedMiplevel = 0.0f;
	float mNumUncompressedMiplevels = 1.0f;
	float mCompressedMiplevel = 0.0f;
	float mNumCompressedMiplevels = 1.0f;
	float mCurrentMiplevel = 0.0f;

	Engine::mat3 mTransform;

private:
	Engine::LoaderDevIL::Image* mImage = nullptr;

	size_t* mCompressedWidth;
	size_t* mCompressedHeight;
	size_t mCompressedLevels;
	unsigned char** mCompressedData;
	Engine::Graphics::Format mCompressedFormat;

	void LoadTexture(const std::string& filename)
	{
		if (filename.find("".sctex"") != std::string::npos)
		{
			Engine::LoaderSctex* loader = new Engine::LoaderSctex(mLog);

			if (mCompressed != nullptr)
			{
				delete mCompressed;
			}
			mCompressed = loader->Load(filename, mRenderer, ""Compressed"");

			if (mImage != nullptr)
			{
				delete mImage;
				mImage = nullptr;
			}

			// Now, load the same image - but only into helper data, these must be de-compressed 
			// and setup as original image (and therefore also uncompressed image.
			Engine::LoaderSctex::HelperImageData* imageData = loader->Load(filename);

			mImage = new Engine::LoaderDevIL::Image();
			mImage->mUseAlphaMipmap = true;
			mImage->mChannels = 4;
			mImage->mBpp = 4;
			mImage->mWidth = imageData->mImageRecord[0].mWidth;
			mImage->mHeight = imageData->mImageRecord[0].mHeight;
			mImage->mData = new unsigned char[imageData->mImageRecord[0].mWidth * imageData->mImageRecord[0].mHeight * 4];
			mImage->mMipLevels = imageData->mHeader.mNumImages;
			mImage->mMipmaps = new unsigned char*[mImage->mMipLevels];
			mImage->mMipmaps[0] = mImage->mData;

			Engine::TextureCompressor::Decompress(imageData->mImageRecord[0].mWidth, imageData->mImageRecord[0].mHeight, mImage->mData, imageData->mImageData[0].mData, (Engine::TextureCompressor::Format)imageData->mHeader.mFormat);
			
			for (size_t i = 1; i < mImage->mMipLevels; i++)
			{
				mImage->mMipmaps[i] = new unsigned char[imageData->mImageRecord[i].mWidth * imageData->mImageRecord[i].mHeight * 4];
				Engine::TextureCompressor::Decompress(imageData->mImageRecord[i].mWidth, imageData->mImageRecord[i].mHeight, mImage->mMipmaps[i], imageData->mImageData[i].mData, (Engine::TextureCompressor::Format)imageData->mHeader.mFormat);
			}

			// Check for BC5 format - those hold normal map. Add blue channel.
			if ((Engine::TextureCompressor::Format)imageData->mHeader.mFormat == Engine::TextureCompressor::Format::BC5)
			{
				for (size_t i = 0; i < mImage->mMipLevels; i++)
				{
					unsigned char* ptr = mImage->mMipmaps[i];

					for (size_t j = 0; j < imageData->mImageRecord[i].mWidth * imageData->mImageRecord[i].mHeight; j++)
					{
						float x = (float)ptr[0] / 255.0f * 2.0f - 1.0f;
						float y = (float)ptr[1] / 255.0f * 2.0f - 1.0f;
						float z = 1.0f - x * x - y * y;
						if (z < 0.0f)
						{
							z = 0.0f;
						}
						else
						{
							z = sqrtf(z);
						}

						ptr[0] = (unsigned char)((x * 0.5f + 0.5f) * 255.0f);
						ptr[1] = (unsigned char)((y * 0.5f + 0.5f) * 255.0f);
						ptr[2] = (unsigned char)((z * 0.5f + 0.5f) * 255.0f);
						ptr[3] = 255;

						ptr += 4;
					}
				}
			}

			if (mImage != nullptr)
			{
				mNumUncompressedMiplevels = (float)mImage->mMipLevels;

				if (mUncompressed != nullptr)
				{
					delete mUncompressed;
				}
				mUncompressed = new Engine::Texture(""Uncompressed"");
				mUncompressed->InitMipmaps(mRenderer, mImage->mWidth, mImage->mHeight, 1, mImage->mMipLevels, Engine::Graphics::RGBA8, (const void**)mImage->mMipmaps);
				mUncompressed->SetName(""Uncompressed"");
			}

			delete imageData;

			delete loader;
		}
		else
		{
			Engine::LoaderDevIL* loader = new Engine::LoaderDevIL(mLog);

			if (mImage != nullptr)
			{
				delete mImage;
				mImage = nullptr;
			}

			mImage = loader->Load(filename, true, true);
			if (mImage != nullptr)
			{
				loader->GenerateMipmaps(mImage);

				mNumUncompressedMiplevels = (float)mImage->mMipLevels;

				if (mUncompressed != nullptr)
				{
					delete mUncompressed;
				}
				mUncompressed = new Engine::Texture(""Uncompressed"");
				mUncompressed->InitMipmaps(mRenderer, mImage->mWidth, mImage->mHeight, 1, mImage->mMipLevels, mImage->mBpp <= 4 ? Engine::Graphics::RGBA8 : Engine::Graphics::RGBA32F, (const void**)mImage->mMipmaps);
				mUncompressed->SetName(""Uncompressed"");

				delete mCompressed;
				mCompressed = nullptr;
			}

			delete loader;
		}
	}

	void CompressTexture(Engine::TextureCompressor::Format format, bool dithering, bool generateMipmaps, bool alphaMipmap, bool normalMipmap, float exposure)
	{
		if (mImage != nullptr)
		{
			switch (format)
			{
			case Engine::TextureCompressor::Format::BC1:
				mCompressedFormat = Engine::Graphics::BC1;
				break;

			case Engine::TextureCompressor::Format::BC2:
				mCompressedFormat = Engine::Graphics::BC2;
				break;

			case Engine::TextureCompressor::Format::BC3:
				mCompressedFormat = Engine::Graphics::BC3;
				break;

			case Engine::TextureCompressor::Format::BC4:
				mCompressedFormat = Engine::Graphics::BC4;
				break;

			case Engine::TextureCompressor::Format::BC5:
				mCompressedFormat = Engine::Graphics::BC5;
				break;

			case Engine::TextureCompressor::Format::BC6H:
				mCompressedFormat = Engine::Graphics::BC6H;
				break;
			}

			Engine::LoaderDevIL* loader = new Engine::LoaderDevIL(mLog);
			mImage->mUseAlphaMipmap = alphaMipmap;
			if (normalMipmap)
			{
				loader->GenerateMipmapsNormal(mImage);
			}
			else
			{
				loader->GenerateMipmaps(mImage);
			}

			if (mUncompressed != nullptr)
			{
				delete mUncompressed;
			}
			mUncompressed = new Engine::Texture(""Uncompressed"");
			mUncompressed->InitMipmaps(mRenderer, mImage->mWidth, mImage->mHeight, 1, mImage->mMipLevels, mImage->mBpp <= 4 ? Engine::Graphics::RGBA8 : Engine::Graphics::RGBA32F, (const void**)mImage->mMipmaps);
			mUncompressed->SetName(""Uncompressed"");

			delete loader;

			if (mCompressed != nullptr)
			{
				delete mCompressed;
			}
			mCompressed = new Engine::Texture(""Compressed"");

			if (mCompressedData)
			{
				for (int i = 0; i < mCompressedLevels; i++)
				{
					delete mCompressedData[i];
				}

				delete[] mCompressedData;
			}

			if (mCompressedWidth)
			{
				delete[] mCompressedWidth;
			}

			if (mCompressedHeight)
			{
				delete[] mCompressedHeight;
			}

			if (generateMipmaps)
			{
				size_t width = mImage->mWidth;
				size_t height = mImage->mHeight;
				mCompressedLevels = 1;

				while (width > 4 && height > 4)
				{
					width /= 2;
					height /= 2;

					if ((width % 4 == 0) && (height % 4 == 0))
					{
						mCompressedLevels++;
					}
					else
					{
						break;
					}
				}

				mCompressedWidth = new size_t[mCompressedLevels];
				mCompressedHeight = new size_t[mCompressedLevels];

				width = mImage->mWidth;
				height = mImage->mHeight;

				mCompressedData = new unsigned char*[mCompressedLevels];
				for (int i = 0; i < mCompressedLevels; i++)
				{
					mCompressedWidth[i] = width;
					mCompressedHeight[i] = height;

					mCompressedData[i] = new unsigned char[mCompressedWidth[i] * mCompressedHeight[i] * Engine::Graphics::GetFormatSize(mCompressedFormat) / (Engine::Graphics::GetBlockSize(mCompressedFormat) * Engine::Graphics::GetBlockSize(mCompressedFormat))];

					Engine::TextureCompressor::Compress(mCompressedWidth[i], mCompressedHeight[i], mCompressedData[i], mImage->mMipmaps[i], format, 4, true, dithering, mImage->mBpp == 16 ? true : false, exposure);

					width /= 2;
					height /= 2;
				}

				mNumCompressedMiplevels = (float)mCompressedLevels;

				mCompressed->InitMipmaps(mRenderer, mCompressedWidth[0], mCompressedHeight[0], 1, mCompressedLevels, mCompressedFormat, (const void**)mCompressedData);
			}
			else
			{
				mCompressedLevels = 1;
				mCompressedWidth = new size_t[mCompressedLevels];
				mCompressedHeight = new size_t[mCompressedLevels];
				mCompressedWidth[0] = mImage->mWidth;
				mCompressedHeight[0] = mImage->mHeight;

				mCompressedData = new unsigned char*[mCompressedLevels];

				mCompressedData[0] = new unsigned char[mCompressedWidth[0] * mCompressedHeight[0] * Engine::Graphics::GetFormatSize(mCompressedFormat) / (Engine::Graphics::GetBlockSize(mCompressedFormat) * Engine::Graphics::GetBlockSize(mCompressedFormat))];

				Engine::TextureCompressor::Compress(mCompressedWidth[0], mCompressedHeight[0], mCompressedData[0], mImage->mData, format, 4, true, dithering, mImage->mBpp == 16 ? true : false, exposure);

				mNumCompressedMiplevels = 1.0f;

				mCompressed->Init(mRenderer, mCompressedWidth[0], mCompressedHeight[0], 1, mCompressedFormat, (const void*)mCompressedData[0]);
			}

			mCompressed->SetName(""Compressed"");
		}
	}

public:
	/// <summary>
	/// Headless compression of input image into output image based on input parameters
	/// 
	/// <para>Format types:</para>
	/// <para>0 - BC1</para>
	/// <para>1 - BC2</para>
	/// <para>2 - BC3</para>
	/// <para>3 - BC4</para>
	/// <para>4 - BC5</para>
	/// </summary>
	/// <param name=""log"">Log to write errors/info into</param>
	/// <param name=""input"">Input image filename</param>
	/// <param name=""output"">Output image filename</param>
	/// <param name=""format"">Format type</param>
	/// <param name=""dithering"">Use dithering?</param>
	/// <param name=""generateMipmaps"">Generate mipmaps?</param>
	/// <param name=""alphaMipmap"">Use alpha conservation when generating mipmaps?</param>
	/// <param name=""normalMipmap"">Generate normal-map mipmaps (renormalize each level)?</param>
	/// <param name=""exposure"">Exposure value to pre-multiply original image with</param>
	static void CompressHeadless(Engine::Log* log, const std::string& input, const std::string& output, int format, bool dithering, bool generateMipmaps, bool alphaMipmap, bool normalMipmap, float exposure)
	{
		Engine::LoaderDevIL* loader = new Engine::LoaderDevIL(log);

		Engine::LoaderDevIL::Image* image = loader->Load(input, true, true);
		if (image != nullptr)
		{

			Engine::TextureCompressor::Format compressFormat = (Engine::TextureCompressor::Format)format;

			Engine::Graphics::Format compressedFormat;
			switch (compressFormat)
			{
			case Engine::TextureCompressor::Format::BC1:
				compressedFormat = Engine::Graphics::BC1;
				break;

			case Engine::TextureCompressor::Format::BC2:
				compressedFormat = Engine::Graphics::BC2;
				break;

			case Engine::TextureCompressor::Format::BC3:
				compressedFormat = Engine::Graphics::BC3;
				break;

			case Engine::TextureCompressor::Format::BC4:
				compressedFormat = Engine::Graphics::BC4;
				break;

			case Engine::TextureCompressor::Format::BC5:
				compressedFormat = Engine::Graphics::BC5;
				break;

			case Engine::TextureCompressor::Format::BC6H:
				compressedFormat = Engine::Graphics::BC6H;
				break;
			}

			image->mUseAlphaMipmap = alphaMipmap;
			if (normalMipmap)
			{
				loader->GenerateMipmapsNormal(image);
			}
			else
			{
				loader->GenerateMipmaps(image);
			}

			size_t compressedLevels = 0;
			size_t* compressedWidth = nullptr;
			size_t* compressedHeight = nullptr;
			unsigned char** compressedData = nullptr;

			if (generateMipmaps)
			{
				size_t width = image->mWidth;
				size_t height = image->mHeight;
				compressedLevels = 1;

				while (width > 4 && height > 4)
				{
					width /= 2;
					height /= 2;

					if ((width % 4 == 0) && (height % 4 == 0))
					{
						compressedLevels++;
					}
					else
					{
						break;
					}
				}

				compressedWidth = new size_t[compressedLevels];
				compressedHeight = new size_t[compressedLevels];

				width = image->mWidth;
				height = image->mHeight;

				compressedData = new unsigned char* [compressedLevels];
				for (int i = 0; i < compressedLevels; i++)
				{
					compressedWidth[i] = width;
					compressedHeight[i] = height;

					compressedData[i] = new unsigned char[compressedWidth[i] * compressedHeight[i] * Engine::Graphics::GetFormatSize(compressedFormat) / (Engine::Graphics::GetBlockSize(compressedFormat) * Engine::Graphics::GetBlockSize(compressedFormat))];

					Engine::TextureCompressor::Compress(compressedWidth[i], compressedHeight[i], compressedData[i], image->mMipmaps[i], compressFormat, 4, true, dithering, image->mBpp == 16 ? true : false, exposure);

					width /= 2;
					height /= 2;
				}
			}
			else
			{
				compressedLevels = 1;
				compressedWidth = new size_t[compressedLevels];
				compressedHeight = new size_t[compressedLevels];
				compressedWidth[0] = image->mWidth;
				compressedHeight[0] = image->mHeight;

				compressedData = new unsigned char* [compressedLevels];

				compressedData[0] = new unsigned char[compressedWidth[0] * compressedHeight[0] * Engine::Graphics::GetFormatSize(compressedFormat) / (Engine::Graphics::GetBlockSize(compressedFormat) * Engine::Graphics::GetBlockSize(compressedFormat))];

				Engine::TextureCompressor::Compress(compressedWidth[0], compressedHeight[0],compressedData[0], image->mData, compressFormat, 4, true, dithering, image->mBpp == 16 ? true : false, exposure);
			}

			// Save the image
			Engine::LoaderSctex* sctexLoader = new Engine::LoaderSctex(log);

			std::vector<Engine::LoaderSctex::Image> data;

			for (size_t i = 0; i < compressedLevels; i++)
			{
				Engine::LoaderSctex::Image image;
				image.mWidth = compressedWidth[i];
				image.mHeight = compressedHeight[i];
				image.mData = compressedData[i];

				data.push_back(image);
			}

			sctexLoader->Save(output, compressedFormat, data);

			delete sctexLoader;

			for (size_t i = 0; i < compressedLevels; i++)
			{
				delete[] compressedData[i];
			}

			delete compressedWidth;
			delete compressedHeight;
			delete compressedData;

			delete image;
		}

		delete loader;
	}

	Main(Engine::Log* log, Engine::Constants* options) : Engine::System(""Main"")
	{
		EnableUpdater();

		mLog = log;
		mOptions = options;

		mWindow = new Engine::Window(log, options);
		mWindow->Create();

		mRenderer = new Engine::D3DRenderer(mWindow, log, options);
		mSwapChain = new Engine::D3DSwapChain(mRenderer, mWindow, log, options);

		static Engine::EventChannel chan;
		chan.Add<Engine::Keyboard::KeyPressed>(*this);
		chan.Add<Engine::Keyboard::KeyReleased>(*this);
		chan.Add<Engine::Keyboard::KeyChar>(*this);
		chan.Add<Engine::Mouse::MouseMove>(*this);
		chan.Add<Engine::Mouse::ButtonPressed>(*this);
		chan.Add<Engine::Mouse::ButtonReleased>(*this);
		chan.Add<Engine::Mouse::MouseWheel>(*this);
		chan.Add<Engine::Window::Resize>(*this);
	}

	virtual ~Main()
	{
		for (int i = 0; i < mCompressedLevels; i++)
		{
			delete mCompressedData[i];
		}
		delete[] mCompressedData;

		delete[] mCompressedWidth;
		delete[] mCompressedHeight;

		delete mImage;
		delete mCompressed;
		delete mUncompressed;

		delete mSwapChain;
		delete mRenderer;
		delete mWindow;
	}

	virtual bool Init()
	{
		int w;
		int h;
		this->mWindow->GetSize(&w, &h);

		mTexturesPass = new SkyeCuillin::RenderPassGUI(mRenderer, w, h);

		mImgui = new SkyeCuillin::ImguiSubsystem(mRenderer, w, h);
		ImGui::GetStyle().WindowBorderSize = 0;

		LoadTexture(""../Data/Shared/Test.png"");
		CompressTexture(Engine::TextureCompressor::Format::BC1, true, true, false, false, 1.0f);

		return true;
	}

	virtual void Shutdown()
	{
		mRenderer->Flush();

		delete mImgui;

		delete mTexturesPass;

		mWindow->Destroy();
	}

	virtual void Update()
	{
		static bool compressionShow = false;


		int w;
		int h;
		mWindow->GetSize(&w, &h);

		mWindow->Process();

		Engine::GraphicsContext* context = mRenderer->GetGraphicsContext();

		context->Begin();
		context->SetDescriptorHeap(Engine::DescriptorHeap::CBV_SRV_UAV, mRenderer->Heap());
		context->TransitionResource(mSwapChain->GetBackBuffer(), D3D12_RESOURCE_STATE_RENDER_TARGET, true);
		context->SetRenderTargets(mSwapChain->GetBackBuffer(), mSwapChain->GetDepthBuffer());
		context->SetViewport(0.0f, 0.0f, (float)w, (float)h);
		context->SetScissorRect(0.0f, 0.0f, (float)w, (float)h);
		context->ClearColor(mSwapChain->GetBackBuffer(), 0.0f, 0.0f, 0.0f, 1.0f);
		context->ClearDepth(mSwapChain->GetDepthBuffer(), 1.0f, 0);

		static bool alphaMask = false;
		static float exposure = 1.0f;
		static int mode = 0;

		Engine::float3 mUV[2] = {
			mTransform * Engine::float3(-1.0f, -1.0f, 1.0f),
			mTransform * Engine::float3(1.0f, 1.0f, 1.0f)
		};

		mTexturesPass->Clear();
		if (mUncompressed != nullptr)
		{
			mUncompressedMiplevel = mCurrentMiplevel;
			if (mCurrentMiplevel >= mNumUncompressedMiplevels)
			{
				mUncompressedMiplevel = mNumUncompressedMiplevels - 1.0f;
			}
			mTexturesPass->AddSprite(Engine::float2(0.0f, 0.0f), 
				Engine::float2(0.5f, 1.0f), 
				Engine::float2(mUV[0].x, mUV[0].y) * 0.5f + 0.5f, 
				Engine::float2(mUV[1].x, mUV[1].y) * 0.5f + 0.5f,
				Engine::float4(exposure, exposure, exposure, 1.0f), 
				mUncompressed, 
				mUncompressedMiplevel, 
				alphaMask ? mode + 5 : mode);
		}
		if (mCompressed != nullptr)
		{
			mCompressedMiplevel = mCurrentMiplevel;
			if (mCurrentMiplevel >= mNumCompressedMiplevels)
			{
				mCompressedMiplevel = mNumCompressedMiplevels - 1.0f;
			}
			mTexturesPass->AddSprite(Engine::float2(0.5f, 0.0f), 
				Engine::float2(0.5f, 1.0f), 
				Engine::float2(mUV[0].x, mUV[0].y) * 0.5f + 0.5f, 
				Engine::float2(mUV[1].x, mUV[1].y) * 0.5f + 0.5f, 
				Engine::float4(exposure, exposure, exposure, 1.0f), 
				mCompressed, 
				mCompressedMiplevel, 
				alphaMask ? mode + 5 : mode);
		}

		mTexturesPass->Render(mRenderer->Heap(), context);

		bool loadTexture = false;
		std::string textureFilename;

		mImgui->Update(context);
		mImgui->NewFrame();
		ImGui::SetNextWindowSize(ImVec2((float)w, 20.0f), ImGuiCond_Always);
		ImGui::SetNextWindowPos(ImVec2(0.0f, 0.0f));
		ImGui::PushStyleVar(ImGuiStyleVar_WindowRounding, 0.0f);
		if (ImGui::Begin(""Menu"", nullptr, ImGuiWindowFlags_NoTitleBar | ImGuiWindowFlags_NoResize | ImGuiWindowFlags_NoMove | ImGuiWindowFlags_NoScrollbar | ImGuiWindowFlags_NoCollapse | ImGuiWindowFlags_MenuBar))
		{
			if (ImGui::BeginMenuBar())
			{
				if (ImGui::BeginMenu(""File""))
				{
					if (ImGui::MenuItem(""Open"", ""CTRL+O"", nullptr))
					{
						std::string filename;
						bool open = Engine::FileDialog::Show(mLog, ""Open Image"", ""Image Files\0*.jpg;*.jpeg;*.png;*.bmp;*.tga;*.dds;*.tif;*.gif;*.sctex\0All Files\0*.*\0"", Engine::FileDialog::Type::OPEN_FILE_DIALOG, filename);
						if (open)
						{
							textureFilename = filename;
							loadTexture = true;

							// Reset miplevel, view and exposure when loading a new image
							mCurrentMiplevel = 0.0f;
							mTransform = Engine::mat3();
							exposure = 1.0f;
						}
					}

					if (ImGui::MenuItem(""Save"", ""CTRL+S"", nullptr))
					{
						std::string filename;
						bool save = Engine::FileDialog::Show(mLog, ""Save Compressed Image"", ""Skye Cuillin Texture\0*.sctex\0All Files\0*.*\0"", Engine::FileDialog::Type::SAVE_FILE_DIALOG, filename);
						if (save)
						{
							Engine::LoaderSctex* sctexLoader = new Engine::LoaderSctex(mLog);

							std::vector<Engine::LoaderSctex::Image> data;

							for (size_t i = 0; i < mCompressedLevels; i++)
							{
								Engine::LoaderSctex::Image image;
								image.mWidth = mCompressedWidth[i];
								image.mHeight = mCompressedHeight[i];
								image.mData = mCompressedData[i];

								data.push_back(image);
							}

							sctexLoader->Save(filename, mCompressedFormat, data);

							delete sctexLoader;
						}
					}

					if (ImGui::MenuItem(""Exit""))
					{
						static Engine::EventChannel chan;
						chan.Broadcast(Engine::Scheduler::StopEvent());
					}

					ImGui::EndMenu();
				}

				if (ImGui::BeginMenu(""Edit""))
				{
					if (ImGui::MenuItem(""Compress""))
					{
						compressionShow = true;
					}

					ImGui::EndMenu();
				}

				if (ImGui::BeginMenu(""View""))
				{
					if (ImGui::MenuItem(""Mip Level Up""))
					{
						mCurrentMiplevel = mCurrentMiplevel - 1.0f;
						if (mCurrentMiplevel < 0.0f)
						{
							mCurrentMiplevel = 0.0f;
						}
					}

					if (ImGui::MenuItem(""Mip Level Down""))
					{
						mCurrentMiplevel = mCurrentMiplevel + 1.0f;
						float maxLevel = Engine::Math::Max(mNumCompressedMiplevels, mNumUncompressedMiplevels);
						if (mCurrentMiplevel >= maxLevel)
						{
							mCurrentMiplevel = maxLevel - 1.0f;
						}
					}

					if (ImGui::MenuItem(""Reset View""))
					{
						mTransform = Engine::mat3();
					}

					if (ImGui::MenuItem(""Reset Exposure""))
					{
						exposure = 1.0f;
					}

					ImGui::EndMenu();
				}

				ImGui::RadioButton(""C"", &mode, 0);
				ImGui::RadioButton(""R"", &mode, 1);
				ImGui::RadioButton(""G"", &mode, 2);
				ImGui::RadioButton(""B"", &mode, 3);
				ImGui::RadioButton(""A"", &mode, 4);

				ImGui::Checkbox(""Alpha Mask"", &alphaMask);

				ImGui::SliderFloat(""Exposure"", &exposure, 0.0f, 10.0f);

				ImGui::EndMenuBar();
			}
		}
		ImGui::End();
		ImGui::PopStyleVar();

		if (compressionShow)
		{
			if (ImGui::Begin(""Compress"", nullptr, ImGuiWindowFlags_NoCollapse))
			{
				const char* compression[] = { ""BC1"", ""BC2"", ""BC3"", ""BC4"", ""BC5"", ""BC6H""};
				static int compressionSelected = 0;
				ImGui::Combo(""Compression Type"", &compressionSelected, compression, IM_ARRAYSIZE(compression));

				static bool dithering = false;
				ImGui::Checkbox(""Use Dithering"", &dithering);

				static bool generateMipmaps = false;
				ImGui::Checkbox(""Generate Mipmaps"", &generateMipmaps);

				static bool alphaMipmaps = false;
				ImGui::Checkbox(""Alpha Mipmaps"", &alphaMipmaps);

				static bool normalMipmaps = false;
				ImGui::Checkbox(""Normal Mipmaps"", &normalMipmaps);

				if (ImGui::Button(""Compress""))
				{
					CompressTexture((Engine::TextureCompressor::Format)compressionSelected, dithering, generateMipmaps, alphaMipmaps, normalMipmaps, exposure);
					compressionShow = false;
				}
				ImGui::SameLine();
				if (ImGui::Button(""Cancel""))
				{
					compressionShow = false;
				}
			}
			ImGui::End();
		}

		ImGui::SetNextWindowSize(ImVec2((float)w, 24.0f), ImGuiCond_Always);
		ImGui::SetNextWindowPos(ImVec2(0.0f, (float)h - 24.0f));
		ImGui::PushStyleVar(ImGuiStyleVar_WindowRounding, 0.0f);
		if (ImGui::Begin(""StatusBar"", nullptr, ImGuiWindowFlags_NoTitleBar | ImGuiWindowFlags_NoResize | ImGuiWindowFlags_NoMove | ImGuiWindowFlags_NoScrollbar | ImGuiWindowFlags_NoCollapse))
		{
			ImGui::Text(""Mip Level %2f    Position (%4f, %4f)"", mCurrentMiplevel, (mUV[0].x + mUV[1].x) * 0.5f, (mUV[1].y + mUV[1].y) * 0.5f);
		}
		ImGui::End();
		ImGui::PopStyleVar();

		mImgui->Render();

		context->TransitionResource(mSwapChain->GetBackBuffer(), D3D12_RESOURCE_STATE_PRESENT, true);
		uint64_t fence = context->Finish();

		mSwapChain->SwapBuffers();

		if (loadTexture)
		{
			LoadTexture(textureFilename);
		}
	}

	void Handle(const Engine::Keyboard::KeyChar& kc)
	{
		ImGuiIO& io = ImGui::GetIO();

		if (kc.mKey < 256)
		{
			io.AddInputCharacter((ImWchar)kc.mKey);
		}
	}

	void Handle(const Engine::Keyboard::KeyPressed& kp)
	{
		ImGuiIO& io = ImGui::GetIO();
		io.KeysDown[kp.mKey] = 1;

		Engine::Input* input = (Engine::Input*)Engine::Core::Instance()->Get(""Input"");
		/*if (input->GetKeyboard()->GetKeyState(Engine::Keyboard::KEY_CONTROL_L))
		{
			io.AddInputCharacter((ImWchar)kp.mKey);
		}*/

		switch (kp.mKey)
		{
		case Engine::Keyboard::KEY_CONTROL_L:
			io.KeyCtrl = true;
			break;

		case Engine::Keyboard::KEY_ALT_L:
			io.KeyAlt = true;
			break;

		case Engine::Keyboard::KEY_SHIFT_L:
			io.KeyShift = true;
			break;
		}

		switch (kp.mKey)
		{
		case Engine::Keyboard::KEY_PAGE_UP:
			mCurrentMiplevel = mCurrentMiplevel - 1.0f;
			if (mCurrentMiplevel < 0.0f)
			{
				mCurrentMiplevel = 0.0f;
			}
			break;

		case Engine::Keyboard::KEY_PAGE_DOWN:
			mCurrentMiplevel = mCurrentMiplevel + 1.0f;
			float maxLevel = Engine::Math::Max(mNumCompressedMiplevels, mNumUncompressedMiplevels);
			if (mCurrentMiplevel >= maxLevel)
			{
				mCurrentMiplevel = maxLevel - 1.0f;
			}
			break;
		}
	}

	void Handle(const Engine::Keyboard::KeyReleased& kp)
	{
		ImGuiIO& io = ImGui::GetIO();
		io.KeysDown[kp.mKey] = 0;

		switch (kp.mKey)
		{
		case Engine::Keyboard::KEY_CONTROL_L:
			io.KeyCtrl = false;
			break;

		case Engine::Keyboard::KEY_ALT_L:
			io.KeyAlt = false;
			break;

		case Engine::Keyboard::KEY_SHIFT_L:
			io.KeyShift = false;
			break;
		}
	}

	bool mMousing = false;
	
	float mPrevMouse[2];

	void Handle(const Engine::Mouse::MouseMove& m)
	{
		ImGuiIO& io = ImGui::GetIO();
		io.MousePos.x = (float)m.mX;
		io.MousePos.y = (float)m.mY;

		// Check whether we're moving with mouse and whether mouse isn't over ImGUI panels/windows - if both apply, update viewport transform
		if (mMousing && !io.WantCaptureMouse)
		{
			float mDeltaMouse[2];
			mDeltaMouse[0] = mPrevMouse[0] - (float)m.mX;
			mDeltaMouse[1] = mPrevMouse[1] - (float)m.mY;

			int w = 0;
			int h = 0;
			mWindow->GetSize(&w, &h);

			Engine::float3 transform = Engine::float3(mDeltaMouse[0] * 1.0f / (float)w, mDeltaMouse[1] * 1.0f / (float)h, 1.0f);

			mTransform = mTransform * Engine::mat3(transform);
		}

		mPrevMouse[0] = (float)m.mX;
		mPrevMouse[1] = (float)m.mY;
	}

	void Handle(const Engine::Mouse::MouseWheel& m)
	{
		ImGuiIO& io = ImGui::GetIO();
		io.MouseWheel = (float)m.mDelta / 120.0f;

		// Check whether mouse isn't over ImGUI panels/windows - if it isn't, zoom in/out viewport
		if (!io.WantCaptureMouse)
		{
			if (m.mDelta < 0)
			{
				mTransform = mTransform * Engine::mat3(1.1f, 0.0f, 0.0f, 0.0f, 1.1f, 0.0f, 0.0f, 0.0f, 1.0f);
			}
			else if (m.mDelta > 0)
			{
				mTransform = mTransform * Engine::mat3(0.9f, 0.0f, 0.0f, 0.0f, 0.9f, 0.0f, 0.0f, 0.0f, 1.0f);
			}
		}
	}

	void Handle(const Engine::Mouse::ButtonPressed& bp)
	{
		ImGuiIO& io = ImGui::GetIO();
		io.MouseDown[bp.mButton] = true;

		if (bp.mButton == 0)
		{
			mMousing = true;
		}
	}

	void Handle(const Engine::Mouse::ButtonReleased& br)
	{
		ImGuiIO& io = ImGui::GetIO();
		io.MouseDown[br.mButton] = false;

		if (br.mButton == 0)
		{
			mMousing = false;
		}
	}

	void Handle(const Engine::Window::Resize& r)
	{
		mSwapChain->Resize(r.mWidth, r.mHeight);
		mImgui->Resize(r.mWidth, r.mHeight);
		mTexturesPass->Resize(r.mWidth, r.mHeight);
	}
};

int main(int argc, char** argv)
{
	Engine::Log* log = new Engine::Log();
	log->AddOutput(new std::ofstream(""Output.log""), Engine::Log::LOG_DEFAULT);

	if (argc > 1)
	{
		int inputIndex = -1;
		std::string input;
		int outputIndex = -1;
		std::string output;
		int formatIndex = -1;
		int format = 0;
		bool dithering = false;
		bool mipmaps = false;
		bool alphaMipmaps = false;
		bool normalMipmaps = false;
		bool useExposure = false;
		int exposureIndex = -1;
		float exposure = 1.0f;

		for (int i = 0; i < argc; i++)
		{
			std::string arg = std::string(argv[i]);

			if ((arg == ""--input"" || arg == ""-i"") && argc >(i + 1) && inputIndex == -1)
			{
				inputIndex = i + 1;
			}
			else if ((arg == ""--output"" || arg == ""-o"") && argc > (i + 1) && outputIndex == -1)
			{
				outputIndex = i + 1;
			}
			else if ((arg == ""--format"" || arg == ""-f"") && argc > (i + 1) && formatIndex == -1)
			{
				formatIndex = i + 1;
			}
			else if (arg == ""--dithering"" || arg == ""-d"")
			{
				dithering = true;
			}
			else if (arg == ""--mipmaps"" || arg == ""-m"")
			{
				mipmaps = true;
			}
			else if (arg == ""--alpha"" || arg == ""-a"")
			{
				alphaMipmaps = true;
			}
			else if (arg == ""--normals"" || arg == ""-n"")
			{
				normalMipmaps = true;
			}
			else if ((arg == ""--exposure"" || arg == ""-e"") && argc > (i + 1) && exposureIndex == -1)
			{
				useExposure = true;
				exposureIndex = i + 1;
			}
		}

		input = argv[inputIndex];
		if (input[0] == '\""')
		{
			input = input.substr(1, input.length() - 2);
		}

		output = argv[outputIndex];
		if (output[0] == '\""')
		{
			output = output.substr(1, output.length() - 2);
		}

		format = std::atoi(argv[formatIndex]);

		if (exposureIndex > -1)
		{
			exposure = std::atof(argv[exposureIndex]);
		}

		if (inputIndex == -1 || outputIndex == -1 || formatIndex == -1 || input.length() == 0 || output.length() == 0 || format < 0 || format > 4)
		{
			std::cout << ""Error: Invalid arguments, required arguments are:"" << std::endl << std::endl;
			std::cout << ""--input, -i"" << std::endl;
			std::cout << ""\tPath to input image file (*.*)"" << std::endl;
			std::cout << ""--output, -o"" << std::endl;
			std::cout << ""\tPath to output image file (*.sctex)"" << std::endl;
			std::cout << ""--format, -f"" << std::endl;
			std::cout << ""\tFormat to use for compression (0 - BC1, 1 - BC2, 2 - BC3, 3 - BC4, 4 - BC5)"" << std::endl;
			std::cout << ""--dithering, -d"" << std::endl;
			std::cout << ""\tUse dithering to improve"" << std::endl;
			std::cout << ""--mipmaps, -m"" << std::endl;
			std::cout << ""\tPath to input image file"" << std::endl;
			std::cout << ""--alpha, -a"" << std::endl;
			std::cout << ""\tPath to input image file"" << std::endl;
			std::cout << ""--normals, -n"" << std::endl;
			std::cout << ""\tPath to input image file"" << std::endl;
			std::cout << ""--exposure, -e"" << std::endl;
			std::cout << ""\tExposure value - decimal number, default is 1.0"" << std::endl;
		}
		else
		{
			Main::CompressHeadless(log, input, output, format, dithering, mipmaps, alphaMipmaps, normalMipmaps, exposure);
		}
	}
	else
	{
		Engine::Constants* options = new Engine::Constants(log, ""../Data/Config/ConfigTexture.conf"");

		Engine::Input* input = new Engine::Input();

		Main* m = new Main(log, options);

		Engine::Core::Instance()->Add(input);
		Engine::Core::Instance()->Add(m);
		Engine::Core::Instance()->SetLog(log);
		Engine::Core::Instance()->SetOptions(options);

		Engine::Core::Instance()->Run();

		Engine::Core::Instance()->Dispose();

		delete m;
		delete input;
		delete options;
	}

	delete log;

	Engine::MemoryDump(std::cout);

	return 0;
}"
JP0tdf4s,Python 3.10+ Two Function Complete Monad Library!,HasteBin0,Python,Sunday 17th of September 2023 05:52:48 PM CDT,"# py_struct = NamedTuple
class CompareResult(py_struct):
    les: bool
    equ: bool
    gtr: bool


cmp_str_input_t = NewType('cmp_str_input_t', Iterable[SupportsBytes and SupportsIndex and SupportsInt])


def cmp_iter_str(si1: cmp_str_input_t, si2: cmp_str_input_t) -> CompareResult:
    it1 = iter(si1)
    it2 = iter(si2)
    while True:
        c1 = next(it1, None)
        c2 = next(it2, None)
        n1 = c1 is None
        n2 = c2 is None
        if n1 and n2:
            return CompareResult(False, True, False)
        elif n1 ^ n2:
            return CompareResult(n1, False, n2)
        elif c1 != c2:
            return CompareResult(c1 < c2, False, c1 > c2)


class monad_attr_err_spec_t(py_struct):
    obj_type: Type[Any]
    attr_name: str
    fxn_triggered: callable


def monad(call_function: callable, *op_types: monad_attr_err_spec_t, pass_types: bool = False) -> callable:
    def _i(*args, **kwargs):
        try:
            if pass_types:
                return call_function(*args, op_types = op_types, **kwargs)
            return call_function(*args, **kwargs)
        except AttributeError as attr_err:  # https://docs.python.org/3.11/library/exceptions.html#AttributeError
            if attr_err.obj is None:
                return
            ae_obj, ae_name = attr_err.obj, attr_err.name  # Changed in version 3.10: Added the name and obj attributes.
            x: monad_attr_err_spec_t
            for x in op_types:
                if x.obj_type is type(ae_obj) and ae_name == x.attr_name:
                    return x.fxn_triggered(*args, ae_obj = ae_obj, ae_name = ae_name, **kwargs)
    
    return _i"
MTHAS4EY,Untitled,skimono,C++,Sunday 17th of September 2023 05:24:55 PM CDT,"#pragma GCC optimize(""Ofast"") // ������������ ���������, �� ��� ������
#pragma GCC optimize(""no-stack-protector"") //�����
#pragma GCC optimize(""unroll-loops"") // � ���� ���� ��� �� 100 �� ������ ����� � ��������� �� ��� � 100 ��� �� ������ ��������
#pragma GCC target(""sse,sse2,sse3,ssse3,popcnt,abm,mmx,tune=native"") // ��� ����� ����� �� ��� 03 02 ��������� � ������ ������� �������� ��� ���� ������������
#pragma GCC optimize(""fast-math"")
#define _CRT_SECURE_NO_WARNINGS

#include <iostream>
#include <vector>
#include <string>
#include <algorithm>
#include <cmath>
#include <stack>
#include <iomanip>
#include <fstream>
#include <string>
#include <set>
#include <deque>
#include <queue>
#include <map>
#include <bitset>
#include <random>
#include <list>
#include <unordered_map>
#include <unordered_set>
#include <cassert>

using namespace std;

typedef long long ll;
typedef short sh;
typedef unsigned long long ull;
typedef long double ld;
typedef string str;
//typedef __int128 ultraint;
#define sqrt sqrtl
#define F first
#define S second
#define endl '\n'
#define all(vc666) vc666.begin(), vc666.end()
#define allr(vc666) vc666.rbegin(), vc666.rend()
#define int long long
#define degug(x) cerr (#x) << "" "" << (x) << endl;

const ll INF = 2e18;
const ll inf = 2e9 + 3;
const ll ONE = 1, ZERO = 0;
const ll mod = 998244353;
const ll m1 = 1e9 + 575179;
const ll m2 = 1e9 + 87;
const ll LG = 19;
const ll k = 1;
const ll p = 79;
ld EPS = 1e-9;
ld PI = 3.1415926535897932384;
ld phi = (sqrt(5) + 1.0) / 2.0;
mt19937_64 rnd(4906);

struct Query {
    int l, r, idx;
};

const int N = 1e5 + 3;
pair <int, int> pw[N];
pair <int, int> h[N];
map <int, int> keys[N];
vector <int> base[N], base2[N];
int ans[N];
Query Q[N];

pair <int, int> get_h(int l, int r) {
    return { (h[r + 1].first - (h[l].first * pw[r - l + 1].first) % m1 + m1) % m1, (h[r + 1].second - (h[l].second * pw[r - l + 1].second) % m2 + m2) % m2 };
}

bool cmp(const Query& a, const Query& b) {
    if (a.l / k != b.l / k) {
        return a.l < b.l;
    }
    else {
        return a.r < b.r;
    }
}

void solve() {
    string t, s;
    int n, len_t, len_s, len, i, j, m, l, r, q, res, lst = -1;
    cin >> t;
    len_t = t.size();
    pw[0] = { 1, 1 };
    h[0] = { 0, 0 };
    for (i = 1; i <= len_t; i++) {
        pw[i].first = (pw[i - 1].first * p) % m1;
        pw[i].second = (pw[i - 1].second * p) % m2;
        h[i].first = (h[i - 1].first * p + (t[i - 1] - 'a' + ONE)) % m1;
        h[i].second = (h[i - 1].second * p + (t[i - 1] - 'a' + ONE)) % m2;
    }
    pair <int, int> hesh;
    vector <int> rzl;
    cin >> n;
    for (i = 0; i < n; i++) {
        cin >> s;
        len_s = s.size();
        rzl.push_back(len_s);
        hesh = { 0, 0 };
        for (j = 0; j < len_s; j++) {
            hesh.first = (hesh.first * p + (s[j] - 'a' + ONE)) % m1;
            hesh.second = (hesh.second * p + (s[j] - 'a' + ONE)) % m2;
        }
        keys[len_s][hesh.first * m1 + hesh.second] = i;
    }
    sort(all(rzl));
    rzl.resize(unique(all(rzl)) - rzl.begin());
    m = rzl.size();
    for (i = 0; i < len_t; i++) {
        for (j = 0; j < m; j++) {
            len = rzl[j];
            if (i + len - 1 < len_t) {
                hesh = get_h(i, i + len - 1);
                if (keys[len].contains(hesh.first * m1 + hesh.second)) {
                    base[i].push_back(len);
                    base2[i + len - 1].push_back(len);
                }
            }
        }
    }
    for (i = 0; i < len_t; i++) {
        sort(all(base2[i]));
    }
    cin >> q;
    for (i = 0; i < q; i++) {
        cin >> Q[i].l >> Q[i].r;
        Q[i].idx = i;
        Q[i].l--;
        Q[i].r--;
    }
    sort(Q, Q + q, cmp);
    int left, right, last_r, last_l;
    for (i = 0; i < q; i++) {
        if (Q[i].l / k != lst) {
            lst = Q[i].l / k;
            l = Q[i].l;
            r = Q[i].l - 1;
            res = 0;
        }
        last_r = r;
        last_l = l;
        for (r; r < Q[i].r; r++) {
            left = -1, right = base2[r + 1].size();
            while (right - left > 1) {
                m = (left + right) / 2;
                if (r + 1 - base2[r + 1][m] + 1 >= last_l) {
                    left = m;
                }
                else {
                    right = m;
                }
            }
            res += right;
        }
        for (l; l > Q[i].l; l--) {
            left = -1, right = base[l - 1].size();
            while (right - left > 1) {
                m = (left + right) / 2;
                if (l - 1 + base[l - 1][m] - 1 <= r) {
                    left = m;
                }
                else {
                    right = m;
                }
            }
            res += right;
        }
        for (l; l < Q[i].l; l++) {
            left = -1, right = base[l].size();
            while (right - left > 1) {
                m = (left + right) / 2;
                if (l + base[l][m] - 1 <= r) {
                    left = m;
                }
                else {
                    right = m;
                }
            }
            res -= right;
        }
        ans[Q[i].idx] = res;
    }
    for (i = 0; i < q; i++) {
        cout << ans[i] << "" "";
    }
}

signed main() {
#ifdef _DEBUG
    freopen(""input.txt"", ""r "", stdin);
    freopen(""output.txt"", ""w"", stdout);
#endif
    ios_base::sync_with_stdio(0);
    cin.tie(NULL);
    cout.tie(NULL);
    int t = 1;
    //cin >> t;
    while (t--) solve();
}
//Deisgned by skimono
//Клуб ""Кольца(Серьги)"""
LYBSuxh5,WindManager,GoodNoodle,C#,Sunday 17th of September 2023 05:22:47 PM CDT,"using DG.Tweening;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class WindMaker : MonoBehaviour
{

    public float waitTime;

    public float speed;

    [SerializeField] public PlayerController player, buddy;


    // Start is called before the first frame update
    void Start()
    {
      
       
    }

    // Update is called once per frame
    void Update()
    {
        Vector2 pos = player.theRb.position;
        player.theRb.position += Vector2.down * speed * Time.deltaTime;
        player.theRb.MovePosition(pos);
    }

    private void OnTriggerStay2D(Collider2D other)
    {
        if(other.tag == ""Player"")
        {
            StartCoroutine(PushDirection());
        }
    }

    public IEnumerator PushDirection()
    {
        Vector2 pos = player.theRb.position;
        player.theRb.position += Vector2.down * speed * Time.deltaTime;
        player.theRb.MovePosition(pos);

       yield return new WaitForSeconds(waitTime);     
    }
}
"
1aqAuSGs,Untitled,corbinjo,SQL,Sunday 17th of September 2023 04:59:28 PM CDT,"--1.   Kreirati bazu podataka pod nazivom ZadaciZaVjezbu.
CREATE DATABASE ZadaciZaVjezbu
GO
USE ZadaciZaVjezbu
 
--2.   U pomenutoj bazi kreirati tabelu Aplikanti koja æe sadržavati sljedeæe kolone: Ime, Prezime i Mjesto_roðenja. Sva navedena polja trebaju da budu tekstualnog tipa, te prilikom kreiranja istih paziti da se ne zauzimaju bespotrebno memorijski resursi.
CREATE TABLE Aplikanti
(
Ime NVARCHAR(10),
Prezime NVARCHAR(20),
MjestoRodjenja NVARCHAR(50)
)
--3.   U tabelu Aplikanti dodati kolonu AplikantID, te je proglasiti primarnim kljuèem tabele (kolona mora biti autonkrement)
ALTER TABLE Aplikanti
ADD AplikantID INT NOT NULL IDENTITY(1,1)
 
ALTER TABLE Aplikanti
ADD CONSTRAINT PK_Aplikant PRIMARY KEY(AplikantID)
--4.   U bazi ZadaciZaVjezbu kreirati tabelu Projekti koji æe sadržavati sljedeæe kolone: Naziv projekta, Akronim projekta, Svrha projekta i Cilj projekta. Sva polja u tabeli su tekstualnog tipa, te prilikom kreiranja istih paziti da se ne zauzimaju bespotrebno memorijski resursi. Sva navedena polja osim cilja projekta moraju imati vrijednost.
CREATE TABLE Projekti
(
NazivProjekta NVARCHAR(30) NOT NULL,
AkronimProjekta NVARCHAR(30) NOT NULL,
SvrhaProjekta NVARCHAR(150) NOT NULL,
CiljProjekta NVARCHAR(150)
 
)
--5.   U tabelu Projekti dodati kolonu Sifra projekta, te je proglasiti primarnim kljuèem tabele.
ALTER TABLE Projekti
ADD SifraProjekta NVARCHAR(30) PRIMARY KEY
--6.   U tabelu Aplikanti dodati kolonu projekatID koje æe biti spoljni kljuè na tabelu projekat.
ALTER TABLE Aplikanti
ADD ProjekatID NVARCHAR(30) NOT NULL CONSTRAINT FK_Aplikant_Projekti FOREIGN KEY REFERENCES Projekti(sifraProjekta)
--7.   U bazi podataka ZadaciZaVjezbu kreirati tabelu TematskeOblasti koja æe sadržavati sljedeæa polja tematskaOblastID, naziv i opseg. TematskaOblastID predstavlja primarni kljuè tabele, te se automatski uveæava. Sva definisana polja moraju imati vrijednost. Prilikom definisanja dužine polja potrebno je obratiti pažnju da se ne zauzimaju bespotrebno memorijski resursi.
CREATE TABLE TematskeOblasti
(
TematskaOblastID INT CONSTRAINT PK_TematskaOblast PRIMARY KEY,
Naziv NVARCHAR(50) NOT NULL,
Opseg NVARCHAR(150) NOT NULL
)
--8.   U tabeli Aplikanti dodati polje email koje je tekstualnog tipa i može ostati prazno.
ALTER TABLE Aplikanti
ADD Email NVARCHAR(50)
--9.   U tabeli Aplikanti obrisati mjesto roðenja i dodati polja telefon i matièni broj. Oba novokreirana polja su tekstualnog tipa i moraju sadržavati vrijednost.
ALTER TABLE Aplikanti
DROP COLUMN MjestoRodjenja
 
ALTER TABLE Aplikanti
ADD Telefon NVARCHAR(10) NOT NULL,
MaticniBroj NVARCHAR(13) NOT NULL --CONSTRAINT UQ_Aplikanti_MaticniBroj UNIQUE
--10.  Obrisati tabele kreirane u prethodnim zadacima
DROP TABLE Aplikanti, TematskeOblasti, Projekti
--11.  Obrisati kreiranu bazu
DROP DATABASE ZadaciZaVjezbu
 
 
 
--1.         Kreirati bazu Procedure_ i aktivirati je.
CREATE DATABASE Procedure_
GO
USE Procedure_
--2.         Kreirati tabelu Proizvodi te prilikom kreiranja uraditi insert podataka iz tabele Products baze Northwind.
SELECT*
INTO Proizvodi
FROM Northwind.dbo.Products
 
--3.         Kreirati proceduru sp_Insert_Proizvod kojom æe se u tabeli Proizvodi uraditi insert novog zapisa.
GO
CREATE PROCEDURE sp_Products_Insert
(
@ProductName NVARCHAR(40),
@SupplierID INT=NULL,
@CategoryID INT=NULL,
@QuantityPerUnit NVARCHAR (20)= NULL,
@UnitPrice MONEY= NULL,
@UnitsInStock SMALLINT= NULL,
@UnitsOnOrder SMALLINT= NULL,
@ReorderLevel SMALLINT= NULL,
@Discontinued BIT
)
AS
BEGIN
INSERT INTO Proizvodi
VALUES(@ProductName,@SupplierID,@CategoryID,@QuantityPerUnit,@UnitPrice,@UnitsInStock,@UnitsOnOrder,@ReorderLevel,@Discontinued)
END
GO
--4.         Kreirati dva testna sluèaja, u prvom poslati podatke u sva polja, u drugom samo u ona koja su obavezna.
EXEC sp_Products_Insert
  @ProductName='Mlijeko',
  @SupplierID=1,
  @CategoryID=1,
  @QuantityPerUnit=2,
  @UnitPrice=1.4,
  @UnitsInStock=30,
  @UnitsOnOrder=0,
  @ReorderLevel=1,
  @Discontinued=1
 
SELECT*
FROM Proizvodi
ORDER BY 1 DESC
 
EXEC sp_Products_Insert
  @ProductName='Brašno',
  @Discontinued=1
 
--5.         Kreirati proceduru sp_Proizvod_Update kojom æe se u tabeli Proizvodi uraditi update zapisa.
GO
CREATE OR ALTER PROCEDURE sp_Proizvod_Update
(
@ProductID INT,
@ProductName NVARCHAR(40),
@SupplierID INT=NULL,
@CategoryID INT=NULL,
@QuantityPerUnit NVARCHAR (20)= NULL,
@UnitPrice MONEY= NULL,
@UnitsInStock SMALLINT= NULL,
@UnitsOnOrder SMALLINT= NULL,
@ReorderLevel SMALLINT= NULL,
@Discontinued BIT
)
AS
BEGIN
UPDATE Proizvodi
SET
                ProductName=ISNULL(@ProductName,ProductName),
                SupplierID=ISNULL(@SupplierID,SupplierID),
                CategoryID=ISNULL(@CategoryID,CategoryID),
                QuantityPerUnit=ISNULL(@QuantityPerUnit,QuantityPerUnit),
                UnitPrice=ISNULL(@UnitPrice,UnitPrice),
                UnitsInStock=ISNULL(@UnitsInStock,UnitsInStock),
                UnitsOnOrder=ISNULL(@UnitsOnOrder,UnitsOnOrder),
                ReorderLevel=ISNULL(@ReorderLevel,ReorderLevel),
                Discontinued=ISNULL(@Discontinued,Discontinued)
                WHERE ProductID=@ProductID
END
GO
 
EXEC sp_Proizvod_Update
  @ProductID=76,
  @ProductName='New product',
  @SupplierID=2,
  @ReorderLevel=1,
  @Discontinued=1
 
SELECT *
FROM Proizvodi
ORDER BY 1 DESC
 
 
GO
CREATE OR ALTER PROCEDURE sp_Proizvod_Update
(
@ProductId INT,
@ProductName NVARCHAR(40)=NULL,
@SupplierID INT=NULL,
@CategoryID INT=NULL,
@QuantityPerUnit NVARCHAR(20)=NULL,
@UnitPrice MONEY=NULL,
@UnitsInStock SMALLINT=NULL,
@UnitsOnOrder SMALLINT=NULL,
@ReorderLevel SMALLINT=NULL,
@Discontinued BIT
)
AS
BEGIN
UPDATE Proizvodi
SET
ProductName=ISNULL(@ProductName,ProductName),
SupplierID=ISNULL(@SupplierID,SupplierID),
CategoryID=      ISNULL(@CategoryID,CategoryID),
QuantityPerUnit=ISNULL(@QuantityPerUnit,QuantityPerUnit),
UnitPrice=ISNULL(@UnitPrice,UnitPrice),
UnitsInStock=ISNULL(@UnitsInStock,UnitsInStock),
UnitsOnOrder=ISNULL(@UnitsOnOrder,UnitsOnOrder),
ReorderLevel=ISNULL(@ReorderLevel,ReorderLevel),
Discontinued=ISNULL(@Discontinued,Discontinued)
WHERE ProductID=@ProductId
END
--6.         Kreirati testni sluèaj za update zapisa kroz proceduru.
EXEC sp_Proizvod_Update
  @ProductName='Mlijeko',
  @SupplierID=1,
  @CategoryID=1,
  @UnitPrice=1.6,
  @UnitsInStock=30,
  @UnitsOnOrder=0,
  @Discontinued=1,
  @ProductID=78
 
--7          Kreirati proceduru sp_Proizvod_Delete kojom æe se u tabeli Proizvodi uraditi delete odreðenog zapisa.
 
GO
CREATE PROCEDURE sp_Proizvod_Delete
(
                @ProductID INT
)
AS
BEGIN
DELETE FROM Proizvodi
WHERE ProductID=@ProductID
END
GO
 
 
GO
CREATE PROCEDURE sp_Proizvod_Delete
(
@ProductID int
)
AS
BEGIN
DELETE FROM Proizvodi
WHERE ProductID=@ProductID
END
 
--8.         Kreirati testni sluèaj za brisanje proizvoda sa id-om 78.
EXEC sp_Proizvod_Delete @ProductId=78
 
--9.         Kreirati tabelu StavkeNarudzbe te prilikom kreiranja uraditi insert podataka iz tabele Order Details baze Northwind.
SELECT*
INTO StavkeNarudzbe
FROM Northwind.dbo.[Order Details]
--10.      Kreirati proceduru sp_StavkeNarudzbe_Proizvodi_InsertUpdate kojom æe se u tabeli StavkeNarudzbe dodati nova stavka narudžbe a u tabeli Proizvodi umanjiti stanje za zalihama.
GO
CREATE PROCEDURE sp_StavkeNarudzbe_Proizvodi_InsertUpdate
(
@OrderID int,
@ProductID int,
@UnitPrice money,
@Quantity smallint,
@Discount real
)
AS
BEGIN
INSERT INTO StavkeNarudzbe
VALUES(@OrderID,@ProductID,@UnitPrice,@Quantity,@Discount)
 
UPDATE Proizvodi
SET UnitsInStock=UnitsInStock-@Quantity
WHERE ProductID=@ProductID
END
--11.      Kreirati testni sluèaj za prethodno kreiranu proceduru.
EXEC sp_StavkeNarudzbe_Proizvodi_InsertUpdate 10248,1,5,4,0.1
 
SELECT*
FROM StavkeNarudzbe
WHERE OrderID=10248
 
SELECT*
FROM Proizvodi
--12.      Kreirati proceduru kojom æe se u tabeli Proizvodi uraditi select proizvoda prema nazivu proizvoda i ID kategorije. Ukoliko korisnik ne unese ništa od navedenog prikazati sve proizvode.
GO
CREATE PROCEDURE sp_Proizvodi_SelectByProductNameOrCategoryID
(
@ProductName NVARCHAR(40)=NULL,
@CategoryID INT=NULL
)
AS
BEGIN
SELECT P.ProductName,P.CategoryID,P.UnitPrice,P.UnitsInStock,P.UnitsOnOrder
FROM Proizvodi as P
WHERE(ProductName=@ProductName OR @ProductName IS NULL) AND (CategoryID=@CategoryID OR @CategoryID IS NULL)
END
 
--13.      Prethodno kreiranu proceduru izvršiti sa sljedeæim testnim sluèajevima:
EXEC sp_Proizvodi_SelectByProductNameOrCategoryID @ProductName='Chai'
EXEC sp_Proizvodi_SelectByProductNameOrCategoryID @CategoryID=7
EXEC sp_Proizvodi_SelectByProductNameOrCategoryID @ProductName='Tofu',@CategoryID=7
EXEC sp_Proizvodi_SelectByProductNameOrCategoryID @ProductName=NULL,@CategoryID=NULL
 
 
--14.      Kreirati proceduru u bazi Procedure_ naziva  sp_uposlenici_selectAll nad tabelama HumanResources.Employee i Person.Person baze AdventureWorks2017 kojom æe se dati prikaz polja BusinessEntityID, FirstName, LastName i JobTitle. Proceduru podesiti da se rezultati sortiraju po BusinessEntityID.
 
GO
CREATE PROCEDURE sp_Uposlenici_selectAll
AS
BEGIN
SELECT  E.BusinessEntityID, P.FirstName, P.LastName, E.JobTitle
FROM AdventureWorks2017.HumanResources.Employee  AS E
INNER JOIN AdventureWorks2017.Person.Person  AS P
ON E.BusinessEntityID = P.BusinessEntityID
ORDER BY E.BusinessEntityID
END
 
EXEC sp_Uposlenici_selectAll
GO
 
--15.      Iz baze AdventureWorks2017 u tabelu Vendor kopirati tabelu Purchasing.Vendor.
SELECT *
INTO Vendor
FROM AdventureWorks2017.Purchasing.Vendor
--16.      Kreirati proceduru sp_vendor_deleteColumn kojom æe se izvršiti brisanje kolone PurchasingWebServiceURL.
GO
CREATE PROCEDURE SP_Vendor_deleteColumn
AS
BEGIN
ALTER TABLE Vendor
DROP COLUMN PurchasingWebServiceURL
END
 
EXEC sp_vendor_deleteColumn
 
SELECT * FROM Vendor
--17.      Kreirati proceduru sp_Vendor_updateColumn kojom æe se izvršiti update kolone AccountNumber tako da u svakom zapisu posljednji znak (cifra) podatka bude iskljuèivo 1.
GO
CREATE PROCEDURE sp_Vendor_updateAccountNumber
AS
BEGIN
UPDATE Vendor
SET AccountNumber = LEFT (AccountNumber, LEN (AccountNumber)-1) + '1'
WHERE RIGHT (AccountNumber,1) <> '1'
--WHERE CAST (RIGHT (AccountNumber,1) AS INT) != 1
--WHERE CONVERT (INT,RIGHT (AccountNumber,1)) <> 1
END
 
 
EXEC sp_Vendor_updateAccountNumber
 
SELECT*
FROM Vendor
--18.      18.          Kreirati proceduru u bazi Procedure_ naziva sp_Zaposlenici_SelectByFirstNameLastNameGender nad odgovarajuæim tabelama baze AdventureWorks2017 kojom æe se definirati sljedeæi ulazni parametri:
--            - EmployeeID,
--            - FirstName,
--            - LastName,
--            - Gender.
--Proceduru kreirati tako da je prilikom izvršavanja moguæe unijeti bilo koji broj parametara (možemo ostaviti bilo koje polje bez unijete vrijednosti parametra),
--te da procedura daje rezultat ako je zadovoljena bilo koja od vrijednosti koje su navedene kao vrijednosti parametara. Nakon kreiranja pokrenuti proceduru za sljedeæe vrijednosti parametara:
--•          EmployeeID = 20,
--•          LastName = Miller,
--•          LastName = Abercrombie Gender = M
 
GO
CREATE PROCEDURE sp_Zaposlenici_SelectByFirstNameLastNameGender
(
                @EmployeeID INT = NULL,
                @FirstName NVARCHAR (50) = NULL,
                @LastName NVARCHAR (50) = NULL,
                @Gender NCHAR (1) = NULL
)
AS
BEGIN
SELECT  e.BusinessEntityID, p.FirstName, p.LastName, e.Gender
FROM AdventureWorks2017.HumanResources.Employee AS E
INNER JOIN  AdventureWorks2017.Person.Person AS P
ON         E.BusinessEntityID = P.BusinessEntityID
WHERE E.BusinessEntityID = @EmployeeID OR P.FirstName = @FirstName OR P.LastName = @LastName OR E.Gender = @Gender
END
 
EXEC sp_Zaposlenici_SelectByFirstNameLastNameGender @EmployeeID = 20
 
EXEC sp_Zaposlenici_SelectByFirstNameLastNameGender @LastName = 'Miller'
 
EXEC sp_Zaposlenici_SelectByFirstNameLastNameGender @LastName = Abercrombie, @Gender = M
 
 
--19.      Proceduru sp_Zaposlenici_SelectByFirstNameLastNameGender izmijeniti tako da je prilikom izvršavanja moguæe unijeti bilo koje vrijednosti za prva tri parametra (možemo ostaviti bilo koje od tih polja bez unijete vrijednosti), a da vrijednost èetvrtog parametra bude F.
--Nakon izmjene pokrenuti proceduru za sljedeæe vrijednosti parametara:
--•          EmployeeID = 2,
--•          LastName = Miller
 
GO
ALTER PROCEDURE sp_Zaposlenici_SelectByFirstNameLastNameGender
(
                @EmployeeID INT = NULL,
                @FirstName NVARCHAR (50) = NULL,
                @LastName NVARCHAR (50) = NULL,
                @Gender NCHAR (1) = 'F'
)
AS
BEGIN
SELECT  E.BusinessEntityID, P.FirstName, P.LastName, E.Gender
FROM AdventureWorks2017.HumanResources.Employee AS E
INNER JOIN  AdventureWorks2017.Person.Person AS P
ON         E.BusinessEntityID = P.BusinessEntityID
WHERE (E.BusinessEntityID = @EmployeeID OR P.FirstName = @FirstName or P.LastName = @LastName) AND E.Gender = @Gender
END
 
EXEC sp_Zaposlenici_SelectByFirstNameLastNameGender @EmployeeID = 2
 
EXEC sp_Zaposlenici_SelectByFirstNameLastNameGender @LastName = 'Miller'
 
--20.      Kreirati proceduru u bazi Procedure_ naziva sp_Narudzbe_SelectByCustomerID nad odgovarajuæim tabelama baze Northwind, sa parametrom CustomerID kojom æe se dati pregled ukupno naruèenih koloèina svakog od proizvoda za unijeti ID Customera. Proceduru pokrenuti za ID Customera BOLID
GO
CREATE PROCEDURE sp_Narudzbe_SelectByCustomerID
@CustomerID NCHAR (5)
AS
BEGIN
SELECT  P.ProductName, SUM (OD.Quantity) as 'Ukupno narudèenih'
FROM Northwind.dbo.Products AS P
INNER JOIN Northwind.dbo.[Order Details] AS OD
ON P.ProductID = OD.ProductID
INNER JOIN Northwind.dbo.Orders AS O
ON OD.OrderID = O.OrderID
INNER JOIN Northwind.dbo.Customers AS C
ON O.CustomerID = C.CustomerID
WHERE C.CustomerID = @CustomerID
GROUP BY P.ProductName
ORDER BY 2 desc
END
 
EXEC sp_Narudzbe_SelectByCustomerID @CustomerID = BOLID
 
--21.      Koristeæi bazu Northwind pogled v_Narudzbe strukture:
--            - OrderID
--            - ShippedDate
--            - ukupno (predstavlja sumu vrijednosti stavki po narudžbi).
 
GO
CREATE VIEW v_Narudzbe
AS
SELECT  O.OrderID, O.ShippedDate, SUM (OD.Quantity * OD.UnitPrice) 'Ukupno'
FROM   Northwind.dbo.[Order Details] AS OD
INNER JOIN Northwind.dbo.Orders AS O
ON OD.OrderID = O.OrderID
GROUP BY O.OrderID, O.ShippedDate
GO
 
--22.      Koristeæi pogled v_Narudzbe kreirati proceduru sp_Prodavci_Zemlje sa paramterima:
--            - startDate, datumski tip
--            - endDate, datumski tip
--startDate i endDate su datumi izmeðu kojih se izraèunava suma prometa po narudžbi i obavezno je unijeti oba datuma.
--Procedura ima sljedeæu strukturu, odnosno vraæa sljedeæe podatke:
--            - OrderID
--            - Ukupno
--pri èemu æe kolona ukupno biti tipa money.
--Omoguæiti sortiranje u opadajuæem redoslijedu po Ukupno.
--Nakon kreiranja procedure pokrenuti za vrijednosti
--            - startDate          = 1997-01-01
--            - endDate           = 1997-12-31
 
GO
CREATE PROCEDURE sp_Prodavci_Zemlje
(
                @startDate        DATE,
                @endDate          DATE
)
AS
SELECT  OrderID, CAST (Ukupno AS MONEY)
FROM   v_Narudzbe
WHERE ShippedDate BETWEEN @startDate AND @endDate
ORDER BY 2
GO
 
EXEC sp_Prodavci_Zemlje @startDate = '1997-01-01', @endDate = '1997-12-31'
 
EXEC sp_Prodavci_Zemlje @startDate = '19970101', @endDate = '19971231'
 
--23.      Iz baze AdventureWorks2017 u bazu Procedure_ kopirati tabelu zaglavlje i tabelu stavke narudžbe za nabavke. Novokreirane tabele imenovati kao zaglavlje i detalji. U kreiranim tabelama definirati PK kao u tabelama u Bazi AdventureWorks2017. Definirati realtionships izmeðu tabela zaglavlje i stavke narudzbe.
SELECT *
INTO Detalji
FROM AdventureWorks2017.Purchasing.PurchaseOrderDetail
 
SELECT *
INTO Zaglavlje
FROM AdventureWorks2017.Purchasing.PurchaseOrderHeader
 
ALTER TABLE Zaglavlje
ADD CONSTRAINT PK_Zaglavlje PRIMARY KEY ([PurchaseOrderID])
 
ALTER TABLE Detalji
ADD CONSTRAINT PK_Detalji PRIMARY KEY ([PurchaseOrderID],[PurchaseOrderDetailID])
 
ALTER TABLE Detalji
ADD CONSTRAINT FK_Detalji_Zaglavlje FOREIGN KEY ([PurchaseOrderID]) REFERENCES Detalji ([PurchaseOrderID])
 
--24.      Kreirati proceduru sp_Narudzbe_Stavke sa paramterima:
--            - status, kratki cjelobrojni tip
--            - mjesecNarudzbe, cjelobrojni tip
--            - kvartalIsporuke, cjelobrojni tip
--            - vrijednostStavke, realni tip
--Procedura je sljedeæe strukture:
--            - status
--            - mjesec datuma narudžbe
--            - kvartal datuma isporuke
--            - naruèena kolièina
--            - cijena
--            - vrijednost stavke kao proizvod kolièine i cijene
--Uslov je da procedura dohvata samo one zapise u kojima je vrijednost kolone ukupno izmeðu 100 i 500, pri èemu æe prilikom pokretanja procedure rezultati biti sortirani u opadajuæem redoslijedu. Proceduru kreirati tako da je prilikom izvršavanja moguæe unijeti bilo koji broj parametara (možemo ostaviti bilo koje polje bez unijetog parametra), te da procedura daje rezultat ako je zadovoljena bilo koja od vrijednosti koje su navedene kao vrijednosti parametara.
--Nakon kreiranja procedure pokrenuti za sljedeæe vrijednosti parametara:
--            - status = 3
--            - kvartal_isporuke = 4
--            - mjesec_narudzbe = 3, status = 1
 
GO
CREATE PROCEDURE sp_Narudzbe_Stavke
(
                @status TINYINT = NULL,
                @mjesec_narudzbe INT = NULL,
                @kvartal_isporuke INT = NULL,
                @vrijednostStavke REAL = NULL
)
AS
SELECT  Z.Status, MONTH (Z.OrderDate) 'Mjesec',
                               DATEPART (QUARTER, Z.ShipDate) 'Kvartal',
                               D.OrderQty, D.UnitPrice, D.OrderQty * D.UnitPrice 'Vrijednost stavke'
FROM Zaglavlje AS Z
INNER JOIN Detalji AS D
ON Z.PurchaseOrderID = D.PurchaseOrderID
WHERE (Z.Status = @status OR MONTH (Z.OrderDate) = @mjesec_narudzbe OR DATEPART (QUARTER, Z.ShipDate) = @kvartal_isporuke OR
                               D.OrderQty * D.UnitPrice = @vrijednostStavke)
                               AND (D.OrderQty * D.UnitPrice) BETWEEN 100 AND 500
ORDER BY 6
GO
 
EXEC sp_Narudzbe_Stavke @status = 3
 
EXEC sp_Narudzbe_Stavke @kvartal_isporuke = 4
 
EXEC sp_Narudzbe_Stavke @mjesec_narudzbe = 3, @status = 1
 
 
--25.      Kreirati proceduru sp_Narudzbe_Stavke_sum sa paramterima:
--            - status, kratki cjelobrojni tip
--            - mjesecNarudzbe, cjelobrojni tip
--            - kvartalIsporuke, cjelobrojni tip
--Procedura je sljedeæe strukture:
--            - Status
--            - mjesec datuma narudžbe
--            - kvartal datuma isporuke
--            - ukupnu vrijednost narudžbe
--Uslov je da procedura dohvata samo one zapise u kojima je vrijednost kolone ukupno izmeðu 10000 i 5 000 000, pri èemu æe prilikom pokretanja procedure rezultati biti sortirani u opadajuæem redoslijedu.
--Proceduru kreirati tako da je prilikom izvršavanja moguæe unijeti bilo koji broj parametara (možemo ostaviti bilo koje polje bez unijetog parametra), te da procedura daje rezultat ako je zadovoljena bilo koja od vrijednosti koje su navedene kao vrijednosti parametara.
--Nakon kreiranja procedure pokrenuti za sljedeæe vrijednosti parametara:
--            - status = 1
--            - kvartal_isporuke = 4, mjesec_narudzbe = 3
 
GO
CREATE PROCEDURE sp_Narudzbe_Stavke_sum
(
                @status TINYINT = NULL,
                @mjesec_narudzbe INT = NULL,
                @kvartal_isporuke INT = NULL
)
AS
SELECT Z.Status, MONTH (Z.OrderDate) 'Mjesec', DATEPART (QUARTER, Z.ShipDate) 'Kvartal', SUM (D.OrderQty * D.UnitPrice) AS Ukupno
FROM Zaglavlje AS Z
INNER JOIN Detalji AS D
ON Z.PurchaseOrderID = D.PurchaseOrderID
WHERE (Z.Status = @status OR MONTH (Z.OrderDate) = @mjesec_narudzbe OR DATEPART (QUARTER, Z.ShipDate) = @kvartal_isporuke)
GROUP BY Z.Status, MONTH (Z.OrderDate), DATEPART (QUARTER, Z.ShipDate)
HAVING SUM(D.OrderQty * D.UnitPrice) BETWEEN 10000 AND 5000000
ORDER BY 4
GO
 
EXEC sp_Narudzbe_Stavke_sum @status = 1
 
EXEC sp_Narudzbe_Stavke_sum @kvartal_isporuke = 4, @mjesec_narudzbe = 3
 
--26.      Kreirati bazu Indeksi i aktivirati je.
CREATE DATABASE Indeksi_
GO
USE Indeksi_
 
--27.      Kreirati tabelu ProizvodiOsobe koja æe nastati spajanjem tabela Product i Person baze AdventureWorks2017 i prilikom kreiranja importovati 10 miliona zapisa.
SELECT TOP 100000000 P.ProductID,P.Name,P.ProductNumber,P.Color,P.ListPrice,PP.BusinessEntityID,PP.FirstName,PP.LastName,PP.MiddleName
INTO ProizvodiOsobe
FROM AdventureWorks2017.Production.Product AS P
CROSS JOIN AdventureWorks2017.Person.Person AS PP
 
--28.      Kreirati nonclustered index kojim æe se ubrzati pretraga po imenu i prezimenu. Kreirati testni sluèaj i pogledati aktualni plan izvršenja. Izbrisati kreirani index.
CREATE INDEX IX_proizvodiOsobe_FirstName_LastName
ON ProizvodiOsobe(FirstName,LastName)
 
SELECT PO.FirstName,PO.LastName
FROM ProizvodiOsobe AS PO
WHERE PO.FirstName LIKE 'A%' AND PO.LastName LIKE 'S%'
 
DROP INDEX IX_proizvodiOsobe_FirstName_LastName
ON ProizvodiOsobe
 
--29.      Kreirati nonclustered indeks koji æe omoguæiti bržu pretragu prema imenu i prezimenu a takoðer pretraga æe biti ubrzana iako se prikaže srednje ime. Kreirati testni sluèaj i pogledati plan izvršenja. Izbrisati kreirani index.
CREATE INDEX IX_proizvodiOsobe_FirstName_LastName_INC_MiddleName
ON ProizvodiOsobe(FirstName,LastName) INCLUDE(MiddleName)
 
SELECT PO.FirstName,PO.LastName,PO.MiddleName
FROM ProizvodiOsobe AS PO
WHERE PO.FirstName LIKE 'A%' AND PO.LastName LIKE 'S%' and po.MiddleName like 'L'
GROUP BY  PO.FirstName,PO.LastName,PO.MiddleName
 
DROP INDEX IX_proizvodiOsobe_FirstName_LastName_INC_MiddleName
ON ProizvodiOsobe
 
--30.      Kreirati kompozitni primarni kljuè nad kolonama ProductId i BusindessEntityId. Kreirati testni sluèaj za upotrebu primarnog kljuèa.
ALTER TABLE ProizvodiOsobe
ADD CONSTRAINT PK_ProizvodiOsobe_ProductId_BusinessEntityID PRIMARY KEY (ProductId, BusinessEntityId)
 
SELECT *
FROM ProizvodiOsobe AS PO
WHERE PO.ProductId = 1 AND PO.BusinessEntityID=14951
 
 
ALTER TABLE ProizvodiOsobe
DROP CONSTRAINT PK_ProizvodiOsobe_ProductId_BusinessEntityID
--31.      Kreirati clustered index nad kolonom ProductNumber. Kreirati testni sluèaj za upotrebu indexa i pogledati plan izvršenja. Izbrisati kreirani index.
CREATE CLUSTERED INDEX IX_proizvodiOsobe_ProductNumber
ON ProizvodiOsobe(ProductNumber)
 
SELECT *
FROM ProizvodiOsobe AS PO
WHERE PO.ProductNumber LIKE 'A%'
               
 
 
--Vježba 11_1 :: Zadaci
USE AdventureWorks2017
GO
--1.   Kreirati upit koji prikazuje kreditne kartice kojima je plaæeno više od 20 narudžbi. U listu ukljuèiti ime i prezime vlasnika kartice, tip kartice, broj kartice, ukupan iznos plaæen karticom. Rezultate sortirati prema ukupnom iznosu u opadajuæem redoslijedu.
SELECT PP.FirstName+' '+PP.LastName 'Ime i prezime', CC.CardType 'Tip kartice', CC.CardNumber 'Broj kartice',ROUND( SUM(SOH.TotalDue),2) 'Ukupan iznos'
FROM Person.Person AS PP
INNER JOIN Sales.PersonCreditCard AS PCC
ON PP.BusinessEntityID=PCC.BusinessEntityID
INNER JOIN Sales.CreditCard AS CC
ON PCC.CreditCardID=CC.CreditCardID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON CC.CreditCardID=SOH.CreditCardID
GROUP BY PP.FirstName,PP.LastName , CC.CardType , CC.CardNumber
HAVING COUNT(*)>20
ORDER BY 4 DESC
 
 
--2. Prikazati ime i prezime te vrijednost narudžbe (bez popusta) kupaca koji su napravili narudžbu veæu od prosjeène vrijednosti svih narudžbi proizvoda sa id 779
SELECT P.FirstName,P.LastName, SUM(SOD.OrderQty*SOD.UnitPrice) 'Vrijednost narudžbe'
FROM Person.Person AS P
INNER JOIN Sales.Customer AS C
ON C.PersonID=P.BusinessEntityID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOH.CustomerID=C.CustomerID
INNER JOIN Sales.SalesOrderDetail AS SOD
ON SOD.SalesOrderID=SOH.SalesOrderID
GROUP BY P.FirstName,P.LastName
HAVING SUM(SOD.OrderQty*SOD.UnitPrice) >
(
       SELECT AVG(SOD1.OrderQty*SOD1.UnitPrice)
       FROM Sales.SalesOrderDetail AS SOD1
       WHERE SOD1.ProductID=779
)
 
 
 
--3.   Kreirati upit koji prikazuje kupce koji su u maju mjesecu 2014. godine naruèili proizvod „Front Brakes“ u kolièini veæoj od 5 komada.
SELECT CONCAT(PP.FirstName,' ',PP.LastName) 'Ime i prezime', p.Name 'Ime', SOD.OrderQty 'Narucena kolicina',
CONVERT(NVARCHAR,SOH.OrderDate,104) 'Datum narudzbe'
FROM Person.Person AS PP
INNER JOIN Sales.Customer AS C
ON PP.BusinessEntityID=C.PersonID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON C.CustomerID=SOH.CustomerID
INNER JOIN Sales.SalesOrderDetail AS SOD
ON SOH.SalesOrderID=SOD.SalesOrderID
INNER JOIN Production.Product AS P
ON SOD.ProductID=P.ProductID
WHERE MONTH(SOH.OrderDate)=5 AND YEAR(SOH.OrderDate)=2014 AND P.Name='Front Brakes' AND SOD.OrderQty>5
 
 
 
 
--4.   Kreirati upit koji prikazuje kupce koji su u 7. mjesecu utrošili više od 200.000 KM. U listu ukljuèiti ime i prezime kupca te ukupni utrošak. Izlaz sortirati prema utrošku opadajuæim redoslijedom.
SELECT CONCAT (PP.FirstName,' ',PP.LastName) 'Ime i prezime', SUM(SOH.TotalDue) 'Ukupni trošak'
FROM Person.Person AS PP
INNER JOIN Sales.Customer AS SC
ON PP.BusinessEntityID=SC.PersonID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SC.CustomerID=SOH.CustomerID
WHERE MONTH(SOH.OrderDate)=7
GROUP BY PP.FirstName,PP.LastName
HAVING SUM(SOH.TotalDue) > 200000
ORDER BY 2 DESC
 
 
--5.   Kreirati upit koji prikazuje zaposlenike koji su uradili više od 200 narudžbi. U listu ukljuèiti ime i prezime zaposlenika te ukupan broj uraðenih narudžbi. Izlaz sortirati prema broju narudžbi opadajuæim redoslijedom
SELECT CONCAT(PP.FirstName,' ',PP.LastName) 'Ime i prezime', COUNT(*) 'Ukupan broj uraðenih narudžbi'
FROM Person.Person AS PP
INNER JOIN Sales.SalesPerson AS SP
ON PP.BusinessEntityID=SP.BusinessEntityID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SP.BusinessEntityID=SOH.SalesPersonID
GROUP BY PP.FirstName,PP.LastName
HAVING COUNT(*)>200
ORDER BY 2 DESC
 
 
 
--6.   Kreirati upit koji prikazuje proizvode kojih na skladištu ima u kolièini manjoj od 30 komada. Lista treba da sadrži naziv proizvoda, naziv skladišta (lokaciju), stanje na skladištu i ukupnu prodanu kolièinu. U rezultate upita ukljuèiti i one proizvode koji nikad nisu prodavani. Ukoliko je ukupna prodana kolièina prikazana kao NULL vrijednost, izlaz formatirati brojem 0.
SELECT P.Name 'Naziv proizvoda', L.Name 'Naziv skladišta', PI.Quantity 'Stanje na skladištu',
ISNULL((SELECT SUM(SOD.OrderQty)
             FROM Sales.SalesOrderDetail AS SOD
        WHERE SOD.ProductID=P.ProductID),0) 'Prodana kolièina'
FROM Production.Product AS P
INNER JOIN Production.ProductInventory AS PI
ON P.ProductID=PI.ProductID
INNER JOIN Production.Location AS L
ON PI.LocationID=L.LocationID
WHERE (PI.Quantity<30 OR P.ProductID NOT IN(SELECT DISTINCT SOD.ProductID
                                                                          FROM Sales.SalesOrderDetail AS SOD))
ORDER BY [Prodana kolièina] DESC
 
 
 
--7.   Prikazati ukupnu kolièinu prodaje i ukupnu zaradu (ukljuèujuæi popust) od prodaje svakog pojedinog proizvoda po teritoriji. Uzeti u obzir samo prodaju u sklopu ponude pod nazivom “Volume Discount 11 to 14” i to samo gdje je kolièina prodaje veæa od 100 komada. Zaradu zaokružiti na dvije decimale, te izlaz sortirati po zaradi u opadajuæem redoslijedu.
SELECT ST.Name 'Teritorija',PP.Name'Naziv proizvoda',SUM(SOD.OrderQty)'Ukupna kolièina prodaje', CAST(SUM((SOD.LineTotal)) AS DECIMAL(10,2)) 'Ukupna zarada'
FROM Production.Product AS PP
INNER JOIN Sales.SalesOrderDetail AS SOD
ON PP.ProductID=SOD.ProductID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOD.SalesOrderID=SOH.SalesOrderID
INNER JOIN Sales.SalesTerritory AS ST
ON SOH.TerritoryID=ST.TerritoryID
INNER JOIN Sales.SpecialOffer AS SO
ON SOD.SpecialOfferID=SO.SpecialOfferID
WHERE SO.Description LIKE 'Volume Discount 11 to 14'
GROUP BY PP.Name,ST.Name
HAVING SUM(SOD.OrderQty)>100
ORDER BY [Ukupna zarada] DESC
 
SELECT ST.Name 'Teritorija',PP.Name'Naziv proizvoda',SUM(SOD.OrderQty)'Ukupna kolièina prodaje', CAST(SUM((SOD.LineTotal)) AS DECIMAL(10,2)) 'Ukupna zarada'
FROM Production.Product AS PP
INNER JOIN Sales.SalesOrderDetail AS SOD
ON PP.ProductID=SOD.ProductID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOD.SalesOrderID=SOH.SalesOrderID
INNER JOIN Sales.SalesTerritory AS ST
ON SOH.TerritoryID=ST.TerritoryID
INNER JOIN Sales.SpecialOfferProduct AS SOP
ON SOP.SpecialOfferID=SOD.SpecialOfferID AND SOP.ProductID=SOD.ProductID
INNER JOIN Sales.SpecialOffer AS SO
ON SOP.SpecialOfferID=SO.SpecialOfferID
WHERE SO.Description LIKE 'Volume Discount 11 to 14'
GROUP BY PP.Name,ST.Name
HAVING SUM(SOD.OrderQty)>100
ORDER BY [Ukupna zarada] DESC
 
--8.   Kreirati upit koji prikazuje naziv proizvoda, naziv lokacije, stanje zaliha na lokaciji, ukupno stanje zaliha na svim lokacijama i ukupnu prodanu kolièinu. Uzeti u obzir prodaju samo u 2013. godini.
SELECT PP.Name 'Naziv proizvoda', L.Name 'Naziv lokacije', PI.Quantity 'Stanje zaliha',
(
       SELECT SUM(PI.Quantity)
       FROM Production.ProductInventory AS PI
       WHERE PI.ProductID=PP.ProductID
) 'Ukupno na svim lokacijama',
(
       SELECT SUM(SOD.OrderQty)
       FROM Sales.SalesOrderDetail AS SOD
       INNER JOIN Sales.SalesOrderHeader AS SOH
       ON SOD.SalesOrderID=SOH.SalesOrderID
       WHERE PP.ProductID=SOD.ProductID AND YEAR(SOH.OrderDate)=2013
) 'Ukupna prodana kolièina'
FROM Production.Product AS PP
INNER JOIN Production.ProductInventory AS PI
ON PP.ProductID=PI.ProductID
INNER JOIN Production.Location AS L
ON PI.LocationID=L.LocationID
ORDER BY [Ukupna prodana kolièina] DESC
 
 
 
--9.   Kreirati upit kojim æe se prikazati narudžbe kojima je na osnovu popusta kupac uštedio 100KM i više. Upit treba da sadrži broj narudžbe, naziv kupca i stvarnu ukupnu vrijednost narudžbe zaokruženu na 2 decimale. Podatke je potrebno sortirati rastuæim redosljedom od najmanjeg do najveæeg.
SELECT SOH.SalesOrderID, PP.FirstName +' '+PP.LastName 'Kupac', CAST(SUM(SOD.LineTotal) AS DECIMAL(18,2)) 'Ukupna vrijednost'
FROM Sales.SalesOrderHeader AS SOH
INNER JOIN Sales.Customer AS SC
ON SOH.CustomerID=SC.CustomerID
INNER JOIN Person.Person AS PP
ON SC.PersonID=PP.BusinessEntityID
INNER JOIN Sales.SalesOrderDetail AS SOD
ON SOD.SalesOrderID=SOH.SalesOrderID
GROUP BY SOH.SalesOrderID, PP.FirstName +' '+PP.LastName
HAVING SUM(SOD.UnitPrice*SOD.OrderQty*SOD.UnitPriceDiscount)>=100
ORDER BY 3
 
 
--10.  Kreirati upit kojim se prikazuje da li su muškarci ili žene napravili veæi broj narudžbi. Naèin provjere spola jeste da osobe èije ime završava slovom „a“ predstavljaju ženski spol. U rezultatima upita prikazati spol (samo jedan), ukupan broj narudžbi koje su napravile osobe datog spola i ukupnu potrošenu vrijednost zaokruženu na dvije decimale.
SELECT TOP 1 COUNT(*) 'Broj narudžbi',IIF(RIGHT(PP.FirstName,1)='a', 'Ž','M') 'Broj narudžbi', ROUND(SUM(SOH.TotalDue),2) 'Ukupna potrošena vrijednost'
FROM Person.Person AS PP
INNER JOIN Sales.Customer AS SC
ON PP.BusinessEntityID=SC.PersonID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOH.CustomerID=SC.CustomerID
GROUP BY IIF(RIGHT(PP.FirstName,1)='a', 'Ž','M')
ORDER BY 1 DESC
 
 
--11.  Kreirati upit koji prikazuje ukupan broj proizvoda, ukupnu kolièinu proizvoda na lageru, te ukupnu vrijednost proizvoda na lageru (skladištu). Rezultate prikazati grupisane po nazivu dobavljaèa te uzeti u obzir samo one zapise gdje je sumarna kolièina na lageru veæa od 100 i vrijednost cijene proizvoda veæa od 0.
SELECT PV.Name,COUNT(*) 'Ukupan broj proizvoda', SUM(PPI.Quantity) 'Uk. kolièina na lageru', SUM(PP.ListPrice*PPI.Quantity) 'Uk. vrijednost proizvoda na lageru'
FROM Production.ProductInventory AS PPI
INNER JOIN Production.Product AS PP
ON PPI.ProductID = PP.ProductID
INNER JOIN Purchasing.ProductVendor AS PPV
ON PPV.ProductID = PP.ProductID
INNER JOIN Purchasing.Vendor AS PV
ON PPV.BusinessEntityID=PV.BusinessEntityID
WHERE PP.ListPrice > 0
GROUP BY PV.Name
HAVING SUM(PPI.Quantity) > 1000
 
 
 
--Vježba 11_2 :: Zadaci
 
--1.   Kreirati bazu View_ i aktivirati je.
CREATE DATABASE View_
GO
USE View_
--2.   U bazi View kreirati pogled v_Employee sljedeæe strukture:
--     - prezime i ime uposlenika kao polje ime i prezime,
--     - teritoriju i
--     - regiju koju pokrivaju
--Uslov je da se dohvataju uposlenici koji su stariji od 60 godina.(Northwind)
GO
CREATE VIEW v_Employee
AS
SELECT E.[FirstName] + ' ' + e.[LastName] 'Ime i prezime', T.[TerritoryDescription] 'Teritorija', R.[RegionDescription] 'Regija'
FROM Northwind.dbo.Employees AS E
INNER JOIN Northwind.dbo.EmployeeTerritories AS ET
ON E.EmployeeID=ET.EmployeeID
INNER JOIN Northwind.dbo.Territories AS T
ON ET.TerritoryID=T.TerritoryID
INNER JOIN Northwind.dbo.Region AS R
ON T.RegionID=R.RegionID
WHERE DATEDIFF (YEAR, E.[BirthDate], GETDATE ()) > 60
GO
 
--3.   Koristeæi pogled v_Employee prebrojati broj teritorija koje uposlenik pokriva po jednoj regiji.(Northwind)
SELECT VE.[Ime i prezime], VE.Regija, COUNT(VE.Teritorija) 'Broj teritorija'
FROM v_Employee AS VE
GROUP BY VE.[Ime i prezime], VE.Regija
ORDER BY 3 DESC,1
 
--4.   Kreirati pogled v_Sales sljedeæe strukture: (Adventureworks2017)
--     - Id kupca
--     - Ime i prezime kupca
--     - Godinu narudžbe
--     - Vrijednost narudžbe bez troškova prevoza i takse
GO
CREATE VIEW v_Sales
AS
SELECT SC.CustomerID 'Id kupca', CONCAT(PP.FirstName, ' ', PP.LastName) 'Ime i prezime kupca', YEAR(SOH.OrderDate) 'Godina narudžbe', SOH.SubTotal 'Vrijednost'
FROM AdventureWorks2017.Person.Person AS PP
INNER JOIN AdventureWorks2017.Sales.Customer AS SC
ON PP.BusinessEntityID=SC.PersonID
INNER JOIN AdventureWorks2017.Sales.SalesOrderHeader AS SOH
ON SC.CustomerID=SOH.CustomerID
GO
 
--5.   Koristeæi pogled v_Sales dati pregled sumarno ostvarenih prometa po osobi i godini.
SELECT VS.[Godina narudžbe],VS.[Ime i prezime kupca],SUM(VS.Vrijednost) 'Sumarno ostvaren promet'
FROM v_Sales AS VS
GROUP BY VS.[Godina narudžbe],VS.[Ime i prezime kupca]
 
--6.   Koristeæi pogled v_Sales dati pregled zapisa iz 2013. godine u kojima je vrijednost narudžbe bez troškova prevoza i takse u intervalu 10% u odnosu na srednju vrijednost SubTotala iz 2013 godine. Pregled treba da sadrži ime i prezime kupca i vrijednost narudžbe.
GO
CREATE VIEW v_Sales2013
AS
SELECT *
FROM v_Sales AS VS
WHERE  VS.[Godina narudžbe]= 2013
GO
 
SELECT       VS13.[Ime i prezime kupca], VS13.Vrijednost
FROM   v_Sales2013 AS VS13
WHERE  VS13.Vrijednost BETWEEN
             (SELECT AVG (VS13_2.Vrijednost) FROM v_Sales2013 AS VS13_2) - 0.1 * (SELECT AVG (VS13_2.Vrijednost) FROM v_Sales2013 AS VS13_2)
             AND
             (SELECT AVG (VS13_2.Vrijednost) FROM v_Sales2013 AS VS13_2) + 0.1 * (SELECT AVG (VS13_2.Vrijednost) FROM v_Sales2013 AS VS13_2)
ORDER BY 2 DESC
 
 
 
--DRUGI NAÈIN
 
SELECT VS.[Ime i prezime kupca],VS.Vrijednost
FROM v_Sales AS VS
WHERE VS.[Godina narudžbe]=2013
AND VS.Vrijednost BETWEEN
(SELECT AVG(VS.Vrijednost)
FROM v_Sales AS VS
WHERE VS.[Godina narudžbe]=2013)-0.1*(SELECT AVG(VS.Vrijednost) FROM v_Sales AS VS
                                                               WHERE VS.[Godina narudžbe]=2013) AND (SELECT AVG(VS.Vrijednost) FROM v_Sales AS VS
                                                                            WHERE VS.[Godina narudžbe]=2013)+0.1*
                                                                                                                                (SELECT AVG(VS.Vrijednost) FROM v_Sales AS VS
                                                                             WHERE VS.[Godina narudžbe]=2013)
ORDER BY 2 DESC
 
--7.   Kreirati tabelu Zaposlenici te prilikom kreiranja uraditi insert podataka iz tabele Employees baze Northwind.
SELECT*
INTO Zaposlenici
FROM Northwind.dbo.Employees
--8.   Kreirati pogled v_Zaposlenici koji æe dati pregled ID-a, imena, prezimena i države zaposlenika.
GO
CREATE VIEW v_Zaposlenici
AS
SELECT Z.EmployeeID,Z.FirstName,Z.LastName,Z.Country
FROM Zaposlenici AS Z
GO
 
--9.   Modificirati prethodno kreirani pogled te onemoguæiti unos podataka kroz pogled za uposlenike koji ne dolaze iz Amerike ili Velike Britanije.
CREATE OR ALTER VIEW v_Zaposlenici
AS
SELECT Z.EmployeeID,Z.FirstName,Z.LastName,Z.Country
FROM Zaposlenici AS Z
WHERE Z.Country LIKE 'USA' OR Z.Country LIKE 'UK'
WITH CHECK OPTION
GO
 
--10.  Testirati prethodno modificiran view unosom ispravnih i neispravnih podataka (napisati 2 testna sluèaja).
INSERT INTO v_Zaposlenici
VALUES ('FirstName1','LastName1', 'BIH')
 
INSERT INTO v_Zaposlenici
VALUES ('FirstName1','LastName1', 'USA')
 
SELECT*
FROM v_Zaposlenici
 
SELECT*
FROM Zaposlenici
--11.  Koristeæi tabele Purchasing.Vendor i Purchasing.PurchaseOrderDetail kreirati pogled sljedeæe strukture:
--     - Name iz tabele Vendor
--     - PurchaseOrderID iz tabele Purchasing.PurchaseOrderDetail
--     - DueDate iz tabele Purchasing.PurchaseOrderDetail
--     - OrderQty iz tabele Purchasing.PurchaseOrderDetail
--     - UnitPrice iz tabele Purchasing.PurchaseOrderDetail
--     - ukupno kao proizvod OrderQty i UnitPrice
--Uslov je da se dohvate samo oni zapisi kod kojih DueDate pripada 1. ili 3. kvartalu. (AdventureWorks2017)
GO
CREATE VIEW V_Purchasing
AS
SELECT V.Name,POD.PurchaseOrderID,POD.DueDate,POD.OrderQty,POD.UnitPrice,POD.UnitPrice*POD.OrderQty 'Ukupno'
FROM AdventureWorks2017.Purchasing.Vendor AS V
INNER JOIN AdventureWorks2017.Purchasing.PurchaseOrderHeader AS POH
ON V.BusinessEntityID=POH.VendorID
INNER JOIN AdventureWorks2017.Purchasing.PurchaseOrderDetail AS POD
ON POH.PurchaseOrderID=POD.PurchaseOrderID
WHERE DATEPART(QUARTER,POD.DueDate)=1 OR DATEPART(QUARTER,POD.DueDate)=3
--WHERE MONTH (POD.DueDate) IN (1,2,3,7,8,9)
GO
 
--12.  Koristeæi pogled v_Purchasing dati pregled svih dobavljaèa(e) koji je u sklopu narudžbe imao stavke èija je ukupni broj stavki jednak minimumu, odnosno, maksimumu ukupnog broja stavki (proizvoda) po narudžbi.
--Pregled treba imati sljedeæu strukturu:
--     - Name
--     - PurchaseOrderID
--     - prebrojani broj
GO
CREATE VIEW V_Purchasing_prebrojano
AS
SELECT VP.Name,VP.PurchaseOrderID,COUNT(*) 'Prebrojano'
FROM V_Purchasing AS VP
GROUP BY VP.Name,VP.PurchaseOrderID
GO
 
SELECT VPP.Name,VPP.PurchaseOrderID, Prebrojano
FROM V_Purchasing_prebrojano AS VPP
WHERE VPP.Prebrojano=(SELECT MAX(VPP.Prebrojano) FROM V_Purchasing_prebrojano AS VPP) OR VPP.Prebrojano=(SELECT MIN(VPP.Prebrojano) FROM V_Purchasing_prebrojano AS VPP)
 
--13.  U bazi radna kreirati tabele Osoba i Uposlenik.
--Strukture tabela su sljedeæe:
 
--- Osoba
--     OsobaID                    cjelobrojna varijabla, primarni kljuè
--     VrstaOsobe          2 unicode karaktera, obavezan unos
--     Prezime                    50 unicode karaktera, obavezan unos
--     Ime                        50 unicode karaktera, obavezan unos
 
--- Uposlenik
--     UposlenikID         cjelobrojna varijabla, primarni kljuè
--     NacionalniID  15 unicode karaktera, obavezan unos
--     LoginID                    256 unicode karaktera, obavezan unos
--     RadnoMjesto         50 unicode karaktera, obavezan unos
--     DtmZapos            datumska varijabla
--Spoj tabela napraviti prema spoju izmeðu tabela
--Person.Person i HumanResources.Employee baze AdventureWorks2017.
CREATE TABLE Osoba
(
       OsobaID                    INT CONSTRAINT PK_Osoba PRIMARY KEY,
       VrstaOsobe          NVARCHAR (2) NOT NULL,
       Prezime                    NVARCHAR (50) NOT NULL,
       Ime                        NVARCHAR (50) NOT NULL
)
 
CREATE TABLE Uposlenik
(
       UposlenikID         INT CONSTRAINT PK_Uposlenik PRIMARY KEY,
       NacionalniID  NVARCHAR (15) NOT NULL,
       LoginID                    NVARCHAR (256) NOT NULL,
       RadnoMjesto         NVARCHAR (50) NOT NULL,
       DtmZapos            DATE,
       CONSTRAINT FK_Uposlenik_Osoba FOREIGN KEY (UposlenikID) REFERENCES Osoba (OsobaID)
)
 
--14.  Nakon kreiranja tabela u tabelu Osoba kopirati odgovarajuæe podatke iz tabele Person.Person, a u tabelu Uposlenik kopirati odgovarajuæe zapise iz tabele HumanResources.Employee.
INSERT INTO Osoba
SELECT P.BusinessEntityID,P.PersonType,P.LastName,P.FirstName
FROM AdventureWorks2017.Person.Person AS P
 
INSERT INTO Uposlenik
SELECT E.BusinessEntityID, E.NationalIDNumber, E.LoginID, E.JobTitle, E.HireDate
FROM AdventureWorks2017.HumanResources.Employee AS E
 
--15.  Kreirati pogled (view) v_osoba_uposlenik nad tabelama Uposlenik i Osoba koji æe sadržavati sva polja obje tabele.
GO
CREATE VIEW v_Osoba_Uposlenik
AS
SELECT *
FROM Osoba AS O
INNER JOIN Uposlenik  AS U
ON O.OsobaID = U.UposlenikID
GO
 
--16.  Koristeæi pogled v_osoba_uposlenik prebrojati koliko se osoba zaposlilo po godinama.
SELECT YEAR (VOU.DtmZapos) 'Godina', COUNT (*) 'Broj osoba'
FROM v_Osoba_Uposlenik AS VOU
GROUP BY YEAR (VOU.DtmZapos)
ORDER BY 2
 
 
 
 
 
--Vježba 12 :: Zadaci
 
--1.    Kreirati bazu Function_ i aktivirati je.
CREATE DATABASE Function_
GO
USE Function_
--2.   Kreirati tabelu Zaposlenici te prilikom kreiranja uraditi insert podataka iz tabele Employees baze Northwind.
SELECT*
INTO Zaposlenici
FROM pubs.dbo.employee
 
--3.   U tabeli uposlenici dodati izraèunatu (stalno pohranjenu) kolonu godina kojom æe se iz kolone hire_date izdvajati godina uposlenja.
ALTER TABLE Zaposlenici
ADD GodinaZaposlenja AS YEAR(hire_date)
 
SELECT*
FROM Zaposlenici
--4.   Kreirati funkciju f_ocjena sa parametrom brojBodova, cjelobrojni tip koja æe vraæati poruke po sljedeæem pravilu:
--     - brojBodova < 55          nedovoljan broj bodova
--     - brojBodova 55 - 65       šest (6)
--     - broj Bodova 65 - 75             sedam (7)
--     - brojBodova 75 - 85       osam (8)
--     - broj Bodova 85 - 95             devet (9)
--     - brojBodova 95-100        deset
--     - brojBodova >100          fatal error
--Kreirati testne sluèajeve.
GO
CREATE FUNCTION f_ocjena
(
       @brojBodova int
)
RETURNS VARCHAR (30)
AS
BEGIN
       DECLARE @poruka VARCHAR (50)
       SET @poruka = 'nedovoljan broj bodova'
       IF @brojBodova BETWEEN 55 AND 64 SET @poruka = 'šest (6)'
       IF @brojBodova BETWEEN 65 AND 74 SET @poruka = 'sedam (7)'
       IF @brojBodova BETWEEN 75 AND 84 SET @poruka = 'osam (8)'
       IF @brojBodova BETWEEN 85 AND 94 SET @poruka = 'devet (9)'
       IF @brojBodova BETWEEN 95 AND 100 SET @poruka = 'deset (10)'
       IF @brojBodova>100 SET @poruka = 'fatal error'
       RETURN @poruka
END
GO
SELECT dbo.f_ocjena(55),dbo.f_ocjena(40),dbo.f_ocjena(80)
 
--5.   Kreirati funkciju f_godina koja vraæa podatke u formi tabele sa parametrom godina, cjelobrojni tip. Parametar se referira na kolonu godina tabele uposlenici, pri èemu se trebaju vraæati samo oni zapisi u kojima je godina veæa od unijete vrijednosti parametra. Potrebno je da se prilikom pokretanja funkcije u rezultatu nalaze sve kolone tabele uposlenici. Provjeriti funkcioniranje funkcije unošenjem kontrolnih vrijednosti.
GO
CREATE FUNCTION f_godina
(
@godina INT
)
RETURNS TABLE
AS
RETURN
SELECT*
FROM Zaposlenici AS Z
WHERE Z.GodinaZaposlenja>@godina
 
 
SELECT *
FROM f_godina (1993)
ORDER BY 9
--6.   Kreirati funkciju f_pub_id koja vraæa podatke u formi tabele sa parametrima:
--     - prva_cifra, kratki cjelobrojni tip
--     - job_id, kratki cjelobrojni tip
--Parametar prva_cifra se referira na prvu cifru kolone pub_id tabele uposlenici, pri èemu je njegova zadana vrijednost 0. Parametar job_id se referira na kolonu job_id tabele uposlenici. Potrebno je da se prilikom pokretanja funkcije u rezultatu nalaze sve kolone tabele uposlenici. Provjeriti funkcioniranje funkcije unošenjem vrijednosti za parametar job_id = 5
GO
CREATE FUNCTION f_pub_id
(
       @prva_cifra TINYINT = 0,
       @job_id TINYINT
)
RETURNS TABLE
AS
RETURN
       SELECT *
       FROM Zaposlenici AS Z
       WHERE  LEFT (Z.pub_id,1) = @prva_cifra and
                    Z.job_id = @job_id
GO
 
SELECT *
FROM f_pub_id (DEFAULT, 5)
--7.   Kreirati tabelu detalji, te prilikom kreiranja uraditi isert podataka iz tabele Order Details baze Northwind.
SELECT*
INTO Detalji
FROM Northwind.dbo.[Order Details]
--8.   Kreirati funkciju f_ukupno sa parametrima
--     - UnitPrice   novèani tip money,
--     - Quantity    kratki cjelobrojni tip
--     - Discount    realni broj
--Funkcija æe vraæati rezultat tip decimal (10,2) koji æe raèunati po pravilu:
--     UnitPrice * Quantity * (1 - Discount)
GO
CREATE FUNCTION f_ukupno
(
@UnitPrice MONEY,
@Quantity SMALLINT,
@Discount REAL
)
RETURNS DECIMAL(10,2)
AS
BEGIN
RETURN @UnitPrice*@Quantity*(1-@Discount)
END
GO
 
SELECT dbo.f_ukupno(2,2,0.1)
--9.   Koristeæi funkciju f_ukupno u tabeli detalji prikazati ukupnu vrijednost prometa po ID proizvoda.
SELECT ProductID, SUM (dbo.f_ukupno([UnitPrice],[Quantity],[Discount])) 'Ukupno'
FROM Detalji
GROUP BY ProductID
ORDER BY 1
--10.  Koristeæi funkciju f_ukupno u tabeli detalji kreirati pogled v_f_ukupno u kojem æe biti prijazan ukupan promet po ID narudžbe.
GO
CREATE VIEW v_f_ukupno
AS
SELECT OrderID, SUM (dbo.f_ukupno([UnitPrice],[Quantity],[Discount])) as 'Ukupno'
FROM Detalji
GROUP BY OrderID
GO
--11.  Iz pogleda v_f_ukupno odrediti najmanju i najveæu vrijednost sume.
SELECT MIN(VU.Ukupno) 'Min', MAX(VU.Ukupno) 'Max'
FROM v_f_ukupno AS VU
--12.  Kreirati tabelu Kupovina, te prilikom kreiranja uraditi insert podataka iz tabele PurchaseOrderDetail baze AdventureWorks2017.
--Tabela æe sadržavati kolone:
--     - PurchaseOrderID,
--     - PurchaseOrderDetailID,
--     - UnitPrice
--     - RejectedQty,
--     - RazlikaKolicina koja predstavlja razliku izmeðu naruèene i primljene kolièine
SELECT POD.PurchaseOrderID,POD.PurchaseOrderDetailID,POD.UnitPrice,POD.RejectedQty,POD.OrderQty-POD.ReceivedQty 'RazlikaKolicina'
INTO Kupovina
FROM AdventureWorks2017.Purchasing.PurchaseOrderDetail AS POD
--13.  Kreirati funkciju f_rejected koja vraæa podatke u formi tabele sa parametrima:
--     - RejectedQty decimal (8,2)
--     - RazlikaKolicina  int
--Parametar RejectedQty se referira na kolonu RejectedQty tabele kupovina, pri èemu je njegova zadana vrijednost 0. Parametar RazlikaKolicina  se odnosi na kolonu RazlikaKolicina. Potrebno je da se prilikom pokretanja funkcije u rezultatu nalaze sve kolone tabele uposlenici. Provjeriti funkcioniranje funkcije unošenjem vrijednosti za parametar RazlikaKolicina = 27, pri èemu æe upit vraæati sume UnitPrice po PurchaseOrderID.
--Sortirati po sumiranim vrijednostima u opadajuæem redoslijedu.
 
GO
CREATE FUNCTION f_rejected
(
@RejectedQty DECIMAL (8,2)=0,
@RazlikaKolicina INT
)
RETURNS TABLE
AS
RETURN
       SELECT *
       FROM Kupovina
       WHERE  RejectedQty= @RejectedQty AND
                    RazlikaKolicina = @RazlikaKolicina
GO
 
SELECT DISTINCT RazlikaKolicina
FROM kupovina
 
--0.00
--62.00
--5.00
--3.00
--1.00
--280.00
--187.00
--27.00
--82.00
--9.00
 
 
SELECT PurchaseOrderID, SUM (UnitPrice)'Ukupno'
FROM f_rejected (DEFAULT, 27)
GROUP BY PurchaseOrderID
ORDER BY 2 DESC
 
--14.  Kreirati bazu Trigger_ i aktivirati je.
CREATE DATABASE Trigger_
GO
USE Trigger_
--15.  Kreirati tabelu Autori, te prilikom kreiranja uraditi insert podataka iz tabele Authors baze Pubs.
SELECT*
INTO Autori
FROM pubs.dbo.authors
--16.  16.    Kreirati tabelu Autori_log strukture:
       --- log_id int identity (1,1)
       --- au_id varchar (11)
       --- dogadjaj varchar (3)
       --- mod_date datetime
CREATE TABLE Autori_log
(
       log_id INT IDENTITY (1,1),
       au_id VARCHAR (11),
       dogadjaj VARCHAR (3),
       mod_date DATETIME
)
--17.  Nad tabelom Autori kreirati okidaè t_ins_autori kojim æe se prilikom inserta podataka u tabelu autori izvršiti insert podataka u tabelu Autori_log.
GO
CREATE TRIGGER t_ins_autori
ON Autori
AFTER INSERT
AS
BEGIN
       INSERT INTO autori_log
       SELECT au_id, 'ins', GETDATE ()
       FROM inserted
       --select * from inserted
       --select * from deleted
END
--18.  U tabelu Autori insertovati zapis
--'1', 'Ringer', 'Albert', '801 826-0752', '67 Seventh Av.', 'Salt Lake City', 'UT', 84152, 1
--'2', 'Green', 'Marjorie', '415 986-7020', '309 63rd St. #411', 'Oakland',      'CA', 94618, 1
--Provjeriti stanje u tabelama Autori i Autori_log.
INSERT INTO Autori
VALUES
('1', 'Ringer', 'Albert', '801 826-0752', '67 Seventh Av.', 'Salt Lake City', 'UT', 84152, 1),
('2', 'Green', 'Marjorie', '415 986-7020', '309 63rd St. #411', 'Oakland', 'CA', 94618, 1)
 
SELECT *
FROM Autori
 
SELECT *
FROM autori_log
--19.  Nad tabelom Autori kreirati okidaè t_upd_autori kojim æe se prilikom update podataka u tabeli Autori izvršiti insert podataka u tabelu autori_log.
GO
CREATE TRIGGER t_upd_autori
ON Autori
AFTER UPDATE
AS
BEGIN
       INSERT INTO Autori_log
       SELECT au_id, 'upd', GETDATE ()
       FROM   inserted
       SELECT * FROM inserted
       SELECT * FROM deleted
END
--20.  U tabeli autori napraviti update zapisa u kojem je au_id = 998-72-3567 tako što æe se vrijednost kolone au_lname postaviti na prezime. Provjeriti stanje u tabelama autori i autori_log.
UPDATE Autori
SET au_lname = 'prezime'
WHERE au_id = '998-72-3567'
 
SELECT * FROM autori
SELECT * FROM autori_log
--21.  Nad tabelom Autori kreirati okidaè t_del_autori kojim æe se prilikom brisanja podataka u tabeli Autori izvršiti insert podataka u tabelu Autori_log.
s
GO
CREATE TRIGGER t_del_autori
ON Autori
AFTER DELETE
AS
BEGIN
       INSERT INTO Autori_log
       SELECT au_id, 'del', GETDATE ()
       FROM   deleted
       SELECT * FROM inserted
       SELECT * FROM deleted
END
--22.  U tabeli Autori obrisati zapis u kojem je au_id = 3. Provjeriti stanje u tabelama Autori i Autori_log.
DELETE
FROM Autori
WHERE au_id = '2'
 
SELECT * FROM autori
SELECT * FROM autori_log
--23.  Kreirati tabelu Autori_instead_log strukture:
--     - log_id INT IDENTITY (1,1),
--     - au_id VARCHAR (11),
--     - dogadjaj VARCHAR (15),  
--     - mod_date datetime
 
CREATE TABLE Autori_instead_log
(
log_id INT IDENTITY (1,1),
au_id VARCHAR (11),
dogadjaj VARCHAR (15),
mod_date datetime
)
--24.  Nad tabelom autori kreirati okidaè t_instead_ins_autori kojim æe se onemoguæiti insert podataka u tabelu autori. Okidaè treba da vraæa poruku da insert nije izvršen.
GO
CREATE TRIGGER t_instead_ins_autori
ON Autori
INSTEAD OF INSERT
AS
BEGIN
       SELECT 'Insert nije izvršen'
       INSERT INTO Autori_instead_log
       SELECT au_id, 'not_insert', GETDATE ()
       FROM inserted
       SELECT * FROM inserted
       SELECT * FROM deleted
END
GO
--25.  U tabelu autori insertovati zapis
--'3', 'Ringer', 'Albert', '801 826-0752', '67 Seventh Av.', 'Salt Lake City', 'UT', 84152, 1
--Provjeriti stanje u tabelama autori, autori_log i autori_instead_log.
INSERT INTO Autori
VALUES ('3', 'Ringer', 'Albert', '801 826-0752', '67 Seventh Av.', 'Salt Lake City', 'UT', 84152, 1)
 
SELECT * FROM Autori
SELECT * FROM Autori_log
SELECT * FROM Autori_instead_log
--26.  Nad tabelom Autori kreirati okidaè t_instead_upd_autori kojim æe se onemoguæiti update podataka u tabelu Autori. Okidaè treba da vraæa poruku da update nije izvršen.
GO
CREATE TRIGGER t_instead_upd_autori
ON Autori
INSTEAD OF UPDATE
AS
BEGIN
       SELECT 'Update nije izvršen'
       INSERT INTO Autori_instead_log
       SELECT au_id, 'not_update', GETDATE ()
       FROM inserted
       SELECT * FROM inserted
       SELECT * FROM deleted
END
--27.  U tabeli Autori pokušati update zapisa u kojem je au_id = 172-32-1176 tako što æe se vrijednost kolone contract postaviti na  0. Provjeriti stanje u tabelama autori i autori_instead_log.
UPDATE Autori
SET contract = 0
WHERE au_id = '172-32-1176'
 
SELECT * FROM Autori
SELECT * FROM Autori_log
SELECT * FROM Autori_instead_log
--28.  Nad tabelom autori kreirati okidaè t_instead_del_autori kojim æe se onemoguæiti delete podataka u tabelu autori. Okidaè treba da vraæa poruku da delete nije izvršen.
--CHECK
GO
CREATE OR ALTER TRIGGER t_instead_del_autori
ON Autori
INSTEAD OF DELETE
AS
BEGIN
       SELECT 'Delete nije izvršen'
       INSERT INTO Autori_instead_log
       SELECT au_id, 'not_delete', GETDATE ()
       FROM deleted
       --SELECT * FROM inserted
       --SELECT * FROM deleted
END
--29.  U tabeli autori pokušati obrisati zapis u kojem je au_id = 172-32-1176. Provjeriti stanje u tabelama autori i autori_instead_log.
DELETE Autori
WHERE au_id = '172-32-1176'
 
SELECT * FROM Autori
SELECT * FROM Autori_log
SELECT * FROM Autori_instead_log
--30.  Iskljuæiti okidaè t_instead_ins_autori.
DISABLE TRIGGER t_instead_ins_autori ON Autori
--31.  U tabelu Autori insertovati zapis
--'3', 'Ringer', 'Albert', '801 826-0752', '67 Seventh Av.', 'Salt Lake City', 'UT', 84152, 1
--Provjeriti stanje u tabelama Autori, Autori_log i Autori_instead_log.
INSERT INTO Autori
VALUES ('3', 'Ringer', 'Albert', '801 826-0752', '67 Seventh Av.', 'Salt Lake City', 'UT', 84152, 1)
 
SELECT * FROM Autori
SELECT * FROM Autori_log
SELECT * FROM Autori_instead_log
 
--32.  Iskljuèiti sve okidaèe nad tabelom autori.
DISABLE TRIGGER ALL ON Autori
--33.  Ukljuèiti sve okidaèe nad tabelom autori.
ENABLE TRIGGER ALL ON Autori
 
 
 
 
--1.   Koristeæi bazu Northwind izdvojiti godinu, mjesec i dan datuma isporuke narudžbe.
SELECT YEAR(O.ShippedDate) AS Godina, MONTH(O.ShippedDate) AS Mjesec, DAY(O.ShippedDate) AS Dan
FROM Northwind.dbo.Orders AS O
--2.   Koristeæi bazu Northwind izraèunati koliko je vremena prošlo od datum narudžbe do danas.
USE Northwind
SELECT DATEDIFF(YEAR,O.OrderDate,GETDATE()) AS 'Broj godina'
FROM Orders AS O
--3.   Koristeæi bazu Northwind dohvatiti sve zapise u kojima ime zaposlenika poèinje slovom A.
SELECT*
FROM Employees AS E
WHERE E.FirstName LIKE 'A%'
--4.   Koristeæi bazu Pubs dohvatiti sve zapise u kojima ime zaposlenika poèinje slovom A ili M.
SELECT*
FROM pubs.dbo.employee AS E
WHERE E.fname LIKE 'A%' OR E.fname LIKE 'M%'
 
--%    Represents zero or more characters      bl% finds bl, black, blue, and blob
--_    Represents a single character     h_t finds hot, hat, and hit
--[]   Represents any single character within the brackets   h[oa]t finds hot and hat, but not hit
--^    Represents any character not in the brackets   h[^oa]t finds hit, but not hot and hat
---    Represents any single character within the specified range   c[a-b]t finds cat and cbt
SELECT*
FROM pubs.dbo.employee AS E
WHERE E.fname LIKE '[AM]%'
 
--5.   Koristeæi bazu Northwind prikazati sve kupce koje u koloni ContactTitle sadrže pojam ""manager"".
SELECT*
FROM Customers AS C
WHERE C.ContactTitle LIKE '%manager%'
--6.   Koristeæi bazu Northwind dohvatiti sve kupce kod kojih se poštanski broj sastoji samo od cifara.
SELECT*
FROM Customers AS C
WHERE C.PostalCode LIKE '[0-9]%' AND C.PostalCode NOT LIKE '%-%'
 
SELECT*
FROM Customers AS C
WHERE C.PostalCode NOT LIKE '%[^0-9]%'
 
SELECT*
FROM Customers AS C
WHERE ISNUMERIC(C.PostalCode)=1
 
--7.   Iz tabele Person.Person baze AdventureWorks2017 u bazu Vjezba2 u tabelu Osoba kopirati kolone FirstName, MiddleName i LastName. Prikazati spojeno ime, srednje ime i prezime.Uslov je da se izmeðu pojedinih segmenata nalazi space. Omoguæiti prikaz podataka i ako neki od podataka nije unijet. Prikazati samo jedinstvene zapise (bez ponavljanja istih zapisa).
 
USE Vjezba2
 
SELECT PP.FirstName,PP.MiddleName,PP.LastName
INTO Osoba
FROM AdventureWorks2017.Person.Person AS PP
 
SELECT O.FirstName + ' ' +ISNULL(O.MiddleName,' ')+ ' ' + O.LastName
FROM Osoba AS O
 
UPDATE Osoba
SET MiddleName=' '
WHERE MiddleName IS NULL
 
SELECT DISTINCT O.FirstName + ' ' + O.MiddleName + ' ' + O.LastName
FROM Osoba AS O
 
SELECT DISTINCT CONCAT(PP.FirstName,' ',PP.MiddleName,' ',PP.LastName)
FROM AdventureWorks2017.Person.Person AS PP
 
--8.   Prikazati listu zaposlenika sa sljedeæim atributima: ID, ime, prezime, država i titula, gdje je ID = 9 ili dolaze iz USA.
SELECT E.EmployeeID,E.FirstName,E.LastName,E.Country,E.Title
FROM Northwind.dbo.Employees AS E
WHERE E.EmployeeID=9 OR E.Country LIKE 'USA'
--WHERE
--9.   Prikazati podatke o narudžbama koje su napravljene prije 19.07.1996. godine. Izlaz treba da sadrži sljedeæe kolone: ID narudžbe, datum narudžbe, ID kupca, te grad.
USE Northwind
SELECT O.OrderID,O.OrderDate,O.CustomerID,O.ShipCity
FROM Orders AS O
WHERE O.OrderDate<'1996-07-19'
--10.  Prikazati stavke narudžbe gdje je kolièina narudžbe bila veæa od 100 komada uz odobreni popust.
SELECT*
FROM [Order Details] AS OD
WHERE OD.Quantity>100 AND OD.Discount>0
--11.  Prikazati ime kompanije kupca i kontakt telefon i to samo onih koji u svome imenu posjeduju rijeè „Restaurant“. Ukoliko naziv kompanije sadrži karakter (-), kupce izbaciti iz rezultata upita.
SELECT C.CompanyName,C.Phone
FROM Customers AS C
WHERE C.CompanyName LIKE '%Restaurant%' AND C.CompanyName NOT LIKE '%-%'
--12.  Prikazati proizvode èiji naziv poèinje slovima „C“ ili „G“, drugo slovo može biti bilo koje, a treæe slovo u nazivu je „A“ ili „O“.
SELECT*
FROM Products AS P
WHERE P.ProductName LIKE '[CG]_[ao]%'
--13.  Prikazati listu proizvoda èiji naziv poèinje slovima „L“ ili „T“, ili je ID proizvoda = 46. Lista treba da sadrži samo one proizvode èija se cijena po komadu kreæe izmeðu 10 i 50 (ukljuèujuæi graniène vrijednosti). Upit napisati na dva naèina.
SELECT *
FROM Products AS P
WHERE (P.ProductName LIKE '[LT]%' OR P.ProductID=46) AND P.UnitPrice BETWEEN 10 AND 50
 
SELECT *
FROM Products AS P
WHERE (P.ProductName LIKE '[LT]%' OR P.ProductID=46) AND P.UnitPrice>=10 AND P.UnitPrice<=50
 
--14.  Prikazati naziv proizvoda i cijenu gdje je stanje na zalihama manje od naruèene kolièine. Takoðer, u rezultate upita ukljuèiti razliku izmeðu naruèene kolièine i stanja zaliha.
SELECT P.ProductName,P.UnitPrice,P.UnitsInStock-P.UnitsOnOrder AS Razlika
FROM Products AS P
WHERE P.UnitsInStock<P.UnitsOnOrder
--15.  Prikazati dobavljaèe koji dolaze iz Španije ili Njemaèke a nemaju unesen broj faxa. Formatirati izlaz NULL vrijednosti. Upit napisati na dva naèina
SELECT S.SupplierID,S.CompanyName,S.ContactName,S.ContactTitle,S.Address,S.City,S.Region,S.PostalCode,S.Country,S.Phone,ISNULL(S.Fax,'nepoznata vrijednost') AS Fax,S.HomePage
FROM Suppliers AS S
WHERE S.Country IN ('Spain','Germany') AND S.Fax IS NULL
 
SELECT S.SupplierID,S.CompanyName,S.ContactName,S.ContactTitle,S.Address,S.City,S.Region,S.PostalCode,S.Country,S.Phone,ISNULL(S.Fax,'nepoznata vrijednost') AS Fax,S.HomePage
FROM Suppliers AS S
WHERE (S.Country LIKE'Spain'OR S.Country LIKE'Germany') AND S.Fax IS NULL
 
--16.  Prikazati listu autora sa sljedeæim kolonama: ID, ime i prezime (spojeno), grad i to samo one autore èiji ID poèinje brojem 8 ili dolaze iz grada „Salt Lake City“. Takoðer autorima status ugovora treba biti 1. Koristiti aliase nad kolonama.
USE pubs
SELECT A.au_id, A.au_fname +' '+A.au_lname AS 'ime prezime', A.city,A.contract
FROM authors AS A
WHERE (A.au_id LIKE '8%' OR A.city LIKE 'Salt Lake City') AND A.contract=1
--17.  Prikazati sve tipove knjiga bez duplikata. Listu sortirati po tipu.
SELECT DISTINCT T.type
FROM titles AS T
ORDER BY T.type
--18.  Prikazati listu prodaje knjiga sa sljedeæim kolonama: ID prodavnice, broj narudžbe i kolièinu, ali samo gdje je kolièina izmeðu 10 i 50, ukljuèujuæi i graniène vrijednosti. Rezultat upita sortirati po kolièini opadajuæim redoslijedom. Upit napisati na dva naèina.
SELECT S.stor_id,S.ord_num,S.qty AS Kolicina
FROM sales AS S
WHERE S.qty BETWEEN 10 AND 50
ORDER BY 3 DESC
--19.  Prikazati listu knjiga sa sljedeæim kolonama: naslov, tip djela i cijenu. Kao novu kolonu dodati 20% od prikazane cijene (npr. Ako je cijena 19.99 u novoj koloni treba da piše 3,998). Naziv kolone se treba zvati „20% od cijene“. Listu sortirati abecedno po tipu djela i po cijeni opadajuæim redoslijedom. Sa liste eliminisati one vrijednosti koje u polju cijena imaju nepoznatu vrijednost. Modifikovati upit tako da prikaže cijenu umanjenu za 20 %. Naziv kolone treba da se zove „Cijena umanjena za 20%“.
SELECT T.title,T.type,T.price,T.price*0.2 '20% od cijene', T.price*(1-0.2)'Cijena umanjena za 20%'
FROM titles AS T
WHERE T.price IS NOT NULL
ORDER BY 2,3
--20.  Prikazati 10 kolièinski najveæih stavki prodaje. Lista treba da sadrži broj narudžbe, datum narudžbe i kolièinu. Provjeriti da li ima više stavki sa kolièinom kao posljednja u listi
USE pubs
SELECT TOP 10 WITH TIES S.ord_num,S.ord_date,S.qty
FROM sales AS S
ORDER BY 3 DESC
 
 
 
 
 
 
 
 
--Vježba 10 :: Zadaci
 
--1.   a) Upotrebom podupita iz tabele Customers baze Northwind
--dati prikaz svih polja tabele pri èemu je kupac iz Berlina.
--b) Upotrebom podupita iz tabele Customers baze Northwind dati prikaz svih polja tabele pri èemu je kupac iz Londona ili Berlina.
--A
USE Northwind
SELECT*
FROM Customers AS C
WHERE C.City LIKE (SELECT C.City
                           FROM Customers AS C
                           WHERE C.City='Berlin')
--B
SELECT*
FROM Customers AS C
WHERE C.City IN (SELECT C.City
                           FROM Customers AS C
                           WHERE C.City='Berlin' OR C.City='London')
 
 
--2.   Prikazati srednju vrijednost nabavljene kolièine, u obzir uzeti samo one zapise
--u kojima je vrijednost UnitPrice izmeðu 50 i 100 (ukljuèujuæi graniène
--vrijednosti). (AdventureWorks2017)
 
USE AdventureWorks2017
 
SELECT AVG(PP.OrderQty) 'Srednja vrijednost naruèene kolièine'
FROM Purchasing.PurchaseOrderDetail AS PP
WHERE PP.UnitPrice BETWEEN 50 AND 100
 
SELECT AVG(PodQ.OrderQty) 'Srednja vrijednost naruèene kolièine'
FROM (SELECT PP.OrderQty
         FROM Purchasing.PurchaseOrderDetail AS PP
         WHERE PP.UnitPrice BETWEEN 50 AND 100) AS PodQ
 
--3.Prikazati ID narudžbe(i) u kojima je naruèena kolièina jednaka minimalnoj, odnosno, maksimalnoj vrijednosti svih naruèenih kolièina. (Northwind)     
USE Northwind
 
SELECT MIN(OD.Quantity) 'MIN', MAX(OD.Quantity)'MAX'
FROM [Order Details] AS OD
--MIN 1
--MAX 130
--NAÈIN 1
SELECT DISTINCT OD.OrderID, OD.Quantity
FROM [Order Details] AS OD
WHERE OD.Quantity=(SELECT MIN(OD.Quantity)
                                  FROM [Order Details] AS OD) OR OD.Quantity=(SELECT MAX(OD.Quantity)
                                                                                                            FROM [Order Details] AS OD)
--NAÈIN 2
SELECT OD.OrderID, OD.Quantity
FROM [Order Details] AS OD
WHERE OD.Quantity=(SELECT MIN(OD.Quantity)
                                  FROM [Order Details] AS OD)
UNION
SELECT OD.OrderID, OD.Quantity
FROM [Order Details] AS OD
WHERE OD.Quantity=(SELECT MAX(OD.Quantity)
                                  FROM [Order Details] AS OD)
 
--4.   Prikazati  ID narudžbe i ID kupca koji je kupio više od 10 komada proizvoda èiji je ID 15. (Northwind)
SELECT O.OrderID,O.CustomerID
FROM Orders as O
WHERE ( SELECT Quantity
             FROM [Order Details] AS OD       
             WHERE O.OrderID=OD.OrderID AND OD.ProductID=15)>10
 
USE Northwind
SELECT O.OrderID,O.CustomerID, OD.Quantity
FROM Orders AS O
INNER JOIN [Order Details] AS OD
ON O.OrderID=OD.OrderID
WHERE  OD.ProductID=15 AND OD.Quantity>10
 
--5.   Prikazati sve osobe koje nemaju prihode, vanredni i redovni. (Prihodi)
USE prihodi
SELECT O.OsobaID, o.Ime
FROM Osoba AS O
WHERE NOT EXISTS  (SELECT VP.OsobaID
                              FROM VanredniPrihodi AS VP
                                  WHERE VP.OsobaID=O.OsobaID) AND NOT EXISTS (SELECT RP.OsobaID
                                                                                                            FROM RedovniPrihodi AS RP
                                                                                                            WHERE RP.OsobaID=O.OsobaID)
 
SELECT O.OsobaID, O.Ime
FROM Osoba AS O
LEFT JOIN VanredniPrihodi AS VP
ON VP.OsobaID=O.OsobaID
WHERE VP.OsobaID IS NULL
INTERSECT
SELECT O.OsobaID, O.Ime
FROM Osoba AS O
LEFT JOIN RedovniPrihodi AS RP
ON RP.OsobaID=O.OsobaID
WHERE RP.OsobaID IS NULL
 
--6.   Dati prikaz ID narudžbe, ID proizvoda i jediniène cijene, te razliku cijene u odnosu na srednju vrijednost cijene za sve stavke. Rezultat sortirati prema vrijednosti razlike u rastuæem redoslijedu.  (Northwind)
USE Northwind
SELECT OD.OrderID,OD.ProductID,OD.UnitPrice,
(SELECT AVG(OD.UnitPrice)
FROM [Order Details] AS OD) 'Srednja vrijednost',
OD.UnitPrice-(SELECT AVG(OD.UnitPrice)
                      FROM [Order Details] AS OD) 'Razlika'
FROM [Order Details] AS OD
ORDER BY 5
 
--7.   Za sve proizvode kojih ima na stanju dati prikaz ID proizvoda, naziv proizvoda i stanje zaliha, te razliku stanja zaliha proizvoda u odnosu na srednju vrijednost stanja za sve proizvode u tabeli. Rezultat sortirati prema vrijednosti razlike u opadajuæem redoslijedu. (Northwind)
SELECT P.ProductID,P.ProductName,P.UnitsInStock, P.UnitsInStock -(SELECT AVG(P.UnitsInStock)
                                                                                                                  FROM Products AS P) 'Razlika'
FROM Products AS P
WHERE P.UnitsInStock>0
ORDER BY 4 DESC
 
--8.   Prikazati po 5 najstarijih zaposlenika muškog, odnosno, ženskog spola uz navoðenje sljedeæih podataka: radno mjesto na kojem se nalazi, datum roðenja, korisnicko ime i godine starosti. Korisnièko ime je dio podatka u LoginID. Rezultate sortirati prema polu rastuæim, a zatim prema godinama starosti opadajuæim redoslijedom. (AdventureWorks2017)
USE AdventureWorks2017
SELECT *
FROM(SELECT TOP 5 E.JobTitle, E.BirthDate, E.LoginID, DATEDIFF(YEAR, E.BirthDate, GETDATE())'Godine starosti', E.Gender
FROM HumanResources.Employee AS E
WHERE E.Gender='F'
ORDER BY 4 DESC) AS F
UNION
SELECT*
FROM(SELECT TOP 5 E.JobTitle, E.BirthDate, E.LoginID, DATEDIFF(YEAR, E.BirthDate, GETDATE())'Godine starosti', E.Gender
FROM HumanResources.Employee AS E
WHERE E.Gender='M'
ORDER BY 4 DESC) AS M
ORDER BY 5, 4 DESC
 
 
 
 
--9.   Prikazati po 3 zaposlenika koji obavljaju poslove managera uz navoðenje sljedeæih podataka: radno mjesto na kojem se nalazi, datum zaposlenja, braèni status i staž. Ako osoba nije u braku plaæa dodatni porez (upitom naglasiti to), inaèe ne plaæa. Rezultate sortirati prema braènom statusu rastuæim, a zatim prema stažu opadajuæim redoslijedom. (AdventureWorks2017)
SELECT TOP 3 E.JobTitle,E.HireDate,E.MaritalStatus,DATEDIFF(YEAR, E.HireDate,GETDATE()) 'Godine staza', 'Placa dodatni porez' Porez
FROM HumanResources.Employee AS E
WHERE E.JobTitle LIKE '%manager%' AND E.MaritalStatus ='S'
UNION
SELECT TOP 3 E.JobTitle,E.HireDate,E.MaritalStatus,DATEDIFF(YEAR, E.HireDate,GETDATE()) 'Godine staza', ' ' Porez
FROM HumanResources.Employee AS E
WHERE E.JobTitle LIKE '%manager%' AND E.MaritalStatus ='M'
ORDER BY 3, [Godine staza] DESC
 
 
--10.  Prikazati po 5 osoba koje se nalaze na 1, odnosno, 4.  organizacionom nivou, uposlenici su i žele primati email ponude od AdventureWorksa uz navoðenje sljedeæih polja: ime i prezime osobe kao jedinstveno polje, organizacijski nivo na kojem se nalazi i da li prima email promocije. Pored ovih uvesti i polje koje æe sadržavati poruke: Ne prima (0), Prima selektirane (1) i Prima (2). Sadržaj novog polja ovisi o vrijednosti polja EmailPromotion. Rezultat sortirati prema organizacijskom nivou i dodatno uvedenom polju. (AdventureWorks2017)
SELECT TOP 5 PP.FirstName +' ' +PP.LastName 'Ime i prezime', E.OrganizationLevel,PP.EmailPromotion, 'Ne prima' Prima
FROM HumanResources.Employee AS E
INNER JOIN Person.Person AS PP
ON E.BusinessEntityID=PP.BusinessEntityID
WHERE (E.OrganizationLevel=1 OR E.OrganizationLevel=4) AND PP.EmailPromotion=0
UNION
SELECT TOP 5 PP.FirstName +' ' +PP.LastName 'Ime i prezime', E.OrganizationLevel,PP.EmailPromotion, 'Prima selektirane' Prima
FROM HumanResources.Employee AS E
INNER JOIN Person.Person AS PP
ON E.BusinessEntityID=PP.BusinessEntityID
WHERE (E.OrganizationLevel=1 OR E.OrganizationLevel=4) AND PP.EmailPromotion=1
UNION
SELECT TOP 5 PP.FirstName +' ' +PP.LastName 'Ime i prezime', E.OrganizationLevel,PP.EmailPromotion, 'Prima email promocije' Prima
FROM HumanResources.Employee AS E
INNER JOIN Person.Person AS PP
ON E.BusinessEntityID=PP.BusinessEntityID
WHERE (E.OrganizationLevel=1 OR E.OrganizationLevel=4) AND PP.EmailPromotion=2
ORDER BY 2 ,4
 
--11.  Prikazati broj narudžbe, datum narudžbe i datum isporuke za narudžbe koje su isporuèene u Kanadu u 7. mjesecu 2014. godine. Uzeti u obzir samo narudžbe koje nisu plaæene kreditnom karticom. Datume formatirati u sljedeæem obliku: dd.mm.yyyy. (AdventureWorks2017)
SELECT SOH.SalesOrderID, FORMAT(SOH.OrderDate,'dd.MM.yyyy') 'Order date',FORMAT( SOH.ShipDate,'dd.MM.yyyy') 'Ship date'
FROM Sales.SalesOrderHeader AS SOH
INNER JOIN Sales.SalesTerritory AS ST
ON ST.TerritoryID=SOH.TerritoryID
WHERE ST.Name LIKE 'Canada' AND YEAR(SOH.ShipDate)=2014 AND MONTH(SOH.ShipDate)=7 AND SOH.CreditCardID IS NULL
 
 
--12.  Kreirati upit koji prikazuje minimalnu, maksimalnu, prosjeènu te ukupnu vrijednost stavke po mjesecima u 2013. godini. (AdventureWorks2017)
SELECT MONTH(SOH.OrderDate) 'Mjesec',AVG(SOD.LineTotal) 'Prosjek', MIN(SOD.LineTotal) 'Minimalna', MAX(SOD.LineTotal) 'Maksimalna'
FROM Sales.SalesOrderDetail AS SOD
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOD.SalesOrderID=SOH.SalesOrderID
WHERE YEAR(SOH.OrderDate)=2013
GROUP BY MONTH(SOH.OrderDate)
ORDER BY 1
 
SELECT MONTH(SOH.OrderDate) 'Mjesec',AVG(SOD.UnitPrice*SOD.OrderQty) 'Prosjek', MIN(SOD.UnitPrice*SOD.OrderQty) 'Minimalna', MAX(SOD.UnitPrice*SOD.OrderQty) 'Maksimalna'
FROM Sales.SalesOrderDetail AS SOD
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOD.SalesOrderID=SOH.SalesOrderID
WHERE YEAR(SOH.OrderDate)=2013
GROUP BY MONTH(SOH.OrderDate)
ORDER BY 1
 
--13.  Kreirati upit koji prikazuje ime i prezime, korisnièko ime (sve iza znaka „\“ u koloni LoginID), dužinu korisnièkog imena, titulu, datum zaposlenja (dd.mm.yyyy), starost i staž zaposlenika. Uslov je da se prikaže 10 najstarijih zaposlenika koji obavljaju bilo koju ulogu menadžera. (AdventureWorks2017)
SELECT TOP 10 PP.FirstName+ ' '+PP.LastName 'Ime i prezime', RIGHT(E.LoginID, CHARINDEX('\',REVERSE(E.LoginID))-1) 'Korisnièko ime', LEN(RIGHT(E.LoginID, CHARINDEX('\',REVERSE(E.LoginID))-1)) 'Dužina korisnièkog imena', E.JobTitle, FORMAT(E.HireDate,'dd.MM.yyyy') 'Datum zaposlenja', DATEDIFF(YEAR,E.BirthDate,GETDATE()) 'Starost', DATEDIFF(YEAR, E.HireDate,GETDATE()) 'Staž'
FROM Person.Person AS PP
INNER JOIN HumanResources.Employee AS E
ON E.BusinessEntityID=PP.BusinessEntityID
WHERE E.JobTitle LIKE '%Manager%'
ORDER BY Starost DESC
 
--14.  Kreirati upit koji prikazuje 10 najskupljih stavki prodaje (detalji narudžbe) i to sljedeæe kolone: naziv proizvoda, kolièina, cijena, iznos. Cijenu i iznos zaokružiti na dvije decimale. Takoðer, kolièinu prikazati u formatu „10 kom.“, a cijenu i iznos u formatu „1000 KM“. (AdventureWorks2017)
SELECT TOP 10 PP.Name,CAST(SOD.OrderQty AS VARCHAR) +' kom' 'Kolicina',CAST(SOD.UnitPrice AS VARCHAR) +' KM' 'Cijena',CAST(SUM(SOD.UnitPrice*SOD.OrderQty) AS VARCHAR) +' KM' 'Iznos'
FROM Sales.SalesOrderDetail AS SOD
INNER JOIN Production.Product AS PP
ON SOD.ProductID=PP.ProductID
GROUP BY PP.Name,SOD.OrderQty,SOD.UnitPrice
ORDER BY 3 DESC
 
--15.  Kreirati upit koji prikazuje naziv modela i opis modela proizvoda. Uslov je da naziv modela sadrži rijeè „Mountain“, dok je opis potrebno prikazati samo na engleskom jeziku. (AdventureWorks2017)
SELECT PM.Name,PD.Description
FROM Production.ProductModel AS PM
INNER JOIN Production.ProductModelProductDescriptionCulture AS PMPDC
ON PM.ProductModelID=PMPDC.ProductModelID
INNER JOIN Production.ProductDescription AS PD
ON PD.ProductDescriptionID=PMPDC.ProductDescriptionID
INNER JOIN Production.Culture AS C
ON C.CultureID=PMPDC.CultureID
WHERE C.Name LIKE 'English' AND PM.Name LIKE '%Mountain%'
 
--16.  Kreirati upit koji prikazuje broj, naziv i cijenu proizvoda, te stanje zaliha po lokacijama. Uzeti u obzir samo proizvode koji pripadaju kategoriji „Bikes“. Izlaz sortirati po stanju zaliha u opadajuæem redoslijedu. (AdventureWorks2017)
SELECT PP.ProductNumber,PP.Name,PP.ListPrice,PL.Name,SUM(PI.Quantity) 'Stanje zaliha'
FROM Production.Product AS PP
INNER JOIN Production.ProductInventory AS PI
ON PP.ProductID=PI.ProductID
INNER JOIN Production.Location AS PL
ON PI.LocationID=PL.LocationID
INNER JOIN Production.ProductSubcategory AS PS
ON PP.ProductSubcategoryID=PS.ProductSubcategoryID
INNER JOIN Production.ProductCategory AS PC
ON PS.ProductCategoryID=PC.ProductCategoryID
WHERE PC.Name LIKE 'Bikes'
GROUP BY PP.ProductNumber,PP.Name,PP.ListPrice,PL.Name
ORDER BY 5 DESC
 
--17.  Kreirati upit koji prikazuje ukupno ostvarenu zaradu bez popusta po zaposleniku, za robu isporuèenu na podruèje Evrope, u januaru mjesecu 2014. godine. Lista treba da sadrži ime i prezime zaposlenika, datum zaposlenja (dd.mm.yyyy), mail adresu, te ukupnu ostvarenu zaradu zaokruženu na dvije decimale. Izlaz sortirati po zaradi u opadajuæem redoslijedu. (AdventureWorks2017)  
SELECT PP.FirstName + ' '+ PP.LastName 'Ime i prezime zaposlenika', FORMAT(E.HireDate,'dd.MM.yyyy') 'Datum zaposlenja',E.HireDate,EA.EmailAddress,ROUND(SUM(SOD.UnitPrice*SOD.OrderQty),2)'Ukupna zarada'
FROM HumanResources.Employee AS E
INNER JOIN Person.Person AS PP
ON E.BusinessEntityID=PP.BusinessEntityID
INNER JOIN Person.EmailAddress AS EA
ON PP.BusinessEntityID=EA.BusinessEntityID
INNER JOIN Sales.SalesPerson AS SP
ON E.BusinessEntityID=SP.BusinessEntityID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOH.SalesPersonID=SP.BusinessEntityID
INNER JOIN Sales.SalesOrderDetail AS SOD
ON SOD.SalesOrderID=SOH.SalesOrderID
INNER JOIN Sales.SalesTerritory AS ST
ON SOH.TerritoryID=ST.TerritoryID
WHERE ST.[Group]='Europe' AND YEAR(SOH.OrderDate)=2014 AND MONTH(SOH.OrderDate)=1
GROUP BY PP.FirstName + ' '+ PP.LastName,FORMAT(E.HireDate,'dd.MM.yyyy'),E.HireDate,EA.EmailAddress
ORDER BY [Ukupna zarada] DESC
 
 
 
--FUNKCIJE ZA RAD SA STRINGOVIMA
SELECT LEFT('Softverski inzinjering',2)  --REZULTAT: SO
SELECT RIGHT('Softverski inzinjering',11)  --REZULTAT: INZINJERING
SELECT CHARINDEX(' ','Sofrverski inzinjering') --REZULTAT: 11
SELECT PATINDEX('%[0-9]%','FITCC2022') --REZULTAT 6
SELECT SUBSTRING('Sofrverski inzinjering',11+1,11) --REZULTAT: INZINJERING
SELECT UPPER('Sofrverski inzinjering') --REZULTAT: INZINJERING
SELECT LOWER('Sofrverski inzinjering') --REZULTAT: inzinjering
SELECT LEN('Sofrverski inzinjering') --REZULTAT: 22
SELECT REPLACE('Sofrverski inzinjering','i','XY') --REZULTAT:SofrverskXY XYnzXYnjerXYng
SELECT STUFF('Softverski inzinjering',3,2,'XY') --REZULTAT: SoXYverski inzinjering
SELECT STR(122)+ '.' --REZULTAT: 122.
SELECT REVERSE('Softverski inzinjering') --REZULTAT: gnirejnizni iksrevtfoS
 
 
--Vježba 9_1 :: Zadaci
 
--1.   Iz tabele HumanResources.Employee baze AdventureWorks2017 iz kolone LoginID izvuæi ime uposlenika.
SELECT E.LoginID, SUBSTRING(E.LoginID,CHARINDEX('\',E.LoginID)+1,LEN(E.LoginID)-CHARINDEX('\',E.LoginID)-1) AS 'Ime uposlenika'
FROM AdventureWorks2017.HumanResources.Employee AS E
 
--2.   Kreirati upit koji prikazuje podatke o zaposlenicima. Lista treba da sadrži sljedeæe kolone: ID uposlenika, korisnièko ime i novu lozinku:
--Uslovi su sljedeæi:
--•    Za korisnièko ime potrebno je koristiti kolonu LoginID (tabela Employees). Npr. LoginID zaposlenika sa imenom i prezimenom 'Mary Gibson' je adventureworks\mary0. Korisnièko ime zaposlenika je sve što se nalazi iza znaka \ (backslash) što je u ovom primjeru mary0,
--•    Nova lozinka se formira koristeæi hešovanu lozinku zaposlenika na sljedeæi naèin: o Hešovanu lozinku potrebno je okrenuti obrnuto (npr. dbms2015 -> 5102smbd) o Nakon toga preskaèemo prvih 5 i uzimamo narednih 8 karaktera
--•    Sljedeæi korak jeste da iz dobivenog stringa poèevši od drugog karaktera naredna dva zamijenimo sa X# (npr. ako je dobiveni string dbms2015 izlaz æe biti dX#s2015)
--RJEŠENJE 1
SELECT *,RIGHT(E.LoginID,CHARINDEX('\',REVERSE(E.LoginID))-1) AS 'Korisnicko ime',
REPLACE(SUBSTRING(REVERSE(E.rowguid),6,7),SUBSTRING(SUBSTRING(REVERSE(E.rowguid),6,8),2,3),'X#')
FROM AdventureWorks2017.HumanResources.Employee AS E
--RJEŠENJE 2
SELECT *,RIGHT(E.LoginID,CHARINDEX('\',REVERSE(E.LoginID))-1) AS 'Korisnicko ime',
STUFF(SUBSTRING(REVERSE(E.rowguid),6,8),2,2,'X#') 'Nova lozinka'
FROM AdventureWorks2017.HumanResources.Employee AS E
 
--3.   Iz tabele Sales.Customer baze AdventureWorks2017 iz kolone AccountNumber izvuæi broj pri èemu je potrebno broj prikazati bez vodeæih nula.
--a) dohvatiti sve zapise
--b) dohvatiti one zapise kojima je unijet podatak u kolonu PersonID
--a
SELECT C.AccountNumber, CAST(RIGHT(C.AccountNumber,PATINDEX('%[A-Z]%',REVERSE(C.AccountNumber))-1) AS INT)
FROM AdventureWorks2017.Sales.Customer AS C
--b
SELECT C.AccountNumber, CAST(RIGHT(C.AccountNumber,PATINDEX('%[A-Z]%',REVERSE(C.AccountNumber))-1) AS INT)
FROM AdventureWorks2017.Sales.Customer AS C
WHERE C.PersonID IS NOT NULL
 
--4.   Iz tabele Purchasing.Vendor baze AdventureWorks2017 dohvatiti zapise u kojima se podatak u koloni AccountNumber formirao iz prve rijeèi kolone Name.
--1.RJEŠENJE
SELECT PV.AccountNumber,PV.Name,LEFT(PV.AccountNumber,CHARINDEX('0',PV.AccountNumber)-1), LEFT(PV.Name+' ',CHARINDEX(' ',PV.Name+ ' ')-1)
FROM AdventureWorks2017.Purchasing.Vendor AS PV
WHERE LEFT(PV.AccountNumber,CHARINDEX('0',PV.AccountNumber)-1)=LEFT(PV.Name+' ',CHARINDEX(' ',PV.Name+ ' ')-1)
--2.RJEŠENJE
SELECT PV.AccountNumber,PV.Name,LEFT(PV.AccountNumber,CHARINDEX('0',PV.AccountNumber)-1), IIF(CHARINDEX(' ',PV.Name)=0,PV.Name,LEFT(PV.Name,CHARINDEX(' ',PV.Name)-1))
FROM AdventureWorks2017.Purchasing.Vendor AS PV
WHERE LEFT(PV.AccountNumber,CHARINDEX('0',PV.AccountNumber)-1)=IIF(CHARINDEX(' ',PV.Name)=0,PV.Name,LEFT(PV.Name,CHARINDEX(' ',PV.Name)-1))
--3 RJEŠENJE
SELECT PV.AccountNumber,PV.Name,LEFT(PV.AccountNumber,PATINDEX('%[0-9]%',PV.AccountNumber)-1), IIF(CHARINDEX(' ',PV.Name)=0,PV.Name,LEFT(PV.Name,CHARINDEX(' ',PV.Name)-1))
FROM AdventureWorks2017.Purchasing.Vendor AS PV
WHERE LEFT(PV.AccountNumber,PATINDEX('%[0-9]%',PV.AccountNumber)-1)=IIF(CHARINDEX(' ',PV.Name)=0,PV.Name,LEFT(PV.Name,CHARINDEX(' ',PV.Name)-1))
 
--5.   Koristeæi bazu Northwind kreirati upit koji æe prikazati odvojeno ime i prezime, naziv firme te državu i grad kupca ali samo onih èija adresa završava sa 2 ili više cifre. U rezultate upita ne treba ukljuèiti one koje u polju ContactName imaju 2 ili više rijeèi
SELECT LEFT(C.ContactName,CHARINDEX(' ',C.ContactName)-1) AS Ime, RIGHT(C.ContactName,CHARINDEX(' ',REVERSE(C.ContactName))-1) AS Prezime, C.CompanyName ,C.ContactName,C.Address
FROM Northwind.dbo.Customers AS C
WHERE IIF(ISNUMERIC(RIGHT(C.Address,CHARINDEX(' ',REVERSE(C.Address))-1))=1,RIGHT(C.Address,CHARINDEX(' ',REVERSE(C.Address))-1),0)>=10 AND LEN(C.ContactName)-LEN(REPLACE(C.ContactName,' ',''))=1
 
 
--ILI
 
SELECT LEFT(C.ContactName,CHARINDEX(' ',C.ContactName)-1) AS Ime, RIGHT(C.ContactName,CHARINDEX(' ',REVERSE(C.ContactName))-1) AS Prezime, C.CompanyName ,C.ContactName,C.Address
FROM Northwind.dbo.Customers AS C
WHERE RIGHT(C.Address,CHARINDEX(' ',REVERSE(C.Address))-1) NOT LIKE '%[^0-9]%' AND LEN(RIGHT(C.Address,CHARINDEX(' ',REVERSE(C.Address))-1))>=2 AND LEN(C.ContactName)-LEN(REPLACE(C.ContactName,' ',''))=1
--6.   Koristeæi bazu Northwind u tabeli Customers dodati izraèunato polje Spol u koji æe se upitom pohraniti vrijednost da li se radi o muškarcu ili ženi (M ili F). Vrijednost na osnovu koje se odreðuje to o kojem se spolu radi nalazi se u koloni ContactName gdje zadnje slovo prve rijeèi odreðuje spol (rijeèi koje se završavaju slovom a predstavljaju osobe ženskog spola).
--SELECT I PROVJERA ISPRAVNOSTI ZAPISA
SELECT C.ContactName,IIF(RIGHT(LEFT(C.ContactName,CHARINDEX(' ',C.ContactName)-1),1)='a','F','M')
FROM Northwind.dbo.Customers AS C
--COMPUTED FIELD
ALTER TABLE Northwind.dbo.Customers
ADD Spol2 AS IIF(RIGHT(LEFT(ContactName,CHARINDEX(' ',ContactName)-1),1)='a','F','M')
 
 
 
--1.   U tabeli Customers baze Northwind ID kupca je primarni kljuè.
--U tabeli Orders baze Northwind ID kupca je vanjski kljuè.
--Prikazati:
--a)   Koliko je kupaca evidentirano u obje tabele
--b)   Da li su svi kupci obavili narudžbu
--c)   Ukoliko postoje neki da nisu prikazati koji su to
USE Northwind
--A
--UNIJOM PROVJERAVAMO KOLIKO JE KUPACA EVIDENTIRANO-BROJ KUPACA
SELECT C.CustomerID
FROM Customers AS C
UNION
SELECT O.CustomerID
FROM Orders AS O
--B
--INTERSECTOM MOŽEMO PROVJERITI DA LI SU SVI KUPCI OBAVILI NARUDŽBU
SELECT C.CustomerID
FROM Customers AS C
INTERSECT
SELECT O.CustomerID
FROM Orders AS O
--C
SELECT C.CustomerID
FROM Customers AS C
EXCEPT
SELECT O.CustomerID
FROM Orders AS O
--LEFT JOIN
SELECT C.CustomerID,O.OrderID
FROM Customers AS C
LEFT OUTER JOIN Orders AS O
ON O.CustomerID=C.CustomerID
WHERE O.OrderID IS NULL
 
--2.   Dati pregled vanrednih prihoda svih osoba. Pregled treba da sadrži sljedeæe kolone: OsobaID, Ime, VanredniPrihodID, IznosPrihoda (Prihodi)
USE prihodi
SELECT O.OsobaID,O.Ime,VP.VanredniPrihodiID,VP.IznosVanrednogPrihoda
FROM Osoba AS O
LEFT OUTER JOIN VanredniPrihodi AS VP
ON VP.OsobaID=O.OsobaID
 
--3.   Dati pregled redovnih prihoda svih osoba. Pregled treba da sadrži sljedeæe kolone: OsobaID, Ime, RedovniPrihodID, Neto (Prihodi)
SELECT O.OsobaID,O.Ime,RP.RedovniPrihodiID,RP.Neto
FROM Osoba AS O
LEFT OUTER JOIN RedovniPrihodi AS RP
ON O.OsobaID=RP.OsobaID
 
 
--4.   Odrediti da li je svaki autor napisao bar po jedan naslov. (Pubs)
--a) ako ima autora koji nisu napisali ni jedan naslov navesti njihov ID.
--b) dati pregled autora koji su napisali bar po jedan naslov.
USE pubs
SELECT A.au_id
FROM authors AS A
INTERSECT
SELECT TA.au_id
FROM titleauthor AS TA
 
SELECT*
FROM authors
 
-- OVIM VIDIMO DA SVI AUTORI NISU NAPISALI PO JEDAN NASLOV
--A
SELECT A.au_id 'Autori bez naslova'
FROM authors AS A
LEFT OUTER JOIN titleauthor AS TA
ON A.au_id=TA.au_id
WHERE TA.title_id IS NULL
 
--ILI
 
SELECT A.au_id
FROM authors AS A
EXCEPT
SELECT TA.au_id
FROM titleauthor AS TA
 
--B
-- DISTINCT UKOLIKO ŽELIMO DA SE JEDAN AUTOR NE PONAVLJA VIŠE PUTA
SELECT DISTINCT A.au_id 'Autori s naslovima'
FROM authors AS A
INNER JOIN titleauthor AS TA
ON A.au_id=TA.au_id
 
--ILI
 
SELECT A.au_id
FROM authors AS A
INTERSECT
SELECT TA.au_id
FROM titleauthor AS TA
 
--5.   Prikazati 10 najskupljih stavki prodaje. Upit treba da sadrži naziv proizvoda, kolièinu, cijenu i vrijednost stavke prodaje. Cijenu i vrijednost stavke prodaje zaokružiti na dvije decimale. Izlaz formatirati na naèin da uz kolièinu stoji 'kom' (npr 50kom) a uz cijenu KM (npr 50KM). (AdventureWorks2017)
USE AdventureWorks2017
SELECT TOP 10 PP.Name,CAST(SOD.OrderQty AS NVARCHAR)+' kom' 'Kolicina',CAST(ROUND(SOD.UnitPrice,2) AS NVARCHAR) +' KM' 'Cijena',CAST(ROUND((SOD.OrderQty*SOD.UnitPrice),2) AS nvarchar) +'KM' 'Stavka prodaje'
FROM Sales.SalesOrderDetail AS SOD
INNER JOIN Production.Product AS PP
ON SOD.ProductID=PP.ProductID
ORDER BY 4 DESC
 
--6.   Kreirati upit koji prikazuje ukupan broj kupaca po teritoriji. Lista treba da sadrži sljedeæe kolone: naziv teritorije, ukupan broj kupaca. Uzeti u obzir samo teritorije gdje ima više od 1000 kupaca. (AdventureWorks2017)
SELECT ST.Name, COUNT(*) 'Broj kupaca'
FROM Sales.Customer AS SC
INNER JOIN SALES.SalesTerritory AS ST
ON SC.TerritoryID=ST.TerritoryID
GROUP BY St.Name
HAVING COUNT(*)>1000
 
--7.   Kreirati upit koji prikazuje zaradu od prodaje proizvoda. Lista treba da sadrži naziv proizvoda, ukupnu zaradu bez uraèunatog popusta i ukupnu zaradu sa uraèunatim popustom. Iznos zarade zaokružiti na dvije decimale. Uslov je da se prikaže zarada samo za stavke gdje je bilo popusta. Listu sortirati po zaradi opadajuæim redoslijedom. (AdventureWorks2017)
SELECT PP.Name,ROUND(SUM(SOD.UnitPrice*SOD.OrderQty),2) 'Ukupna zarada bez popusta', ROUND(SUM(SOD.UnitPrice*SOD.OrderQty*(1-SOD.UnitPriceDiscount)),2) 'Ukupna zarada sa popustom'
FROM Sales.SalesOrderDetail AS SOD
INNER JOIN Production.Product AS PP
ON PP.ProductID=SOD.ProductID
WHERE SOD.UnitPriceDiscount>0
GROUP BY PP.Name
ORDER BY 3 DESC
 
 
 
--VJEŽBA 8
 
USE Northwind
 
--1.  Prikazati kolièinski najmanju i najveæu vrijednost stavke narudžbe. (Northwind)
SELECT MIN(OD.Quantity) 'Najmanja', MAX(OD.Quantity) 'Najveca'
FROM [Order Details] AS OD
 
--2.  Prikazati kolièinski najmanju i najveæu vrijednost stavke narudžbe za svaku od
--narudžbi pojedinaèno. (Northwind)
SELECT  OD.OrderID, MIN(OD.Quantity) Najmanja, MAX(OD.Quantity) Najveca
FROM [Order Details] AS OD
GROUP BY OD.OrderID
 
--3.  Prikazati ukupnu zaradu od svih narudžbi. (Northwind)
SELECT SUM(OD.Quantity*OD.UnitPrice) 'Zarada'
FROM [Order Details] AS OD
 
--4.  Prikazati ukupnu vrijednost za svaku narudžbu pojedinaèno uzimajuæi u obzir i popust.
--Rezultate zaokružiti na dvije decimale i sortirati prema ukupnoj vrijednosti naružbe u
--opadajuæem redoslijedu. (Northwind)
SELECT OD.OrderID, ROUND(SUM(OD.Quantity*OD.UnitPrice*(1-OD.Discount)),2) 'Ukupna vrijednost sa popustom'
FROM [Order Details] AS OD
GROUP BY OD.OrderID
ORDER BY 2 DESC
 
--5.  Prebrojati stavke narudžbe gdje su naruèene kolièine veæe od 50 (ukljuèujuæi i graniènu
--vrijednost). Uzeti u obzir samo one stavke narudžbe gdje je odobren popust.
--(Northwind)
SELECT COUNT(*) 'Broj stavki'
FROM [Order Details] AS OD
WHERE OD.Quantity>=50 AND OD.Discount>0
 
--6.  Prikazati prosjeènu cijenu stavki narudžbe za svaku narudžbu pojedinaèno. Sortirati
--po prosjeènoj cijeni u opadajuæem redoslijedu. (Northwind)
SELECT OD.OrderID,AVG(OD.UnitPrice) 'Cijena'
FROM [Order Details] AS OD
GROUP BY OD.OrderID
 
--7.  Prikazati broj stavki narudžbi sa odobrenim popustom. (Northwind)
SELECT COUNT(*) 'Broj stavki'
FROM [Order Details] AS OD
WHERE OD.Discount>0
 
--8.  Prikazati broj narudžbi u kojima je unesena regija kupovine. (Northwind)
SELECT COUNT (*) 'Broj narudžbi sa unesenim regijama'
FROM Orders AS O
WHERE O.ShipRegion IS NOT NULL
 
SELECT COUNT (O.ShipRegion) 'Broj narudžbi sa unesenim regijama'
FROM Orders AS O
 
--9. Modificirati prethodni upit tako da se dobije broj narudžbi u kojima nije unesena regija
--kupovine. (Northwind)
SELECT COUNT(*)-COUNT(O.ShipRegion) 'Nije unesena regija kupovine'
FROM Orders AS O
 
SELECT COUNT (*) 'Broj narudžbi sa unesenim regijama'
FROM Orders AS O
WHERE O.ShipRegion IS NULL
 
--10. Prikazati ukupne troškove prevoza po uposlenicima. Uslov je da ukupni troškovi
--prevoza nisu prešli 7500 pri èemu se rezultat treba sortirati opadajuæim redoslijedom
--po visini troškova prevoza. (Northwind)
SELECT O.EmployeeID, SUM(O.Freight) 'Troškovi prevoza'
FROM Orders AS O
GROUP BY O.EmployeeID
HAVING SUM(O.Freight)<7500
ORDER BY 2 DESC
 
--11. Prikazati ukupnu vrijednost troškova prevoza po državama ali samo ukoliko je veæa od
--4000 za robu koja se kupila u Francuskoj, Njemaèkoj ili USA. (Northwind)
SELECT O.ShipCountry, SUM (O.Freight) 'Troškovi prevoza'
FROM Orders AS O
WHERE O.ShipCountry IN ('France', 'Germany', 'USA')
GROUP BY O.ShipCountry
HAVING SUM (O.Freight)>4000
 
--12. Prikazati ukupan broj modela proizvoda. Lista treba da sadrži ID modela proizvoda i
--njihov ukupan broj. Uslov je da proizvod pripada nekom modelu i da je ukupan broj
--proizvoda po modelu veæi od 3. U listu ukljuèiti (prebrojati) samo one proizvode èiji
--naziv poèinje slovom 'S'. (AdventureWorks2017)
USE AdventureWorks2017
SELECT PP.ProductModelID, COUNT (*)
FROM Production.Product AS PP
WHERE PP.Name LIKE 'S%' AND PP.ProductModelID IS NOT NULL
GROUP BY PP.ProductModelID
HAVING COUNT (*)>3
 
--ILI
 
SELECT PP.ProductModelID, COUNT (PP.ProductModelID)
FROM Production.Product AS PP
WHERE PP.Name LIKE 'S%'
GROUP BY PP.ProductModelID
HAVING COUNT (PP.ProductModelID)>3
 
--13.  Prikazati tip popusta, naziv prodavnice i njen id. (Pubs)
USE pubs
SELECT D.discounttype,S.stor_name,S.stor_id
FROM stores AS S
INNER JOIN discounts AS D
ON S.stor_id=D.stor_id
 
--14.  Prikazati ime uposlenika, njegov id, te naziv posla koji obavlja. (Pubs)
SELECT E.fname,E.emp_id,J.job_desc
FROM employee AS E
INNER JOIN jobs AS J
ON J.job_id=E.job_id
 
--15.  Prikazati spojeno ime i prezime uposlenika, teritoriju i regiju koju pokriva. Uslov je da su zaposlenici mlaði od 60 godina. (Northwind)
USE Northwind
SELECT E.FirstName + ' '+E.LastName,T.TerritoryDescription,R.RegionDescription
FROM Employees AS E
INNER JOIN EmployeeTerritories AS ET
ON E.EmployeeID=ET.EmployeeID
INNER JOIN Territories AS T
ON ET.TerritoryID=T.TerritoryID
INNER JOIN Region AS R
ON R.RegionID=T.RegionID
WHERE DATEDIFF(YEAR,E.BirthDate,GETDATE())<60
 
--16.  Prikazati ime uposlenika i ukupnu vrijednost svih narudžbi koju je taj uposlenik napravio u 1996. godini. U obzir uzeti samo one uposlenike èija je ukupna napravljena vrijednost veæa od 20000. Podatke sortirati prema ukupnoj vrijednosti (zaokruženoj na dvije decimale) u rastuæem redoslijedu. (Northwind)
SELECT E.EmployeeID,SUM(OD.UnitPrice*OD.Quantity)'Ukupna vrijednost'
FROM Employees AS E
INNER JOIN Orders AS O
ON E.EmployeeID=O.EmployeeID
INNER JOIN [Order Details] AS OD
ON OD.OrderID=O.OrderID
WHERE YEAR(O.OrderDate)=1996
GROUP BY E.EmployeeID
HAVING SUM(OD.UnitPrice*OD.Quantity)>20000
ORDER BY 2
 
--17.  Prikazati naziv dobavljaèa, adresu i državu dobavljaèa i nazive proizvoda koji pripadaju kategoriji piæa i ima ih na stanju više od 30 komada. Rezultate upita sortirati po državama. (Northwind)
SELECT S.ContactName,S.Address,S.Country,P.ProductName
FROM Suppliers AS S
INNER JOIN Products AS P
ON S.SupplierID=P.SupplierID
INNER JOIN Categories AS C
ON C.CategoryID=P.CategoryID
WHERE P.UnitsInStock>30 AND C.Description LIKE '%drinks%'
ORDER BY 3
 
--18.  Prikazati kontakt ime kupca, njegov id, broj narudžbe, datum kreiranja narudžbe (prikazan na naèin npr 24.07.2021) te ukupnu vrijednost narudžbe sa i bez popusta. Prikazati samo one narudžbe koje su kreirane u 1997. godini. Izraèunate vrijednosti zaokružiti na dvije decimale, te podatke sortirati prema ukupnoj vrijednosti narudžbe sa popustom. (Northwind)
USE Northwind
SELECT C.ContactName,C.CustomerID,O.OrderID,FORMAT(O.OrderDate,'dd.MM.yyyy') AS 'Datum kreiranja narudžbe', SUM(OD.UnitPrice*OD.Quantity) 'Ukupno bez popusta',ROUND(SUM(OD.UnitPrice*OD.Quantity*(1-OD.Discount)),2) 'Ukupno sa popustom'
FROM Customers AS C
INNER JOIN Orders AS O
ON C.CustomerID=O.CustomerID
INNER JOIN [Order Details] AS OD
ON OD.OrderID=O.OrderID
WHERE YEAR(O.OrderDate)=1997
GROUP BY C.ContactName,C.CustomerID,O.OrderID,FORMAT(O.OrderDate,'dd.MM.yyyy')
ORDER BY 6 DESC
 
 
 
 
 
 
 
 
 
--01.11.2022.
 
--BAZE PODATAKA – PRAKTIÈNI ISPIT
 
 
--1. Kroz SQL kod kreirati bazu podataka sa imenom vašeg broja indeksa.
CREATE DATABASE ispitni
GO
USE ispitni
--2. U kreiranoj bazi podataka kreirati tabele sa sljedeæom strukturom:
--a) Proizvodi
--• ProizvodID, cjelobrojna vrijednost i primarni kljuè
--• Naziv, 50 UNICODE karaktera (obavezan unos)
--• SifraProizvoda, 25 UNICODE karaktera (obavezan unos)
--• Boja, 15 UNICODE karaktera
--• NazivKategorije, 50 UNICODE (obavezan unos)
--• Tezina, decimalna vrijednost sa 2 znaka iza zareza
--b) ZaglavljeNarudzbe
--• NarudzbaID, cjelobrojna vrijednost i primarni kljuè,
--• DatumNarudzbe, polje za unos datuma i vremena (obavezan unos)
--• DatumIsporuke, polje za unos datuma i vremena
--• ImeKupca, 50 UNICODE (obavezan unos)
--• PrezimeKupca, 50 UNICODE (obavezan unos)
--• NazivTeritorije, 50 UNICODE (obavezan unos)
--• NazivRegije, 50 UNICODE (obavezan unos)
--• NacinIsporuke, 50 UNICODE (obavezan unos)
--c) DetaljiNarudzbe
--• NarudzbaID, cjelobrojna vrijednost, strani kljuè
--• ProizvodID, cjelobrojna vrijednost, strani kljuè
--• Cijena, novèani tip (obavezan unos),
--• Kolicina, smallint (obavezan unos),
--• Popust, novèani tip (obavezan unos)
--• Narudzba ID i ProizvodID primarni kljuè
--12 bodova
CREATE TABLE Proizvodi (
ProizvodID INT PRIMARY KEY,
Naziv NVARCHAR(50) NOT NULL,
SifraProizvoda NVARCHAR(25) NOT NULL,
Boja NVARCHAR(15),
NazivKategorije NVARCHAR(50) NOT NULL,
Tezina DECIMAL(8,2)
)
 
CREATE TABLE ZaglavljeNarudzbe (
NarudzbaID INT PRIMARY KEY,
DatumNarudzbe DATETIME,
DatumIsporuke DATETIME,
ImeKupca NVARCHAR(50) NOT NULL,
PrezimeKupca NVARCHAR(50) NOT NULL,
NazivTeritorije NVARCHAR(50) NOT NULL,
NazivRegije NVARCHAR(50) NOT NULL,
NacinIsporuke NVARCHAR(50) NOT NULL,
)
 
CREATE TABLE DetaljiNarudzbe (
NarudzbaID INT CONSTRAINT FK_DetaljiNarudzbe_NarudzbaID FOREIGN KEY REFERENCES ZaglavljeNarudzbe (NarudzbaID),
ProizvodID INT CONSTRAINT FK_DetaljiNarudzbe_ProizvodID FOREIGN KEY REFERENCES Proizvodi (ProizvodID),
Cijena MONEY NOT NULL,
Kolicina SMALLINT NOT NULL,
Popust MONEY NOT NULL,
PRIMARY KEY(NarudzbaID, ProizvodID)
)
 
--3. Iz baze podataka AdventureWorks u svoju bazu podataka prebaciti sljedeæe podatke:
--a) U tabelu Proizvodi dodati sve proizvode, na mjestima gdje nema pohranjenih podataka o težini zamijeniti vrijednost sa 0
--• ProductID -> ProizvodID
--• Name  -> Naziv
--• ProductNumber -> SifraProizvoda
--• Color -> Boja
--• Name (ProductCategory) -> NazivKategorije
--• Weight -> Tezina
INSERT INTO Proizvodi
SELECT PP.ProductID, PP.Name, PP.ProductNumber, PP.Color, PPC.Name, ISNULL(PP.Weight, 0)
FROM AdventureWorks2017.Production.Product AS PP
INNER JOIN AdventureWorks2017.Production.ProductSubcategory AS PPS
ON PP.ProductSubcategoryID = PPS.ProductSubcategoryID
INNER JOIN AdventureWorks2017.Production.ProductCategory AS PPC
ON PPS.ProductCategoryID = PPC.ProductCategoryID
 
--b) U tabelu ZaglavljeNarudzbe dodati sve narudžbe
--• SalesOrderID -> NarudzbaID
--• OrderDate -> DatumNarudzbe
--• ShipDate -> DatumIsporuke
--• FirstName (Person) -> ImeKupca
--• LastName (Person) -> PrezimeKupca
--• Name (SalesTerritory) -> NazivTeritorije
--• Group (SalesTerritory) -> NazivRegije
--• Name (ShipMethod) -> NacinIsporuke
INSERT INTO ZaglavljeNarudzbe
SELECT SOH.SalesOrderID, SOH.OrderDate, SOH.ShipDate, PP.FirstName, PP.LastName, ST.Name, ST.[Group], SM.Name
FROM AdventureWorks2017.Sales.SalesOrderHeader AS SOH
INNER JOIN AdventureWorks2017.Sales.Customer AS SC
ON SOH.CustomerID = SC.CustomerID
INNER JOIN AdventureWorks2017.Person.Person AS PP
ON SC.PersonID = PP.BusinessEntityID
INNER JOIN AdventureWorks2017.Sales.SalesTerritory AS ST
ON SOH.TerritoryID = ST.TerritoryID
INNER JOIN AdventureWorks2017.Purchasing.ShipMethod AS SM
ON SOH.ShipMethodID = SM.ShipMethodID
--c) U tabelu DetaljiNarudzbe dodati sve stavke narudžbe
--• SalesOrderID -> NarudzbaID
--• ProductID -> ProizvodID
--• UnitPrice -> Cijena
--• OrderQty -> Kolicina
--• UnitPriceDiscount -> Popust
--12 bodova
INSERT INTO DetaljiNarudzbe
SELECT SOD.SalesOrderID, SOD.ProductID, SOD.UnitPrice, SOD.OrderQty, SOD.UnitPriceDiscount
FROM AdventureWorks2017.Sales.SalesOrderDetail AS SOD
 
--4.
--a) (6 bodova) Prikazati sve proizvode koji imaju težinu izmeðu 15 i 25, ili su crvene ili crne boje.
SELECT * FROM Proizvodi
WHERE Tezina BETWEEN 15 and 25
OR Boja IN ('Black', 'Red')
 
--b) (7 bodova) Prikazati ukupni promet (uzimajuæi u obzir i popust) od narudžbi grupisan po teritorijama.
SELECT NazivTeritorije, SUM(DT.Cijena * DT.Kolicina * (1 - DT.Popust)) as UkupnoProdano
FROM ZaglavljeNarudzbe AS ZN
INNER JOIN DetaljiNarudzbe AS DT
ON ZN.NarudzbaID = DT.NarudzbaID
GROUP BY ZN.NazivTeritorije
 
--c) (7 bodova) Napisati upit koji æe prebrojati stavke narudžbe za svaku narudžbu pojedinaèno. U rezultatima prikazati ID narudžbe i broj stavki, te uzeti u obzir samo one narudžbe èiji je broj stavki veæi od 1, te koje su napravljene izmeðu 1.6. i 10.6. bilo koje godine. (Novokreirana baza)
SELECT ZN.NarudzbaID, COUNT(*) as BrojStavki
FROM ZaglavljeNarudzbe AS ZN
INNER JOIN DetaljiNarudzbe AS DN
ON ZN.NarudzbaID = DN.NarudzbaID
WHERE MONTH(DatumNarudzbe) = 6
AND DAY(DatumNarudzbe) BETWEEN 1 and 10
GROUP BY ZN.NarudzbaID
HAVING COUNT(*) > 1
 
--d) (7 bodova) Prikazati sve uposlenike ženskog spola koji imaju više od 10 godina radnog staža a rade na Production ili Marketing odjelu. Upitom je potrebno prikazati spojeno ime i prezime uposlenika, godine radnog staža, te odjel na kojem rade uposlenici. Rezultate upita sortirati u rastuæem redoslijedu prema nazivu odjela, te opadajuæem prema godinama radnog staža. (AdventureWorks2017)
USE AdventureWorks2017
SELECT PP.FirstName+ ' '+ PP.LastName 'Ime i prezime', DATEDIFF(YEAR,E.HireDate,GETDATE()) 'Godine radnog staza', D.Name
FROM HumanResources.Employee AS E
INNER JOIN HumanResources.EmployeeDepartmentHistory AS EDH
ON E.BusinessEntityID=EDH.BusinessEntityID
INNER JOIN HumanResources.Department AS D
ON D.DepartmentID=EDH.DepartmentID
INNER JOIN Person.Person AS PP
ON PP.BusinessEntityID=E.BusinessEntityID
WHERE DATEDIFF(YEAR,E.HireDate,GETDATE())>10 AND E.Gender ='F' AND D.Name IN ('Production','Marketing')
ORDER BY 3, 2 DESC
--e) (11 bodova) Prikazati spojeno ime i prezime osobe, spol, ukupnu vrijednost redovnih bruto prihoda, ukupnu vrijednost vanrednih prihoda, te sumu ukupnih vanrednih i ukupnih redovnih bruto prihoda. Uslov je da osobe dolaze iz Latvije, Kine ili Indonezije a suma ukupnih bruto i ukupnih vanrednih prihoda je veæa od 1000KM. Takoðer, uslov je da tip vanrednog prihoda bude prekovremeni rad a tip redovnog prihoda plata. Rezultate upita sortirati prema ukupnoj vrijednosti prihoda obrnuto abecedno. (Prihodi)
USE prihodi
select*
from(select O.Ime,O.PrezIme, SUM(rp.Bruto) 'Ukupna bruto vrijednost',SUM(vp.IznosVanrednogPrihoda) 'Ukupna vrijednost vanr prih',SUM(rp.Bruto)+SUM(vp.IznosVanrednogPrihoda) 'Ukupna vrijednost prihoda'
from Osoba as o
inner join Drzava as d
on o.DrzavaID=d.DrzavaID
inner join RedovniPrihodi as rp
on o.OsobaID=rp.OsobaID
inner join VanredniPrihodi as vp
on vp.OsobaID=o.OsobaID
inner join TipVanrednogPrihoda as tvp
on vp.TipVanrednogPrihodaID=tvp.TipVanrednogPrihodaID
inner join TipRedovnogPrihoda as trp
on rp.TipRedovnogPrihodaID=trp.TipRedovnogPrihodaID
where d.Drzava IN( 'China','Latvia','Indonesia') and tvp.NazivVanrednogPrihoda like 'prekovremeni rad' and trp.NazivRedovnogPrihoda like 'plata'
group by o.ime,o.PrezIme) as podq
where [Ukupna vrijednost prihoda]>10000
order by 5 desc
 
USE prihodi
select O.Ime,O.PrezIme, SUM(rp.Bruto) 'Ukupna bruto vrijednost',SUM(vp.IznosVanrednogPrihoda) 'Ukupna vrijednost vanr prih',SUM(rp.Bruto)+SUM(vp.IznosVanrednogPrihoda) 'Ukupna vrijednost prihoda'
from Osoba as o
inner join Drzava as d
on o.DrzavaID=d.DrzavaID
inner join RedovniPrihodi as rp
on o.OsobaID=rp.OsobaID
inner join VanredniPrihodi as vp
on vp.OsobaID=o.OsobaID
inner join TipVanrednogPrihoda as tvp
on vp.TipVanrednogPrihodaID=tvp.TipVanrednogPrihodaID
inner join TipRedovnogPrihoda as trp
on rp.TipRedovnogPrihodaID=trp.TipRedovnogPrihodaID
where d.Drzava IN( 'China','Latvia','Indonesia') and tvp.NazivVanrednogPrihoda like 'prekovremeni rad' and trp.NazivRedovnogPrihoda like 'plata'
group by o.ime,o.PrezIme
having SUM(rp.Bruto)+SUM(vp.IznosVanrednogPrihoda)>10000
order by 5 desc
--f) (10 bodova) Napisati upit koji æe prikazati sljedeæe podatke o proizvodima: ID proizvoda, naziv proizvoda, šifru proizvoda, te novokreiranu šifru proizvoda. Nova šifra se sastoji od sljedeæih vrijednosti:
--1) Svi karakteri nakon prvog znaka - (crtica)
--2) Karakter /
--3) ID proizvoda
--Npr. Za proizvod sa ID-om 716 i šifrom LJ-0192-X, nova šifra æe biti 0192-X/716.
USE ispitni
GO
SELECT ProizvodID, Naziv, SifraProizvoda,
SUBSTRING(SifraProizvoda, CHARINDEX('-', SifraProizvoda, 0) + 1, LEN(SifraProizvoda)) + '/' + CONVERT(NVARCHAR(50), ProizvodID) as Šifra
FROM Proizvodi
 
-- 48 bodova
--5.
--a) (8 bodova) Kreirati view koji prikazuje sljedeæe kolone: ID narudžbe, datum narudžbe, spojeno ime i prezime kupca i ukupnu vrijednost narudžbe. Podatke sortirati prema ukupnoj vrijednosti u opadajuæem redoslijedu. (Novokreirana baza)
GO
CREATE VIEW view_5a AS
SELECT ZN.NarudzbaID, ZN.DatumNarudzbe,ZN.ImeKupca + ' '+ ZN.PrezimeKupca AS 'Ime i prezime',
SUM(DN.Cijena*DN.Kolicina*(1-DN.Popust)) AS 'Vrijednost'
FROM ZaglavljeNarudzbe AS ZN
INNER JOIN DetaljiNarudzbe AS DN
ON ZN.NarudzbaID=DN.NarudzbaID
GROUP BY ZN.NarudzbaID, ZN.DatumNarudzbe, ZN.ImeKupca, ZN.PrezimeKupca
 
GO
 
SELECT*
FROM view_5a
ORDER BY Vrijednost DESC
 
--b) (7 bodova) Kreirati proceduru sp_edit_proizvodi kojom æe se izmijeniti odreðeni zapis iz tabele Proizvodi. Procedurom korisnik može da izmijeni sve podatke o jednom proizvodu ili samo neki odreðeni podatak. Ukoliko korisnik mijenja odreðeni podatak voditi raèuna da ostali podaci ne dobiju NULL vrijednost. OBAVEZNO kreirati testni sluèaj za kreiranu proceduru. (Novokreirana baza)
GO
CREATE PROCEDURE sp_edit_proizvodi
(
@ProizvodID INT,
@Naziv NVARCHAR(40)=NULL,
@SifraProizvoda NVARCHAR(25)=NULL,
@Boja NVARCHAR(15)=NULL,
@NazivKategorije NVARCHAR(50)=NULL,
@Tezina DECIMAL (8,2)=NULL
)
AS
BEGIN
UPDATE Proizvodi
SET Naziv=ISNULL(@Naziv, Naziv),
SifraProizvoda=ISNULL(@SifraProizvoda, SifraProizvoda),
Boja=ISNULL(@Boja, Boja),
NazivKategorije=ISNULL(@NazivKategorije, NazivKategorije),
Tezina=ISNULL(@Tezina, Tezina)
WHERE @ProizvodID=ProizvodID
END
GO
 
EXEC sp_edit_proizvodi @ProizvodID=706, @Naziv='HL Naziv'
 
SELECT*
FROM Proizvodi
 
--c) (7 bodova) Kreirati proceduru sp_search_proizvodi kojom æe se u tabeli Proizvodi uraditi select proizvoda prema nazivu proizvoda ili nazivu kategorije. Proceduru obavezno pokrenuti. (Novokreirana baza)
GO
CREATE PROCEDURE proc_search_proizvodi
(
@Naziv NVARCHAR(40)=NULL,
@Kategorija NVARCHAR(50)=NULL
)
AS
BEGIN
SELECT * FROM Proizvodi as P
WHERE Naziv=@Naziv OR NazivKategorije=@Kategorija
END
 
EXEC proc_search_proizvodi @Naziv = 'HL Road Frame - Red, 62'
EXEC proc_search_proizvodi @Kategorija = 'Components'
EXEC proc_search_proizvodi @Naziv = 'LL Road Front Wheel', @Kategorija = 'Components'
 
 
--22 boda
 
 
--SQL skriptu (bila prazna ili ne) imenovati Vašim brojem indeksa, te istu upload-ovati na FTP u folder Upload.
--Maksimalan broj bodova:100 
--Prag prolaznosti: 55
 
 
 
 
create database zadacic
go
use zadacic
 
 
 
--1 zadatak
create table proizvodi
(
       proizvodID int constraint PK_proizvodi primary key not null,
       naziv nvarchar(50) not null,
       sifraProizvoda nvarchar(25) not null,
       boja nvarchar (15),
       nazivKategorije nvarchar(50) not null,
       tezina decimal (8,2)
)
 
create table zaglavljeNarudzba
(
       narudzbaID int constraint PK_narudzba primary key not null,
       datumNaruzdbe datetime not null,
       datumIsporuke datetime,
       imeKupca nvarchar (50) not null,
       prezimeKupca nvarchar (50) not null,
       nazivTeritorije nvarchar (50) not null,
       nazivRegije nvarchar (50) not null,
       nacinIsporuke nvarchar (50) not null
)
 
create table detaljiNarudzbe
(
       narudzbaID int,
       proizvodID int,
       constraint FK_detaljiNarudzbeZ foreign key (narudzbaID) references zaglavljeNarudzba (narudzbaID),
       constraint FK_detaljiNarudzbeP foreign key (proizvodID) references proizvodi (proizvodID),
       cijena money not null,
       kolicina smallint not null,
       popust money not null,
       constraint PK_detaljiNarudzbeZP primary key(narudzbaID,proizvodID)
)
 
 
--2 zadatak
 
insert into proizvodi
select pp.productID, pp.Name, pp.ProductNumber, pp.color, pc.Name, isnull(pp.Weight,0) as Weight
from [AdventureWorks2014].Production.Product as pp inner join [AdventureWorks2014].Production.ProductSubcategory as sc
on pp.ProductSubcategoryID = sc.ProductSubcategoryID
inner join [AdventureWorks2014].Production.ProductCategory as pc
on sc.ProductCategoryID = pc.ProductCategoryID
 
 
insert into zaglavljeNarudzba
select soh.SalesOrderID, soh.OrderDate, soh.ShipDate, pp.FirstName, pp.LastName, st.Name, st.[Group], sm.Name
from [AdventureWorks2014].Sales.SalesOrderHeader as soh inner join AdventureWorks2014.Sales.Customer as c
on soh.CustomerID = c.CustomerID
inner join AdventureWorks2014.Person.Person as pp
on c.PersonID = pp.BusinessEntityID
inner join AdventureWorks2014.Sales.SalesTerritory as st
on st.TerritoryID = soh.TerritoryID
inner join AdventureWorks2014.Purchasing.ShipMethod as sm
on soh.ShipMethodID = sm.ShipMethodID
 
 
insert into detaljiNarudzbe
select SalesOrderID, ProductID, UnitPrice, OrderQty, UnitPriceDiscount
from AdventureWorks2014.Sales.SalesOrderDetail
 
--zadatak 3
select naziv, boja, tezina
from proizvodi
where tezina between 15 and 25 and (boja like 'Black' or boja like 'Red')
 
select*
from proizvodi
--zadatak 4
 
select dn.narudzbaID, dn.cijena*dn.kolicina*(1-dn.popust) as UkupniPrometSaPopustom, zn.nazivTeritorije
from detaljiNarudzbe as dn inner join zaglavljeNarudzba as zn
on dn.narudzbaID = zn.narudzbaID
 
select *
from detaljiNarudzbe as dn inner join zaglavljeNarudzba as zn
on dn.narudzbaID = zn.narudzbaID
 
--zadatak5
 
select zn.narudzbaID, dn.kolicina, month(zn.datumNaruzdbe) as Mjesec
from zaglavljeNarudzba as zn inner join detaljiNarudzbe as dn
on zn.narudzbaID = dn.narudzbaID
where dn.kolicina > 1 and day(zn.datumNaruzdbe) between 1 and 10
--nema 6 mjeseca
 
select*
from zaglavljeNarudzba as zn inner join detaljiNarudzbe as dn
on zn.narudzbaID = dn.narudzbaID
 
--zadatak6
 
select pp.FirstName + pp.LastName as ImePrezime, year(e.HireDate) as GodinaRadnogStaza, e.JobTitle
from AdventureWorks2014.HumanResources.Employee as e inner join AdventureWorks2014.Person.Person as pp
on e.BusinessEntityID = pp.BusinessEntityID
where e.Gender like 'F' and ( e.JobTitle like '%Marketing%' or e.JobTitle like '%Production%') and DATEDIFF(year, e.HireDate, getdate()) > 10
order by e.JobTitle asc, e.HireDate desc
 
select *
from AdventureWorks2014.HumanResources.Employee as e inner join AdventureWorks2014.Person.Person as pp
on e.BusinessEntityID = pp.BusinessEntityID
 
--zadaatak 7, prihodi
 
select o.ime+o.prezime as imeprezime, sum(rp.bruto) as ukupnaVrijednostBruto, sum(vp.iznos) as ukupnaVrijednostVanPrihodaIznosa, sum(rp.bruto) + sum(vp.iznos) as Ukupno
from prihodi.dbo.osoba as o inner join prihodi.dbo.red_prihodi as rp
on o.osobaID = rp.osobaID
inner join prihodi.dbo.vanr_prihodi as vp
on o.osobaID = vp.osobaID
inner join prihodi.dbo.grad as g
on o.gradID = g.gradID
inner join prihodi.dbo.regija as r
on g.regijaID = r.regijaID
inner join prihodi.dbo.drzava as d
on r.drzavaID = d.drzavaID
inner join prihodi.dbo.tip_vanr_prihoda as tvp
on vp.tip_vanr_prihodaID = tvp.tip_vanr_prihodaID
inner join prihodi.dbo.tip_red_prihoda as trp
on rp.tip_red_prihodaID = trp.tip_red_prihodaID
where (d.naziv like 'Latvia' or d.naziv like 'Indonesia' or d.naziv like 'China') and rp.bruto + vp.iznos > 1000 and tvp.tip_vanr_prihodaID like '1' and trp.tip_red_prihodaID like '1'
group by o.ime+o.prezime
 
 
 
--pomoc pri rjesavanju zadatka
select*
from prihodi.dbo.osoba as o inner join prihodi.dbo.red_prihodi as rp
on o.osobaID = rp.osobaID
inner join prihodi.dbo.vanr_prihodi as vp
on o.osobaID = vp.osobaID
inner join prihodi.dbo.grad as g
on o.gradID = g.gradID
inner join prihodi.dbo.regija as r
on g.regijaID = r.regijaID
inner join prihodi.dbo.drzava as d
on r.drzavaID = d.drzavaID
where (d.drzavaID like 'Latvia' or d.drzavaID like 'Indonesia' or d.drzavaID like 'China') 
 
select vp.tip_vanr_prihodaID
from prihodi.dbo.osoba as o inner join prihodi.dbo.red_prihodi as rp
on o.osobaID = rp.osobaID
inner join prihodi.dbo.vanr_prihodi as vp
on o.osobaID = vp.osobaID
 
 
select*
from prihodi.dbo.tip_red_prihoda
 
--zadatak 8
 
select proizvodID, naziv, sifraProizvoda, right(concat(sifraProizvoda,'/', proizvodID),10) as novaSifra
from proizvodi
 
--right(sifraProizvoda, (charindex ('-', sifraProizvoda)+3)), -- left(punaAdresa, (charindex ('-', punaAdresa)-1))-- ovo mogu iskoristiiti za sifru sa apl roka
 
--zadatak 9
 
go
create view zadatak9view
as
select dn.narudzbaID, zn.datumNaruzdbe, zn.imeKupca+zn.prezimeKupca as imePrezime, dn.cijena * dn.kolicina as UkupnaVrijednostNarudzbe
from detaljiNarudzbe as dn inner join zaglavljeNarudzba as zn
on dn.narudzbaID = zn.narudzbaID
go
 
--samo sortirati ostalo
 
--zadatak 10
 
go
create procedure sp_editProizvodi
as
begin
       update proizvodi
       set 
       where
end
go
 
--nemam pojma iskreno
 
select*
from proizvodi
 
 
 
--zadatak 11
go
create procedure sp_searchProizvod
(
       @naziv nvarchar (50) = null,
       @nazivKategorije nvarchar (50) = null
)
as
begin
select *
from proizvodi
where naziv = @naziv or
             nazivKategorije = @nazivKategorije
end
 
 
 
exec sp_searchProizvod @naziv = 'HL Road Frame - Black, 58'
exec sp_searchProizvod @nazivKategorije = 'Components'
 
select*
from proizvodi
 
 
 
 
create database IspitniZadatak11
go
use IspitniZadatak11
 
--1 zadatak
 
create table proizvodi
(
       proizvodID int constraint PK_proizvodi primary key not null,
       naziv nvarchar (50) not null,
       sifraProizvoda nvarchar (25) not null,
       bona nvarchar (15),
       nazivKategorije nvarchar (50) not null,
       tezina decimal (8,2)
)
 
select*
from detaljiNarudzbe
 
create table zaglavljeNarudzbe
(
       narudzbaID int constraint PK_zaglavljeNarudzbe primary key not null,
       datumNarudzbe datetime not null,
       datumIsporuke datetime not null,
       nazivTeritorije nvarchar (50) not null,
       nazivRegije nvarchar (50) not null,
       nazivIsporuke nvarchar (50) not null
)
 
create table detaljiNarudzbe
(
       narudzbaID int,
       constraint FK_detaljiNarudzbeNarudzba foreign key (narudzbaID) references zaglavljeNarudzbe (narudzbaID),
       proizvodID int,
       constraint FK_detaljiNarudzbeProizvod foreign key (proizvodID) references proizvodi (proizvodID),
       cijena money not null,
       kolicina smallint not null,
       popust money not null,
       constraint PK_proizNaru primary key (narudzbaID, proizvodID)
)
 
drop table detaljiNarudzbe
 
 
--2 zadatak
 
insert into proizvodi
select p.ProductID, p.name, p.ProductNumber, isnull(p.Color,'nije naznaceno') as Boja, pc.Name, p.Weight
from AdventureWorks2014.Production.Product as p inner join AdventureWorks2014.Production.ProductSubcategory as psc
on p.ProductSubcategoryID = psc.ProductSubcategoryID
inner join AdventureWorks2014.Production.ProductCategory as pc
on psc.ProductCategoryID = pc.ProductCategoryID
 
select*
from proizvodi
 
insert into zaglavljeNarudzbe
select soh.SalesOrderID, soh.OrderDate, soh.ShipDate, st.Name, st.[Group], sm.Name
from AdventureWorks2014.Sales.SalesOrderHeader as soh inner join AdventureWorks2014.Sales.SalesTerritory as st
on soh.TerritoryID = st.TerritoryID
inner join AdventureWorks2014.Purchasing.ShipMethod as sm
on soh.ShipMethodID = sm.ShipMethodID
 
select*
from zaglavljeNarudzbe
 
insert into detaljiNarudzbe
select soh.SalesOrderID, sod.ProductID, sod.UnitPrice, sod.OrderQty, sod.UnitPriceDiscount
from AdventureWorks2014.Sales.SalesOrderHeader as soh inner join AdventureWorks2014.Sales.SalesOrderDetail as sod
on soh.SalesOrderID = sod.SalesOrderID
 
select*
from detaljiNarudzbe
 
--3 zadatak
 
go
create view v_proizvodi
as
select p.naziv, p.sifraProizvoda,  count(dn.kolicina) as ukupnoKolicina, dn.cijena*dn.kolicina*(1-dn.popust) as cijena
from proizvodi as p inner join detaljiNarudzbe as dn
on p.proizvodID = dn.proizvodID
group by p.naziv, p.sifraProizvoda, dn.cijena*dn.kolicina*(1-dn.popust)
go
 
select *
from v_proizvodi
order by cijena desc
 
 
 
--4 zadatak
 
select d.GroupName, count(*)
from AdventureWorks2014.HumanResources.Employee as e inner join AdventureWorks2014.HumanResources.EmployeeDepartmentHistory as edh
on e.BusinessEntityID = edh.BusinessEntityID
inner join AdventureWorks2014.HumanResources.Department as d
on d.DepartmentID = edh.DepartmentID
where datediff(year, e.HireDate,getdate()) > 10
group by d.GroupName
order by count(*) desc
 
 
--pomoc pri rjesavanju
--select d.GroupName
--from AdventureWorks2014.HumanResources.Employee as e inner join AdventureWorks2014.HumanResources.EmployeeDepartmentHistory as edh
--on e.BusinessEntityID = edh.BusinessEntityID
--inner join AdventureWorks2014.HumanResources.Department as d
--on d.DepartmentID = edh.DepartmentID
--where datediff(year, e.HireDate,getdate()) > 10
 
 
--5 zadatak
 
 
select count(pod.OrderQty) as UkupnoPoMjesecu
from AdventureWorks2014.Purchasing.PurchaseOrderHeader as poh inner join AdventureWorks2014.Purchasing.PurchaseOrderDetail as pod
on poh.PurchaseOrderID = pod.PurchaseOrderID
inner join AdventureWorks2014.Purchasing.ShipMethod as sm
on poh.ShipMethodID = sm.ShipMethodID
where poh.Freight between 500 and 2500 and sm.Name like '%Cargo%'
group by month(pod.DueDate)
 
--pomoc
--select*
--from AdventureWorks2014.Purchasing.PurchaseOrderHeader as poh inner join AdventureWorks2014.Purchasing.PurchaseOrderDetail as pod
--on poh.PurchaseOrderID = pod.PurchaseOrderID
--inner join AdventureWorks2014.Purchasing.ShipMethod as sm
--on poh.ShipMethodID = sm.ShipMethodID
 
 
--6 zadatak
 
select soh.SalesPersonID, count(soh.SalesOrderID) as BrojNarucenihNarudzbiPoOsobi
from AdventureWorks2014.Sales.SalesOrderHeader as soh inner join AdventureWorks2014.Sales.SalesTerritory as st
on soh.TerritoryID = st.TerritoryID
where (year(soh.OrderDate) like 2011 or year(soh.OrderDate) like 2011) and (st.Name like 'Canada' or st.Name like 'France' or st.Name like 'United Kingdom')
group by soh.SalesPersonID
order by count(soh.SalesOrderID)
 
--pomoc
--select st.Name
--from AdventureWorks2014.Sales.SalesOrderHeader as soh inner join AdventureWorks2014.Sales.SalesTerritory as st
--on soh.TerritoryID = st.TerritoryID
 
--7 zadatak
-- moram ponoviti index
 
--8 zadatak
 
 
 
--1
/*
a) Kreirati bazu Indeks.
*/
 
create database IspitniZadatak10
go
use IspitniZadatak10
 
/*
b) U bazi indeks kreirati sljedeće tabele:
1. Narudzba koja će se sastojati od polja:
2. Dobavljac
3. Proizvod
*/
 
create table narudzba
(
       narudzbaID int constraint PK_narudzba primary key not null,
       datumNarudzbe date not null,
       datumPrijema date not null,
       datumIsporuke date not null,
       trosakPrevoza money not null,
       punaAdresa nvarchar (70) not null
)
 
 
create table dobavljac
(
       dobavljacID int constraint PK_dobavljac primary key not null,
       nazivDobavljaca nvarchar (40) not null,
       punaAdresa nvarchar (60) not null,
       drzava nvarchar (15) not null
)
 
create table proizvod
(
       narudzbaID int not null,
       dobavljacID int not null,
       proizvodID int constraint PK_proizvod primary key not null,
       nazivProizvoda nvarchar (40) not null,
       cijena int not null,
       kolicina int not null,
       popust decimal (3,2) not null,
       raspolozivost bit not null,
       constraint FK_proizvodNarudzba foreign key (narudzbaID) references narudzba (narudzbaID),
       constraint FK_proizvodDobavljac foreign key (dobavljacID) references dobavljac (dobavljacID)
)
 
 
--2
/*a) U tabelu Narudzba insertovati podatke iz tabele Orders baze Northwind pri čemu će puna adresa biti sačinjena od adrese, poštanskog broja i grada isporuke.
Između dijelova adrese umetnuti prazno mjesto. Ukoliko nije unijeta vrijednost poštanskog broja zamijeniti je sa 00000.
Uslov je da se insertuju zapisi iz 1997. i većih godina (1998, 1999...), te da postoji datum isporuke. Zapise sortirati po vrijednosti troška prevoza.
*/
insert into narudzba
select orderID, OrderDate, RequiredDate, ShippedDate, Freight, ShipAddress + ' ' + isnull(ShipPostalCode, '00000') + ShipCity as PunaAdresa
from NORTHWND.dbo.Orders
where year(OrderDate) > 1996 and ShippedDate is not null -- postoji datum isporuke
order by Freight
 
--RJ: 657
 
/*
b) U tabelu Dobavljac insertovati zapise iz tabele Suppliers. Puna adresa će se sastojati od adrese, poštanskog broja i grada dobavljača.
*/
insert into dobavljac
select SupplierID, CompanyName, Address + ' '+ PostalCode + ' ' + City, Country
from NORTHWND.dbo.Suppliers
 
--RJ: 29
 
/*
c) U tabelu Proizvod insertovati zapise iz odgovarajućih kolona tabela Order Details i Product uz uslov da vrijednost cijene bude veća od
10, te da je na proizvod odobren popust. S obzirom na zadatak 2a voditi računa o postavljanju odgovarajućeg uslova da ne bi došlo do
konflikta u odnosu na NarudzbaID - potrebno je postaviti uslov da se insertuju zapisi iz 1997. i većih godina (1998, 1999...), te da postoji datum isporuke.
*/
 
insert into proizvod
select od.OrderID, p.SupplierID, p.ProductID, p.ProductName, p.UnitPrice, od.Quantity, od.Discount, p.Discontinued
from NORTHWND.dbo.[Order Details] as od inner join NORTHWND.dbo.Products as p
on od.ProductID = p.ProductID
inner join NORTHWND.dbo.Orders as o
on od.OrderID = o.OrderID
where od.Quantity > 10 and od.Discount > 0 and year (o.OrderDate) > 1996 and o.ShippedDate is not null
 
insert into proizvod
select od.OrderID, p.SupplierID, p.ProductID, p.ProductName, od.UnitPrice, od.Quantity, od.Discount, p.Discontinued
from NORTHWND.dbo.[Order Details] as od inner join NORTHWND.dbo.Products as p
on od.ProductID = p.ProductID
inner join NORTHWND.dbo.Orders as o
       on od.OrderID = o.OrderID
where od.Quantity > 10 and od.Discount > 0 and year (o.OrderDate) > 1996 and o.ShippedDate is not null
 
--RJ: 521
 
--3
/*
Iz tabele Proizvod dati pregled ukupnog broja ostvarenih narudzbi po dobavljaču i proizvodu.
*/
SELECT DobavljacID, NazivProizvoda, COUNT (NarudzbaID) AS UkupnoNarudzbi
FROM Proizvod
GROUP BY DobavljacID, NazivProizvoda
ORDER BY 1
--RJ: 76
 
--4
/*
Iz tabele Proizvod dati pregled ukupnog prometa ostvarenog po dobavljaču i narudžbi uz uslov da se prikažu samo oni zapisi kod kojih je vrijednost
prometa manja od 1000 i odobreni popust veći od 10%. Ukupni promet izračunati uz uzimanje u obzir i odobrenog popusta.
*/
SELECT DobavljacID, NarudzbaID, Popust, SUM (Cijena * Kolicina * (1 - Popust)) AS Promet
FROM Proizvod
WHERE Popust > 0.10
GROUP BY DobavljacID, NarudzbaID, Popust
HAVING SUM (Cijena * Kolicina * (1 - Popust)) < 1000
ORDER BY 1
--RJ: 242
 
--5
/*
Iz tabele Narudzba dati pregled svih narudzbi kod kojih je broj dana od datuma narudžbe do datuma isporuke manji od 10.
Pregled će se sastojati od ID narudžbe, broja dana razlike i kalendarske godine, pri čemu je razdvojiti pregled po godinama
(1997 i 1998 - prvo sve 1997, zatim sve 1998). Sortirati po broju dana isporuke u opadajućem redoslijedu.
*/
SELECT NarudzbaID, DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) AS BrDanaIsporuke, YEAR (DatumIsporuke) AS Godina
FROM Narudzba
WHERE DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) < 10
ORDER BY 3, 2
--RJ: 495
 
SELECT NarudzbaID, DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) AS BrDanaIsporuke, '1997' AS Godina
FROM Narudzba
WHERE YEAR (DatumIsporuke) = 1997 AND DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) < 10
UNION
SELECT NarudzbaID, DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) AS BrDanaIsporuke, '1998' AS Godina
FROM Narudzba
WHERE YEAR (DatumIsporuke) = 1998 AND DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) < 10
ORDER BY 2 DESC
 
--6
/*
Iz tabele Narudzba dati pregled svih narudzbi kod kojih je isporuka izvršena u istom mjesecu.
Pregled će se sastojati od ID narudžbe, broja dana razlike, mjeseca narudžbe, mjeseca isporuke i kalendarske godine, pri čemu je potrebno razdvojiti pregled po godinama
(1997 i 1998 - prvo sve 1997, zatim sve 1998). Sortirati po broju dana isporuke u opadajućem redoslijedu.
*/
SELECT NarudzbaID, DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) AS BrDanaIsporuke, MONTH (DatumIsporuke) AS MjesecNarudzbe, MONTH (DatumNarudzbe) AS MjesecIsporuke, YEAR (DatumIsporuke) AS Godina
FROM Narudzba
WHERE MONTH (DatumIsporuke) = MONTH (DatumNarudzbe)
ORDER BY 5, 2
--RJ: 464
 
--7
/*Iz tabele Narudzba dati pregled svih narudžbi koje su isporučene u Graz ili Köln.
Pregled će se sastojati od ID narudžbe i naziva grada. Sortirati po nazivu grada.
*/
SELECT NarudzbaID, RIGHT (PunaAdresa, 4) AS NazivGrada
FROM Narudzba
WHERE PunaAdresa LIKE '%Graz%' OR PunaAdresa LIKE '%Köln%'
ORDER BY 2
--RJ: 31
 
--8
/*
Iz tabela Narudzba, Dobavljac i Proizvod kreirati pregled koji će se sastojati od polja NarudzbaID, GodNarudzbe kao godinu iz polja DatumNarudzbe,
NazivProizvoda, NazivDobavljaca, Drzava, TrosakPrevoza, Ukupno kao ukupna vrijednost narudžbe koja će se računati uz uzimanje u obzir i popusta i postotak
koji će davati informaciju o vrijednosti postotka troška prevoza u odnosu na ukupnu vrijenost narudžbe.
Uslov je da postotak bude veći od 30% i da je ukupna vrijednost veća od troška prevoza. Sortirati po vrijednosti postotka u opadajućem redoslijedu.
*/
SELECT N.NarudzbaID, YEAR (N.DatumNarudzbe) AS GodNarudzbe, P.NazivProizvoda, D.NazivDobavljaca, D.Drzava,
             N.TrosakPrevoza, P.Cijena * P.Kolicina * (1 - P.Popust) AS Ukupno, LEFT (ROUND (N.TrosakPrevoza / (P.Cijena * P.Kolicina * (1 - P.Popust)) * 100, 2),5) AS Postotak
FROM   Narudzba AS N INNER JOIN Proizvod AS P
ON           N.NarudzbaID = P.NarudzbaID
             INNER JOIN Dobavljac AS D
             ON P.DobavljacID = D.DobavljacID
WHERE  N.TrosakPrevoza > 0.3 * (P.Cijena * P.Kolicina * (1 - P.Popust)) AND N.TrosakPrevoza < (P.Cijena * P.Kolicina * (1 - P.Popust))
ORDER BY 8 DESC
--RJ: 104
 
--9
/*
Iz tabela Narudzba, Dobavljac i Proizvod kreirati pogled koji će sadržavati ID narudžbe, dan iz datuma prijema, raspoloživost, naziv grada iz pune adrese naručitelja,
i državu dobavljača. Uslov je da je datum prijema u 2. ili 3. dekadi mjeseca i da grad naručitelja Bergamo.
*/
USE Indeks
GO
CREATE VIEW view1
AS
SELECT TOP 100 PERCENT N.NarudzbaID, DAY (N.DatumPrijema) AS DanPrijema, P.Raspolozivost, RIGHT (N.PunaAdresa, 7) AS NazivGrada, D.Drzava
FROM   Narudzba AS N INNER JOIN Proizvod AS P
ON           N.NarudzbaID = P.NarudzbaID
             INNER JOIN Dobavljac AS D
             ON P.DobavljacID = D.DobavljacID
WHERE  DAY (N.DatumPrijema) BETWEEN 11 AND 31 AND RIGHT (N.PunaAdresa, 7) = 'Bergamo'
ORDER BY 2
 
SELECT * FROM view1
--RJ: 5
 
--10
/*
Iz tabela Proizvod i Dobavljac kreirati proceduru proc1 koja će sadržavati ID i naziv dobavljača i ukupan broj proizvoda
koji je realizirao dobavljač. Pokrenuti proceduru za vrijednost ukupno realiziranog broja proizvoda 22 i 14.
*/
USE Indeks
GO
CREATE PROCEDURE proc1
(
       @DobavljacID int = NULL,
       @NazivDobavljaca nvarchar(40) = NULL,
       @UkBroj int = NULL
)
AS
BEGIN
SELECT P.DobavljacID, D.NazivDobavljaca, COUNT (P.ProizvodID) AS Broj
FROM   Proizvod AS P INNER JOIN Dobavljac AS D
ON           P.DobavljacID = D.DobavljacID
--WHERE      P.DobavljacID = @DobavljacID OR
--           NazivDobavljaca = @NazivDobavljaca OR
--           P.ProizvodID >= 0
GROUP BY P.DobavljacID, D.NazivDobavljaca
HAVING COUNT (P.ProizvodID) = @UkBroj
END
 
exec proc1 @UkBroj = 14
 
exec proc1 @UkBroj = 22
 
 
 
 
--1
/*
a) Koristeći izričito SQL kod kreirati bazu podataka pod vlastitim brojem indeksa.
*/
 
create database IspitniZadatak9
go
use IspitniZadatak9
 
 
 
--b) Kreiranje tabela. Voditi računa o međusobnom odnosu između tabela. Definirati odgovarajuće spoljne ključeve pomoću kojih će se tabele međusobno povezati.
/*
I. Kreirati tabelu narudzba sljedeće strukture:
       - narudzbaID cjelobrojna varijabla, primarni ključ
       - kupac, 40 unicode karaktera
       - puna_adresa, 80 unicode karaktera
       - datum_narudzbe, datumska varijabla
       - cijena_prevoza, novčana varijabla
*/
create table narudzba
(
       narudzbaID int constraint PK_narudzba primary key not null,
       kupac nvarchar (40),
       punaAdresa nvarchar (80),
       datumNarudzbe date,
       cijenaPrevoza money
)
 
/*
II. Kreirati tabelu proizvod sljedeće strukture:
       - proizvodID, , cjelobrojna varijabla, primarni ključ
       - naziv_proizvoda, 40 unicode karaktera
       - naziv_dobavljaca, 40 unicode karaktera
       - stanje_na_sklad, cjelobrojna varijabla
       - narucena_kol, cjelobrojna varijabla
 
*/
create table proizvod
(
       proizvodID int constraint PK_proizvod primary key not null,
       nazivProizvoda nvarchar (40),
       nazivDobavljaca nvarchar (40),
       stanjeNaSkladistu int,
       narucenaKolicina int
)
 
/*
II. Kreirati tabelu detalji_narudzbe sljedeće strukture:
       - narudzbaID, cjelobrojna varijabla
       - proizvodID, cjelobrojna varijabla
       - cijena_proizvoda, novčana varijabla
       - kolicina, cjelobrojna varijabla
       - popust, decimalna varijabla
*/
 
create table detaljiNarudzbe
(
       narudzbaID int,
       proizvodID  int,
       cijenaProizvoda money,
       kolicina int,
       popust decimal(8,2),
       constraint PK_detaljiNarudzbe primary key (narudzbaID, proizvodID),
       constraint FK_detaljiProizvod foreign key (proizvodID) references proizvod (proizvodID),
       constraint FK_detaljiNarudzba foreign key (narudzbaID) references narudzba (narudzbaID)
)
 
drop table detaljiNarudzbe
 
--10 bodova
 
---------------------------------------------------------------------------
--2. Import podataka
/*
Koristeći bazu Northwind u vlastiti bazu prebaciti podatke prema zadatim pravilima.
a) U tabelu narudzba iz tabela Customers i Orders prebaciti:
       - OrderID -> narudzbaID
       - CompanyName -> kupac
       - puna_adresa - spojiti podatke iz kolona Address, PostalCode i City pri čemu je potrebno podatke razdvojiti crticom
       - OrderDate -> datum_narudzbe
       - Freight -> cijena_prevoza
 
*/
insert into narudzba
select o.OrderID, c.CompanyName, c.Address + '-' + c.PostalCode + '-' + c.City as PunaAdresa, o.OrderDate, o.Freight
from NORTHWND.dbo.Customers as c inner join NORTHWND.dbo.Orders as o
on c.CustomerID = o.CustomerID
 
select*
from narudzba
--830
 
 
/*
b) U tabelu proizvod iz tabela Products i Suppliers prebaciti:
       - ProductID -> proizvodID
       - ProductName -> naziv_proizvoda
       - CompanyName -> naziv_dobavljaca
       - UnitsInStock -> stanje_na_sklad
       - UnitsOnOrder -> narucena_kol
*/
insert into proizvod
select p.ProductID, p.ProductName, s.CompanyName, p.UnitsInStock, p.UnitsOnOrder
from NORTHWND.dbo.Products as p inner join NORTHWND.dbo.Suppliers as s
on p.SupplierID = s.SupplierID
 
select*
from proizvod
--77
 
/*
c) U tabelu detalji_narudzbe iz tabela Order Details i Products prebaciti:
       - OrderID -> narudzbaID
       - ProductID -> proizvodID
       - UnitPrice -> cijena_proizvoda
       - Quantity -> kolicina
       - Discount -> popust
*/
 
insert into detaljiNarudzbe
select od.OrderID, p.ProductID, p.UnitPrice, od.Quantity, od.Discount
from NORTHWND.dbo.[Order Details] as od inner join NORTHWND.dbo.Products as p
on od.ProductID = p.ProductID
 
--2155
--10 bodova
 
---------------------------------------------------------------------------
/*
3.
a) Koristeći tabele narudzba i detalji_narudzbe kreirati pogled view_kupac_kol sljedeće strukture:
       -      narudzbaID
       -      kupac
       -      datum_narudzbe
       -      kolicina
uz uslov da je narudzba izvršena najranije 22 godine u odnosu na aktuelni datum.
*/
 
go
create view view_kupac_kol
as
select n.narudzbaID, n.kupac, n.datumNarudzbe, dn.kolicina
from narudzba as n inner join detaljiNarudzbe as dn
on n.narudzbaID = dn.narudzbaID
where datediff(year, n.datumNarudzbe, getdate()) < 25 --zapamti
go
 
--691
select * from view_kupac_kol
 
--12 bodova
 
---------------------------------------------------------------------------
/*
4.
Kreirati proceduru koja će imati istu strukturu kao tabela detalji_narudzba. Voditi računa o tipovima varijabli u proceduri.
Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti).
Uslov je da preuzmu samo oni zapisi u kojima nije odobren popust. Pokrenuti porceduru za sljedeće vrijednosti parametara:
1. količina = 10
2. ID narudžbe = 10255
*/
go
create procedure procedureDetaljiNarudzba
(
       @narudzbaID int = null,
       @proizvodID int = null,
       @cijenaProizvoda money = null,
       @kolicina int = null,
       @popust decimal(8,2) = null
)
as
begin
       select narudzbaID, proizvodID, cijenaProizvoda, kolicina, popust
       from detaljiNarudzbe
where (
                    @narudzbaID = narudzbaID or
                    @proizvodID = proizvodID or
                    @cijenaProizvoda = cijenaProizvoda or
                    @kolicina = kolicina or
                    @popust = popust ) and popust = 0
end
go
 
drop procedure procedureDetaljiNarudzba
 
exec procedureDetaljiNarudzba @kolicina = 10
exec procedureDetaljiNarudzba @narudzbaID = 10255
 
--130
--4
 
--8 bodova
 
---------------------------------------------------------------------------
/*
5. Kreirati pogled kojim će se dati prikaz naručenih količina prema mjesecu narudžbe.
Uslov je da je narudžba izvršena u 1996. godini. Pogled treba sadržavati ID narudžbe, redni broj mjeseca i količinu.
*/
go
create view zadatak5
as
select dn.narudzbaID, month(n.datumNarudzbe) as mjesec, dn.kolicina
from detaljiNarudzbe as dn inner join narudzba as n
on dn.narudzbaID = n.narudzbaID
where year(n.datumNarudzbe) = 1996
go
 
--405
 
select * from zadatak5
 
--7 bodova
 
---------------------------------------------------------------------------
/*
6.
a) Kreirati pogled koji će se sastojati od naziva dobavljača, naziva proizvoda,
ukupne cijene koja je proizvod jedinične cijene i količine, ukupne cijene s popustom koja predstavlja ukupnu cijenu sa obračunatim popustom i visinu popusta izraženu kao broj. Obratiti pažnju na
način računanja ukupne cijene s popustom. Uslov da je u pogledu budu samo oni zapisi kod kojih je odobren popust.
b) Koriseći pogled kreiran pod a) prikazati minimalnu, maksimalnu i srednju vrijednost visine popusta,
te razliku između minimalne i maksimalne vrijednosti. Srednja vrijednsot predstavlja srednju vrijednost novčanih vrijednosti, pa njen prikaz treba s tim uskladiti.
*/
--a
go
create view zadatak6
as
select p.nazivDobavljaca, p.nazivProizvoda, dn.cijenaProizvoda * dn.kolicina as ukupnaCijena, dn.cijenaProizvoda * dn.kolicina * (1 - dn.popust) as UkupnaCijenaSaPopustom,
             dn.cijenaProizvoda * dn.kolicina * dn.popust as visinaPopusta
from proizvod as p inner join detaljiNarudzbe as dn
on p.proizvodID = dn.proizvodID
where dn.popust > 0
go
 
select * from zadatak6
 
--838
 
--b
 
select min(visinaPopusta) as minimalno, max(visinaPopusta) as maksimalno, round(avg(visinaPopusta),2) as srednjaVrijednost, max(visinaPopusta) - min(visinaPopusta) as razlikaIzmedjuMaxiMin
from zadatak6
 
 
--8 bodova
 
---------------------------------------------------------------------------
/*
7.
a) Kreirati pogled koji će prikazati sumirane cijene proizvoda po nazivu proizvoda i popustu.
b) Koristeći pogled kreiran pod a) prikazati maksimalne vrijednosti suma po visinama popusta. Sortirati po vrijednostima popusta u rastućem redoslijedu.
c) Koristeći pogled kreiran pod a) prikazati srednje vrijednosti suma po nazivima proizvoda. Sortirati po vrijednostima suma u opadajućem redoslijedu.
--Voditi računa da je cijena proizvoda novčana varijabla, te prema tome formatirati srednje vrijednosti.
*/
--
--a
go
create view sumirano
as
select p.nazivProizvoda, dn.popust, sum(dn.cijenaProizvoda) as ukupno
from detaljiNarudzbe as dn inner join proizvod as p
on dn.proizvodID = p.proizvodID
group by p.nazivProizvoda, dn.popust
go
 
select *
from sumirano
 
--b
 
select popust, max(ukupno)
from sumirano
group by popust
 
--407
--11
/*
0.00   3530.90
0.01   15.00
0.02   25.00
0.03   33.25
0.04   81.00
0.05   1212.10
0.06   34.00
0.10   527.00
0.15   297.00
0.20   421.60
0.25   742.74
*/
--c
select nazivProizvoda, round(avg(ukupno),2)
from sumirano
group by nazivProizvoda
order by 2 desc
--77
--15 bodova
 
 
 
---------------------------------------------------------------------------
/*
8. Dati pregled kupovine po rednom broju dana u mjesecu. Upit treba da sadrži naziv proizvoda,
redni broj dana u mjesecu i ukupan broj prodaje proizvoda na taj redni broj dana. Npr, proizvod_1 se 1 dana u mjesecu prodao 3 puta. Uslova je da se dadne prikaz za prvu polovicu mjeseca.
*/
select p.nazivProizvoda, day(n.datumNarudzbe) as brojDana, count(day(n.datumNarudzbe))
from proizvod as p inner join detaljiNarudzbe as dn
on p.proizvodID = dn.proizvodID
inner join narudzba as n
on n.narudzbaID = dn.narudzbaID
where day(n.datumNarudzbe) between 1 and 15
group by p.nazivProizvoda, day(n.datumNarudzbe)
 
--646
--15 bodova
 
 
---------------------------------------------------------------------------
/*
9. Kreirati pregled kojim će se na osnovu podataka iz kolone puna_adresa prebrojati koliko puta se neka adresa pojavljuje.
Upit treba da sadrži adresu i broj pojavljivanja adrese. Npr. adresa 1 se pojavljuje 10 puta. Sortirati prema broju pojavljivanja u opadajućem redoslijedu.
*/
 
select  left(punaAdresa, (charindex ('-', punaAdresa)-1)) as dioAdrese, count( left(punaAdresa, (charindex ('-', punaAdresa)-1))) as prebrojano
from narudzba
group by left(punaAdresa, (charindex ('-', punaAdresa)-1))
order by 2 desc
 
-- left(punaAdresa, (charindex ('-', punaAdresa)-1))-- ovo mogu iskoristiiti za sifru sa apl roka
 
 
 
--89
--15 bodova
 
 
 
------------------------------------------------
--1
/*
a) Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
create database IspitniZadatak8
go
use IspitniZadatak8
 
 
--------------------------
 
/*Prilikom kreiranja tabela voditi računa o međusobnom odnosu između tabela.
b) Kreirati tabelu radnik koja će imati sljedeću strukturu:
       - radnikID, cjelobrojna varijabla, primarni ključ
       - drzavaID, 15 unicode karaktera
       - loginID, 256 unicode karaktera
       - sati_god_odmora, cjelobrojna varijabla
       - sati_bolovanja, cjelobrojna varijabla
*/
create table radnik
(
       radnikID int constraint PK_radnik primary key not null,
       drzavaID nvarchar (15),
       loginID nvarchar (256),
       satiGodisnjegOdmora int,
       satiBolovanja int
)
 
/*
c) Kreirati tabelu kupovina koja će imati sljedeću strukturu:
       - kupovinaID, cjelobrojna varijabla, primarni ključ
       - status, cjelobrojna varijabla
       - radnikID, cjelobrojna varijabla
       - br_racuna, 15 unicode karaktera
       - naziv_dobavljaca, 50 unicode karaktera
       - kred_rejting, cjelobrojna varijabla
*/
create table kupovina
(
       kupovinaID int constraint PK_kupovina primary key not null,
       status int,
       radnikID int,
       constraint FK_kupovina foreign key (radnikID) references radnik (radnikID),
       brRacuna nvarchar(15),
       nazivDobavljaca nvarchar (50),
       kredRejting int
)
 
/*
c) Kreirati tabelu prodaja koja će imati sljedeću strukturu:
       - prodavacID, cjelobrojna varijabla, primarni ključ
       - prod_kvota, novčana varijabla
       - bonus, novčana varijabla
       - proslogod_prodaja, novčana varijabla
       - naziv_terit, 50 unicode karaktera
*/
create table prodaja
(
       prodavacID int constraint PK_prodaja primary key not null,
       prodKvota money,
       bonus money,
       proslogodisnjaProdaja money,
       nazivteritorije nvarchar (50),
       constraint FK_ProdajaRadnik foreign key (prodavacID) references radnik (radnikID)
)
 
--10 bodova
 
 
--------------------------------------------
--2. Import podataka
/*
a) Iz tabele humanresources.employee baze AdventureWorks2014 u tabelu radnik importovati podatke po sljedećem pravilu:
       - BusinessEntityID -> radnikID
       - NationalIDNumber -> drzavaID
       - LoginID -> loginID
       - VacationHours -> sati_god_odmora
       - SickLeaveHours -> sati_bolovanja
*/
 
insert into radnik
select BusinessEntityID, NationalIDNumber, LoginID, VacationHours, SickLeaveHours
from AdventureWorks2014.HumanResources.Employee
 
--rj: 290
 
/*
b) Iz tabela purchasing.purchaseorderheader i purchasing.vendor baze AdventureWorks2014 u tabelu kupovina importovati podatke po sljedećem pravilu:
       - PurchaseOrderID -> kupovinaID
       - Status -> status
       - EmployeeID -> radnikID
       - AccountNumber -> br_racuna
       - Name -> naziv_dobavljaca
       - CreditRating -> kred_rejting
*/
insert into kupovina
select poh.PurchaseOrderID, poh.status, poh.EmployeeID, v.AccountNumber, v.Name, v.CreditRating
from AdventureWorks2014.Purchasing.PurchaseOrderHeader as poh inner join AdventureWorks2014.Purchasing.Vendor as v
on poh.VendorID = v.BusinessEntityID
 
--rj: 4012
 
/*
c) Iz tabela sales.salesperson i sales.salesterritory baze AdventureWorks2014 u tabelu prodaja importovati podatke po sljedećem pravilu:
       - BusinessEntityID -> prodavacID
       - SalesQuota -> prod_kvota
       - Bonus -> bonus
       - SalesLastYear -> proslogod_prodaja
       - Name -> naziv_terit
       - CreditRating -> kred_rejting // nema imena
*/
insert into prodaja
select sp.BusinessEntityID, sp.SalesQuota, sp.Bonus, sp.SalesLastYear, st.Name
from AdventureWorks2014.Sales.SalesPerson as sp inner join AdventureWorks2014.Sales.SalesTerritory as st
on sp.TerritoryID = st.TerritoryID
 
--rj: 14
--10 bodova
 
------------------------------------------
/*
3.
a) Iz tabela radnik i kupovina kreirati pogled view_bicikl koji će imati sljedeću strukturu:
       - kupovinaID,
       - naziv dobavljača,
       - kreditni rejting
Uslov je da u pogledu budu samo oni zapisi u kojima se prema nazivu dobavljača zaključuje da se bavi prodajom bicikla.
Obavezno napisati kod kojim će se dati prikaz sadržaja pogleda sortiran po ID kupovine.
b) Koristeći prethodno kreirani pogled prebrojati broj obavljenih kupovina prema kreditnom rejtingu. Pregled treba da sadrži oznaku kreditnog rejtinga i ukupan broj obavljenih kupovina.*/
--a
go
create view v_biciklo
as
select k.kupovinaID, k.nazivDobavljaca, k.kredRejting
from radnik as r inner join kupovina as k
on r.radnikID = k.radnikID
where k.nazivDobavljaca like '%Bi%'
go
 
select * from v_biciklo
order by kupovinaID
 
--rj: 1474
 
--b
select kredRejting, count(kredRejting) as UkupanBroj
from v_biciklo
group by kredRejting
order by 1
 
--rj: 3
/*
1      1273
3      151
5      50
*/
--10 bodova
-----------------------------------------------
/*
4.
Kreirati proceduru koja će imati istu strukturu kao pogled kreiran u prethodnom zadatku.
Voditi računa o tipovima varijabli u proceduri.
Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti).
Uslov je da se procedurom obuhvate oni zapisi iz pogleda kod kojih je kreditni rejting veći od 1, te da se izvrši sortiranje po kreditnom rejtingu. Pokrenuti proceduru za kreditni rejting 3 i 5.*/
 
go
create procedure zadatak4
(
       @kupovinaID int = null,
       @nazivDobavljaca nvarchar (50) = null,
       @kredRejting int = null
)
as
begin
select kupovinaID, nazivDobavljaca, kredRejting
from v_biciklo
where @kredRejting > 1 and
       (
             @kupovinaID = kupovinaID or
             @nazivDobavljaca = nazivDobavljaca or
             @kredRejting = kredRejting
       )
order by kredRejting
end
 
exec zadatak4 @kredRejting = 3
exec zadatak4 @kredRejting = 5
 
--rj: 151
 
--rj: 50
--10 bodova
 
 
 
 
-----------------------------------------------
/*
5.
a) U tabeli radnik kreirati neklasterirani indeks nad kolonom drzavaID. Uključiti kolone sati_god_odmora i sati_bolovanja.
b) Izvršiti testiranje kreiranog indeksa.
c) Obrisati prethodno kreirani indeks.
*/
create nonclustered index IX_ukupnoSati on radnik
(
       drzavaID asc
)
include (satiGodisnjegOdmora, satiBolovanja)
 
 
select*
from radnik
where drzavaID < 50000000 and satiGodisnjegOdmora > 80 and satiBolovanja > 40
 
drop index IX_ukupnoSati on radnik
--rj: 3
/*
53     9659517       adventure-works\diane0     87     63
210    20244403      adventure-works\belinda0   83     61
230    28414965      adventure-works\stuart1    88     64
*/
 
--5 bodova
-----------------------------------------------
/*
6.
a) Dati pregled kojim će se prebrojati zapisi u kojima je broj sati bolovanja veći od broja sati godišnjeg odmora,
uz uslov da je ta razlika veća od 10. Pregled treba da sadrži razliku sati i ukupan broj. Sortirati prema razlici sati.
b) Dati pregled svih zapisa kojim će se prebrojati broj država po prodajnim kvotama.
*/
--a
 
select  (satiBolovanja - satiGodisnjegOdmora) as razlikaSati, count(satiBolovanja - satiGodisnjegOdmora) as UkupanBroj
from radnik
where (satiBolovanja - satiGodisnjegOdmora) > 10
group by (satiBolovanja - satiGodisnjegOdmora)
order by (satiBolovanja - satiGodisnjegOdmora)
 
select *
from radnik
 
--rj: 12
 
--b
select count(r.drzavaID), p.prodKvota
from radnik as r inner join prodaja as p
on r.radnikID = p.prodavacID
group by p.prodKvota
 
select*
from radnik as r inner join prodaja as p
on r.radnikID = p.prodavacID
 
--rj: 2
/*
250000.00    11
300000.00    3
*/
--10 bodova
 
-------------------------------------------
/*
7.
a) Kreirati pogled dobavljaci_radnici koji će se sastojati od kolona naziv dobavljača i ukupan broj radnika.
Ukupan broj je podatak kojim se prebrojava broj radnika s kojima je dobavljač poslovao. Obavezno napisati kod kojim će se izvršiti pregled sadržaja pogleda sortiran po ukupnom broju.
b) Kreirati pregled kojim će se izvršiti prebrojavanje po ukupnom broju prebrojanih radnika.
c) Kreirati proceduru kojom će se iz pogleda kreiranog pod a) preuzeti zapisi u kojima je ukupan broj manji od 50. Voditi računa o tipovima podataka.
Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti). Pokrenuti proceduru za vrijednosti ukupan broj = 1, 2 i 50.
*/
--a
go
create view dobavljaci_radnici
as
select nazivDobavljaca, count(radnikID) as UkupanBrojRadnika
from kupovina
group by nazivDobavljaca
go
 
 
select *
from dobavljaci_radnici
 
--rj: 86
 
--b
select UkupanBrojRadnika, count(UkupanBrojRadnika)
from dobavljaci_radnici
group by UkupanBrojRadnika
order by UkupanBrojRadnika
 
--5
/*
1      4
2      2
4      1
50     29
51     50
*/
 
--c
 
--c) Kreirati proceduru kojom će se iz pogleda kreiranog pod a) preuzeti zapisi u kojima je ukupan broj manji od 50. Voditi računa o tipovima podataka.
--Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti).
--Pokrenuti proceduru za vrijednosti ukupan broj = 1, 2 i 50.
go
create procedure dobavljaci
(
       @nazivDobavljaca nvarchar (50) = null,
       @UkupanBrojRadnika int = null
)
as
begin
select nazivDobavljaca, UkupanBrojRadnika
from dobavljaci_radnici
where UkupanBrojRadnika < 51 and
       (
             @nazivDobavljaca = nazivDobavljaca or
             @UkupanBrojRadnika = UkupanBrojRadnika
       )
end
 
drop procedure dobavljaci
exec dobavljaci @UkupanBrojRadnika = 1
exec dobavljaci @UkupanBrojRadnika = 2
exec dobavljaci @UkupanBrojRadnika = 50
 
 
 
--rj: 1
--15 bodova
 
---------------------------------------
/*
8.
a) Iz tabela kupovina i radnik kreirati pogled view_sifra_transakc koja će se sastojati od sljedećih kolona:
       - naziv dobavljača,
       - ID države (odnosi se na radnika),
       - sifra_transakc
Podaci u koloni sifra_transakc će se formirati spajanjem karaktera koji se dobiju kada se iz kolone loginID tabele radnik ukloni dio 'adventure-works\' i posljednja 4 karaktera iz kolone br_racuna tabele kupovina, između kojih je potrebno umetnuti donju crtu (_).
Obavezno napisati kod za pregled sadržaja pogleda.
b) Iz prethodno kreiranog pogleda prebrojati sve zapise u kojima su i drzavaID i šifra transkacije parni brojevi .*/
*/
 
create view view_sifra_transakc
as
select k.nazivDobavljaca, r.drzavaID,   SUBSTRING(r.loginID, 17, 15) + +'-' + right(k.brRacuna,4) as SifraTRansakcije, r.loginID
from kupovina as k inner join radnik as r
on k.radnikID = r.radnikID
 
select *
from view_sifra_transakc
order by 1
 
--4012
select count (*)
from view_sifra_transakc
where right (drzavaID,1) in (0,2,4,6,8) and right (SifraTRansakcije,1) in (0,2,4,6,8)
 
--rj: count = 93 
--10 bodova
 
 
--------------------------------------------
/*
9.
a) U tabeli kupovina broj računa se sastoji od slovnog i brojčanog dijela. Kreirati pogled view_slovni kojim će se izvršiti prebrojavanje prema slovnom dijelu broja računa.
b) Koristeći prethodno kreirani pogled izvršiti prebrojavanje prema početnom slovu
c) Koristeći pogled kreiran pod a) izvršiti prebrojavanje ukupnog broj prebrojanih slovnih dijelova koji nisu jednocifreni.
*/
create view view_slovni
as
select left (brRacuna,LEN (brRacuna)-4) as slovni, COUNT (left (brRacuna,LEN (brRacuna)-4)) as count_slovni
from kupovina
group by left (brRacuna,LEN (brRacuna)-4)
--80
 
select LEFT (slovni,1), COUNT (LEFT (slovni,1))
from view_slovni
group by LEFT (slovni,1)
--18
 
select count_slovni, COUNT (count_slovni)
from view_slovni
where count_slovni > 9
group by count_slovni
--4
/*
50     29
51     41
102    3
154    1
*/
--15 bodova
 
 
 
--------------------------------------------
/*
10.
Kreirati upit kojim će dati prikaz kolone loginID nakon što se iz nje izbaci sve osim karaktera koji slijede nakon znaka \,
uz uslov da se prikažu samo oni zapisi u kojima je dužina novonastalog stringa kraća od 6 znakova.
*/
select substring (loginID,17,15)
from radnik
where LEN (substring (loginID,17,15)) < 6
--82
--5 bodova
 
--1.
/*
a) Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
 
create database IspitniZadatak7
go
use IspitniZadatak7
 
 
 
--b) Kreiranje tabela. Prilikom kreiranja tabela voditi računa o spojnim poljima između tabela.
/*
I. Kreirati tabelu TipProizv koja se sastoji od polja:
       - potkatID - cjelobrojna varijabla, primarni ključ
       - katID - cjelobrojna varijabla, obavezan unos
       - kat_naziv - 50 unicode karaktera, obavezan unos
       - potkat_naziv - 50 unicode karaktera, obavezan unos
*/
create table TipProizvodnje
(
       potkatID int constraint PK_tipProizvodnje primary key not null,
       katID int not null,
       katNaziv nvarchar (50) not null,
       potkatNaziv nvarchar (50)  not null
)
 
/*
II. Kreirati tabelu proizvod koja se sastoji od polja:
       - proizvodID - cjelobrojna varijabla, primarni ključ
       - naziv - 50 UNICODE karaktera, obavezan unos
       - boja - 15 UNICODE karaktera
       - tezina - decimalni broj  decimal(8, 2),
       - dana_za_proiz - cjelobrojna varijabla, obavezan unos
       - klasa - 2 unicode karaktera
       - potkat_ID cjelobrojna varijabla, obavezan unos
*/
create table proizvod
(
       proizvodID int constraint PK_proizvod primary key not null,
       naziv nvarchar(50) not null,
       boja nvarchar (15),
       tezina decimal (8,2),
       danaZaProizvodnju  int not null,
       klasa nvarchar (2),
       potkatID int not null,
       constraint FK_potkat foreign key (potkatID) references TipProizvodnje (potkatID)
)
 
/*
III. Kreirati tabelu nalog koja se sastoji od polja:
       - nalogID - cjelobrojna varijabla, primarni ključ
       - proizvodID - cjelobrojna varijabla, obavezan unos
       - naruc_kol - cjelobrojna varijabla, obavezan unos
       - stanje_kol - cjelobrojna varijabla, obavezan unos
       - dtm_zaduz - datumska varijabla samo za unos datuma (bez vremena)
       - oznaka_greske - 50 unicode karaktera, obavezan unos
*/
create table nalog
(
       nalogID int constraint PK_nalog primary key not null,
       proizvodID int not null,
       constraint FK_proizvod foreign key (nalogID) references proizvod (proizvodID),
       narucenaKolicina int not null,
       stanjeKolicina int not null,
       datumZaduzivanja date,
       oznakaGreske nvarchar (50) not null
)
 
create table nalozi
(
       nalogID int,
       proizvodID int not null,
       constraint PK_proizvoda primary key (proizvodID, nalogID),
       narucenaKolicina int not null,
       stanjeKolicine int not null,
       datumZaduzivanja date,
       oznakaGreske nvarchar (50) not null
)
 
drop table nalog
--15 bodova
 
-----------------------------------------------------------------------------------------------
--2. Importovanje podataka
/*
a) U tabelu TipProizv importovati podatke iz tabela ProductSubcategory i ProductCategory baze AdventureWorks2014 koje se nalaze u šemi Production na sljedeći način:
       - ProductSubcategoryID -> potkatID
       - ProductCategoryID -> katID
       - Name -> kat_naziv
       - Name -> potkat_naziv
Voditi računa o pripadnosti polja tabelama iz kojih se importuju podaci.
*/
 
insert into TipProizvodnje
select ps.ProductSubcategoryID, pc.ProductCategoryID, ps.name, pc.Name
from AdventureWorks2014.Production.ProductSubcategory as ps inner join AdventureWorks2014.Production.ProductCategory as pc
on ps.ProductCategoryID = pc.ProductCategoryID
 
--37
 
/*
b) U tabelu proizvod importovati podatke iz tabele Product baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
       - ProductID -> proizvodID
       - Name -> naziv
       - Color -> boja
       - Weight -> tezina
       - DaysToManufacture -> dana_za_proiz
       - Class -> klasa
       - ProductSubcategoryID -> potkatID
uz uslov da je ProductSubcategoryID sadrži vrijednost.
*/
insert into proizvod
select ProductID, name, color, Weight, DaysToManufacture, Class, ProductSubcategoryID
from AdventureWorks2014.Production.Product
where ProductSubcategoryID is not null
--295
 
/*
c) U tabelu nalog importovati podatke iz tabela WorkOrder i ScrapReason baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
       - WorkOrderID -> nalogID
       - ProductID -> proizvodID
       - OrderQty -> naruc_kol
       - StockedQty -> stanje_kol
       - DueDate -> dtm_zaduz
       - Name -> oznaka_greske
uz uslov da je ProductID veći ili jednak 680.
*/
 
insert into nalozi
select wo.WorkOrderID, wo.ProductID, wo.OrderQty, wo.StockedQty, wo.DueDate, sr.name
from AdventureWorks2014.Production.WorkOrder as wo inner join AdventureWorks2014.Production.ScrapReason as sr
on wo.ScrapReasonID = sr.ScrapReasonID
where wo.ProductID >= 680
 
--332
-- 15 bodova
 
-----------------------------------------------------------------------------------------------
--3.
/*
Iz tabele nalog dati pregled koji će se sastojati od polja:
       - godina - godina zaduženja proizvoda
       - uk_broj_po_god - ukupan broj zapisa po godinama
uz uslov da je proizvod zadužen u prvom polugodištu bilo koje godine.
Primjer za uk_broj: U tabeli se nalazi 5 zapisa kod kojih je datum zaduženja iz prvog polugodišta 2015. godine
*/
 
select year(datumZaduzivanja) as godina, count(datumZaduzivanja) as ukupanBrojPoGodinama
from nalog
where MONTH(datumZaduzivanja) < 7
group by year(datumZaduzivanja)
 
--4
/*
2011   2
2012   49
2013   72
2014   51
*/
--5 bodova
 
-----------------------------------------------------------------------------------------------
--4.
/*
Iz tabele nalog kreirati pogled view_razlika koji će se sastojati od polja:
       - razlika_stanja - razlika između naručene količine i količine na stanju
       - uk_broj_po_razlici - ukupan broj zapisa po vrijednosti razlike, npr. u tabeli se nalazi 5 zapisa kod kojih je razlika 10
uz uslov da je proizvod zadužen u 10. mjesecu bilo koje godine prije 2013.
Obavezno napisati naredbu za pregled sadržaja pogleda.
*/
 
go
create view view_Razlika
as
select narucenaKolicina - stanjeKolicine as razlikaStanja, count(narucenaKolicina - stanjeKolicine) as UkupanBrojPoRazlici
from nalog
where MONTH(datumZaduzivanja) = 10 and year(datumZaduzivanja) < 2013
group by narucenaKolicina - stanjeKolicine
go
 
 
select *
from view_Razlika
 
 
--6
/*
1      8
2      7
3      1
10     1
30     1
32     1
*/
--12 bodova
 
-----------------------------------------------------------------------------------------------
/*
5. Koristeći tabelu proizvod kreirati proceduru proc_proizvod kojom će se definirati sljedeći ulazni parametri:
- proizvodID
- boja
- tezina
- dana_za_proiz
Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koje polje bez unijetog parametra).
 
Proceduru pokrenuti za sljedeće vrijednosti parametara:
1. @boja = Black
2. @dana_za_proiz = 1
 
*/
go
create procedure proc_proizvod
(
       @proizvodID int = null,
       @boja nvarchar(15) = null,
       @tezina decimal(8,2) = null,
       @danaZaProizvodnju int = null
)
as
begin
select proizvodID, boja, tezina, danaZaProizvodnju
from proizvod
where (
                    @proizvodID = proizvodID or
                    @boja = boja or
                    @tezina = tezina or
                    @danaZaProizvodnju = danaZaProizvodnju
             )
end
go
 
exec proc_proizvod @boja = 'Black'
exec proc_proizvod @danaZaProizvodnju = 1
 
--89
--127
 
--8 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
6. Kreirati pregled koji će sadržavati polja:
       - potkatID
       - suma_tez u kojem će se nalaziti suma težina
Uslov je da naziv proizvoda počinje slovima HL, da se ne preuzimaju zapisi u kojima se nalaze vrijednosti u kolonama boja i tezina, te da je proizvod zaduzen u 2011. ili 2012. godini.
*/
 
select p.potkatID, sum(p.tezina) as sumaTezina
from proizvod as p inner join nalog as n
on p.proizvodID = n.proizvodID
where p.naziv like '%HL%' and p.boja is not null and p.tezina is not null and year(datumZaduzivanja) in (2011, 2012)
group by p.potkatID
 
 
 
--10 bodova
--3
/*
17     5270.00
12     27.56
14     6.52
*/
 
-----------------------------------------------------------------------------------------------
/*
7.
Kreirati pogled view_potkat_boja koji će se sastojati od polja:
       - potkatID
       - boja
       - uk_broj_po_oznaka_greske kojim će se prebrojati ukupan broj pojedinog naziva greške
Napisati naredbu za pregled sadržaja pogleda pri čemu će se izostaviti svi zapisi u kojima nije unijeta vrijednost za boju i uk_broj_po_oznaka_greske je neparan broj.
*/
go
create view view_potkatBoja
as
select p.potkatID, p.boja, count(oznakaGreske) as UkupanBrojGresaka
from nalog as n inner join proizvod as p
on n.proizvodID = p.proizvodID
group by p.potkatID, p.boja
go
 
select *
from view_potkatBoja
where boja is not null and right(UkupanBrojGresaka, 1) in (0,2,4,6,8)
 
--21
 
--7
--10 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
8. Kreirati pregled koji će sadržavati polja:
- naziv potkategorije
- sr_vr_tez - srednja vrijednost težine zaokružena na 2 decimalna mjesta (treća i ostale decimale su 0)
pri čemu se ne prikazuju zapisi u kojima ne postoji srednja vrijednost.
*/
select potkatNaziv, round (avg(p.tezina), 2) as srednjaVrijednost
from  tipProizvodnje as tp inner join proizvod as p
on tp.potkatID = p.potkatID
group by tp.potkatNaziv
having avg(p.tezina) is not null
 
 
--12
/*
Bottom Brackets            187.000000
Brakes                     317.000000
Cranksets                  603.330000
Derailleurs                151.500000
Mountain Bikes             25.060000
Mountain Frames            2.840000
Pedals                     187.330000
Road Bikes                 17.450000
Road Frames                2.310000
Touring Bikes       27.680000
Touring Frames             3.080000
Wheels                     890.000000
*/
--10 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
9.
Kreirati pogled kojim će se dati prikaz ID naloga, ID proizvoda, broja godina razlike u odnosu na aktivnu godinu,
oznaku boje koju će predstavljati prvo slovo naziva (npr. Purple -> P), klase i naziva potkategorije.
Izraz za izračunavanje broja godina razlike treba biti općeg karaktera. Uslov je da naziv potkategorije sadrži riječ Bikes, te da boja nije crna. Obavezno napisati kod za pregled sadržaja pogleda.
*/
--a
go
create view view_zadatak9
as
select n.nalogID, p.proizvodID, datediff(year, n.datumZaduzivanja, getdate()) as GodinaRazlike, left(p.boja, 1) as OznakaBoje, p.klasa, tp.potkatNaziv
from nalog as n inner join proizvod as p
on n.proizvodID = p.proizvodID
inner join tipProizvodnje as tp
on p.potkatID = tp.potkatID
where tp.potkatNaziv like '%Bike%' and p.boja  not like 'Black'
go
 
select *
from view_zadatak9
 
--59
--15 bodova
 
 
--1.
/*
a) Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
 
create database IspitniZadatak7
go
use IspitniZadatak7
 
 
 
--b) Kreiranje tabela. Prilikom kreiranja tabela voditi računa o spojnim poljima između tabela.
/*
I. Kreirati tabelu TipProizv koja se sastoji od polja:
       - potkatID - cjelobrojna varijabla, primarni ključ
       - katID - cjelobrojna varijabla, obavezan unos
       - kat_naziv - 50 unicode karaktera, obavezan unos
       - potkat_naziv - 50 unicode karaktera, obavezan unos
*/
create table TipProizvodnje
(
       potkatID int constraint PK_tipProizvodnje primary key not null,
       katID int not null,
       katNaziv nvarchar (50) not null,
       potkatNaziv nvarchar (50)  not null
)
 
/*
II. Kreirati tabelu proizvod koja se sastoji od polja:
       - proizvodID - cjelobrojna varijabla, primarni ključ
       - naziv - 50 UNICODE karaktera, obavezan unos
       - boja - 15 UNICODE karaktera
       - tezina - decimalni broj  decimal(8, 2),
       - dana_za_proiz - cjelobrojna varijabla, obavezan unos
       - klasa - 2 unicode karaktera
       - potkat_ID cjelobrojna varijabla, obavezan unos
*/
create table proizvod
(
       proizvodID int constraint PK_proizvod primary key not null,
       naziv nvarchar(50) not null,
       boja nvarchar (15),
       tezina decimal (8,2),
       danaZaProizvodnju  int not null,
       klasa nvarchar (2),
       potkatID int not null,
       constraint FK_potkat foreign key (potkatID) references TipProizvodnje (potkatID)
)
 
/*
III. Kreirati tabelu nalog koja se sastoji od polja:
       - nalogID - cjelobrojna varijabla, primarni ključ
       - proizvodID - cjelobrojna varijabla, obavezan unos
       - naruc_kol - cjelobrojna varijabla, obavezan unos
       - stanje_kol - cjelobrojna varijabla, obavezan unos
       - dtm_zaduz - datumska varijabla samo za unos datuma (bez vremena)
       - oznaka_greske - 50 unicode karaktera, obavezan unos
*/
create table nalog
(
       nalogID int constraint PK_nalog primary key not null,
       proizvodID int not null,
       constraint FK_proizvod foreign key (nalogID) references proizvod (proizvodID),
       narucenaKolicina int not null,
       stanjeKolicina int not null,
       datumZaduzivanja date,
       oznakaGreske nvarchar (50) not null
)
 
create table nalozi
(
       nalogID int,
       proizvodID int not null,
       constraint PK_proizvoda primary key (proizvodID, nalogID),
       narucenaKolicina int not null,
       stanjeKolicine int not null,
       datumZaduzivanja date,
       oznakaGreske nvarchar (50) not null
)
 
drop table nalog
--15 bodova
 
-----------------------------------------------------------------------------------------------
--2. Importovanje podataka
/*
a) U tabelu TipProizv importovati podatke iz tabela ProductSubcategory i ProductCategory baze AdventureWorks2014 koje se nalaze u šemi Production na sljedeći način:
       - ProductSubcategoryID -> potkatID
       - ProductCategoryID -> katID
       - Name -> kat_naziv
       - Name -> potkat_naziv
Voditi računa o pripadnosti polja tabelama iz kojih se importuju podaci.
*/
 
insert into TipProizvodnje
select ps.ProductSubcategoryID, pc.ProductCategoryID, ps.name, pc.Name
from AdventureWorks2014.Production.ProductSubcategory as ps inner join AdventureWorks2014.Production.ProductCategory as pc
on ps.ProductCategoryID = pc.ProductCategoryID
 
--37
 
/*
b) U tabelu proizvod importovati podatke iz tabele Product baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
       - ProductID -> proizvodID
       - Name -> naziv
       - Color -> boja
       - Weight -> tezina
       - DaysToManufacture -> dana_za_proiz
       - Class -> klasa
       - ProductSubcategoryID -> potkatID
uz uslov da je ProductSubcategoryID sadrži vrijednost.
*/
insert into proizvod
select ProductID, name, color, Weight, DaysToManufacture, Class, ProductSubcategoryID
from AdventureWorks2014.Production.Product
where ProductSubcategoryID is not null
--295
 
/*
c) U tabelu nalog importovati podatke iz tabela WorkOrder i ScrapReason baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
       - WorkOrderID -> nalogID
       - ProductID -> proizvodID
       - OrderQty -> naruc_kol
       - StockedQty -> stanje_kol
       - DueDate -> dtm_zaduz
       - Name -> oznaka_greske
uz uslov da je ProductID veći ili jednak 680.
*/
 
insert into nalozi
select wo.WorkOrderID, wo.ProductID, wo.OrderQty, wo.StockedQty, wo.DueDate, sr.name
from AdventureWorks2014.Production.WorkOrder as wo inner join AdventureWorks2014.Production.ScrapReason as sr
on wo.ScrapReasonID = sr.ScrapReasonID
where wo.ProductID >= 680
 
--332
-- 15 bodova
 
-----------------------------------------------------------------------------------------------
--3.
/*
Iz tabele nalog dati pregled koji će se sastojati od polja:
       - godina - godina zaduženja proizvoda
       - uk_broj_po_god - ukupan broj zapisa po godinama
uz uslov da je proizvod zadužen u prvom polugodištu bilo koje godine.
Primjer za uk_broj: U tabeli se nalazi 5 zapisa kod kojih je datum zaduženja iz prvog polugodišta 2015. godine
*/
 
 
select year (datumZaduzivanja) as GodinaZaduzivanja, count(datumZaduzivanja) as UkupanBrojZapisaPoGodinama
from nalozi
where MONTH(datumZaduzivanja) < 7
group by year (datumZaduzivanja)
 
select *
from nalozi
 
--4
/*
2011   2
2012   49
2013   72
2014   51
*/
--5 bodova
 
-----------------------------------------------------------------------------------------------
--4.
/*
Iz tabele nalog kreirati pogled view_razlika koji će se sastojati od polja:
       - razlika_stanja - razlika između naručene količine i količine na stanju
       - uk_broj_po_razlici - ukupan broj zapisa po vrijednosti razlike, npr. u tabeli se nalazi 5 zapisa kod kojih je razlika 10
uz uslov da je proizvod zadužen u 10. mjesecu bilo koje godine prije 2013.
Obavezno napisati naredbu za pregled sadržaja pogleda.
*/
 
go
create view viewRazlika
as
select narucenaKolicina - stanjeKolicine as RazlikaStanja, count(narucenaKolicina - stanjeKolicine) as UkupanBrojZapisaPoVrijednostiRazlike
from nalozi
where year(datumZaduzivanja) < 2013 and MONTH(datumZaduzivanja) = 10
group by narucenaKolicina - stanjeKolicine
go
 
select*
from nalozi
 
select*
from viewRazlika
 
 
 
--6
/*
1      8
2      7
3      1
10     1
30     1
32     1
*/
--12 bodova
 
-----------------------------------------------------------------------------------------------
/*
5. Koristeći tabelu proizvod kreirati proceduru proc_proizvod kojom će se definirati sljedeći ulazni parametri:
- proizvodID
- boja
- tezina
- dana_za_proiz
Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koje polje bez unijetog parametra).
 
Proceduru pokrenuti za sljedeće vrijednosti parametara:
1. @boja = Black
2. @dana_za_proiz = 1
 
*/
go
create procedure proceduraProizvod
(
       @proizvodID int = null,
       @boja nvarchar (15) = null,
       @tezina decimal (8,2) = null,
       @danaZaProizvodnju int = null
)
as
begin
select proizvodID, boja, tezina, danaZaProizvodnju
from proizvod
where (
                    @proizvodID = proizvodID or
                    @boja = boja or
                    @tezina = tezina or
                    @danaZaProizvodnju = danaZaProizvodnju
             )
end
go
 
exec proceduraProizvod @danaZaProizvodnju = 1
exec proceduraProizvod @boja = 'Black'
 
--89
--127
 
--8 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
6. Kreirati pregled koji će sadržavati polja:
       - potkatID
       - suma_tez u kojem će se nalaziti suma težina
Uslov je da naziv proizvoda počinje slovima HL, da se ne preuzimaju zapisi u kojima se nalaze vrijednosti u kolonama boja i tezina, te da je proizvod zaduzen u 2011. ili 2012. godini.
*/
 
select p.potkatID, sum(p.tezina) as sumaTezina
from proizvod as p inner join nalozi as n
on p.proizvodID = n.proizvodID
where p.naziv like '%HL%' and p.boja is not null and p.tezina is not null and year(datumZaduzivanja) in (2011, 2012)
group by p.potkatID
order by sum(p.tezina) desc
 
select p.naziv
from proizvod as p inner join nalozi as n
on p.proizvodID = n.proizvodID
 
 
--10 bodova
--3
/*
17     5270.00
12     27.56
14     6.52
*/
 
-----------------------------------------------------------------------------------------------
/*
7.
Kreirati pogled view_potkat_boja koji će se sastojati od polja:
       - potkatID
       - boja
       - uk_broj_po_oznaka_greske kojim će se prebrojati ukupan broj pojedinog naziva greške
Napisati naredbu za pregled sadržaja pogleda pri čemu će se izostaviti svi zapisi u kojima nije unijeta vrijednost za boju i uk_broj_po_oznaka_greske je neparan broj.
*/
go
create view viewPotkatBoja
as
select p.potkatID, p.boja, count(n.oznakaGreske) as ukupanBrojGresaka
from proizvod as p inner join nalozi as n
on p.proizvodID = n.proizvodID
group by p.potkatID, p.boja
go
 
--21
 
select*
from viewPotkatBoja
where boja is not null and right(ukupanBrojGresaka, 1) in (0,2,4,6,8)
 
--7
--10 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
8. Kreirati pregled koji će sadržavati polja:
- naziv potkategorije
- sr_vr_tez - srednja vrijednost težine zaokružena na 2 decimalna mjesta (treća i ostale decimale su 0)
pri čemu se ne prikazuju zapisi u kojima ne postoji srednja vrijednost.
*/
 
select tp.potkatNaziv, round(avg(p.tezina),2) as SrednjaVrijednost
from TipProizvodnje as tp inner join proizvod as p
on tp.potkatID = p.potkatID
group by tp.potkatNaziv
having avg(p.tezina) is not null
 
select tp.potkatNaziv
from TipProizvodnje as tp inner join proizvod as p
on tp.potkatID = p.potkatID
 
 
--12
/*
Bottom Brackets            187.000000
Brakes                     317.000000
Cranksets                  603.330000
Derailleurs                151.500000
Mountain Bikes             25.060000
Mountain Frames            2.840000
Pedals                     187.330000
Road Bikes                 17.450000
Road Frames                2.310000
Touring Bikes       27.680000
Touring Frames             3.080000
Wheels                     890.000000
*/
--10 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
9.
Kreirati pogled kojim će se dati prikaz ID naloga, ID proizvoda, broja godina razlike u odnosu na aktivnu godinu,
oznaku boje koju će predstavljati prvo slovo naziva (npr. Purple -> P), klase i naziva potkategorije.
Izraz za izračunavanje broja godina razlike treba biti općeg karaktera. Uslov je da naziv potkategorije sadrži riječ Bikes, te da boja nije crna. Obavezno napisati kod za pregled sadržaja pogleda.
*/
--a
 
go
create view viewZadatak9
as
select n.nalogID, p.proizvodID, datediff(year, n.datumZaduzivanja, getdate()) as GodinaRazlike, left(p.boja, 1) as OznakaBoje, p.klasa, tp.potkatNaziv
from nalozi as n inner join proizvod as p
on n.proizvodID = p.proizvodID
inner join TipProizvodnje as tp
on p.potkatID = tp.potkatID
where tp.potkatNaziv like '%Bikes%' and p.boja not like 'Black'
go
 
select*
from viewZadatak9
 
 
 
--59
--15 bodova
 
 
--1.
/*
a) Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
 
 
 
create database IspitniZadatak6
go
use IspitniZadatak6
 
 
 
--b) Kreiranje tabela. Prilikom kreiranja tabela voditi računa o spojnim poljima između tabela.
/*
I. Kreirati tabelu TipProizv koja se sastoji od polja:
       - potkatID - cjelobrojna varijabla, primarni ključ
       - katID - cjelobrojna varijabla, obavezan unos
       - kat_naziv - 50 unicode karaktera, obavezan unos
       - potkat_naziv - 50 unicode karaktera, obavezan unos
*/
 
create table TipProizvodnje
(
       potkatID int constraint PK_tipProizvodnje primary key not null,
       katID int not null,
       katNaziv nvarchar (50) not null,
       potkatNaziv nvarchar (50) not null
)
 
/*
II. Kreirati tabelu proizvod koja se sastoji od polja:
       - proizvodID - cjelobrojna varijabla, primarni ključ
       - naziv - 50 UNICODE karaktera, obavezan unos
       - boja - 15 UNICODE karaktera
       - tezina - decimalni broj  decimal(8, 2),
       - dana_za_proiz - cjelobrojna varijabla, obavezan unos
       - klasa - 2 unicode karaktera
       - potkat_ID cjelobrojna varijabla, obavezan unos
*/
create table proizvod
(
       proizvodID int constraint PK_proizvod primary key not null,
       naziv nvarchar (50) not null,
       boja nvarchar (15),
       tezina decimal (8,2),
       danaZaProizvodnju int not null,
       klasa nvarchar (2),
       potkatID int not null,
       constraint FK_potkatID foreign key (potkatID) references TipProizvodnje (potkatID)
)
 
/*
III. Kreirati tabelu nalog koja se sastoji od polja:
       - nalogID - cjelobrojna varijabla, primarni ključ
       - proizvodID - cjelobrojna varijabla, obavezan unos
       - naruc_kol - cjelobrojna varijabla, obavezan unos
       - stanje_kol - cjelobrojna varijabla, obavezan unos
       - dtm_zaduz - datumska varijabla samo za unos datuma (bez vremena)
       - oznaka_greske - 50 unicode karaktera, obavezan unos
*/
 
create table nalog
(
       nalogID int,
       proizvodID int not null,
       constraint PK_proizvoda primary key (proizvodID, nalogID),
       narucenaKolicina int not null,
       stanjeKolicine int not null,
       datumZaduzivanja date,
       oznakaGreske nvarchar (50) not null
)
 
drop table nalog
--15 bodova
 
-----------------------------------------------------------------------------------------------
--2. Importovanje podataka
/*
a) U tabelu TipProizv importovati podatke iz tabela ProductSubcategory i ProductCategory baze AdventureWorks2014 koje se nalaze u šemi Production na sljedeći način:
       - ProductSubcategoryID -> potkatID
       - ProductCategoryID -> katID
       - Name -> kat_naziv
       - Name -> potkat_naziv
Voditi računa o pripadnosti polja tabelama iz kojih se importuju podaci.
*/
insert into TipProizvodnje
select ps.ProductSubcategoryID, pc.ProductCategoryID, ps.name, pc.Name
from AdventureWorks2014.Production.ProductSubcategory as ps inner join AdventureWorks2014.Production.ProductCategory as pc
on ps.ProductCategoryID = pc.ProductCategoryID
 
--37
 
/*
b) U tabelu proizvod importovati podatke iz tabele Product baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
       - ProductID -> proizvodID
       - Name -> naziv
       - Color -> boja
       - Weight -> tezina
       - DaysToManufacture -> dana_za_proiz
       - Class -> klasa
       - ProductSubcategoryID -> potkatID
uz uslov da je ProductSubcategoryID sadrži vrijednost.
*/
insert into proizvod
select ProductID, name, color, Weight, DaysToManufacture, Class, ProductSubcategoryID
from AdventureWorks2014.Production.Product
where ProductSubcategoryID is not null
--295
 
/*
c) U tabelu nalog importovati podatke iz tabela WorkOrder i ScrapReason baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
       - WorkOrderID -> nalogID
       - ProductID -> proizvodID
       - OrderQty -> naruc_kol
       - StockedQty -> stanje_kol
       - DueDate -> dtm_zaduz
       - Name -> oznaka_greske
uz uslov da je ProductID veći ili jednak 680.
*/
 
insert into nalog
select wo.WorkOrderID, wo.ProductID, wo.OrderQty, wo.StockedQty, wo.DueDate, sr.name
from AdventureWorks2014.Production.WorkOrder as wo inner join AdventureWorks2014.Production.ScrapReason as sr
on wo.ScrapReasonID = sr.ScrapReasonID
where wo.ProductID >= 680
 
--332
-- 15 bodova
 
-----------------------------------------------------------------------------------------------
--3.
/*
Iz tabele nalog dati pregled koji će se sastojati od polja:
       - godina - godina zaduženja proizvoda
       - uk_broj_po_god - ukupan broj zapisa po godinama
uz uslov da je proizvod zadužen u prvom polugodištu bilo koje godine.
Primjer za uk_broj: U tabeli se nalazi 5 zapisa kod kojih je datum zaduženja iz prvog polugodišta 2015. godine
*/
 
select year(datumZaduzivanja) as godina, count(datumZaduzivanja) as ukupanBrojPoGodinama
from nalog
where MONTH(datumZaduzivanja) < 7
group by year(datumZaduzivanja)
 
--4
/*
2011   2
2012   49
2013   72
2014   51
*/
--5 bodova
 
-----------------------------------------------------------------------------------------------
--4.
/*
Iz tabele nalog kreirati pogled view_razlika koji će se sastojati od polja:
       - razlika_stanja - razlika između naručene količine i količine na stanju
       - uk_broj_po_razlici - ukupan broj zapisa po vrijednosti razlike, npr. u tabeli se nalazi 5 zapisa kod kojih je razlika 10
uz uslov da je proizvod zadužen u 10. mjesecu bilo koje godine prije 2013.
Obavezno napisati naredbu za pregled sadržaja pogleda.
*/
 
go
create view view_Razlika
as
select narucenaKolicina - stanjeKolicine as razlikaStanja, count(narucenaKolicina - stanjeKolicine) as UkupanBrojPoRazlici
from nalog
where MONTH(datumZaduzivanja) = 10 and year(datumZaduzivanja) < 2013
group by narucenaKolicina - stanjeKolicine
go
 
 
select *
from view_Razlika
 
 
--6
/*
1      8
2      7
3      1
10     1
30     1
32     1
*/
--12 bodova
 
-----------------------------------------------------------------------------------------------
/*
5. Koristeći tabelu proizvod kreirati proceduru proc_proizvod kojom će se definirati sljedeći ulazni parametri:
- proizvodID
- boja
- tezina
- dana_za_proiz
Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koje polje bez unijetog parametra).
 
Proceduru pokrenuti za sljedeće vrijednosti parametara:
1. @boja = Black
2. @dana_za_proiz = 1
 
*/
go
create procedure proc_proizvod
(
       @proizvodID int = null,
       @boja nvarchar(15) = null,
       @tezina decimal(8,2) = null,
       @danaZaProizvodnju int = null
)
as
begin
select proizvodID, boja, tezina, danaZaProizvodnju
from proizvod
where (
                    @proizvodID = proizvodID or
                    @boja = boja or
                    @tezina = tezina or
                    @danaZaProizvodnju = danaZaProizvodnju
             )
end
go
 
exec proc_proizvod @boja = 'Black'
exec proc_proizvod @danaZaProizvodnju = 1
 
--89
--127
 
--8 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
6. Kreirati pregled koji će sadržavati polja:
       - potkatID
       - suma_tez u kojem će se nalaziti suma težina
Uslov je da naziv proizvoda počinje slovima HL, da se ne preuzimaju zapisi u kojima se nalaze vrijednosti u kolonama boja i tezina, te da je proizvod zaduzen u 2011. ili 2012. godini.
*/
 
select p.potkatID, sum(p.tezina) as sumaTezina
from proizvod as p inner join nalog as n
on p.proizvodID = n.proizvodID
where p.naziv like '%HL%' and p.boja is not null and p.tezina is not null and year(datumZaduzivanja) in (2011, 2012)
group by p.potkatID
 
 
 
--10 bodova
--3
/*
17     5270.00
12     27.56
14     6.52
*/
 
-----------------------------------------------------------------------------------------------
/*
7.
Kreirati pogled view_potkat_boja koji će se sastojati od polja:
       - potkatID
       - boja
       - uk_broj_po_oznaka_greske kojim će se prebrojati ukupan broj pojedinog naziva greške
Napisati naredbu za pregled sadržaja pogleda pri čemu će se izostaviti svi zapisi u kojima nije unijeta vrijednost za boju i uk_broj_po_oznaka_greske je neparan broj.
*/
go
create view view_potkatBoja
as
select p.potkatID, p.boja, count(oznakaGreske) as UkupanBrojGresaka
from nalog as n inner join proizvod as p
on n.proizvodID = p.proizvodID
group by p.potkatID, p.boja
go
 
select *
from view_potkatBoja
where boja is not null and right(UkupanBrojGresaka, 1) in (0,2,4,6,8)
 
--21
 
--7
--10 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
8. Kreirati pregled koji će sadržavati polja:
- naziv potkategorije
- sr_vr_tez - srednja vrijednost težine zaokružena na 2 decimalna mjesta (treća i ostale decimale su 0)
pri čemu se ne prikazuju zapisi u kojima ne postoji srednja vrijednost.
*/
select potkatNaziv, round (avg(p.tezina), 2) as srednjaVrijednost
from  TipProizvodnje as tp inner join proizvod as p
on tp.potkatID = p.potkatID
group by tp.potkatNaziv
having avg(p.tezina) is not null
 
 
--12
/*
Bottom Brackets            187.000000
Brakes                     317.000000
Cranksets                  603.330000
Derailleurs                151.500000
Mountain Bikes             25.060000
Mountain Frames            2.840000
Pedals                     187.330000
Road Bikes                 17.450000
Road Frames                2.310000
Touring Bikes       27.680000
Touring Frames             3.080000
Wheels                     890.000000
*/
--10 bodova
 
 
-----------------------------------------------------------------------------------------------
/*
9.
Kreirati pogled kojim će se dati prikaz ID naloga, ID proizvoda, broja godina razlike u odnosu na aktivnu godinu,
oznaku boje koju će predstavljati prvo slovo naziva (npr. Purple -> P), klase i naziva potkategorije.
Izraz za izračunavanje broja godina razlike treba biti općeg karaktera. Uslov je da naziv potkategorije sadrži riječ Bikes, te da boja nije crna. Obavezno napisati kod za pregled sadržaja pogleda.
*/
--a
go
create view view_zadatak9
as
select n.nalogID, p.proizvodID, datediff(year, n.datumZaduzivanja, getdate()) as GodinaRazlike, left(p.boja, 1) as OznakaBoje, p.klasa, tp.potkatNaziv
from nalog as n inner join proizvod as p
on n.proizvodID = p.proizvodID
inner join TipProizvodnje as tp
on p.potkatID = tp.potkatID
where tp.potkatNaziv like '%Bike%' and p.boja  not like 'Black'
go
 
select *
from view_zadatak9
 
--59
--15 bodova
 
 
/*
Napomena:
A.
Prilikom  bodovanja rješenja prioritet ima rezultat koji upit treba da vrati (broj zapisa, vrijednosti agregatnih funkcija...).
U sluèaju da rezultat upita nije taèan, a pogled, tabela... koji su rezultat tog upita se koriste u narednim zadacima,
tada se rješenja narednih zadataka, bez obzira na taènost koda, ne boduju punim brojem bodova,
jer ni ta rješenja ne mogu vratiti taèan rezultat (broj zapisa, vrijednosti agregatnih funkcija...).
B.
Tokom pisanja koda obratiti posebnu pažnju na tekst zadatka i ono što se traži zadatkom.
Prilikom pregleda rada pokreæe se kod koji se nalazi u sql skripti i
sve ono što nije uraðeno prema zahtjevima zadatka ili je pogrešno uraðeno predstavlja grešku.
*/
 
------------------------------------------------
--1
/*
Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
 
create database IspitniZadatak4
go
use IspitniZadatak4
 
 
 
/*Prilikom kreiranja tabela voditi raèuna o meðusobnom odnosu izmeðu tabela.
a) Kreirati tabelu radnik koja æe imati sljedeæu strukturu:
       - radnikID, cjelobrojna varijabla, primarni kljuè
       - drzavaID, 15 unicode karaktera
       - loginID, 256 unicode karaktera
       - sati_god_odmora, cjelobrojna varijabla
       - sati_bolovanja, cjelobrojna varijabla
*/
create table radnik
(
       radnikID int constraint PK_radnik primary key not null,
       drzavaID nvarchar (15),
       loginID nvarchar (256),
       satiGodisnjegOdmora int,
       satiBolovanja int
)
 
/*
b) Kreirati tabelu nabavka koja æe imati sljedeæu strukturu:
       - nabavkaID, cjelobrojna varijabla, primarni kljuè
       - status, cjelobrojna varijabla
       - nabavaljacID, cjelobrojna varijabla
       - br_racuna, 15 unicode karaktera
       - naziv_nabavljaca, 50 unicode karaktera
       - kred_rejting, cjelobrojna varijabla
*/
create table nabavka
(
       nabavkaID int constraint PK_nabavka primary key not null,
       status int,
       nabavljacID int,
       brojRacuna nvarchar (15),
       nazivDobavljaca nvarchar (50),
       kreditniRejting int,
       constraint FK_radnikID foreign key (nabavljacID) references radnik(radnikID)
)
 
/*
c) Kreirati tabelu prodaja koja æe imati sljedeæu strukturu:
       - prodavacID, cjelobrojna varijabla, primarni kljuè
       - prod_kvota, novèana varijabla
       - bonus, novèana varijabla
       - proslogod_prodaja, novèana varijabla
       - naziv_terit, 50 unicode karaktera
*/
--10 bodova
 
create table prodaja
(
       prodavacID int constraint PK_prodaja primary key not null,
       prodKvota money,
       bonus money,
       proslogodisnjaProdaja money,
       nazivTeritorije nvarchar (50)
       constraint FK_prodaja foreign key (prodavacID) references radnik (radnikID)
)
 
 
 
--------------------------------------------
--2. Import podataka
/*
a) Iz tabele HumanResources.Employee AdventureWorks2017 u tabelu radnik importovati podatke po sljedeæem pravilu:
       - BusinessEntityID -> radnikID
       - NationalIDNumber -> drzavaID
       - LoginID -> loginID
       - VacationHours -> sati_god_odmora
       - SickLeaveHours -> sati_bolovanja
*/
insert into radnik
select BusinessEntityID, NationalIDNumber, LoginID, VacationHours, SickLeaveHours
from AdventureWorks2014.HumanResources.Employee
 
 
 
 
/*
b) Iz tabela Purchasing.PurchaseOrderHeader i Purchasing.Vendor baze AdventureWorks2017 u tabelu nabavka importovati podatke po sljedeæem pravilu:
       - PurchaseOrderID -> nabavkaID
       - Status -> status
       - EmployeeID -> radnikID
       - AccountNumber -> br_racuna
       - Name -> naziv_nabavljaca
       - CreditRating -> kred_rejting
*/
 
insert into nabavka
select poh.PurchaseOrderID, poh.Status, poh.EmployeeID, v.AccountNumber, v.Name, v.CreditRating
from AdventureWorks2014.Purchasing.PurchaseOrderHeader as poh inner join AdventureWorks2014.Purchasing.Vendor as v
on poh.VendorID = v.BusinessEntityID
 
select *
from nabavka
 
 
/*
c) Iz tabela Sales.SalesPerson i Sales.SalesTerritory baze AdventureWorks2017 u tabelu prodaja importovati podatke po sljedeæem pravilu:
       - BusinessEntityID -> prodavacID
       - SalesQuota -> prod_kvota
       - Bonus -> bonus
       - SalesLastYear iz Sales.SalesPerson -> proslogod_prodaja
       - Name -> naziv_terit
*/
 
insert into prodaja
select sp.BusinessEntityID, sp.SalesQuota, sp.bonus, sp.SalesLastYear, st.name
from AdventureWorks2014.sales.SalesPerson as sp inner join AdventureWorks2014.Sales.SalesTerritory as st
on sp.TerritoryID = st.TerritoryID
 
 
select * from prodaja
select * from radnik
 
--10 bodova
 
------------------------------------------
/*
3.
a) Iz tabela radnik i nabavka kreirati pogled view_drzavaID koji æe imati sljedeæu strukturu:
       - nabavkaID,
       - loginID,
       - status
       - naziv nabavljaèa,
       - kreditni rejting
Uslov je da u pogledu budu zapisi u kojima je kreditni rejting veæi od 1.
b) Koristeæi prethodno kreirani pogled prebrojati broj obavljenih nabavki prema kreditnom rejtingu.
Npr. kreditni rejting 8 se pojavljuje 20 puta. Pregled treba da sadrži oznaku kreditnog rejtinga i ukupan broj obavljenih nabavki.
*/
--10 bodova
 
--a
go
create view viweDrzavaID
as
select n.nabavkaID, r.loginID, n.status, n.nazivDobavljaca, n.kredRejting
from nabavka as n inner join radnik as r
on n.nabavljacID = r.radnikID
where n.kredRejting > 1
 
 
select * from viweDrzavaID
 
 
--b
select count(kredRejting)
from viweDrzavaID
group by kredRejting
 
-----------------------------------------------
/*
4.
Kreirati proceduru koja æe imati istu strukturu kao pogled kreiran u prethodnom zadatku. Proceduru kreirati tako da je prilikom izvršavanja moguæe unijeti
bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti), uz uslov da je status veæi od 2. Pokrenuti proceduru za kreditni rejting 3 i 5.
*/
--10 bodova
 
go
create procedure zadatak4
(
       @nabavkaID int = null,
       @loginID nvarchar (2) = null,
       @status int = null,
       @nazivDobavljaca nvarchar (50) = null,
       @kredRejting int = null
)
as
begin
       select n.nabavkaID, r.loginID, n.status, n.nazivDobavljaca, n.kredRejting
       from radnik as r inner join nabavka as n
       on r.radnikID = n.nabavkaID
       where (      
                           @nabavkaID = n.nabavkaID or
                           @loginID = r.loginID or
                           @status = n.status or
                           @nazivDobavljaca = n.nazivDobavljaca or
                           @kredRejting = n.kredRejting
                    ) and n.status > 2
end
 
exec zadatak4 @kredRejting = 3
exec zadatak4 @kredRejting = 5
 
 
-------------------------------------------
/*
5.
a) Kreirati pogled nabavljaci_radnici koji æe se sastojati od kolona naziv dobavljaèa i prebrojani_broj radnika. prebrojani_broj je podatak kojim se prebrojava broj
radnika s kojima je dobavljaè poslovao. Obavezno napisati kod kojim æe se izvršiti pregled sadržaja pogleda sortiran po ukupnom broju.
b) Kreirati proceduru kojom æe se iz pogleda kreiranog pod a) preuzeti zapisi u kojima je prebrojani_broj manji od 50. Proceduru kreirati tako da je prilikom izvršavanja
moguæe unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti). Pokrenuti proceduru za vrijednosti prebrojani_broj = 1 i 2.
*/
--15 bodova
 
--a
go
create view viewNabavljaciRadnici
as
select n.nazivDobavljaca, count (r.radnikID) as prebrojaniBrojRadnika
from radnik as r inner join nabavka as n
on r.radnikID = n.nabavkaID
group by n.nazivDobavljaca
      
select *
from viewNabavljaciRadnici
order by prebrojaniBrojRadnika
 
--b
 
create procedure zadatak5
(
       @nazivDobavljaca nvarchar (50) = null,
       @prebrojaniBrojRadnika int = null
)
as
begin
       select *
       from viewNabavljaciRadnici
       where (
                    @nazivDobavljaca = nazivDobavljaca or
                    @prebrojaniBrojRadnika = prebrojaniBrojRadnika)
                    and prebrojaniBrojRadnika < 50
end
exec zadatak5 @prebrojaniBrojRadnika = 1
exec zadatak5 @prebrojaniBrojRadnika = 2
 
exec zad5b @prebrojani_broj = 1
exec zad5b @prebrojani_broj = 2
 
 
--------------------------------------------
/*
6.
a) U tabeli radnik dodati kolonu razlika_sati kao cjelobrojnu varijablu sa obaveznom default vrijednošæu 0.
b) U koloni razlika_sati ostaviti 0 ako su sati bolovanja veæi od godišnjeg odmora, inaèe u kolonu smjestiti vrijednost razlike izmeðu sato_bolovanja i sati_god_odmora.
c) Kreirati pogled view_sati u kojem æe biti poruka da li radnik ima više sati godišnjeg odmora ili bolovanja.
Ako je više bolovanja daje se poruka ""bolovanje"", inaèe ""godisnji"". Pogled treba da sadrži ID radnika i poruku.
*/
--10 bodova
 
--a
alter table radnik
add razlikaSati int default(0)
 
--b
update radnik
set razlikaSati =
       case
       when satiBolovanja > satiGodOdmora then 0
       when satiBolovanja <= satiGodOdmora then satiBolovanja - satiGodOdmora
       end
 
select * from radnik
 
--c
create view viewSati
as
select radnikID, 'bolovanje' bolovanjeGodisnji
from radnik
where satiBolovanja > satiGodOdmora
union
select radnikID, 'godisnji' bolovanjeGodisnji
from radnik
where satiBolovanja < satiGodOdmora
 
select * from viewSati
 
-----------------------------------------------
/*
7.
Koristeæi tabelu prodaja kreirati pogled view_prodaja sljedeæe strukture:
       - prodavacID
       - naziv_terit
       - razlika prošlogodišnje prodaje i srednje vrijednosti prošlogodišnje prodaje.
Uslov je da se dohvate zapisi u kojima je bonus bar za 1000 veæi od minimalne vrijednosti bonusa
*/
--10 bodova
create view viewProdaja
as
select prodavacID, nazivTeritorije, proslogodProdaja - (select avg (proslogodProdaja) from prodaja) as razlika
from prodaja
where (bonus - 1000) > (select min(bonus) from prodaja)
 
select * from viewProdaja
 
------------------------------------------
/*
8.
U koloni drzavaID tabele radnik izvršiti promjenu svih vrijednosti u kojima je broj cifara neparan broj. Promjenu izvršiti tako što æe se u umjesto postojeæih
vrijednosti unijeti sluèajno generisani niz znakova.
*/
--10 bodova
update radnik
set drzavaID = cast (left(newid(), 15) as nvarchar)
where len(drzavaID)%2 != 0
 
select drzavaID
from radnik
 
---------------------------------------
/*
9.
Iz tabela nabavka i radnik kreirati pogled view_sifra_transakc koja æe se sastojati od sljedeæih kolona:
       - naziv dobavljaèa,
       - sifra_transakc
Podaci u koloni sifra_transakc æe se formirati spajanjem karaktera imena iz kolone loginID tabele radnik (ime je npr. ken, NE ken0) i rijeèi iz kolone
br_racuna (npr. u LITWARE0001 rijeè je LITWARE) tabele nabavka, izmeðu kojih je potrebno umetnuti donju crtu (_).
Uslov je da se ne dohvataju duplikati (prikaz jedinstvenih vrijednosti) u koloni sifre_transaks.
Obavezno napisati kod za pregled sadržaja pogleda.
*/
--13 bodova
create view viewSifraTransakcije
as
select distinct n.nazivDobavljaca, SUBSTRING(loginID, CHARINDEX ('\', loginID) + 1, len (substring(loginID, charindex ('\', loginID) + 1, len(loginID)) ) - 1) + '_' +
                           left(n.brRacuna, charindex ('0', brRacuna) - 1) as sifraTransakcije
from radnik as r inner join nabavka as n
on r.radnikID =n.nabavkaID
 
select loginID
from radnik
 
-----------------------------------------------
--10.
/*
Kreirati backup baze na default lokaciju, obrisati bazu, a zatim izvršiti restore baze.
Uslov prihvatanja koda je da se može izvršiti.
*/
 
BACKUP DATABASE BP2_2020_09_11
TO DISK = 'BP2_2020_09_11.bak'
GO
 
USE master
DROP DATABASE BP2_2020_09_11
 
RESTORE DATABASE BP2_2020_09_11 FROM DISK = 'BP2_2020_09_11.bak'
USE BP2_2020_09_11
 
--2 boda
 
 
/*
Napomena:
A.
Prilikom  bodovanja rješenja prioritet ima rezultat koji upit treba da vrati (broj zapisa, vrijednosti agregatnih funkcija...).
U sluèaju da rezultat upita nije taèan, a pogled, tabela... koji su rezultat tog upita se koriste u narednim zadacima,
tada se rješenja narednih zadataka, bez obzira na taènost koda, ne boduju punim brojem bodova,
jer ni ta rješenja ne mogu vratiti taèan rezultat (broj zapisa, vrijednosti agregatnih funkcija...).
B.
Tokom pisanja koda obratiti posebnu pažnju na tekst zadatka i ono što se traži zadatkom.
Prilikom pregleda rada pokreæe se kod koji se nalazi u sql skripti i
sve ono što nije uraðeno prema zahtjevima zadatka ili je pogrešno uraðeno predstavlja grešku.
*/
 
------------------------------------------------
--1
/*
Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
 
create database IspitniZadatak3
go
use IspitniZadatak3
 
 
 
/*Prilikom kreiranja tabela voditi raèuna o meðusobnom odnosu izmeðu tabela.
a) Kreirati tabelu radnik koja æe imati sljedeæu strukturu:
       - radnikID, cjelobrojna varijabla, primarni kljuè
       - drzavaID, 15 unicode karaktera
       - loginID, 256 unicode karaktera
       - sati_god_odmora, cjelobrojna varijabla
       - sati_bolovanja, cjelobrojna varijabla
*/
create table radnik
(
       radnikID int constraint PK_radnik primary key not null,
       drzavaID nvarchar (15),
       loginID nvarchar (256),
       satiGodisnjegOdmora int,
       satiBolovanja int
)
 
 
/*
b) Kreirati tabelu nabavka koja æe imati sljedeæu strukturu:
       - nabavkaID, cjelobrojna varijabla, primarni kljuè
       - status, cjelobrojna varijabla
       - nabavaljacID, cjelobrojna varijabla
       - br_racuna, 15 unicode karaktera
       - naziv_nabavljaca, 50 unicode karaktera
       - kred_rejting, cjelobrojna varijabla
*/
create table nabavka
(
       nabavkaID int constraint PK_nabavka primary key not null,
       status int,
       nabavljacID int,
       brojRacuna nvarchar (15),
       nazivDobavljaca nvarchar (50),
       kreditniRejting int,
       constraint FK_radnik foreign key (nabavljacID) references radnik (radnikID)
)
 
 
 
drop table nabavka
/*
c) Kreirati tabelu prodaja koja æe imati sljedeæu strukturu:
       - prodavacID, cjelobrojna varijabla, primarni kljuè
       - prod_kvota, novèana varijabla
       - bonus, novèana varijabla
       - proslogod_prodaja, novèana varijabla
       - naziv_terit, 50 unicode karaktera
*/
--10 bodova
create table prodaja
(
       prodavacID int constraint PK_prodaja primary key not null,
       prodKvota money,
       bonus money,
       proslogodisnjaProdaja money,
       nazivteritorije nvarchar (50)
       constraint FK_prodajaRadnik foreign key (prodavacID) references radnik (radnikID)
)
 
drop table prodaja
--------------------------------------------
--2. Import podataka
/*
a) Iz tabele HumanResources.Employee AdventureWorks2017 u tabelu radnik importovati podatke po sljedeæem pravilu:
       - BusinessEntityID -> radnikID
       - NationalIDNumber -> drzavaID
       - LoginID -> loginID
       - VacationHours -> sati_god_odmora
       - SickLeaveHours -> sati_bolovanja
*/
insert into radnik
select BusinessEntityID, NationalIDNumber, LoginID, VacationHours, SickLeaveHours
from AdventureWorks2014.HumanResources.Employee
 
 
 
 
/*
b) Iz tabela Purchasing.PurchaseOrderHeader i Purchasing.Vendor baze AdventureWorks2017 u tabelu nabavka importovati podatke po sljedeæem pravilu:
       - PurchaseOrderID -> nabavkaID
       - Status -> status
       - EmployeeID -> radnikID
       - AccountNumber -> br_racuna
       - Name -> naziv_nabavljaca
       - CreditRating -> kred_rejting
*/
 
insert into nabavka
select poh.PurchaseOrderID, poh.Status, poh.EmployeeID, v.AccountNumber, v.Name, v.CreditRating
from AdventureWorks2014.Purchasing.PurchaseOrderHeader as poh inner join AdventureWorks2014.Purchasing.Vendor as v
on poh.VendorID = v.BusinessEntityID
 
select *
from nabavka
 
 
/*
c) Iz tabela Sales.SalesPerson i Sales.SalesTerritory baze AdventureWorks2017 u tabelu prodaja importovati podatke po sljedeæem pravilu:
       - BusinessEntityID -> prodavacID
       - SalesQuota -> prod_kvota
       - Bonus -> bonus
       - SalesLastYear iz Sales.SalesPerson -> proslogod_prodaja
       - Name -> naziv_terit
*/
 
insert into prodaja
select
from ad
 
insert into prodaja
select sp.BusinessEntityID, sp.SalesQuota, sp.bonus, sp.SalesLastYear, st.name
from AdventureWorks2014.sales.SalesPerson as sp inner join AdventureWorks2014.Sales.SalesTerritory as st
on sp.TerritoryID = st.TerritoryID
 
 
select * from prodaja
select * from radnik
 
--10 bodova
 
------------------------------------------
/*
3.
a) Iz tabela radnik i nabavka kreirati pogled view_drzavaID koji æe imati sljedeæu strukturu:
       - nabavkaID,
       - loginID,
       - status
       - naziv nabavljaèa,
       - kreditni rejting
Uslov je da u pogledu budu zapisi u kojima je kreditni rejting veæi od 1.
b) Koristeæi prethodno kreirani pogled prebrojati broj obavljenih nabavki prema kreditnom rejtingu.
Npr. kreditni rejting 8 se pojavljuje 20 puta. Pregled treba da sadrži oznaku kreditnog rejtinga i ukupan broj obavljenih nabavki.
*/
--10 bodova
 
--a
go
create view viweDrzavaID
as
select n.nabavkaID, r.loginID, n.status, n.nazivDobavljaca, n.kredRejting
from nabavka as n inner join radnik as r
on n.nabavljacID = r.radnikID
where n.kredRejting > 1
 
 
select * from viweDrzavaID
 
 
--b
select count(kredRejting)
from viweDrzavaID
group by kredRejting
 
-----------------------------------------------
/*
4.
Kreirati proceduru koja æe imati istu strukturu kao pogled kreiran u prethodnom zadatku. Proceduru kreirati tako da je prilikom izvršavanja moguæe unijeti
bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti), uz uslov da je status veæi od 2. Pokrenuti proceduru za kreditni rejting 3 i 5.
*/
--10 bodova
 
go
create procedure zadatak4
(
       @nabavkaID int = null,
       @loginID nvarchar (2) = null,
       @status int = null,
       @nazivDobavljaca nvarchar (50) = null,
       @kredRejting int = null
)
as
begin
       select n.nabavkaID, r.loginID, n.status, n.nazivDobavljaca, n.kredRejting
       from radnik as r inner join nabavka as n
       on r.radnikID = n.nabavkaID
       where (      
                           @nabavkaID = n.nabavkaID or
                           @loginID = r.loginID or
                           @status = n.status or
                           @nazivDobavljaca = n.nazivDobavljaca or
                           @kredRejting = n.kredRejting
                    ) and n.status > 2
end
 
exec zadatak4 @kredRejting = 3
exec zadatak4 @kredRejting = 5
 
 
-------------------------------------------
/*
5.
a) Kreirati pogled nabavljaci_radnici koji æe se sastojati od kolona naziv dobavljaèa i prebrojani_broj radnika. prebrojani_broj je podatak kojim se prebrojava broj
radnika s kojima je dobavljaè poslovao. Obavezno napisati kod kojim æe se izvršiti pregled sadržaja pogleda sortiran po ukupnom broju.
b) Kreirati proceduru kojom æe se iz pogleda kreiranog pod a) preuzeti zapisi u kojima je prebrojani_broj manji od 50. Proceduru kreirati tako da je prilikom izvršavanja
moguæe unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti). Pokrenuti proceduru za vrijednosti prebrojani_broj = 1 i 2.
*/
--15 bodova
 
--a
go
create view viewNabavljaciRadnici
as
select n.nazivDobavljaca, count (r.radnikID) as prebrojaniBrojRadnika
from radnik as r inner join nabavka as n
on r.radnikID = n.nabavkaID
group by n.nazivDobavljaca
      
select *
from viewNabavljaciRadnici
order by prebrojaniBrojRadnika
 
--b
 
create procedure zadatak5
(
       @nazivDobavljaca nvarchar (50) = null,
       @prebrojaniBrojRadnika int = null
)
as
begin
       select *
       from viewNabavljaciRadnici
       where (
                    @nazivDobavljaca = nazivDobavljaca or
                    @prebrojaniBrojRadnika = prebrojaniBrojRadnika)
                    and prebrojaniBrojRadnika < 50
end
exec zadatak5 @prebrojaniBrojRadnika = 1
exec zadatak5 @prebrojaniBrojRadnika = 2
 
exec zad5b @prebrojani_broj = 1
exec zad5b @prebrojani_broj = 2
 
 
--------------------------------------------
/*
6.
a) U tabeli radnik dodati kolonu razlika_sati kao cjelobrojnu varijablu sa obaveznom default vrijednošæu 0.
b) U koloni razlika_sati ostaviti 0 ako su sati bolovanja veæi od godišnjeg odmora, inaèe u kolonu smjestiti vrijednost razlike izmeðu sato_bolovanja i sati_god_odmora.
c) Kreirati pogled view_sati u kojem æe biti poruka da li radnik ima više sati godišnjeg odmora ili bolovanja.
Ako je više bolovanja daje se poruka ""bolovanje"", inaèe ""godisnji"". Pogled treba da sadrži ID radnika i poruku.
*/
--10 bodova
 
--a
alter table radnik
add razlikaSati int default(0)
 
--b
update radnik
set razlikaSati =
       case
       when satiBolovanja > satiGodOdmora then 0
       when satiBolovanja <= satiGodOdmora then satiBolovanja - satiGodOdmora
       end
 
select * from radnik
 
--c
create view viewSati
as
select radnikID, 'bolovanje' bolovanjeGodisnji
from radnik
where satiBolovanja > satiGodOdmora
union
select radnikID, 'godisnji' bolovanjeGodisnji
from radnik
where satiBolovanja < satiGodOdmora
 
select * from viewSati
 
-----------------------------------------------
/*
7.
Koristeæi tabelu prodaja kreirati pogled view_prodaja sljedeæe strukture:
       - prodavacID
       - naziv_terit
       - razlika prošlogodišnje prodaje i srednje vrijednosti prošlogodišnje prodaje.
Uslov je da se dohvate zapisi u kojima je bonus bar za 1000 veæi od minimalne vrijednosti bonusa
*/
--10 bodova
create view viewProdaja
as
select prodavacID, nazivTeritorije, proslogodProdaja - (select avg (proslogodProdaja) from prodaja) as razlika
from prodaja
where (bonus - 1000) > (select min(bonus) from prodaja)
 
select * from viewProdaja
 
------------------------------------------
/*
8.
U koloni drzavaID tabele radnik izvršiti promjenu svih vrijednosti u kojima je broj cifara neparan broj. Promjenu izvršiti tako što æe se u umjesto postojeæih
vrijednosti unijeti sluèajno generisani niz znakova.
*/
--10 bodova
update radnik
set drzavaID = cast (left(newid(), 15) as nvarchar)
where len(drzavaID)%2 != 0
 
select drzavaID
from radnik
 
---------------------------------------
/*
9.
Iz tabela nabavka i radnik kreirati pogled view_sifra_transakc koja æe se sastojati od sljedeæih kolona:
       - naziv dobavljaèa,
       - sifra_transakc
Podaci u koloni sifra_transakc æe se formirati spajanjem karaktera imena iz kolone loginID tabele radnik (ime je npr. ken, NE ken0) i rijeèi iz kolone
br_racuna (npr. u LITWARE0001 rijeè je LITWARE) tabele nabavka, izmeðu kojih je potrebno umetnuti donju crtu (_).
Uslov je da se ne dohvataju duplikati (prikaz jedinstvenih vrijednosti) u koloni sifre_transaks.
Obavezno napisati kod za pregled sadržaja pogleda.
*/
--13 bodova
create view viewSifraTransakcije
as
select distinct n.nazivDobavljaca, SUBSTRING(loginID, CHARINDEX ('\', loginID) + 1, len (substring(loginID, charindex ('\', loginID) + 1, len(loginID)) ) - 1) + '_' +
                           left(n.brRacuna, charindex ('0', brRacuna) - 1) as sifraTransakcije
from radnik as r inner join nabavka as n
on r.radnikID =n.nabavkaID
 
select loginID
from radnik
 
-----------------------------------------------
--10.
/*
Kreirati backup baze na default lokaciju, obrisati bazu, a zatim izvršiti restore baze.
Uslov prihvatanja koda je da se može izvršiti.
*/
 
BACKUP DATABASE BP2_2020_09_11
TO DISK = 'BP2_2020_09_11.bak'
GO
 
USE master
DROP DATABASE BP2_2020_09_11
 
RESTORE DATABASE BP2_2020_09_11 FROM DISK = 'BP2_2020_09_11.bak'
USE BP2_2020_09_11
 
--2 boda
 
 
 
/*
Napomena:
A.
Prilikom  bodovanja rješenja prioritet ima rezultat koji upit treba da vrati (broj zapisa, vrijednosti agregatnih funkcija...).
U sluèaju da rezultat upita nije taèan, a pogled, tabela... koji su rezultat tog upita se koriste u narednim zadacima,
tada se rješenja narednih zadataka, bez obzira na taènost koda, ne boduju punim brojem bodova,
jer ni ta rješenja ne mogu vratiti taèan rezultat (broj zapisa, vrijednosti agregatnih funkcija...).
B.
Tokom pisanja koda obratiti posebnu pažnju na tekst zadatka i ono što se traži zadatkom.
Prilikom pregleda rada pokreæe se kod koji se nalazi u sql skripti i
sve ono što nije uraðeno prema zahtjevima zadatka ili je pogrešno uraðeno predstavlja grešku.
*/
 
------------------------------------------------
--1
/*
Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
 
create database FIT_ispitniZadatak5
go
 
use FIT_ispitniZadatak5
go
 
 
/*Prilikom kreiranja tabela voditi raèuna o meðusobnom odnosu izmeðu tabela.
a) Kreirati tabelu radnik koja æe imati sljedeæu strukturu:
       - radnikID, cjelobrojna varijabla, primarni kljuè
       - drzavaID, 15 unicode karaktera
       - loginID, 256 unicode karaktera
       - sati_god_odmora, cjelobrojna varijabla
       - sati_bolovanja, cjelobrojna varijabla
*/
 
create table radnik
(
       radnikID int constraint PK_radnik primary key not null,
       drzavaID nvarchar (15),
       loginID nvarchar(256),
       satiGodOdmora int,
       satiBolovanja int
)
 
 
/*
b) Kreirati tabelu nabavka koja æe imati sljedeæu strukturu:
       - nabavkaID, cjelobrojna varijabla, primarni kljuè
       - status, cjelobrojna varijabla
       - nabavaljacID, cjelobrojna varijabla
       - br_racuna, 15 unicode karaktera
       - naziv_nabavljaca, 50 unicode karaktera
       - kred_rejting, cjelobrojna varijabla
*/
create table nabavka
(     
       nabavkaID int constraint PK_nabavka primary key not null,
       status int,
       nabavljacID int,
       brRacuna nvarchar (15),
       nazivDobavljaca nvarchar (50),
       kredRejting int
       constraint FK_radnikID foreign key (nabavljacID) references radnik(radnikID)
)
 
drop table nabavka
/*
c) Kreirati tabelu prodaja koja æe imati sljedeæu strukturu:
       - prodavacID, cjelobrojna varijabla, primarni kljuè
       - prod_kvota, novèana varijabla
       - bonus, novèana varijabla
       - proslogod_prodaja, novèana varijabla
       - naziv_terit, 50 unicode karaktera
*/
--10 bodova
create table prodaja
(
       prodavacID int constraint PK_prodaja primary key not null,
       prodKvota money,
       bonus money,
       proslogodProdaja money,
       nazivTeritorije nvarchar(50)
       constraint FK_prodaja foreign key (prodavacID) references radnik (radnikID)
)
 
 
drop table prodaja
--------------------------------------------
--2. Import podataka
/*
a) Iz tabele HumanResources.Employee AdventureWorks2017 u tabelu radnik importovati podatke po sljedeæem pravilu:
       - BusinessEntityID -> radnikID
       - NationalIDNumber -> drzavaID
       - LoginID -> loginID
       - VacationHours -> sati_god_odmora
       - SickLeaveHours -> sati_bolovanja
*/
insert into radnik
select BusinessEntityID, NationalIDNumber, LoginID, VacationHours, SickLeaveHours
from AdventureWorks2014.HumanResources.Employee
 
/*
b) Iz tabela Purchasing.PurchaseOrderHeader i Purchasing.Vendor baze AdventureWorks2017 u tabelu nabavka importovati podatke po sljedeæem pravilu:
       - PurchaseOrderID -> nabavkaID
       - Status -> status
       - EmployeeID -> radnikID
       - AccountNumber -> br_racuna
       - Name -> naziv_nabavljaca
       - CreditRating -> kred_rejting
*/
 
insert into nabavka
select poh.PurchaseOrderID, poh.Status, poh.EmployeeID, v.AccountNumber, v.Name, v.CreditRating
from AdventureWorks2014.Purchasing.PurchaseOrderHeader as poh inner join AdventureWorks2014.Purchasing.Vendor as v
on poh.VendorID = v.BusinessEntityID
 
select *
from nabavka
 
 
/*
c) Iz tabela Sales.SalesPerson i Sales.SalesTerritory baze AdventureWorks2017 u tabelu prodaja importovati podatke po sljedeæem pravilu:
       - BusinessEntityID -> prodavacID
       - SalesQuota -> prod_kvota
       - Bonus -> bonus
       - SalesLastYear iz Sales.SalesPerson -> proslogod_prodaja
       - Name -> naziv_terit
*/
 
insert into prodaja
select sp.BusinessEntityID, sp.SalesQuota, sp.bonus, sp.SalesLastYear, st.name
from AdventureWorks2014.sales.SalesPerson as sp inner join AdventureWorks2014.Sales.SalesTerritory as st
on sp.TerritoryID = st.TerritoryID
 
 
select * from prodaja
select * from radnik
 
--10 bodova
 
------------------------------------------
/*
3.
a) Iz tabela radnik i nabavka kreirati pogled view_drzavaID koji æe imati sljedeæu strukturu:
       - nabavkaID,
       - loginID,
       - status
       - naziv nabavljaèa,
       - kreditni rejting
Uslov je da u pogledu budu zapisi u kojima je kreditni rejting veæi od 1.
b) Koristeæi prethodno kreirani pogled prebrojati broj obavljenih nabavki prema kreditnom rejtingu.
Npr. kreditni rejting 8 se pojavljuje 20 puta. Pregled treba da sadrži oznaku kreditnog rejtinga i ukupan broj obavljenih nabavki.
*/
--10 bodova
 
--a
go
create view viweDrzavaID
as
select n.nabavkaID, r.loginID, n.status, n.nazivDobavljaca, n.kredRejting
from nabavka as n inner join radnik as r
on n.nabavljacID = r.radnikID
where n.kredRejting > 1
 
 
select * from viweDrzavaID
 
 
--b
select count(kredRejting)
from viweDrzavaID
group by kredRejting
 
-----------------------------------------------
/*
4.
Kreirati proceduru koja æe imati istu strukturu kao pogled kreiran u prethodnom zadatku. Proceduru kreirati tako da je prilikom izvršavanja moguæe unijeti
bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti), uz uslov da je status veæi od 2. Pokrenuti proceduru za kreditni rejting 3 i 5.
*/
--10 bodova
 
go
create procedure zadatak4
(
       @nabavkaID int = null,
       @loginID nvarchar (2) = null,
       @status int = null,
       @nazivDobavljaca nvarchar (50) = null,
       @kredRejting int = null
)
as
begin
       select n.nabavkaID, r.loginID, n.status, n.nazivDobavljaca, n.kredRejting
       from radnik as r inner join nabavka as n
       on r.radnikID = n.nabavkaID
       where (      
                           @nabavkaID = n.nabavkaID or
                           @loginID = r.loginID or
                           @status = n.status or
                           @nazivDobavljaca = n.nazivDobavljaca or
                           @kredRejting = n.kredRejting
                    ) and n.status > 2
end
 
exec zadatak4 @kredRejting = 3
exec zadatak4 @kredRejting = 5
 
 
-------------------------------------------
/*
5.
a) Kreirati pogled nabavljaci_radnici koji æe se sastojati od kolona naziv dobavljaèa i prebrojani_broj radnika. prebrojani_broj je podatak kojim se prebrojava broj
radnika s kojima je dobavljaè poslovao. Obavezno napisati kod kojim æe se izvršiti pregled sadržaja pogleda sortiran po ukupnom broju.
b) Kreirati proceduru kojom æe se iz pogleda kreiranog pod a) preuzeti zapisi u kojima je prebrojani_broj manji od 50. Proceduru kreirati tako da je prilikom izvršavanja
moguæe unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti). Pokrenuti proceduru za vrijednosti prebrojani_broj = 1 i 2.
*/
--15 bodova
 
--a
go
create view viewNabavljaciRadnici
as
select n.nazivDobavljaca, count (r.radnikID) as prebrojaniBrojRadnika
from radnik as r inner join nabavka as n
on r.radnikID = n.nabavkaID
group by n.nazivDobavljaca
      
select *
from viewNabavljaciRadnici
order by prebrojaniBrojRadnika
 
--b
 
create procedure zadatak5
(
       @nazivDobavljaca nvarchar (50) = null,
       @prebrojaniBrojRadnika int = null
)
as
begin
       select *
       from viewNabavljaciRadnici
       where (
                    @nazivDobavljaca = nazivDobavljaca or
                    @prebrojaniBrojRadnika = prebrojaniBrojRadnika)
                    and prebrojaniBrojRadnika < 50
end
exec zadatak5 @prebrojaniBrojRadnika = 1
exec zadatak5 @prebrojaniBrojRadnika = 2
 
exec zad5b @prebrojani_broj = 1
exec zad5b @prebrojani_broj = 2
 
 
--------------------------------------------
/*
6.
a) U tabeli radnik dodati kolonu razlika_sati kao cjelobrojnu varijablu sa obaveznom default vrijednošæu 0.
b) U koloni razlika_sati ostaviti 0 ako su sati bolovanja veæi od godišnjeg odmora, inaèe u kolonu smjestiti vrijednost razlike izmeðu sato_bolovanja i sati_god_odmora.
c) Kreirati pogled view_sati u kojem æe biti poruka da li radnik ima više sati godišnjeg odmora ili bolovanja.
Ako je više bolovanja daje se poruka ""bolovanje"", inaèe ""godisnji"". Pogled treba da sadrži ID radnika i poruku.
*/
--10 bodova
 
--a
alter table radnik
add razlikaSati int default(0)
 
--b
update radnik
set razlikaSati =
       case
       when satiBolovanja > satiGodOdmora then 0
       when satiBolovanja <= satiGodOdmora then satiBolovanja - satiGodOdmora
       end
 
select * from radnik
 
--c
create view viewSati
as
select radnikID, 'bolovanje' bolovanjeGodisnji
from radnik
where satiBolovanja > satiGodOdmora
union
select radnikID, 'godisnji' bolovanjeGodisnji
from radnik
where satiBolovanja < satiGodOdmora
 
select * from viewSati
 
-----------------------------------------------
/*
7.
Koristeæi tabelu prodaja kreirati pogled view_prodaja sljedeæe strukture:
       - prodavacID
       - naziv_terit
       - razlika prošlogodišnje prodaje i srednje vrijednosti prošlogodišnje prodaje.
Uslov je da se dohvate zapisi u kojima je bonus bar za 1000 veæi od minimalne vrijednosti bonusa
*/
--10 bodova
create view viewProdaja
as
select prodavacID, nazivTeritorije, proslogodProdaja - (select avg (proslogodProdaja) from prodaja) as razlika
from prodaja
where (bonus - 1000) > (select min(bonus) from prodaja)
 
select * from viewProdaja
 
------------------------------------------
/*
8.
U koloni drzavaID tabele radnik izvršiti promjenu svih vrijednosti u kojima je broj cifara neparan broj. Promjenu izvršiti tako što æe se u umjesto postojeæih
vrijednosti unijeti sluèajno generisani niz znakova.
*/
--10 bodova
update radnik
set drzavaID = cast (left(newid(), 15) as nvarchar)
where len(drzavaID)%2 != 0
 
select drzavaID
from radnik
 
---------------------------------------
/*
9.
Iz tabela nabavka i radnik kreirati pogled view_sifra_transakc koja æe se sastojati od sljedeæih kolona:
       - naziv dobavljaèa,
       - sifra_transakc
Podaci u koloni sifra_transakc æe se formirati spajanjem karaktera imena iz kolone loginID tabele radnik (ime je npr. ken, NE ken0) i rijeèi iz kolone
br_racuna (npr. u LITWARE0001 rijeè je LITWARE) tabele nabavka, izmeðu kojih je potrebno umetnuti donju crtu (_).
Uslov je da se ne dohvataju duplikati (prikaz jedinstvenih vrijednosti) u koloni sifre_transaks.
Obavezno napisati kod za pregled sadržaja pogleda.
*/
--13 bodova
create view viewSifraTransakcije
as
select distinct n.nazivDobavljaca, SUBSTRING(loginID, CHARINDEX ('\', loginID) + 1, len (substring(loginID, charindex ('\', loginID) + 1, len(loginID)) ) - 1) + '_' +
                           left(n.brRacuna, charindex ('0', brRacuna) - 1) as sifraTransakcije
from radnik as r inner join nabavka as n
on r.radnikID =n.nabavkaID
 
select loginID
from radnik
 
-----------------------------------------------
--10.
/*
Kreirati backup baze na default lokaciju, obrisati bazu, a zatim izvršiti restore baze.
Uslov prihvatanja koda je da se može izvršiti.
*/
 
BACKUP DATABASE BP2_2020_09_11
TO DISK = 'BP2_2020_09_11.bak'
GO
 
USE master
DROP DATABASE BP2_2020_09_11
 
RESTORE DATABASE BP2_2020_09_11 FROM DISK = 'BP2_2020_09_11.bak'
USE BP2_2020_09_11
 
--2 boda
 
 
 
-------------------------------------------------------------
/*
Napomena:
A.
Prilikom  bodovanja rješenja prioritet ima rezultat koji upit treba da vrati (broj zapisa, vrijednosti agregatnih funkcija...).
U sluèaju da rezultat upita nije taèan, a pogled, tabela... koji su rezultat tog upita se koriste u narednim zadacima,
tada se rješenja narednih zadataka, bez obzira na taènost koda, ne boduju punim brojem bodova,
jer ni ta rješenja ne mogu vratiti taèan rezultat (broj zapisa, vrijednosti agregatnih funkcija...).
B.
Tokom pisanja koda obratiti posebnu pažnju na tekst zadatka i ono što se traži zadatkom.
Prilikom pregleda rada pokreæe se kod koji se nalazi u sql skripti i
sve ono što nije uraðeno prema zahtjevima zadatka ili je pogrešno uraðeno predstavlja grešku.
*/
 
 
--1.
/*
Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
create database FIT_ispitniZadatak4
go
use FIT_ispitniZadatak4
 
 
/*Prilikom kreiranja tabela voditi raèuna o meðusobnom odnosu izmeðu tabela.
a) Kreirati tabelu osoba sljedeæe strukture:
       - osoba_id          cjelobrojna varijabla, primarni kljuè
       - ime               50 UNICODE karaktera
       - prezime           50 UNICODE karaktera
       - tip_osobe         2 UNICODE karaktera
       - kreditna_id cjelobrojna varijabla
       - tip_kreditne      50 UNICODE karaktera
       - broj_kartice      50 UNICODE karaktera
       - dtm_izdav         datumska varijabla
*/
 
create table osoba
(
       osobaID int constraint PK_osoba primary key not null,
       ime nvarchar (50),
       prezime nvarchar (50),
       tipOsobe nvarchar (2),
       kreditnaID int,
       tipKreditne nvarchar (50),
       brojKartice nvarchar (50),
       datumIzdavanja date
)
 
/*
c) Kreirati tabelu kupac sljedeæe strukture:
       - kupac_id          cjelobrojna varijabla, primarni kljuè
       - osoba_id          cjelobrojna varijabla
       - prodavnica_id cjelobrojna varijabla
       - br_racuna         10 unicode karaktera
*/
 
create table kupac
(
       kupacID int constraint PK_kupac primary key not null,
       osobaID int,
       prodavnicaID int,
       brRacuna nvarchar (10),
       constraint FK_kupacOsoba foreign key (osobaID) references osoba (osobaID)
)
 
/*
c) Kreirati tabelu kupovina sljedeæe strukture:
       - kupovina_id cjelobrojna varijabla, primarni kljuè
       - detalj_id         cjelobrojna varijabla, primarni kljuè
       - narudzba_id 25 UNICODE karaktera
       - kreditna_id cjelobrojna varijabla
       - teritorija_id cjelobrojna varijabla
       - kupac_id          cjelobrojna varijabla
       - kolicina          cjelobrojna varijabla
       - cijena            novèana varijabla
*/
create table kupovina
(
       kupovinaID int,
       detaljID int,
       narudzbaID nvarchar (25),
       kreditnaID int,
       teritorijaID int,
       kupacID int,
       kolicina int,
       cijena money,
       constraint PK_kupovina primary key (kupovinaID, detaljID),
       constraint FK_kupovinaKupac foreign key (kupacID) references kupac (kupacID)
)
 
--10 bodova
-----------------------------------------------------------------------
--2.
/*
a) Koristeæi tabele Person.Person, Sales.PersonCreditCard i Sales.CreditCard baze AdventureWorks2017 izvršiti insert podataka prema sljedeæem pravilu:
       - BusinessEntityID  -> osoba_id
       - FirstName                -> ime
       - LastName                 -> prezime
       - CardType                 -> tip_kreditne
       - PersonType        -> tip_osobe
       - CardNumber        -> broj_kartice
       - CreditCardID             -> kreditna_id
       - ModifiedDate             -> dtm_izdav
*/
 
insert into osoba
select pp.BusinessEntityID, pp.FirstName, pp.LastName, pp.PersonType, cc.CreditCardID, cc.CardType, cc.CardNumber, pcc.ModifiedDate
from AdventureWorks2014.Person.Person as pp inner join AdventureWorks2014.Sales.PersonCreditCard as pcc
on pp.BusinessEntityID = pcc.BusinessEntityID
inner join AdventureWorks2014.Sales.CreditCard as cc
on pcc.CreditCardID = cc.CreditCardID
 
--19118
 
/*
b) Koristeæi tabelu Sales.Customer baze AdventureWorks2017 izvršiti insert podataka prema sljedeæem pravilu:
       - CustomerID  -> kupac_id
       - PersonID          -> osoba_id
       - StoreID           -> prodavnica_id
       - AccountNumber -> br_racuna
uz uslov da PersonID bude veæi od 300.
*/
insert into kupac
select CustomerID, PersonID, StoreID, AccountNumber
from AdventureWorks2014.Sales.Customer
where PersonID > 300
 
--19114
 
/*
c) Koristeæi tabele Sales.SalesOrderHeader i Sales.SalesOrderDetail baze AdventureWorks2017 izvršiti insert podataka u tabelu kupovina prema sljedeæem pravilu:
       - SalesOrderID                    -> kupovina_id
       - SalesOrderDetailID -> detalj_id
       - PurchaseOrderNumber      -> narudzba_id
       - CreditCardID                    -> kreditna_id
       - TerritoryID              -> teritorija_id
       - CustomerID               -> kupac_id
       - OrderQty                        -> kolicina
       - UnitPrice                       -> cijena
uz uslov da CustomerID bude manji od 29000.
*/
insert into kupovina
select soh.SalesOrderID, sod.SalesOrderDetailID, soh.PurchaseOrderNumber, soh.CreditCardID, soh.TerritoryID, soh.CustomerID, sod.OrderQty, sod.UnitPrice
from AdventureWorks2014.sales.SalesOrderHeader as soh inner join AdventureWorks2014.Sales.SalesOrderDetail as sod
on soh.SalesOrderID = sod.SalesOrderID
where soh.CustomerID < 29000
 
--59297
--10 bodova
 
-----------------------------------------------------------------------
--3.
/*
a)
Kreirati pogled view_ukupno kojim æe se dati ukupna vrijednost svih kupovina koje je osoba ostvarila.
Pogled treba sadržavati kolone:
       - osoba_id
       - ukupno - ukupna svota svih kupovina
Napomena:
Vrijednost jedne kupovine predstavlja umnožak kolièine i cijene.
b)
Odrediti koliko je zapisa veæe, koliko jednako, a koliko manje od srednje vrijednosti kolone ukupno iz view_ukupno.
Rezultat upita treba da vrati prebrojane brojeve sa pripadajuæim oznakama (veæe, jednako, manje).
Ne prihvata se rješenje koje ne vraæa oznake.
*/
--a
go
create view viewUkupno
as
select o.osobaID, sum(kup.kolicina * kup.cijena) as ukupno
from osoba as o inner join kupac as k
on o.osobaID = k.osobaID
inner join kupovina as kup
on k.kupacID = kup.kupacID
group by o.osobaID
go
 
select *
from viewUkupno
--18000
 
--b)
/*Odrediti koliko je zapisa veæe, koliko jednako, a koliko manje od srednje vrijednosti kolone ukupno iz view_ukupno.
Rezultat upita treba da vrati prebrojane brojeve sa pripadajuæim oznakama (veæe, jednako, manje).
Ne prihvata se rješenje koje ne vraæa oznake.*/
 
select 'veæe', count (*)
from viewUkupno
where ukupno > (select avg(ukupno) from viewUkupno)
 
select 'jednako', count (*)
from viewUkupno
where ukupno = (select avg(ukupno) from viewUkupno)
 
select 'manje', count (*)
from viewUkupno
where ukupno < (select avg(ukupno) from viewUkupno)
 
/*
veæe   6509
jednako      0
manje  11491
*/
--10 bodova
 
 
-----------------------------------------------------------------------
--4.
/*
a)
U tabeli osoba dodati izraèunatu kolonu lozinka.
Podatak u koloni lozinka æe se sastojati od sljedeæih dijelova:
       -      2 znaka sluèajno generisani karakteri
       -      bilo koja 3 karaktera iz kolona ime u obrnutom redoslijedu
       -      bilo koja 3 karaktera iz kolone prezime u obrnutom redoslijedu
       -      godina iz datuma izdavanja
       -      dan iz datuma izdavanja
       -      mjesec iz datuma izdavanja
Izmeðu svih dijelova lozinke OBAVEZNO treba biti donja crta.
b)
U tabeli kupac u koloni prodavnica_id umjesto NULL vrijednosti ubaciti vrijednost podatka iz kolone osoba_id uveæan za 1.
*/
alter table osoba
add lozinka as left (newid(), 2) + '_' + reverse (left(ime, 3)) + '_' + reverse (left(prezime, 3)) + '_' +
                    cast (year (getdate()) as nvarchar) + '_' + cast (day(getdate()) as nvarchar) + '_' + cast (month (getdate()) as nvarchar)
 
update kupac
set prodavnicaID = osobaID + 1
where prodavnicaID is null
 
--18484
--10 bodova
 
 
 
 
-----------------------------------------------------------------------
--5.
/*
a)
Kreirati proceduru proc_narudzba kojom æe se smještati podaci u kolonu narudzba_id tabele kupovina.
Podatak u koloni narudzba_id æe se sastoji od sljedeæih dijelova:
       - 1. karakter je slovo n
       - kupovina_id
       - detalj_id
Izmeðu svih dijelova narudzba_id OBAVEZNO treba biti srednja crta.
OBAVEZNO pokrenuti proceduru.
b)
Nad kolonom narudzba_id kreirati ogranièenje kojim æe biti moguæe unijeti podatak koji ima najviše 20 karaktera.
*/
--a
go
create procedure proc_narudzba
as
begin
update kupovina
set narudzba_id = 'n' + '-' + CAST (kupovina_id as nvarchar) + '-' + CAST (detalj_id as nvarchar)
end
 
exec proc_narudzba
--59297
 
--b
alter table kupovina
add constraint CK_narudzba_id check (len (narudzba_id) <= 20)
--10 bodova
 
 
 
-----------------------------------------------------------------------
--6.
/*
Neka su za cijene definirane sljedeæe 4 klase:
       - 0-999,99          => klasa 1
       - 1000-1999,99      => klasa 2
       - 2000-2999,99      => klasa 3
       - 3000-3999,99      => klasa 4
Kreirati proceduru proc_klasa kojom æe se izvršiti klasificiranje cijena prema navedenim klasama.
Procedura treba da vrati cijenu (njenu vrijednost) i oznaku klase kojoj pripada,
uz uslov da procedura ne vraæa duplikate cijena.
*/
go
create procedure proc_klasa
as
begin
select distinct cijena, 'klasa 1' as klasa
from   kupovina
where  cijena between 0 and 999.99
union
select distinct cijena, 'klasa 2' as klasa
from   kupovina
where  cijena between 1000 and 1999.99
union
select distinct cijena, 'klasa 3' as klasa
from   kupovina
where  cijena between 2000 and 2999.99
union
select distinct cijena, 'klasa 4' as klasa
from   kupovina
where  cijena between 3000 and 3999.99
order by 1
end
 
exec proc_klasa
--42
--10 bodova
 
 
 
 
-----------------------------------------------------------------------
--7.
/*
a)
Koristeæi tabele baze kreirati pogled view_tip sljedeæe strukture:
       - tip kreditne kartice
       - ID prodavnice
       - prebrojano - prebrojani broj kupovina po tipu kreditne kartice i ID prodavnice
b)
Koristeæi pogled view_tip kreirati proceduru proc_tip koja æe imati parametar za kolonu prebrojano. Pokrenuti proceduru za vrijednosti paramtera 3 i 30.
*/
go
create view view_tip
as
SELECT osoba.tip_kreditne, kupac.prodavnica_id, COUNT(kupovina.kupovina_id) AS prebrojano
FROM   kupac INNER JOIN kupovina
ON           kupac.kupac_id = kupovina.kupac_id
             INNER JOIN osoba ON kupac.osoba_id = osoba.osoba_id
GROUP BY osoba.tip_kreditne, kupac.prodavnica_id
go
--18000
 
--b
go
create procedure proc_prebrojano
(
       @prebrojano int = null
)
as
begin
select prebrojano, count (*)
from view_tip
where  prebrojano = @prebrojano
group by prebrojano
end
 
exec proc_prebrojano 3
exec proc_prebrojano 30
/*
3      4505
30     3
*/
--10 bodova
 
 
-----------------------------------------------------------------------
--8.
/*
Na osnovu tabele osoba kreirati proceduru nakon èijeg pokretanja æe se dobiti ukupan broj osoba èije prezime je jedinstveno.
*/
go
create view view_jedinstveno
as
select prezime, count(*) indikator
from osoba
group by prezime
having COUNT (*) = 1
go
 
go
create procedure proc_jedinstveno
as
begin
select count (*)
from view_jedinstveno
end
 
exec proc_jedinstveno
--585
--10 bodova
 
 
-----------------------------------------------------------------------
--9.
/*
a)
Koristeæi tabele baze kreirati globalnu privremenu tabelu temp sljedeæe strukture:
       - ID osobe
       - tip kreditne kartice
       - klasa - prve 4 cifre iz kolone broj_kartice
       - datum izdavanja
       - ID narudzbe
i u nju povuæi podatke iz odgovarajuæih tabela.
b)
Provjeriti da li je jednom tipu kreditne kartice u privremenoj tabeli pridružena jedna ili više klasa.
*/
SELECT osoba.osoba_id, osoba.tip_kreditne, left (osoba.broj_kartice,4) klasa, osoba.dtm_izdav, kupovina.narudzba_id
into   temp
FROM   kupac INNER JOIN kupovina
ON           kupac.kupac_id = kupovina.kupac_id
             INNER JOIN osoba
             ON kupac.osoba_id = osoba.osoba_id
--52297
 
--b
select distinct tip_kreditne, klasa
from   ##temp
order by 1
--jedna
 
--10 bodova
 
 
-----------------------------------------------------------------------
--10.
/*
a)
Prebrojati broj pojavljivanja dužina podatka u koloni narudzba_id, 
uz uslov da se prikažu samo one vrijednosti dužina koja se pojavljaju više od 1000 puta.
b)
Svim zapisima èija dužina podatka se pojavljuje manje od 1000 puta promijeniti sadržaj
kolone narudzba_id tako što æe se na postojeæi podatak dodati tekuæi datum.
*/
--a
select LEN (narudzba_id), COUNT (*)
from kupovina
group by LEN (narudzba_id)
having COUNT (*) > 1000
/*
12     1747
13     42192
14     15213
*/
 
--b
alter table kupovina
drop constraint [CK_narudzba_id]
 
alter table kupovina
alter column narudzba_id nvarchar (50)
 
update kupovina
set narudzba_id = narudzba_id + cast (getdate () as nvarchar)
where LEN (narudzba_id) = 11
--145
--10 bodova
 
 
 
 
/*
Napomena:
A.
Prilikom  bodovanja rješenja prioritet ima rezultat
koji upit treba da vrati (broj zapisa, vrijednosti agregatnih funkcija...).
U sluèaju da rezultat upita nije taèan, a rezultat tog upita se koristi
u narednim zadacima, tada se rješenja narednih zadataka,
bez obzira na taènost koda, ne boduju punim brojem bodova,
jer ni ta rješenja ne mogu vratiti taèan rezultat
(broj zapisa, vrijednosti agregatnih funkcija...).
B.
Tokom pisanja koda obratiti pažnju na tekst zadatka
i ono što se traži zadatkom. Prilikom pregleda rada pokreæe se
kod koji se nalazi u sql skripti i
sve ono što nije uraðeno prema zahtjevima zadatka
ili je pogrešno uraðeno predstavlja grešku.
*/
 
------------------------------------------------
/*
BODOVANJE
       Maksimalni broj bodova:           80
       Prag prolaznosti:                 44
RASPON OCJENA
       bodovi              ocjena
       0      -      43           5
       44     -      58           6
       59     -      73           7
       74     -      80           8
*/
------------------------------------------------
 
 
 
------------------------------------------------
--1.
/*
Kreirati bazu podataka pod vlastitim brojem indeksa
i aktivirati je.
*/
 
create database FIT_ispitniZadatak3
use FIT_ispitniZadatak3
 
---------------------------------------------------------------------------
--Prilikom kreiranja tabela voditi raèuna o njihovom meðusobnom odnosu.
---------------------------------------------------------------------------
/*
a)
Kreirati tabelu prodavac koja æe imati sljedeæu strukturu:
       - prodavac_id, cjelobrojni tip, primarni kljuè
       - naziv_posla, 50 unicode karaktera
       - dtm_rodj, datumski tip
       - bracni_status, 1 karakter
       - prod_kvota, novèani tip
       - bonus, novèani tip
*/
create table prodavac
(
       prodavacID int constraint PK_prodavac primary key not null,
       nazivPosla nvarchar (50),
       datumRodjenja date,
       bracniStatus char (1),
       prodKvota money,
       bonus money
)
/*
b)
Kreirati tabelu prodavnica koja æe imati sljedeæu strukturu:
       - prodavnica_id, cjelobrojni tip, primarni kljuè
       - naziv_prodavnice, 50 unicode karaktera
       - prodavac_id, cjelobrojni tip
*/
create table prodavnica
(
       prodavnicaID int constraint PK_prodavnica primary key not null,
       nazivProdavnice nvarchar (50),
       prodavacID int,
       constraint FK_prodavac foreign key (prodavacID) references prodavac (prodavacID)
)
 
/*
c)
Kreirati tabelu kupac_detalji koja æe imati sljedeæu strukturu:
       - detalj_id, cjelobrojni tip, primarni kljuè, automatsko punjenje sa poèetnom vrijednošæu 1 i inkrementom 1
       - kupac_id, cjelobrojni tip, primarni kljuè
       - prodavnica_id, cjelobrojni tip
       - br_rac, 10 karaktera
       - dtm_narudz, datumski tip
       - kolicina, skraæeni cjelobrojni tip
       - cijena, novèani tip
       - popust, realni tip
*/
create table kupacDetalj
(
       detaljID int identity (1,1),
       kupacID int,
       prodavnicaID int,
       brojRacuna nvarchar (10),
       datumNarudzbe date,
       kolicina smallint,
       cijena money,
       popust real,
       constraint PK_detaljiKupac primary key (detaljID, kupacID),
       constraint FK_prodavnicaID foreign key (prodavnicaID) references prodavnica (prodavnicaID)
)
 
 
--10 bodova
--2.
/*
a)
Koristeæi tabele HumanResources.Employee i Sales.SalesPerson
baze AdventureWorks2017 zvršiti insert podataka u
tabelu prodavac prema sljedeæem pravilu:
       - BusinessEntityID -> prodavac_id
       - JobTitle -> naziv_posla
       - BirthDate -> dtm_rodj
       - MaritalStatus -> bracni_status
       - SalesQuota -> prod_kvota
       - Bonus -> nžbonus
*/
insert into prodavac
select  sp.BusinessEntityID, e.JobTitle, e.BirthDate, e.MaritalStatus, sp.SalesQuota, sp.Bonus
from AdventureWorks2014.HumanResources.Employee as e inner join AdventureWorks2014.Sales.SalesPerson as sp
on e.BusinessEntityID = sp.BusinessEntityID
 
select *
from prodavac
 
/*
b)
Koristeæi tabelu Sales.Store baze AdventureWorks2017
izvršiti insert podataka u tabelu prodavnica
prema sljedeæem pravilu:
       - BusinessEntityID -> prodavnica_id
       - Name -> naziv_prodavnice
       - SalesPersonID -> prodavac_id
*/
 
insert into prodavnica
select BusinessEntityID, name, SalesPersonID
from AdventureWorks2014.Sales.Store
 
select *
from prodavnica
 
/*
b)
Koristeæi tabele Sales.Customer, Sales.SalesOrderHeader i SalesOrderDetail
baze AdventureWorks2017 izvršiti insert podataka u tabelu kupac_detalji
prema sljedeæem pravilu:
       - CustomerID -> kupac_id
       - StoreID -> prodavnica_id
       - AccountNumber -> br_rac
       - OrderDate -> dtm_narudz
       - OrderQty -> kolicina
       - UnitPrice -> cijena
       - UnitPriceDiscount -> popust
Uslov je da se ne dohvataju zapisi u kojima su
StoreID i PersonID NULL vrijednost
*/
insert into kupacDetalj
select c.CustomerID, c.StoreID, c.AccountNumber, soh.OrderDate, sod.OrderQty, sod.UnitPrice, sod.UnitPriceDiscount
from AdventureWorks2014.Sales.Customer as c inner join AdventureWorks2014.Sales.SalesOrderHeader as soh
on c.CustomerID = soh.CustomerID
inner join AdventureWorks2014.Sales.SalesOrderDetail as sod
on soh.SalesOrderID = sod.SalesOrderID
where c.StoreID is not null and c.PersonID is not null
 
select*
from kupacDetalj
 
--10 bodova
 
 
 
--3.
/*
a)
U tabeli prodavac dodati izraèunatu kolonu god_rodj
u koju æe se smještati godina roðenja prodavca.
*/
 
select *
from prodavac
 
alter table prodavac
add godinaRodjenja as year(datumRodjenja)
 
select * from prodavac
 
 
 
/*
b)
U tabeli kupac_detalji promijeniti tip podatka
kolone cijena iz novèanog u decimalni tip oblika (8,2)
*/
 
alter table kupacDetalj
alter column cijena decimal(8,2)
 
/*
c)
U tabeli kupac_detalji dodati standardnu kolonu
lozinka tipa 20 unicode karaktera.
*/
 
alter table kupacDetalj
add lozinka nvarchar(20)
 
select * from kupacDetalj
 
/*
d)
Kolonu lozinka popuniti tako da bude spojeno
10 sluèajno generisanih znakova i
numerièki dio (bez vodeæih nula) iz kolone br_rac
*/
update kupacDetalj
set lozinka = left(newid(), 10) + right(brojRacuna, 5)
 
select *
from kupacDetalj
 
--10 bodova
 
 
 
 
 
 
--4.
/*
Koristeæi tabele prodavnica i kupac_detalji
dati pregled sumiranih kolièina po
nazivu prodavnice i godini naruèivanja.
Sortirati po nazivu prodavnice.
*/
 
select p.nazivProdavnice, sum(kd.kolicina) as kolicinaSumirano, year(kd.datumNarudzbe) as godina
from prodavnica as p inner join kupacDetalj as kd
on p.prodavnicaID = kd.prodavnicaID
group by p.nazivProdavnice, year(kd.datumNarudzbe)
order by 1
 
--6 bodova
 
 
--5.
/*
Kreirati pogled v_prodavac_cijena sljedeæe strukture:
       - prodavac_id
       - bracni_status
       - sum_cijena
Uslov je da se u pogled dohvate samo oni zapisi u
kojima je sumirana vrijednost veæa od 1000000.
*/
 
go
create view view_prodavacCijena
as
select p.prodavacID, p.bracniStatus, sum(kd.cijena) as cijenaSumirano
from prodavac as p inner join prodavnica as pr
on p.prodavacID = pr.prodavacID
inner join kupacDetalj as kd
on pr.prodavnicaID = kd.prodavnicaID
group by p.prodavacID, p.bracniStatus
having sum(kd.cijena) > 1000000
 
select*
from view_prodavacCijena
 
 
--8 bodova
 
--6.
/*
Koristeæi pogled v_prodavac_cijena
kreirati proceduru p_prodavac_cijena sa parametrom
bracni_status èija je zadata (default) vrijednost M.
Uslov je da se procedurom dohvataju zapisi u kojima je
vrijednost u koloni sum_cijena veæa od srednje vrijednosti kolone sum_cijena.
Obavezno napisati kod za pokretanje procedure.
*/
 
go
create procedure procProdavacCijena
(
       @bracni_status char(1) = 'M'
)
as
begin
select *
from view_prodavacCijena
where bracniStatus = @bracni_status and
       cijenaSumirano > (select avg(cijenaSumirano) from view_prodavacCijena)
end
 
exec procProdavacCijena;
--8 bodova
 
 
--7.
/*
Iz tabele kupac_detalji prikazati zapise u kojima je
vrijednost u koloni cijena jednaka
minimalnoj, odnosno, maksimalnoj vrijednosti u ovoj koloni.
Upit treba da vraæa kolone kupac_id, prodavnica_id i cijena.
Sortirati u rastuæem redoslijedu prema koloni cijena.
*/
select kupacID, prodavnicaID, cijena
from kupacDetalj
where cijena = (select min(cijena) from kupacDetalj) or cijena = (select max(cijena) from kupacDetalj)
 
--8 bodova
 
--8.
/*
a)
U tabeli kupac_detalji kreirati kolonu
cijena_sa_popustom tipa decimal (8,2).
*/
select *
from kupacDetalj
alter table kupacDetalj
add cijenaSaPopustom decimal(8,2)
 
select *
from kupacDetalj
 
/*
b)
Koristeæi tabelu kupac_detalji
kreirati proceduru p_popust sa parametrom
godina koji æe odgovarati godini iz datum naruèivanja.
Procedura æe vršiti update kolone cijena_sa_popustom
ako je vrijednost parametra veæa od 2013,
inaèe se daje poruka 'transakcija nije izvršena'.
Testirati funkcionisanje procedure za vrijednost
parametra godina 2014.
Obavezno napisati kod za provjeru sadržaja tabele
nakon što se pokrene procedura.
*/
go
create procedure procPopust
(     
       @godina int
)
as
begin
       begin transaction
       update kupacDetalj
       set cijenaSaPopustom = cijena * (1 - popust)
       where YEAR(datumNarudzbe) = @godina
       if (@godina > 2013)
             begin
                    commit transaction
                    print('Transakcija uspjesna!')
             end
             else
                    begin
                           print ('Transankcija nije izvrsena!')
                           rollback transaction
                    end
end
exec procPopust @godina = 2014;
exec procPopust @godina = 2010;
--testiranje
 
select *
from kupacDetalj
--8 bodova
 
--9.
/*
a)
U tabeli prodavac kreirati kolonu min_kvota tipa decimal (8,2).
i na njoj postaviti ogranièenje da se
ne može unijeti negativna vrijednost.
*/
 
alter table prodavac
add minimalnaKvota decimal (8,2) constraint CK_minimalnaKvota check (minimalnaKvota >=0)
 
select *
from prodavac
 
/*
b)
Kreirati skalarnu funkciju f_kvota sa parametrom prod_kvota.
Funkcija æe vraæati rezultat tipa decimal (8,2)
koji æe se raèunati po pravilu:
       10% od prod_kvota
*/
go
create function f_Kvota(@prod_Kvota money)
returns decimal (8,2)
as
begin
       return @prod_Kvota * 0.10
end
 
 
--testiranje
 
/*
c)
Koristeæi funkciju f_kvota izvršiti update
kolone min_kvota u tabeli prodavac
*/
update prodavac
set minimalnaKvota = dbo.f_Kvota(prodKvota)
 
 
select * from prodavac
--8 bodova
 
--10.
/*
a)
Kreirati tabelu prodavac_log strukture:
       - log_id, primarni kljuè, automatsko punjenje sa poèetnom vrijednošæu 1 i inkrementom 1
       - prodavac_id int
       - min_kvota decimal (8,2)
       - dogadjaj varchar (3)
       - mod_date datetime
*/
create table prodavacLog
(
       logID int constraint PK_logID primary key identity (1,1),
       prodavacID int,
       min_kvota decimal (8,2),
       dogadjaj varchar(3),
       mod_date datetime
)
 
 
/*
b)
Nad tabelom prodavac kreirati okidaè t_ins_prod
kojim æe se prilikom inserta podataka u
tabelu prodavac izvršiti insert podataka u
tabelu prodavac_log sa naznakom aktivnosti
(insert, update ili delete).
*/
go
create trigger triggerInsProd
on prodavac
after insert
as
begin
       insert into prodavacLog
       select i.prodavacID, i.minimalnaKvota, 'ins', getdate()
       from inserted as i
end
 
 
/*
c)
U tabelu prodavac insertovati zapis
291, Sales Manager, 1985-09-30, M, 250000.00, 985.00, -20000.00
Ako je potrebno izvršiti podešavanja
koja æe omoguæiti insrt zapisa.
*/
 
--da bi mogli izvrsiti insert potrebno je dropati constraint
alter table prodavac
drop constraint CK_minimalnaKvota
 
insert into prodavac
values (291, 'Sales Manager', '1985-09-30', 'M', 250000.00, 985.00, -20000.00)
 
insert into prodavac
values(291, 'Sales Manager', '1985-09-30','M', 250000.00, 985.00, -20000.00)
 
/*
d)
Obavezno napisati kod za pregled sadržaja
tabela prodavac i prodavac_log.
*/
select * from prodavac
select * from prodavacLog
--4 boda
 
 
 
--29.06.2022.
 
--BAZE PODATAKA II � ISPIT
 
--***Prilikom izrade zadataka, OBAVEZNO iznad svakog zadatka napisati redni broj zadatka npr (4c). Zadaci koji ne budu ozna�eni na prethodno definisan na�in ne�e biti evaluirani.
 
--1.   Kroz SQL kod kreirati bazu podataka sa imenom va�eg broja indeksa.
CREATE DATABASE FIT_ispitniZadatak1
GO
USE FIT_ispitniZadatak1
GO
--2.   U kreiranoj bazi podataka kreirati tabele sa sljede�om strukturom:
--a)   Proizvodi
--�   ProizvodID, cjelobrojna vrijednost i primarni klju�, autoinkrement
--�   Naziv, 50 UNICODE karaktera (obavezan unos)
--�   SifraProizvoda, 25 UNICODE karaktera (obavezan unos)
--�   Boja, 15 UNICODE karaktera
--�   NazivKategorije, 50 UNICODE (obavezan unos)
--�   Tezina, decimalna vrijednost sa 2 znaka iza zareza
 
create table proizvodi
(
       proizvodID int constraint PK_proizvod primary key identity(1,1),
       naziv nvarchar(50) not null,
       sifraProizvoda nvarchar (25) not null,
       boja nvarchar (15),
       nazivKategorije nvarchar (50) not null,
       tezina decimal (8,2)
)
--b)   ZaglavljeNarudzbe
--�   NarudzbaID, cjelobrojna vrijednost i primarni klju�, autoinkrement
--�   DatumNarudzbe, polje za unos datuma i vremena (obavezan unos)
--�   DatumIsporuke, polje za unos datuma i vremena
--�   ImeKupca, 50 UNICODE (obavezan unos)
--�   PrezimeKupca, 50 UNICODE (obavezan unos)
--�   NazivTeritorije, 50 UNICODE (obavezan unos)
--�   NazivRegije, 50 UNICODE (obavezan unos)
--�   NacinIsporuke, 50 UNICODE (obavezan unos)
create table zaglavljeNarudzbe
(
       narudzbaID int constraint PK_zaglavljeNaruzdbe primary key identity (1,1),
       datumNarudzbe datetime not null,
       datumIsporuke datetime,
       imeKupca nvarchar (50) not null,
       prezimeKupca nvarchar (50) not null,
       nazivTeritorije nvarchar (50) not null,
       nazivRegije nvarchar (50) not null,
       nacinIsporuke nvarchar (50) not null
)
--c)   DetaljiNarudzbe
--�   NarudzbaID, cjelobrojna vrijednost, strani klju�
--�   ProizvodID, cjelobrojna vrijednost, strani klju�
--�   Cijena, nov�ani tip (obavezan unos),
--�   Kolicina, skra�eni cjelobrojni tip (obavezan unos),
--�   Popust, nov�ani tip (obavezan unos)
create table detaljiNarudzbe
(
       narudzbaID int not null constraint FK_zaglavljeNarudzbe foreign key references zaglavljeNarudzbe(narudzbaID),
       proizvodID int not null constraint FK_proizvodi foreign key references proizvodi(proizvodID),
       cijena money not null,
       kolicina smallint not null,
       popust money not null,
       detaljiNarudzbe int constraint PK_detaljiNarudzbe primary key identity (1,1)
       --primarni kljuc se mora pratiti, ukoliko ga nema mozemo iskoristiti naziv same tabele da nam bude primarni kljuc
)
--**Jedan proizvod se mo�e vi�e puta naru�iti, dok jedna narud�ba mo�e sadr�avati vi�e proizvoda. U okviru jedne narud�be jedan proizvod se mo�e naru�iti vi�e puta.
--7 bodova
 
 
--3.   Iz baze podataka AdventureWorks u svoju bazu podataka prebaciti sljede�e podatke:
--a)   U tabelu Proizvodi dodati sve proizvode, na mjestima gdje nema pohranjenih podataka o te�ini zamijeniti vrijednost sa 0
--�   ProductID -> ProizvodID
--�   Name  -> Naziv     
--�   ProductNumber -> SifraProizvoda
--�   Color -> Boja
--�   Name (ProductCategory) -> NazivKategorije
--�   Weight -> Tezina
SET IDENTITY_INSERT proizvodi ON
 
insert into proizvodi (proizvodID, naziv, sifraProizvoda, boja, nazivKategorije, tezina)
select p.ProductID, p.name, p.ProductNumber, p.Color, pc.name, isnull(p.weight, 0)
from AdventureWorks2014.Production.Product as p inner join AdventureWorks2014.Production.ProductSubcategory as ps
on p.ProductSubcategoryID = ps.ProductSubcategoryID
inner join AdventureWorks2014.Production.ProductCategory as pc
on ps.ProductCategoryID = pc.ProductCategoryID
 
select*
from proizvodi
 
--b)   U tabelu ZaglavljeNarudzbe dodati sve narud�be
--�   SalesOrderID -> NarudzbaID
--�   OrderDate -> DatumNarudzbe
--�   ShipDate -> DatumIsporuke
--�   FirstName (Person) -> ImeKupca
--�   LastName (Person) -> PrezimeKupca
--�   Name (SalesTerritory) -> NazivTeritorije
--�   Group (SalesTerritory) -> NazivRegije
--�   Name (ShipMethod) -> NacinIsporuke
 
SET IDENTITY_INSERT zaglavljeNarudzbe ON
 
insert into zaglavljeNarudzbe(narudzbaID, datumNarudzbe, datumIsporuke, imeKupca, prezimeKupca, nazivTeritorije, nazivRegije, nacinIsporuke)
select soh.SalesOrderID, soh.OrderDate, soh.ShipDate, pp.FirstName, pp.LastName, st.name, st.[Group], sm.name
from AdventureWorks2014.Sales.SalesOrderHeader as soh inner join AdventureWorks2014.sales.Customer as sc
on soh.CustomerID = sc.CustomerID
inner join AdventureWorks2014.Person.Person as pp
on sc.PersonID = pp.BusinessEntityID
inner join AdventureWorks2014.Sales.SalesTerritory as st
on st.TerritoryID = soh.TerritoryID
inner join AdventureWorks2014.Purchasing.ShipMethod as sm
on soh.ShipMethodID = sm.ShipMethodID
 
SET IDENTITY_INSERT zaglavljeNarudzbe OFF
go
 
select*
from zaglavljeNarudzbe
 
 
--c)   U tabelu DetaljiNarudzbe dodati sve stavke narud�be
--�   SalesOrderID -> NarudzbaID
--�   ProductID -> ProizvodID
--�   UnitPrice -> Cijena
--�   OrderQty -> Kolicina
--�   UnitPriceDiscount -> Popust
--8 bodova
 
 
INSERT INTO detaljiNarudzbe
SELECT SOD.SalesOrderID, SOD.ProductID, SOD.UnitPrice, SOD.OrderQty, SOD.UnitPriceDiscount
FROM AdventureWorks2014.Sales.SalesOrderDetail AS SOD
GO
 
 
 
--4.  
--a)   (6 bodova) Kreirati upit koji �e prikazati ukupan broj uposlenika po odjelima.
--Potrebno je prebrojati samo one uposlenike koji su trenutno aktivni, odnosno rade na datom odjelu.
--Tako�er, samo uzeti u obzir one uposlenike koji imaju vi�e od 10 godina radnog sta�a (ne uklju�uju�i grani�nu vrijednost).
--Rezultate sortirati preba broju uposlenika u opadaju�em redoslijedu.(AdventureWorks2017)
USE AdventureWorks2017
SELECT
    D.Name,
    COUNT(*) 'Broj uposlenika'
FROM HumanResources.Employee AS E
    INNER JOIN HumanResources.EmployeeDepartmentHistory AS EDH ON E.BusinessEntityID = EDH.BusinessEntityID
    INNER JOIN HumanResources.Department AS D ON EDH.DepartmentID = D.DepartmentID
WHERE EDH.EndDate IS NULL AND DATEDIFF(YEAR, E.HireDate, GETDATE()) > 10
GROUP BY D.Name
ORDER BY 'Broj uposlenika' DESC
GO
--, SUM(IIF(POD.RejectedQty>100,1,0)) 'Broj stavki'
--b)   Kreirati upit koji prikazuje po mjesecima ukupnu vrijednost poru�ene robe za skladi�te, te ukupnu koli�inu primljene robe, isklju�ivo u 2012 godini. Uslov je da su tro�kovi prevoza bili izme�u 500 i 2500, a da je dostava izvr�ena CARGO transportom. Tako�er u rezultatima upita je potrebno prebrojati stavke narud�be na kojima je odbijena koli�ina ve�a od 100.(AdventureWorks2017)
 
USE AdventureWorks2017
--1. NA�IN
SELECT
    MONTH(POH.OrderDate) 'Mjesec',
    SUM(POD.LineTotal),
    SUM(POD.ReceivedQty),
    SUM(IIF(POD.RejectedQty > 100, 1, 0)) 'Broj stavki'
FROM Purchasing.PurchaseOrderHeader AS POH
    INNER JOIN Purchasing.PurchaseOrderDetail AS POD ON POH.PurchaseOrderID = POD.PurchaseOrderID
   INNER JOIN Purchasing.ShipMethod AS SM ON POH.ShipMethodID = SM.ShipMethodID
WHERE YEAR(POH.OrderDate)=2012
    AND POH.Freight BETWEEN 500 AND 2500
    AND SM.Name LIKE '%CARGO%'
GROUP BY MONTH(POH.OrderDate) 
GO 
--2. NA�IN 
SELECT
  MONTH(POH.OrderDate) 'Mjesec',
  SUM(POD.LineTotal),
  SUM(POD.ReceivedQty),
  (SELECT COUNT(*)
      FROM Purchasing.PurchaseOrderHeader AS POH1
             INNER JOIN Purchasing.PurchaseOrderDetail AS POD1 ON POH1.PurchaseOrderID = POD1.PurchaseOrderID
        INNER JOIN Purchasing.ShipMethod AS SM1 ON POH1.ShipMethodID = SM1.ShipMethodID
      WHERE MONTH(POH.OrderDate) = MONTH(POH1.OrderDate)
          AND POD1.RejectedQty > 100
          AND YEAR(POH1.OrderDate) = 2012
          AND POH1.Freight BETWEEN 500 AND 2500
          AND SM1.Name LIKE '%CARGO%')
FROM Purchasing.PurchaseOrderHeader AS POH
  INNER JOIN Purchasing.PurchaseOrderDetail AS POD ON POH.PurchaseOrderID = POD.PurchaseOrderID
  INNER JOIN Purchasing.ShipMethod AS SM ON POH.ShipMethodID = SM.ShipMethodID
WHERE YEAR(POH.OrderDate)=2012
  AND POH.Freight BETWEEN 500 AND 2500
  AND SM.Name LIKE '%CARGO%'
GROUP BY MONTH(POH.OrderDate)
 
GO
 
--3. NA�IN
SELECT
    Q.Mjesec,
    SUM(Q.[Ukupna vrijednost]) 'Ukupna vrijednost',
    SUM(Q.[Ukupna koli�ina]) 'Ukupna koli�ina',
    SUM(Q.[Stavke narudzbe]) 'Stavke narudzbe'
FROM (SELECT
    MONTH(POH.OrderDate) 'Mjesec',
    SUM(POD.LineTotal) 'Ukupna vrijednost',
    SUM(POD.ReceivedQty) 'Ukupna koli�ina',
    (SELECT COUNT(*)
           FROM AdventureWorks2017.Purchasing.PurchaseOrderDetail AS POD1
             WHERE POD1.RejectedQty > 100 AND POD.PurchaseOrderID = POD1.PurchaseOrderID) 'Stavke narudzbe'
FROM Purchasing.PurchaseOrderDetail AS POD
    INNER JOIN Purchasing.PurchaseOrderHeader AS POH ON POD.PurchaseOrderID = POH.PurchaseOrderID
    INNER JOIN Purchasing.ShipMethod AS SM ON POH.ShipMethodID = SM.ShipMethodID
WHERE YEAR(POH.OrderDate) = 2012
    AND (POH.Freight BETWEEN 500 AND 2500)
    AND SM.Name LIKE '%CARGO%'
GROUP BY MONTH(POH.OrderDate), POD.PurchaseOrderID) AS Q
GROUP BY Q.Mjesec
 
GO
--PROVJERA
SELECT
    POH.OrderDate,
    POD.RejectedQty,
    POD.PurchaseOrderDetailID,
    POH.PurchaseOrderID
FROM Purchasing.PurchaseOrderHeader AS POH
    INNER JOIN Purchasing.PurchaseOrderDetail AS POD ON POH.PurchaseOrderID = POD.PurchaseOrderID
    INNER JOIN Purchasing.ShipMethod AS SM ON POH.ShipMethodID = SM.ShipMethodID
WHERE YEAR(POH.OrderDate)=2012
    AND POH.Freight BETWEEN 500 AND 2500
    AND SM.Name LIKE '%CARGO%'
    AND MONTH(POH.OrderDate) = 1
  --GROUP BY MONTH(POH.OrderDate), POD.RejectedQty
GO 
--c)   (11 bodova) Prikazati ukupan broj narud�bi koje su obradili uposlenici, za svakog uposlenika pojedina�no. Uslov je da su narud�be kreirane u 2011 ili 2012 godini, te da je u okviru jedne narud�be odobren popust na dvije ili vi�e stavki. Tako�er uzeti u obzir samo one narud�be koje su isporu�ene u Veliku Britaniju, Kanadu ili Francusku. (AdventureWorks2017)
 
SELECT
    PP.LastName,
    PP.FirstName,
    COUNT(*) BrojNarudzbi
FROM Person.Person AS PP
    INNER JOIN HumanResources.Employee AS E ON PP.BusinessEntityID = E.BusinessEntityID
    INNER JOIN Sales.SalesPerson AS SP ON SP.BusinessEntityID = E.BusinessEntityID
    INNER JOIN Sales.SalesOrderHeader AS SOH ON SOH.SalesPersonID = SP.BusinessEntityID
    INNER JOIN Sales.SalesTerritory AS ST ON ST.TerritoryID = SOH.TerritoryID
WHERE YEAR(SOH.OrderDate) IN (2011,2012)
    AND ST.Name IN ('United Kingdom', 'Canada', 'France')
    AND (SELECT COUNT(*)
           FROM Sales.SalesOrderDetail AS SOD
        WHERE SOD.SalesOrderID = SOH.SalesOrderID AND SOD.UnitPriceDiscount>0) >=2
GROUP BY PP.LastName, PP.FirstName
ORDER BY BrojNarudzbi DESC
 
GO
 
 
 
 
--d)   (11 bodova) Napisati upit koji �e prikazati sljede�e podatke o proizvodima: naziv proizvoda,
--naziv kompanije dobavlja�a, koli�inu na skladi�tu, te kreiranu �ifru proizvoda. �ifra se sastoji od sljede�ih vrijednosti: (Northwind)
--1)   Prva dva slova naziva proizvoda
--2)   Karakter /
--3)   Prva dva slova druge rije�i naziva kompanije dobavlja�a, uzeti u obzir one kompanije koje u nazivu imaju 2 ili 3 rije�i
--4)   ID proizvoda po pravilu ukoliko se radi o jednocifrenom broju na njega dodati slovo 'a', u ostalim slu�ajevima dodati obrnutu vrijednost broja
--Npr. Za proizvod sa nazivom Chai i sa dobavlja�em naziva Exotic Liquids, �ifra �e btiti Ch/Li1a.
 
USE Northwind
GO
SELECT
    P.ProductName,
    S.CompanyName,
    P.UnitsInStock,
    CONCAT(
        LEFT(P.ProductName, 2),
        '/',
        LEFT(SUBSTRING(S.CompanyName, CHARINDEX(' ', S.CompanyName) + 1, LEN(S.CompanyName)), 2),
        IIF(P.ProductID BETWEEN 1 AND 9, 'a', REVERSE(P.ProductID))
    ),
    -- Moze i sa +, meni bolje izgleda kad je grupisano pod CONCAT
    -- LEFT(P.ProductName, 2)
    --     + '/'
    --     + LEFT(SUBSTRING(S.CompanyName, CHARINDEX(' ', S.CompanyName) + 1, LEN(S.CompanyName)), 2)
    --     + IIF(P.ProductID BETWEEN 1 AND 9, 'a', REVERSE(P.ProductID)),
    P.ProductID
FROM Products AS P
INNER JOIN Suppliers AS S ON P.SupplierID = S.SupplierID
WHERE LEN(S.CompanyName) - LEN(REPLACE(S.CompanyName, ' ', '')) IN (1, 2)
 
GO
--           37 bodova
--5.  
--a)   (3 boda) U kreiranoj bazi kreirati index kojim �e se ubrzati pretraga prema �ifri i nazivu proizvoda. Napisati upit za potpuno iskori�tenje indexa.
USE brojIndexa
GO
 
CREATE INDEX IX_Search_Products
ON Proizvodi(SifraProizvoda, Naziv)
 
SELECT P.SifraProizvoda, P.Naziv
FROM Proizvodi AS P
WHERE P.SifraProizvoda LIKE 'F%' AND P.Naziv LIKE 'H%'
--b)   (7 bodova) U kreiranoj bazi kreirati proceduru sp_search_products kojom �e se vratiti podaci o proizvodima na osnovu kategorije kojoj pripadaju ili te�ini.
--Korisnici ne moraju unijeti niti jedan od parametara ali u tom slu�aju procedura ne vra�a niti jedan od zapisa.
--Korisnicima unosom ve� prvog slova kategorije se trebaju osvje�iti zapisi, a vrijednost unesenog parametra te�ina �e vratiti one proizvode �ija te�ina je ve�a od  unesene vrijednosti.
GO
CREATE PROCEDURE sp_search_products
(
    @Kategorija NVARCHAR(50)=NULL,
    @Tezina DECIMAL(18,2)=NULL
)
AS
BEGIN
       SELECT *
       FROM Proizvodi AS P
       WHERE P.NazivKategorije LIKE @Kategorija + '%' OR P.Tezina > @Tezina
END
GO
 
 
EXEC sp_search_products 'Clothing'
EXEC sp_search_products @Tezina = 2.2
 
--c)   (18 bodova) Zbog progla�enja dobitnika nagradne igre odr�ane u prva dva mjeseca drugog kvartala 2013 godine potrebno je kreirati upit. Upitom �e se prikazati tre�a najve�a narud�ba (vrijednost bez popusta) za svaki mjesec pojedina�no. Obzirom da je u pravilima nagradne igre potrebno nagraditi 2 osobe (mu�karca i �enu) za svaki mjesec, potrebno je u rezultatima upita prikazati pored navedenih stavki i o kojem se kupcu radi odnosno ime i prezime, te koju je nagradu osvojio. Nagrade se dodjeljuju po sljede�em pravilu:
--�   za �ene u prvom mjesecu drugog kvartala je stoni mikser, dok je za mu�karce usisiva�
--�   za �ene u drugom mjesecu drugog kvartala je pegla, dok je za mu�karc multicooker
-- Obzirom da za kupce nije eksplicitno naveden spol, odre�ivat �e se po pravilu: Ako je zadnje slovo imena a, smatra se da je osoba �enskog spola u suprotnom radi se o osobi mu�kog spola. Rezultate u formiranoj tabeli dobitnika sortirati prema vrijednosti narud�be u opadaju�em redoslijedu. (AdventureWorks2017)
--28 bodova
--6.   Dokument teorija_28_06_2022, preimenovati va�im brojem indeksa, te u tom dokumentu izraditi pitanja.
--20 bodova
--SQL skriptu (bila prazna ili ne) imenovati Va�im brojem indeksa npr IB200001.sql, te istu zajedno sa .docx dokumentom kompromitovati  u jednu datoteku naziva npr IB200001.zip i upload-ovati na ftp u folder Upload.
--Maksimalan broj bodova:100 
--Prag prolaznosti: 55
GO
USE AdventureWorks2017
 
SELECT *
FROM
    (SELECT TOP 1
        T1.SalesOrderID,
        T1.FirstName,
        T1.LastName,
        T1.[Ukupna vrijednost],
        T1.Nagrada
    FROM
        (SELECT TOP 3
            SOH.SalesOrderID,
            PP.FirstName,
            PP.LastName,
            SUM(SOD.UnitPrice * SOD.OrderQty) 'Ukupna vrijednost',
            'Stoni mikser' Nagrada
            FROM Sales.SalesOrderHeader AS SOH
                INNER JOIN Sales.SalesOrderDetail AS SOD ON SOH.SalesOrderID = SOD.SalesOrderID
                INNER JOIN Sales.Customer AS SC ON SOH.CustomerID = SC.CustomerID
                INNER JOIN Person.Person AS PP ON SC.PersonID = PP.BusinessEntityID
            WHERE YEAR(SOH.OrderDate) = 2013 AND MONTH(SOH.OrderDate) = 4 AND RIGHT(PP.FirstName, 1) = 'a'
            GROUP BY SOH.SalesOrderID, PP.FirstName, PP.LastName
            ORDER BY 'Ukupna vrijednost' DESC) AS T1
        ORDER BY 'Ukupna vrijednost' ASC) AS T2
UNION
SELECT *
FROM
    (SELECT TOP 1
        T1.SalesOrderID,
        T1.FirstName,
        T1.LastName,
        T1.[Ukupna vrijednost],
        T1.Nagrada
    FROM
        (SELECT TOP 3
            SOH.SalesOrderID,
            PP.FirstName,
            PP.LastName,
            SUM(SOD.UnitPrice * SOD.OrderQty) 'Ukupna vrijednost',
            'Usisiva�' Nagrada
            FROM Sales.SalesOrderHeader AS SOH
                INNER JOIN Sales.SalesOrderDetail AS SOD ON SOH.SalesOrderID = SOD.SalesOrderID
                INNER JOIN Sales.Customer AS SC ON SOH.CustomerID = SC.CustomerID
                INNER JOIN Person.Person AS PP ON SC.PersonID = PP.BusinessEntityID
            WHERE YEAR(SOH.OrderDate) = 2013 AND MONTH(SOH.OrderDate) = 4 AND RIGHT(PP.FirstName, 1) <> 'a'
            GROUP BY SOH.SalesOrderID, PP.FirstName, PP.LastName
            ORDER BY 'Ukupna vrijednost' DESC) AS T1
        ORDER BY 'Ukupna vrijednost' ASC) AS T2
UNION
SELECT *
FROM
    (SELECT TOP 1
        T1.SalesOrderID,
        T1.FirstName,
        T1.LastName,
        T1.[Ukupna vrijednost],
        T1.Nagrada
    FROM
        (SELECT TOP 3
            SOH.SalesOrderID,
            PP.FirstName,
            PP.LastName,
            SUM(SOD.UnitPrice * SOD.OrderQty) 'Ukupna vrijednost',
            'Pegla' Nagrada
            FROM Sales.SalesOrderHeader AS SOH
                INNER JOIN Sales.SalesOrderDetail AS SOD ON SOH.SalesOrderID = SOD.SalesOrderID
                INNER JOIN Sales.Customer AS SC ON SOH.CustomerID = SC.CustomerID
                INNER JOIN Person.Person AS PP ON SC.PersonID = PP.BusinessEntityID
            WHERE YEAR(SOH.OrderDate) = 2013 AND MONTH(SOH.OrderDate) = 5 AND RIGHT(PP.FirstName, 1) = 'a'
            GROUP BY SOH.SalesOrderID, PP.FirstName, PP.LastName
            ORDER BY 'Ukupna vrijednost' DESC) AS T1
        ORDER BY 'Ukupna vrijednost' ASC) AS T2
UNION
SELECT *
FROM
    (SELECT TOP 1
        T1.SalesOrderID,
        T1.FirstName,
        T1.LastName,
        T1.[Ukupna vrijednost],
        T1.Nagrada
    FROM
        (SELECT TOP 3
            SOH.SalesOrderID,
            PP.FirstName,
            PP.LastName,
            SUM(SOD.UnitPrice * SOD.OrderQty) 'Ukupna vrijednost',
            'Multicooker' Nagrada
            FROM Sales.SalesOrderHeader AS SOH
                INNER JOIN Sales.SalesOrderDetail AS SOD ON SOH.SalesOrderID = SOD.SalesOrderID
                INNER JOIN Sales.Customer AS SC ON SOH.CustomerID = SC.CustomerID
                INNER JOIN Person.Person AS PP ON SC.PersonID = PP.BusinessEntityID
            WHERE YEAR(SOH.OrderDate) = 2013 AND MONTH(SOH.OrderDate) = 5 AND RIGHT(PP.FirstName, 1) <> 'a'
            GROUP BY SOH.SalesOrderID, PP.FirstName, PP.LastName
            ORDER BY 'Ukupna vrijednost' DESC) AS T1
        ORDER BY 'Ukupna vrijednost' ASC) AS T2
 
 
-- Naredni kod nije Elda pisala
-- Usrana alternativa
GO
CREATE PROCEDURE Nagradna_Igra  
    @NagradaM nvarchar(max),
    @NagradaZ nvarchar(max),
    @Spol varchar(1),
    @Godina int,
    @Mjesec int  
AS  
SELECT
    SOH.SalesOrderID,
    PP.FirstName,
    PP.LastName,
    SUM(SOD.UnitPrice * SOD.OrderQty) 'Ukupna vrijednost',
    IIF(@Spol = 'M' AND RIGHT(PP.FirstName, 1) <> 'a', @NagradaM, @NagradaZ) Nagrada
FROM Sales.SalesOrderHeader AS SOH
    INNER JOIN Sales.SalesOrderDetail AS SOD ON SOH.SalesOrderID = SOD.SalesOrderID
    INNER JOIN Sales.Customer AS SC ON SOH.CustomerID = SC.CustomerID
    INNER JOIN Person.Person AS PP ON SC.PersonID = PP.BusinessEntityID
WHERE YEAR(SOH.OrderDate) = @Godina
    AND MONTH(SOH.OrderDate) = @Mjesec
    AND ((@Spol = 'M' AND RIGHT(PP.FirstName, 1) <> 'a') OR (@Spol = 'Z' AND RIGHT(PP.FirstName, 1) = 'a'))
GROUP BY SOH.SalesOrderID, PP.FirstName, PP.LastName
ORDER BY 'Ukupna vrijednost' DESC
OFFSET 2 ROWS FETCH NEXT 1 ROWS ONLY
GO 
 
 
CREATE TABLE #Dobitnici
(
    SalesOrderID INT,
    FirstName VARCHAR(MAX),
    LastName VARCHAR(MAX),
    UkupnaVrijednost MONEY,
    Nagrada VARCHAR(MAX)
)
 
INSERT INTO #Dobitnici
EXECUTE Nagradna_Igra @NagradaM = 'Multicooker', @NagradaZ = 'Pegla', @Godina = 2013, @Mjesec = 4, @Spol = 'M'
 
INSERT INTO #Dobitnici
EXECUTE Nagradna_Igra @NagradaM = 'Multicooker', @NagradaZ = 'Pegla', @Godina = 2013, @Mjesec = 4, @Spol = 'Z'
 
INSERT INTO #Dobitnici
EXECUTE Nagradna_Igra @NagradaM = 'Stoni mikser', @NagradaZ = 'Usisiva�', @Godina = 2013, @Mjesec = 5, @Spol = 'M'
 
INSERT INTO #Dobitnici
EXECUTE Nagradna_Igra @NagradaM = 'Stoni mikser', @NagradaZ = 'Usisiva�', @Godina = 2013, @Mjesec = 5, @Spol = 'Z'
 
SELECT * FROM #Dobitnici
 
DROP TABLE #Dobitnici
 
 
 
 
use pubs
 
select a.au_fname, a.au_lname, count(ta.title_id) as 'Ukupan broj naslova'
from pubs.dbo.authors as a
inner join pubs.dbo.titleauthor as ta
on a.au_id = ta.au_id
group by a.au_fname, a.au_lname
having COUNT(ta.title_id) >=2
order by 3 desc
 
create view view_2
as
select t.title, t.type, t.price, s.qty, YEAR(s.ord_date) 'Godina prodaje', MONTH(s.ord_date) 'Mjesec prodaje', st.stor_name
from titles as t
inner join sales as s
on t.title_id = s.title_id
inner join stores as st
on s.stor_id = st.stor_id
where YEAR(s.ord_date) = 1994 and t.price between 10 and 20
 
select*
from view_2
 
create procedure proc_3(
@au_id varchar(11),
@au_lname varchar(40),
@au_fname varchar(20),
@phone char(12),
@address varchar(40),
@city varchar(20),
@state char(2),
@zip char(5),
@contract bit
)
as
begin
insert into authors
values (@au_id, @au_lname, @au_fname, @phone, @address, @city, @state, @zip, @contract)
end
 
select*
from authors
exec proc_3 @au_id = '222-55-6851',
@au_lname = 'Gološ',
@au_fname = 'Kemal',
@phone = '062 967-6080',
@address = 'Blagaj bb',
@city = 'Mostar',
@state = 'MO',
@zip = '88201',
@contract = '1'
 
create procedure proc_4(
@au_id varchar(11)
)
as
begin
delete from authors
where au_id = @au_id
end
 
exec proc_4 @au_id = '222-55-6851'
select *
from authors
where au_id = '222-55-6851'
 
 
 
 
 
 
 
--1
create database indeks2
go
use indeks2
 
--2
--2a
create table Proizvodi
(
       ProizvodID          int constraint PK_proizvod primary key,
       Naziv               nvarchar (50) not null,
       SifraProizvoda      nvarchar (25) not null,
       Boja                nvarchar (15),
       NazivKategorije     nvarchar (50) not null,
       Tezina              decimal (8,2)
)
 
--2b
create table ZaglavljeNarudzbe
(
       NaruzdbaID          int constraint PK_zaglavljeNarudzbe primary key,
       DatumNarudzbe datetime not null,
       DatumIsporuke datetime,
       ImeKupca            nvarchar (50) not null,
       PrezimeKupca  nvarchar (50) not null,
       NazivTeritorije     nvarchar (50) not null,
       NazivRegije         nvarchar (50) not null,
       NacinIsporuke nvarchar (50) not null
)
 
--2c
create table DetaljiNarudzbe
(
       NarudzbaID    int constraint FK_DetNar_ZagNar foreign key (NarudzbaID) references ZaglavljeNarudzbe (NaruzdbaID),
       ProizvodID    int constraint FK_DetNar_Proizv foreign key (ProizvodID) references Proizvodi (ProizvodID),
       Cijena        money not null,
       Kolicina      smallint not null,
       Popust        money not null,
       constraint PK_DetaljiNarudzbe primary key (NarudzbaID, ProizvodID)
)
 
--3
--3a
insert into Proizvodi
select p.ProductID,p.Name, p.ProductNumber, p.Color, pc.Name, p.Weight
from   AdventureWorks2014.Production.Product as p inner join AdventureWorks2014.Production.ProductSubcategory as ps
on           p.ProductSubcategoryID = ps.ProductSubcategoryID
             inner join AdventureWorks2014.Production.ProductCategory as pc
             on ps.ProductCategoryID = pc.ProductCategoryID
 
--3b
insert into ZaglavljeNarudzbe
select soh.SalesOrderID, soh.OrderDate, soh.ShipDate, p.FirstName, p.LastName, st.Name, st.[Group], sm.Name
from   AdventureWorks2014.Sales.SalesTerritory as st inner join AdventureWorks2014.Sales.SalesOrderHeader as soh
on           st.TerritoryID = soh.TerritoryID
             inner join AdventureWorks2014.Purchasing.ShipMethod as sm
             on soh.ShipMethodID = sm.ShipMethodID
             inner join AdventureWorks2014.Sales.Customer as c
             on soh.CustomerID = c.CustomerID
             inner join AdventureWorks2014.Person.Person as p
             on c.PersonID = p.BusinessEntityID
 
--3c
insert into DetaljiNarudzbe
select sod.SalesOrderID, sod.ProductID, sod.UnitPrice, sod.OrderQty, sod.UnitPriceDiscount
from   AdventureWorks2014.Sales.SalesOrderDetail as sod
 
 
--4
--4a
select COUNT(e.BusinessEntityID) as 'ukupan broj zaposlenih', d.GroupName, DATEDIFF(year, e.HireDate, getdate()) as 'god radnog staža'
from   AdventureWorks2014.HumanResources.Employee as e inner join AdventureWorks2014.HumanResources.EmployeeDepartmentHistory as edh
on           e.BusinessEntityID = edh.BusinessEntityID
             inner join AdventureWorks2014.HumanResources.Department as d
             on edh.DepartmentID = d.DepartmentID
where  DATEDIFF(year, e.HireDate, getdate()) > 10 and edh.EndDate is not null
group by d.GroupName, e.HireDate
order by 1 desc
 
--4b
select MONTH(poh.OrderDate) 'mjesec', SUM(pod.StockedQty * pod.UnitPrice) as 'ukupna vrijednost robe', SUM(pod.ReceivedQty) as 'ukupna kolicina', poh.Freight, sm.Name
from   AdventureWorks2014.Purchasing.PurchaseOrderDetail as pod inner join AdventureWorks2014.Purchasing.PurchaseOrderHeader as poh
on           pod.PurchaseOrderID = poh.PurchaseOrderID
             inner join AdventureWorks2014.Purchasing.ShipMethod as sm
             on poh.ShipMethodID = sm.ShipMethodID
where  poh.Freight between 500 and 2500 and sm.Name like '%CARGO%' and YEAR(poh.OrderDate) > '2012'
group by poh.Freight, sm.Name, poh.OrderDate
 
--5c
select count (soh.SalesOrderID) as 'ukupno narudzbe', sp.BusinessEntityID, sod.UnitPriceDiscount, st.Name
from   AdventureWorks2014.Sales.SalesOrderDetail as sod inner join AdventureWorks2014.Sales.SalesOrderHeader as soh
on           sod.SalesOrderID = soh.SalesOrderID inner join AdventureWorks2014.Sales.SalesPerson as sp
             on soh.SalesPersonID = sp.BusinessEntityID inner join AdventureWorks2014.Sales.SalesTerritory as st
             on sp.TerritoryID = st.TerritoryID inner join AdventureWorks2014.HumanResources.Employee as e
             on sp.BusinessEntityID = e.BusinessEntityID
where  (YEAR(soh.OrderDate) = 2011 or year(soh.OrderDate) = 2012) and st.Name in ('Canada', 'United Kingdom', 'France')
group by sp.BusinessEntityID, sod.UnitPriceDiscount, st.Name
 
--5c
select p.ProductName, s.CompanyName, p.UnitsInStock, left(p.ProductName,2) + '/' +
             left(SUBSTRING(s.CompanyName, charindex(' ', s.CompanyName) + 1, LEN(s.CompanyName)),2) +
             IIF (p.ProductID between 1 and 9, 'a', reverse(p.ProductID)) as 'SifraProizvoda'
from   Northwind.dbo.Suppliers as s inner join Northwind.dbo.Products as p
on           s.SupplierID = p.SupplierID
 
--5
--5a
create nonclustered index IX_sifra_naziv on Proizvodi
(
       SifraProizvoda asc,
       Naziv asc
)
 
--5b
create procedure sp_search
(
       @Kategorija nvarchar (50) = null,
       @Tezina decimal (8,2) = null
)
as
begin
             select *
             from Proizvodi as p
             where p.NazivKategorije like @Kategorija + '%' or p.Tezina > @Tezina
end
go
 
exec sp_search @Tezina = 2.2
exec sp_search @Kategorija = 'C'
 
 
 
 
--1 ZADATAK
 
CREATE DATABASE Indeks
GO
USE Indeks
GO
 
CREATE TABLE Narudzba
(
       NarudzbaID INT NOT NULL PRIMARY KEY (NarudzbaID),
       DatumNarudzbe DATE NULL,
       DatumPrijema DATE NULL,
       DatumIsporuke DATE NULL,
       TrosakPrevoza MONEY NULL,
       PunaAdresa NVARCHAR (70) NULL
)
 
CREATE TABLE Dobavljac
(
       DobavljacID INT NOT NULL PRIMARY KEY (DobavljacID),
       NazivDobavljaca nvarchar(40) NOT NULL,
       PunaAdresa nvarchar(60) NULL,
       Drzava nvarchar(15) NULL,
      
)
 
CREATE TABLE Proizvod
(
       NarudzbaID INT NOT NULL CONSTRAINT FK_Proizvod_Narudzba FOREIGN KEY (NarudzbaID) REFERENCES Narudzba (NarudzbaID),
       DobavljacID INT NOT NULL CONSTRAINT FK_Proizvod_Dobavljac FOREIGN KEY (DobavljacID) REFERENCES Dobavljac (DobavljacID),  
       ProizvodID INT NOT NULL,
       NazivProizvoda NVARCHAR (40) NOT NULL,
       Cijena INT NOT NULL,
       Kolicina INT NOT NULL,
       Popust DECIMAL (3,2) NOT NULL,
       Raspolozivost BIT NOT NULL,
       CONSTRAINT PK_Proizvod PRIMARY KEY (NarudzbaID, DobavljacID, ProizvodID)
)
--2 ZADATAK
 
--2a
INSERT INTO Narudzba
SELECT o.OrderID, o.OrderDate, o.RequiredDate, o.ShippedDate,o.Freight, o.ShipAddress + ' '+ ISNULL(o.ShipPostalCode,'0000')+ ' '+o.ShipCity
FROM Northwind.dbo.Orders as o
WHERE YEAR(o.OrderDate)>=1997 AND o.ShippedDate IS NOT NULL
ORDER BY o.Freight
--657
 
--2b
INSERT INTO Dobavljac
SELECT S.SupplierID, S.CompanyName, S.Address + S.PostalCode + S.City, S.Country
FROM Northwind.dbo.Suppliers as S
--29
 
--2c
INSERT INTO Proizvod
SELECT OD.OrderID, P.SupplierID, P.ProductID, P.ProductName, OD.UnitPrice,OD.Quantity,OD.Discount,P.Discontinued
FROM Northwind.dbo.Products as P
inner join Northwind.dbo.[Order Details] as OD
on P.ProductID=OD.ProductID
inner join Northwind.dbo.Orders as O
on O.OrderID=OD.OrderID
WHERE OD.UnitPrice>10 AND OD.Discount>0 AND YEAR(O.OrderDate)>=1997 AND O.ShippedDate IS NOT NULL
--512
 
--3 ZADATAK
--Iz tabele Proizvod dati pregled ukupnog broja ostvarenih narudzbi po dobavljaèu i proizvodu.
 
SELECT P.DobavljacID,P.ProizvodID,COUNT(P.DobavljacID) AS 'Broj narudzbi'
FROM Proizvod AS P
GROUP BY P.DobavljacID,P.ProizvodID
ORDER BY 1
--62
 
--4 ZADATAK
--Iz tabele Proizvod dati pregled ukupnog prometa ostvarenog po dobavljaèu i narudžbi uz uslov da se prikažu samo oni zapisi
--kod kojih je vrijednost prometa manja od 1000 i odobreni popust veæi od 10%. Ukupni promet izraèunati uz uzimanje u obzir i odobrenog popusta.
 
SELECT  P.DobavljacID,P.NarudzbaID,SUM(P.Cijena*P.Kolicina*(1-P.Popust)) AS Promet
FROM Proizvod AS P
WHERE P.Popust>0.1
GROUP BY P.DobavljacID,P.NarudzbaID
HAVING SUM(P.Cijena*P.Kolicina*(1-P.Popust))<1000
 
--5 ZADATAK
--Iz tabele Narudzba dati pregled svih narudzbi kod kojih je broj dana od datuma narudžbe do datuma isporuke manji od 10.
--Pregled æe se sastojati od ID narudžbe, broja dana razlike i kalendarske godine,
--pri èemu je razdvojiti pregled po godinama - 1997 i 1998 (prvo sve 1997, zatim sve 1998).
--Sortirati po broju dana isporuke u opadajuæem redoslijedu.
 
SELECT NarudzbaID, DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) AS BrDanaIsporuke, YEAR (DatumIsporuke) AS Godina
FROM Narudzba
WHERE DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) < 10
ORDER BY 3, 2
--495
 
SELECT N.NarudzbaID, DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke) AS 'Broj dana razlike', '1997' AS 'Godina'
FROM Narudzba AS N
WHERE  DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke)<10 AND YEAR(N.DatumIsporuke)=1997
UNION
SELECT N.NarudzbaID, DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke) AS 'Broj dana razlike', '1998' AS 'Godina'
FROM Narudzba AS N
WHERE  DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke)<10 AND YEAR(N.DatumIsporuke)=1998
ORDER BY 2 DESC
--495
 
 
 
--6 ZADATAK
--Iz tabele Narudzba dati pregled svih narudzbi kod kojih je isporuka izvršena u istom mjesecu.
--Pregled æe se sastojati od ID narudžbe, broja dana razlike, mjeseca narudžbe, mjeseca isporuke i kalendarske godine,
--pri èemu je potrebno razdvojiti pregled po godinama (1997 i 1998 - prvo sve 1997, zatim sve 1998).
--Sortirati po broju dana isporuke u opadajuæem redoslijedu.
 
SELECT N.NarudzbaID, DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke) AS 'Broj dana razlike',
       MONTH(N.DatumNarudzbe) AS 'Mjesec narudzbe',MONTH(N.DatumIsporuke) AS 'Mjesec isporuke','1997' AS 'Godina'
FROM Narudzba AS N
WHERE  MONTH(N.DatumNarudzbe)=MONTH(N.DatumIsporuke) AND YEAR(N.DatumIsporuke)=1997
UNION
SELECT N.NarudzbaID, DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke) AS 'Broj dana razlike',
       MONTH(N.DatumNarudzbe) AS 'Mjesec narudzbe',MONTH(N.DatumIsporuke) AS 'Mjesec isporuke','1998' AS 'Godina'
FROM Narudzba AS N
WHERE  MONTH(N.DatumNarudzbe)=MONTH(N.DatumIsporuke) AND YEAR(N.DatumIsporuke)=1998
ORDER BY 2 DESC
--464
 
SELECT NarudzbaID, DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) AS BrDanaIsporuke, MONTH (DatumIsporuke) AS MjesecNarudzbe,
MONTH (DatumNarudzbe) AS MjesecIsporuke, YEAR (DatumIsporuke) AS Godina
FROM Narudzba
WHERE MONTH (DatumIsporuke) = MONTH (DatumNarudzbe)
ORDER BY 5, 2
 
 
 
 
--7 ZADATAK
--Iz tabele Narudzba dati pregled svih narudžbi koje su isporuèene u Graz ili Köln.
--Pregled æe se sastojati od ID narudžbe i naziva grada. Sortirati po nazivu grada.
 
SELECT N.PunaAdresa, RIGHT(N.PunaAdresa, CHARINDEX(' ',REVERSE(N.PunaAdresa))-1) AS 'Naziv grada'
FROM Narudzba AS N
WHERE RIGHT(N.PunaAdresa, CHARINDEX(' ',REVERSE(N.PunaAdresa))-1) IN('Graz', 'Köln')
ORDER BY 2
 
 
--8 ZADATAK
--Iz tabela Narudzba, Dobavljac i Proizvod kreirati pregled koji æe se sastojati od polja NarudzbaID,
--GodNarudzbe kao godinu iz polja DatumNarudzbe, NazivProizvoda, NazivDobavljaca, Drzava, TrosakPrevoza,
--Ukupno kao ukupna vrijednost narudžbe koja æe se raèunati uz uzimanje u obzir i popusta i postotak koji æe
--davati informaciju o vrijednosti postotka troška prevoza u odnosu na ukupnu vrijenost narudžbe. Uslov je da
--postotak bude veæi od 30% i da je ukupna vrijednost veæa od troška prevoza. Sortirati po vrijednosti postotka u opadajuæem redoslijedu.
 
SELECT N.NarudzbaID,YEAR(N.DatumNarudzbe) AS 'GodNarudzbe', P.NazivProizvoda,D.NazivDobavljaca,D.Drzava,N.TrosakPrevoza,
P.Cijena*P.Kolicina*(1-P.Popust) AS 'Ukupna vrijednost',
LEFT (ROUND (N.TrosakPrevoza / (P.Cijena * P.Kolicina * (1 - P.Popust)) * 100, 2),5) AS Postotak
FROM Proizvod AS P INNER JOIN
     Narudzba AS N
        ON P.NarudzbaID=N.NarudzbaID
       JOIN Dobavljac AS D
       ON D.DobavljacID=P.DobavljacID
WHERE N.TrosakPrevoza / (P.Cijena * P.Kolicina * (1 - P.Popust)) * 100>30 AND P.Cijena*P.Kolicina*(1-p.Popust)>N.TrosakPrevoza
ORDER BY 8 DESC
 
 
--9 ZADATAK
--Iz tabela Narudzba, Dobavljac i Proizvod kreirati pogled koji æe sadržavati ID narudžbe, dan iz datuma prijema,
--raspoloživost, naziv grada iz pune adrese naruèitelja i državu dobavljaèa.
--Uslov je da je datum prijema u 2. ili 3. dekadi mjeseca i da grad naruèitelja Bergamo.
 
CREATE VIEW view_9
AS
SELECT N.NarudzbaID, DAY(N.DatumPrijema) AS 'Dan', P.Raspolozivost,
N.PunaAdresa ,RIGHT(N.PunaAdresa, CHARINDEX(' ',REVERSE(N.PunaAdresa))-1) AS 'Naziv grada', d.Drzava
FROM Proizvod AS P
     INNER JOIN Narudzba AS N
       ON P.NarudzbaID=N.NarudzbaID
       INNER JOIN Dobavljac AS D
       ON D.DobavljacID=P.DobavljacID
--WHERE DAY(N.DatumPrijema) BETWEEN 11 AND 31 AND RIGHT(N.PunaAdresa, CHARINDEX(' ',REVERSE(N.PunaAdresa))-1) = 'Bergamo'
SELECT*
FROM view_9
--7
 
 
--10 ZADATAK
--Iz tabela Proizvod i Dobavljac kreirati proceduru proc1 koja æe sadržavati ID i naziv dobavljaèa i ukupan broj proizvoda
--koji je realizirao dobavljaè. Pokrenuti proceduru za vrijednost ukupno realiziranog broja proizvoda 22 i 14.
 
ALTER PROCEDURE proc1
(
       @DobavljacID int = NULL,
       @NazivDobavljaca nvarchar(40) = NULL,
       @UkBroj int = NULL
)
AS
BEGIN
SELECT P.DobavljacID, D.NazivDobavljaca, COUNT (P.ProizvodID) AS Broj
FROM   Proizvod AS P INNER JOIN Dobavljac AS D
ON           P.DobavljacID = D.DobavljacID
--WHERE      P.DobavljacID = @DobavljacID OR
--           NazivDobavljaca = @NazivDobavljaca OR
--           P.ProizvodID >= 0
GROUP BY P.DobavljacID, D.NazivDobavljaca
HAVING COUNT (P.ProizvodID) = @UkBroj --OR @UkBroj IS NULL
END
 
EXEC proc1  @UkBroj=22
 
 
 
 
--1.
create database DodatniRok
go
use DodatniRok
go
 
drop table Proizvodi
drop table ZaglavljeNarudzbe
drop table DetaljiNarudzbe
 
 
--2.
--a)
create table Proizvodi(
ProizvodID int not null primary key,
Naziv nvarchar(50) not null,
SifraProizvoda nvarchar(50) not null,
Boja nvarchar(15),
NazivKategorije nvarchar(50) not null,
Tezina dec(8,2)
)
--b)
create table ZaglavljeNarudzbe(
NarudzbaID int not null primary key,
DatumNarudzbe datetime not null,
DatumIsporuke datetime,
NazivTeritorije nvarchar(50) not null,
NazivRegije nvarchar(50) not null,
NacinIsporuke nvarchar(50) not null
)
--c)
create table DetaljiNarudzbe(
NarudzbaID int not null constraint FK_DetaljiNarudzbe_ZaglavljeNarudzbe foreign key (NarudzbaID) references ZaglavljeNarudzbe(NarudzbaID),
ProizvodID int not null constraint FK_DetaljiNaruzbe_Proizvodi foreign key (ProizvodID) references Proizvodi(ProizvodID),
Cijena money not null,
Kolicina smallint not null,
Popust money not null,
Constraint PK_DetaljiNarudzbe primary key(NarudzbaID, ProizvodID)
)
 
--3.
--a)
insert into Proizvodi
select P.ProductID, P.Name, P.ProductNumber, ISNULL(P.Color, 'nije naznaceno') as 'Boja', PC.Name, P.Weight
from AdventureWorks2019.Production.Product as P
inner join AdventureWorks2019.Production.ProductSubcategory as SC
on P.ProductSubcategoryID = SC.ProductSubcategoryID
inner join AdventureWorks2019.Production.ProductCategory as PC
on SC.ProductCategoryID = PC.ProductCategoryID
--b)
insert into ZaglavljeNarudzbe
select SOH.SalesOrderID, SOH.OrderDate, SOH.ShipDate, ST.Name, ST.[Group], SM.Name
from AdventureWorks2019.Sales.SalesTerritory as ST
inner join AdventureWorks2019.Sales.SalesOrderHeader as SOH
on ST.TerritoryID = SOH.TerritoryID
inner join AdventureWorks2019.Purchasing.ShipMethod as SM
on SOH.ShipMethodID = SM.ShipMethodID
--c)
insert into DetaljiNarudzbe
select SOD.SalesOrderID, SOD.ProductID, SOD.UnitPrice, SOD.OrderQty, SOD.UnitPriceDiscount
from AdventureWorks2019.Sales.SalesOrderDetail as SOD
 
--4.
--a)
create view v_proizvodi
as
select P.Naziv, P.SifraProizvoda, COUNT(P.ProizvodID) as 'Broj prodanih stavki', SUM(DN.Cijena*DN.Kolicina*(1-DN.Popust)) as 'Ukupna vrijednost sa popustom'
from Proizvodi as P
inner join DetaljiNarudzbe as DN
on P.ProizvodID = DN.ProizvodID
group by P.Naziv, P.SifraProizvoda, (DN.Cijena*DN.Kolicina*(1-DN.Popust))
 select*
from v_proizvodi
order by 4 desc
 
--b)
select COUNT(EDH.BusinessEntityID) as 'Ukupan broj uposlenika', D.Name, DATEDIFF(YEAR, EDH.StartDate, GETDATE()) as 'Radni staz'
from AdventureWorks2019.HumanResources.EmployeeDepartmentHistory as EDH
inner join AdventureWorks2019.HumanResources.Department as D
on EDH.DepartmentID = D.DepartmentID
where DATEDIFF(YEAR, EDH.StartDate, GETDATE()) > 10
group by D.Name, DATEDIFF(YEAR, EDH.StartDate, GETDATE())
order by 1 desc
 
--c)
select SUM(POD.ReceivedQty) as 'Ukupna kolicina primljene robe', SUM(POD.UnitPrice*POD.ReceivedQty) as 'Vrijednost robe',
MONTH(POD.DueDate) as 'Mjesec', YEAR(POD.DueDate) as 'Godina', SM.Name
from AdventureWorks2019.Purchasing.ShipMethod as SM
inner join AdventureWorks2019.Purchasing.PurchaseOrderHeader as POH
on SM.ShipMethodID = POH.ShipMethodID
 inner join AdventureWorks2019.Purchasing.PurchaseOrderDetail as POD
on POH.PurchaseOrderID = POD.PurchaseOrderID
where YEAR(POD.DueDate) = 2012 and POH.Freight between 500 and 2500 and SM.Name like '%CARGO%'
group by MONTH(POD.DueDate), YEAR(POD.DueDate), SM.Name
 
select*
from AdventureWorks2019.Sales.SalesTerritory
 
--d)
select COUNT(SOH.SalesOrderID) 'Ukupan broj narudzbi', YEAR(SOH.OrderDate) as 'Godina narudzbe', ST.Name
from AdventureWorks2019.Sales.SalesOrderHeader as SOH
inner join AdventureWorks2019.Sales.SalesTerritory as ST
on SOH.TerritoryID = ST.TerritoryID
where YEAR(SOH.OrderDate) = 2011 or YEAR(SOH.OrderDate) = 2012 and ST.Name in('United Kingdom', 'France', 'Canada')
group by YEAR(SOH.OrderDate), ST.Name
order by 1 desc
 
select*
from AdventureWorks2019.Sales.SalesTerritory
 
--5.
--a)
create nonclustered index IX_Naziv_Sifra on Proizvodi(
Naziv asc,
SifraProizvoda asc
)
 
--b)
create procedure sp_insert(
@NarudzbaID int = null,
@ProizvodID int = null,
@Cijena money = null,
@Kolicina smallint = null,
@Popust money = null
)
as
begin
insert into DetaljiNarudzbe
values(@NarudzbaID, @ProizvodID, @Cijena, @Kolicina, @Popust)
end
 
select*
from DetaljiNarudzbe
 
exec sp_insert
@NarudzbaID = '43661',
@ProizvodID = '833',
@Cijena = '129.00',
@Kolicina = '1',
@Popust = '50.00'
 
--c)
create procedure sp_search_products(
 
)
 
 
 
-- TABLE
CREATE TABLE demo (ID integer primary key, Name varchar(20), Hint text );
CREATE TABLE Dobavljac (
  DobavljacID INT PRIMARY KEY,
  NazivDobavljaca NVARCHAR(40) NOT NULL,
  PunaAdresa NVARCHAR(60),
  Drzava NVARCHAR(15)
);
CREATE TABLE Narudzba (
  NarudzbaID INT PRIMARY KEY,
  DatumNarudzbe DATE,
  DatumPrijema DATE,
  DatumIsporuke DATE,
  TrosakPrevoza DECIMAL(10,2),
  PunaAdresa NVARCHAR(70)
);
CREATE TABLE Proizvod (
  NarudzbaID INT,
  DobavljacID INT NOT NULL,
  ProizvodID INT NOT NULL,
  NazivProizvoda NVARCHAR(40) NOT NULL,
  Cijena INT NOT NULL,
  Kolicina INT NOT NULL,
  Popust DECIMAL(5,2) NOT NULL,
  Raspolozivost BIT NOT NULL,
  PRIMARY KEY (NarudzbaID, DobavljacID, ProizvodID),
  FOREIGN KEY (NarudzbaID) REFERENCES Narudzba(NarudzbaID),
  FOREIGN KEY (DobavljacID) REFERENCES Dobavljac(DobavljacID)
);
-- INDEX
-- TRIGGER
-- VIEW
 
 
--1.
go
create database BB200001
go
use BB200001
 
--2.
--a)
create table Proizvodi(
ProizvodID int not null primary key,
Naziv nvarchar(50) not null,
SifraProizvoda nvarchar(25) not null,
Boja nvarchar(15),
NazivKategorije nvarchar(50) not null,
Tezina decimal(8,2)
)
 
--b)
create table ZaglavljeNarudzbe(
NarudzbaID int not null primary key,
DatumNarudzbe datetime not null,
DatumIsporuke datetime,
NazivTeritorije nvarchar(50) not null,
NazivRegije nvarchar(50) not null,
NacinIsporuke nvarchar(50) not null
)
 
--c)
create table DetaljiNarudzbe(
NarudzbaID int not null constraint FK_DetaljiNarudzbe_ZaglavljeNarudzbe foreign key (NarudzbaID) references ZaglavljeNarudzbe(NarudzbaID),
ProizvodID int not null constraint FK_DetaljiNarudzbe_Proizvodi foreign key (ProizvodID) references Proizvodi(ProizvodID),
Cijena money not null,
Kolicina smallint not null,
Popust money not null
constraint PK_DetaljiNarudzbe primary key(NarudzbaID, ProizvodID)
)
 
--3.
--a)
insert into Proizvodi
select P.ProductID, P.Name, P.ProductNumber, ISNULL(P.Color, 'nije naznaceno') as 'Boja', PC.Name, P.Weight
from AdventureWorks2019.Production.Product as P
inner join AdventureWorks2019.Production.ProductSubcategory as PS
on P.ProductSubcategoryID = PS.ProductSubcategoryID
inner join AdventureWorks2019.Production.ProductCategory as PC
on PS.ProductCategoryID = PC.ProductCategoryID
 
--b)
insert into ZaglavljeNarudzbe
select SOH.SalesOrderID, SOH.OrderDate, SOH.ShipDate, ST.Name, ST.[Group], SM.Name
from AdventureWorks2019.Sales.SalesTerritory as ST
inner join AdventureWorks2019.Sales.SalesOrderHeader as SOH
on ST.TerritoryID = SOH.TerritoryID
inner join AdventureWorks2019.Purchasing.ShipMethod as SM
on SOH.ShipMethodID = SM.ShipMethodID
 
--c)
insert into DetaljiNarudzbe
select SOD.SalesOrderID, SOD.ProductID, SOD.UnitPrice, SOD.OrderQty, SOD.UnitPriceDiscount
from AdventureWorks2019.Sales.SalesOrderDetail as SOD
 
--4.
--a)
create view v_proizvodi
as
select P.Naziv, P.SifraProizvoda, COUNT(P.ProizvodID) as 'Ukupan broj stavki', SUM(DN.Cijena*DN.Kolicina*(1-DN.Popust)) as 'Ukupna vrijednost'
from Proizvodi as P
inner join DetaljiNarudzbe as DN
on P.ProizvodID = DN.ProizvodID
group by P.Naziv, P.SifraProizvoda
 
select*
from v_proizvodi
order by 4 desc
 
--b)
select COUNT(E.BusinessEntityID) as 'Ukupan broj uposlenika', D.Name, DATEDIFF(YEAR, EDH.StartDate, GETDATE()) as 'Radni staz'
from AdventureWorks2019.HumanResources.Employee as E
inner join AdventureWorks2019.HumanResources.EmployeeDepartmentHistory as EDH
on E.BusinessEntityID = EDH.BusinessEntityID
inner join AdventureWorks2019.HumanResources.Department as D
on EDH.DepartmentID = D.DepartmentID
where DATEDIFF(YEAR, EDH.StartDate, GETDATE()) > 10
group by D.Name, DATEDIFF(YEAR, EDH.StartDate, GETDATE())
order by 1 desc
 
--c)
select MONTH(POD.DueDate) as 'Mjesec', SUM(POD.ReceivedQty) as 'Ukupna količina', SUM(POD.UnitPrice*POD.OrderQty) as 'Ukupna vrijednost'
from AdventureWorks2019.Purchasing.ShipMethod as SM
inner join AdventureWorks2019.Purchasing.PurchaseOrderHeader as POH
on SM.ShipMethodID = POH.ShipMethodID
inner join AdventureWorks2019.Purchasing.PurchaseOrderDetail as POD
on POH.PurchaseOrderID = POD.PurchaseOrderID
where YEAR(POD.DueDate) = 2012 and POH.Freight between 500 and 2500 and SM.Name like '%CARGO%'
group by MONTH(POD.DueDate)
 
--d)
select COUNT(SOH.SalesOrderID) as 'Ukupan broj', P.FirstName as 'Ime uposlenika', ST.Name
from AdventureWorks2019.Sales.SalesTerritory as ST
inner join AdventureWorks2019.Sales.SalesOrderHeader as SOH
on ST.TerritoryID = SOH.TerritoryID
inner join AdventureWorks2019.Person.Person as P
on SOH.SalesPersonID = P.BusinessEntityID
where (YEAR(SOH.OrderDate) = 2011 or YEAR(SOH.OrderDate) = 2012) and ST.Name in('United Kingdom', 'France', 'Canada')
group by P.FirstName, ST.Name
order by 1 desc
 
 
 
go
create database Agregatne
go
create schema Funkcije
 
create table Funkcije.Odjel(
OdjelID smallint not null constraint PK_OdjelID primary key (OdjelID) identity (1,1),
Naziv nvarchar(50) not null,
NazivSektora nvarchar(50) not null,
DatumKreiranja date not null
)
 
insert into Funkcije.Odjel
select D.Name, D.GroupName, LEFT(D.ModifiedDate, 11)
from AdventureWorks2019.HumanResources.Department as D
where D.GroupName like 'Sales and Marketing' or D.GroupName like 'Research and Development'
order by D.GroupName
 
create table Funkcije.AgrOdjel(
NazivSektora nvarchar(50) not null,
UkupnoSektor int
)
 
insert into Funkcije.AgrOdjel
select D.GroupName, COUNT(D.GroupName) as 'Ukupan broj odjela po sektorima'
from AdventureWorks2019.HumanResources.Department as D
group by D.GroupName
 
select YEAR(E.BirthDate) as GodRodj, COUNT(YEAR(E.BirthDate)) BrojPoGodinama,
YEAR(E.HireDate) as GodZap, COUNT(YEAR(E.HireDate)) BrojPoGod
from AdventureWorks2019.HumanResources.Employee as E
group by YEAR(E.BirthDate), YEAR(E.HireDate)
 
SELECT LEFT (BirthDate,4) AS GodRodj,
COUNT (LEFT (BirthDate,4)) BrojRodj,
LEFT (HireDate,4) AS GodZap,
COUNT (LEFT (HireDate,4)) BrojZapos
FROM AdventureWorks2019.HumanResources.Employee as E
GROUP BY LEFT (BirthDate,4), LEFT (HireDate,4)
 
select E.JobTitle, COUNT(E.JobTitle) as 'Ukupan broj'
from AdventureWorks2019.HumanResources.Employee as E
where E.JobTitle like '%manager%'
group by E.JobTitle
 
 
--1.
create database vjezba13_zadaci
use vjezba13_zadaci
 
--2.
--a)
create table Proizvodi(
ProizvodID int not null primary key,
Naziv nvarchar(40) not null,
Cijena money not null,
KolicinaNaSkladistu smallint,
NazivKompanijeDobavljaca nvarchar(40) not null,
Raspolozivost bit not null
)
 
--b)
create table Narudzbe(
NarudzbaID int not null primary key,
DatumNarudzbe date,
DatumPrijema date,
DatumIsporuke date,
Drzava nvarchar(15),
Regija nvarchar(15),
Grad nvarchar(15),
Adresa nvarchar(60)
)
 
--c)
create table StavkeNarudzbe(
NarudzbaID int not null constraint FK_StavkeNarudzbe_Narudzbe foreign key (NarudzbaID) references Narudzbe(NarudzbaID),
ProizvodID int not null constraint FK_StavkeNarudzbe_Proizvodi foreign key (ProizvodID) references Proizvodi(ProizvodID),
Cijena money not null,
Kolicina smallint not null,
Popust real not null
constraint PK_StavkeNarudzbe primary key(NarudzbaID, ProizvodID)
)
 
--3.
--a)
insert into Proizvodi
select P.ProductID, P.ProductName, P.UnitPrice, P.UnitsInStock, S.CompanyName, P.Discontinued
from Northwind.dbo.Products as P
inner join Northwind.dbo.Suppliers as S
on P.SupplierID = S.SupplierID
--77
 
--b)
insert into Narudzbe
select O.OrderID, O.OrderDate, O.RequiredDate, O.ShippedDate, O.ShipCountry, ISNULL(O.ShipRegion, 'nije naznaceno'), O.ShipCity,O.ShipAddress
from Northwind.dbo.Orders as O
--830
 
--c)
insert into StavkeNarudzbe
select OD.OrderID, OD.ProductID, OD.UnitPrice, OD.Quantity, OD.Discount
from Northwind.dbo.[Order Details] as OD
where OD.Quantity > 4
--1985
 
--4
--a)
select*
from Proizvodi as P
where (P.Naziv like 'A%' or P.Naziv like 'C%') and P.Raspolozivost = 0
--9
 
--b)
select N.NarudzbaID, YEAR(N.DatumNarudzbe) as 'Godina narudzbe', SUM(SN.Cijena*SN.Kolicina) as 'Ukupna vrijednost'
from Narudzbe as N
inner join StavkeNarudzbe as SN
on N.NarudzbaID = SN.NarudzbaID
where YEAR(N.DatumNarudzbe) = 1996
group by N.NarudzbaID, YEAR(N.DatumNarudzbe)
having SUM(SN.Cijena*SN.Kolicina) > 500
--104
 
--c)
SELECT ST.Name,round(SUM(SOD.LineTotal),2) 'Ukupni promet'
FROM AdventureWorks2019.Sales.SalesTerritory AS ST
INNER JOIN AdventureWorks2019.Sales.SalesOrderHeader AS SOH
ON ST.TerritoryID=SOH.TerritoryID
INNER JOIN AdventureWorks2019.Sales.SalesOrderDetail AS SOD
ON SOH.SalesOrderID=SOD.SalesOrderID
GROUP BY ST.Name
--10
 
--d)
select SOH.SalesOrderID, COUNT(*) as 'Broj stavki'
from AdventureWorks2019.Sales.SalesOrderHeader as SOH
inner join AdventureWorks2019.Sales.SalesOrderDetail as SOD
on SOH.SalesOrderID = SOD.SalesOrderID
where MONTH(SOH.OrderDate) = 6 and DAY(SOH.OrderDate) between 1 and 10
group by SOH.SalesOrderID
having COUNT(*) > 1
order by 2 desc
--386
 
--e)
select P.ProductID, P.Name, P.ProductNumber,
SUBSTRING(P.ProductNumber, CHARINDEX('-', P.ProductNumber) + 1, LEN(P.ProductNumber)) + '/'
+ CONVERT(nvarchar(50), P.ProductID) as 'Sifra'
from AdventureWorks2019.Production.Product as P
where P.ProductID = 716
 
--5.
--a)
create procedure sp_search_proizvodi(
@Naziv nvarchar(40) = null,
@Dobavljac nvarchar(50) = null
)
as
begin
select*
from Proizvodi as P
where (Naziv like @Naziv + '%' or @Naziv is null) and (NazivKompanijeDobavljaca like @Dobavljac + '%' or @Dobavljac is null)
end
 
exec sp_search_proizvodi
--@Naziv = 'R',
@Dobavljac = 'P'
 
--b)
create procedure sp_insert_stavke(
@NarudzbaID int = null,
@ProizvodID int = null,
@Cijena money = null,
@Kolicina smallint = null,
@Popust money = null
)
as
begin
insert into StavkeNarudzbe
values(@NarudzbaID, @ProizvodID, @Cijena, @Kolicina, @Popust)
end
 
select*
from StavkeNarudzbe
 
exec sp_insert_stavke
@NarudzbaID = '10248',
@ProizvodID = '13',
@Cijena = '15.30',
@Kolicina = '3',
@Popust = '0'
 
--c)
create view pogled_narudzba
as
select SOH.SalesOrderID as 'ID Narudzbe', SOH.OrderDate as 'Datum narudzbe', P.FirstName + ' ' + P.LastName as 'Ime i prezime',
SUM(SOD.UnitPrice*SOD.OrderQty) as 'Ukupna vrijednost'
from AdventureWorks2019.Sales.SalesOrderHeader as SOH
inner join AdventureWorks2019.sales.SalesOrderDetail as SOD
on SOH.SalesOrderID = SOD.SalesOrderID
inner join AdventureWorks2019.Sales.Customer as C
on SOH.CustomerID = C.CustomerID
inner join AdventureWorks2019.Person.Person as P
on C.PersonID = P.BusinessEntityID
group by SOH.SalesOrderID, SOH.OrderDate, P.FirstName, P.LastName
 
select*
from pogled_narudzba
order by 4 desc
 
--d)
create index ix_selectPoNazivuProizvoda
on Proizvodi(Naziv)
 
select Naziv
from Proizvodi
where Naziv like 'B%'
 
--f)
 
 
 
 
--Vježba 13 :: Zadaci
 
--1.   Kroz SQL kod kreirati bazu podataka sa imenom vašeg broja indeksa.
CREATE DATABASE brojIndexa
GO
USE brojIndexa
--2.   U kreiranoj bazi podataka kreirati tabele sa sljedeæom strukturom:
--a)   Proizvodi
--•    ProizvodID, cjelobrojna vrijednost i primarni kljuè
--•    Naziv, 40 UNICODE karaktera (obavezan unos)
--•    Cijena, novèani tip (obavezan unos)
--•    KolièinaNaSkladistu, smallint
--•    NazivKompanijeDobavljaca, 40 UNICODE (obavezan unos)
--•    Raspolozivost, bit (obavezan unos)
CREATE TABLE Proizvodi
(
       ProizvodID INT NOT NULL PRIMARY KEY,
       Naziv NVARCHAR(40) NOT NULL,
       Cijena MONEY NOT NULL,
       KolièinaNaSkladistu SMALLINT,
       NazivKompanijeDobavljaca NVARCHAR(40) NOT NULL,
       Raspolozivost BIT NOT NULL
)
CREATE TABLE Narudzbe
(
       NarudzbaID INT NOT NULL PRIMARY KEY,
       DatumNarudzbe DATE,
       DatumPrijema DATE,
       DatumIsporuke DATE,
       Drzava NVARCHAR(15),
       Regija NVARCHAR(15),
       Grad NVARCHAR(15),
       Adresa NVARCHAR(60)
)
CREATE TABLE StavkeNarudzbe
(
       NarudzbaID INT CONSTRAINT FK_StavkeNarudzbe_Narudzbe FOREIGN KEY REFERENCES Narudzbe(NarudzbaID),
       ProizvodID INT CONSTRAINT FK_StavkeNarudzbe_Proizvodi FOREIGN KEY REFERENCES Proizvodi(ProizvodID),
       Cijena MONEY NOT NULL,
       Kolièina SMALLINT NOT NULL,
       Popust REAL NOT NULL,
       CONSTRAINT PK_StavkeNarudzbe PRIMARY KEY(NarudzbaID,ProizvodID)
)
--**Jedan proizvod se može naæi na više narudžbi, dok jedna narudžba može imati više proizvoda. U okviru jedne narudžbe jedan proizvod se ne može pojaviti više od jedanput.
 
--3.   Iz baze podataka Northwind u svoju bazu podataka prebaciti sljedeæe podatke:
--a)   U tabelu Proizvodi dodati sve proizvode
--•    ProductID -> ProizvodID
--•    ProductName -> Naziv      
--•    UnitPrice -> Cijena
--•    UnitsInStock -> KolicinaNaSkladistu
--•    CompanyName -> NazivKompanijeDobavljaca
--•    Discontinued -> Raspolozivost
INSERT INTO Proizvodi
SELECT P.ProductID,P.ProductName,P.UnitPrice,P.UnitsInStock,S.CompanyName,P.Discontinued
FROM Northwind.dbo.Products AS P
INNER JOIN Northwind.dbo.Suppliers AS S
ON P.SupplierID=S.SupplierID
--b)   U tabelu Narudzbe dodati sve narudžbe, na mjestima gdje nema pohranjenih podataka o regiji zamijeniti vrijednost sa nije naznaceno
--•    OrderID -> NarudzbaID
--•    OrderDate -> DatumNarudzbe
--•    RequiredDate -> DatumPrijema
--•    ShippedDate -> DatumIsporuke
--•    ShipCountry -> Drzava
--•    ShipRegion -> Regija
--•    ShipCity -> Grad
--•    ShipAddress -> Adresa
INSERT INTO Narudzbe
SELECT O.OrderID,O.OrderDate,O.RequiredDate,O.ShippedDate,O.ShipCountry,ISNULL(O.ShipRegion,'nije naznaceno'),O.ShipCity,O.ShipAddress
FROM Northwind.dbo.Orders AS O
--c)   U tabelu StavkeNarudzbe dodati sve stavke narudžbe gdje je kolièina veæa od 4
--•    OrderID -> NarudzbaID
--•    ProductID -> ProizvodID
--•    UnitPrice -> Cijena
--•    Quantity -> Kolièina
--•    Discount -> Popust
INSERT INTO StavkeNarudzbe
SELECT OD.OrderID,OD.ProductID,OD.UnitPrice,OD.Quantity,OD.Quantity
FROM Northwind.dbo.[Order Details] AS OD
WHERE OD.Quantity>4
--4.  
--a)   Prikazati sve proizvode koji poèinju sa slovom a ili c a trenutno nisu raspoloživi.
SELECT*
FROM Proizvodi AS P
WHERE (P.Naziv LIKE 'A%' OR P.Naziv LIKE 'C%') AND P.Raspolozivost=0
--b)   Prikazati narudžbe koje su kreirane 1996 godine i èija je ukupna vrijednost bez popusta veæa od 500KM.
SELECT N.NarudzbaID, SUM(SN.Cijena*SN.Kolièina) 'Ukupna vrijednost'
FROM Narudzbe AS N
INNER JOIN StavkeNarudzbe AS SN
ON N.NarudzbaID=SN.NarudzbaID
WHERE YEAR(N.DatumNarudzbe)=1996
GROUP BY N.NarudzbaID
HAVING SUM(SN.Cijena*SN.Kolièina)>500
select*
from StavkeNarudzbe
--c)   Prikazati ukupni promet (uzimajuæi u obzir i popust) od narudžbi po teritorijama. (AdventureWorks2017)
SELECT ST.Name,round(SUM(SOD.LineTotal),2) 'Ukupni promet'
FROM AdventureWorks2017.Sales.SalesTerritory AS ST
INNER JOIN AdventureWorks2017.Sales.SalesOrderHeader AS SOH
ON ST.TerritoryID=SOH.TerritoryID
INNER JOIN AdventureWorks2017.Sales.SalesOrderDetail AS SOD
ON SOH.SalesOrderID=SOD.SalesOrderID
GROUP BY ST.Name
--d)   Napisati upit koji æe prebrojati stavke narudžbe za svaku narudžbu pojedinaèno. U rezultatima prikazati ID narudžbe i broj stavki, te uzeti u obzir samo one narudžbe èiji je broj stavki veæi od 1, te koje su napravljene izmeðu 1.6. i 10.6. bilo koje godine. (AdventureWorks2017)
SELECT SOH.SalesOrderID,(SELECT COUNT(*)
                                               FROM AdventureWorks2017.Sales.SalesOrderDetail AS SOD
                                               WHERE SOD.SalesOrderID=SOH.SalesOrderID) 'Ukupno stavki'
FROM AdventureWorks2017.Sales.SalesOrderHeader AS SOH
WHERE MONTH(SOH.OrderDate)=6 AND DAY(SOH.OrderDate) BETWEEN 1 AND 10 AND (SELECT COUNT(*)
                                               FROM AdventureWorks2017.Sales.SalesOrderDetail AS SOD
                                               WHERE SOD.SalesOrderID=SOH.SalesOrderID)>1
ORDER BY 2 DESC
 
--ILI
 
SELECT SOH.SalesOrderID, COUNT(*) as BrojStavki
FROM AdventureWorks2017.Sales.SalesOrderHeader AS SOH
       INNER JOIN AdventureWorks2017.Sales.SalesOrderDetail AS SOD
       ON SOH.SalesOrderID = SOD.SalesOrderID
WHERE MONTH(SOH.OrderDate) = 6
AND DAY(SOH.OrderDate) BETWEEN 1 and 10
GROUP BY SOH.SalesOrderID
HAVING COUNT(*) > 1
ORDER BY 2 DESC
--e)   Napisati upit koji æe prikazati sljedeæe podatke o proizvodima: ID proizvoda, naziv proizvoda, šifru proizvoda, te novokreiranu šifru proizvoda. Nova šifra se sastoji od sljedeæih vrijednosti: (AdventureWorks2017)
--•    Svi karakteri nakon prvog znaka - (crtica)
--•    Karakter /
--•    ID proizvoda
--Npr. Za proizvod sa ID-om 716 i šifrom LJ-0192-X, nova šifra æe biti 0192-X/716.
SELECT PP.ProductID, PP.Name, PP.ProductNumber,
SUBSTRING(ProductNumber, CHARINDEX('-', ProductNumber) + 1, LEN(ProductNumber)) + '/' + CONVERT(NVARCHAR(50), PP.ProductID) as Šifra
FROM AdventureWorks2017.Production.Product AS PP
WHERE PP.ProductID=716
 
--5.  
--a)   Kreirati proceduru sp_search_proizvodi kojom æe se u tabeli Proizvodi uraditi pretraga proizvoda prema nazivu prizvoda ili nazivu dobavljaèa. Pretraga treba da radi i prilikom unosa bilo kojeg od slova, ne samo potpune rijeèi. Ukoliko korisnik ne unese ništa od navedenog vratiti sve zapise. Proceduru obavezno pokrenuti.
GO
CREATE PROCEDURE proc_search_proizvodi
(
@Naziv NVARCHAR(40)=NULL,
@Dobavljac NVARCHAR(50)=NULL
)
AS
BEGIN
SELECT * FROM Proizvodi as P
WHERE (Naziv LIKE @Naziv+'%' OR @Naziv IS NULL) AND (NazivKompanijeDobavljaca LIKE @Dobavljac+'%' OR @Dobavljac IS NULL)
END
 
EXEC proc_search_proizvodi @Naziv='C'
--b)   Kreirati proceduru sp_insert_stavkeNarudzbe koje æe vršiti insert nove stavke narudžbe u tabelu stavkeNarudzbe. Proceduru obavezno pokrenuti.
GO
CREATE PROCEDURE sp_insert_stavkeNarudzbe (
@NarudzbaID INT,
@ProizvodID INT,
@Cijena MONEY,
@Kolicina SMALLINT,
@Popust MONEY
)
AS
BEGIN
       INSERT INTO StavkeNarudzbe VALUES (@NarudzbaID, @ProizvodID, @Cijena, @Kolicina, @Popust)
END
GO
EXEC sp_insert_stavkeNarudzbe 10248, 1, 2, 2, 0.02
 
SELECT*
FROM StavkeNarudzbe
WHERE NarudzbaID=10248
 
--c)   Kreirati view koji prikazuje sljedeæe kolone: ID narudžbe, datum narudžbe, spojeno ime i prezime kupca i ukupnu vrijednost narudžbe bez popusta. Podatke sortirati prema ukupnoj vrijednosti u opadajuæem redoslijedu. (AdventureWorks2017)
GO
CREATE VIEW view_5c AS
SELECT SOH.SalesOrderID 'ID narudžbe', SOH.OrderDate 'Datum narudžbe',PP.FirstName + ' '+ PP.LastName AS 'Ime i prezime',
SUM(SOD.UnitPrice*SOD.OrderQty) AS 'Vrijednost'
FROM AdventureWorks2017.Sales.SalesOrderHeader AS SOH
       INNER JOIN AdventureWorks2017.Sales.SalesOrderDetail AS SOD
       ON SOH.SalesOrderID = SOD.SalesOrderID
       INNER JOIN AdventureWorks2017.Sales.Customer AS C
       ON SOH.CustomerID=C.CustomerID
       INNER JOIN AdventureWorks2017.Person.Person AS PP
       ON PP.BusinessEntityID=C.PersonID
GROUP BY SOH.SalesOrderID , SOH.OrderDate ,PP.FirstName , PP.LastName
GO
 
SELECT*
FROM view_5c
ORDER BY Vrijednost DESC
--d)   Kreirati okidaè kojim æe se onemoguæiti brisanje zapisa iz tabele StavkeNarudzbe. Korisnicima je potrebno ispisati poruku Arhivske zapise nije moguæe izbrisati.
GO
CREATE TRIGGER t_instead_delete
ON StavkeNarudzbe
INSTEAD OF DELETE
AS
BEGIN
       SELECT 'Arhivske zapise nije moguæe izbrisati'
END
DELETE
FROM StavkeNarudzbe
--e)   Kreirati index kojim æe se ubrzati pretraga po nazivu proizvoda.
CREATE INDEX ix_selectByProductName
ON Proizvodi(Naziv)
 
SELECT Naziv
FROM Proizvodi
WHERE Naziv LIKE 'A%'
--f)   U tabeli StavkeNarudzbe kreirati polje ModifiedDate u kojem æe se nakon kreiranja okidaèa za izmjenu podataka spremati datum modifikacije podataka za konkretan red na kojem je izvršena modifikacija.
ALTER TABLE StavkeNarudzbe
ADD ModifiedDate DATE
GO
CREATE OR ALTER TRIGGER t_after_update
ON StavkeNarudzbe
AFTER UPDATE
AS
BEGIN
       UPDATE StavkeNarudzbe
       SET ModifiedDate=GETDATE()
       WHERE NarudzbaID IN (SELECT DISTINCT NarudzbaID FROM Inserted) AND ProizvodID IN (SELECT DISTINCT ProizvodID FROM Inserted)
END
 
UPDATE StavkeNarudzbe
SET Cijena=1
WHERE NarudzbaID=10248 AND ProizvodID=1
 
SELECT*
FROM StavkeNarudzbe
 
--ALTER TABLE StavkeNarudzbe
--DROP COLUMN ModifiedDate
 
 
 
--1.
go
create database vjezba_ispitni
go
use vjezba_ispitni
 
--2.
--a)
create table Narudzba(
NarudzbaID int not null primary key,
DatumNarudzbe date,
DatumPrijema date,
DatumIsporuke date,
TrosakPrevoza money,
PunaAdresa nvarchar(70)
)
--b)
create table Dobavljac(
DobavljacID int not null primary key,
NazivDobavljaca nvarchar(40) not null,
PunaAdresa nvarchar(60),
Drzava nvarchar(15)
)
--c)
create table Proizvod(
NarudzbaID int not null constraint FK_Proizvod_Naruzba foreign key (NarudzbaID) references Narudzba(NarudzbaID),
DobavljacID int not null constraint FK_Proizvod_Dobavljac foreign key (DobavljacID) references Dobavljac(DobavljacID),
ProizvodID int not null,
NazivProizvoda nvarchar(40) not null,
Cijena int not null,
Kolicina int not null,
Popust decimal(3,2) not null,
Raspolozivost bit not null,
constraint PK_Proizvod primary key (NarudzbaID, DobavljacID, ProizvodID)
)
 
--2.
--a)
insert into Narudzba
select O.OrderID, O.OrderDate, O.RequiredDate, O.ShippedDate, O.Freight, O.ShipAddress + ' ' + isnull(O.ShipPostalCode, '00000') + ' ' + O.ShipCity as 'Puna adresa'
from Northwind.dbo.Orders as O
where YEAR(O.OrderDate) >= 1997 and O.ShippedDate is not null
order by O.Freight
--b)
insert into Dobavljac
select S.SupplierID, S.CompanyName, S.Address + ' ' + S.PostalCode + ' ' + S.City as 'Puna adresa', S.Country
from Northwind.dbo.Suppliers as S
--c)
insert into Proizvod
select OD.OrderID, P.SupplierID, P.ProductID, P.ProductName, OD.UnitPrice, OD.Quantity, OD.Discount, P.Discontinued
from Northwind.dbo.Products as P
inner join Northwind.dbo.[Order Details] as OD
on P.ProductID = OD.ProductID
inner join Northwind.dbo.Orders as O
on OD.OrderID = O.OrderID
where OD.UnitPrice > 10 and OD.Discount > 0 and YEAR(O.OrderDate) >= 1997 and O.ShippedDate is not null
 
--3.
select count(P.NarudzbaID) as 'Broj narudzbi', P.DobavljacID, P.ProizvodID
from Proizvod as P
group by P.DobavljacID, P.ProizvodID
order by 1
 
--4.
select P.DobavljacID, P.NarudzbaID, SUM(P.Cijena*P.Kolicina*(1-P.Popust)) as 'Ukupni promet'
from Proizvod as P
where P.Popust > 0.1
group by P.DobavljacID, P.NarudzbaID
having SUM(P.Cijena*P.Kolicina*(1-P.Popust)) < 1000
 
--5.
select N.NarudzbaID, DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) as 'Broj dana razlike', YEAR(N.DatumIsporuke) as 'Kalendarska godina'
from Narudzba as N
where DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) < 10
order by 3, 2
 
select N.NarudzbaID, DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) as 'Broj dana razlike', '1997' as 'Kalendarska godina'
from Narudzba as N
where DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) < 10 and YEAR(N.DatumIsporuke) = 1997
union
select N.NarudzbaID, DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) as 'Broj dana razlike', '1998' as 'Kalendarska godina'
from Narudzba as N
where DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) < 10 and YEAR(N.DatumIsporuke) = 1998
order by 2 desc
 
--6.
select N.NarudzbaID, DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) as 'Broj dana razlike', MONTH(N.DatumNarudzbe) as 'Mjesec narudzbe', MONTH(N.DatumIsporuke) as 'Mjesec isporuke', YEAR(N.DatumIsporuke) as 'Kalendarska godina'
from Narudzba as N
where MONTH(N.DatumNarudzbe) = MONTH(N.DatumIsporuke)
order by 5, 2
 
select N.NarudzbaID, DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) as 'Broj dana razlike', MONTH(N.DatumNarudzbe) as 'Mjesec narudzbe', MONTH(N.DatumIsporuke) as 'Mjesec isporuke', '1997' as 'Kalendarska godina'
from Narudzba as N
where MONTH(N.DatumNarudzbe) = MONTH(N.DatumIsporuke) and YEAR(N.DatumIsporuke) = 1997
union
select N.NarudzbaID, DATEDIFF(DAY, N.DatumNarudzbe, N.DatumIsporuke) as 'Broj dana razlike', MONTH(N.DatumNarudzbe) as 'Mjesec narudzbe', MONTH(N.DatumIsporuke) as 'Mjesec isporuke', '1998' as 'Kalendarska godina'
from Narudzba as N
where MONTH(N.DatumNarudzbe) = MONTH(N.DatumIsporuke) and YEAR(N.DatumIsporuke) = 1998
order by 2 desc
 
--7.
select N.NarudzbaID, RIGHT(N.PunaAdresa, CHARINDEX(' ', REVERSE(N.PunaAdresa))-1) as 'Naziv grada'
from Narudzba as N
where RIGHT(N.PunaAdresa, CHARINDEX(' ', REVERSE(N.PunaAdresa))-1) in('Graz', 'Köln')
order by 2
 
--8.
select N.NarudzbaID, YEAR(N.DatumNarudzbe) as 'Godina narudzbe', P.NazivProizvoda, D.NazivDobavljaca, D.Drzava, N.TrosakPrevoza, (P.Cijena*P.Kolicina*(1-P.Popust)) as 'Ukupno',
LEFT(ROUND(N.TrosakPrevoza/(P.Cijena*P.Kolicina*(1-P.Popust))*100, 2), 5) as 'Postotak'
from Narudzba as N
inner join Proizvod as P
on N.NarudzbaID = P.NarudzbaID
inner join Dobavljac as D
on P.DobavljacID = D.DobavljacID
where N.TrosakPrevoza/(P.Cijena*P.Kolicina*(1-P.Popust))* 100 > 30 and (P.Cijena*P.Kolicina*(1-P.Popust)) > N.TrosakPrevoza
order by 8 desc
 
--9.
create view pogled1
as
select N.NarudzbaID, DAY(N.DatumPrijema) as 'Dan prijema', P.Raspolozivost, RIGHT(N.PunaAdresa, CHARINDEX(' ', REVERSE(N.PunaAdresa))-1) as 'Naziv grada', D.Drzava
from Narudzba as N
inner join Proizvod as P
on N.NarudzbaID = P.NarudzbaID
inner join Dobavljac as D
on P.DobavljacID = D.DobavljacID
where DAY(N.DatumPrijema) between 11 and 31 and RIGHT(N.PunaAdresa, CHARINDEX(' ', REVERSE(N.PunaAdresa))-1) = 'Bergamo'
 
select*
from pogled1
 
--10.
create procedure proc1(
@DobavljacID int = null,
@NazivDobavljaca nvarchar(40) = null,
@UkupanBrojPr int = null
)
as
begin
select P.DobavljacID, D.NazivDobavljaca, COUNT(P.ProizvodID) as 'UkupanBrojPr'
from Proizvod as P
inner join Dobavljac as D
on P.DobavljacID = D.DobavljacID
where P.DobavljacID = @DobavljacID
or D.NazivDobavljaca = @NazivDobavljaca
or P.ProizvodID >= 0
group by P.DobavljacID, D.NazivDobavljaca
having COUNT(P.ProizvodID) = @UkupanBrojPr or @UkupanBrojPr is null
end
 
exec proc1 @UkupanBrojPr = 22
exec proc1 @UkupanBrojPr = 14
 
 
 
go
create database treci_online_test
go
use treci_online_test
 
--Zadatak 1.
select a.au_fname as 'Ime', a.au_lname as 'Prezime', COUNT(ta.title_id) as 'Ukupan broj naslova'
from pubs.dbo.authors as a
inner join pubs.dbo.titleauthor as ta
on a.au_id = ta.au_id
inner join pubs.dbo.titles as t
on ta.title_id = t.title_id
group by a.au_fname, a.au_lname
having COUNT(ta.title_id) >= 2
order by 3 desc
--6
 
--Zadatak 2.
create view view_2
as
select t.title as 'Naziv naslova', t.type as 'Naziv(tip)', t.price as 'Cijena', s.qty as 'Kolicina',
YEAR(s.ord_date) as 'Godina prodaje', MONTH(s.ord_date) as 'Mjesec prodaje', st.stor_name as 'Naziv prodavnice'
from pubs.dbo.titles as t
inner join pubs.dbo.sales as s
on t.title_id = s.title_id
inner join pubs.dbo.stores as st
on s.stor_id = st.stor_id
where YEAR(s.ord_date) = 1994 and t.price between 10 and 20
 
select*
from view_2
 
--Zadatak 3.
create procedure proc_3(
@au_id varchar(11),
@au_lname varchar(40),
@au_fname varchar(20),
@phone char(12),
@address varchar(40),
@city varchar(20),
@state char(2),
@zip char(5),
@contract bit
)
as
begin
insert into pubs.dbo.authors
values (@au_id, @au_lname, @au_fname, @phone, @address, @city, @state, @zip, @contract)
end
 
select*
from pubs.dbo.authors
exec proc_3
@au_id = '222-55-6851',
@au_lname = 'Gološ',
@au_fname = 'Kemal',
@phone = '062 967-6080',
@address = 'Blagaj bb',
@city = 'Mostar',
@state = 'MO',
@zip = '88201',
@contract = '1'
 
--Zadatak 4.
create procedure proc_4(
@au_id varchar(11)
)
as
begin
delete from pubs.dbo.authors
where au_id = @au_id
end
 
exec proc_4
@au_id = '222-55-6851'
 
select*
from pubs.dbo.authors
where au_id = '222-55-6851'
 
 
 
 
--Vježba 13 :: Zadaci
 
--1.   Kroz SQL kod kreirati bazu podataka sa imenom vašeg broja indeksa.
CREATE DATABASE brojIndexa
GO
USE brojIndexa
--2.   U kreiranoj bazi podataka kreirati tabele sa sljedeæom strukturom:
--a)   Proizvodi
--•    ProizvodID, cjelobrojna vrijednost i primarni kljuè
--•    Naziv, 40 UNICODE karaktera (obavezan unos)
--•    Cijena, novèani tip (obavezan unos)
--•    KolièinaNaSkladistu, smallint
--•    NazivKompanijeDobavljaca, 40 UNICODE (obavezan unos)
--•    Raspolozivost, bit (obavezan unos)
CREATE TABLE Proizvodi
(
       ProizvodID INT NOT NULL PRIMARY KEY,
       Naziv NVARCHAR(40) NOT NULL,
       Cijena MONEY NOT NULL,
       KolièinaNaSkladistu SMALLINT,
       NazivKompanijeDobavljaca NVARCHAR(40) NOT NULL,
       Raspolozivost BIT NOT NULL
)
CREATE TABLE Narudzbe
(
       NarudzbaID INT NOT NULL PRIMARY KEY,
       DatumNarudzbe DATE,
       DatumPrijema DATE,
       DatumIsporuke DATE,
       Drzava NVARCHAR(15),
       Regija NVARCHAR(15),
       Grad NVARCHAR(15),
       Adresa NVARCHAR(60)
)
CREATE TABLE StavkeNarudzbe
(
       NarudzbaID INT CONSTRAINT FK_StavkeNarudzbe_Narudzbe FOREIGN KEY REFERENCES Narudzbe(NarudzbaID),
       ProizvodID INT CONSTRAINT FK_StavkeNarudzbe_Proizvodi FOREIGN KEY REFERENCES Proizvodi(ProizvodID),
       Cijena MONEY NOT NULL,
       Kolièina SMALLINT NOT NULL,
       Popust REAL NOT NULL,
       CONSTRAINT PK_StavkeNarudzbe PRIMARY KEY(NarudzbaID,ProizvodID)
)
--**Jedan proizvod se može naæi na više narudžbi, dok jedna narudžba može imati više proizvoda. U okviru jedne narudžbe jedan proizvod se ne može pojaviti više od jedanput.
 
--3.   Iz baze podataka Northwind u svoju bazu podataka prebaciti sljedeæe podatke:
--a)   U tabelu Proizvodi dodati sve proizvode
--•    ProductID -> ProizvodID
--•    ProductName -> Naziv      
--•    UnitPrice -> Cijena
--•    UnitsInStock -> KolicinaNaSkladistu
--•    CompanyName -> NazivKompanijeDobavljaca
--•    Discontinued -> Raspolozivost
INSERT INTO Proizvodi
SELECT P.ProductID,P.ProductName,P.UnitPrice,P.UnitsInStock,S.CompanyName,P.Discontinued
FROM Northwind.dbo.Products AS P
INNER JOIN Northwind.dbo.Suppliers AS S
ON P.SupplierID=S.SupplierID
--b)   U tabelu Narudzbe dodati sve narudžbe, na mjestima gdje nema pohranjenih podataka o regiji zamijeniti vrijednost sa nije naznaceno
--•    OrderID -> NarudzbaID
--•    OrderDate -> DatumNarudzbe
--•    RequiredDate -> DatumPrijema
--•    ShippedDate -> DatumIsporuke
--•    ShipCountry -> Drzava
--•    ShipRegion -> Regija
--•    ShipCity -> Grad
--•    ShipAddress -> Adresa
INSERT INTO Narudzbe
SELECT O.OrderID,O.OrderDate,O.RequiredDate,O.ShippedDate,O.ShipCountry,ISNULL(O.ShipRegion,'nije naznaceno'),O.ShipCity,O.ShipAddress
FROM Northwind.dbo.Orders AS O
--c)   U tabelu StavkeNarudzbe dodati sve stavke narudžbe gdje je kolièina veæa od 4
--•    OrderID -> NarudzbaID
--•    ProductID -> ProizvodID
--•    UnitPrice -> Cijena
--•    Quantity -> Kolièina
--•    Discount -> Popust
INSERT INTO StavkeNarudzbe
SELECT OD.OrderID,OD.ProductID,OD.UnitPrice,OD.Quantity,OD.Quantity
FROM Northwind.dbo.[Order Details] AS OD
WHERE OD.Quantity>4
--4.  
--a)   Prikazati sve proizvode koji poèinju sa slovom a ili c a trenutno nisu raspoloživi.
SELECT*
FROM Proizvodi AS P
WHERE (P.Naziv LIKE 'A%' OR P.Naziv LIKE 'C%') AND P.Raspolozivost=0
--b)   Prikazati narudžbe koje su kreirane 1996 godine i èija je ukupna vrijednost bez popusta veæa od 500KM.
SELECT N.NarudzbaID, SUM(SN.Cijena*SN.Kolièina) 'Ukupna vrijednost'
FROM Narudzbe AS N
INNER JOIN StavkeNarudzbe AS SN
ON N.NarudzbaID=SN.NarudzbaID
WHERE YEAR(N.DatumNarudzbe)=1996
GROUP BY N.NarudzbaID
HAVING SUM(SN.Cijena*SN.Kolièina)>500
select*
from StavkeNarudzbe
--c)   Prikazati ukupni promet (uzimajuæi u obzir i popust) od narudžbi po teritorijama. (AdventureWorks2017)
SELECT ST.Name,round(SUM(SOD.LineTotal),2) 'Ukupni promet'
FROM AdventureWorks2017.Sales.SalesTerritory AS ST
INNER JOIN AdventureWorks2017.Sales.SalesOrderHeader AS SOH
ON ST.TerritoryID=SOH.TerritoryID
INNER JOIN AdventureWorks2017.Sales.SalesOrderDetail AS SOD
ON SOH.SalesOrderID=SOD.SalesOrderID
GROUP BY ST.Name
--d)   Napisati upit koji æe prebrojati stavke narudžbe za svaku narudžbu pojedinaèno. U rezultatima prikazati ID narudžbe i broj stavki, te uzeti u obzir samo one narudžbe èiji je broj stavki veæi od 1, te koje su napravljene izmeðu 1.6. i 10.6. bilo koje godine. (AdventureWorks2017)
SELECT SOH.SalesOrderID,(SELECT COUNT(*)
                                               FROM AdventureWorks2017.Sales.SalesOrderDetail AS SOD
                                               WHERE SOD.SalesOrderID=SOH.SalesOrderID) 'Ukupno stavki'
FROM AdventureWorks2017.Sales.SalesOrderHeader AS SOH
WHERE MONTH(SOH.OrderDate)=6 AND DAY(SOH.OrderDate) BETWEEN 1 AND 10 AND (SELECT COUNT(*)
                                               FROM AdventureWorks2017.Sales.SalesOrderDetail AS SOD
                                               WHERE SOD.SalesOrderID=SOH.SalesOrderID)>1
ORDER BY 2 DESC
 
--ILI
 
SELECT SOH.SalesOrderID, COUNT(*) as BrojStavki
FROM AdventureWorks2017.Sales.SalesOrderHeader AS SOH
       INNER JOIN AdventureWorks2017.Sales.SalesOrderDetail AS SOD
       ON SOH.SalesOrderID = SOD.SalesOrderID
WHERE MONTH(SOH.OrderDate) = 6
AND DAY(SOH.OrderDate) BETWEEN 1 and 10
GROUP BY SOH.SalesOrderID
HAVING COUNT(*) > 1
ORDER BY 2 DESC
--e)   Napisati upit koji æe prikazati sljedeæe podatke o proizvodima: ID proizvoda, naziv proizvoda, šifru proizvoda, te novokreiranu šifru proizvoda. Nova šifra se sastoji od sljedeæih vrijednosti: (AdventureWorks2017)
--•    Svi karakteri nakon prvog znaka - (crtica)
--•    Karakter /
--•    ID proizvoda
--Npr. Za proizvod sa ID-om 716 i šifrom LJ-0192-X, nova šifra æe biti 0192-X/716.
SELECT PP.ProductID, PP.Name, PP.ProductNumber,
SUBSTRING(ProductNumber, CHARINDEX('-', ProductNumber) + 1, LEN(ProductNumber)) + '/' + CONVERT(NVARCHAR(50), PP.ProductID) as Šifra
FROM AdventureWorks2017.Production.Product AS PP
WHERE PP.ProductID=716
 
--5.  
--a)   Kreirati proceduru sp_search_proizvodi kojom æe se u tabeli Proizvodi uraditi pretraga proizvoda prema nazivu prizvoda ili nazivu dobavljaèa. Pretraga treba da radi i prilikom unosa bilo kojeg od slova, ne samo potpune rijeèi. Ukoliko korisnik ne unese ništa od navedenog vratiti sve zapise. Proceduru obavezno pokrenuti.
GO
CREATE PROCEDURE proc_search_proizvodi
(
@Naziv NVARCHAR(40)=NULL,
@Dobavljac NVARCHAR(50)=NULL
)
AS
BEGIN
SELECT * FROM Proizvodi as P
WHERE (Naziv LIKE @Naziv+'%' OR @Naziv IS NULL) AND (NazivKompanijeDobavljaca LIKE @Dobavljac+'%' OR @Dobavljac IS NULL)
END
 
EXEC proc_search_proizvodi @Naziv='C'
--b)   Kreirati proceduru sp_insert_stavkeNarudzbe koje æe vršiti insert nove stavke narudžbe u tabelu stavkeNarudzbe. Proceduru obavezno pokrenuti.
GO
CREATE PROCEDURE sp_insert_stavkeNarudzbe (
@NarudzbaID INT,
@ProizvodID INT,
@Cijena MONEY,
@Kolicina SMALLINT,
@Popust MONEY
)
AS
BEGIN
       INSERT INTO StavkeNarudzbe VALUES (@NarudzbaID, @ProizvodID, @Cijena, @Kolicina, @Popust)
END
GO
EXEC sp_insert_stavkeNarudzbe 10248, 1, 2, 2, 0.02
 
SELECT*
FROM StavkeNarudzbe
WHERE NarudzbaID=10248
 
--c)   Kreirati view koji prikazuje sljedeæe kolone: ID narudžbe, datum narudžbe, spojeno ime i prezime kupca i ukupnu vrijednost narudžbe bez popusta. Podatke sortirati prema ukupnoj vrijednosti u opadajuæem redoslijedu. (AdventureWorks2017)
GO
CREATE VIEW view_5c AS
SELECT SOH.SalesOrderID 'ID narudžbe', SOH.OrderDate 'Datum narudžbe',PP.FirstName + ' '+ PP.LastName AS 'Ime i prezime',
SUM(SOD.UnitPrice*SOD.OrderQty) AS 'Vrijednost'
FROM AdventureWorks2017.Sales.SalesOrderHeader AS SOH
       INNER JOIN AdventureWorks2017.Sales.SalesOrderDetail AS SOD
       ON SOH.SalesOrderID = SOD.SalesOrderID
       INNER JOIN AdventureWorks2017.Sales.Customer AS C
       ON SOH.CustomerID=C.CustomerID
       INNER JOIN AdventureWorks2017.Person.Person AS PP
       ON PP.BusinessEntityID=C.PersonID
GROUP BY SOH.SalesOrderID , SOH.OrderDate ,PP.FirstName , PP.LastName
GO
 
SELECT*
FROM view_5c
ORDER BY Vrijednost DESC
--d)   Kreirati okidaè kojim æe se onemoguæiti brisanje zapisa iz tabele StavkeNarudzbe. Korisnicima je potrebno ispisati poruku Arhivske zapise nije moguæe izbrisati.
GO
CREATE TRIGGER t_instead_delete
ON StavkeNarudzbe
INSTEAD OF DELETE
AS
BEGIN
       SELECT 'Arhivske zapise nije moguæe izbrisati'
END
DELETE
FROM StavkeNarudzbe
--e)   Kreirati index kojim æe se ubrzati pretraga po nazivu proizvoda.
CREATE INDEX ix_selectByProductName
ON Proizvodi(Naziv)
 
SELECT Naziv
FROM Proizvodi
WHERE Naziv LIKE 'A%'
--f)   U tabeli StavkeNarudzbe kreirati polje ModifiedDate u kojem æe se nakon kreiranja okidaèa za izmjenu podataka spremati datum modifikacije podataka za konkretan red na kojem je izvršena modifikacija.
ALTER TABLE StavkeNarudzbe
ADD ModifiedDate DATE
GO
CREATE OR ALTER TRIGGER t_after_update
ON StavkeNarudzbe
AFTER UPDATE
AS
BEGIN
       UPDATE StavkeNarudzbe
       SET ModifiedDate=GETDATE()
       WHERE NarudzbaID IN (SELECT DISTINCT NarudzbaID FROM Inserted) AND ProizvodID IN (SELECT DISTINCT ProizvodID FROM Inserted)
END
 
UPDATE StavkeNarudzbe
SET Cijena=1
WHERE NarudzbaID=10248 AND ProizvodID=1
 
SELECT*
FROM StavkeNarudzbe
 
--ALTER TABLE StavkeNarudzbe
--DROP COLUMN ModifiedDate
 
 
 
 
create database vježba
go
 
use vježba
 
create table Proizvodi(
ProizvodID int not null primary key,
Naziv nvarchar(40) not null,
Cijena money not null,
Koli?inaNaSkladištu smallint,
NazivKompanijeDobavlja?a nvarchar(40) not null,
Raspoloživost bit not null
)
 
create table Narudžbe(
NarudzbaID int not null primary key,
DatumNarudzbe date,
DatumPrijema date,
DatumIpsoruke date,
Drzava nvarchar(15),
Regija nvarchar(15),
Grad nvarchar(15),
Adresa nvarchar(60)
)
 
create table StavkeNarudzbe(
NarudzbaID int constraint FK_StavkeNarudzbe_Narudzbe foreign key references Narudžbe(NarudzbaID),
ProizvodID int constraint FK_StavkeNarudzbe_Proizvodi foreign key references Proizvodi(ProizvodID),
Cijena money not null,
Koli?ina smallint not null,
Popust real not null,
constraint PK_StavkeNarudzbe primary key(NarudzbaID, ProizvodID)
)
 
insert into Proizvodi
select P.ProductID, P.ProductName, P.UnitPrice, P.UnitsInStock, S.CompanyName, P.Discontinued
from Northwind.dbo.Products as P
inner join Northwind.dbo.Suppliers as S
on P.SupplierID = S.SupplierID
 
insert into Narudžbe
select O.OrderID, O.OrderDate, O.RequiredDate, O.ShippedDate, O.ShipCountry, O.ShipRegion, O.ShipCity, O.ShipAddress
from Northwind.dbo.Orders as O
 
insert into StavkeNarudzbe
select OD.OrderID, OD.ProductID, OD.UnitPrice, OD.Quantity, OD.Discount
from Northwind.dbo.[Order Details] as OD
 
select*
from Proizvodi as P
where (P.Naziv like 'A%' or P.Naziv like 'C%') and P.Raspoloživost = 0
 
select N.NarudzbaID, SUM(SN.Cijena*SN.Koli?ina) 'Ukupna vrijednost'
from Narudžbe as N
inner join StavkeNarudzbe as SN
on N.NarudzbaID = SN.NarudzbaID
where YEAR(N.DatumNarudzbe) = 1996
group by N.NarudzbaID
having SUM(SN.Cijena*SN.Koli?ina) > 500
 
select*
from StavkeNarudzbe
 
 
 
 
 
 
 
 
SELECT
    o.OrderID,
    SUM(od.Quantity) AS UkupanBrojKomada,
    ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)), 2) AS UkupnaCijenaBezPopusta,
    ROUND(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount) * (1 + o.ShippingCosts)), 2) AS UkupnaCijenaSPopustom
FROM
    Orders o
    INNER JOIN OrderDetails od ON o.OrderID = od.OrderID
    INNER JOIN Customers c ON o.CustomerID = c.CustomerID
WHERE
    o.ShippedDate IS NOT NULL
    AND o.ShippedDate - o.OrderDate <= 7
    AND c.City IN ('Madrid', 'Munich', 'Seattle')
GROUP BY
    o.OrderID
ORDER BY   UkupanBrojKomada DESC;

create database jacuseubit
use jacuseubit

create table izdavac 
(
	izdavacID nvarchar(4) primary key not null,
	izdavac_naziv nvarchar(40),
	izdavac_grad_okrug nvarchar(40)
)

create table uposlenik
(
	uposlenikID nvarchar(9) primary key not null,
	ime_prezime nvarchar(50),
	datum_zaposl datetime,
	opis_posla nvarchar(50),
	izdavacID nvarchar(4)
	constraint FK_uposlenik_izdavac foreign key (izdavacID) references izdavac(izdavacID)
)
create table publikacija
(
	pubID nvarchar(10) primary key not null,
	naziv_pub nvarchar(80),
	cijena money,
	datum_izd datetime,
	izdavacID nvarchar(4),
	constraint  FK_publikacija_izdavac foreign key (izdavacID) references izdavac(izdavacID)
)

INSERT INTO izdavac
select p.pub_id,p.pub_name,ISNULL(p.city,'xx')+'_'+ISNULL(p.state,'xx')
from pubs.dbo.publishers as p

INSERT INTO uposlenik
select e.emp_id,e.fname+ ' ' + e.lname as 'ime i prezime',e.hire_date,j.job_desc,e.pub_id
from pubs.dbo.employee as e join pubs.dbo.jobs as j on e.job_id=j.job_id

insert into publikacija
select t.title_id,t.title,t.price,t.pubdate,t.pub_id
from pubs.dbo.titles as t

go
create view view_god_zaposl
as
select u.ime_prezime,year(u.datum_zaposl) as 'godina_zaposlenja',DATEDIFF(year,u.datum_zaposl,GETDATE()) as 'godina_staza',u.opis_posla,i.izdavac_naziv
from uposlenik as u join izdavac as i on u.izdavacID=i.izdavacID
where DATEDIFF(year,u.datum_zaposl,GETDATE())>25

drop view view_god_zaposl

select*from view_god_zaposl
order by 3 desc

select opis_posla,COUNT(godina_staza) as 'pobrojano'
from view_god_zaposl
group by opis_posla 

select godina_staza,COUNT(godina_staza)
from view_god_zaposl 
group by godina_staza
order by 2 desc 

select* from view_god_zaposl
order by 3 desc 

go
create procedure proc_god_zaposl
(
	@ime_prezime nvarchar(50)=null,
	@godina_zaposlenja int=null,
	@godina_staza int=null,
	@opis_posla nvarchar(50)=null,
	@izdavac_naziv nvarchar(40)=null
)
as 
begin
select ime_prezime,godina_zaposlenja,godina_staza,opis_posla,izdavac_naziv

from view_god_zaposl 
where  ime_prezime=@ime_prezime OR
	   godina_zaposlenja=@godina_zaposlenja OR
	   godina_staza=@godina_staza OR 
	   opis_posla=@opis_posla OR
	   izdavac_naziv=@izdavac_naziv
end;

exec proc_god_zaposl @godina_staza=26
exec proc_god_zaposl @opis_posla='designer'
exec proc_god_zaposl @godina_zaposlenja=1992

select u.ime_prezime,count(p.pubID) as 'ukupno pub'
from publikacija as p join izdavac as i on p.izdavacID=i.izdavacID join uposlenik as u on i.izdavacID=p.izdavacID
where year(p.datum_izd)=1991 and u.opis_posla LIKE ('%Ed%')
GROUP BY U.ime_prezime
ORDER BY 2 DESC


go
create view view_izdavaci
as
select distinct p.izdavacID,i.izdavac_naziv
from publikacija as p join izdavac as i  on p.izdavacID=i.izdavacID

select*from view_izdavaci

select i.izdavacID,i.izdavac_naziv,sum(p.cijena) as 'ukupno'
from publikacija as p join izdavac as i on p.izdavacID=i.izdavacID
group by i.izdavacID,i.izdavac_naziv

go
create procedure proc_uposlenik
(
	@uposlenikID nvarchar(9)=null,
	@ime_prezime nvarchar(50)=null,
	@godina_zaposlenja int=null,
	@opis_posla nvarchar(50)=null,
	@izdavacID nvarchar(4)=null
)
as
begin
select uposlenikID,ime_prezime,year(datum_zaposl) as 'godina_zaposlenja',opis_posla,izdavacID
from uposlenik
where opis_posla LIKE ('%Man%') and uposlenikID=uposlenikID OR ime_prezime=@ime_prezime OR year(datum_zaposl)=@godina_zaposlenja or 
	  opis_posla=@opis_posla or izdavacID=@izdavacID
end;

exec proc_uposlenik @godina_zaposlenja=1992
exec proc_uposlenik @opis_posla='Marketing Manager'
exec proc_uposlenik @izdavacID=9999
drop procedure proc_uposlenik

drop table izdavac
drop table publikacija
drop table uposlenik

use master
drop database jacuseubit





create database PI_5_7_2019
use PI_5_7_2019


create table uposlenik
(
	uposlenikID int constraint PK_uposlenikID primary key (uposlenikID) identity (1,1),
	prezime_ime nvarchar (30) not null, 
	datum_rodj date,
	datum_zaposl date,
	kucni_tel nvarchar (25),
	teritorija nvarchar (50)
)

insert into uposlenik
SELECT	E.LastName + ' ' + E.FirstName, E.BirthDate, E.HireDate, E.HomePhone, T.TerritoryDescription
FROM	Northwind.dbo.EmployeeTerritories as ET INNER JOIN Northwind.dbo.Employees as E
ON		ET.EmployeeID = E.EmployeeID 
		INNER JOIN Northwind.dbo.Territories AS T
		ON ET.TerritoryID = T.TerritoryID
--rj: 49


create table isporucitelj
(
	isporuciteljID int constraint PK_isporuciteljID primary key (isporuciteljID),
	ispor_naziv nvarchar (40),
	ispor_tel nvarchar (24)
)

insert into isporucitelj
select * from Northwind.dbo.Shippers
--rJ: 3

create table isporuka
(
	isporukaID int constraint PK_narudzbaID primary key (narudzbaID),
	kupac_naziv nvarchar (40) not null, 
	kupac_br_tel nvarchar (25),
	prevoz money,
	isporuciteljID int,
	uposlenikID int,
	constraint FK_isporucitelj foreign key (isporuciteljID) references isporucitelj (isporuciteljID),
	constraint FK_uposlenik foreign key (uposlenikID) references uposlenik (uposlenikID)
)

insert into isporuka
SELECT	O.OrderID, C.CompanyName, C.Phone, O.Freight, O.ShipVia, O.EmployeeID
FROM	Northwind.dbo.Customers AS C INNER JOIN Northwind.dbo.Orders AS O
ON		C.CustomerID = O.CustomerID
--rj: 830

--------------------------------------------------------------------
--3
--------------------------------------------------------------------
select isporuciteljID, sum (prevoz) as ukupno
from narudzba
where isporuciteljID = 3
group by isporuciteljID

se
--------------------------------------------------------------------
--4
--------------------------------------------------------------------
/*a Kreirati pogled sljedeće strukture: */
create view view_uposlenici
as 
SELECT	prezime_ime, year (datum_rodj) as godina, count (teritorija) broj_po_teritoriji
FROM	uposlenik
where year (datum_rodj) > 1950
group by prezime_ime, year (datum_rodj)

select *
from view_uposlenici
order by 2

/*b Kreirati proceduru koja će imati istu strukturu kao i pogled pod 3.a, a zatim pokrenuti proceduru  za sljedeće vrijednosti parametara:
1. godina = 1963
2. broj_po_teritoriji = 7*/
create procedure proc_uposlenici
(
	@prezime_ime nvarchar (40) = null,
	@godina int = null,
	@broj_po_teritoriji int = null
)
as
begin
select * 
from view_uposlenici
where	prezime_ime = @prezime_ime or
		godina = @godina or
		broj_po_teritoriji = @broj_po_teritoriji
end

exec proc_uposlenici @godina = 1963
--rj: 2
/*
prezime_ime                    godina      broj_po_teritoriji
------------------------------ ----------- ------------------
Leverling Janet                1963        4
Suyama Michael                 1963        5
*/

exec proc_uposlenici @broj_po_teritoriji = 7
--rj: 3
/*
prezime_ime                    godina      broj_po_teritoriji
------------------------------ ----------- ------------------
Fuller Andrew                  1952        7
Buchanan Steven                1955        7
Dodsworth Anne                 1966        7
*/


--------------------------------------------------------------------
--5
--------------------------------------------------------------------
/*Dati pregled ukupno ostvarenog prihoda kojeg su ostvarili isporučitelji. Pregled treba da sadrži naziv isporučitelja i ukupno ostvareni prihod po osnovu prevoza. Sortirati po visini ostvarenog prihoda u opadajućem redoslijedu.*/
select I.ispor_naziv, sum (N.prevoz) as suma_prevoza
from narudzba as N inner join isporucitelj as I
on N.isporuciteljID = I.isporuciteljID
group by I.ispor_naziv
order by 2 desc
--rj: 3
/*
ispor_naziv                              suma_prevoza
---------------------------------------- ---------------------
United Package                           28244.85
Federal Shipping                         20512.51
Speedy Express                           16185.33
*/

--------------------------------------------------------------------
--6
--------------------------------------------------------------------
create nonclustered index IX_tel on isporucitelj
(
	ispor_tel asc
)


--------------------------------------------------------------------
--7
--------------------------------------------------------------------
/*Koristeći tabele iz vlastite baze podataka kreirati pogled koji će imati sljedeću strukturu: prezime i ime uposlenika, naziv kupca, broj telefona kupca i prevoz. U pogledu trebaju biti smješteni oni zapisi kod kojih se predbroj (broj smješten između zagrada) broja telefona kupca sastoji od isključivo dvije cifre (nije dozvoljen bilo kakav  drugi znak osim cifre). Obavezno provjeriti sadržaj kreiranog pogleda. Potrebno je da svaki uposlenik pojavljuje samo jedanput.*/
create view view_uposlenik_kupac
as 
select	u.prezime_ime, n.kupac_naziv, n.kupac_br_tel, n.prevoz
from	narudzba as n inner join uposlenik as u
on		n.uposlenikID = u.uposlenikID
where	left( n.kupac_br_tel ,4) like '([0-9][0-9])'

select *
from view_uposlenik_kupac
order by 1
--rj: 120


--------------------------------------------------------------------
--8
--------------------------------------------------------------------
/*Kreirati proceduru koja će koristiti podatke iz prethodno kreiranog pogleda, a imat će sljedeću strukturu: prezime i ime, prevoz, suma prevoza, uz uslov da se procedurom daje suma samo onih zapisa kod kojih je vrijednost prevoza veća od 10. Pokrenuti proceduru  za sljedeće vrijednosti parametara:
1. prezime_ime = Fuller Andrew
2. prezime_ime = Davolio Nancy*/
create procedure proc_suma_prevoza
(
	@prezime_ime nvarchar (40) = null,
	@suma_prevoza decimal (8,2) = null
)
as
begin
select	prezime_ime, sum (prevoz) as suma_prevoza
from	view_uposlenik_kupac
where	prevoz > 10 and
		prezime_ime = @prezime_ime
group by prezime_ime
end

exec proc_suma_prevoza @prezime_ime= 'Fuller Andrew'
--rj: 5054.15

exec proc_suma_prevoza @prezime_ime= 'Davolio Nancy'
--rj: 1182.68

--------------------------------------------------------------------
--9
--------------------------------------------------------------------
/*a) Kreirati pogled koji će imati sljedeću strukturu: prezime_ime, mjesec, pri čemu je u mjesec potrebno smjestiti redni broj mjeseca u kojem je uposlenik zaposlen, uz uslov da se uposlenik zaposlio u prvoj polovini kalendarske godine. Obavezno provjeriti sadržaj kreiranog pogleda. Potrebno je da svaki uposlenik pojavljuje samo jedanput.*/
create view view_mjeseci
as
select distinct prezime_ime, month(datum_zaposl) as mjesec
from uposlenik
where month (datum_zaposl) in (1,2,3,4,5,6)

select * 
from view_mjeseci
order by 2
--rj: 5
/*
prezime_ime                    mjesec
------------------------------ -----------
King Robert                    1
Callahan Laura                 3
Leverling Janet                4
Davolio Nancy                  5
Peacock Margaret               5
*/

/*b Iz pogleda kreiranog u zadatku 5.a dati pregled broja zaposlenika po mjesecima, tj. koliko se uposlenika zaposlilo u svakom od mjeseci navedenog perioda u godini.*/
select mjesec, count (mjesec) as uk_broj
from view_mjeseci
group by mjesec
--rj: 4
/*
mjesec		uk_broj
1           1
3           1
4           1
5           2
*/


--------------------------------------------------------------------
--10
--------------------------------------------------------------------
drop table uposlenik
drop table isporucitelj
drop table narudzba
drop database PI_5_7_2019


--1.
/*
a) Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
create database PI_2019_9_I
use PI_2019_9_I

--b) Kreiranje tabela. Prilikom kreiranja tabela voditi računa o spojnim poljima između tabela.
/*
I. Kreirati tabelu TipProizv koja se sastoji od polja:
	- potkatID - cjelobrojna varijabla, primarni ključ
	- katID - cjelobrojna varijabla, obavezan unos
	- kat_naziv - 50 unicode karaktera, obavezan unos
	- potkat_naziv - 50 unicode karaktera, obavezan unos
*/
create table TipProizv
(
	potkatID int constraint PK_TipProizv primary key (potkatID),
	katID int not null,
	kat_naziv nvarchar(50) not null,
	potkat_naziv nvarchar(50)
)
/*
II. Kreirati tabelu proizvod koja se sastoji od polja:
	- proizvodID - cjelobrojna varijabla, primarni ključ
	- naziv - 50 UNICODE karaktera, obavezan unos
	- boja - 15 UNICODE karaktera
	- tezina - decimalni broj  decimal(8, 2),
	- dana_za_proiz - cjelobrojna varijabla, obavezan unos
	- klasa - 2 unicode karaktera 
	- potkat_ID cjelobrojna varijabla, obavezan unos
*/
create table proizvod
(
	proizvodID int constraint PK_proizvod Primary key (proizvodID),
	naziv nvarchar(50) not null,
	boja nvarchar(15),
	tezina decimal(8, 2),
	dana_za_proiz int not null,
	klasa nvarchar (2),
	potkatID int not null
	constraint FK_proizvod_TipProiz foreign key (potkatID) references TipProizv (potkatID)
)

/*
III. Kreirati tabelu nalog koja se sastoji od polja:
	- nalogID - cjelobrojna varijabla, primarni ključ
	- proizvodID - cjelobrojna varijabla, obavezan unos
	- naruc_kol - cjelobrojna varijabla, obavezan unos
	- stanje_kol - cjelobrojna varijabla, obavezan unos
	- dtm_zaduz - datumska varijabla samo za unos datuma (bez vremena)
	- oznaka_greske - 50 unicode karaktera, obavezan unos
*/

create table nalog
(
	nalogID int constraint PK_nalogID primary key (nalogID),
	proizvodID int not null,
	naruc_kol int not null,
	stanje_kol int not null,
	dtm_zaduz date,
	oznaka_greske nvarchar(50) not null,
	constraint FK_nalog_proizvod foreign key (proizvodID) references proizvod (proizvodID)
)
--15 bodova


-----------------------------------------------------------------------------------------------
--2. Importovanje podataka
/*
a) U tabelu TipProizv importovati podatke iz tabela ProductSubcategory i ProductCategory baze AdventureWorks2014 koje se nalaze u šemi Production na sljedeći način:
	- ProductSubcategoryID -> potkatID 
	- ProductCategoryID -> katID 
	- Name -> kat_naziv
	- Name -> potkat_naziv
Voditi računa o pripadnosti polja tabelama iz kojih se importuju podaci.
*/

INSERT INTO TipProizv
SELECT	PS.ProductSubcategoryID, PC.ProductCategoryID, PC.Name, PS.Name
FROM	AdventureWorks2014.Production.ProductCategory AS PC INNER JOIN AdventureWorks2014.Production.ProductSubcategory AS PS
ON		PC.ProductCategoryID = PS.ProductCategoryID
--37

/*
b) U tabelu proizvod importovati podatke iz tabele Product baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
	- ProductID -> proizvodID
	- Name -> naziv
	- Color -> boja 
	- Weight -> tezina 
	- DaysToManufacture -> dana_za_proiz 
	- Class -> klasa 
	- ProductSubcategoryID -> potkatID
uz uslov da je ProductSubcategoryID sadrži vrijednost.
*/
INSERT INTO proizvod
SELECT	P.ProductID, P.Name, P.Color, P.Weight, P.DaysToManufacture, P.Class, P.ProductSubcategoryID
FROM	AdventureWorks2014.Production.Product AS P
where	P.ProductSubcategoryID is not null ------------ ne moze biti not null 
--295

/*
c) U tabelu nalog importovati podatke iz tabela WorkOrder i ScrapReason baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
	- WorkOrderID -> nalogID 
	- ProductID -> proizvodID 
	- OrderQty -> naruc_kol 
	- StockedQty -> stanje_kol 
	- DueDate -> dtm_zaduz 
	- Name -> oznaka_greske
uz uslov da je ProductID veći ili jednak 680. 
*/
INSERT INTO nalog
SELECT	WO.WorkOrderID, WO.ProductID, WO.OrderQty, WO.StockedQty, WO.DueDate, SR.Name
FROM	AdventureWorks2014.Production.WorkOrder as WO INNER JOIN AdventureWorks2014.Production.ScrapReason as SR
ON		SR.ScrapReasonID = WO.ScrapReasonID
where	WO.ProductID >=680 
--332
-- 15 bodova


-----------------------------------------------------------------------------------------------
--3.
/*
Iz tabele nalog dati pregled koji će se sastojati od polja:
	- godina - godina zaduženja proizvoda
	- uk_broj_po_god - ukupan broj zapisa po godinama
uz uslov da je proizvod zadužen u prvom polugodištu bilo koje godine.
Primjer za uk_broj: U tabeli se nalazi 5 zapisa kod kojih je datum zaduženja iz prvog polugodišta 2015. godine
*/
select	year (dtm_zaduz) as godina, count (dtm_zaduz) as uk_broj_po_god
from	nalog
where	MONTH (dtm_zaduz) < 7
group by year (dtm_zaduz)
--4
/*
2011	2
2012	49
2013	72
2014	51
*/
--5 bodova

-----------------------------------------------------------------------------------------------
--4.
/*
Iz tabele nalog kreirati pogled view_razlika koji će se sastojati od polja:
	- razlika_stanja - razlika između naručene količine i količine na stanju
	- uk_broj_po_razlici - ukupan broj zapisa po vrijednosti razlike, npr. u tabeli se nalazi 5 zapisa kod kojih je razlika 10
uz uslov da je proizvod zadužen u 10. mjesecu bilo koje godine prije 2013.
Obavezno napisati naredbu za pregled sadržaja pogleda.
*/
create view view_razlika
as
select	naruc_kol - stanje_kol as razlika_stanja, count (naruc_kol - stanje_kol) as uk_broj_po_razlici
from	nalog
where	MONTH (dtm_zaduz) = 10 and year (dtm_zaduz) < 2013 
group by (naruc_kol - stanje_kol)

select * from view_razlika
--6
/*
1	8
2	7
3	1
10	1
30	1
32	1
*/
--12 bodova

-----------------------------------------------------------------------------------------------
/*
5. Koristeći tabelu proizvod kreirati proceduru proc_proizvod kojom će se definirati sljedeći ulazni parametri:
- proizvodID
- boja
- tezina
- dana_za_proiz
Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koje polje bez unijetog parametra).

Proceduru pokrenuti za sljedeće vrijednosti parametara:
1. @boja = Black
2. @dana_za_proiz = 1
*/

CREATE PROCEDURE proc_proizvod
(
	@proizvodID int = null,
	@boja nvarchar(15) = null,
	@tezina decimal(8, 2) = null,
	@dana_za_proiz int = null
)
AS
BEGIN
select	proizvodID, naziv, boja, tezina, dana_za_proiz
from	PI_2019_9_I.dbo.proizvod
where	proizvodID = @proizvodID or
		boja = @boja or
		tezina = @tezina or
		dana_za_proiz = @dana_za_proiz
END

exec proc_proizvod @boja = 'Black'
--89

exec proc_proizvod @dana_za_proiz = 1
--127
--8 bodova


-----------------------------------------------------------------------------------------------
/*
6. Kreirati pregled koji će sadržavati polja:
	- potkatID
	- suma_tez u kojem će se nalaziti suma težina
Uslov je da naziv proizvoda počinje slovima HL, da se ne preuzimaju zapisi u kojima se nalaze vrijednosti u kolonama boja i tezina, te da je proizvod zaduzen u 2011. ili 2012. godini.
*/
select	P.potkatID, sum (tezina) as suma_tez
from	proizvod as P inner join nalog as N
on		P.proizvodID = N.proizvodID
where	P.naziv like 'HL%' and P.boja is not null and P.tezina is not null and year (dtm_zaduz) in (2011,2012)
group by P.potkatID
--10 bodova
--3
/*
17	5270.00
12	27.56
14	6.52
*/



-----------------------------------------------------------------------------------------------
/*
7. 
Kreirati pogled view_potkat_boja koji će se sastojati od polja:
	- potkatID
	- boja
	- uk_broj_po_oznaka_greske kojim će se prebrojati ukupan broj pojedinog naziva greške
Napisati naredbu za pregled sadržaja pogleda pri čemu će se izostaviti svi zapisi u kojima nije unijeta vrijednost za boju i uk_broj_po_oznaka_greske je neparan broj.
*/
create view view_potkat_boja
as
select	P.potkatID, P.boja, count (oznaka_greske) as uk_broj_po_oznaka_greske
from	proizvod as P inner join nalog as N
on		P.proizvodID = N.proizvodID
group by P.potkatID, P.boja
--21
 
select *
from view_potkat_boja
where boja is not null and right (uk_broj_po_oznaka_greske,1) in (0,2,4,6,8)
--7
--10 bodova


-----------------------------------------------------------------------------------------------
/*
8. Kreirati pregled koji će sadržavati polja:
- naziv potkategorije
- sr_vr_tez - srednja vrijednost težine zaokružena na 2 decimalna mjesta (treća i ostale decimale su 0)
pri čemu se ne prikazuju zapisi u kojima ne postoji srednja vrijednost.
*/
SELECT	TP.potkat_naziv, round (avg (P.tezina),2) as sr_vr_tez
FROM	proizvod AS P INNER JOIN TipProizv AS TP
ON		P.potkatID = TP.potkatID
group by TP.potkat_naziv
HAVING	AVG (P.tezina) is not null
--12
/*
Bottom Brackets		187.000000
Brakes				317.000000
Cranksets			603.330000
Derailleurs			151.500000
Mountain Bikes		25.060000
Mountain Frames		2.840000
Pedals				187.330000
Road Bikes			17.450000
Road Frames			2.310000
Touring Bikes		27.680000
Touring Frames		3.080000
Wheels				890.000000
*/
--10 bodova


-----------------------------------------------------------------------------------------------
/*
9. 
Kreirati pogled kojim će se dati prikaz ID naloga, ID proizvoda, broja godina razlike u odnosu na aktivnu godinu, oznaku boje koju će predstavljati prvo slovo naziva (npr. Purple -> P), klase i naziva potkategorije. Izraz za izračunavanje broja godina razlike treba biti općeg karaktera. Uslov je da naziv potkategorije sadrži riječ Bikes, te da boja nije crna. Obavezno napisati kod za pregled sadržaja pogleda.
*/
--a
create view view_bikes
as
SELECT	nalog.nalogID, proizvod.proizvodID, datediff (year,nalog.dtm_zaduz,getdate()) as razl_godina, left (proizvod.boja,1) as ozn_boje, proizvod.klasa, TipProizv.potkat_naziv
FROM	nalog INNER JOIN proizvod 
ON		nalog.proizvodID = proizvod.proizvodID 
		INNER JOIN TipProizv 
		ON proizvod.potkatID = TipProizv.potkatID
where	TipProizv.potkat_naziv like '%Bikes%' and proizvod.boja not like 'Black'

select * from view_bikes
--59
--15 bodova


------------------------------------------------
--1
/*
a) Kreirati bazu podataka pod vlastitim brojem indeksa.
*/
create database PI_BP_2019_9_12
use PI_BP_2019_9_12

--------------------------

/*Prilikom kreiranja tabela voditi računa o međusobnom odnosu između tabela.
b) Kreirati tabelu radnik koja će imati sljedeću strukturu:
	- radnikID, cjelobrojna varijabla, primarni ključ
	- drzavaID, 15 unicode karaktera
	- loginID, 256 unicode karaktera
	- sati_god_odmora, cjelobrojna varijabla
	- sati_bolovanja, cjelobrojna varijabla
*/
create table radnik
(
	radnikID int constraint PK_radnikID primary key (radnikID),
	drzavaID nvarchar (15),
	loginID nvarchar (256),
	sati_god_odmora int,
	sati_bolovanja int
)

/*
c) Kreirati tabelu kupovina koja će imati sljedeću strukturu:
	- kupovinaID, cjelobrojna varijabla, primarni ključ
	- status, cjelobrojna varijabla
	- radnikID, cjelobrojna varijabla
	- br_racuna, 15 unicode karaktera
	- naziv_dobavljaca, 50 unicode karaktera
	- kred_rejting, cjelobrojna varijabla
*/
create table kupovina
(
	kupovinaID int constraint PK_kupovinaID primary key (kupovinaID),
	status int,
	radnikID int not null,
	br_racuna nvarchar (15),
	naziv_dobavljaca nvarchar (50),
	kred_rejting int,
	constraint FK_kupovina_radnik foreign key (radnikID) references radnik (radnikID)
)

/*
c) Kreirati tabelu prodaja koja će imati sljedeću strukturu:
	- prodavacID, cjelobrojna varijabla, primarni ključ
	- prod_kvota, novčana varijabla
	- bonus, novčana varijabla
	- proslogod_prodaja, novčana varijabla
	- naziv_terit, 50 unicode karaktera
*/

create table prodaja
(
	prodavacID int constraint PK_prodaja primary key (prodavacID),
	prod_kvota money,
	bonus money,
	proslogod_prodaja money,
	naziv_terit nvarchar (50),
	constraint FK_prodaja_radnik foreign key (prodavacID) references radnik (radnikID)
)
--10 bodova




--------------------------------------------
--2. Import podataka
/*
a) Iz tabele humanresources.employee baze AdventureWorks2014 u tabelu radnik importovati podatke po sljedećem pravilu:
	- BusinessEntityID -> radnikID
	- NationalIDNumber -> drzavaID
	- LoginID -> loginID
	- VacationHours -> sati_god_odmora
	- SickLeaveHours -> sati_bolovanja
*/
insert into radnik
SELECT	E.BusinessEntityID, E.NationalIDNumber, E.LoginID, E.VacationHours, E.SickLeaveHours
FROM	AdventureWorks2014.HumanResources.Employee as E
--rj: 290

/*
b) Iz tabela purchasing.purchaseorderheader i purchasing.vendor baze AdventureWorks2014 u tabelu kupovina importovati podatke po sljedećem pravilu:
	- PurchaseOrderID -> kupovinaID
	- Status -> status
	- EmployeeID -> radnikID
	- AccountNumber -> br_racuna
	- Name -> naziv_dobavljaca
	- CreditRating -> kred_rejting
*/
insert into kupovina
SELECT	POH.PurchaseOrderID, POH.Status, POH.EmployeeID, V.AccountNumber, V.Name, V.CreditRating
FROM	AdventureWorks2014.Purchasing.PurchaseOrderHeader as POH INNER JOIN AdventureWorks2014.Purchasing.Vendor as V
ON		POH.VendorID = V.BusinessEntityID
--rj: 4012

/*
c) Iz tabela sales.salesperson i sales.salesterritory baze AdventureWorks2014 u tabelu prodaja importovati podatke po sljedećem pravilu:
	- BusinessEntityID -> prodavacID
	- SalesQuota -> prod_kvota
	- Bonus -> bonus
	- SalesLastYear -> proslogod_prodaja
	- Name -> naziv_terit
	- CreditRating -> kred_rejting
*/
insert into prodaja
SELECT	SP.BusinessEntityID, SP.SalesQuota, SP.Bonus, SP.SalesLastYear, ST.Name
FROM	AdventureWorks2014.Sales.SalesPerson as SP INNER JOIN AdventureWorks2014.Sales.SalesTerritory as ST
ON		SP.TerritoryID = ST.TerritoryID
--rj: 14
--10 bodova




------------------------------------------
/*
3.
a) Iz tabela radnik i kupovina kreirati pogled view_bicikl koji će imati sljedeću strukturu: 
	- kupovinaID,
	- naziv dobavljača,
	- kreditni rejting
Uslov je da u pogledu budu samo oni zapisi u kojima se prema nazivu dobavljača zaključuje da se bavi prodajom bicikla.
 Obavezno napisati kod kojim će se dati prikaz sadržaja pogleda sortiran po ID kupovine.
b) Koristeći prethodno kreirani pogled prebrojati broj obavljenih kupovina prema kreditnom rejtingu. Pregled treba da sadrži oznaku kreditnog rejtinga i ukupan broj obavljenih kupovina.*/
--a
CREATE VIEW view_bicikl
as
SELECT	K.kupovinaID, K.naziv_dobavljaca, K.kred_rejting
FROM	radnik as R INNER JOIN kupovina as K 
ON		R.radnikID = K.radnikID
where	K.naziv_dobavljaca like '%Bi%'

select * 
from view_bicikl
order by 1
--rj: 1474

--b
select kred_rejting, count (kred_rejting) as ukupan_broj
from view_bicikl
group by kred_rejting
order by 1
--rj: 3
/*
1	1273
3	151
5	50
*/
--10 bodova




-----------------------------------------------
/*
4.
Kreirati proceduru koja će imati istu strukturu kao pogled kreiran u prethodnom zadatku. Voditi računa o tipovima varijabli u proceduri. Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti). Uslov je da se procedurom obuhvate oni zapisi iz pogleda kod kojih je kreditni rejting veći od 1, te da se izvrši sortiranje po kreditnom rejtingu. Pokrenuti proceduru za kreditni rejting 3 i 5.*/
CREATE PROCEDURE sp_view_bicikl
(
	@kupovinaID int = null, 
	@naziv_dobavljaca nvarchar (50) = null,
	@kred_rejting int = null
)
AS
BEGIN
	SELECT kupovinaID, naziv_dobavljaca, kred_rejting 
	FROM view_bicikl
	WHERE	kred_rejting > 1 AND 
			(kupovinaID = @kupovinaID OR
			naziv_dobavljaca = @naziv_dobavljaca OR
			kred_rejting = @kred_rejting)
	ORDER BY 3
END

EXEC sp_view_bicikl @kred_rejting = 3
--rj: 151

EXEC sp_view_bicikl @kred_rejting = 5
--rj: 50
--10 bodova




-----------------------------------------------
/*
5.
a) U tabeli radnik kreirati neklasterirani indeks nad kolonom drzavaID. Uključiti kolone sati_god_odmora i sati_bolovanja. 
b) Izvršiti testiranje kreiranog indeksa. 
c) Obrisati prethodno kreirani indeks.
*/
CREATE NONCLUSTERED INDEX IX_ukupno_sati ON radnik
(
		drzavaID ASC
)
INCLUDE (sati_god_odmora, sati_bolovanja)

SELECT * FROM radnik
WHERE drzavaID < 50000000 And sati_god_odmora > 80 and sati_bolovanja > 40
--rj: 3
/*
53	9659517	adventure-works\diane0	87	63
210	20244403	adventure-works\belinda0	83	61
230	28414965	adventure-works\stuart1	88	64
*/

drop index IX_ukupno_sati on radnik
--5 bodova
	



-----------------------------------------------
/*
6.
a) Dati pregled kojim će se prebrojati zapisi u kojima je broj sati bolovanja veći od broja sati godišnjeg odmora, uz uslov da je ta razlika veća od 10. Pregled treba da sadrži razliku sati i ukupan broj. Sortirati prema razlici sati. 
b) Dati pregled svih zapisa kojim će se prebrojati broj država po prodajnim kvotama.
*/
--a
SELECT	(sati_bolovanja - sati_god_odmora) as razlika_sati, count (sati_bolovanja - sati_god_odmora) as ukupan_broj
FROM	radnik
where	(sati_bolovanja - sati_god_odmora) > 10
group by (sati_bolovanja - sati_god_odmora)
order by 1 
--rj: 12

--b
SELECT	prodaja.prod_kvota, count (radnik.drzavaID)
FROM	radnik INNER JOIN
		prodaja ON radnik.radnikID = prodaja.prodavacID
group by prodaja.prod_kvota
--rj: 2
/*
250000.00	11
300000.00	3
*/
--10 bodova




-------------------------------------------
/*
7.
a) Kreirati pogled dobavljaci_radnici koji će se sastojati od kolona naziv dobavljača i ukupan broj radnika. Ukupan broj je podatak kojim se prebrojava broj radnika s kojima je dobavljač poslovao. Obavezno napisati kod kojim će se izvršiti pregled sadržaja pogleda sortiran po ukupnom broju.
b) Kreirati pregled kojim će se izvršiti prebrojavanje po ukupnom broju prebrojanih radnika.
c) Kreirati proceduru kojom će se iz pogleda kreiranog pod a) preuzeti zapisi u kojima je ukupan broj manji od 50. Voditi računa o tipovima podataka. Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti). Pokrenuti proceduru za vrijednosti ukupan broj = 1, 2 i 50.
*/
--a
create view dobavljaci_radnici
as
SELECT	naziv_dobavljaca, count (radnikID) as ukupan_broj
FROM	kupovina
GROUP BY naziv_dobavljaca

select *
from dobavljaci_radnici
order by 1
--rj: 86

--b
select ukupan_broj, count (ukupan_broj)
from dobavljaci_radnici
group by ukupan_broj
order by 1
--5
/*
1	4
2	2
4	1
50	29
51	50
*/

--c
CREATE PROCEDURE sp_dobavljaci_radnici 
(
	@naziv_dobavljaca nvarchar (50) = null,
	@ukupan_broj int = null
) 
as
begin
	select naziv_dobavljaca, ukupan_broj
	from dobavljaci_radnici
	WHERE ukupan_broj < 51 and
		(naziv_dobavljaca = @naziv_dobavljaca or
		ukupan_broj = @ukupan_broj)
END

exec sp_dobavljaci_radnici @ukupan_broj = 4
--rj: 1
--15 bodova

---------------------------------------
/*
8.
a) Iz tabela kupovina i radnik kreirati pogled view_sifra_transakc koja će se sastojati od sljedećih kolona: 
	- naziv dobavljača,
	- ID države (odnosi se na radnika),
	- sifra_transakc
Podaci u koloni sifra_transakc će se formirati spajanjem karaktera koji se dobiju kada se iz kolone loginID tabele radnik ukloni dio 'adventure-works\' i posljednja 4 karaktera iz kolone br_racuna tabele kupovina, između kojih je potrebno umetnuti donju crtu (_). 
Obavezno napisati kod za pregled sadržaja pogleda.
b) Iz prethodno kreiranog pogleda prebrojati sve zapise u kojima su i drzavaID i šifra transkacije parni brojevi .*/
*/
create view view_sifra_transakc
as
select	K.naziv_dobavljaca, R.drzavaID, substring (R.loginID, 17, 15) + '_' +right (K.br_racuna, 4) as sifra_transakc
FROM	kupovina as K INNER JOIN radnik as R
ON		K.radnikID = R.radnikID

select * 
from view_sifra_transakc
order by 1
--4012

select count (*) 
from view_sifra_transakc
where right (drzavaID,1) in (0,2,4,6,8) and right (sifra_transakc, 1) in (0,2,4,6,8)
--rj: count = 93  
--10 bodova


--------------------------------------------
/*
9.
a) U tabeli kupovina broj računa se sastoji od slovnog i brojčanog dijela. Kreirati pogled view_slovni kojim će se izvršiti prebrojavanje prema slovnom dijelu broja računa.
b) Koristeći prethodno kreirani pogled izvršiti prebrojavanje prema početnom slovu 
c) Koristeći pogled kreiran pod a) izvršiti prebrojavanje ukupnog broj prebrojanih slovnih dijelova koji nisu jednocifreni.
*/
create view view_slovni
as
select left (br_racuna,LEN (br_racuna)-4) as slovni, COUNT (left (br_racuna,LEN (br_racuna)-4)) as count_slovni
from kupovina
group by left (br_racuna,LEN (br_racuna)-4)
--80

select LEFT (slovni,1), COUNT (LEFT (slovni,1))
from view_slovni
group by LEFT (slovni,1)
--18

select count_slovni, COUNT (count_slovni)
from view_slovni
where count_slovni > 9 
group by count_slovni
--4
/*
50	29
51	41
102	3
154	1
*/
--15 bodova



--------------------------------------------
/*
10. 
Kreirati upit kojim će dati prikaz kolone loginID nakon što se iz nje izbaci sve osim karaktera koji slijede nakon znaka \, uz uslov da se prikažu samo oni zapisi u kojima je dužina novonastalog stringa kraća od 6 znakova.
*/
select substring (loginID,17,15)
from radnik
where LEN (substring (loginID,17,15)) < 6
--82
--5 bodova


	CREATE DATABASE MILICALJUBAVkl
	use MILICALJUBAVkl

--b) Kreiranje tabela. Voditi raèuna o meðusobnom odnosu izmeðu tabela. Definirati odgovarajuæe spoljne kljuèeve pomoæu kojih æe se tabele meðusobno povezati.

	
/*
I. Kreirati tabelu narudzba sljedeæe strukture:
	- narudzbaID cjelobrojna varijabla, primarni kljuè
	- kupac, 40 unicode karaktera
	- puna_adresa, 80 unicode karaktera
	- datum_narudzbe, datumska varijabla
	- cijena_prevoza, novèana varijabla
*/

	CREATE TABLE narudzba
	(
		narudzbaID int not null primary key,
		kupac nvarchar(40),
		puna_adresa nvarchar(80),
		datum_narudzbe date,
		cijena_prevoza money
	)


/*
II. Kreirati tabelu proizvod sljedeæe strukture:
	- proizvodID, , cjelobrojna varijabla, primarni kljuè 
	- naziv_proizvoda, 40 unicode karaktera
	- naziv_dobavljaca, 40 unicode karaktera
	- stanje_na_sklad, cjelobrojna varijabla
	- narucena_kol, cjelobrojna varijabla
*/
	create table proizvod
	(
		proizvodID int not null primary key,
		naziv_proizvoda nvarchar(40),
		naziv_dobavljaca nvarchar(40),
		stanje_na_sklad int,
		narucena_kol int
	)

/*
II. Kreirati tabelu detalji_narudzbe sljedeæe strukture:
	- narudzbaID, cjelobrojna varijabla
	- proizvodID, cjelobrojna varijabla
	- cijena_proizvoda, novèana varijabla
	- kolicina, cjelobrojna varijabla
	- popust, decimalna varijabla
*/
	create table detalji_narudzbe 
	(
		narudzbaID int not null,
		proizvodID int not null,
		cijena_proizvoda money,
		kolicina int,
		popust decimal(8,2),
		constraint PK_detalji_narudzbe primary key (narudzbaID,proizvodID),
		constraint FK_detalji_narudzbe_narudzba foreign key (narudzbaID) references narudzba(narudzbaID),
		constraint FK_detalji_narudzbe_proizvod foreign key (proizvodID) references proizvod (proizvodID)
	)

--10 bodova
---------------------------------------------------------------------------
--2. Import podataka
/*
Koristeæi bazu Northwind u vlastiti bazu prebaciti podatke prema zadatim pravilima.
a) U tabelu narudzba iz tabela Customers i Orders prebaciti: 
	- OrderID -> narudzbaID 
	- CompanyName -> kupac 
	- puna_adresa - spojiti podatke iz kolona Address, PostalCode i City pri èemu je potrebno podatke razdvojiti crticom
	- OrderDate -> datum_narudzbe 
	- Freight -> cijena_prevoza
*/
	INSERT INTO narudzba
	SELECT O.OrderID,C.CompanyName,C.Address+ '_' + C.PostalCode + '_' + C.City AS 'puna_adresa',o.OrderDate,O.Freight
	FROM Northwind.dbo.Customers as C join Northwind.dbo.Orders as O ON C.CustomerID=O.CustomerID


/*
b) U tabelu proizvod iz tabela Products i Suppliers prebaciti: 
	- ProductID -> proizvodID 
	- ProductName -> naziv_proizvoda 
	- CompanyName -> naziv_dobavljaca 
	- UnitsInStock -> stanje_na_sklad 
	- UnitsOnOrder -> narucena_kol 
*/

	INSERT INTO proizvod
	SELECT P.ProductID,p.ProductName,S.CompanyName,P.UnitsInStock,P.UnitsOnOrder
	from Northwind.dbo.Products as P join Northwind.dbo.Suppliers as S ON P.SupplierID=S.SupplierID
--77

/*
c) U tabelu detalji_narudzbe iz tabela Order Details i Products prebaciti: 
	- OrderID -> narudzbaID 
	- ProductID -> proizvodID 
	- UnitPrice -> cijena_proizvoda 
	- Quantity -> kolicina 
	- Discount -> popust 
*/

	INSERT INTO detalji_narudzbe
	SELECT OD.OrderID,P.ProductID,P.UnitPrice,OD.Quantity,OD.Discount
	FROM Northwind.dbo.[Order Details] AS OD JOIN Northwind.dbo.Products AS P ON OD.ProductID=P.ProductID


--2155
--10 bodova




---------------------------------------------------------------------------
/*
3. 
a) Koristeæi tabele narudzba i detalji_narudzbe kreirati pogled view_kupac_kol sljedeæe strukture:
	-	narudzbaID
	-	kupac
	-	datum_narudzbe
	-	kolicina
uz uslov da je narudzba izvršena najranije 22 godine u odnosu na aktuelni datum.
*/

--12 bodova
go
create view view_kupac_kol
as
select n.narudzbaID, n.kupac, n.datum_narudzbe, dn.kolicina
from narudzba as n join detalji_narudzbe as dn on dn.narudzbaID=n.narudzbaID 
where datediff(year, n.datum_narudzbe, getdate()) <22
/*4. 
Kreirati proceduru koja æe imati istu strukturu kao tabela narudzba. Voditi raèuna o tipovima varijabli u proceduri. Proceduru kreirati tako da je prilikom izvršavanja moguæe unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti). Uslov je da preuzmu samo oni zapisi u kojima nije odobren popust. Pokrenuti porceduru za sljedeæe vrijednosti parametara:
1. kolièina = 10
2. ID narudžbe = 10255
*/

go
create procedure proc_kupac_kol
(
@narudzbaID INT=NULL,
@proizvodID INT=NULL,
@cijena_proizvoda MONEY=null,
@kolicina INT=null,
@popust DECIMAL=null
)
as
begin
select narudzbaID,proizvodID,cijena_proizvoda,kolicina,popust
from detalji_narudzbe
where (@narudzbaID=narudzbaID OR  @proizvodID=proizvodID OR @cijena_proizvoda=cijena_proizvoda OR
	   @kolicina=kolicina OR  @popust=popust) AND ( @popust IS NULL)
END;


exec proc_kupac_kol @kolicina=10
exec proc_kupac_kol @narudzbaID=10255


/*
5. Kreirati pogled kojim æe se dati prikaz naruèenih kolièina prema mjesecu narudžbe. Uslov je da je narudžba izvršena u 1996. godini. Pogled treba sadržavati ID narudžbe, redni broj mjeseca i kolièinu.
*/

go
create view view_kolicina
as
select n.narudzbaID, month(n.datum_narudzbe) as 'mjesec', dn.kolicina
from narudzba as n join detalji_narudzbe as dn on dn.narudzbaID=n.narudzbaID
where YEAR(n.datum_narudzbe) LIKE 1996 

/*
6. 
a) Kreirati pogled koji æe se sastojati od naziva dobavljaèa, naziva proizvoda, ukupne cijene koja je proizvod jediniène cijene i kolièine, ukupne cijene s popustom koja predstavlja ukupnu cijenu sa obraèunatim popustom i visinu popusta izraženu kao broj. Obratiti pažnju na naèin raèunanja ukupne cijene s popustom. Uslov da je u pogledu budu samo oni zapisi kod kojih je odobren popust.
b) Koriseæi pogled kreiran pod a) prikazati minimalnu, maksimalnu i srednju vrijednost visine popusta, te razliku izmeðu minimalne i maksimalne vrijednosti. Srednja vrijednsot predstavlja srednju vrijednost novèanih vrijednosti, pa njen prikaz treba s tim uskladiti.
*/

go
create view view_dobavljac
as
select p.naziv_dobavljaca, p.naziv_proizvoda, dn.kolicina*dn.cijena_proizvoda as 'ukupna_cijena', dn.kolicina*dn.cijena_proizvoda*(1-dn.popust) as 'uk_sa_pop', dn.cijena_proizvoda*dn.kolicina*dn.popust as 'visina_popusta' 
from proizvod as p join detalji_narudzbe as dn on p.proizvodID=dn.proizvodID
where dn.popust IS NOT NULL

SELECT min(visina_popusta) as 'min', max(visina_popusta) as 'max', round(avg(visina_popusta),2) as 'prosjecna',
	   MAX(visina_popusta)-MIN(visina_popusta) as 'razlika'
from view_dobavljac

/*
7. 
a) Kreirati pogled koji æe prikazati sumirane cijene proizvoda po nazivu proizvoda i popustu.
b) Koristeæi pogled kreiran pod a) prikazati maksimalne vrijednosti suma po visinama popusta. Sortirati po vrijednostima popusta u rastuæem redoslijedu.
c) Koristeæi pogled kreiran pod a) prikazati srednje vrijednosti suma po nazivima proizvoda. Sortirati po vrijednostima suma u opadajuæem redoslijedu. Voditi raèuna da je cijena proizvoda novèana varijabla, te prema tome formatirati srednje vrijednosti.
*/

go
create view view_cijena
as
select p.naziv_proizvoda,dn.popust,SUM(dn.cijena_proizvoda) as 'sumirana_cijena'
from proizvod as p join detalji_narudzbe as dn on p.proizvodID=dn.proizvodID
group by p.naziv_proizvoda,dn.popust


select MAX(c.sumirana_cijena) as 'cijena',c.popust
from view_cijena as c
group by c.popust
order by popust asc

select naziv_proizvoda, round(avg(sumirana_cijena),2) as 'sumirana cijena'
from view_cijena 
group by naziv_proizvoda
order by round(avg(sumirana_cijena),2) desc

/*
8. Dati pregled kupovine po rednom broju dana u mjesecu. Upit treba da sadrži naziv proizvoda, redni broj dana u mjesecu i ukupan broj prodaje proizvoda na taj redni broj dana. Npr, proizvod_1 se 1 dana u mjesecu prodao 3 puta. Uslov je da se da prikaz za prvu polovinu mjeseca.
*/

SELECT p.naziv_proizvoda,day(n.datum_narudzbe) as 'dani_u_mjesecu',count(*) as 'koliko_puta_se_prodalo'
FROM proizvod as p join detalji_narudzbe as dn on p.proizvodID=dn.proizvodID JOIN narudzba as n ON dn.narudzbaID=n.narudzbaID
where day(n.datum_narudzbe)>=1 AND day(n.datum_narudzbe)<=15
GROUP BY p.naziv_proizvoda,day(n.datum_narudzbe)

/*
9. Kreirati pregled kojim æe se na osnovu podataka iz kolone puna_adresa prebrojati koliko puta se neka adresa pojavljuje. Upit treba da sadrži adresu i broj pojavljivanja adrese. Npr. adresa 1 se pojavljuje 10 puta. Sortirati prema broju pojavljivanja u opadajuæem redoslijedu.
*/

SELECT n.puna_adresa,COUNT(n.puna_adresa) as 'broj_pojavljivanja_adrese'
FROM narudzba AS n
GROUP BY n.puna_adresa
ORDER BY COUNT(n.puna_adresa) desc


select left (puna_adresa, (CHARINDEX ('-',puna_adresa)-1)), count (left (puna_adresa, (CHARINDEX ('-',puna_adresa)-1)))
from narudzba
group by left (puna_adresa, (CHARINDEX ('-',puna_adresa)-1))
order by 2 desc





--1
/*
a) Koristeći izričito SQL kod kreirati bazu podataka pod vlastitim brojem indeksa.
*/
CREATE DATABASE PI_2019_9_16
USE PI_2019_9_16

--b) Kreiranje tabela. Voditi računa o međusobnom odnosu između tabela. Definirati odgovarajuće spoljne ključeve pomoću kojih će se tabele međusobno povezati.
/*
I. Kreirati tabelu narudzba sljedeće strukture:
	- narudzbaID cjelobrojna varijabla, primarni ključ
	- kupac, 40 unicode karaktera
	- puna_adresa, 80 unicode karaktera
	- datum_narudzbe, datumska varijabla
	- cijena_prevoza, novčana varijabla
*/
CREATE TABLE narudzba
(
	narudzbaID INT CONSTRAINT PK_Narudzba PRIMARY KEY,
	kupac NVARCHAR (40),
	puna_adresa NVARCHAR (80),
	datum_narudzbe DATE,
	cijena_prevoza MONEY
)

/*
II. Kreirati tabelu proizvod sljedeće strukture:
	- proizvodID, , cjelobrojna varijabla, primarni ključ 
	- naziv_proizvoda, 40 unicode karaktera
	- naziv_dobavljaca, 40 unicode karaktera
	- stanje_na_sklad, cjelobrojna varijabla
	- narucena_kol, cjelobrojna varijabla
*/
CREATE TABLE proizvod
(
	proizvodID INT CONSTRAINT PK_ProizvodID PRIMARY KEY,
	naziv_proizvoda NVARCHAR (40),
	naziv_dobavljaca NVARCHAR (40),
	stanje_na_sklad INT,
	narucena_kol INT
)

/*
II. Kreirati tabelu detalji_narudzbe sljedeće strukture:
	- narudzbaID, cjelobrojna varijabla
	- proizvodID, cjelobrojna varijabla
	- cijena_proizvoda, novčana varijabla
	- kolicina, cjelobrojna varijabla
	- popust, decimalna varijabla
*/
CREATE TABLE detalji_narudzbe
(
	narudzbaID INT,
	proizvodID INT,
	cijena_proizvoda MONEY,
	kolicina INT,
	popust decimal (8,2),
	CONSTRAINT FK_Detalji_Narudzba FOREIGN KEY (narudzbaID) REFERENCES narudzba (narudzbaID),
	CONSTRAINT FK_Detalji_Proizvod FOREIGN KEY (proizvodID) REFERENCES proizvod (proizvodID),
	CONSTRAINT PK_DetaljiNarudzbe PRIMARY KEY (narudzbaID, proizvodID)
)
--10 bodova



---------------------------------------------------------------------------
--2. Import podataka
/*
Koristeći bazu Northwind u vlastiti bazu prebaciti podatke prema zadatim pravilima.
a) U tabelu narudzba iz tabela Customers i Orders prebaciti: 
	- OrderID -> narudzbaID 
	- CompanyName -> kupac 
	- puna_adresa - spojiti podatke iz kolona Address, PostalCode i City pri čemu je potrebno podatke razdvojiti crticom
	- OrderDate -> datum_narudzbe 
	- Freight -> cijena_prevoza
*/
INSERT INTO narudzba 
SELECT	O.OrderID, C.CompanyName, C.Address + ' - ' + C.PostalCode + ' - ' + C.City,
		O.OrderDate, O.Freight
FROM	Northwind.dbo.Customers AS C INNER JOIN Northwind.dbo.Orders AS O
ON		C.CustomerID = O.CustomerID 
--830

SELECT * FROM narudzba

/*
b) U tabelu proizvod iz tabela Products i Suppliers prebaciti: 
	- ProductID -> proizvodID 
	- ProductName -> naziv_proizvoda 
	- CompanyName -> naziv_dobavljaca 
	- UnitsInStock -> stanje_na_sklad 
	- UnitsOnOrder -> narucena_kol 
*/
INSERT INTO proizvod
SELECT	P.ProductID, P.ProductName, S.CompanyName, P.UnitsInStock, P.UnitsOnOrder
FROM	Northwind.dbo.Products AS P INNER JOIN Northwind.dbo.Suppliers AS S 
ON		P.SupplierID = S.SupplierID
--77

/*
c) U tabelu detalji_narudzbe iz tabela Order Details i Products prebaciti: 
	- OrderID -> narudzbaID 
	- ProductID -> proizvodID 
	- UnitPrice -> cijena_proizvoda 
	- Quantity -> kolicina 
	- Discount -> popust 
*/
INSERT INTO detalji_narudzbe
SELECT	OD.OrderID, OD.ProductID, OD.UnitPrice, OD.Quantity, OD.Discount
FROM    Northwind.dbo.[Order Details] AS OD INNER JOIN Northwind.dbo.Products AS P
ON		OD.ProductID = P.ProductID
--2155
--10 bodova




---------------------------------------------------------------------------
/*
3. 
a) Koristeći tabele narudzba i detalji_narudzbe kreirati pogled view_kupac_kol sljedeće strukture:
	-	narudzbaID
	-	kupac
	-	datum_narudzbe
	-	kolicina
uz uslov da je narudzba izvršena najranije 22 godine u odnosu na aktuelni datum.
*/
create view view_kupac_kol
as
SELECT	detalji_narudzbe.narudzbaID, narudzba.kupac, narudzba.datum_narudzbe, detalji_narudzbe.kolicina
FROM	detalji_narudzbe INNER JOIN narudzba 
ON		detalji_narudzbe.narudzbaID = narudzba.narudzbaID
WHERE   (DATEDIFF(year, narudzba.datum_narudzbe, GETDATE()) < 22)
--691

select * from view_kupac_kol
--12 bodova




---------------------------------------------------------------------------
/*
4. 
Kreirati proceduru koja će imati istu strukturu kao tabela narudzba. Voditi računa o tipovima varijabli u proceduri. Proceduru kreirati tako da je prilikom izvršavanja moguće unijeti bilo koji broj parametara (možemo ostaviti bilo koji parametar bez unijete vrijednosti). Uslov je da preuzmu samo oni zapisi u kojima nije odobren popust. Pokrenuti porceduru za sljedeće vrijednosti parametara:
1. količina = 10
2. ID narudžbe = 10255
*/
go
CREATE PROCEDURE proc_detalji_narudzbe
(
	@narudzbaID int = null, 
	@proizvodID int = null,
	@cijena_proizvoda money = null,
	@kolicina int = null,
	@popust decimal (8,2) = null
)
AS
BEGIN
	SELECT narudzbaID, proizvodID, cijena_proizvoda, kolicina, popust 
	FROM detalji_narudzbe
	WHERE popust = 0 AND 
			(narudzbaID = @narudzbaID OR
			proizvodID = @proizvodID OR
			cijena_proizvoda = @cijena_proizvoda or
			kolicina = @kolicina or
			popust = @popust)
END

exec proc_detalji_narudzbe @kolicina = 10
--130

exec proc_detalji_narudzbe @narudzbaID = 10255
--4
--8 bodova




---------------------------------------------------------------------------
/*
5. Kreirati pogled kojim će se dati prikaz naručenih količina prema mjesecu narudžbe. Uslov je da je narudžba izvršena u 1996. godini. Pogled treba sadržavati ID narudžbe, redni broj mjeseca i količinu.
*/
go
create view view_1996
as
SELECT	detalji_narudzbe.narudzbaID, month (narudzba.datum_narudzbe) as mjesec, detalji_narudzbe.kolicina
FROM	detalji_narudzbe INNER JOIN narudzba 
	ON detalji_narudzbe.narudzbaID = narudzba.narudzbaID
where year (narudzba.datum_narudzbe) = 1996
--405

select * from view_1996

--7 bodova



---------------------------------------------------------------------------
/*
6. 
a) Kreirati pogled koji će se sastojati od naziva dobavljača, naziva proizvoda, ukupne cijene koja je proizvod jedinične cijene i količine, ukupne cijene s popustom koja predstavlja ukupnu cijenu sa obračunatim popustom i visinu popusta izraženu kao broj. Obratiti pažnju na način računanja ukupne cijene s popustom. Uslov da je u pogledu budu samo oni zapisi kod kojih je odobren popust.
b) Koriseći pogled kreiran pod a) prikazati minimalnu, maksimalnu i srednju vrijednost visine popusta, te razliku između minimalne i maksimalne vrijednosti. Srednja vrijednsot predstavlja srednju vrijednost novčanih vrijednosti, pa njen prikaz treba s tim uskladiti.
*/
--a
create view view_popust
as
SELECT	proizvod.naziv_dobavljaca, proizvod.naziv_proizvoda, detalji_narudzbe.cijena_proizvoda * detalji_narudzbe.kolicina as uk_cijena, detalji_narudzbe.cijena_proizvoda * detalji_narudzbe.kolicina * (1-detalji_narudzbe.popust) as uk_cij_sa_pop, detalji_narudzbe.cijena_proizvoda * detalji_narudzbe.kolicina * detalji_narudzbe.popust as vis_pop
FROM	detalji_narudzbe INNER JOIN proizvod 
	ON detalji_narudzbe.proizvodID = proizvod.proizvodID
	where detalji_narudzbe.popust <> 0
--838

select * from view_popust

--b
select min (vis_pop), MAX (vis_pop), round(AVG (vis_pop),2), MAX (vis_pop) - min (vis_pop)
from view_popust
--8 bodova





---------------------------------------------------------------------------
/*
7. 
a) Kreirati pogled koji će prikazati sumirane cijene proizvoda po nazivu proizvoda i popustu.
b) Koristeći pogled kreiran pod a) prikazati maksimalne vrijednosti suma po visinama popusta. Sortirati po vrijednostima popusta u rastućem redoslijedu.
c) Koristeći pogled kreiran pod a) prikazati srednje vrijednosti suma po nazivima proizvoda. Sortirati po vrijednostima suma u opadajućem redoslijedu. Voditi računa da je cijena proizvoda novčana varijabla, te prema tome formatirati srednje vrijednosti.
*/
--a
create view view_max_popust
as
SELECT	proizvod.naziv_proizvoda, detalji_narudzbe.popust, sum (detalji_narudzbe.cijena_proizvoda) as ukupno
FROM	detalji_narudzbe INNER JOIN proizvod 
	ON	detalji_narudzbe.proizvodID = proizvod.proizvodID
group by proizvod.naziv_proizvoda, detalji_narudzbe.popust
--407

--b
select popust, max (ukupno)
from view_max_popust
group by popust
--11
/*
0.00	3530.90
0.01	15.00
0.02	25.00
0.03	33.25
0.04	81.00
0.05	1212.10
0.06	34.00
0.10	527.00
0.15	297.00
0.20	421.60
0.25	742.74
*/
--c
select naziv_proizvoda, round (avg (ukupno),2)
from view_max_popust
group by naziv_proizvoda
order by 2 desc
--77
--15 bodova



---------------------------------------------------------------------------
/*
8. Dati pregled kupovine po rednom broju dana u mjesecu. Upit treba da sadrži naziv proizvoda, redni broj dana u mjesecu i ukupan broj prodaje proizvoda na taj redni broj dana. Npr, proizvod_1 se 1 dana u mjesecu prodao 3 puta. Uslova je da se dadne prikaz za prvu polovicu mjeseca.
*/
SELECT	proizvod.naziv_proizvoda, day (narudzba.datum_narudzbe) as r_br_dana, count (day (narudzba.datum_narudzbe))
FROM	detalji_narudzbe INNER JOIN narudzba 
	ON detalji_narudzbe.narudzbaID = narudzba.narudzbaID INNER JOIN proizvod 
		ON detalji_narudzbe.proizvodID = proizvod.proizvodID
where day (narudzba.datum_narudzbe) between 1 and 15
group  by proizvod.naziv_proizvoda, day (narudzba.datum_narudzbe)
--646
--15 bodova





---------------------------------------------------------------------------
/*
9. Kreirati pregled kojim će se na osnovu podataka iz kolone puna_adresa prebrojati koliko puta se neka adresa pojavljuje. Upit treba da sadrži adresu i broj pojavljivanja adrese. Npr. adresa 1 se pojavljuje 10 puta. Sortirati prema broju pojavljivanja u opadajućem redoslijedu.
*/
select left (puna_adresa, (CHARINDEX ('-',puna_adresa)-1)), count (left (puna_adresa, (CHARINDEX ('-',puna_adresa)-1)))
from narudzba
group by left (puna_adresa, (CHARINDEX ('-',puna_adresa)-1))
order by 2 desc
--89
--15 bodova
create database probajseneubit
USE probajseneubit
--b) Kreiranje tabela. Prilikom kreiranja tabela voditi računa o spojnim poljima između tabela.
/*
I. Kreirati tabelu TipProizv koja se sastoji od polja:
	- potkatID - cjelobrojna varijabla, primarni ključ
	- katID - cjelobrojna varijabla, obavezan unos
	- kat_naziv - 50 unicode karaktera, obavezan unos
	- potkat_naziv - 50 unicode karaktera, obavezan unos
*/
create table TipProizv
(
	potkatID int constraint PK_TipProizv primary key (potkatID),
	katID int not null,
	kat_naziv nvarchar(50) not null,
	potkat_naziv nvarchar(50)
)

/*
II. Kreirati tabelu proizvod koja se sastoji od polja:
	- proizvodID - cjelobrojna varijabla, primarni ključ
	- naziv - 50 UNICODE karaktera, obavezan unos
	- boja - 15 UNICODE karaktera
	- tezina - decimalni broj  decimal(8, 2),
	- dana_za_proiz - cjelobrojna varijabla, obavezan unos
	- klasa - 2 unicode karaktera 
	-dtmm_poc_prodaje- datumska varijabla samo za unos datuma (bez vremena)
	- potkat_ID cjelobrojna varijabla, obavezan unos
*/
create table proizvod
(
	proizvodID int constraint PK_proizvod Primary key (proizvodID),
	naziv nvarchar(50) not null,
	boja nvarchar(15),
	tezina decimal(8, 2),
	dana_za_proiz int not null,
	klasa nvarchar (2),
	dtm_poc_prodaje date,
	potkatID int not null
	constraint FK_proizvod_TipProiz foreign key (potkatID) references TipProizv (potkatID)
)

/*
III. Kreirati tabelu nalog koja se sastoji od polja:
	- nalogID - cjelobrojna varijabla, primarni ključ
	- proizvodID - cjelobrojna varijabla, obavezan unos
	- naruc_kol - cjelobrojna varijabla, obavezan unos
	- stanje_kol - cjelobrojna varijabla, obavezan unos
	- dtm_zaduz - datumska varijabla samo za unos datuma (bez vremena)
	- oznaka_greske - 50 unicode karaktera, obavezan unos
*/
create table nalog
(
	nalogID int not null primary key,
	proizvodID int not null,
	naruc_kol int not null,
	stanje_kol int not null,
	dtm_zaduz date,
	oznaka_greske nvarchar(50) not null,
	constraint FK_nalog_proizvod foreign key (proizvodID) references proizvod (proizvodID)
)
--15 bodova

--2. Importovanje podataka
/*
a) U tabelu TipProizv importovati podatke iz tabela ProductSubcategory i ProductCategory baze AdventureWorks2014 koje se nalaze u šemi Production na sljedeći način:
	- ProductSubcategoryID -> potkatID 
	- ProductCategoryID -> katID 
	- Name -> kat_naziv
	- Name -> potkat_naziv
Voditi računa o pripadnosti polja tabelama iz kojih se importuju podaci.
*/

INSERT INTO TipProizv
SELECT	PS.ProductSubcategoryID, PC.ProductCategoryID, PC.Name, PS.Name
FROM	AdventureWorks2014.Production.ProductCategory AS PC INNER JOIN AdventureWorks2014.Production.ProductSubcategory AS PS
ON		PC.ProductCategoryID = PS.ProductCategoryID

/*b) U tabelu proizvod importovati podatke iz tabele Product baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
	- ProductID -> proizvodID
	- Name -> naziv
	- Color -> boja 
	- Weight -> tezina 
	- DaysToManufacture -> dana_za_proiz 
	- Class -> klasa 
	- ProductSubcategoryID -> potkatID
uz uslov da je ProductSubcategoryID sadrži vrijednost.
*/

INSERT INTO proizvod(proizvodID, naziv, boja, tezina, dana_za_proiz, klasa, potkatID)
select p.ProductID, P.Name, P.Color, P.Weight, P.DaysToManufacture, P.Class, P.ProductSubcategoryID
FROM	AdventureWorks2014.Production.Product AS P
where	P.ProductSubcategoryID is not null

/*
c) U tabelu nalog importovati podatke iz tabela WorkOrder i ScrapReason baze AdventureWorks2014 koja se nalazi u šemi Production na sljedeći način:
	- WorkOrderID -> nalogID 
	- ProductID -> proizvodID 
	- OrderQty -> naruc_kol 
	- StockedQty -> stanje_kol 
	- DueDate -> dtm_zaduz 
	- Name -> oznaka_greske
uz uslov da je ProductID veći ili jednak 680. 
*/
INSERT INTO nalog
SELECT	WO.WorkOrderID, WO.ProductID, WO.OrderQty, WO.StockedQty, WO.DueDate, SR.Name
FROM	AdventureWorks2014.Production.WorkOrder as WO INNER JOIN AdventureWorks2014.Production.ScrapReason as SR
ON		SR.ScrapReasonID = WO.ScrapReasonID
where	WO.ProductID >= 680 

/*
3. Iz tabele proizvod dati pregled koji će se sastojati od polja:

mjesec - mjesec iz datuma početka prodaje
uk_broj_po_mj - ukupan broj zapisa po mjesecima

5 bodova
*/

select MONTH(dtm_poc_prodaje) AS 'mjesec', count(*)
from proizvod
group by month(dtm_poc_prodaje)

/*
4. Iz tabele nalog kreirati pogled view_greska koji će se sastojati od polja:
- nalogID, proizvodID, dtm_zaduz, uz uslov da se u oznaci greške bilo gdje pojavi riječ 'brake'

10 bodova


*/

go
create view view_greska
as
select n.nalogID, n.proizvodID, n.dtm_zaduz, n.oznaka_greske
from nalog as n
where n.oznaka_greske LIKE '%Brake%'
/*
5. Koristeći pogled view_greska kreirati proceduru proc_greska kojom će se definisati ulazni parametar godina
a procedura će imati strukturu 
-godina 
-prebrojano, broj grešaka po godinama
Proc pokrenuti za vrijednost parametra 2011 i 2014

10 bodova

*/

go
create procedure proc_greska
(
@godina int=null
)
as
begin
select year(dtm_zaduz) as 'godina', count(*) as 'prebrojano' 
from view_greska
where @godina=year(dtm_zaduz)
group by year(dtm_zaduz)
end;

exec proc_greska @godina=2014
exec proc_greska @godina=2011
/*
6. Koristeći tabele proizvod i nalog kreirati pogled view_tezina sljedeće strukture:
- potkatID, 
- suma_tez suma tezina 
Uslov je da se preuzimaju zapisi u kojima se nalaze vrijednosti u kolonama boja i težina
*/

go
create view view_tezina
as
select p.potkatID, sum(p.tezina) as 'suma'
from proizvod as p join nalog as n on n.proizvodID=p.proizvodID
where p.boja IS NOT NULL AND p.tezina IS NOT NULL
GROUP BY P.potkatID
*/
/*
Koristeći pogled view_tezina prebrojati broj zapisa koji su veći ili jednaki, odnosno manji od srednje vrijednosti. Rezultat upita trebaju biti isključivo dvije poruke:
'Broj zapisa u kojima je suma veća ili jednaka srednjoj vrijednosti sume težina je: ' nakon čega slijedi prebrojati
'Broj zapisa u kojima je suma manja srednjoj vrijednosti sume težina je: ' nakon čega slijedi prebrojani broj
Neće se priznati rješenje koje vraća dvije ili više kolona

---- spajanje poruka, vise od jedne je UNION !

15 bodoba
*/

select 'broj zapisa u kojima je suma veca ili jednaka sredjnoj vrijednosti sume tezina je:' + CONVERT(nvarchar,COUNT(suma))
from view_tezina
where suma>=AVG(suma)
UNION 
SELECT
FROM 
group by 
having 

*/
/*
8. a)Kreirati pogled view_proizv_greska koji će se sastojati od polja:
proizvodID, oznaka_greske, uk_broj_gresaka kojim će se prebrojati ukupan broj pojavljivanja grešaka po proizvodID i nazivu greške.
b) Koristeći pogled view_proizv_greska dati informaciju o proizvodima na kojim je ustanovljeno više vrsta grešaka
Sortirati po opadajućem redoslijedu prema broju poajvljivanja


15 bodova
*/

go
create view view_proizv_greska
as
select n.proizvodID, n.oznaka_greske, count(n.oznaka_greske) as 'ukupan_broj'
from nalog as n
group by n.proizvodID, n.oznaka_greske



	select proizvodID,COUNT(ukupan_broj) as ' uk_prebrojano'
	from view_proizv_greska
	group by proizvodID
	order by 2 desc 

*/
/*
9. Kreirati pogled kojim će se dati prikaz nalogID, proizvodID, broja godina razlike u odnosnu na trenutnu (aktivnu), oznaku boje koju će predstavljati prvo slovo naziva (npr. Puprle) -> P, klase i naziva potkat. Izraz za izračunavanje broja godina razlike treba biti opšteg karaktera. Uslov je da naziv potkat sadrži 'Bikes', te da boja nije crna.Obavezno napisati kod za pregled sadržaja pogleda.


*/

go
create view view_neki
as
select N.nalogID, N.proizvodID,DATEDIFF(YEAR,N.dtm_zaduz,GETDATE()) as 'razlika_godina', LEFT(P.boja,1) AS 'oznaka_boje',P.klasa,TP.potkat_naziv							          
from nalog as N join proizvod as P ON N.proizvodID=P.proizvodID join TipProizv as TP ON P.potkatID=TP.potkatID
where TP.potkat_naziv like '%Bikes%' AND P.boja  NOT LIKE 'Black'


SELECT* from  view_neki
/*
10.a) Kreirati backup baze na default lokaciju
b) obrisati bazu
c) restore baze
*/
backup database probajseneubit
to disk = 'probajseneubit.bak'

use master

alter database probajseneubit
set offline

drop database probajseneubit

restore database probajseneubit 
from disk = 'probajseneubit.bak'
with replace

*/


*/



















--29.06.2022.

--BAZE PODATAKA II – ISPIT

--***Prilikom izrade zadataka, OBAVEZNO iznad svakog zadatka napisati redni broj zadatka npr (4c). Zadaci koji ne budu oznaèeni na prethodno definisan naèin neæe biti evaluirani.

--1.	Kroz SQL kod kreirati bazu podataka sa imenom vašeg broja indeksa.
CREATE DATABASE brojIndexa
GO
USE brojIndexa
GO
--2.	U kreiranoj bazi podataka kreirati tabele sa sljedeæom strukturom:
--a)	Proizvodi
--•	ProizvodID, cjelobrojna vrijednost i primarni kljuè, autoinkrement
--•	Naziv, 50 UNICODE karaktera (obavezan unos)
--•	SifraProizvoda, 25 UNICODE karaktera (obavezan unos)
--•	Boja, 15 UNICODE karaktera 
--•	NazivKategorije, 50 UNICODE (obavezan unos)
--•	Tezina, decimalna vrijednost sa 2 znaka iza zareza
CREATE TABLE Proizvodi
(
	ProizvodID INT CONSTRAINT PK_Proizvod PRIMARY KEY IDENTITY(1,1),
	Naziv NVARCHAR(50) NOT NULL,
	SifraProizvoda NVARCHAR(25) NOT NULL,
	Boja NVARCHAR(15), 
	NazivKategorije  NVARCHAR(50) NOT NULL,
	Tezina DECIMAL(18,2)

)
GO
--b)	ZaglavljeNarudzbe 
--•	NarudzbaID, cjelobrojna vrijednost i primarni kljuè, autoinkrement
--•	DatumNarudzbe, polje za unos datuma i vremena (obavezan unos)
--•	DatumIsporuke, polje za unos datuma i vremena
--•	ImeKupca, 50 UNICODE (obavezan unos)
--•	PrezimeKupca, 50 UNICODE (obavezan unos)
--•	NazivTeritorije, 50 UNICODE (obavezan unos)
--•	NazivRegije, 50 UNICODE (obavezan unos)
--•	NacinIsporuke, 50 UNICODE (obavezan unos)
CREATE TABLE ZaglavljeNarudzbe
(
	NarudzbaID INT CONSTRAINT PK_ZaglavljeNarudzbe PRIMARY KEY IDENTITY(1,1),
	DatumNarudzbe DATETIME NOT NULL,
	DatumIsporuke DATETIME,
	ImeKupca NVARCHAR(50) NOT NULL,
	PrezimeKupca NVARCHAR(50) NOT NULL, 
	NazivTeritorije NVARCHAR(50) NOT NULL,
	NazivRegije NVARCHAR(50) NOT NULL,
	NacinIsporuke NVARCHAR(50) NOT NULL
)
GO
--c)	DetaljiNarudzbe
--•	NarudzbaID, cjelobrojna vrijednost, strani kljuè
--•	ProizvodID, cjelobrojna vrijednost, strani kljuè
--•	Cijena, novèani tip (obavezan unos),
--•	Kolicina, skraæeni cjelobrojni tip (obavezan unos),
--•	Popust, novèani tip (obavezan unos)
CREATE TABLE DetaljiNarudzbe
(
	NarudzbaID INT NOT NULL CONSTRAINT FK_ZaglavljeNarudzbe FOREIGN KEY REFERENCES ZaglavljeNarudzbe(NarudzbaID),
	ProizvodID INT NOT NULL CONSTRAINT FK_Proizvodi FOREIGN KEY REFERENCES Proizvodi(ProizvodID),
	Cijena MONEY NOT NULL,
	Kolicina SMALLINT NOT NULL,
	Popust MONEY NOT NULL,
	DetaljiNarudzbe INT CONSTRAINT PK_DetaljiNarudzbe PRIMARY KEY IDENTITY(1,1)
)
GO
--**Jedan proizvod se može više puta naruèiti, dok jedna narudžba može sadržavati više proizvoda. U okviru jedne narudžbe jedan proizvod se može naruèiti više puta.
--7 bodova
--3.	Iz baze podataka AdventureWorks u svoju bazu podataka prebaciti sljedeæe podatke:
--a)	U tabelu Proizvodi dodati sve proizvode, na mjestima gdje nema pohranjenih podataka o težini zamijeniti vrijednost sa 0
--•	ProductID -> ProizvodID
--•	Name  -> Naziv 	
--•	ProductNumber -> SifraProizvoda
--•	Color -> Boja 
--•	Name (ProductCategory) -> NazivKategorije
--•	Weight -> Tezina
SET IDENTITY_INSERT  Proizvodi ON
INSERT INTO Proizvodi(ProizvodID,Naziv,SifraProizvoda,Boja,NazivKategorije,Tezina)
SELECT P.ProductID,P.Name,P.ProductNumber,P.Color,PC.Name,ISNULL(P.Weight,0)
FROM AdventureWorks2017.Production.Product AS P
INNER JOIN AdventureWorks2017.Production.ProductSubcategory AS PS
ON P.ProductSubcategoryID=PS.ProductSubcategoryID
INNER JOIN AdventureWorks2017.Production.ProductCategory AS PC
ON PS.ProductCategoryID=PC.ProductCategoryID
SET IDENTITY_INSERT  Proizvodi OFF
GO

--b)	U tabelu ZaglavljeNarudzbe dodati sve narudžbe
--•	SalesOrderID -> NarudzbaID
--•	OrderDate -> DatumNarudzbe
--•	ShipDate -> DatumIsporuke
--•	FirstName (Person) -> ImeKupca
--•	LastName (Person) -> PrezimeKupca
--•	Name (SalesTerritory) -> NazivTeritorije
--•	Group (SalesTerritory) -> NazivRegije
--•	Name (ShipMethod) -> NacinIsporuke
SET IDENTITY_INSERT ZaglavljeNarudzbe ON
INSERT INTO ZaglavljeNarudzbe(NarudzbaID,DatumNarudzbe,DatumIsporuke,ImeKupca,PrezimeKupca,NazivTeritorije,NazivRegije,NacinIsporuke)
SELECT SOH.SalesOrderID,SOH.OrderDate,SOH.ShipDate,PP.FirstName,PP.LastName,ST.Name,ST.[Group],SM.Name
FROM AdventureWorks2017.Sales.SalesOrderHeader AS SOH
INNER JOIN AdventureWorks2017.Sales.Customer AS SC
ON SOH.CustomerID=SC.CustomerID
INNER JOIN AdventureWorks2017.Person.Person AS PP
ON SC.PersonID=PP.BusinessEntityID
INNER JOIN AdventureWorks2017.Sales.SalesTerritory AS ST
ON ST.TerritoryID=SOH.TerritoryID
INNER JOIN AdventureWorks2017.Purchasing.ShipMethod AS SM
ON SOH.ShipMethodID=SM.ShipMethodID
SET IDENTITY_INSERT ZaglavljeNarudzbe OFF
GO
--c)	U tabelu DetaljiNarudzbe dodati sve stavke narudžbe
--•	SalesOrderID -> NarudzbaID
--•	ProductID -> ProizvodID
--•	UnitPrice -> Cijena
--•	OrderQty -> Kolicina
--•	UnitPriceDiscount -> Popust
--8 bodova
INSERT INTO DetaljiNarudzbe
SELECT SOD.SalesOrderID,SOD.ProductID,SOD.UnitPrice,SOD.OrderQty,SOD.UnitPriceDiscount
FROM AdventureWorks2017.Sales.SalesOrderDetail AS SOD
GO
--4.	
--a)	(6 bodova) Kreirati upit koji æe prikazati ukupan broj uposlenika po odjelima. Potrebno je prebrojati samo one uposlenike koji su trenutno aktivni, odnosno rade na datom odjelu. Takoðer, samo uzeti u obzir one uposlenike koji imaju više od 10 godina radnog staža (ne ukljuèujuæi graniènu vrijednost). Rezultate sortirati preba broju uposlenika u opadajuæem redoslijedu. (AdventureWorks2017)
USE AdventureWorks2017
SELECT D.Name,COUNT(*) 'Broj uposlenika'
FROM HumanResources.Employee AS E
INNER JOIN HumanResources.EmployeeDepartmentHistory AS EDH
ON E.BusinessEntityID=EDH.BusinessEntityID
INNER JOIN HumanResources.Department AS D
ON EDH.DepartmentID=D.DepartmentID
WHERE EDH.EndDate IS NULL AND DATEDIFF(YEAR,E.HireDate,GETDATE())>10
GROUP BY D.Name
ORDER BY 2 DESC
GO
--, SUM(IIF(POD.RejectedQty>100,1,0)) 'Broj stavki'
--b)	Kreirati upit koji prikazuje po mjesecima ukupnu vrijednost poruèene robe za skladište, te ukupnu kolièinu primljene robe, iskljuèivo u 2012 godini. Uslov je da su troškovi prevoza bili izmeðu 500 i 2500, a da je dostava izvršena CARGO transportom. Takoðer u rezultatima upita je potrebno prebrojati stavke narudžbe na kojima je odbijena kolièina veæa od 100.(AdventureWorks2017)
USE AdventureWorks2017
--1. NAÈIN
  SELECT MONTH(POH.OrderDate) 'Mjesec', SUM(POD.LineTotal), SUM(POD.ReceivedQty),SUM(IIF(POD.RejectedQty>100,1,0)) 'Broj stavki'
  FROM Purchasing.PurchaseOrderHeader AS POH
  INNER JOIN Purchasing.PurchaseOrderDetail AS POD
  ON POH.PurchaseOrderID=POD.PurchaseOrderID
  INNER JOIN Purchasing.ShipMethod AS SM
  ON POH.ShipMethodID=SM.ShipMethodID
  WHERE YEAR(POH.OrderDate)=2012 AND POH.Freight BETWEEN 500 AND 2500 AND SM.Name LIKE '%CARGO%'
  GROUP BY MONTH(POH.OrderDate)  
GO  
--2. NAÈIN  
  SELECT MONTH(POH.OrderDate) 'Mjesec', SUM(POD.LineTotal), SUM(POD.ReceivedQty),(SELECT COUNT(*)
																					FROM Purchasing.PurchaseOrderHeader AS POH1
																					INNER JOIN Purchasing.PurchaseOrderDetail AS POD1
																					ON POH1.PurchaseOrderID=POD1.PurchaseOrderID
																					INNER JOIN Purchasing.ShipMethod AS SM1
																					ON POH1.ShipMethodID=SM1.ShipMethodID
																					WHERE MONTH(POH.OrderDate)=MONTH(POH1.OrderDate) AND                                                     POD1.RejectedQty>100 AND YEAR(POH1.OrderDate)=2012 AND													POH1.Freight BETWEEN 500 AND 2500 AND SM1.Name LIKE '%CARGO%')
  FROM Purchasing.PurchaseOrderHeader AS POH
  INNER JOIN Purchasing.PurchaseOrderDetail AS POD
  ON POH.PurchaseOrderID=POD.PurchaseOrderID
  INNER JOIN Purchasing.ShipMethod AS SM
  ON POH.ShipMethodID=SM.ShipMethodID
  WHERE YEAR(POH.OrderDate)=2012 AND POH.Freight BETWEEN 500 AND 2500 AND SM.Name LIKE '%CARGO%'
  GROUP BY MONTH(POH.OrderDate)

GO

--3. NAÈIN
 SELECT Q.Mjesec, SUM(Q.[Ukupna vrijednost]) 'Ukupna vrijednost', SUM(Q.[Ukupna kolièina])  'Ukupna kolièina',SUM(Q.[Stavke narudzbe]) 'Stavke narudzbe'
FROM
(SELECT MONTH(POH.OrderDate) 'Mjesec', SUM(POD.LineTotal) 'Ukupna vrijednost', SUM(POD.ReceivedQty) 'Ukupna kolièina', (SELECT COUNT(*)
																														FROM
																														AdventureWorks2017.Purchasing.PurchaseOrderDetail AS POD1
																														 WHERE POD1.RejectedQty>100 AND POD.PurchaseOrderID=POD1.PurchaseOrderID) 'Stavke narudzbe'

FROM Purchasing.PurchaseOrderDetail AS POD
INNER JOIN Purchasing.PurchaseOrderHeader AS POH
ON POD.PurchaseOrderID=POH.PurchaseOrderID
INNER JOIN Purchasing.ShipMethod AS SM
ON POH.ShipMethodID=SM.ShipMethodID
WHERE YEAR(POH.OrderDate)=2012 AND (POH.Freight BETWEEN 500 AND 2500) AND SM.Name LIKE '%CARGO%'
GROUP BY MONTH(POH.OrderDate), POD.PurchaseOrderID) AS Q
GROUP BY Q.Mjesec

GO
 --PROVJERA
 SELECT POH.OrderDate, POD.RejectedQty, POD.PurchaseOrderDetailID, POH.PurchaseOrderID
 FROM Purchasing.PurchaseOrderHeader AS POH
 INNER JOIN Purchasing.PurchaseOrderDetail AS POD
 ON POH.PurchaseOrderID=POD.PurchaseOrderID
 INNER JOIN Purchasing.ShipMethod AS SM
 ON POH.ShipMethodID=SM.ShipMethodID
 WHERE YEAR(POH.OrderDate)=2012 AND POH.Freight BETWEEN 500 AND 2500 AND SM.Name LIKE '%CARGO%' AND MONTH(POH.OrderDate) =1
  --GROUP BY MONTH(POH.OrderDate), POD.RejectedQty
GO  
--c)	(11 bodova) Prikazati ukupan broj narudžbi koje su obradili uposlenici, za svakog uposlenika pojedinaèno. Uslov je da su narudžbe kreirane u 2011 ili 2012 godini, te da je u okviru jedne narudžbe odobren popust na dvije ili više stavki. Takoðer uzeti u obzir samo one narudžbe koje su isporuèene u Veliku Britaniju, Kanadu ili Francusku. (AdventureWorks2017)

SELECT PP.LastName,PP.FirstName, COUNT(*) 'Broj narudžbi'
FROM Person.Person AS PP
INNER JOIN HumanResources.Employee AS E
ON PP.BusinessEntityID=E.BusinessEntityID
INNER JOIN Sales.SalesPerson AS SP
ON SP.BusinessEntityID=E.BusinessEntityID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOH.SalesPersonID=SP.BusinessEntityID
INNER JOIN Sales.SalesTerritory AS ST
ON ST.TerritoryID=SOH.TerritoryID
WHERE YEAR(SOH.OrderDate) IN (2011,2012) AND ST.Name IN ('United Kingdom', 'Canada', 'France') AND (SELECT COUNT(*)
																									FROM Sales.SalesOrderDetail AS SOD
																									WHERE SOD.SalesOrderID=SOH.SalesOrderID AND 
																									SOD.UnitPriceDiscount>0) >=2
GROUP BY PP.LastName,PP.FirstName
ORDER BY 3 DESC

GO




--d)	(11 bodova) Napisati upit koji æe prikazati sljedeæe podatke o proizvodima: naziv proizvoda, naziv kompanije dobavljaèa, kolièinu na skladištu, te kreiranu šifru proizvoda. Šifra se sastoji od sljedeæih vrijednosti: (Northwind)
--1)	Prva dva slova naziva proizvoda
--2)	Karakter /
--3)	Prva dva slova druge rijeèi naziva kompanije dobavljaèa, uzeti u obzir one kompanije koje u nazivu imaju 2 ili 3 rijeèi
--4)	ID proizvoda po pravilu ukoliko se radi o jednocifrenom broju na njega dodati slovo 'a', u ostalim sluèajevima dodati obrnutu vrijednost broja
--Npr. Za proizvod sa nazivom Chai i sa dobavljaèem naziva Exotic Liquids, šifra æe btiti Ch/Li1a.

USE Northwind 
GO
SELECT P.ProductName,S.CompanyName,P.UnitsInStock,LEFT(P.ProductName,2)+'/'+LEFT(SUBSTRING(S.CompanyName,CHARINDEX(' ',S.CompanyName)+1,LEN(S.CompanyName)),2)+IIF(P.ProductID BETWEEN 1 AND 9,'a', REVERSE(P.ProductID)), P.ProductID
FROM Products AS P
INNER JOIN Suppliers AS S
ON P.SupplierID=S.SupplierID
WHERE LEN(S.CompanyName)-LEN(REPLACE(S.CompanyName,' ','')) IN (1,2)

GO
--		37 bodova
--5.	
--a)	(3 boda) U kreiranoj bazi kreirati index kojim æe se ubrzati pretraga prema šifri i nazivu proizvoda. Napisati upit za potpuno iskorištenje indexa.
USE brojIndexa
GO

CREATE INDEX IX_Search_Products
ON Proizvodi(SifraProizvoda,Naziv)

SELECT P.SifraProizvoda,P.Naziv
FROM Proizvodi AS P
WHERE P.SifraProizvoda LIKE 'F%' AND P.Naziv LIKE 'H%'
--b)	(7 bodova) U kreiranoj bazi kreirati proceduru sp_search_products kojom æe se vratiti podaci o proizvodima na osnovu kategorije kojoj pripadaju ili težini. Korisnici ne moraju unijeti niti jedan od parametara ali u tom sluèaju procedura ne vraæa niti jedan od zapisa. Korisnicima unosom veæ prvog slova kategorije se trebaju osvježiti zapisi, a vrijednost unesenog parametra težina æe vratiti one proizvode èija težina je veæa od  unesene vrijednosti.
GO
CREATE PROCEDURE sp_search_products
(
@Kategorija NVARCHAR(50)=NULL,
@Tezina DECIMAL(18,2)=NULL
)
AS
BEGIN
	SELECT*
	FROM Proizvodi AS P
	WHERE P.NazivKategorije LIKE @Kategorija+'%' OR P.Tezina>@Tezina
END
GO


EXEC sp_search_products 'Clothing'
EXEC sp_search_products @Tezina=2.2
EXEC sp_search_products
--c)	(18 bodova) Zbog proglašenja dobitnika nagradne igre održane u prva dva mjeseca drugog kvartala 2013 godine potrebno je kreirati upit. Upitom æe se prikazati treæa najveæa narudžba (vrijednost bez popusta) za svaki mjesec pojedinaèno. Obzirom da je u pravilima nagradne igre potrebno nagraditi 2 osobe (muškarca i ženu) za svaki mjesec, potrebno je u rezultatima upita prikazati pored navedenih stavki i o kojem se kupcu radi odnosno ime i prezime, te koju je nagradu osvojio. Nagrade se dodjeljuju po sljedeæem pravilu:
--•	za žene u prvom mjesecu drugog kvartala je stoni mikser, dok je za muškarce usisivaè
--•	za žene u drugom mjesecu drugog kvartala je pegla, dok je za muškarc multicooker
-- Obzirom da za kupce nije eksplicitno naveden spol, odreðivat æe se po pravilu: Ako je zadnje slovo imena a, smatra se da je osoba ženskog spola u suprotnom radi se o osobi muškog spola. Rezultate u formiranoj tabeli dobitnika sortirati prema vrijednosti narudžbe u opadajuæem redoslijedu. (AdventureWorks2017)
--28 bodova
--6.	Dokument teorija_28_06_2022, preimenovati vašim brojem indeksa, te u tom dokumentu izraditi pitanja.
--20 bodova
--SQL skriptu (bila prazna ili ne) imenovati Vašim brojem indeksa npr IB200001.sql, te istu zajedno sa .docx dokumentom kompromitovati  u jednu datoteku naziva npr IB200001.zip i upload-ovati na ftp u folder Upload.
--Maksimalan broj bodova:100  
--Prag prolaznosti: 55
GO
	USE AdventureWorks2017
	SELECT*
	FROM(SELECT TOP 1 T1.SalesOrderID,T1.FirstName,T1.LastName,T1.[Ukupna vrijednost], T1.Nagrada
	FROM (SELECT TOP 3 SOH.SalesOrderID,PP.FirstName,PP.LastName ,SUM(SOD.UnitPrice*SOD.OrderQty) 'Ukupna vrijednost','Stoni mikser' Nagrada
	FROM Sales.SalesOrderHeader AS SOH
	INNER JOIN Sales.SalesOrderDetail AS SOD
	ON SOH.SalesOrderID=SOD.SalesOrderID
	INNER JOIN Sales.Customer AS SC
	ON SOH.CustomerID=SC.CustomerID
	INNER JOIN Person.Person AS PP
	ON SC.PersonID=PP.BusinessEntityID
	WHERE YEAR(SOH.OrderDate)=2013 AND MONTH(SOH.OrderDate)=4 AND RIGHT(PP.FirstName,1)='a'
	GROUP BY SOH.SalesOrderID,PP.FirstName,PP.LastName
	ORDER BY 4 DESC) AS T1
	ORDER BY 4 ASC) AS T2
	UNION
	SELECT*
	FROM(SELECT TOP 1 T1.SalesOrderID,T1.FirstName,T1.LastName,T1.[Ukupna vrijednost], T1.Nagrada
	FROM (SELECT TOP 3 SOH.SalesOrderID,PP.FirstName,PP.LastName ,SUM(SOD.UnitPrice*SOD.OrderQty) 'Ukupna vrijednost','Usisivaè' Nagrada
	FROM Sales.SalesOrderHeader AS SOH
	INNER JOIN Sales.SalesOrderDetail AS SOD
	ON SOH.SalesOrderID=SOD.SalesOrderID
	INNER JOIN Sales.Customer AS SC
	ON SOH.CustomerID=SC.CustomerID
	INNER JOIN Person.Person AS PP
	ON SC.PersonID=PP.BusinessEntityID
	WHERE YEAR(SOH.OrderDate)=2013 AND MONTH(SOH.OrderDate)=4 AND RIGHT(PP.FirstName,1)<>'a'
	GROUP BY SOH.SalesOrderID,PP.FirstName,PP.LastName
	ORDER BY 4 DESC) AS T1
	ORDER BY 4 ASC) AS T2
	UNION
		SELECT*
	FROM(SELECT TOP 1 T1.SalesOrderID,T1.FirstName,T1.LastName,T1.[Ukupna vrijednost], T1.Nagrada
	FROM (SELECT TOP 3 SOH.SalesOrderID,PP.FirstName,PP.LastName ,SUM(SOD.UnitPrice*SOD.OrderQty) 'Ukupna vrijednost','Pegla' Nagrada
	FROM Sales.SalesOrderHeader AS SOH
	INNER JOIN Sales.SalesOrderDetail AS SOD
	ON SOH.SalesOrderID=SOD.SalesOrderID
	INNER JOIN Sales.Customer AS SC
	ON SOH.CustomerID=SC.CustomerID
	INNER JOIN Person.Person AS PP
	ON SC.PersonID=PP.BusinessEntityID
	WHERE YEAR(SOH.OrderDate)=2013 AND MONTH(SOH.OrderDate)=5 AND RIGHT(PP.FirstName,1)='a'
	GROUP BY SOH.SalesOrderID,PP.FirstName,PP.LastName
	ORDER BY 4 DESC) AS T1
	ORDER BY 4 ASC) AS T2
	UNION
	SELECT*
	FROM(SELECT TOP 1 T1.SalesOrderID,T1.FirstName,T1.LastName,T1.[Ukupna vrijednost], T1.Nagrada
	FROM (SELECT TOP 3 SOH.SalesOrderID,PP.FirstName,PP.LastName ,SUM(SOD.UnitPrice*SOD.OrderQty) 'Ukupna vrijednost','Multicooker' Nagrada
	FROM Sales.SalesOrderHeader AS SOH
	INNER JOIN Sales.SalesOrderDetail AS SOD
	ON SOH.SalesOrderID=SOD.SalesOrderID
	INNER JOIN Sales.Customer AS SC
	ON SOH.CustomerID=SC.CustomerID
	INNER JOIN Person.Person AS PP
	ON SC.PersonID=PP.BusinessEntityID
	WHERE YEAR(SOH.OrderDate)=2013 AND MONTH(SOH.OrderDate)=5 AND RIGHT(PP.FirstName,1)<>'a'
	GROUP BY SOH.SalesOrderID,PP.FirstName,PP.LastName
	ORDER BY 4 DESC) AS T1
	ORDER BY 4 ASC) AS T2
	ORDER BY [Ukupna vrijednost] DESC











--1 ZADATAK

CREATE DATABASE Indeks
GO
USE Indeks
GO

CREATE TABLE Narudzba
(
	NarudzbaID INT NOT NULL PRIMARY KEY (NarudzbaID),
	DatumNarudzbe DATE NULL,
	DatumPrijema DATE NULL,
	DatumIsporuke DATE NULL,
	TrosakPrevoza MONEY NULL,
	PunaAdresa NVARCHAR (70) NULL
)

CREATE TABLE Dobavljac 
(
	DobavljacID INT NOT NULL PRIMARY KEY (DobavljacID),
	NazivDobavljaca nvarchar(40) NOT NULL,
	PunaAdresa nvarchar(60) NULL,
	Drzava nvarchar(15) NULL,
	
)

CREATE TABLE Proizvod
(
	NarudzbaID INT NOT NULL CONSTRAINT FK_Proizvod_Narudzba FOREIGN KEY (NarudzbaID) REFERENCES Narudzba (NarudzbaID),
	DobavljacID INT NOT NULL CONSTRAINT FK_Proizvod_Dobavljac FOREIGN KEY (DobavljacID) REFERENCES Dobavljac (DobavljacID),	
	ProizvodID INT NOT NULL,
	NazivProizvoda NVARCHAR (40) NOT NULL,
	Cijena INT NOT NULL,
	Kolicina INT NOT NULL,
	Popust DECIMAL (3,2) NOT NULL,
	Raspolozivost BIT NOT NULL,
	CONSTRAINT PK_Proizvod PRIMARY KEY (NarudzbaID, DobavljacID, ProizvodID)
)
--2 ZADATAK

--2a
INSERT INTO Narudzba
SELECT o.OrderID, o.OrderDate, o.RequiredDate, o.ShippedDate,o.Freight, o.ShipAddress + ' '+ ISNULL(o.ShipPostalCode,'0000')+ ' '+o.ShipCity
FROM Northwind.dbo.Orders as o
WHERE YEAR(o.OrderDate)>=1997 AND o.ShippedDate IS NOT NULL
ORDER BY o.Freight
--657

--2b
INSERT INTO Dobavljac
SELECT S.SupplierID, S.CompanyName, S.Address + S.PostalCode + S.City, S.Country
FROM Northwind.dbo.Suppliers as S
--29

--2c
INSERT INTO Proizvod
SELECT OD.OrderID, P.SupplierID, P.ProductID, P.ProductName, OD.UnitPrice,OD.Quantity,OD.Discount,P.Discontinued
FROM Northwind.dbo.Products as P
inner join Northwind.dbo.[Order Details] as OD
on P.ProductID=OD.ProductID
inner join Northwind.dbo.Orders as O
on O.OrderID=OD.OrderID
WHERE OD.UnitPrice>10 AND OD.Discount>0 AND YEAR(O.OrderDate)>=1997 AND O.ShippedDate IS NOT NULL
--512

--3 ZADATAK
--Iz tabele Proizvod dati pregled ukupnog broja ostvarenih narudzbi po dobavljaèu i proizvodu.

SELECT P.DobavljacID,P.ProizvodID,COUNT(P.DobavljacID) AS 'Broj narudzbi'
FROM Proizvod AS P
GROUP BY P.DobavljacID,P.ProizvodID
ORDER BY 1
--62

--4 ZADATAK
--Iz tabele Proizvod dati pregled ukupnog prometa ostvarenog po dobavljaèu i narudžbi uz uslov da se prikažu samo oni zapisi
--kod kojih je vrijednost prometa manja od 1000 i odobreni popust veæi od 10%. Ukupni promet izraèunati uz uzimanje u obzir i odobrenog popusta.

SELECT  P.DobavljacID,P.NarudzbaID,SUM(P.Cijena*P.Kolicina*(1-P.Popust)) AS Promet
FROM Proizvod AS P
WHERE P.Popust>0.1
GROUP BY P.DobavljacID,P.NarudzbaID
HAVING SUM(P.Cijena*P.Kolicina*(1-P.Popust))<1000 

--5 ZADATAK
--Iz tabele Narudzba dati pregled svih narudzbi kod kojih je broj dana od datuma narudžbe do datuma isporuke manji od 10. 
--Pregled æe se sastojati od ID narudžbe, broja dana razlike i kalendarske godine, 
--pri èemu je razdvojiti pregled po godinama - 1997 i 1998 (prvo sve 1997, zatim sve 1998).
--Sortirati po broju dana isporuke u opadajuæem redoslijedu.

SELECT NarudzbaID, DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) AS BrDanaIsporuke, YEAR (DatumIsporuke) AS Godina
FROM Narudzba
WHERE DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) < 10
ORDER BY 3, 2
--495

SELECT N.NarudzbaID, DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke) AS 'Broj dana razlike', '1997' AS 'Godina'
FROM Narudzba AS N
WHERE  DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke)<10 AND YEAR(N.DatumIsporuke)=1997
UNION
SELECT N.NarudzbaID, DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke) AS 'Broj dana razlike', '1998' AS 'Godina'
FROM Narudzba AS N
WHERE  DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke)<10 AND YEAR(N.DatumIsporuke)=1998
ORDER BY 2 DESC
--495



--6 ZADATAK
--Iz tabele Narudzba dati pregled svih narudzbi kod kojih je isporuka izvršena u istom mjesecu.
--Pregled æe se sastojati od ID narudžbe, broja dana razlike, mjeseca narudžbe, mjeseca isporuke i kalendarske godine, 
--pri èemu je potrebno razdvojiti pregled po godinama (1997 i 1998 - prvo sve 1997, zatim sve 1998). 
--Sortirati po broju dana isporuke u opadajuæem redoslijedu.

SELECT N.NarudzbaID, DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke) AS 'Broj dana razlike', 
       MONTH(N.DatumNarudzbe) AS 'Mjesec narudzbe',MONTH(N.DatumIsporuke) AS 'Mjesec isporuke','1997' AS 'Godina'
FROM Narudzba AS N
WHERE  MONTH(N.DatumNarudzbe)=MONTH(N.DatumIsporuke) AND YEAR(N.DatumIsporuke)=1997
UNION
SELECT N.NarudzbaID, DATEDIFF(DAY,N.DatumNarudzbe,N.DatumIsporuke) AS 'Broj dana razlike', 
       MONTH(N.DatumNarudzbe) AS 'Mjesec narudzbe',MONTH(N.DatumIsporuke) AS 'Mjesec isporuke','1998' AS 'Godina'
FROM Narudzba AS N
WHERE  MONTH(N.DatumNarudzbe)=MONTH(N.DatumIsporuke) AND YEAR(N.DatumIsporuke)=1998
ORDER BY 2 DESC
--464

SELECT NarudzbaID, DATEDIFF (DAY, DatumNarudzbe, DatumIsporuke) AS BrDanaIsporuke, MONTH (DatumIsporuke) AS MjesecNarudzbe,
MONTH (DatumNarudzbe) AS MjesecIsporuke, YEAR (DatumIsporuke) AS Godina
FROM Narudzba
WHERE MONTH (DatumIsporuke) = MONTH (DatumNarudzbe)
ORDER BY 5, 2




--7 ZADATAK
--Iz tabele Narudzba dati pregled svih narudžbi koje su isporuèene u Graz ili Köln. 
--Pregled æe se sastojati od ID narudžbe i naziva grada. Sortirati po nazivu grada.

SELECT N.PunaAdresa, RIGHT(N.PunaAdresa, CHARINDEX(' ',REVERSE(N.PunaAdresa))-1) AS 'Naziv grada'
FROM Narudzba AS N
WHERE RIGHT(N.PunaAdresa, CHARINDEX(' ',REVERSE(N.PunaAdresa))-1) IN('Graz', 'Köln')
ORDER BY 2


--8 ZADATAK
--Iz tabela Narudzba, Dobavljac i Proizvod kreirati pregled koji æe se sastojati od polja NarudzbaID,
--GodNarudzbe kao godinu iz polja DatumNarudzbe, NazivProizvoda, NazivDobavljaca, Drzava, TrosakPrevoza, 
--Ukupno kao ukupna vrijednost narudžbe koja æe se raèunati uz uzimanje u obzir i popusta i postotak koji æe
--davati informaciju o vrijednosti postotka troška prevoza u odnosu na ukupnu vrijenost narudžbe. Uslov je da 
--postotak bude veæi od 30% i da je ukupna vrijednost veæa od troška prevoza. Sortirati po vrijednosti postotka u opadajuæem redoslijedu.

SELECT N.NarudzbaID,YEAR(N.DatumNarudzbe) AS 'GodNarudzbe', P.NazivProizvoda,D.NazivDobavljaca,D.Drzava,N.TrosakPrevoza,
P.Cijena*P.Kolicina*(1-p.Popust) AS 'Ukupna vrijednost',
LEFT (ROUND (N.TrosakPrevoza / (P.Cijena * P.Kolicina * (1 - P.Popust)) * 100, 2),5) AS Postotak
FROM Proizvod AS P INNER JOIN 
     Narudzba AS N 
	 ON P.NarudzbaID=N.NarudzbaID
	 JOIN Dobavljac AS D
	 ON D.DobavljacID=P.DobavljacID
WHERE N.TrosakPrevoza / (P.Cijena * P.Kolicina * (1 - P.Popust)) * 100>30 AND P.Cijena*P.Kolicina*(1-p.Popust)>N.TrosakPrevoza
ORDER BY 8 DESC


--9 ZADATAK
--Iz tabela Narudzba, Dobavljac i Proizvod kreirati pogled koji æe sadržavati ID narudžbe, dan iz datuma prijema, 
--raspoloživost, naziv grada iz pune adrese naruèitelja i državu dobavljaèa.
--Uslov je da je datum prijema u 2. ili 3. dekadi mjeseca i da grad naruèitelja Bergamo.

CREATE VIEW view_9
AS
SELECT N.NarudzbaID, DAY(N.DatumPrijema) AS 'Dan', P.Raspolozivost,
N.PunaAdresa ,RIGHT(N.PunaAdresa, CHARINDEX(' ',REVERSE(N.PunaAdresa))-1) AS 'Naziv grada', d.Drzava
FROM Proizvod AS P
     INNER JOIN Narudzba AS N
	 ON P.NarudzbaID=N.NarudzbaID
	 INNER JOIN Dobavljac AS D
	 ON D.DobavljacID=P.DobavljacID
--WHERE DAY(N.DatumPrijema) BETWEEN 11 AND 31 AND RIGHT(N.PunaAdresa, CHARINDEX(' ',REVERSE(N.PunaAdresa))-1) = 'Bergamo'
SELECT*
FROM view_9
--7


--10 ZADATAK
--Iz tabela Proizvod i Dobavljac kreirati proceduru proc1 koja æe sadržavati ID i naziv dobavljaèa i ukupan broj proizvoda
--koji je realizirao dobavljaè. Pokrenuti proceduru za vrijednost ukupno realiziranog broja proizvoda 22 i 14.

ALTER PROCEDURE proc1
(
	@DobavljacID int = NULL,
	@NazivDobavljaca nvarchar(40) = NULL,
	@UkBroj int = NULL
)
AS
BEGIN
SELECT	P.DobavljacID, D.NazivDobavljaca, COUNT (P.ProizvodID) AS Broj
FROM	Proizvod AS P INNER JOIN Dobavljac AS D
ON		P.DobavljacID = D.DobavljacID
--WHERE	P.DobavljacID = @DobavljacID OR
--		NazivDobavljaca = @NazivDobavljaca OR
--		P.ProizvodID >= 0
GROUP BY P.DobavljacID, D.NazivDobavljaca
HAVING	COUNT (P.ProizvodID) = @UkBroj --OR @UkBroj IS NULL
END

EXEC proc1  @UkBroj=22


--1. Kroz SQL kod kreirati bazu podataka sa imenom vašeg broja indeksa.
CREATE DATABASE BB210006
GO
USE BB210006

--2. U kreiranoj bazi podataka kreirati tabele sa sljedeæom strukturom:
--a) Prodavaci
--• ProdavacID, cjelobrojna vrijednost i primarni kljuè
--• Ime, 50 UNICODE (obavezan unos)
--• Prezime, 50 UNICODE (obavezan unos)
--• OpisPosla, 50 UNICODE karaktera (obavezan unos)
--• EmailAdresa, 50 UNICODE karaktera

CREATE TABLE Prodavaci
(
ProdavacID INT NOT NULL PRIMARY KEY,
Ime NVARCHAR(50) NOT NULL,
Prezime NVARCHAR(50) NOT NULL,
OpisPosla NVARCHAR(50) NOT NULL,
EmailAdresa NVARCHAR(50)
)
--2.
--b) Proizvodi
--• ProizvodID, cjelobrojna vrijednost i primarni kljuè
--• Naziv, 50 UNICODE karaktera (obavezan unos)
--• SifraProizvoda, 25 UNICODE karaktera (obavezan unos)
--• Boja, 15 UNICODE karaktera ,
--• Cijena, novèani tip podatka (obavezan unos)
--• NazivPodkategorije, 50 UNICODE (obavezan unos)

CREATE TABLE Proizvodi
(
ProizvodID INT NOT NULL PRIMARY KEY,
Naziv NVARCHAR(50) NOT NULL,
SifraProizvoda NVARCHAR(25) NOT NULL,
Boja NVARCHAR(15),
Cijena MONEY NOT NULL,
NazivPodkategorije NVARCHAR(50) NOT NULL
)

--2.
--c) ZaglavljeNarudzbe 
--• NarudzbaID, cjelobrojna vrijednost i primarni kljuè
--• DatumNarudzbe, polje za unos datuma i vremena (obavezan unos)
--• DatumIsporuke, polje za unos datuma i vremena
--• NazivTeritorije, 50 UNICODE (obavezan unos)
--• ProdavacID, cjelobrojna vrijednost, strani kljuè

CREATE TABLE ZaglavljeNarudzbe
(
NarudzbaID INT NOT NULL PRIMARY KEY,
DatumNarudzbe DATETIME NOT NULL,
DatumIsporuke DATETIME,
NazivTeritorije NVARCHAR(50) NOT NULL,
ProdavacID  INT CONSTRAINT FK_ZaglavljeNarudzbe FOREIGN KEY REFERENCES Prodavaci(ProdavacID)
)

--2.
--d) DetaljiNarudzbe
--• NarudzbaID, cjelobrojna vrijednost, obavezan unos i strani kljuè
--• ProizvodID, cjelobrojna vrijednost, obavezan unos i strani kljuè
--• Cijena, novèani tip (obavezan unos),
--• Kolicina, skraæeni cjelobrojni tip (obavezan unos),
--• Popust, novèani tip (obavezan unos)
--**Jedan proizvod se može više puta naruèiti, dok jedna narudžba može sadržavati više proizvoda. U okviru jedne 
--narudžbe jedan proizvod se ne može naruèiti više od jedanput.

CREATE TABLE DetaljiNarudzbe
(
NarudzbaID INT NOT NULL CONSTRAINT FK_DetaljiNarudzbe_ZaglavljeNarudzbe FOREIGN KEY REFERENCES ZaglavljeNarudzbe(NarudzbaID),
ProizvodID INT NOT NULL CONSTRAINT FK_DetaljiNarudzbe_Proizvodi FOREIGN KEY REFERENCES Proizvodi(ProizvodID),
Cijena MONEY NOT NULL,
Kolicina SMALLINT NOT NULL,
Popust MONEY NOT NULL
PRIMARY KEY(NarudzbaID,ProizvodID)
)

--3. Iz baze podataka AdventureWorks u kreiranu bazu podataka prebaciti sljedeæe podatke:
--a) U tabelu Prodavaci dodati sve prodavaèe
--• BusinessEntityID (SalesPerson) -> ProdavacID
--• FirstName (Person) -> Ime
--• LastName (Person) -> Prezime
--• JobTitle (Employee) -> OpisPosla
--• EmailAddress (EmailAddress) -> EmailAdresa

INSERT INTO Prodavaci
SELECT SP.BusinessEntityID,PP.FirstName,PP.LastName,E.JobTitle,EA.EmailAddress
FROM AdventureWorks2014.Sales.SalesPerson AS SP
INNER JOIN AdventureWorks2014.Person.Person AS PP
ON SP.BusinessEntityID=PP.BusinessEntityID
INNER JOIN AdventureWorks2014.HumanResources.Employee AS E
ON E.BusinessEntityID=PP.BusinessEntityID
INNER JOIN AdventureWorks2014.Person.EmailAddress AS EA
ON EA.BusinessEntityID=PP.BusinessEntityID

--3.
--b) U tabelu Proizvodi dodati sve proizvode, na mjestima gdje nema pohranjenih podataka o boji zamijeniti 
--vrijednost sa nije naznaceno
--• ProductID (Product)-> ProizvodID
--• Name (Product)-> Naziv 
--• ProductNumber (Product)-> SifraProizvoda
--• Color (Product)-> Boja 
--• ListPrice (Product)-> Cijena
--• Name (ProductSubategory) -> NazivPodkategorije

INSERT INTO Proizvodi
SELECT PP.ProductID,PP.Name,PP.ProductNumber,ISNULL(PP.Color,0),PP.ListPrice,PS.Name
FROM AdventureWorks2014.Production.Product AS PP
INNER JOIN AdventureWorks2014.Production.ProductSubcategory AS PS
ON PP.ProductSubcategoryID=PS.ProductSubcategoryID

--3.
--c) U tabelu ZaglavljeNarudzbe dodati sve narudžbe
--• SalesOrderID (SalesOrderHeader) -> NarudzbaID
--• OrderDate (SalesOrderHeader)-> DatumNarudzbe
--• ShipDate (SalesOrderHeader)-> DatumIsporuke
--• Name (SalesTerritory) -> NazivTeritorije
--• SalesPersonID (SalesOrderHeader)-> ProdavacID

INSERT INTO ZaglavljeNarudzbe
SELECT SOH.SalesOrderID,SOH.OrderDate,SOH.ShipDate,ST.Name,SOH.SalesPersonID
FROM AdventureWorks2014.Sales.SalesOrderHeader AS SOH
INNER JOIN AdventureWorks2014.Sales.SalesTerritory AS ST
ON ST.TerritoryID=SOH.TerritoryID


--3.
--d) U tabelu DetaljiNarudzbe dodati sve stavke narudžbe
--• SalesOrderID (SalesOrderDetail)-> NarudzbaID
--• ProductID (SalesOrderDetail)-> ProizvodID
--• UnitPrice (SalesOrderDetail)-> Cijena
--• OrderQty (SalesOrderDetail)-> Kolicina
--• UnitPriceDiscount (SalesOrderDetail)-> Popust

INSERT INTO DetaljiNarudzbe
SELECT SOD.SalesOrderID ,SOD.ProductID ,SOD.UnitPrice,SOD.OrderQty,SOD.UnitPriceDiscount
FROM AdventureWorks2014.Sales.SalesOrderDetail AS SOD


--4.
--a) (6 bodova) Prikazati sve uposlenike koji rade na 3 ili više teritorija koje pripadaju regiji Eastern. Upitom 
--je potrebno prikazati spojeno ime i prezime uposlenika, te ukupan broj teritorija na koje su rasporeðeni. 
--(Northwind)

SELECT E.FirstName+ ' '+ E.LastName 'Ime i prezime', count(T.TerritoryID) as Ukupanbrojnarudzbi
FROM Northwind.dbo.Employees AS E
INNER JOIN Northwind.dbo.EmployeeTerritories AS ET
ON E.EmployeeID=ET.EmployeeID
INNER JOIN Northwind.dbo.Territories AS T
ON ET.TerritoryID=T.TerritoryID
INNER JOIN Northwind.dbo.Region AS R
ON T.RegionID=R.RegionID
WHERE T.TerritoryID>3 AND T.RegionID LIKE 'Eastern'
GROUP BY E.FirstName,E.LastName,T.TerritoryID

ORDER BY 2 DESC

--b) (7 bodova) U kreiranoj bazi kreirati pogled v_proizvodi koji æe prikazivati naziv i šifru proizvoda,
--ukupan broj prodanih proizvoda, te ukupnu vrijednost sa popustom. Rezultate sortirati prema ukupnoj 
--vrijednosti u opadajuæem redoslijedu.
USE BB210006
GO
CREATE VIEW v_proizvodi AS
SELECT P.Naziv,P.SifraProizvoda,SUM(DN.Kolicina)'ukupan broj prodanih',SUM(DN.Cijena*DN.Kolicina*(1-DN.Popust))'Ukupna vrijednost sa popustom'
FROM Proizvodi as P
INNER JOIN DetaljiNarudzbe AS DN
ON P.ProizvodID=DN.ProizvodID
GROUP BY  P.Naziv,P.SifraProizvoda
GO
SELECT*
FROM v_proizvodi
ORDER BY 4 DESC

--e) (13 bodova) Za svakog uposlenika pojedinaèno prikazati ukupan broj narudžbi koje su obradili. Uslov je 
--da su narudžbe kreirane u 2011 ili 2012 godini. Takoðer uzeti u obzir samo one narudžbe koje su 
--isporuèene u Veliku Britaniju, Kanadu ili Francusku. Rezultate sortirati prema broju narudžbi u 
--opadajuæem redoslijedu. (AdventureWorks2017)
USE AdventureWorks2017
SELECT E.BusinessEntityID,PP.FirstName+' '+PP.LastName'ime i prezime', COUNT(SOH.SalesOrderID) 'broj narudzbi'
FROM HumanResources.Employee AS E
INNER JOIN Sales.SalesPerson AS SP
ON E.BusinessEntityID=SP.BusinessEntityID
INNER JOIN Person.Person AS PP
ON PP.BusinessEntityID=E.BusinessEntityID
INNER JOIN Sales.SalesOrderHeader AS SOH
ON SOH.SalesPersonID=E.BusinessEntityID
INNER JOIN Sales.SalesTerritoryHistory AS STH
ON STH.TerritoryID=sp.BusinessEntityID
inner join Sales.SalesTerritory AS ST
ON STH.TerritoryID=ST.TerritoryID
group by E.BusinessEntityID
order by 3 desc

--f) (4 boda) Prikazati naziv dobavljaèa, adresu i državu dobavljaèa i nazive proizvoda koji pripadaju 
--kategoriji piæa i ima ih na stanju više od 30 komada. Rezultate upita sortirati po državama. (Northwind)

use Northwind
select
from Suppliers as s
inner join Products as p
on p.SupplierID=s.SupplierID
inner join Categories as c
on c.CategoryID=p.CategoryID



--5.
--a) (7 bodova) U kreiranoj bazi kreirati index kojim æe se ubrzati pretraga prema šifri i nazivu proizvoda.
--OBAVEZNO index testirati.

create index ix_searchproduct
on Proizvod(naziv,šifra)


SELECT*
FROM Proizvodi

go
--b) (8 bodova) Kreirati proceduru sp_insert kojom æe se vršiti unos detalja narudžbe. OBAVEZNO 
--proceduru pokrenuti
GO
CREATE PROCEDURE proc_insert
(
@NarudzbaID INT,
@ProizvodID int,
@Cijena MONEY ,
@Kolicina SMALLINT ,
@Popust MONEY
) AS BEGIN

INSERT INTO DetaljiNarudzbe VALUES (@NarudzbaID,@ProizvodID,@Cijena,@Kolicina,@Popust)


END





--1.   Kreirati bazu podataka pod nazivom ZadaciZaVjezbu.

CREATE DATABASE ZadaciZaVjezbu

GO

USE ZadaciZaVjezbu

 

--2.   U pomenutoj bazi kreirati tabelu Aplikanti koja æe sadržavati sljedeæe kolone: Ime, Prezime i Mjesto_roðenja. Sva navedena polja trebaju da budu tekstualnog tipa, te prilikom kreiranja istih paziti da se ne zauzimaju bespotrebno memorijski resursi.

CREATE TABLE Aplikanti

(

Ime NVARCHAR(10),

Prezime NVARCHAR(20),

MjestoRodjenja NVARCHAR(50)

)

--3.   U tabelu Aplikanti dodati kolonu AplikantID, te je proglasiti primarnim kljuèem tabele (kolona mora biti autonkrement)

ALTER TABLE Aplikanti

ADD AplikantID INT NOT NULL IDENTITY(1,1)

 

ALTER TABLE Aplikanti

ADD CONSTRAINT PK_Aplikant PRIMARY KEY(AplikantID)

--4.   U bazi ZadaciZaVjezbu kreirati tabelu Projekti koji æe sadržavati sljedeæe kolone: Naziv projekta, Akronim projekta, Svrha projekta i Cilj projekta. Sva polja u tabeli su tekstualnog tipa, te prilikom kreiranja istih paziti da se ne zauzimaju bespotrebno memorijski resursi. Sva navedena polja osim cilja projekta moraju imati vrijednost.

CREATE TABLE Projekti

(

NazivProjekta NVARCHAR(30) NOT NULL,

AkronimProjekta NVARCHAR(30) NOT NULL,

SvrhaProjekta NVARCHAR(150) NOT NULL,

CiljProjekta NVARCHAR(150)

 

)

--5.   U tabelu Projekti dodati kolonu Sifra projekta, te je proglasiti primarnim kljuèem tabele.

ALTER TABLE Projekti

ADD SifraProjekta NVARCHAR(30) PRIMARY KEY

--6.   U tabelu Aplikanti dodati kolonu projekatID koje æe biti spoljni kljuè na tabelu projekat.

ALTER TABLE Aplikanti

ADD ProjekatID NVARCHAR(30) NOT NULL CONSTRAINT FK_Aplikant_Projekti FOREIGN KEY REFERENCES Projekti(sifraProjekta)

--7.   U bazi podataka ZadaciZaVjezbu kreirati tabelu TematskeOblasti koja æe sadržavati sljedeæa polja tematskaOblastID, naziv i opseg. TematskaOblastID predstavlja primarni kljuè tabele, te se automatski uveæava. Sva definisana polja moraju imati vrijednost. Prilikom definisanja dužine polja potrebno je obratiti pažnju da se ne zauzimaju bespotrebno memorijski resursi.

CREATE TABLE TematskeOblasti

(

TematskaOblastID INT CONSTRAINT PK_TematskaOblast PRIMARY KEY,

Naziv NVARCHAR(50) NOT NULL,

Opseg NVARCHAR(150) NOT NULL

)

--8.   U tabeli Aplikanti dodati polje email koje je tekstualnog tipa i može ostati prazno.

ALTER TABLE Aplikanti

ADD Email NVARCHAR(50)

--9.   U tabeli Aplikanti obrisati mjesto roðenja i dodati polja telefon i matièni broj. Oba novokreirana polja su tekstualnog tipa i moraju sadržavati vrijednost.

ALTER TABLE Aplikanti

DROP COLUMN MjestoRodjenja

 

ALTER TABLE Aplikanti

ADD Telefon NVARCHAR(10) NOT NULL,

MaticniBroj NVARCHAR(13) NOT NULL --CONSTRAINT UQ_Aplikanti_MaticniBroj UNIQUE

--10.  Obrisati tabele kreirane u prethodnim zadacima

DROP TABLE Aplikanti, TematskeOblasti, Projekti

--11.  Obrisati kreiranu bazu

DROP DATABASE ZadaciZaVjezbu

 

 

 

--1.         Kreirati bazu Procedure_ i aktivirati je.

CREATE DATABASE Procedure_

GO

USE Procedure_

--2.         Kreirati tabelu Proizvodi te prilikom kreiranja uraditi insert podataka iz tabele Products baze Northwind.

SELECT*

INTO Proizvodi

FROM Northwind.dbo.Products

 

--3.         Kreirati proceduru sp_Insert_Proizvod kojom æe se u tabeli Proizvodi uraditi insert novog zapisa.

GO

CREATE PROCEDURE sp_Products_Insert

(

@ProductName NVARCHAR(40),

@SupplierID INT=NULL,

@CategoryID INT=NULL,

@QuantityPerUnit NVARCHAR (20)= NULL,

@UnitPrice MONEY= NULL,

@UnitsInStock SMALLINT= NULL,

@UnitsOnOrder SMALLINT= NULL,

@ReorderLevel SMALLINT= NULL,

@Discontinued BIT

)

AS

BEGIN

INSERT INTO Proizvodi

VALUES(@ProductName,@SupplierID,@CategoryID,@QuantityPerUnit,@UnitPrice,@UnitsInStock,@UnitsOnOrder,@ReorderLevel,@Discontinued)

END

GO

--4.         Kreirati dva testna sluèaja, u prvom poslati podatke u sva polja, u drugom samo u ona koja su obavezna.

EXEC sp_Products_Insert

  @ProductName='Mlijeko',

  @SupplierID=1,

  @CategoryID=1,

  @QuantityPerUnit=2,

  @UnitPrice=1.4,

  @UnitsInStock=30,

  @UnitsOnOrder=0,

  @ReorderLevel=1,

  @Discontinued=1

 

SELECT*

FROM Proizvodi

ORDER BY 1 DESC

 

EXEC sp_Products_Insert

  @ProductName='Brašno',

  @Discontinued=1

 

--5.         Kreirati proceduru sp_Proizvod_Update kojom æe se u tabeli Proizvodi uraditi update zapisa.

GO

CREATE OR ALTER PROCEDURE sp_Proizvod_Update

(

@ProductID INT,

@ProductName NVARCHAR(40),

@SupplierID INT=NULL,

@CategoryID INT=NULL,

@QuantityPerUnit NVARCHAR (20)= NULL,

@UnitPrice MONEY= NULL,

@UnitsInStock SMALLINT= NULL,

@UnitsOnOrder SMALLINT= NULL,

@ReorderLevel SMALLINT= NULL,

@Discontinued BIT

)

AS

BEGIN

UPDATE Proizvodi

SET

                ProductName=ISNULL(@ProductName,ProductName),

                SupplierID=ISNULL(@SupplierID,SupplierID),

                CategoryID=ISNULL(@CategoryID,CategoryID),

                QuantityPerUnit=ISNULL(@QuantityPerUnit,QuantityPerUnit),

                UnitPrice=ISNULL(@UnitPrice,UnitPrice),

                UnitsInStock=ISNULL(@UnitsInStock,UnitsInStock),

                UnitsOnOrder=ISNULL(@UnitsOnOrder,UnitsOnOrder),

                ReorderLevel=ISNULL(@ReorderLevel,ReorderLevel),

                Discontinued=ISNULL(@Discontinued,Discontinued)

                WHERE ProductID=@ProductID

END

GO

 

EXEC sp_Proizvod_Update

  @ProductID=76,

  @ProductName='New product',

  @SupplierID=2,

  @ReorderLevel=1,

  @Discontinued=1

 

SELECT *

FROM Proizvodi

ORDER BY 1 DESC

 

 

GO

CREATE OR ALTER PROCEDURE sp_Proizvod_Update

(

@ProductId INT,

@ProductName NVARCHAR(40)=NULL,

@SupplierID INT=NULL,

@CategoryID INT=NULL,

@QuantityPerUnit NVARCHAR(20)=NULL,

@UnitPrice MONEY=NULL,

@UnitsInStock SMALLINT=NULL,

@UnitsOnOrder SMALLINT=NULL,

@ReorderLevel SMALLINT=NULL,

@Discontinued BIT

)

AS

BEGIN

UPDATE Proizvodi

SET

ProductName=ISNULL(@ProductName,ProductName),

SupplierID=ISNULL(@SupplierID,SupplierID),

CategoryID=      ISNULL(@CategoryID,CategoryID),

QuantityPerUnit=ISNULL(@QuantityPerUnit,QuantityPerUnit),

UnitPrice=ISNULL(@UnitPrice,UnitPrice),

UnitsInStock=ISNULL(@UnitsInStock,UnitsInStock),

UnitsOnOrder=ISNULL(@UnitsOnOrder,UnitsOnOrder),

ReorderLevel=ISNULL(@ReorderLevel,ReorderLevel),

Discontinued=ISNULL(@Discontinued,Discontinued)

WHERE ProductID=@ProductId

END

--6.         Kreirati testni sluèaj za update zapisa kroz proceduru.

EXEC sp_Proizvod_Update

  @ProductName='Mlijeko',

  @SupplierID=1,

  @CategoryID=1,

  @UnitPrice=1.6,

  @UnitsInStock=30,

  @UnitsOnOrder=0,

  @Discontinued=1,

  @ProductID=78

 

--7          Kreirati proceduru sp_Proizvod_Delete kojom æe se u tabeli Proizvodi uraditi delete odreðenog zapisa.

 

GO

CREATE PROCEDURE sp_Proizvod_Delete

(

                @ProductID INT

)

AS

BEGIN

DELETE FROM Proizvodi

WHERE ProductID=@ProductID

END

GO

 

 

GO

CREATE PROCEDURE sp_Proizvod_Delete

(

@ProductID int

)

AS

BEGIN

DELETE FROM Proizvodi

WHERE ProductID=@ProductID

END

 

--8.         Kreirati testni sluèaj za brisanje proizvoda sa id-om 78.

EXEC sp_Proizvod_Delete @ProductId=78

 

--9.         Kreirati tabelu StavkeNarudzbe te prilikom kreiranja uraditi insert podataka iz tabele Order Details baze Northwind.

SELECT*

INTO StavkeNarudzbe

FROM Northwind.dbo.[Order Details]

--10.      Kreirati proceduru sp_StavkeNarudzbe_Proizvodi_InsertUpdate kojom æe se u tabeli StavkeNarudzbe dodati nova stavka narudžbe a u tabeli Proizvodi umanjiti stanje za zalihama.

GO

CREATE PROCEDURE sp_StavkeNarudzbe_Proizvodi_InsertUpdate

(

@OrderID int,

@ProductID int,

@UnitPrice money,

@Quantity smallint,

@Discount real

)

AS

BEGIN

INSERT INTO StavkeNarudzbe

VALUES(@OrderID,@ProductID,@UnitPrice,@Quantity,@Discount)

 

UPDATE Proizvodi

SET UnitsInStock=UnitsInStock-@Quantity

WHERE ProductID=@ProductID

END

--11.      Kreirati testni sluèaj za prethodno kreiranu proceduru.

EXEC sp_StavkeNarudzbe_Proizvodi_InsertUpdate 10248,1,5,4,0.1

 

SELECT*

FROM StavkeNarudzbe

WHERE OrderID=10248

 

SELECT*

FROM Proizvodi

--12.      Kreirati proceduru kojom æe se u tabeli Proizvodi uraditi select proizvoda prema nazivu proizvoda i ID kategorije. Ukoliko korisnik ne unese ništa od navedenog prikazati sve proizvode.

GO

CREATE PROCEDURE sp_Proizvodi_SelectByProductNameOrCategoryID

(

@ProductName NVARCHAR(40)=NULL,

@CategoryID INT=NULL

)

AS

BEGIN












"
37urVYcJ,BWR - Changelog 17/09/23,SSilver,Diff,Sunday 17th of September 2023 04:52:21 PM CDT,"Melee
+ Hit registration made more consistent due to interaction with certain plugins
On-Kill Effects
+ Properly credits on-kill effects for ""honorbound"" mechanics when finishing off enemies
Buildings
~ Teleporter/dispenser health while building should match progress
Quick-Fix
~ Ubercharge automatically sets mirroring on, now properly healing the user
Eviction Notice
+ Fixed damage vulnerability being active before first drawing them
Buffalo Steak Sandvich
+ Fixed bug with attempting to switch to disabled weapon ending the buff early
Some fixing of unintended bugs on the server to make these mechanics more consistent.

Cloak and Dagger
+ Removed hidden slower cloak speed
A fix to a hidden downside to the weapon to make it consistent with stock.

Solemn Vow
+ Removed No Random Crits
+ Removed firing speed penalty
- Added -10% slower move speed while active
- Added +50% extra push force taken from damage while active
The prior downsides weren't didn't fit the intended design. With these downsides, it would be decently more difficult to engage in melee combat with the movement inhibitors and without a direct damage nerf, and with some skill the extra damage force could be used to help surf damage to escape.

Disciplinary Action
+ Removed holster speed penalty
- Added +40% blast damage from rocket jumps
Simply making it clunkier to use didn't much affect the huge benefit of using it, and any further melee combat buffs simply wouldn't impact that either. Instead, the added mobility you and your team are given was balanced against a downside that costs you your core mobility option in rocket jumping, requiring you consider your health more in making jumps or use something like gunboats which synergize less with the team support aspect of this weapon.

Conniver's Kunai
- Max HP regen reduced to 2/s (from 3/s)
The downside after one stab didn't appear to have an impact when making a single stab and escaping with the overheal, due to the high speed your health is restored.

Southern Hospitality
- Reduced extra dispenser range to +300% (from +350%)
A nerf meant to rein in the range to something more reasonable, matching the range limit seen in MvM.

Crusader's Crossbow
- Increased max primary ammo penalty to -90% (was -75%)
A simple nerf meant to make the use of the weapon require more ammo maintenance, and make each bolt less disposable to spam.

Vaccinator
~ Reverting all prior changes
+ Increased uber build speed to +100% (was +67%)
+ Increased uber duration to 3 seconds (was 2.5s)
+ Uber effects remains on user while switching weapons
- Removed passive resistances
- Decreased uber's base damage resistance to 33% (was 75%)
- Cannot capture objectives under uber effects
The intent with these changes is to specialize the weapon into its uber’s disposable nature at the cost of the massive resistance it provides to counter individual enemies. With an even faster uber rate, the Medic is encouraged to spend their bubbles more proactively rather than reactively, preferably in place in waiting for the slow overheal building."
Ym0egMQP,برطبو,NoorTFM,Lua,Sunday 17th of September 2023 04:52:06 PM CDT,"
local player = {}
function main()
    for n in next, tfm.get.room.playerList do
        player[n] = {clickonSpace = false}
        for a, k in next,{32, 70} do
            tfm.exec.bindKeyboard(n, k, true,true)
            tfm.exec.bindKeyboard(n, k, false,true)
        end
    end
end

main()

function eventKeyboard(name,k,down)
    if player[name] then
        if k == 32 and down then
             player[name].clickonSpace = true
        elseif k == 32 and not down then
            player[name].clickonSpace = false
        end
        if player[name].clickonSpace and k == 70 and down then
            if not player[name].timer or player[name].timer + 3000 < os.time() then
                local thing =   {objectid = 34, name = ""Poop"", img = {""18a5851f2b3.png"", 10, 9}, speedx = 20, speedy = 5}
                local p = tfm.exec.addShamanObject(10, 500, 100, 0,0 , 0, false)
                tfm.exec.addImage(thing.img[1] , ""#"" .. p , -thing.img[2], -thing.img[3], nil, thing.scale or 1, (thing.scale or 1)) 
                player[name].timer = os.time()
            end
        end
    end
end"
cZe5RLkM,Untitled,dracz3,Python,Sunday 17th of September 2023 04:43:23 PM CDT,"import math

y0 = math.sqrt(2) - 1
a0 = 6 - (4 * math.sqrt(2))


def f(y):
    fy= (1 - (y**4)) ** (0.25)
    return fy


def calculate_y_kp1(k):
    return (1 - f(y[k])) / (1 + f(y[k]))


def calculate_a_kp1(k):
    return (a[k] * (1 + y[k+1]) ** 4) - (2 ** (2*k+3) * y[k+1] * (1 + y[k+1] + (y[k+1] ** 2)))



y = [y0]
a = [a0]
est = []
for k in range(15):
    y.append(calculate_y_kp1(k))
    a.append(calculate_a_kp1(k))
    est.append(1/a[k+1])
    
print(est)"
TF8FfEVM,Untitled,simkoG,PHP,Sunday 17th of September 2023 04:14:55 PM CDT,"<?php

add_filter( 'generate_article_microdata', '__return_empty_string' );
"
CmLKbFUx,Generatepress CreativeWork,simkoG,PHP,Sunday 17th of September 2023 03:56:28 PM CDT,"<?php

add_filter( 'generate_article_itemtype', 'acme_generate_article_itemtype' );
function acme_generate_article_itemtype( $type ) {
	return ""EZT_KELL_ATIRNI"";
}
"
5TNwieRC,Design Shop Order Status Example,4N5H64M3R,HTML,Sunday 17th of September 2023 03:53:21 PM CDT,"<center style=""max-height: 400px; overflow-y: scroll""><table border=""1"" style=""border-collapse: collapse; border: 1px solid black"" cellpadding=""5""><tbody><tr><th>Order</th><th>Order Info</th><th>Orderer</th><th>Status</th><th>Message/Note(s) from designer</th></tr><tr><td>Item purchased from the roomshop</td><td>Info given by orderer (like what they want)</td><td>Username of person who purchased the item</td><td>Status (with a link if completed)</td><td>Message or note from designer for the orderer</td></tr></tbody></table></center>"
FrQeW9Dm,Horor_CPP5_Done,Neo_Feo,C,Sunday 17th of September 2023 03:52:17 PM CDT,"#include <stdio.h>
#include <math.h>

int factorial(short num){
    int isNegativ = 0, result = 1;
    if(num == 0)
        return 1;
    if(num<0){
        isNegativ = 1;
        num*=-1;
    }

    for(int i = 1; i <= num; ++i)
        result *= i;

    return  isNegativ ? result*-1 : result;
}

int main()
{
    int num;
    printf(""introduceti numarul al carui factorial doriti sa-l aflati: "");
    scanf(""%i"",&num);
    printf(""factorialul numarului %d este %d"",num,factorial(num));
    //printf(""g=%d"",factorial(-4));
    return 0;
}
"
i1ZWuXrM,Horor_CPP4_Done,Neo_Feo,C,Sunday 17th of September 2023 03:38:52 PM CDT,"#include <stdio.h>
#include <string.h>
#include <stdlib.h>

void scanWord(char ** buff){
    char *buffer = NULL;
    size_t bufsize = 0;
    ssize_t bytesRead = getline(&buffer, &bufsize, stdin);

    if (bytesRead == -1) {
        perror(""getline"");
        return;
    }

    *buff = (char *) malloc(bytesRead * sizeof(char));
    strcpy(*buff,buffer);
    free(buffer);
}

int main()
{
    char * word1, * word2;

    char* buff = NULL;
    printf(""Introduceti primul cuvant: "");
    scanWord(&word1);

    printf(""Introduceti al doilea cuvant: "");
    scanWord(&word2);

    size_t lenght1 = strlen(word1);
    size_t lenght2 = strlen(word2);

    if(lenght1 > lenght2){
        printf(""Primul cuvant este cel mai lung"");
    }else{
        printf(""Al doilea cuvant este cel mai lung"");
    }

    free(word1);
    free(word2);
    return 0;
}
"
EwGyGe2H,Easter Party,Spocoman,C++,Sunday 17th of September 2023 03:37:37 PM CDT,"#include <iostream>
#include <iomanip>

using namespace std;

int main() {
    int guest;
    cin >> guest;

    double envelope, budget;
    cin >> envelope >> budget;

    double sum = guest * envelope;

    if (guest >= 10 && guest <= 15) {
        sum *= 0.85;
    }
    else if (guest > 15 && guest <= 20) {
        sum *= 0.80;
    }
    else if (guest > 20) {
        sum *= 0.75;
    }

    sum += budget / 10;

    if (budget >= sum) {
        cout << ""It is party time! "" << fixed << setprecision(2) << budget - sum << "" leva left.\n"";
    }
    else {
        cout << ""No party! "" << fixed << setprecision(2) << sum - budget << "" leva needed.\n"";
    }
    return 0;
}"
sYj404Mn,Easter Lunch,Spocoman,C++,Sunday 17th of September 2023 03:30:00 PM CDT,"#include <iostream>
#include <iomanip>

using namespace std;

int main() {
    int easterBreads, eggPacks, cookies;
    cin >> easterBreads >> eggPacks >> cookies;

    double sum = 3.20 * easterBreads + 4.35 * eggPacks  + 5.4 * cookies + 0.15 * 12 * eggPacks;

    cout << fixed << setprecision(2) << sum << endl;
    return 0;
}"
Z2z6ncx3,Easter Guests,Spocoman,C++,Sunday 17th of September 2023 03:23:24 PM CDT,"#include <iostream>
#include <iomanip>
#include <cmath>

using namespace std;

int main() {
    double guests, budget;
    cin >> guests >> budget;

    budget -= ceil(guests / 3) * 4 + guests * 2 * 0.45;

    if (budget < 0) {
        cout << ""Lyubo doesn't have enough money.\n""
            << ""He needs "" << fixed << setprecision(2) << abs(budget) << "" lv. more.\n"";
    }
    else {
        cout << ""Lyubo bought "" << ceil(guests / 3) << "" Easter bread and "" << guests * 2 << "" eggs.\n""
            << ""He has "" << fixed << setprecision(2) << budget << "" lv. left.\n"";
    }
    return 0;
}"
csqDiGzv,Advanced Discord.JS Polls command,document10,JavaScript,Sunday 17th of September 2023 03:04:50 PM CDT,"const { SlashCommandBuilder, EmbedBuilder ,CommandInteraction,Client} = require('discord.js');

module.exports = {
	data: new SlashCommandBuilder()
		.setName('poll')
		.setDescription('Creates a poll with up to ten options')
        .addStringOption(option => option.setName('title')
            .setDescription('The title of the poll')
            .setRequired(true)
        )
        .addStringOption(option => option.setName('option1')
            .setDescription('First option (required)')
            .setRequired(true)
        )
        .addStringOption(option => option.setName('option2')
            .setDescription('Second option (required)')
            .setRequired(true)
        )
        .addStringOption(option => option.setName('option3')
            .setDescription('Third option')
        )
        .addStringOption(option => option.setName('option4')
            .setDescription('Fourth option')
        )
        .addStringOption(option => option.setName('option5')
            .setDescription('Fifth option')
        )
        .addStringOption(option => option.setName('option6')
            .setDescription('Sixth option')
        )
        .addStringOption(option => option.setName('option7')
            .setDescription('Seventh option')
        )
        .addStringOption(option => option.setName('option8')
            .setDescription('Eighth option')
        )
        .addStringOption(option => option.setName('option9')
            .setDescription('Ninth option')
        )
        .addStringOption(option => option.setName('option10')
            .setDescription('Tenth option')
        )
        .addStringOption(option => option.setName('mode')
            .setDescription('The mode to show options in')
            .addChoices(
                {
                    name:""Numbers"",
                    value:""num""
                },
                {
                    name:""Letters"",
                    value:""li""
                },
                {
                    name:""Circles"",
                    value:""cir""
                },
                {
                    name:""Squares"",
                    value:""sq""
                },
                {
                    name:""Hearts"",
                    value:""hea""
                },
                {
                    name:""Books"",
                    value:""book""
                }
            )
        )
        .addRoleOption(option => option.setName('role')
                .setDescription('Role to mention when the poll is sent')
                .setRequired(false)
        )
        ,
	category:'utility',
	/**
     * @param {Client} client
     * @param {CommandInteraction} interaction 
     */
	async execute(client,interaction) {
        await interaction.reply({content:'Creating poll,please wait',ephemeral:true})
        //reactions
		const num = ['1️⃣','2️⃣','3️⃣','4️⃣','5️⃣','6️⃣','7️⃣','8️⃣','9️⃣','🔟']
        const li = ['🇦','🇧','🇨','🇩','🇪','🇫','🇬','🇭','🇮','🇯']
        const cir = ['🔴','🟢','🔵','🟡','🟣','🟤','🟠','⚪','⚫','🔘']
        const sq = ['🟥','🟩','🟦','🟨','🟪','🟫','🟧','⬜','⬛','⏹️']
        const hea = ['❤️','💚','💙','💛','💜','🤎','🧡','🤍','🖤','💟']
        const book = ['📕','📗','📘','📒','📔','📙','📓','🔖','🗒️','📚']
        const title = interaction.options.getString('title',true)
        //command options
		const role = interaction.options.getRole('role',false)
        var mention = """"
        if(role) mention = `<@&${role.id}>`
        var params = [interaction.options.getString('option1',true),interaction.options.getString('option2',true)]
        var el = """"
        var mode = interaction.options.getString(`mode`,false) || 'num'
        var desc = """"
        var options = new Map()
        var i;
        for (i = 3; i < 11; i++) {
            el = interaction.options.getString(`option${i}`,false)
            if(el)params.push(el)
        }
        switch (mode) {
            case 'num':
                params.forEach((p,i) => {
                    options.set(p,num[i])
                })
                break;
            case 'li':
                params.forEach((p,i) => {
                    options.set(p,li[i])
                })
                break;
            case 'cir':
                params.forEach((p,i) => {
                    options.set(p,cir[i])
                })
                break;
            case 'sq':
                params.forEach((p,i) => {
                    options.set(p,sq[i])
                })
                break;
            case 'hea':
                params.forEach((p,i) => {
                    options.set(p,hea[i])
                })
                break;
            case 'book':
                params.forEach((p,i) => {
                    options.set(p,book[i])
                })
                break;
            default:
                break;
        }
        options.forEach((v,k)=>{
            desc += `${v} : ${k}\n`
        })
        const embed = new EmbedBuilder()
            .setTitle(title)
            .setAuthor({name:interaction.user.username,iconURL:interaction.user.displayAvatarURL()})
            .setDescription(desc)
            .setColor('#0000ff')
            .setTimestamp()
        const msg = await interaction.channel.send({content:mention,embeds:[embed]})
        options.forEach(async (v,k)=>{
            await msg.react(v)
        })
	},
};
"
87TG0197,Easter Eggs Battle,Spocoman,C++,Sunday 17th of September 2023 03:03:29 PM CDT,"#include <iostream>

using namespace std;

int main() {
    int firstPlayer, secondPlayer;
    cin >> firstPlayer >> secondPlayer;

    string command;
    cin >> command;

    while (command != ""End"") {
        if (command == ""one"") {
            secondPlayer--;
            if (secondPlayer == 0) {
                cout << ""Player two is out of eggs. Player one has "" << firstPlayer << "" eggs left.\n"";
                break;
            }
        }
        else if (command == ""two"")
        {
            firstPlayer--;
            if (firstPlayer == 0)
            {
                cout << ""Player one is out of eggs. Player two has "" << secondPlayer << "" eggs left.\n"";
                break;
            }
        }
        cin >> command;
    }

    if (command == ""End"") {
        cout << ""Player one has "" << firstPlayer << "" eggs left.\n""
            << ""Player two has "" << secondPlayer << "" eggs left.\n"";
    }
    return 0;
}

Решение с тернарен оператор:

#include <iostream>

using namespace std;

int main() {
    int firstPlayer, secondPlayer;
    cin >> firstPlayer >> secondPlayer;

    string command;
    cin >> command;

    while (command != ""End"") {
        command == ""one"" ? secondPlayer-- : firstPlayer--;

        if (firstPlayer == 0 || secondPlayer == 0) {

            cout << ""Player "" << (firstPlayer == 0 ? ""one"" : ""two"")
                << "" is out of eggs. Player "" << (firstPlayer > 0 ? ""one"" : ""two"")
                << "" has "" << (firstPlayer > 0 ? firstPlayer : secondPlayer) << "" eggs left.\n"";
            break;
        }
        cin >> command;
    }

    if (command == ""End"") {
        cout << ""Player one has "" << firstPlayer << "" eggs left.\n""
            << ""Player two has "" << secondPlayer << "" eggs left.\n"";
    }
    return 0;
}"
xhnuixJq,Easter Eggs,Spocoman,C++,Sunday 17th of September 2023 02:39:13 PM CDT,"#include <iostream>

using namespace std;

int main() {
    int volume, red = 0, orange = 0, blue = 0, green = 0, maxCount = 0;
    cin >> volume;

    string color, maxColor = """";

    for (int i = 0; i < volume; i++) {
        cin >> color;
        if (color == ""red"") {
            red++;
        }
        else if (color == ""orange"") {
            orange++;
        }
        else if (color == ""blue"") {
            blue++;
        }
        else if (color == ""green"") {
            green++;
        }
    }
    if (red > orange && red > blue && red > green) {
        maxCount = red;
        maxColor = ""red"";
    }
    else if (orange > blue && orange > green && orange > red) {
        maxCount = orange;
        maxColor = ""orange"";
    }
    else if (blue > green && blue > red && blue > orange) {
        maxCount = blue;
        maxColor = ""blue"";
    }
    else {
        maxCount = green;
        maxColor = ""green"";
    }

    cout << ""Red eggs: "" << red << endl
        << ""Orange eggs: "" << orange << endl
        << ""Blue eggs: "" << blue << endl
        << ""Green eggs: "" << green << endl
        << ""Max eggs: "" << maxCount << "" -> "" << maxColor << endl;

    return 0;
}

РЕШЕНИЕ С МАР И FOR(EACH):

#include <iostream>
#include <map>

using namespace std;

int main() {
    map <string, int> eggInfo = { {""red"",0},{""orange"",0},{""blue"",0},{""green"",0} };

    int volume, maxCount = 0;
    cin >> volume;

    string color, maxColor = """";

    for (int i = 0; i < volume; i++) {
        cin >> color;
        eggInfo[color]++;
    }

    for (auto& egg : eggInfo) {
        if (egg.second > maxCount) {
            maxColor = egg.first;
            maxCount = egg.second;
        }
    }

    cout << ""Red eggs: "" << eggInfo[""red""] << endl
        << ""Orange eggs: "" << eggInfo[""orange""] << endl
        << ""Blue eggs: "" << eggInfo[""blue""] << endl
        << ""Green eggs: "" << eggInfo[""green""] << endl
        << ""Max eggs: "" << maxCount << "" -> "" << maxColor << endl;

    return 0;
}"
52k5XpQu,Untitled,Salvens,C++,Sunday 17th of September 2023 02:16:01 PM CDT,"#include <bits/stdc++.h>

//#include <ext/pb_ds/assoc_container.hpp>
//using namespace __gnu_pbds;

using namespace std;

#define int long long
#define IOS ios::sync_with_stdio(false); cin.tie(0); cout.tie(0);

const long long INF = 1e18 + 7;
const double EPS = 1e-6;
const int MAXN = 1e5 + 100;
const int MOD = 1e9 + 7;

vector<int> a;
int n, k;

bool check(int x) {
    multiset<int> st;
    for (int i = 0; i < k; ++i) {
        st.insert(a[i]);
    }
    for (int i = 0; i + k < n; ++i) {
        st.insert(a[i + k]);
        if (st.lower_bound(x) == st.end()) {
            return false;
        }
        st.erase(st.find(a[i]));
    }
    return true;
}

inline void solve() {
    cin >> n >> k;
    a.resize(n);
    for (int i = 0; i < n; ++i) {
        cin >> a[i];
    }

    int l = 0, r = 1e5 + 1;
    while (r - l > 1) {
        int mid = (r + l) / 2;
        if (check(mid)) {
            l = mid;
        } else {
            r = mid;
        }
    }
    cout << l << '\n';
}



int32_t main() {
    IOS;

    int tt = 1;
//    cin >> tt;
    while (tt--) {
        solve();
    }
    return 0;
}

"
hK6tDfuq,Untitled,DenCoder618,Python,Sunday 17th of September 2023 01:37:14 PM CDT,"def frequency_analysis(text):
    frequencies = dict()
    total_chars = 0

    for char in text:
        if char.isalpha():
            char = char.lower()
            frequencies[char] = frequencies.get(char, 0) + 1
            total_chars += 1

    items = frequencies.items()
    for char, count in sorted(items, key=lambda i: i[0]):
        frequency = count / total_chars * 100
        print(f""{char}: {frequency:.2f}%"")"
DEPeDiGy,Easter Decoration,Spocoman,C++,Sunday 17th of September 2023 01:32:38 PM CDT,"#include <iostream>
#include <string>

using namespace std;

int main() {
    int clients;
    cin >> clients;
    cin.ignore();

    string stock;

    double totalSum = 0;

    for (int i = 0; i < clients; i++) {
        getline(cin, stock);

        int counter = 0;
        double sum = 0;

        while (stock != ""Finish"") {

            if (stock == ""basket"") {
                sum += 1.50;
            }
            else if (stock == ""wreath"") {
                sum += 3.80;
            }
            else if (stock == ""chocolate bunny"") {
                sum += 7.00;
            }

            getline(cin, stock);
            counter++;
        }

        if (counter % 2 == 0) {
            sum *= 0.80;
        }

        totalSum += sum;
        printf(""You purchased %i items for %.2f leva.\n"", counter, sum);
    }
    printf(""Average bill per client is: %.2f leva.\n"", totalSum / clients);

    return 0;
}"
JdnZG01i,邀您一起看：小祥(7),xiaomianao666,JavaScript,Sunday 17th of September 2023 01:29:33 PM CDT,海阔视界规则分享，当前分享的是：二级页面详情￥page_detail￥小祥(7)@@eyJkYXRhIjoie1wiYXNzb2NpYXRlZE1vZGVsc01hcEZvckpvaW5UYWJsZVwiOnt9LFwiYXNzb2NpYXRlZE1vZGVsc01hcFdpdGhGS1wiOnt9LFwiYXNzb2NpYXRlZE1vZGVsc01hcFdpdGhvdXRGS1wiOnt9LFwiZmllbGRzVG9TZXRUb0RlZmF1bHRcIjpbXSxcImdtdE1vZGlmaWVkXCI6MCxcImlkXCI6MCxcImxhc3RfY2hhcHRlcl9ydWxlXCI6XCJcIixcImxpc3RUb0NsZWFyQXNzb2NpYXRlZEZLXCI6W10sXCJsaXN0VG9DbGVhclNlbGZGS1wiOltdLFwicGFnZUxpc3RcIjpbe1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuW3peWFt1wiLFwicGF0aFwiOlwidXRpbGl5XCIsXCJydWxlXCI6XCJqczpcXG5sZXQgaG9zdCA9IFxcXCJodHRwOi8vaGlrZXIubm9raWEucHJlc3NcXFwiO1xcbi8vbGV0IGhvc3QgPSBcXFwiaHR0cDovLzE5Mi4xNjguMy45NDo4MDc5XFxcIjtcXG5sZXQgaG9tZSA9IGJhc2U2NERlY29kZShcXFwiYUdsclpYSTZMeTlvYjIxbFxcXCIpO1xcbnZhciBhcGkgPSB7XFxuICAgIGhvc3Q6IGhvc3QrXFxcIi9oaWtlcnVsZVxcXCIsXFxuICAgIHVzZXJzVXJsOiBcXFwiL2Rldi91c2Vycz9vcmRlcj1cXFwiLCAvL+eUqOaIt+WIl+ihqFxcbiAgICBydWxlQ291bnRVcmw6IFxcXCIvZGV2L3J1bGVjb3VudFxcXCIsIC8v6I635Y+W6KeE5YiZ5pWw6YePXFxuICAgIHJ1bGVzVXJsOiBcXFwiL2Rldi9nZXRcXFwiLCAvL+eUqOaIt+WvueW6lOeahOinhOWImeWIl+ihqOS7heS7heiOt+WPluWFrOW8gFxcbiAgICBydWxlc0FsbFVybDogXFxcIi9kZXYvZ2V0YWxsXFxcIiwgLy/lvIDlj5HogIXlr7nlupTnmoTop4TliJnliJfooajlj6/ojrflj5bnp4HmnIlcXG4gICAgZGV2U2VsZjonL2Rldi9nZXRzZWxmJywvL+iOt+WPluW8gOWPkeiAheS/oeaBr1xcbiAgICBtYW5DYW5VcGxvYWQ6Jy9zZXRfY2FuX3VwbG9hZC8nLC8v6LaF566h6K6+572u5byA5Y+R6ICF5piv5ZCm5Y+v5LiK5LygXFxuICAgIG1hblJ1bGVTYWZlOicvc2V0X3J1bGVfc2FmZS8nLC8v6LaF566h6K6+572u6KeE5YiZ5a6J5YWo5oCnXFxuICAgIG1hblJ1bGVHb29kOicvc2V0X3J1bGVfZ29vZC8nLC8v6LaF566h6K6+572u6KeE5YiZ5LyY6LSo5oCnXFxuICAgIGltcG9ydFVybDogXFxcIi9ydWxlbGlzdC5qc29uP2lkPVxcXCIsIC8v6KeE5YiZ6K+m5oOF5Y+v5a+85YWlXFxuICAgIGluZm9TZXRVcmw6IFxcXCIvZGV2L3NldF9pbmZvXFxcIixcXG4gICAgbm93Q29uVXJsOiBcXFwiL3NxbF9pbmZvL2dldF9ub3dfY29uXFxcIixcXG4gICAgaW5mb0dldFVybDogXFxcIi9kZXYvZ2V0X2luZm8/bmFtZT1cXFwiLFxcbiAgICBzZXR0aW5nc0dldFVybDogXFxcIi9kZXYvZ2V0X3NldHRpbmdzP25hbWU9XFxcIixcXG4gICAgZ3VwbG9hZDogXFxcIi9kZXYvZ3VwbG9hZFxcXCIsXFxuICAgIGd0aW1lb3ZlcjogXFxcIi9kZXYvZ3RpbWVvdmVyXFxcIixcXG4gICAgZ2V0YnlpZDogXFxcIi9kZXYvZ2V0YnlpZFxcXCIsXFxuICAgIHJ1bGVMaXN0SnNvbjogXFxcIi9ydWxlbGlzdC5qc29uXFxcIixcXG4gICAgYXV0aDogXFxcIi9kZXYvZ2V0X2F1dGhcXFwiLFxcbiAgICB0aW1lb3ZlcjogXFxcIi9kZXYvdGltZW92ZXJcXFwiLFxcbiAgICBzaGFyZTogXFxcIi9kZXYvc2hhcmVcXFwiLFxcbiAgICBnZW5BdXRoOiBcXFwiL2Rldi9nZW5fYXV0aFxcXCIsXFxuICAgIGRlbGV0ZVVybDogXFxcIi9kZXYvZGVsZXRlXFxcIixcXG4gICAganNvbkxpc3Q6IFxcXCIvZGV2L2pzb25fbGlzdFxcXCIsXFxuICAgIHNlYXJjaDogXFxcIi9kZXYvc2VhcmNoXFxcIixcXG4gICAgbmV3X2RldjogXFxcIi9kZXZfcmVnaXN0L25ld1xcXCIsXFxuICAgIG5ld19nZXRJZDogXFxcIi9kZXZfcmVnaXN0L2dldF9pZFxcXCIsXFxuICAgIG5ld19jb25maXJtOiBcXFwiL2Rldl9yZWdpc3QvY29uZmlybVxcXCIsXFxuICAgIG1vZGlmeV9wd2Q6IFxcXCIvbW9kaWZ5L3Bhc3N3b3JkXFxcIixcXG4gICAgbW9kaWZ5X25hbWU6IFxcXCIvbW9kaWZ5L25hbWVcXFwiLFxcbiAgICBtb2RpZnlfYXZhOiBcXFwiL21vZGlmeS9hdmF0YXJcXFwiLFxcbiAgICB1c2VyOiBcXFwiL2Rldi91c2VyL1xcXCIsXFxuICAgIGdldF9ydWxlX25vdGU6IFxcXCIvbW9kaWZ5L2dldF9ydWxlX25vdGUvXFxcIixcXG4gICAgc2V0X3J1bGVfcGljOiBcXFwiL21vZGlmeS9ydWxlX3BpYy9cXFwiLFxcbiAgICBzZXRfcnVsZV9ub3RlOiBcXFwiL21vZGlmeS9ydWxlX25vdGUvXFxcIlxcbn1cXG4kLmV4cG9ydHMucmFuZ2UgPSBmdW5jdGlvbihtLCBuKSB7XFxuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobSAtIG4gKyAxKSArIG4pO1xcbn1cXG4kLmV4cG9ydHMubWFwQ29sVHlwZSA9IGZ1bmN0aW9uKHRhcmdldCwgdHlwZSwgbikge1xcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xcbiAgICAgICAgdGFyZ2V0LnB1c2goe1xcbiAgICAgICAgICAgIGNvbF90eXBlOiB0eXBlXFxuICAgICAgICB9KTtcXG4gICAgfVxcbn1cXG52YXIgZ2V0QXBpID0gZnVuY3Rpb24oaykge1xcbiAgICByZXR1cm4gYXBpLmhvc3QgKyBhcGlba107XFxufTtcXG4kLmV4cG9ydHMuZ2V0QXBpPWdldEFwaTtcXG4kLmV4cG9ydHMubWQ9Z2V0QXBpKCdpbXBvcnRVcmwnKStcXFwiMzE4N1xcXCI7XFxuJC5leHBvcnRzLmxvY2FsUnVsZVZlciA9IGZ1bmN0aW9uKGxvY2FsUnVsZUxpc3QsIHJ1bGUpIHtcXG4gICAgbGV0IGxvY2FsUnVsZTtcXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NhbFJ1bGVMaXN0Lmxlbmd0aDsgaSsrKSB7XFxuICAgICAgICBsZXQgaXRlbSA9IGxvY2FsUnVsZUxpc3RbaV07XFxuICAgICAgICBsZXQgYXUgPSBpdGVtLmF1dGhvciB8fCBcXFwiXFxcIjtcXG4gICAgICAgIGxldCBzYW1lQXU9YXUubGVuZ3RoID4gMCAmJiBydWxlLmF1dGhvci5pbmNsdWRlcyhhdSk7XFxuICAgICAgICBzYW1lQXU9dHJ1ZTsvL+S4jeWIpOaWreS9nOiAhem7mOiupOS4unRydWVcXG4gICAgICAgIGlmIChpdGVtLnRpdGxlID09PSBydWxlLm5hbWUgJiYgc2FtZUF1KSB7XFxuICAgICAgICAgICAgbG9jYWxSdWxlID0gaXRlbTtcXG4gICAgICAgICAgICBicmVhaztcXG4gICAgICAgIH1cXG4gICAgfVxcbiAgICBpZiAobG9jYWxSdWxlID09PSB2b2lkIDApIHtcXG4gICAgICAgIHJldHVybiAtMTtcXG4gICAgfSBlbHNlIHtcXG4gICAgICAgIHJldHVybiBsb2NhbFJ1bGUudmVyc2lvbjtcXG4gICAgfVxcbn1cXG4kLmV4cG9ydHMuY29sb3IgPSBmdW5jdGlvbih0ZXh0LCBjb2xvcikge1xcbiAgICB0ZXh0ICs9IFxcXCJcXFwiO1xcbiAgICBpZiAodGV4dC5pbmRleE9mKFxcXCLigJzigJzigJ3igJ1cXFwiKSA9PT0gMCkge1xcbiAgICAgICAgdGV4dC5yZXBsYWNlKFxcXCLigJzigJzigJ3igJ1cXFwiLCBcXFwiXFxcIik7XFxuICAgIH1cXG4gICAgcmV0dXJuIFxcXCLigJzigJzigJ3igJ08Zm9udCBjb2xvcj0nXFxcIiArIGNvbG9yICsgXFxcIic+XFxcIiArIHRleHQgKyBcXFwiPC9mb250PlxcXCI7XFxufVxcblxcbiQuZXhwb3J0cy5zbGVlcCA9IGZ1bmN0aW9uKHRpbWVvdXQpe1xcbiAgICBqYXZhLmxhbmcuVGhyZWFkLnNsZWVwKHRpbWVvdXQpO1xcbn1cXG5mdW5jdGlvbiBodG1sVGFnKHRhZywgdGV4dCkge1xcbiAgICB0ZXh0ICs9IFxcXCJcXFwiO1xcbiAgICBpZiAodGV4dC5pbmRleE9mKFxcXCLigJzigJzigJ3igJ1cXFwiKSA9PT0gMCkge1xcbiAgICAgICAgdGV4dC5yZXBsYWNlKFxcXCLigJzigJzigJ3igJ1cXFwiLCBcXFwiXFxcIik7XFxuICAgIH1cXG4gICAgcmV0dXJuIFxcXCLigJzigJzigJ3igJ1cXFwiICsgXFxcIjxcXFwiICsgdGFnICsgXFxcIj5cXFwiICsgdGV4dCArIFxcXCI8L1xcXCIgKyB0YWcgKyBcXFwiPlxcXCI7XFxuXFxufVxcblxcbmZ1bmN0aW9uIGdldE5vd0Zvcm1hdERhdGUoKSB7XFxuICAgICAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpO1xcbiAgICAgICAgICAgIGxldCBzZXBlcmF0b3IxID0gXFxcIi1cXFwiO1xcbiAgICAgICAgICAgIGxldCBzZXBlcmF0b3IyID0gXFxcIjpcXFwiO1xcbiAgICAgICAgICAgIGxldCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7XFxuICAgICAgICAgICAgbGV0IHN0ckRhdGUgPSBkYXRlLmdldERhdGUoKTtcXG4gICAgICAgICAgICBsZXQgc3RySG91cnMgPSBkYXRlLmdldEhvdXJzKCk7XFxuICAgICAgICAgICAgbGV0IHN0ck1pbnV0ZXMgPSBkYXRlLmdldE1pbnV0ZXMoKTtcXG4gICAgICAgICAgICBsZXQgc3RyU2Vjb25kcyA9IGRhdGUuZ2V0U2Vjb25kcygpKzE7XFxuICAgICAgICAgICAgaWYgKG1vbnRoID49IDEgJiYgbW9udGggPD0gOSkge1xcbiAgICAgICAgICAgICAgICBtb250aCA9IFxcXCIwXFxcIiArIG1vbnRoXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGlmIChzdHJEYXRlID49IDAgJiYgc3RyRGF0ZSA8PSA5KSB7XFxuICAgICAgICAgICAgICAgIHN0ckRhdGUgPSBcXFwiMFxcXCIgKyBzdHJEYXRlXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGlmIChzdHJIb3VycyA+PSAwICYmIHN0ckhvdXJzIDw9IDkpIHtcXG4gICAgICAgICAgICAgICAgc3RySG91cnMgPSBcXFwiMFxcXCIgKyBzdHJIb3Vyc1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBpZiAoc3RyTWludXRlcyA+PSAwICYmIHN0ck1pbnV0ZXMgPD0gOSkge1xcbiAgICAgICAgICAgICAgICBzdHJNaW51dGVzID0gXFxcIjBcXFwiICsgc3RyTWludXRlc1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBpZiAoc3RyU2Vjb25kcyA+PSAwICYmIHN0clNlY29uZHMgPD0gOSkge1xcbiAgICAgICAgICAgICAgICBzdHJTZWNvbmRzID0gXFxcIjBcXFwiICsgc3RyU2Vjb25kc1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAvL2xldCBjdXJyZW50ZGF0ZSA9IGRhdGUuZ2V0RnVsbFllYXIoKSArIHNlcGVyYXRvcjEgKyBtb250aCArIHNlcGVyYXRvcjEgKyBzdHJEYXRlICsgXFxcIiBcXFwiICsgc3RySG91cnMgKyBzZXBlcmF0b3IyICsgc3RyTWludXRlcyArIHNlcGVyYXRvcjIgKyBzdHJTZWNvbmRzO1xcbiAgICAgICAgICAgIGxldCBjdXJyZW50ZGF0ZSA9IChkYXRlLmdldEZ1bGxZZWFyKCktMjAyMCkrJycrIG1vbnRoICsnJysgc3RyRGF0ZSArJycrIHN0ckhvdXJzKycnICsgc3RyTWludXRlcyArJycrIE1hdGguY2VpbChzdHJTZWNvbmRzLzcpO1xcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludChjdXJyZW50ZGF0ZSlcXG4gICAgICAgIH1cXG4kLmV4cG9ydHMuZ2V0Tm93Rm9ybWF0RGF0ZSA9IGdldE5vd0Zvcm1hdERhdGU7XFxuJC5leHBvcnRzLmh0bWxUYWcgPSBodG1sVGFnO1xcbiQuZXhwb3J0cy5zbWFsbCA9IGZ1bmN0aW9uKHRleHQpIHtcXG4gICAgcmV0dXJuIGh0bWxUYWcoXFxcInNtYWxsXFxcIiwgdGV4dCk7XFxufVxcbiQuZXhwb3J0cy5nZXRGaWxlID0gZnVuY3Rpb24oKSB7XFxuICAgIHZhciBGaWxlID0gcmVxdWVzdChcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb25cXFwiKSB8fCBcXFwie31cXFwiO1xcbiAgICB0cnkge1xcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoRmlsZSk7XFxuICAgIH0gY2F0Y2ggKGUpIHtcXG4gICAgICAgIHdyaXRlRmlsZShcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb25cXFwiLCBcXFwie31cXFwiKTtcXG4gICAgICAgIHJldHVybiB7fTtcXG4gICAgfVxcbn1cXG4kLmV4cG9ydHMuZ2V0VXNlckRhdGUgPWZ1bmN0aW9uKCl7XFxuICAgIHZhciBGaWxlID0gcmVxdWVzdChcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSQS5qc29uXFxcIikgfHwgXFxcIltdXFxcIjtcXG4gICAgdHJ5IHtcXG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKEZpbGUpO1xcbiAgICB9IGNhdGNoIChlKSB7XFxuICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMvV2FyZWhvdXNlVVNFUkEuanNvblxcXCIsIFxcXCJbXVxcXCIpO1xcbiAgICAgICAgcmV0dXJuIFtdO1xcbiAgICB9XFxufVxcbiQuZXhwb3J0cy5leGlzdEZpbGUgPSBmdW5jdGlvbihzcGF0aCwgaXBhdGgsIGhlYWRlcnMpIHtcXG4gICAgbGV0IHNjb2RlID0gcmVxdWVzdChzcGF0aCk7XFxuICAgIGlmICghc2NvZGUpIHtcXG4gICAgICAgIHdyaXRlRmlsZShzcGF0aCwgcmVxdWVzdChpcGF0aCwgaGVhZGVycykpO1xcbiAgICB9XFxufVxcblxcbmxldCBuZXdBcGkgPSB7XFxuICAgIFxcXCJkaXNfbmV3XFxcIjogXFxcIi9oaWtlcnVsZS9uZXdfcnVsZV9kaXNjdXNzL1xcXCIsXFxuICAgIFxcXCJkaXNfdmVyaWZ5XFxcIjogXFxcIi9oaWtlcnVsZS9ydWxlX2Rpc2N1c3MvZ2V0X3l6bVxcXCIsXFxuICAgIFxcXCJkaXNfZ2V0XFxcIjogXFxcIi9oaWtlcnVsZS9ydWxlX2Rpc2N1c3MvXFxcIixcXG4gICAgXFxcImRpc19zZXRcXFwiOiBcXFwiL2hpa2VydWxlL21vZGlmeS9jYW5fZGlzY3Vzcy9cXFwiLFxcbiAgICBcXFwiZGlzX25ld191c2VyXFxcIjogXFxcIi9oaWtlcnVsZS9ydWxlX2Rpc2N1c3MvbmV3X3VzZXJcXFwiLFxcbiAgICBcXFwiZGlzX2xvZ2luXFxcIjpcXFwiL2hpa2VydWxlL3J1bGVfZGlzY3Vzcy91c2VyX2xvZ2luXFxcIixcXG4gICAgXFxcImRpc19kZXZfZGlzY3Vzc1xcXCI6XFxcIi9oaWtlcnVsZS9tb2RpZnkvZGV2X2Nhbl9kaXNjdXNzXFxcIixcXG4gICAgXFxcImRpc19kZXZfY29udHJvbFxcXCI6XFxcIi9oaWtlcnVsZS9ydWxlX2Rpc2N1c3MvcmVtb3ZlL1xcXCIsXFxuICAgIFxcXCJhbGxfcnVsZVxcXCI6XFxcIi9oaWtlcnVsZS9nZXRfcnVsZXNcXFwiLFxcbiAgICBcXFwiZGlzX2dldF9yZXBseVxcXCI6XFxcIi9oaWtlcnVsZS9nZXRfcmVwbHlfcnVsZV9kaXNjdXNzXFxcIixcXG4gICAgXFxcImRpc19yZXBseVxcXCI6XFxcIi9oaWtlcnVsZS9kZXZfbmV3X3J1bGVfZGlzY3Vzcy9cXFwiLFxcbn1cXG5cXG5mdW5jdGlvbiBzZXRBcGkob2JqZWN0KSB7XFxuICAgIGxldCB0YXJnZXQgPSB7fTtcXG4gICAgZm9yIChsZXQga2V5IGluIG9iamVjdCkge1xcbiAgICAgICAgdGFyZ2V0W2tleV09aG9zdCtvYmplY3Rba2V5XVxcbiAgICB9XFxuICAgIHJldHVybiB0YXJnZXQ7XFxufVxcblxcbiQuZXhwb3J0cy5hcGkgPSBzZXRBcGkobmV3QXBpKTtcXG4kLmV4cG9ydHMuYXBpLmhvc3Q9aG9zdDtcXG4kLmV4cG9ydHMuYXBpLmhvbWU9aG9tZTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuW8gOWPkeiAheeZu+W9lVwiLFwicGF0aFwiOlwiZGV2TG9naW5cIixcInJ1bGVcIjpcImpzOlxcbnNldFBhZ2VUaXRsZShcXFwi5byA5Y+R6ICF55m75b2VXFxcIik7XFxuY29uc3Qge1xcbiAgICBnZXRBcGksXFxuICAgIGh0bWxUYWcsXFxuICAgIG1hcENvbFR5cGUsXFxuICAgIHNtYWxsLFxcbmdldEZpbGVcXG59ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcIik7XFxudmFyIGRhdGEgPSBbXTtcXG5hZGRMaXN0ZW5lcignb25DbG9zZScsICQudG9TdHJpbmcoKCk9PntcXG4gICAgY2xlYXJWYXIoXFxcIldhcmVob3VzZVVzZXJuYW1lXFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2VQYXNzd29yZFxcXCIpO1xcbn0pKVxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiAn6LSm5Y+3JyxcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGdldFZhcignV2FyZWhvdXNlVXNlcm5hbWUnLCcnKSxcXG4gICAgICAgIHR5cGU6XFxcIm51bWJlclxcXCIsXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFwiV2FyZWhvdXNlVXNlcm5hbWVcXFwiLGlucHV0KSdcXG4gICAgfVxcbn0sIHtcXG4gICAgdGl0bGU6ICflr4bnoIEnLFxcbiAgICBjb2xfdHlwZTogJ2lucHV0JyxcXG4gICAgZXh0cmE6IHtcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2VQYXNzd29yZCcsICcnKSxcXG4gICAgICAgIHR5cGU6IFxcXCJwYXNzd29yZFxcXCIsXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFwiV2FyZWhvdXNlUGFzc3dvcmRcXFwiLGlucHV0KSdcXG4gICAgfVxcbn0pO1xcblxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOlxcXCImbmJzcDsmbmJzcDs8YSBocmVmPSdoaWtlcjovL3BhZ2UvUmVnaXN0ZXInPuazqOWGjDwvYT5cXFwiLFxcbiAgICBjb2xfdHlwZTpcXFwicmljaF90ZXh0XFxcIlxcbn0pO1xcbm1hcENvbFR5cGUoZGF0YSwgXFxcImxpbmVfYmxhbmtcXFwiLCAxKTtcXG5sZXQgdXNlciA9IGdldEZpbGUoKTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogaHRtbFRhZyhcXFwiYlxcXCIsIFxcXCLnmbvlvZVcXFwiKSxcXG4gICAgdXJsOiAkKCkubGF6eVJ1bGUoKHVybCwgZik9PiB7XFxuICAgICAgICBsZXQgdXNlcm5hbWUgPSBnZXRWYXIoJ1dhcmVob3VzZVVzZXJuYW1lJywgJycpLFxcbiAgICAgICAgICAgIHBhc3N3b3JkID0gZ2V0VmFyKCdXYXJlaG91c2VQYXNzd29yZCcsICcnKTtcXG4gICAgICAgIGlmKHVzZXJuYW1lID09PSBcXFwiXFxcIiAmJiBwYXNzd29yZCA9PT1cXFwiXFxcIil7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+i0puWPt+WSjOWvhueggeS4jeiDveS4uuepulxcXCJcXG4gICAgICAgIH1cXG4gICAgICAgIGxldCBteVVybCA9IHVybCArICc/cXE9JyArIHVzZXJuYW1lICsgJyZwYXNzd29yZD0nICsgcGFzc3dvcmQ7XFxuICAgICAgICBsZXQgY29kZV9zdHIgPSByZXF1ZXN0KG15VXJsKTtcXG4gICAgICAgIGxldCBjb2RlID0gSlNPTi5wYXJzZShjb2RlX3N0cik7XFxuICAgICAgICBpZiAoY29kZS5zdGF0dXMgPT0gMCkge1xcbiAgICAgICAgICAgIGYudXNlcm5hbWU9dXNlcm5hbWU7XFxuICAgICAgICAgICAgZi5wYXNzd29yZD1wYXNzd29yZFxcbiAgICAgICAgICAgIHdyaXRlRmlsZSgnaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb24nLCBKU09OLnN0cmluZ2lmeShmKSk7XFxuICAgICAgICAgICAgYmFjaygpO1xcbiAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/nmbvlvZXmiJDlip9cXFwiO1xcbiAgICAgICAgfWVsc2V7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+i0puWPt+aIluWvhueggemUmeivr1xcXCI7XFxuICAgICAgICB9XFxuICAgIH0sIGdldEFwaShcXFwicnVsZXNBbGxVcmxcXFwiKSx1c2VyKSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJ1xcbn0pO1xcbnNldFJlc3VsdChkYXRhKTtcIn0se1wiY29sX3R5cGVcIjpcImljb25fMl9yb3VuZFwiLFwibmFtZVwiOlwi5byA5Y+R6ICF566h55CGXCIsXCJwYXRoXCI6XCJkZXZNYW5hZ2VcIixcInJ1bGVcIjpcImpzOlxcbnNldFBhZ2VUaXRsZShcXFwi6KeE5YiZ566h55CGXFxcIik7XFxuYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAnY2xlYXJWYXIoXFxcIldhcmVob3VzZS5iYWNrXFxcIixcXFwiXFxcIik7Jyk7XFxuaWYgKGdldFZhcihcXFwiV2FyZWhvdXNlLmJhY2tcXFwiKSA9PT0gXFxcIjFcXFwiKSB7XFxuICAgIGJhY2soKTtcXG59XFxuY29uc3Qge1xcbiAgICBnZXRBcGksXFxuICAgIGNvbG9yLFxcbiAgICBzbWFsbCxcXG4gICAgZ2V0RmlsZSxcXG4gICAgZXhpc3RGaWxlLFxcbiAgICBtYXBDb2xUeXBlLFxcbiAgICBhcGlcXG59ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcIik7XFxubGV0IHtcXG4gICAgZGV2XFxufSA9IE1ZX1BBUkFNUztcXG5sZXQge1xcbiAgICB1c2VybmFtZSxcXG4gICAgcGFzc3dvcmQsXFxufSA9IGdldEZpbGUoKTtcXG4vL2V4aXN0RmlsZShcXFwiaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlL2h0bWwv5byA5Y+R6ICF5YiG5LqrLmh0bWxcXFwiLCBcXFwiaHR0cHM6Ly9lcnAuc2N3aW5iYW8uY29tL2hpa2VydWxlL3J1bGVsaXN0Lmpzb24/aWQ9NTM5XFxcIik7XFxubGV0IHJ1bGVMaXN0ID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldEFwaShcXFwicnVsZXNBbGxVcmxcXFwiKSArICc/cXE9JyArIHVzZXJuYW1lICsgJyZwYXNzd29yZD0nICsgcGFzc3dvcmQpKS5yZXN1bHQ7XFxubGV0IE1PQklMRV9VQSA9ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNS4wOyBTTS1HOTAwUCBCdWlsZC9MUlgyMVQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84OC4wLjQzMjQuMTQ2IE1vYmlsZSBTYWZhcmkvNTM3LjM2JztcXG5sZXQgaW5mb1NldFVybCA9IGdldEFwaShcXFwiaW5mb1NldFVybFxcXCIpO1xcbmxldCBpbmZvR2V0VXJsID0gZ2V0QXBpKFxcXCJpbmZvR2V0VXJsXFxcIikgKyB1c2VybmFtZTtcXG5sZXQgc2V0dGluZ3NHZXRVcmwgPSBnZXRBcGkoXFxcInNldHRpbmdzR2V0VXJsXFxcIikgKyB1c2VybmFtZTtcXG5wdXRNeVZhcihcXFwiZGV2X3NldF9pbmZvXFxcIiwgW3VzZXJuYW1lLCBwYXNzd29yZCwgaW5mb1NldFVybCwgTU9CSUxFX1VBLCBpbmZvR2V0VXJsXS5qb2luKFxcXCIkJFxcXCIpKTtcXG5sZXQgZGF0YSA9IFtdO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiAn4oCc4oCc4oCd4oCdPGJpZz7ku5PlupPorr7nva48L2JpZz4mbmJzcDsmbmJzcDsmbmJzcDs8c21hbGw+PHU+77yIIOS4quS6uui1hOaWmSA+77yJPC91Pjwvc21hbGw+JyxcXG4gICAgZGVzYzogJ+KAnOKAnOKAneKAneaCqOWFseaciSA8c3BhbiBzdHlsZT1cXFwiY29sb3I6ICNmZjcwMDBcXFwiPicgKyBydWxlTGlzdC5sZW5ndGggKyAnPC9zcGFuPicgKyBcXFwiIOadoeinhOWImeOAglxcXFxu54K55Ye76KeE5YiZ5Y+v6L+b6KGM5YiG5Lqr44CB5Yig6Zmk44CB5a+85YWl5pON5L2c5Y+K5p+l55yL6K+m5oOFXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL1BlcnNvbmFsRGF0YSNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFwiLFxcbiAgICBleHRyYTp7aWQ6ZGV2LmlkfSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzEnXFxufSk7XFxubWFwQ29sVHlwZShkYXRhLCBcXFwibGluZVxcXCIsIDIpO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBzbWFsbChjb2xvcihcXFwi5pu05pS55YWs5ZGK4pyNXFxcIiwgXFxcIiMzNGIxZmZcXFwiKSksXFxuICAgIC8vIHVybDogXFxcIng1Oi8vZmlsZTovLy9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL2NvbS5leGFtcGxlLmhpa2Vydmlldy9maWxlcy9Eb2N1bWVudHMvcnVsZXMvZHpIb3VzZS9odG1sL2Rldl9pbmZvX2VkaXQuaHRtbFxcXCIsXFxuICAgIHVybDogXFxcImhpa2VyOi8vcGFnZS9kZXZJbmZvRWRpdFxcXCIsXFxuICAgIGNvbF90eXBlOiAndGV4dF8zJ1xcbn0pO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBzbWFsbChjb2xvcihcXFwi5pu05aSa5YiG5Lqr8J+TslxcXCIsIFxcXCIjMzRiMWZmXFxcIikpLFxcbiAgICAvL3VybDogXFxcIng1Oi8vZmlsZTovLy9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL2NvbS5leGFtcGxlLmhpa2Vydmlldy9maWxlcy9Eb2N1bWVudHMvcnVsZXMvZHpIb3VzZS9odG1sL+W8gOWPkeiAheWIhuS6qy5odG1sXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL21vcmVTaGFyZVxcXCIsXFxuICAgIGNvbF90eXBlOiAndGV4dF8zJ1xcbn0pO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBzbWFsbChjb2xvcihcXFwi5Y2H57qn5L6d6LWW8J+TpVxcXCIsIFxcXCIjMzRiMWZmXFxcIikpLFxcbiAgICB1cmw6ICQoXFxcIuWNh+e6p+S8mumHjeaWsOS7juS7k+W6k+aLieWPluebuOWFs+eahOmdmeaAgemhtemdouWIsOacrOWcsFxcXFxu56Gu6K6k5Y2H57qn5ZCXP1xcXCIpLmNvbmZpcm0oKGhvc3QpID0+IHtcXG4gICAgICAgIHdyaXRlRmlsZShcXFwiaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlL2h0bWwv5byA5Y+R6ICF5YiG5LqrLmh0bWxcXFwiLCByZXF1ZXN0KGhvc3QrJy9oaWtlcnVsZS9ydWxlbGlzdC5qc29uP2lkPTUzOScpKTtcXG4gICAgICAgIHdyaXRlRmlsZShcXFwiaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlL2h0bWwvZGV2X2luZm9fZWRpdC5odG1sXFxcIiwgcmVxdWVzdChob3N0KycvaGlrZXJ1bGUvcnVsZWxpc3QuanNvbj9pZD00MDInKSk7XFxuICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9odG1sL2Rldl9pbmZvX2dldC5odG1sXFxcIiwgcmVxdWVzdChob3N0KycvaGlrZXJ1bGUvcnVsZWxpc3QuanNvbj9pZD00MDQnKSk7XFxuICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxuICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5bey6YeN572u5byA5Y+R6ICF5YiG5LqrLOeugOS7i+afpeeciyznroDku4vnvJbovpHnrYnpnZnmgIHmlofku7ZcXFwiO1xcbiAgICB9LGFwaS5ob3N0KSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzMnXFxufSk7XFxubGV0IGRldlNldEJhY2s7XFxudHJ5IHtcXG4gICAgZGV2U2V0QmFjayA9IEpTT04ucGFyc2UocmVxdWVzdChzZXR0aW5nc0dldFVybCkpO1xcbn0gY2F0Y2ggKGUpIHtcXG4gICAgZGV2U2V0QmFjayA9IHt9O1xcbn1cXG5cXG5mdW5jdGlvbiBzZXRTZXR0aW5nSXRlbShiYXNpYykge1xcbiAgICBsZXQgdGVtcCA9IHtcXG4gICAgICAgIHRpdGxlOiBiYXNpYy50aXRsZSxcXG4gICAgICAgIGNvbF90eXBlOiBiYXNpYy5jb2xfdHlwZSxcXG4gICAgICAgIHVybDogJChiYXNpYy5jb25maXJtKS5jb25maXJtKCh1cmwsIG1zZykgPT4ge1xcbiAgICAgICAgICAgIGxldCBiYWNrID0gcmVxdWVzdCh1cmwpO1xcbiAgICAgICAgICAgIGxldCByZXQgPSBKU09OLnBhcnNlKGJhY2spO1xcbiAgICAgICAgICAgIGlmIChyZXQuc3RhdHVzID09IDApIHtcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UodHJ1ZSk7XFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly9cXFwiICsgbXNnWzBdO1xcbiAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL1xcXCIgKyBtc2dbMV0gKyBcXFwiXFxcXG5cXFwiICsgcmV0LmRldGFpbDtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9LCBiYXNpYy51cmwsIGJhc2ljLm1zZylcXG4gICAgfTtcXG4gICAgcmV0dXJuIHRlbXA7XFxufVxcbmlmIChkZXZTZXRCYWNrLnN0YXR1cyA9PSAwKSB7XFxuICAgIGxldCBkZXZTZXR0aW5ncyA9IGRldlNldEJhY2sucmVzdWx0O1xcbiAgICBsZXQgc2hhcmUgPSB7XFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfM1xcXCJcXG4gICAgfTtcXG4gICAgaWYgKGRldlNldHRpbmdzLnNoYXJlX3B1YmxpYykge1xcbiAgICAgICAgc2hhcmUudGl0bGUgPSBzbWFsbChjb2xvcihcXFwi5YWs5byA5LiK5LygXFxcIiwgXFxcImdyZWVuXFxcIikgKyBjb2xvcihcXFwiKOengeiXjylcXFwiLCBcXFwiIzAwYmZmZlxcXCIpKTtcXG4gICAgICAgIHNoYXJlLnVybCA9IGdldEFwaShcXFwiZ3VwbG9hZFxcXCIpICsgXFxcIj9xcT1cXFwiICsgdXNlcm5hbWUgKyBcXFwiJnBhc3N3b3JkPVxcXCIgKyBwYXNzd29yZCArIFxcXCImZmxhZz0xXFxcIjtcXG4gICAgICAgIHNoYXJlLmNvbmZpcm0gPSBcXFwi5piv5ZCm56Gu6K6k56eB6JeP5Lul5ZCO5o+Q5Lqk55qE6KeE5YiZP1xcXCI7XFxuICAgICAgICBzaGFyZS5tc2cgPSBbXFxcIuW3suengeiXj1xcXCIsIFxcXCLnp4Hol4/lpLHotKVcXFwiXTtcXG4gICAgfSBlbHNlIHtcXG4gICAgICAgIHNoYXJlLnRpdGxlID0gc21hbGwoY29sb3IoXFxcIuengeWvhuS4iuS8oFxcXCIsIFxcXCJyZWRcXFwiKSArIGNvbG9yKFxcXCIo5YWs5byAKVxcXCIsIFxcXCIjYWRmZjJmXFxcIikpO1xcbiAgICAgICAgc2hhcmUudXJsID0gZ2V0QXBpKFxcXCJndXBsb2FkXFxcIikgKyBcXFwiP3FxPVxcXCIgKyB1c2VybmFtZSArIFxcXCImcGFzc3dvcmQ9XFxcIiArIHBhc3N3b3JkO1xcbiAgICAgICAgc2hhcmUuY29uZmlybSA9IFxcXCLmmK/lkKbnoa7orqTlhazlvIDku6XlkI7mj5DkuqTnmoTop4TliJk/XFxcIjtcXG4gICAgICAgIHNoYXJlLm1zZyA9IFtcXFwi5bey5YWs5byAXFxcIiwgXFxcIuWFrOW8gOWksei0pVxcXCJdO1xcbiAgICB9XFxuICAgIGRhdGEucHVzaChzZXRTZXR0aW5nSXRlbShzaGFyZSkpO1xcbiAgICBsZXQgdGltZU92ZXIgPSB7XFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfM1xcXCJcXG4gICAgfTtcXG4gICAgaWYgKGRldlNldHRpbmdzLnRpbWVfb3Zlcikge1xcbiAgICAgICAgdGltZU92ZXIudGl0bGUgPSBzbWFsbChjb2xvcihcXFwi55+t5pe256eY6ZKlXFxcIiwgXFxcImdyZWVuXFxcIikgKyBjb2xvcihcXFwiKOawuOS5hSlcXFwiLCBcXFwiIzAwYmZmZlxcXCIpKTtcXG4gICAgICAgIHRpbWVPdmVyLnVybCA9IGdldEFwaShcXFwiZ3RpbWVvdmVyXFxcIikgKyBcXFwiP3FxPVxcXCIgKyB1c2VybmFtZSArIFxcXCImcGFzc3dvcmQ9XFxcIiArIHBhc3N3b3JkICsgXFxcIiZmbGFnPTFcXFwiO1xcbiAgICAgICAgdGltZU92ZXIuY29uZmlybSA9IFxcXCLmmK/lkKbnoa7orqTku6XlkI7nmoTnp4Hol4/op4TliJnliIbkuqvkuI3ov4fmnJ8/XFxcIjtcXG4gICAgICAgIHRpbWVPdmVyLm1zZyA9IFtcXFwi5bey6K6+5Li65rC45LmFXFxcIiwgXFxcIuiuvuS4uuawuOS5heWksei0pVxcXCJdO1xcbiAgICB9IGVsc2Uge1xcbiAgICAgICAgdGltZU92ZXIudGl0bGUgPSBzbWFsbChjb2xvcihcXFwi5rC45LmF56eY6ZKlXFxcIiwgXFxcInJlZFxcXCIpICsgY29sb3IoXFxcIijov4fmnJ8pXFxcIiwgXFxcIiNhZGZmMmZcXFwiKSk7XFxuICAgICAgICB0aW1lT3Zlci51cmwgPSBnZXRBcGkoXFxcImd0aW1lb3ZlclxcXCIpICsgXFxcIj9xcT1cXFwiICsgdXNlcm5hbWUgKyBcXFwiJnBhc3N3b3JkPVxcXCIgKyBwYXNzd29yZDtcXG4gICAgICAgIHRpbWVPdmVyLmNvbmZpcm0gPSBcXFwi56Gu6K6k6KaB5Lul5ZCO5YiG5Lqr55qE56eB6JeP6KeE5YiZ6Ieq5Yqo5Yiw5pyfP1xcXCI7XFxuICAgICAgICB0aW1lT3Zlci5tc2cgPSBbXFxcIuW3suiuvuS4uui/h+acn1xcXCIsIFxcXCLorr7kuLrov4fmnJ/lpLHotKVcXFwiXTtcXG4gICAgfVxcbiAgICBkYXRhLnB1c2goc2V0U2V0dGluZ0l0ZW0odGltZU92ZXIpKTtcXG4gICAgbGV0IGRpc2N1c3MgPSB7XFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfM1xcXCJcXG4gICAgfTtcXG4gICAgaWYgKGRldlNldHRpbmdzLmNhbl9kaXNjdXNzKSB7XFxuICAgICAgICBkaXNjdXNzLnRpdGxlID0gc21hbGwoY29sb3IoXFxcIuWFgeiuuOivhOiuulxcXCIsIFxcXCJyZWRcXFwiKSArIGNvbG9yKFxcXCIo5LiN6K64KVxcXCIsIFxcXCIjYWRmZjJmXFxcIikpO1xcbiAgICAgICAgZGlzY3Vzcy51cmwgPSBhcGkuZGlzX2Rldl9kaXNjdXNzICsgXFxcIj9xcT1cXFwiICsgdXNlcm5hbWUgKyBcXFwiJnBhc3N3b3JkPVxcXCIgKyBwYXNzd29yZCsgXFxcIiZmbGFnPTFcXFwiO1xcbiAgICAgICAgZGlzY3Vzcy5jb25maXJtID0gXFxcIuaYr+WQpuehruiupOS7peWQjuS4iuS8oOeahOinhOWImeWFgeiuuOivhOiuuj9cXFwiO1xcbiAgICAgICAgZGlzY3Vzcy5tc2cgPSBbXFxcIuW3suiuvuS4uuS4jeiuuFxcXCIsIFxcXCLorr7nva7lpLHotKVcXFwiXTtcXG5cXG4gICAgfSBlbHNlIHtcXG4gICAgICAgIGRpc2N1c3MudGl0bGUgPSBzbWFsbChjb2xvcihcXFwi5LiN6K646K+E6K66XFxcIiwgXFxcImdyZWVuXFxcIikgKyBjb2xvcihcXFwiKOWFgeiuuClcXFwiLCBcXFwiIzAwYmZmZlxcXCIpKTtcXG4gICAgICAgIGRpc2N1c3MudXJsID0gYXBpLmRpc19kZXZfZGlzY3VzcyArIFxcXCI/cXE9XFxcIiArIHVzZXJuYW1lICsgXFxcIiZwYXNzd29yZD1cXFwiICsgcGFzc3dvcmQ7XFxuICAgICAgICBkaXNjdXNzLmNvbmZpcm0gPSBcXFwi5piv5ZCm56Gu6K6k5Lul5ZCO5LiK5Lyg55qE6KeE5YiZ5YWB6K646K+E6K66P1xcXCI7XFxuICAgICAgICBkaXNjdXNzLm1zZyA9IFtcXFwi5bey6K6+5Li65YWB6K64XFxcIiwgXFxcIuiuvue9ruWksei0pVxcXCJdO1xcbiAgICB9XFxuICAgIGRhdGEucHVzaChzZXRTZXR0aW5nSXRlbShkaXNjdXNzKSk7XFxufVxcbm1hcENvbFR5cGUoZGF0YSwgXFxcImxpbmVcXFwiLCAyKTtcXG5mb3IgKGxldCBpdGVtIG9mIHJ1bGVMaXN0KSB7XFxuICAgIGxldCBteV90X2V4Y29kZTEgPSAnJztcXG4gICAgbGV0IG15X3RfZXhjb2RlMiA9ICcnO1xcbiAgICBpZiAoaXRlbS5zdGF0ZSAhPSAncHVibGljJykge1xcbiAgICAgICAgbXlfdF9leGNvZGUxICs9ICfjipnvuI8nO1xcbiAgICB9IGVsc2Uge1xcbiAgICAgICAgbXlfdF9leGNvZGUxICs9ICcnO1xcbiAgICB9XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogbXlfdF9leGNvZGUxICsgaXRlbS5uYW1lICsgbXlfdF9leGNvZGUyLFxcbiAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL21hbmFnZVJ1bGUjbm9IaXN0b3J5IyNub1JlY29yZEhpc3RvcnkjXFxcIixcXG4gICAgICAgIGV4dHJhOiB7XFxuICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXFxuICAgICAgICAgICAgLy91c2VybmFtZTogdXNlcm5hbWUsXFxuICAgICAgICAgICAgLy9wYXNzd29yZDogcGFzc3dvcmRcXG4gICAgICAgIH0sXFxuICAgICAgICBwaWNfdXJsOiBpdGVtLnBpYyxcXG4gICAgfSlcXG59XFxuaWYgKHJ1bGVMaXN0Lmxlbmd0aCA9PT0gMCkge1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCI8aDUgc3R5bGU9J3RleHQtYWxpZ246Y2VudGVyJz7lv6vmnaXkuIrkvKDkvaDnmoTnrKzkuIDmnaHop4TliJnlkKfvvIE8L2g1PlxcXCIsXFxuICAgICAgICBjb2xfdHlwZTogXFxcInJpY2hfdGV4dFxcXCJcXG4gICAgfSk7XFxufVxcbnNldFJlc3VsdChkYXRhKTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuinhOWImeivpue7hi1kZXZcIixcInBhdGhcIjpcIm1hbmFnZVJ1bGVcIixcInJ1bGVcIjpcImpzOlxcbiAgICBjb25zdCB7XFxuICAgICAgICBnZXRBcGksXFxuICAgICAgICBjb2xvcixcXG4gICAgICAgIHNtYWxsLFxcbiAgICAgICAgZ2V0RmlsZSxcXG4gICAgICAgIGV4aXN0RmlsZSxcXG4gICAgICAgIG1hcENvbFR5cGUsXFxuICAgICAgICBodG1sVGFnLFxcbiAgICAgICAgYXBpLFxcbiAgICAgICAgbWQsXFxuICAgIH0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFwiKTtcXG5sZXQge1xcbiAgICBpZFxcbn0gPSBNWV9QQVJBTVM7XFxubGV0IHtcXG4gICAgdXNlcm5hbWUsXFxuICAgIHBhc3N3b3JkLFxcbn0gPSBnZXRGaWxlKCk7XFxuYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAkLnRvU3RyaW5nKCgpID0+IHtcXG4gICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcbn0pKTtcXG5sZXQgZGF0YUl0ZW0gPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXCJnZXRieWlkXFxcIikgKyBcXFwiP2lkPVxcXCIgKyBpZCkpLnJlc3VsdDtcXG5zZXRQYWdlVGl0bGUoXFxcIue8lui+keOAjFxcXCIgKyBkYXRhSXRlbS5uYW1lICsgXFxcIuOAjVxcXCIpO1xcbmxldCByZXFCeUdldCA9IFxcXCI/aWQ9XFxcIiArIGRhdGFJdGVtLmlkICsgXFxcIiZxcT1cXFwiICsgdXNlcm5hbWUgKyBcXFwiJnBhc3N3b3JkPVxcXCIgKyBwYXNzd29yZDtcXG5sZXQgcnVsZUxpc3RKc29uID0gZ2V0QXBpKFxcXCJydWxlTGlzdEpzb25cXFwiKSArIFxcXCI/aWQ9XFxcIjtcXG5sZXQgZGF0YSA9IFtdO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBodG1sVGFnKFxcXCJiaWdcXFwiLCBcXFwi54mI5pysXFxcIiksXFxuICAgIGRlc2M6IFxcXCLigJzigJzigJ3igJ3kupHnq6/niYjmnKw6XFxcIiArIGNvbG9yKGRhdGFJdGVtLnZlciwgXFxcIiM1Y2ZmMmNcXFwiKSArIFxcXCJcXFxcbuS4iuasoeaPkOS6pOS6jjogW1xcXCIgKyBjb2xvcihkYXRhSXRlbS5sYXN0X3VwZGF0ZSwgXFxcIiNmZjcwMDBcXFwiKSArIFxcXCJdXFxcIixcXG4gICAgdXJsOiAkKFxcXCI85byA5Y+R6ICFPlxcXFxuXFxcIiArIGRhdGFJdGVtLmF1dGhvciArIFxcXCJcXFxcbjzlkI3np7A+XFxcXG5cXFwiICsgZGF0YUl0ZW0ubmFtZSArIFxcXCJcXFxcbjzkupHnq6/niYjmnKw+XFxcXG5cXFwiICsgZGF0YUl0ZW0udmVyICsgXFxcIlxcXFxuPOabtOaWsOaXtumXtD5cXFxcbltcXFwiICsgZGF0YUl0ZW0ubGFzdF91cGRhdGUgKyBcXFwiXVxcXCIpLmNvbmZpcm0oKCkgPT4ge30pLFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMSdcXG59KTtcXG5sZXQgZGF0YVR5cGUgPSB7XFxuICAgIGhvbWVfcnVsZV91cmw6ICfpppbpobXkupHop4TliJknLFxcbiAgICBwdWJsaXNoOiAn5o+Q5Lqk5LqR5LuT5bqT6KeE5YiZJyxcXG4gICAganNfdXJsOiAn572R6aG15o+S5Lu26KeE5YiZJyxcXG4gICAgaHRtbDogJ+mdmeaAgemhtemdoicsXFxuICAgIGNvbmZpZzogJ+S4u+mhtemFjee9ridcXG59O1xcblxcbmxldCBiYXNpYyA9IHtcXG4gICAgY29sX3R5cGU6IFxcXCJ0ZXh0XzFcXFwiLFxcbiAgICB1cmw6IFxcXCJoaWtlcjovL2VtcHR5XFxcIlxcbn07XFxubGV0IGRhdGFUeXBlVGlwcyA9IGRhdGFUeXBlW2RhdGFJdGVtLmRhdGFfdHlwZV0gfHwgJ+acquefpeinhOWImTonICsgZGF0YUl0ZW0uZGF0YV90eXBlO1xcblxcbmJhc2ljLnRpdGxlID0gaHRtbFRhZyhcXFwiYmlnXFxcIiwgXFxcIuexu+Wei1xcXCIpICsgXFxcIlxcXFx0XFxcXHRcXFxcdFxcXCIgKyBzbWFsbChcXFwiKGlkOlxcXCIgKyBkYXRhSXRlbS5pZCArIFxcXCIpXFxcIik7XFxuYmFzaWMuZGVzYyA9IFxcXCLmlbDmja7nsbvlnovvvJpcXFwiICsgY29sb3IoZGF0YVR5cGVUaXBzLCBcXFwiI2NiNTRmZlxcXCIpICsgXFxcIlxcXFxu5YiG5Lqr54q25oCB5Li677yaXFxcIiArIGRhdGFJdGVtLnN0YXRlO1xcbmlmIChbXFxcImh0bWxcXFwiLCBcXFwiY29uZmlnXFxcIiwgXFxcImpzX3VybFxcXCJdLmluY2x1ZGVzKGRhdGFJdGVtLmRhdGFfdHlwZSkpIHtcXG4gICAgYmFzaWMuZGVzYyArPSBcXFwiXFxcXG7igJzigJzigJ3igJ0gPT5cXFwiICsgc21hbGwoXFxcIueCueatpOmihOiniFxcXCIpO1xcbiAgICBiYXNpYy51cmwgPSBydWxlTGlzdEpzb24gKyBkYXRhSXRlbS5pZDtcXG59XFxubGV0IGF1dGggPSBcXFwiXFxcIjtcXG5pZiAoZGF0YUl0ZW0uc3RhdGUgPT0gXFxcInByaXZhdGVcXFwiKSB7XFxuICAgIGxldCBhdXRoX2JhY2sgPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXCJhdXRoXFxcIikgKyByZXFCeUdldCkpO1xcbiAgICBiYXNpYy50aXRsZSA9IGJhc2ljLnRpdGxlICsgXFxcIlxcXFxuXFxcIiArIHNtYWxsKGNvbG9yKGF1dGhfYmFjay5yZXN1bHQsIFxcXCJncmV5XFxcIikpO1xcbiAgICBhdXRoID0gJyZhdXRoPScgKyBhdXRoX2JhY2sucmVzdWx0O1xcbiAgICBiYXNpYy51cmwgPSBiYXNpYy51cmwgPT09IFxcXCJoaWtlcjovL2VtcHR5XFxcIiA/IGJhc2ljLnVybCA6IGJhc2ljLnVybCArIGF1dGg7XFxufVxcbmRhdGEucHVzaChiYXNpYyk7XFxubGV0IG5vdGVzID0gcmVxdWVzdChnZXRBcGkoXFxcImdldF9ydWxlX25vdGVcXFwiKSArIGlkKTtcXG5ub3RlcyA9IEpTT04ucGFyc2Uobm90ZXMpLnJlc3VsdDtcXG5yZXF1aXJlKG1kKTtcXG5sZXQgbm90ZXNIdG1sPVxcXCJcXFwiXFxudHJ5e1xcbiAgICBub3Rlc0h0bWw9bWFya2VkLnBhcnNlKG5vdGVzKTtcXG59Y2F0Y2goZSl7fVxcbmlmIChub3RlcyAhPT0gZmFsc2UpIHtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBodG1sVGFnKFxcXCJiaWdcXFwiLCBcXFwi5aSH5rOoXFxcIikgKyBcXFwiXFxcXHRcXFxcdFxcXFx0XFxcIiArIHNtYWxsKGh0bWxUYWcoXFxcInVcXFwiLCBcXFwi5p+l55yL5a6M5pW05YWs5ZGKID5cXFwiKSksXFxuICAgICAgICBkZXNjOiBub3RlcyxcXG4gICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF8xXFxcIixcXG4gICAgICAgIHVybDogXFxcImhpa2VyOi8vcGFnZS9pbmZvXFxcIixcXG4gICAgICAgIGV4dHJhOiB7XFxuICAgICAgICAgICAgdGV4dDogbm90ZXNIdG1sLFxcbiAgICAgICAgICAgIG5hbWU6IGRhdGFJdGVtLm5hbWUsXFxuICAgICAgICAgICAgLy8gdHlwZTogXFxcImxvbmdfdGV4dFxcXCJcXG4gICAgICAgICAgICB0eXBlOiBcXFwicmljaF90ZXh0XFxcIlxcbiAgICAgICAgfVxcbiAgICB9KTtcXG59XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IGh0bWxUYWcoXFxcImJpZ1xcXCIsIFxcXCLmk43kvZxcXFwiKSxcXG4gICAgY29sX3R5cGU6IFxcXCJ0ZXh0XzFcXFwiLFxcbiAgICB1cmw6IFxcXCJ0b2FzdDovL+S9oOaJjeaYr+acgOW4heeahOmCo+S4quS6uu+8gVxcXCJcXG59KTtcXG5sZXQgaW1wb3J0VXJsLCBydWxlQ29kZSwgc2hhcmVVcmwsIGJhY2tDb2RlID0gXFxcIlxcXCI7XFxubGV0IHN1YlVybCA9IHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkICsgYXV0aDtcXG5pZiAoIWRhdGFJdGVtLmlzX2pzb24pIHtcXG4gICAgYmFja0NvZGUgPSByZXF1ZXN0KHN1YlVybCk7XFxufVxcbnN3aXRjaCAoZGF0YUl0ZW0uZGF0YV90eXBlKSB7XFxuICAgIGNhc2UgXFxcImhvbWVfcnVsZV91cmxcXFwiOlxcbiAgICAgICAgcnVsZUNvZGUgPSBcXFwi5rW36ZiU6KeG55WM6aaW6aG16aKR6YGT6KeE5YiZ44CQXFxcIiArIGRhdGFJdGVtLm5hbWUgKyBcXFwi44CR77+laG9tZV9ydWxlX3VybO+/pVxcXCIgKyBydWxlTGlzdEpzb24gKyBkYXRhSXRlbS5pZCArIGF1dGg7XFxuICAgICAgICBpbXBvcnRVcmwgPSBcXFwicnVsZTovL1xcXCIgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpXFxuICAgICAgICBicmVhaztcXG4gICAgY2FzZSAncHVibGlzaCc6XFxuICAgICAgICBydWxlQ29kZSA9ICfmtbfpmJTop4bnlYzop4TliJnliIbkuqvvvIzlvZPliY3liIbkuqvnmoTmmK/vvJonICsgZGF0YUl0ZW0ubmFtZSArICfvv6VwdWJsaXNo77+lJyArIGJhc2U2NEVuY29kZShiYWNrQ29kZSk7XFxuICAgICAgICBpbXBvcnRVcmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpO1xcbiAgICAgICAgYnJlYWs7XFxuICAgIGNhc2UgJ2pzX3VybCc6XFxuICAgICAgICBydWxlQ29kZSA9ICfmtbfpmJTop4bnlYzop4TliJnliIbkuqvvvIzlvZPliY3liIbkuqvnmoTmmK/vvJrnvZHpobXmj5Lku7bvv6Vqc191cmzvv6UnICsgZGF0YUl0ZW0ubmFtZSArICdAYmFzZTY0Oi8vJyArIGJhc2U2NEVuY29kZShiYWNrQ29kZSk7XFxuICAgICAgICBpbXBvcnRVcmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpO1xcbiAgICAgICAgYnJlYWs7XFxuICAgIGNhc2UgJ2h0bWwnOlxcbiAgICAgICAgbGV0IGZpbGVfdG1wID0gZGF0YUl0ZW0ubmFtZS5zcGxpdCgnLicpO1xcbiAgICAgICAgbGV0IGZpbGVfcGF0aCA9IGZpbGVfdG1wLmxlbmd0aCA+IDEgPyBmaWxlX3RtcFtmaWxlX3RtcC5sZW5ndGggLSAxXSArIFxcXCIvXFxcIiArIGRhdGFJdGVtLm5hbWUgOiBkYXRhSXRlbS5uYW1lO1xcbiAgICAgICAgcnVsZUNvZGUgPSBcXFwi5rW36ZiU6KeG55WM5pys5Zyw5paH5Lu25YiG5Lqr77+lZmlsZV91cmzvv6VoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvXFxcIiArIGZpbGVfcGF0aCArIFxcXCJAXFxcIiArIHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkICsgYXV0aDtcXG4gICAgICAgIGltcG9ydFVybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShydWxlQ29kZSk7XFxuICAgICAgICBicmVha1xcbiAgICBjYXNlIFxcXCJjb25maWdcXFwiOlxcbiAgICAgICAgaW1wb3J0VXJsID0gJCgpLnJ1bGUocGFzc3dvcmQgPT4ge1xcbiAgICAgICAgICAgIGV2YWwoZmV0Y2goXFxcImhpa2VyOi8vYXNzZXRzL2hvbWUuanNcXFwiKSk7XFxuICAgICAgICAgICAgSGlrZXJIb21lLmxvYWQoXFxcImltcG9ydFxcXCIsIHBhc3N3b3JkKTtcXG4gICAgICAgIH0sIGJhY2tDb2RlKTtcXG4gICAgICAgIGJyZWFrO1xcbn1cXG5sZXQgbXlfY29sX3R5cGUgPSBcXFwidGV4dF8yXFxcIjtcXG5pZiAoaW1wb3J0VXJsKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuWvvOWFpeinhOWImVxcXCIsXFxuICAgICAgICB1cmw6IGltcG9ydFVybCxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcbiAgICB9KTtcXG4gICAgaWYoZGF0YUl0ZW0uaXNfanNvbl9saXN0JiYvaG9tZV9ydWxlX3VybHxodG1sLy50ZXN0KGRhdGFJdGVtLmRhdGFfdHlwZSkpe1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICB0aXRsZTogJ+KAnOKAnOKAneKAnTxzcGFuIHN0eWxlPVxcXCJjb2xvcjogI2ZmNzAwMFxcXCI+5a+85YWl6YGT5b6357uPPC9zcGFuPicsXFxuICAgICAgICAgICAgdXJsOiAkKCkubGF6eVJ1bGUoKGRhdGFJdGVtLHN1YlVybCk9PntcXG4gICAgICAgICAgICAgICAgLy8gbGV0IHRpdGxlID0gXFxcIkgtXFxcIitkYXRhSXRlbS5uYW1lK1xcXCIuXFxcIitkYXRhSXRlbS5hdXRob3I7XFxuICAgICAgICAgICAgICAgIGxldCB0aXRsZSA9IFxcXCJKLVxcXCIrZGF0YUl0ZW0ubmFtZS5zcGxpdCgnLicpWzBdO1xcbiAgICAgICAgICAgICAgICBsZXQgc3ViT2JqID0ge1xcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBzdWJVcmwsXFxuICAgICAgICAgICAgICAgICAgICBkZXNjOiBcXFwiaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlL3J1bGVDYWNoZS9cXFwiK3RpdGxlK1xcXCIuanNvblxcXCIsXFxuICAgICAgICAgICAgICAgICAgICBjb2RlOiBcXFwiXFxcIixcXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZTogZmFsc2UsLy/npoHnlKjlubblj5Hmm7TmlrBcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICBsZXQgc2hhcmVUZXh0ID0gYmFzZTY0RW5jb2RlKEpTT04uc3RyaW5naWZ5KHN1Yk9iaikpO1xcbiAgICAgICAgICAgICAgICB2YXIgcGFzdGVzID0gZ2V0UGFzdGVzKCk7XFxuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBzaGFyZVBhc3RlKHNoYXJlVGV4dCxwYXN0ZXMuc2xpY2UoLTEpWzBdKTtcXG4gICAgICAgICAgICAgICAgbGV0IGltcG9ydF9ydWxlPSBcXFwi6L275ZCI6ZuG6K6i6ZiF77yaXFxcIit0aXRsZSsnXFxcXG4nK3VybDtcXG4gICAgICAgICAgICAgICAgY29weShpbXBvcnRfcnVsZSk7XFxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGggPSAnaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlL3J1bGVDYWNoZS9zdWIuanNvbic7XFxuICAgICAgICAgICAgICAgICQucmMoY29uZmlnLmxpYi5zdWIpO1xcbiAgICAgICAgICAgICAgICByZXR1cm4g6K6i6ZiF5a+85YWlKHBhdGgpXFxuICAgICAgICAgICAgfSxkYXRhSXRlbSxzdWJVcmwpLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcbiAgICAgICAgfSk7XFxuICAgIH1cXG59XFxuaWYgKHJ1bGVDb2RlKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuWIhuS6q+inhOWImVxcXCIsXFxuICAgICAgICB1cmw6IFxcXCJjb3B5Oi8vXFxcIiArIHJ1bGVDb2RlLFxcbiAgICAgICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxuICAgIH0pO1xcbn1cXG5cXG5mdW5jdGlvbiBzZXRTZXR0aW5nSXRlbShiYXNpYywgcGF0dGVybikge1xcbiAgICBsZXQgdGVtcCA9IHtcXG4gICAgICAgIHRpdGxlOiBiYXNpYy50aXRsZSxcXG4gICAgICAgIGNvbF90eXBlOiBiYXNpYy5jb2xfdHlwZSxcXG4gICAgICAgIHVybDogJChiYXNpYy5jb25maXJtKS5jb25maXJtKCh1cmwsIG1zZywgcGF0dGVybikgPT4ge1xcbiAgICAgICAgICAgIGxldCBiYWNrQSA9IHJlcXVlc3QodXJsKTtcXG4gICAgICAgICAgICBsZXQgcmV0ID0gSlNPTi5wYXJzZShiYWNrQSk7XFxuICAgICAgICAgICAgaWYgKHJldC5zdGF0dXMgPT0gMCkge1xcbiAgICAgICAgICAgICAgICBwYXR0ZXJuID8gYmFjaygpIDogcmVmcmVzaFBhZ2UoZmFsc2UpO1xcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vXFxcIiArIG1zZ1swXTtcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICBwYXR0ZXJuID8gYmFjaygpIDogcmVmcmVzaFBhZ2UoZmFsc2UpO1xcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vXFxcIiArIG1zZ1sxXSArIFxcXCJcXFxcblxcXCIgKyByZXQuZGV0YWlsO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0sIGJhc2ljLnVybCwgYmFzaWMubXNnLCBwYXR0ZXJuKVxcbiAgICB9O1xcbiAgICByZXR1cm4gdGVtcDtcXG59XFxuaWYgKGRhdGFJdGVtLnN0YXRlID09ICdwcml2YXRlJykge1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLorr7kuLrlhazlvIBcXFwiLFxcbiAgICAgICAgdXJsOiAkKGdldEFwaShcXFwic2hhcmVcXFwiKSArIHJlcUJ5R2V0ICsgXFxcIiZmbGFnXFxcIiArIFxcXCIjbm9Mb2FkaW5nI1xcXCIpLmxhenlSdWxlKCgpID0+IHtcXG4gICAgICAgICAgICByZXF1ZXN0KGlucHV0KTtcXG4gICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+W3suiuvuS4uuWFrOW8gFxcXCI7XFxuICAgICAgICB9KSxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcbiAgICB9LCB7XFxuICAgICAgICB0aXRsZTogXFxcIumaj+acuuWvhumSpVxcXCIsXFxuICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGUsXFxuICAgICAgICB1cmw6ICQoZ2V0QXBpKFxcXCJnZW5BdXRoXFxcIikgKyByZXFCeUdldCArIFxcXCIjbm9Mb2FkaW5nI1xcXCIpLmxhenlSdWxlKCgpID0+IHtcXG4gICAgICAgICAgICBsZXQgYmFjayA9IHJlcXVlc3QoaW5wdXQpO1xcbiAgICAgICAgICAgIGxldCByZXQgPSBKU09OLnBhcnNlKGJhY2spO1xcbiAgICAgICAgICAgIGlmIChyZXQuc3RhdHVzID09IDApIHtcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5bey55Sf5oiQ6ZqP5py65a+G56CBXFxcXG5cXFwiICsgcmV0LnJlc3VsdFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKHRydWUpO1xcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v6ZqP5py65a+G56CB55Sf5oiQ5aSx6LSlXFxcIlxcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0pXFxuICAgIH0pO1xcbiAgICBsZXQgdGltZU92ZXIgPSB7XFxuICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXG4gICAgfTtcXG4gICAgaWYgKGRhdGFJdGVtLnRpbWVfb3Zlcikge1xcbiAgICAgICAgdGltZU92ZXIudGl0bGUgPSBzbWFsbChjb2xvcihcXFwi55+t5pe25a+G6ZKlXFxcIiwgXFxcImdyZWVuXFxcIikgKyBjb2xvcihcXFwiKOKGkuawuOS5hSlcXFwiLCBcXFwicmVkXFxcIikpO1xcbiAgICAgICAgdGltZU92ZXIudXJsID0gZ2V0QXBpKFxcXCJ0aW1lb3ZlclxcXCIpICsgcmVxQnlHZXQgKyBcXFwiJmZsYWc9MVxcXCI7XFxuICAgICAgICB0aW1lT3Zlci5jb25maXJtID0gXFxcIuaYr+WQpuehruiupOS7peWQjueahOengeiXj+inhOWImeWIhuS6q+S4jei/h+acnz9cXFwiO1xcbiAgICAgICAgdGltZU92ZXIubXNnID0gW1xcXCLlt7Lorr7kuLrmsLjkuYVcXFwiLCBcXFwi6K6+5Li65rC45LmF5aSx6LSlXFxcIl07XFxuICAgIH0gZWxzZSB7XFxuICAgICAgICB0aW1lT3Zlci50aXRsZSA9IHNtYWxsKGNvbG9yKFxcXCLmsLjkuYXlr4bpkqVcXFwiLCBcXFwicmVkXFxcIikgKyBjb2xvcihcXFwiKOKGkuefreaXtilcXFwiLCBcXFwiZ3JlZW5cXFwiKSk7XFxuICAgICAgICB0aW1lT3Zlci51cmwgPSBnZXRBcGkoXFxcInRpbWVvdmVyXFxcIikgKyByZXFCeUdldDtcXG4gICAgICAgIHRpbWVPdmVyLmNvbmZpcm0gPSBcXFwi56Gu6K6k6KaB5Lul5ZCO5YiG5Lqr55qE56eB6JeP6KeE5YiZ6Ieq5Yqo5Yiw5pyfP1xcXCI7XFxuICAgICAgICB0aW1lT3Zlci5tc2cgPSBbXFxcIuW3suiuvuS4uui/h+acn1xcXCIsIFxcXCLorr7kuLrov4fmnJ/lpLHotKVcXFwiXTtcXG4gICAgfVxcbiAgICBkYXRhLnB1c2goc2V0U2V0dGluZ0l0ZW0odGltZU92ZXIpKTtcXG59IGVsc2UgaWYgKGRhdGFJdGVtLnN0YXRlID09ICdwdWJsaWMnKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuiuvuS4uuengeaciVxcXCIsXFxuICAgICAgICB1cmw6ICQoZ2V0QXBpKFxcXCJzaGFyZVxcXCIpICsgcmVxQnlHZXQgKyBcXFwiJmZsYWc9MSNub0xvYWRpbmcjXFxcIikubGF6eVJ1bGUoKCkgPT4ge1xcbiAgICAgICAgICAgIHJlcXVlc3QoaW5wdXQpO1xcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXG4gICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5bey6K6+5Li656eB5pyJXFxcIjtcXG4gICAgICAgIH0pLFxcbiAgICAgICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxuICAgIH0pO1xcbn1cXG5kYXRhLnB1c2goc2V0U2V0dGluZ0l0ZW0oe1xcbiAgICB0aXRsZTogXFxcIuWIoOmZpOaVsOaNrlxcXCIsXFxuICAgIGNvbmZpcm06IFxcXCLmmK/lkKbnoa7orqTliKDpmaRcXFwiLFxcbiAgICBtc2c6IFtcXFwi5bey5Yig6ZmkXFxcIiwgXFxcIuWIoOmZpOWksei0pVxcXCJdLFxcbiAgICB1cmw6IGdldEFwaShcXFwiZGVsZXRlVXJsXFxcIikgKyByZXFCeUdldCxcXG4gICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxufSwgdHJ1ZSkpO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwi6K6+572u5Zu+5qCHXFxcIixcXG4gICAgdXJsOiAkKGRhdGFJdGVtLnBpY191cmwsIFxcXCLovpPlhaXlm77moIflnLDlnYBcXFwiKS5pbnB1dChhcGkgPT4ge1xcbiAgICAgICAgaWYgKGlucHV0ID09PSBcXFwiXFxcIikge1xcbiAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/kvaDlnKjpgJfmiJHpk77mjqXlk6o/XFxcIlxcbiAgICAgICAgfVxcbiAgICAgICAgbGV0IHJlc3VsdCA9IHJlcXVlc3QoYXBpICsgXFxcIiZydWxlX3BpYz1cXFwiICsgaW5wdXQpO1xcbiAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpO1xcbiAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgIT09IDApIHtcXG4gICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vXFxcIiArIHJlc3VsdC5kZXRhaWw7XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5L+u5pS55oiQ5YqfXFxcIjtcXG4gICAgfSwgZ2V0QXBpKFxcXCJzZXRfcnVsZV9waWNcXFwiKSArIGRhdGFJdGVtLmlkICsgcmVxQnlHZXQpLFxcbiAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXG59KTtcXG5cXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogZGF0YUl0ZW0uY2FuX2Rpc2N1c3MgPyBcXFwi56aB5q2i6K+E6K66XFxcIiA6IFxcXCLlvIDlkK/or4TorrpcXFwiLFxcbiAgICB1cmw6ICQoYXBpLmRpc19zZXQgKyBkYXRhSXRlbS5pZCArIHJlcUJ5R2V0ICsgXFxcIiZzdGF0ZT1cXFwiICsgKGRhdGFJdGVtLmNhbl9kaXNjdXNzID8gXFxcIlxcXCIgOiAxKSkubGF6eVJ1bGUoKGNhbl9kaXNjdXNzKSA9PiB7XFxuICAgICAgICByZXF1ZXN0KGlucHV0KTtcXG4gICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXG4gICAgICAgIHJldHVybiBjYW5fZGlzY3VzcyA/IFxcXCJ0b2FzdDovL+W3suemgeatouivhOiuulxcXCIgOiBcXFwidG9hc3Q6Ly/lt7LlvIDlkK/or4TorrpcXFwiO1xcbiAgICB9LCBkYXRhSXRlbS5jYW5fZGlzY3VzcyksXFxuICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcbn0pO1xcbk1ZX1BBUkFNUy5uYW1lID0gZGF0YUl0ZW0ubmFtZTtcXG5NWV9QQVJBTVMudXNlcm5hbWU9dXNlcm5hbWU7XFxuTVlfUEFSQU1TLnBhc3N3b3JkPXBhc3N3b3JkO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwi6K6+572u5aSH5rOoXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL3NldF9ydWxlX25vdGVzXFxcIixcXG4gICAgZXh0cmE6IE1ZX1BBUkFNUyxcXG4gICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxufSk7XFxuaWYgKGRhdGFJdGVtLmlzX2pzb24gJiYgZGF0YUl0ZW0uZGF0YV90eXBlID09PSBcXFwiaG9tZV9ydWxlX3VybFxcXCIgJiYgIWRhdGFJdGVtLmlzX2pzb25fbGlzdCkge1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6ICfov5vlhaXpopHpgZMnLFxcbiAgICAgICAgdXJsOiAkKCAvKlxcXCIjbm9Mb2FkaW5nI1xcXCIqLyApLmxhenlSdWxlKChuYW1lLGhvbWUpID0+IHtcXG4gICAgICAgICAgICBsZXQgcnVsZUxpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoaG9tZSkpO1xcbiAgICAgICAgICAgIGxldCBoYXNSdWxlID0gcnVsZUxpc3Quc29tZShpdGVtID0+IGl0ZW0udGl0bGUgPT09IG5hbWUpO1xcbiAgICAgICAgICAgIGlmIChoYXNSdWxlKSB7XFxuICAgICAgICAgICAgICAgIHB1dFZhcihcXFwiV2FyZWhvdXNlLmJhY2tcXFwiLCBcXFwiMVxcXCIpO1xcbiAgICAgICAgICAgICAgICBiYWNrKCk7XFxuICAgICAgICAgICAgICAgIHJldHVybiBob21lK1xcXCJzQFxcXCIgKyBuYW1lO1xcbiAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/mnKrlronoo4VcXFwiO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0sIGRhdGFJdGVtLm5hbWUsYXBpLmhvbWUpLFxcbiAgICAgICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxuICAgIH0pO1xcbn1cXG5kYXRhLnB1c2goe1xcbiAgICBjb2xfdHlwZTogXFxcImxpbmVfYmxhbmtcXFwiXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IGRhdGFJdGVtLmdvb2RfbnVtLFxcbiAgICBwaWNfdXJsOiBcXFwiaGlrZXI6Ly9maWxlcy9pY29uL+i1ni5zdmdcXFwiLFxcbiAgICBjb2xfdHlwZTogXFxcImljb25fc21hbGxfM1xcXCIsXFxuICAgIHVybDogXFxcImhpa2VyOi8vZW1wdHlcXFwiXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IGRhdGFJdGVtLmJhZF9udW0sXFxuICAgIHBpY191cmw6IFxcXCJoaWtlcjovL2ZpbGVzL2ljb24v6LipLnN2Z1xcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwiaWNvbl9zbWFsbF8zXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCJcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogXFxcIuivhOiuulxcXCIsXFxuICAgIHBpY191cmw6IFxcXCJoaWtlcjovL2ZpbGVzL2ljb24v6K+E6K66LnN2Z1xcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwiaWNvbl9zbWFsbF8zXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL1JlcGx5I25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXCIsXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICBydWxlSWQ6IGRhdGFJdGVtLmlkLFxcbiAgICAgICAgbmFtZTogZGF0YUl0ZW0uYXV0aG9yLFxcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkLFxcbiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lXFxuICAgIH1cXG59KTtcXG5sZXQgdG90YWxTdW0gPSBkYXRhSXRlbS5nb29kX251bSArIGRhdGFJdGVtLmJhZF9udW07XFxuXFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IGh0bWxUYWcoXFxcImJpZ1xcXCIsIFxcXCLor4TorrooXFxcIiArIHRvdGFsU3VtICsgXFxcIilcXFwiKSArIFxcXCJcXFxcdFxcXFx0XFxcXHRcXFwiICsgc21hbGwoaHRtbFRhZyhcXFwidVxcXCIsIFxcXCLmn6XnnIvlhajpg6jor4Torroo5o6n6K+EKSA+XFxcIikpLFxcbiAgICBjb2xfdHlwZTogXFxcInRleHRfMVxcXCIsXFxuICAgIHVybDogXFxcImhpa2VyOi8vcGFnZS9Db21tZW50XFxcIixcXG4gICAgZXh0cmE6IHtcXG4gICAgICAgIHVybDogXFxcImhpa2VyOi8vZW1wdHkjZnlwYWdlI25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXCIsXFxuICAgICAgICBpZDogZGF0YUl0ZW0uaWQsXFxuICAgICAgICB0b3RhbFN1bTogdG90YWxTdW0sXFxuICAgICAgICBub19hY3RpdmU6IHRydWUsXFxuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXFxuICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcXG4gICAgfVxcbn0pO1xcbi8vY29uc3QgbG9uZ2VzdFN1bT0xMjA7XFxubGV0IGljb24gPSB7XFxuICAgIFxcXCJnb29kXFxcIjogXFxcIvCfkY1cXFwiLFxcbiAgICBcXFwiYmFkXFxcIjogXFxcIvCfkY5cXFwiLFxcbiAgICBcXFwicmVwbHlcXFwiOiBcXFwi5byA5Y+R6ICF8J+Xo1xcXCJcXG59XFxuaWYgKHRvdGFsU3VtID09PSAwKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIjxoNSBzdHlsZT0ndGV4dC1hbGlnbjpjZW50ZXInPuS4gOadoeivhOiuuuS5n+ayoeacie+8jOW/q+adpeaKouaymeWPkeWQp++8gTwvaDU+XFxcIixcXG4gICAgICAgIGNvbF90eXBlOiBcXFwicmljaF90ZXh0XFxcIlxcbiAgICB9KTtcXG59IGVsc2Uge1xcbiAgICBsZXQgY29tbWVudExpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoYXBpLmRpc19nZXQgKyBkYXRhSXRlbS5pZCArIFxcXCI/bGltaXQ9NVxcXCIpKS5yZXN1bHQ7XFxuICAgIGZvciAobGV0IGl0ZW0gb2YgY29tbWVudExpc3QpIHtcXG4gICAgICAgIGxldCBSZXBseSA9IGl0ZW0uZGlzY3Vzc190eXBlPT09XFxcInJlcGx5XFxcIiYmaXRlbS5yZXBseV90b19uYW1lIT09ZmFsc2UmJml0ZW0ucmVwbHlfdG9faWQhPT1mYWxzZT9cXFwi4oCY4oCY5Zue5aSNQFxcXCIraXRlbS5yZXBseV90b19uYW1lK1xcXCIgI1xcXCIraXRlbS5kaXNjdXNzX2lkK1xcXCLigJnigJlcXFxcblxcXCI6XFxcIlxcXCI7XFxuICAgICAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLm5hbWUgKyBcXFwiJm5ic3A7Jm5ic3A7PGZvbnQgY29sb3I9J2dyYXknPjxzbWFsbD4jXFxcIiArIGl0ZW0uaWQgKyBcXFwiPC9zbWFsbD48Zm9udD5cXFwiLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwiYXZhdGFyXFxcIixcXG4gICAgICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvUmVwbHlcXFwiLFxcbiAgICAgICAgICAgIGV4dHJhOntcXG4gICAgICAgICAgICAgICAgcnVsZUlkOiBkYXRhSXRlbS5pZCxcXG4gICAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQsXFxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcXG4gICAgICAgICAgICAgICAgcmVwbHlJZDppdGVtLmlkXFxuICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICBwaWNfdXJsOiBpdGVtLmF2YXRhcl91cmxcXG4gICAgICAgIH0pO1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICB0aXRsZTogaXRlbS5kaXNjdXNzX3RleHQsXFxuICAgICAgICAgICAgZGVzYzogUmVwbHkraXRlbS5jcmVhdGVfZGF0ZSArIFxcXCLCt1xcXCIgKyBpY29uW2l0ZW0uZGlzY3Vzc190eXBlXSxcXG4gICAgICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfMVxcXCIsXFxuICAgICAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL2luZm9cXFwiLFxcbiAgICAgICAgICAgIGV4dHJhOiB7XFxuICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcXG4gICAgICAgICAgICAgICAgdHlwZTogXFxcImxvbmdfdGV4dFxcXCIsXFxuICAgICAgICAgICAgICAgIHRleHQ6IGl0ZW0uZGlzY3Vzc190ZXh0XFxuICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICBwaWNfdXJsOiBpdGVtLmF2YXRhcl91cmxcXG4gICAgICAgIH0pO1xcbiAgICB9XFxufVxcbmRhdGEucHVzaCh7XFxuICAgIGNvbF90eXBlOiBcXFwibGluZV9ibGFua1xcXCJcXG59KTtcXG5zZXRSZXN1bHQoZGF0YSk7XCJ9LHtcImNvbF90eXBlXCI6XCJpY29uXzJfcm91bmRcIixcIm5hbWVcIjpcIuinhOWImeWIl+ihqFwiLFwicGF0aFwiOlwicnVsZXNcIixcInJ1bGVcIjpcImpzOlxcbiAgICBhZGRMaXN0ZW5lcignb25DbG9zZScsJC50b1N0cmluZygoKT0+e1xcbiAgICAgICAgY2xlYXJWYXIoXFxcIldhcmVob3VzZS5iYWNrXFxcIik7XFxuICAgICAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLmZpbHRlclxcXCIpO1xcbiAgICAgICAgY2xlYXJWYXIoXFxcIldhcmVob3VzZS50eXBlXFxcIik7XFxuICAgICAgICBpZihnZXRWYXIoJ1dhcmVob3VzZS5jYW5fdXBsb2FkJywnJykpe1xcbiAgICAgICAgICAgIGxvZygn5pON5L2c6L+H56aB5q2i5LiK5LygOicrZ2V0VmFyKCdXYXJlaG91c2UuY2FuX3VwbG9hZCcpKTtcXG4gICAgICAgICAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLmNhbl91cGxvYWRcXFwiKTtcXG4gICAgICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXG4gICAgICAgIH1cXG4gICAgfSkpO1xcblxcbmlmIChnZXRWYXIoXFxcIldhcmVob3VzZS5iYWNrXFxcIikgPT09IFxcXCIxXFxcIikge1xcbiAgICBiYWNrKGZhbHNlKTtcXG59XFxuXFxuY29uc3Qge1xcbiAgICBnZXRBcGksXFxuICAgIGFwaSxcXG4gICAgY29sb3IsXFxuICAgIHNtYWxsLFxcbiAgICBsb2NhbFJ1bGVWZXIsXFxuICAgIGh0bWxUYWcsXFxuICAgIG1kXFxufSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXCIpO1xcbmNvbnN0IHsgbm9ybWFsU29ydCB9ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2Uvc29ydFxcXCIpO1xcbmxldCB7XFxuICAgIGF2YXRhclVybCxcXG4gICAgcXEsXFxuICAgIGlkLFxcbiAgICBjYW5fdXBsb2FkXFxufSA9IE1ZX1BBUkFNUztcXG5sZXQgZGF0YVR5cGUgPSBnZXRWYXIoXFxcIldhcmVob3VzZS50eXBlXFxcIixcXFwiXFxcIik7XFxubGV0IGJhY2tDb2RlID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldEFwaShcXFwicnVsZXNVcmxcXFwiKSArIFxcXCI/bmFtZT1cXFwiICsgcXErXFxcIiZkYXRhX3R5cGU9XFxcIitkYXRhVHlwZSkpO1xcbmxldCBkZXZOYW1lID0gYmFja0NvZGUuZGV2X25hbWU7XFxucHV0VmFyKFxcXCJXYXJlaG91c2UuZmlsdGVyXFxcIiwgZGV2TmFtZSk7XFxubGV0IHJ1bGVMaXN0ID0gYmFja0NvZGUucmVzdWx0O1xcbmxldCBzdWJVcmwgPSBnZXRBcGkoXFxcImpzb25MaXN0XFxcIikgKyBcXFwiP25hbWU9XFxcIiArIHFxO1xcbmxldCBoYXNTdWIgPSBoYXNIb21lU3ViKHN1YlVybCk7XFxubGV0IGRldkluZm8gPSBcXFwi6L+Z5Liq5Lq65b6I5oeSLOS7gOS5iOmDveayoeWGmeWTpn5cXFwiO1xcbmxldCB0bXBKc29uID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldEFwaShcXFwiaW5mb0dldFVybFxcXCIpICsgcXEpKTtcXG5pZiAodG1wSnNvbi5zdGF0dXMgPT0gMCkge1xcbiAgICBkZXZJbmZvID0gdG1wSnNvbi5yZXN1bHQgfHwgZGV2SW5mbztcXG59XFxubGV0IHN1YkZsYWcgPSBoYXNTdWIgPyAn8J+GlycgOiAn8J+ToSc7XFxubGV0IGRhdGEgPSBbXTtcXG5yZXF1aXJlKG1kKTtcXG5kZXZJbmZvPW1hcmtlZC5wYXJzZShkZXZJbmZvKTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogXFxcIuKAnOKAnOKAneKAnVxcXCIgKyBkZXZOYW1lICsgXFxcIlxcXFxuXFxcXG5cXFwiICsgc21hbGwoaHRtbFRhZyhcXFwidVxcXCIsIFxcXCLngrnlh7vmn6XnnIvlrozmlbTlhazlkYpcXFwiKSksXFxuICAgIGRlc2M6IHNtYWxsKGRldkluZm8pLFxcbiAgICB1cmw6ICdoaWtlcjovL3BhZ2UvaW5mbycsXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICB0ZXh0OiBkZXZJbmZvLFxcbiAgICAgICAgbmFtZTogZGV2TmFtZSxcXG4gICAgICAgIHR5cGU6XFxcInJpY2hfdGV4dFxcXCJcXG4gICAgfSxcXG4gICAgcGljX3VybDogYXZhdGFyVXJsLFxcbiAgICBjb2xfdHlwZTogJ21vdmllXzFfdmVydGljYWxfcGljJ1xcbn0pO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwiPGJpZz7orqLpmIXnrqHnkIY8L2JpZz4mbmJzcDsmbmJzcDs8c21hbGw+KOW9k+WJjVxcXCIgKyAoaGFzU3ViID8gXFxcIuW3suiuoumYhVxcXCIgOiBcXFwi5pyq6K6i6ZiFXFxcIikgKyBcXFwiKTwvc21hbGw+XFxcIixcXG4gICAgY29sX3R5cGU6IFxcXCJyaWNoX3RleHRcXFwiXFxufSk7XFxuXFxubGV0IHN1Yl9jb2RlID0gJ+a1t+mYlOinhueVjOWQiOmbhuinhOWImeiuoumYhe+/pWhvbWVfc3Vi77+lJyArIGRldk5hbWUgKyBcXFwi5ZCI6ZuGQEBcXFwiICsgc3ViVXJsO1xcbmxldCBydWxlc0NvZGUgPSAn5rW36ZiU6KeG55WM5ZCI6ZuG6KeE5YiZ77+laG9tZV9ydWxlX3VybO+/pScgKyBzdWJVcmw7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6ICfigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFwiY29sb3I6ICNmZjcwMDBcXFwiPuS4gOmUruiuoumYhTwvc3Bhbj4nLFxcbiAgICBkZXNjOiAn6K6i6ZiF4oCc4oCc4oCd4oCdPHNwYW4gc3R5bGU9XFxcImNvbG9yOiAjNWNmZjJjXFxcIj4nICsgZGV2TmFtZSArICc8L3NwYW4+55qE5omA5pyJ5Y2V6KeE5YiZ77yM5ZCI6ZuG6ZyA5Y2V54us6K6i6ZiFJyxcXG4gICAgdXJsOiBzdWJfY29kZSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzInXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6ICfigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFwiY29sb3I6ICNmZjcwMDBcXFwiPuWvvOWFpeWFqOmDqDwvc3Bhbj4nLFxcbiAgICB1cmw6IHJ1bGVzQ29kZSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzInXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6ICfigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFwiY29sb3I6ICNmZjcwMDBcXFwiPuWvvOWFpei9u+WQiOmbhjwvc3Bhbj4nLFxcbiAgICB1cmw6ICQoKS5sYXp5UnVsZSgoZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKT0+e1xcbiAgICAgICAgY29uc3Qge2dlblJ1bGV9PSQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL2dlbkFwaVxcXCIpO1xcbiAgICAgICAgbG9nKFxcXCLovbvlkIjpm4blm77moIfpk77mjqU6XFxcIithdmF0YXJVcmwpO1xcbiAgICAgICAgbGV0IGltcG9ydF9ydWxlPWdlblJ1bGUoXFxcIui9u+WQiOmbhi5cXFwiK2Rldk5hbWUsc3ViVXJsLGF2YXRhclVybCk7XFxuICAgICAgICAvL2NvcHkoaW1wb3J0X3J1bGUpO1xcbiAgICAgICAgbGV0IHJ1bGVDb2RlPXBhcnNlUGFzdGUoaW1wb3J0X3J1bGUuc3BsaXQoXFxcIlxcXFxuXFxcIilbMF0pO1xcbiAgICAgICAgLy9yZXR1cm4gXFxcImhpa2VyOi8vZW1wdHlcXFwiXFxuICAgICAgICBpbXBvcnRVcmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpO1xcbiAgICAgICAgcmV0dXJuIGltcG9ydFVybFxcbiAgICB9LGRldk5hbWUsc3ViVXJsLGF2YXRhclVybCksXFxuICAgIGNvbF90eXBlOiAndGV4dF8yJ1xcbn0pO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiAn4oCc4oCc4oCd4oCdPHNwYW4gc3R5bGU9XFxcImNvbG9yOiAjZmY3MDAwXFxcIj7lr7zlhaXpgZPlvrfnu488L3NwYW4+JyxcXG4gICAgdXJsOiAkKCkubGF6eVJ1bGUoKGRldk5hbWUsc3ViVXJsLGF2YXRhclVybCk9PntcXG4gICAgICAgIGxldCB0aXRsZSA9IFxcXCJILVxcXCIrZGV2TmFtZTtcXG4gICAgICAgIGxldCBzdWJPYmogPSB7XFxuICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxcbiAgICAgICAgICAgIHVybDogc3ViVXJsLFxcbiAgICAgICAgICAgIGRlc2M6IFxcXCJoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvcnVsZUNhY2hlL1xcXCIrdGl0bGUrXFxcIi5qc29uXFxcIixcXG4gICAgICAgICAgICBjb2RlOiBcXFwiXFxcIixcXG4gICAgICAgICAgICBhY3RpdmU6IGZhbHNlLC8v56aB55So5bm25Y+R5pu05pawXFxuICAgICAgICB9XFxuICAgICAgICBsZXQgc2hhcmVUZXh0ID0gYmFzZTY0RW5jb2RlKEpTT04uc3RyaW5naWZ5KHN1Yk9iaikpO1xcbiAgICAgICAgdmFyIHBhc3RlcyA9IGdldFBhc3RlcygpO1xcbiAgICAgICAgdmFyIHVybCA9IHNoYXJlUGFzdGUoc2hhcmVUZXh0LHBhc3Rlcy5zbGljZSgtMSlbMF0pO1xcbiAgICAgICAgbGV0IGltcG9ydF9ydWxlPSBcXFwi6L275ZCI6ZuG6K6i6ZiF77yaXFxcIit0aXRsZSsnXFxcXG4nK3VybDtcXG4gICAgICAgIGNvcHkoaW1wb3J0X3J1bGUpO1xcbiAgICAgICAgY29uc3QgcGF0aCA9ICdoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvcnVsZUNhY2hlL3N1Yi5qc29uJztcXG4gICAgICAgICQucmMoY29uZmlnLmxpYi5zdWIpO1xcbiAgICAgICAgcmV0dXJuIOiuoumYheWvvOWFpShwYXRoKVxcbiAgICB9LGRldk5hbWUsc3ViVXJsLGF2YXRhclVybCksXFxuICAgIGNvbF90eXBlOiAndGV4dF8yJ1xcbn0pO1xcbmxldCBjYW5fdXBsb2FkX2FwaSA9IGdldEFwaShcXFwibWFuQ2FuVXBsb2FkXFxcIikraWQ7XFxuaWYoZ2V0VmFyKCdob3VzZS5pc19tYW5hZ2VyJykpe1xcbiAgICBsZXQgdGlwcyA9IGNhbl91cGxvYWQ/J+iDvSc6J+WQpic7XFxuICAgIC8vIGxvZygndGlwczonK3RpcHMpO1xcbiAgICAvLyBsb2coJ2Nhbl91cGxvYWQ6JytjYW5fdXBsb2FkKTtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOifimqDog73lkKbkuIrkvKA6JysoZ2V0VmFyKCdXYXJlaG91c2UuY2FuX3VwbG9hZCcpfHx0aXBzKSxcXG4gICAgICAgIGNvbF90eXBlOidzY3JvbGxfYnV0dG9uJyxcXG4gICAgICAgIHVybDonaGlrZXI6Ly9lbXB0eSdcXG4gICAgfSk7XFxuICAgIGZ1bmN0aW9uIHNldFVwbG9hZChmbGFnLGNhbl91cGxvYWRfYXBpKSB7XFxuICAgICAgICBmbGFnID0gZmxhZyB8fCAnJztcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgbGV0IGNvZGUgPSBmZXRjaChjYW5fdXBsb2FkX2FwaSwge1xcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XFxcIlVzZXItQWdlbnRcXFwiOiBNT0JJTEVfVUF9LFxcbiAgICAgICAgICAgICAgICBib2R5OiB7XFxuICAgICAgICAgICAgICAgICAgICBcXFwicGFyYW1zXFxcIjpcXG4gICAgICAgICAgICAgICAgICAgICAgICB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcXCJ1c2VybmFtZVxcXCI6IGdldFZhcignaG91c2UudXNlcm5hbWUnKSxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcInBhc3N3b3JkXFxcIjogZ2V0VmFyKCdob3VzZS5wYXNzd29yZCcpLFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFwiY2FuX3VwbG9hZFxcXCI6ICEhZmxhZ1xcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgIGNvZGUgPSBKU09OLnBhcnNlKGNvZGUpLnJlc3VsdDtcXG4gICAgICAgICAgICBpZiAoY29kZS5zdGF0dXMgPT09IDApIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvZGUuZGV0YWlsXFxuICAgICAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuICfmk43kvZzlpLHotKU6JyArIGNvZGUuZGV0YWlsXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgICAgIHJldHVybiAn5pON5L2c5aSx6LSlOicgKyBlLm1lc3NhZ2VcXG4gICAgICAgIH1cXG4gICAgfVxcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6J/CfmqvnpoHmraLkuIrkvKAnLFxcbiAgICAgICAgY29sX3R5cGU6J3Njcm9sbF9idXR0b24nLFxcbiAgICAgICAgdXJsOiQoJ+emgeatouivpeW8gOWPkeiAheS4iuS8oOinhOWImT/kvaDnmoTmk43kvZzlsIbooqvns7vnu5/orrDlvZUnKS5jb25maXJtKChpZCxjYW5fdXBsb2FkX2FwaSxzZXRVcGxvYWQpPT57XFxuICAgICAgICAgICAgbGV0IHJldCA9IHNldFVwbG9hZChmYWxzZSxjYW5fdXBsb2FkX2FwaSk7XFxuICAgICAgICAgICAgaWYoIS/mk43kvZzlpLHotKUvLnRlc3QocmV0KSl7XFxuICAgICAgICAgICAgICAgIHB1dFZhcignV2FyZWhvdXNlLmNhbl91cGxvYWQnLCflkKYnKTtcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8vJytyZXRcXG4gICAgICAgIH0saWQsY2FuX3VwbG9hZF9hcGksc2V0VXBsb2FkKVxcbiAgICB9KTtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOifinIXlhYHorrjkuIrkvKAnLFxcbiAgICAgICAgY29sX3R5cGU6J3Njcm9sbF9idXR0b24nLFxcbiAgICAgICAgdXJsOiQoJ+WFgeiuuOivpeW8gOWPkeiAheS4iuS8oOinhOWImT/kvaDnmoTmk43kvZzlsIbooqvns7vnu5/orrDlvZUnKS5jb25maXJtKChpZCxjYW5fdXBsb2FkX2FwaSxzZXRVcGxvYWQpPT57XFxuICAgICAgICAgICAgbGV0IHJldCA9IHNldFVwbG9hZCh0cnVlLGNhbl91cGxvYWRfYXBpKTtcXG4gICAgICAgICAgICBpZighL+aTjeS9nOWksei0pS8udGVzdChyZXQpKXtcXG4gICAgICAgICAgICAgICAgcHV0VmFyKCdXYXJlaG91c2UuY2FuX3VwbG9hZCcsJ+aYrycpO1xcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly8nK3JldFxcbiAgICAgICAgfSxpZCxjYW5fdXBsb2FkX2FwaSxzZXRVcGxvYWQpXFxuICAgIH0pO1xcbn1cXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogXFxcIjxzbWFsbD7mj5DnpLrvvJrlvIDlj5HogIXljZXni6zliIbkuqvnmoTlkIjpm4bmlofku7blj6rog73ljZXni6zlr7zlhaXjgII8L3NtYWxsPlxcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwicmljaF90ZXh0XFxcIlxcbn0pO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwiPGJpZz7op4TliJnliJfooag8L2JpZz4mbmJzcDsmbmJzcDs8c21hbGw+KOWFsVxcXCIgKyBydWxlTGlzdC5sZW5ndGggKyBcXFwi5p2hKTwvc21hbGw+XFxcIixcXG4gICAgY29sX3R5cGU6IFxcXCJyaWNoX3RleHRcXFwiXFxufSk7XFxubGV0IGRhdGFUeXBlTGlzdCA9IHtcXG4gICAgXFxcIlxcXCI6XFxcIuWFqOmDqFxcXCIsXFxuICAgIFxcXCJob21lX3J1bGVfdXJsXFxcIjogJ+Wwj+eoi+W6jycsXFxuICAgIC8vXFxcInB1Ymxpc2hcXFwiOiAn5o+Q5Lqk5LqR5LuT5bqT6KeE5YiZJyxcXG4gICAgXFxcImpzX3VybFxcXCI6ICfnvZHpobXmj5Lku7YnLFxcbiAgICBcXFwiaHRtbFxcXCI6ICfpnZnmgIHpobXpnaInLFxcbiAgICBcXFwiY29uZmlnXFxcIjogJ+S4u+mimCdcXG59O1xcbmZvcihsZXQga2V5IGluIGRhdGFUeXBlTGlzdCl7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTpkYXRhVHlwZT09PWtleT9cXFwi4oCc4oCcXFxcIitkYXRhVHlwZUxpc3Rba2V5XStcXFwi4oCd4oCdXFxcIjpkYXRhVHlwZUxpc3Rba2V5XSxcXG4gICAgICAgIHVybDokKFxcXCIjbm9Mb2FkaW5nI1xcXCIpLmxhenlSdWxlKChrZXkpPT57XFxuICAgICAgICAgICAgcHV0VmFyKFxcXCJXYXJlaG91c2UudHlwZVxcXCIsa2V5KTtcXG4gICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJoaWtlcjovL2VtcHR5XFxcIjtcXG4gICAgICAgIH0sa2V5KSxcXG4gICAgICAgIGNvbF90eXBlOlxcXCJzY3JvbGxfYnV0dG9uXFxcIlxcbiAgICB9KTtcXG59XFxuaWYgKHJ1bGVMaXN0Lmxlbmd0aCA+IDIwKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuaQnOe0olxcXCIsXFxuICAgICAgICB1cmw6ICQudG9TdHJpbmcobmFtZSA9PiBcXFwiaGlrZXI6Ly9zZWFyY2g/cz1cXFwiICsgaW5wdXQgKyBcXFwiJnJ1bGU9XFxcIiArIG5hbWUsIE1ZX1JVTEUudGl0bGUpLFxcbiAgICAgICAgY29sX3R5cGU6IFxcXCJpbnB1dFxcXCIsXFxuICAgICAgICBkZXNjOiBcXFwi5pCc57Si5b2T5YmN5byA5Y+R6ICF55qE6KeE5YiZXFxcIlxcbiAgICB9KTtcXG59XFxubGV0IGhvbWVMaXN0ID0gSlNPTi5wYXJzZShyZXF1ZXN0KGFwaS5ob21lKSk7XFxubGV0IG1SdWxlTGlzdCA9IFtdO1xcbmZvciAodmFyIGl0ZW0gb2YgcnVsZUxpc3QpIHtcXG4gICAgdmFyIG5hbWUgPSBpdGVtLm5hbWU7XFxuICAgIGlmIChpdGVtLmlzX3RhcCkge1xcbiAgICAgICAgbGV0IGxvY2F0aW9uID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldEFwaShcXFwicnVsZUxpc3RKc29uXFxcIikgKyBcXFwiP2lkPVxcXCIgKyBpdGVtLmlkKSk7XFxuICAgICAgICBpdGVtLmlkID0gbG9jYXRpb24uaWQ7XFxuICAgICAgICBpdGVtLm5hbWUgPSBsb2NhdGlvbi5uYW1lO1xcbiAgICAgICAgaXRlbS5hdXRob3IgPSBsb2NhdGlvbi5hdXRob3I7XFxuICAgICAgICBpdGVtLmRhdGFfdHlwZSA9IGxvY2F0aW9uLmRhdGFfdHlwZTtcXG4gICAgICAgIGl0ZW0udmVyID0gbG9jYXRpb24udmVyXFxuICAgIH1cXG4gICAgaXRlbS52ZXJzaW9uID0gaXRlbS52ZXI7XFxuICAgIGxldCBsYWJlbCA9IFxcXCJcXFwiLFxcbiAgICAgICAgbHZlciA9IC0yO1xcbiAgICBpZiAoaXRlbS5pc19qc29uICYmIGl0ZW0uZGF0YV90eXBlID09PSBcXFwiaG9tZV9ydWxlX3VybFxcXCIpIHtcXG4gICAgICAgIGx2ZXIgPSBsb2NhbFJ1bGVWZXIoaG9tZUxpc3QsIGl0ZW0pO1xcbiAgICAgICAgaWYgKGx2ZXIgPT09IC0xKSB7XFxuICAgICAgICAgICAgbGFiZWwgPSBcXFwi8J+GlVxcXCI7XFxuICAgICAgICB9IGVsc2UgaWYgKGx2ZXIgPCBpdGVtLnZlcikge1xcbiAgICAgICAgICAgIGxhYmVsID0gXFxcIvCfhplcXFwiO1xcbiAgICAgICAgfVxcbiAgICB9XFxuICAgIG1SdWxlTGlzdC5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBsYWJlbCArIG5hbWUsXFxuICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvcnVsZURldGFpbCNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFwiLFxcbiAgICAgICAgZXh0cmE6IHtcXG4gICAgICAgICAgICBsdmVyOiBsdmVyLFxcbiAgICAgICAgICAgIGlkOiBpdGVtLmlkXFxuICAgICAgICB9LFxcbiAgICAgICAgcGljX3VybDogaXRlbS5waWMsXFxuICAgIH0pO1xcbn1cXG4vKiDlvZLlubbmjpLluo8gU3RhcnQgKi9cXG5pZihnZXRJdGVtKFxcXCLmjpLluo9cXFwiLFxcXCLml7bpl7TkvJjlhYhcXFwiKT09PSfmlrDniYjkvJjlhYgnKXtcXG4gICAgbVJ1bGVMaXN0ID0gbm9ybWFsU29ydChtUnVsZUxpc3QpO1xcbn1cXG4vKiDlvZLlubbmjpLluo8gRW5kICovXFxuZGF0YS5wdXNoLmFwcGx5KGRhdGEsIG1SdWxlTGlzdClcXG5zZXRSZXN1bHQoZGF0YSk7XFxuXCJ9LHtcImNvbF90eXBlXCI6XCJtb3ZpZV8zXCIsXCJuYW1lXCI6XCLop4TliJnor6bnu4YtdXNlclwiLFwicGF0aFwiOlwicnVsZURldGFpbFwiLFwicnVsZVwiOlwianM6XFxuICAgIGNvbnN0IHtcXG4gICAgICAgIGdldEFwaSxcXG4gICAgICAgIGNvbG9yLFxcbiAgICAgICAgc21hbGwsXFxuICAgICAgICBodG1sVGFnLFxcbiAgICAgICAgYXBpLFxcbiAgICAgICAgbWRcXG4gICAgfSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXCIpO1xcbmxldCB7XFxuICAgIGlkLFxcbiAgICBsdmVyLFxcbiAgICBpc0FsbFxcbn0gPSBNWV9QQVJBTVM7XFxuaWYoZ2V0UGFyYW0oXFxcImlkXFxcIikpe1xcbiAgICBpc0FsbCA9IHRydWU7XFxuICAgIGlkID0gZ2V0UGFyYW0oXFxcImlkXFxcIik7XFxuICAgIGx2ZXIgPSBsdmVyIHx8IFxcXCLmnKrojrflj5bniYjmnKzlj7dcXFwiO1xcbn1cXG5hZGRMaXN0ZW5lcignb25DbG9zZScsICQudG9TdHJpbmcoKGlzQWxsKSA9PiB7XFxuICAgIGlmKCFpc0FsbCl7XFxuICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxuICAgIH1cXG59LGlzQWxsKSk7XFxubGV0IGRhdGFJdGVtID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldEFwaShcXFwiZ2V0YnlpZFxcXCIpICsgXFxcIj9pZD1cXFwiICsgaWQpKS5yZXN1bHQ7XFxuc2V0UGFnZVRpdGxlKFxcXCLjgIxcXFwiICsgZGF0YUl0ZW0ubmFtZSArIFxcXCLjgI1cXFwiKVxcbmxldCBydWxlTGlzdEpzb24gPSBnZXRBcGkoXFxcInJ1bGVMaXN0SnNvblxcXCIpICsgXFxcIj9pZD1cXFwiO1xcbmxldCBkYXRhID0gW107XFxudmFyIGhhc1N1YiA9IGZhbHNlO1xcblxcbmlmIChkYXRhSXRlbS5pc19qc29uX2xpc3QpIHtcXG4gICAgaGFzU3ViID0gaGFzSG9tZVN1YihydWxlTGlzdEpzb24gKyBkYXRhSXRlbS5pZCk7XFxufSBlbHNlIGlmICghZGF0YUl0ZW0uaXNfanNvbl9saXN0ICYmIGRhdGFJdGVtLmRhdGFfdHlwZSA9PSAnaG9tZV9ydWxlX3VybCcpIHtcXG4gICAgaGFzU3ViID0gaGFzSG9tZVN1YihydWxlTGlzdEpzb24gKyBkYXRhSXRlbS5pZCArICcmZGVidWc9dHJ1ZScpO1xcbn1cXG5cXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogaHRtbFRhZyhcXFwiYmlnXFxcIiwgXFxcIueJiOacrFxcXCIpLFxcbiAgICBkZXNjOiBcXFwi4oCc4oCc4oCd4oCd5byA5Y+R6ICF77yaXFxcIiArIGNvbG9yKGRhdGFJdGVtLmF1dGhvciwgXFxcIiMyMjhCRTZcXFwiKSArIFxcXCJcXFxcbuS6keerr+eJiOacrO+8mlxcXCIgKyBjb2xvcihkYXRhSXRlbS52ZXIsIFxcXCIjNWNmZjJjXFxcIikgKyBcXFwiXFxcXHRcXFxcdOacrOWcsOeJiOacrO+8mlxcXCIgKyBjb2xvcihsdmVyLCBcXFwiIzVjZmYyY1xcXCIpICsgXFxcIlxcXFxu5pu05paw5LqOOiBbXFxcIiArIGNvbG9yKGRhdGFJdGVtLmxhc3RfdXBkYXRlLCBcXFwiI2ZmNzAwMFxcXCIpICsgXFxcIl1cXFwiLFxcbiAgICB1cmw6ICQoXFxcIjzlvIDlj5HogIU+XFxcXG5cXFwiICsgZGF0YUl0ZW0uYXV0aG9yICsgXFxcIlxcXFxuPOWQjeensD5cXFxcblxcXCIgKyBkYXRhSXRlbS5uYW1lICsgXFxcIlxcXFxuPOS6keerr+eJiOacrD5cXFxcblxcXCIgKyBkYXRhSXRlbS52ZXIgKyBcXFwiXFxcXG485pys5Zyw54mI5pysPlxcXFxuXFxcIiArIGx2ZXIgKyBcXFwiXFxcXG485pu05paw5pe26Ze0PlxcXFxuW1xcXCIgKyBkYXRhSXRlbS5sYXN0X3VwZGF0ZSArIFxcXCJdXFxcIikuY29uZmlybSgoKSA9PiB7fSksXFxuICAgIGNvbF90eXBlOiAndGV4dF8xJ1xcbn0pO1xcbmxldCBkYXRhVHlwZSA9IHtcXG4gICAgaG9tZV9ydWxlX3VybDogJ+mmlumhteS6keinhOWImScsXFxuICAgIHB1Ymxpc2g6ICfmj5DkuqTkupHku5PlupPop4TliJknLFxcbiAgICBqc191cmw6ICfnvZHpobXmj5Lku7bop4TliJknLFxcbiAgICBodG1sOiAn6Z2Z5oCB6aG16Z2iJyxcXG4gICAgY29uZmlnOiAn5Li76aG16YWN572uJ1xcbn07XFxuXFxubGV0IGJhc2ljID0ge1xcbiAgICBjb2xfdHlwZTogXFxcInRleHRfMVxcXCIsXFxuICAgIHVybDogXFxcImhpa2VyOi8vZW1wdHlcXFwiXFxufTtcXG5sZXQgZGF0YVR5cGVUaXBzID0gZGF0YVR5cGVbZGF0YUl0ZW0uZGF0YV90eXBlXSB8fCAn5pyq55+l6KeE5YiZ77yaJyArIGRhdGFJdGVtLmRhdGFfdHlwZTtcXG5cXG5sZXQgc2FmZV90aXA9ZGF0YUl0ZW0uaXNfc2FmZT9cXFwi5a6J5YWoXFxcIjpcXFwi5Y2x6ZmpXFxcIjtcXG5sZXQgZ29vZF90aXAgPSBkYXRhSXRlbS5pc19nb29kP3NtYWxsKGNvbG9yKFxcXCLjgJDkvJjotKjop4TliJnjgJFcXFwiLCcjZmY3MDAwJykpOlxcXCJcXFwiO1xcbmxldCBub3Rfc2FmZV9ub3RlPWRhdGFJdGVtLm5vdF9zYWZlX25vdGU7XFxuYmFzaWMudGl0bGUgPSBodG1sVGFnKFxcXCJiaWdcXFwiLCBcXFwi57G75Z6LXFxcIikgKyBcXFwiXFxcXHRcXFxcdFxcXFx0XFxcIiArIHNtYWxsKFxcXCIoaWQ6XFxcIiArIGRhdGFJdGVtLmlkICsgXFxcIilcXFwiKStcXFwiXFxcXHRcXFxcdFxcXFx0XFxcIiArIHNtYWxsKFxcXCIo6aOO6Zmp5qOA5rWLOlxcXCIgK3NhZmVfdGlwK1xcXCIpXFxcIikrZ29vZF90aXA7XFxuYmFzaWMuZGVzYyA9IFxcXCLmlbDmja7nsbvlnovvvJpcXFwiICsgY29sb3IoZGF0YVR5cGVUaXBzLCBcXFwiI2NiNTRmZlxcXCIpICsgXFxcIlxcXFxu5YiG5Lqr54q25oCB5Li677yaXFxcIiArIGRhdGFJdGVtLnN0YXRlO1xcbmlmIChbXFxcImh0bWxcXFwiLCBcXFwiY29uZmlnXFxcIiwgXFxcImpzX3VybFxcXCJdLmluY2x1ZGVzKGRhdGFJdGVtLmRhdGFfdHlwZSkpIHtcXG4gICAgYmFzaWMuZGVzYyArPSBcXFwiXFxcXG7igJzigJzigJ3igJ0gPT5cXFwiICsgc21hbGwoXFxcIueCueatpOmihOiniFxcXCIpO1xcbiAgICBiYXNpYy51cmwgPSBydWxlTGlzdEpzb24gKyBkYXRhSXRlbS5pZDtcXG59XFxuXFxuZGF0YS5wdXNoKGJhc2ljKTtcXG5sZXQgaGFzU3VicyA9IFxcXCJcXFwiO1xcbmlmIChoYXNTdWIpIHtcXG4gICAgaGFzU3VicyA9IFxcXCJcXFxcdFxcXFx0XFxcXHRcXFwiICsgc21hbGwoXFxcIuW3suiuoumYhVxcXCIpXFxufVxcblxcbmxldCBub3RlcyA9IHJlcXVlc3QoZ2V0QXBpKFxcXCJnZXRfcnVsZV9ub3RlXFxcIikgKyBpZCk7XFxubm90ZXMgPSBKU09OLnBhcnNlKG5vdGVzKS5yZXN1bHQ7XFxucmVxdWlyZShtZCk7XFxubGV0IG5vdGVzSHRtbD1cXFwiXFxcIlxcbnRyeXtcXG4gICAgbm90ZXNIdG1sPW1hcmtlZC5wYXJzZShub3Rlcyk7XFxufWNhdGNoKGUpe31cXG5cXG5pZiAobm90ZXMgIT09IGZhbHNlKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogaHRtbFRhZyhcXFwiYmlnXFxcIiwgXFxcIuWkh+azqFxcXCIpICsgXFxcIlxcXFx0XFxcXHRcXFxcdFxcXCIgKyBzbWFsbChodG1sVGFnKFxcXCJ1XFxcIiwgXFxcIuafpeeci+WujOaVtOWFrOWRiiA+XFxcIikpLFxcbiAgICAgICAgZGVzYzogbm90ZXMsXFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfMVxcXCIsXFxuICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvaW5mb1xcXCIsXFxuICAgICAgICBleHRyYToge1xcbiAgICAgICAgICAgIHRleHQ6IG5vdGVzSHRtbCxcXG4gICAgICAgICAgICBuYW1lOiBkYXRhSXRlbS5uYW1lLFxcbiAgICAgICAgICAgIC8vIHR5cGU6IFxcXCJsb25nX3RleHRcXFwiXFxuICAgICAgICAgICAgdHlwZTogXFxcInJpY2hfdGV4dFxcXCJcXG4gICAgICAgIH1cXG4gICAgfSk7XFxufVxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBodG1sVGFnKFxcXCJiaWdcXFwiLCBcXFwi5pON5L2cKOWIhuS6q+ivpue7humhtSlcXFwiKSArIGhhc1N1YnMsXFxuICAgIGNvbF90eXBlOiBcXFwidGV4dF8xXFxcIixcXG4gICAgdXJsOiBcXFwiY29weTovL+mBk+mVv+S7k+W6k+OAjFxcXCIrZGF0YUl0ZW0ubmFtZStcXFwi44CNXFxcXG5cXFwiK2lkKydAaW1wb3J0PWpzOiQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3J1bGVEZXRhaWxJbXBvcnQ/cnVsZT3pgZPplb/ku5PlupNQcm9cXFwiLCBpbnB1dCknXFxufSk7XFxubGV0IGltcG9ydFVybCwgcnVsZUNvZGUsIHNoYXJlVXJsLCBiYWNrQ29kZSA9IFxcXCJcXFwiO1xcbmlmICghZGF0YUl0ZW0uaXNfanNvbikge1xcbiAgICBiYWNrQ29kZSA9IHJlcXVlc3QocnVsZUxpc3RKc29uICsgZGF0YUl0ZW0uaWQpO1xcbn1cXG5zd2l0Y2ggKGRhdGFJdGVtLmRhdGFfdHlwZSkge1xcbiAgICBjYXNlIFxcXCJob21lX3J1bGVfdXJsXFxcIjpcXG4gICAgICAgIHJ1bGVDb2RlID0gXFxcIua1t+mYlOinhueVjOmmlumhtemikemBk+inhOWImeOAkFxcXCIgKyBkYXRhSXRlbS5uYW1lICsgXFxcIuOAke+/pWhvbWVfcnVsZV91cmzvv6VcXFwiICsgcnVsZUxpc3RKc29uICsgZGF0YUl0ZW0uaWQ7XFxuICAgICAgICBpbXBvcnRVcmwgPSBcXFwicnVsZTovL1xcXCIgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpXFxuICAgICAgICBicmVhaztcXG4gICAgY2FzZSAncHVibGlzaCc6XFxuICAgICAgICBydWxlQ29kZSA9ICfmtbfpmJTop4bnlYzop4TliJnliIbkuqvvvIzlvZPliY3liIbkuqvnmoTmmK/vvJonICsgZGF0YUl0ZW0ubmFtZSArICfvv6VwdWJsaXNo77+lJyArIGJhc2U2NEVuY29kZShiYWNrQ29kZSk7XFxuICAgICAgICBpbXBvcnRVcmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpO1xcbiAgICAgICAgYnJlYWs7XFxuICAgIGNhc2UgJ2pzX3VybCc6XFxuICAgICAgICBydWxlQ29kZSA9ICfmtbfpmJTop4bnlYzop4TliJnliIbkuqvvvIzlvZPliY3liIbkuqvnmoTmmK/vvJrnvZHpobXmj5Lku7bvv6Vqc191cmzvv6UnICsgZGF0YUl0ZW0ubmFtZSArICdAYmFzZTY0Oi8vJyArIGJhc2U2NEVuY29kZShiYWNrQ29kZSk7XFxuICAgICAgICBpbXBvcnRVcmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpO1xcbiAgICAgICAgYnJlYWs7XFxuICAgIGNhc2UgJ2h0bWwnOlxcbiAgICAgICAgbGV0IGZpbGVfdG1wID0gZGF0YUl0ZW0ubmFtZS5zcGxpdCgnLicpO1xcbiAgICAgICAgbGV0IGZpbGVfcGF0aCA9IGZpbGVfdG1wLmxlbmd0aCA+IDEgPyBmaWxlX3RtcFtmaWxlX3RtcC5sZW5ndGggLSAxXSArIFxcXCIvXFxcIiArIGRhdGFJdGVtLm5hbWUgOiBkYXRhSXRlbS5uYW1lO1xcbiAgICAgICAgcnVsZUNvZGUgPSBcXFwi5rW36ZiU6KeG55WM5pys5Zyw5paH5Lu25YiG5Lqr77+lZmlsZV91cmzvv6VoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvXFxcIiArIGZpbGVfcGF0aCArIFxcXCJAXFxcIiArIHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkO1xcbiAgICAgICAgaW1wb3J0VXJsID0gJ3J1bGU6Ly8nICsgYmFzZTY0RW5jb2RlKHJ1bGVDb2RlKTtcXG4gICAgICAgIGJyZWFrXFxuICAgIGNhc2UgXFxcImNvbmZpZ1xcXCI6XFxuICAgICAgICBpbXBvcnRVcmwgPSAkKCkucnVsZShwYXNzd29yZCA9PiB7XFxuICAgICAgICAgICAgZXZhbChmZXRjaChcXFwiaGlrZXI6Ly9hc3NldHMvaG9tZS5qc1xcXCIpKTtcXG4gICAgICAgICAgICBIaWtlckhvbWUubG9hZChcXFwiaW1wb3J0XFxcIiwgcGFzc3dvcmQpO1xcbiAgICAgICAgfSwgYmFja0NvZGUpO1xcbiAgICAgICAgYnJlYWs7XFxufVxcbmxldCBteV9jb2xfdHlwZSA9IFxcXCJ0ZXh0XzJcXFwiO1xcbmxldCBteV9jb2xfdHlwZTIgPSBcXFwidGV4dF8zXFxcIjtcXG5pZiAoaW1wb3J0VXJsKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuWvvOWFpeinhOWImVxcXCIsXFxuICAgICAgICB1cmw6IGRhdGFJdGVtLmlzX3NhZmU/aW1wb3J0VXJsOid0b2FzdDovL+mjjumZqeinhOWImeemgeatouWvvOWFpSEhIScsXFxuICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXG4gICAgfSk7XFxufVxcbmlmIChydWxlQ29kZSkge1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLliIbkuqvlj6Pku6RcXFwiLFxcbiAgICAgICAgdXJsOiBcXFwiY29weTovL1xcXCIgKyBydWxlQ29kZSxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcbiAgICB9KTtcXG59XFxuXFxuaWYgKGltcG9ydFVybCkge1xcbiAgICBpZiAoZGF0YUl0ZW0uaXNfanNvbl9saXN0ICYmICFoYXNTdWIpIHtcXG4gICAgICAgIGxldCBzdWJfcnVsZV9jb2RlID0gJ+a1t+mYlOinhueVjOWQiOmbhuinhOWImeiuoumYhe+/pWhvbWVfc3Vi77+lJyArIGRhdGFJdGVtLm5hbWUgKyBcXFwiQEBcXFwiICsgcnVsZUxpc3RKc29uICsgZGF0YUl0ZW0uaWQ7XFxuICAgICAgICBsZXQgc3ViX3VybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShzdWJfcnVsZV9jb2RlKTtcXG4gICAgICAgIGRhdGEucHVzaCh7XFxuICAgICAgICAgICAgdGl0bGU6ICforqLpmIXlkIjpm4YnLFxcbiAgICAgICAgICAgIHVybDogc3ViX3VybCxcXG4gICAgICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGUyXFxuICAgICAgICB9KTtcXG4gICAgICAgIGRhdGEucHVzaCh7XFxuICAgICAgICAgICAgdGl0bGU6ICfigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFwiY29sb3I6ICNmZjcwMDBcXFwiPuWvvOWFpei9u+WQiOmbhjwvc3Bhbj4nLFxcbiAgICAgICAgICAgIHVybDogJCgpLmxhenlSdWxlKChkYXRhSXRlbSxzdWJVcmwpPT57XFxuICAgICAgICAgICAgICAgIGNvbnN0IHtnZW5SdWxlfT0kLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS9nZW5BcGlcXFwiKTtcXG4gICAgICAgICAgICAgICAgbGV0IGltcG9ydF9ydWxlPWdlblJ1bGUoZGF0YUl0ZW0ubmFtZStcXFwiLlxcXCIrZGF0YUl0ZW0uYXV0aG9yLHN1YlVybCk7XFxuICAgICAgICAgICAgICAgIC8vY29weShpbXBvcnRfcnVsZSk7XFxuICAgICAgICAgICAgICAgIGxldCBydWxlQ29kZT1wYXJzZVBhc3RlKGltcG9ydF9ydWxlLnNwbGl0KFxcXCJcXFxcblxcXCIpWzBdKTtcXG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gXFxcImhpa2VyOi8vZW1wdHlcXFwiXFxuICAgICAgICAgICAgICAgIGltcG9ydFVybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShydWxlQ29kZSk7XFxuICAgICAgICAgICAgICAgIHJldHVybiBpbXBvcnRVcmxcXG4gICAgICAgICAgICB9LGRhdGFJdGVtLHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkKSxcXG4gICAgICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGUyXFxuICAgICAgICB9KTtcXG4gICAgICAgIGRhdGEucHVzaCh7XFxuICAgICAgICAgICAgdGl0bGU6ICfigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFwiY29sb3I6ICNmZjcwMDBcXFwiPuWvvOWFpemBk+W+t+e7jzwvc3Bhbj4nLFxcbiAgICAgICAgICAgIHVybDogJCgpLmxhenlSdWxlKChkYXRhSXRlbSxzdWJVcmwpPT57XFxuICAgICAgICAgICAgICAgIC8vIGxldCB0aXRsZSA9IFxcXCJILVxcXCIrZGF0YUl0ZW0ubmFtZStcXFwiLlxcXCIrZGF0YUl0ZW0uYXV0aG9yO1xcbiAgICAgICAgICAgICAgICBsZXQgdGl0bGUgPSBcXFwiSi1cXFwiK2RhdGFJdGVtLm5hbWUuc3BsaXQoJy4nKVswXTtcXG4gICAgICAgICAgICAgICAgbGV0IHN1Yk9iaiA9IHtcXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcXG4gICAgICAgICAgICAgICAgICAgIHVybDogc3ViVXJsLFxcbiAgICAgICAgICAgICAgICAgICAgZGVzYzogXFxcImhpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9ydWxlQ2FjaGUvXFxcIit0aXRsZStcXFwiLmpzb25cXFwiLFxcbiAgICAgICAgICAgICAgICAgICAgY29kZTogXFxcIlxcXCIsXFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmU6IGZhbHNlLC8v56aB55So5bm25Y+R5pu05pawXFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgbGV0IHNoYXJlVGV4dCA9IGJhc2U2NEVuY29kZShKU09OLnN0cmluZ2lmeShzdWJPYmopKTtcXG4gICAgICAgICAgICAgICAgdmFyIHBhc3RlcyA9IGdldFBhc3RlcygpO1xcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gc2hhcmVQYXN0ZShzaGFyZVRleHQscGFzdGVzLnNsaWNlKC0xKVswXSk7XFxuICAgICAgICAgICAgICAgIGxldCBpbXBvcnRfcnVsZT0gXFxcIui9u+WQiOmbhuiuoumYhe+8mlxcXCIrdGl0bGUrJ1xcXFxuJyt1cmw7XFxuICAgICAgICAgICAgICAgIGNvcHkoaW1wb3J0X3J1bGUpO1xcbiAgICAgICAgICAgICAgICBjb25zdCBwYXRoID0gJ2hpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9ydWxlQ2FjaGUvc3ViLmpzb24nO1xcbiAgICAgICAgICAgICAgICAkLnJjKGNvbmZpZy5saWIuc3ViKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIOiuoumYheWvvOWFpShwYXRoKVxcbiAgICAgICAgICAgIH0sZGF0YUl0ZW0scnVsZUxpc3RKc29uICsgZGF0YUl0ZW0uaWQpLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZTJcXG4gICAgICAgIH0pO1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICB0aXRsZTogXFxcIjxzbWFsbD7mj5DnpLrvvJrlvIDlj5HogIXljZXni6zliIbkuqvnmoTlkIjpm4bmlofku7blj6rog73ljZXni6zlr7zlhaXjgII8L3NtYWxsPlxcXCIsXFxuICAgICAgICAgICAgY29sX3R5cGU6IFxcXCJyaWNoX3RleHRcXFwiXFxuICAgICAgICB9KTtcXG4gICAgfSBlbHNlIGlmICghZGF0YUl0ZW0uaXNfanNvbl9saXN0ICYmICFoYXNTdWIgJiYgZGF0YUl0ZW0uZGF0YV90eXBlID09ICdob21lX3J1bGVfdXJsJykge1xcbiAgICAgICAgbGV0IHN1Yl9ydWxlX2NvZGUgPSAn5rW36ZiU6KeG55WM5Y2V6KeE5YiZ6K6i6ZiF77+laG9tZV9zdWLvv6UnICsgZGF0YUl0ZW0ubmFtZSArIFxcXCJAQFxcXCIgKyBydWxlTGlzdEpzb24gKyBkYXRhSXRlbS5pZCArICcmZGVidWc9dHJ1ZSc7XFxuICAgICAgICBsZXQgc3ViX3VybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShzdWJfcnVsZV9jb2RlKTtcXG4gICAgICAgIGRhdGEucHVzaCh7XFxuICAgICAgICAgICAgdGl0bGU6ICforqLpmIXop4TliJknLFxcbiAgICAgICAgICAgIHVybDogc3ViX3VybCxcXG4gICAgICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXG4gICAgICAgIH0pXFxuICAgIH1cXG59XFxuaWYgKGRhdGFJdGVtLmlzX2pzb24gJiYgZGF0YUl0ZW0uZGF0YV90eXBlID09PSBcXFwiaG9tZV9ydWxlX3VybFxcXCIgJiYgIWRhdGFJdGVtLmlzX2pzb25fbGlzdCkge1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6ICfov5vlhaXpopHpgZMnLFxcbiAgICAgICAgdXJsOiAkKCAvKlxcXCIjbm9Mb2FkaW5nI1xcXCIqLyApLmxhenlSdWxlKChuYW1lLGhvbWUpID0+IHtcXG4gICAgICAgICAgICBsZXQgcnVsZUxpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoaG9tZSkpO1xcbiAgICAgICAgICAgIGxldCBoYXNSdWxlID0gcnVsZUxpc3Quc29tZShpdGVtID0+IGl0ZW0udGl0bGUgPT09IG5hbWUpO1xcbiAgICAgICAgICAgIGlmIChoYXNSdWxlKSB7XFxuICAgICAgICAgICAgICAgIHB1dFZhcihcXFwiV2FyZWhvdXNlLmJhY2tcXFwiLCBcXFwiMVxcXCIpO1xcbiAgICAgICAgICAgICAgICBiYWNrKCk7XFxuICAgICAgICAgICAgICAgIHJldHVybiBob21lK1xcXCJzQFxcXCIgKyBuYW1lO1xcbiAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/mnKrlronoo4VcXFwiO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0sIGRhdGFJdGVtLm5hbWUsYXBpLmhvbWUpLFxcbiAgICAgICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxuICAgIH0pXFxufVxcbmxldCBtYW5fcnVsZV9zYWZlID0gZ2V0QXBpKFxcXCJtYW5SdWxlU2FmZVxcXCIpK2RhdGFJdGVtLmlkO1xcbmxldCBtYW5fcnVsZV9nb29kID0gZ2V0QXBpKFxcXCJtYW5SdWxlR29vZFxcXCIpK2RhdGFJdGVtLmlkO1xcbi8vIGRhdGFJdGVtLmlzX3NhZmU7XFxuaWYoZ2V0VmFyKCdob3VzZS5pc19tYW5hZ2VyJykpe1xcbiAgICBmdW5jdGlvbiBzZXRJc1NhZmUoZmxhZyxtYW5fcnVsZV9zYWZlKSB7XFxuICAgICAgICBmbGFnID0gZmxhZyB8fCAnJztcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgbGV0IGNvZGUgPSBmZXRjaChtYW5fcnVsZV9zYWZlLCB7XFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcXFwiVXNlci1BZ2VudFxcXCI6IE1PQklMRV9VQX0sXFxuICAgICAgICAgICAgICAgIGJvZHk6IHtcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJwYXJhbXNcXFwiOlxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcInVzZXJuYW1lXFxcIjogZ2V0VmFyKCdob3VzZS51c2VybmFtZScpLFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFwicGFzc3dvcmRcXFwiOiBnZXRWYXIoJ2hvdXNlLnBhc3N3b3JkJyksXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcXCJpc19zYWZlXFxcIjogISFmbGFnXFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfSk7XFxuICAgICAgICAgICAgY29kZSA9IEpTT04ucGFyc2UoY29kZSkucmVzdWx0O1xcbiAgICAgICAgICAgIGlmIChjb2RlLnN0YXR1cyA9PT0gMCkge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gY29kZS5kZXRhaWxcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+aTjeS9nOWksei0pTonICsgY29kZS5kZXRhaWxcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9IGNhdGNoIChlKSB7XFxuICAgICAgICAgICAgcmV0dXJuICfmk43kvZzlpLHotKU6JyArIGUubWVzc2FnZVxcbiAgICAgICAgfVxcbiAgICB9XFxuICAgIGZ1bmN0aW9uIHNldElzR29vZChmbGFnLG1hbl9ydWxlX2dvb2QpIHtcXG4gICAgICAgIGZsYWcgPSBmbGFnIHx8ICcnO1xcbiAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICBsZXQgY29kZSA9IGZldGNoKG1hbl9ydWxlX2dvb2QsIHtcXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xcXCJVc2VyLUFnZW50XFxcIjogTU9CSUxFX1VBfSxcXG4gICAgICAgICAgICAgICAgYm9keToge1xcbiAgICAgICAgICAgICAgICAgICAgXFxcInBhcmFtc1xcXCI6XFxuICAgICAgICAgICAgICAgICAgICAgICAge1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFwidXNlcm5hbWVcXFwiOiBnZXRWYXIoJ2hvdXNlLnVzZXJuYW1lJyksXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcXCJwYXNzd29yZFxcXCI6IGdldFZhcignaG91c2UucGFzc3dvcmQnKSxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcImlzX2dvb2RcXFwiOiAhIWZsYWdcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB9KTtcXG4gICAgICAgICAgICBjb2RlID0gSlNPTi5wYXJzZShjb2RlKS5yZXN1bHQ7XFxuICAgICAgICAgICAgaWYgKGNvZGUuc3RhdHVzID09PSAwKSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiBjb2RlLmRldGFpbFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiAn5pON5L2c5aSx6LSlOicgKyBjb2RlLmRldGFpbFxcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcXG4gICAgICAgICAgICByZXR1cm4gJ+aTjeS9nOWksei0pTonICsgZS5tZXNzYWdlXFxuICAgICAgICB9XFxuICAgIH1cXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOifwn5qr6aOO6ZmpJyxcXG4gICAgICAgIGNvbF90eXBlOidzY3JvbGxfYnV0dG9uJyxcXG4gICAgICAgIHVybDokKCfmoIforrDor6Xop4TliJnkuLrpo47pmak/6aOO6Zmp6KeE5YiZ5peg5rOV6KKr5a+85YWlJykuY29uZmlybSgoaWQsbWFuX3J1bGVfc2FmZSxzZXRJc1NhZmUpPT57XFxuICAgICAgICAgICAgbGV0IHJldCA9IHNldElzU2FmZShmYWxzZSxtYW5fcnVsZV9zYWZlKTtcXG4gICAgICAgICAgICBpZighL+aTjeS9nOWksei0pS8udGVzdChyZXQpKXtcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8vJytyZXRcXG4gICAgICAgIH0sZGF0YUl0ZW0uaWQsbWFuX3J1bGVfc2FmZSxzZXRJc1NhZmUpXFxuICAgIH0pO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6J+Kcheato+W4uCcsXFxuICAgICAgICBjb2xfdHlwZTonc2Nyb2xsX2J1dHRvbicsXFxuICAgICAgICB1cmw6JCgn5qCH6K6w6K+l6KeE5YiZ5Li65q2j5bi4PycpLmNvbmZpcm0oKGlkLG1hbl9ydWxlX3NhZmUsc2V0SXNTYWZlKT0+e1xcbiAgICAgICAgICAgIGxldCByZXQgPSBzZXRJc1NhZmUodHJ1ZSxtYW5fcnVsZV9zYWZlKTtcXG4gICAgICAgICAgICBpZighL+aTjeS9nOWksei0pS8udGVzdChyZXQpKXtcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8vJytyZXRcXG4gICAgICAgIH0sZGF0YUl0ZW0uaWQsbWFuX3J1bGVfc2FmZSxzZXRJc1NhZmUpXFxuICAgIH0pO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6J+KZpemdnuS8mOi0qCcsXFxuICAgICAgICBjb2xfdHlwZTonc2Nyb2xsX2J1dHRvbicsXFxuICAgICAgICB1cmw6JCgn5qCH6K6w6K+l6KeE5YiZ5Li66Z2e5LyY6LSoPycpLmNvbmZpcm0oKGlkLG1hbl9ydWxlX2dvb2Qsc2V0SXNHb29kKT0+e1xcbiAgICAgICAgICAgIGxldCByZXQgPSBzZXRJc0dvb2QoZmFsc2UsbWFuX3J1bGVfZ29vZCk7XFxuICAgICAgICAgICAgaWYoIS/mk43kvZzlpLHotKUvLnRlc3QocmV0KSl7XFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovLycrcmV0XFxuICAgICAgICB9LGRhdGFJdGVtLmlkLG1hbl9ydWxlX2dvb2Qsc2V0SXNHb29kKVxcbiAgICB9KTtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOifwn5KW5LyY6LSoJyxcXG4gICAgICAgIGNvbF90eXBlOidzY3JvbGxfYnV0dG9uJyxcXG4gICAgICAgIHVybDokKCfmoIforrDor6Xop4TliJnkuLrkvJjotKg/JykuY29uZmlybSgoaWQsbWFuX3J1bGVfZ29vZCxzZXRJc0dvb2QpPT57XFxuICAgICAgICAgICAgbGV0IHJldCA9IHNldElzR29vZCh0cnVlLG1hbl9ydWxlX2dvb2QpO1xcbiAgICAgICAgICAgIGlmKCEv5pON5L2c5aSx6LSlLy50ZXN0KHJldCkpe1xcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly8nK3JldFxcbiAgICAgICAgfSxkYXRhSXRlbS5pZCxtYW5fcnVsZV9nb29kLHNldElzR29vZClcXG4gICAgfSk7XFxufVxcblxcbmRhdGEucHVzaCh7XFxuICAgIGNvbF90eXBlOiBcXFwibGluZV9ibGFua1xcXCJcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogZGF0YUl0ZW0uZ29vZF9udW0sXFxuICAgIHBpY191cmw6IFxcXCJoaWtlcjovL2ZpbGVzL2ljb24v6LWeLnN2Z1xcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwiaWNvbl9zbWFsbF8zXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL01ha2VBY29tbWVudCNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFwiLFxcbiAgICBleHRyYToge1xcbiAgICAgICAgaWQ6IGRhdGFJdGVtLmlkLFxcbiAgICAgICAgbmFtZTogZGF0YUl0ZW0ubmFtZVxcbiAgICB9XFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IGRhdGFJdGVtLmJhZF9udW0sXFxuICAgIHBpY191cmw6IFxcXCJoaWtlcjovL2ZpbGVzL2ljb24v6LipLnN2Z1xcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwiaWNvbl9zbWFsbF8zXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL01ha2VBY29tbWVudCNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFwiLFxcbiAgICBleHRyYToge1xcbiAgICAgICAgaWQ6IGRhdGFJdGVtLmlkLFxcbiAgICAgICAgbmFtZTogZGF0YUl0ZW0ubmFtZSxcXG4gICAgICAgIGRlZmF1bHRUeXBlOlxcXCJiYWRcXFwiXFxuICAgIH1cXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogXFxcIuivhOiuulxcXCIsXFxuICAgIHBpY191cmw6IFxcXCJoaWtlcjovL2ZpbGVzL2ljb24v6K+E6K66LnN2Z1xcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwiaWNvbl9zbWFsbF8zXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL01ha2VBY29tbWVudCNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFwiLFxcbiAgICBleHRyYToge1xcbiAgICAgICAgaWQ6IGRhdGFJdGVtLmlkLFxcbiAgICAgICAgbmFtZTogZGF0YUl0ZW0ubmFtZVxcbiAgICB9XFxufSk7XFxubGV0IHRvdGFsU3VtID0gZGF0YUl0ZW0uZ29vZF9udW0gKyBkYXRhSXRlbS5iYWRfbnVtO1xcblxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBodG1sVGFnKFxcXCJiaWdcXFwiLCBcXFwi6K+E6K66KFxcXCIgKyB0b3RhbFN1bSArIFxcXCIpXFxcIikgKyBcXFwiXFxcXHRcXFxcdFxcXFx0XFxcIiArIHNtYWxsKGh0bWxUYWcoXFxcInVcXFwiLCBcXFwi5p+l55yL5YWo6YOo6K+E6K66ID5cXFwiKSksXFxuICAgIGNvbF90eXBlOiBcXFwidGV4dF8xXFxcIixcXG4gICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL0NvbW1lbnRcXFwiLFxcbiAgICBleHRyYToge1xcbiAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9lbXB0eSNmeXBhZ2Ujbm9IaXN0b3J5IyNub1JlY29yZEhpc3RvcnkjXFxcIixcXG4gICAgICAgIGlkOiBkYXRhSXRlbS5pZCxcXG4gICAgICAgIHRvdGFsU3VtOiB0b3RhbFN1bSxcXG4gICAgICAgIG5vX2FjdGl2ZTogZmFsc2VcXG4gICAgfVxcbn0pO1xcbi8vY29uc3QgbG9uZ2VzdFN1bT0xMjA7XFxubGV0IGljb24gPSB7XFxuICAgIFxcXCJnb29kXFxcIjogXFxcIvCfkY1cXFwiLFxcbiAgICBcXFwiYmFkXFxcIjogXFxcIvCfkY5cXFwiLFxcbiAgICBcXFwicmVwbHlcXFwiOlxcXCLlvIDlj5HogIXwn5ejXFxcIlxcbn1cXG5pZiAodG90YWxTdW0gPT09IDApIHtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBcXFwiPGg1IHN0eWxlPSd0ZXh0LWFsaWduOmNlbnRlcic+5LiA5p2h6K+E6K665Lmf5rKh5pyJ77yM5b+r5p2l5oqi5rKZ5Y+R5ZCn77yBPC9oNT5cXFwiLFxcbiAgICAgICAgY29sX3R5cGU6IFxcXCJyaWNoX3RleHRcXFwiXFxuICAgIH0pO1xcbn0gZWxzZSB7XFxuICAgIGxldCBjb21tZW50TGlzdCA9IEpTT04ucGFyc2UocmVxdWVzdChhcGkuZGlzX2dldCArIGRhdGFJdGVtLmlkICsgXFxcIj9saW1pdD01XFxcIikpLnJlc3VsdDtcXG4gICAgZm9yIChsZXQgaXRlbSBvZiBjb21tZW50TGlzdCkge1xcbiAgICAgICAgbGV0IFJlcGx5ID0gaXRlbS5kaXNjdXNzX3R5cGU9PT1cXFwicmVwbHlcXFwiJiZpdGVtLnJlcGx5X3RvX25hbWUhPT1mYWxzZSYmaXRlbS5yZXBseV90b19pZCE9PWZhbHNlP1xcXCLigJjigJjlm57lpI1AXFxcIitpdGVtLnJlcGx5X3RvX25hbWUrXFxcIiAjXFxcIitpdGVtLmRpc2N1c3NfaWQrXFxcIuKAmeKAmVxcXFxuXFxcIjpcXFwiXFxcIjtcXG4gICAgICAgIGRhdGEucHVzaCh7XFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW0ubmFtZSArIFxcXCImbmJzcDsmbmJzcDs8Zm9udCBjb2xvcj0nZ3JheSc+PHNtYWxsPiNcXFwiICsgaXRlbS5pZCArIFxcXCI8L3NtYWxsPjxmb250PlxcXCIsXFxuICAgICAgICAgICAgY29sX3R5cGU6IFxcXCJhdmF0YXJcXFwiLFxcbiAgICAgICAgICAgIC8vdXJsOiBcXFwidG9hc3Q6Ly9cXFwiICsgaXRlbS5xcSxcXG4gICAgICAgICAgICB1cmw6XFxcIm1xcXdwYTovL2ltL2NoYXQ/Y2hhdF90eXBlPXdwYSZ1aW49XFxcIitpdGVtLnFxLFxcbiAgICAgICAgICAgIHBpY191cmw6IGl0ZW0uYXZhdGFyX3VybFxcbiAgICAgICAgfSk7XFxuICAgICAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLmRpc2N1c3NfdGV4dCxcXG4gICAgICAgICAgICBkZXNjOiBSZXBseStpdGVtLmNyZWF0ZV9kYXRlICsgXFxcIsK3XFxcIiArIGljb25baXRlbS5kaXNjdXNzX3R5cGVdLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF8xXFxcIixcXG4gICAgICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvaW5mb1xcXCIsXFxuICAgICAgICAgICAgZXh0cmE6e1xcbiAgICAgICAgICAgICAgICBuYW1lOml0ZW0ubmFtZSxcXG4gICAgICAgICAgICAgICAgdHlwZTpcXFwibG9uZ190ZXh0XFxcIixcXG4gICAgICAgICAgICAgICAgdGV4dDppdGVtLmRpc2N1c3NfdGV4dFxcbiAgICAgICAgICAgIH0sXFxuICAgICAgICAgICAgcGljX3VybDogaXRlbS5hdmF0YXJfdXJsXFxuICAgICAgICB9KTtcXG4gICAgfVxcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgY29sX3R5cGU6IFxcXCJsaW5lX2JsYW5rXFxcIlxcbiAgICB9KTtcXG59XFxuXFxuc2V0UmVzdWx0KGRhdGEpO1wifSx7XCJjb2xfdHlwZVwiOlwicmljaF90ZXh0XCIsXCJuYW1lXCI6XCLmn6XnnItcIixcInBhdGhcIjpcImluZm9cIixcInJ1bGVcIjpcImpzOlxcbnNldFBhZ2VUaXRsZShcXFwi5p+l55yL44CMXFxcIitNWV9QQVJBTVMubmFtZStcXFwi44CNXFxcIilcXG5zZXRSZXN1bHQoW3tcXG4gICAgdGl0bGU6IE1ZX1BBUkFNUy50ZXh0LFxcbiAgICBjb2xfdHlwZTpNWV9QQVJBTVMudHlwZVxcbn1dKTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuW8gOWPkeiAheazqOWGjFwiLFwicGF0aFwiOlwiUmVnaXN0ZXJcIixcInJ1bGVcIjpcImpzOlxcbnNldFBhZ2VUaXRsZShcXFwi5byA5Y+R6ICF5rOo5YaMXFxcIik7XFxuY29uc3Qge1xcbiAgICBnZXRBcGksXFxuICAgIGh0bWxUYWcsXFxuICAgIG1hcENvbFR5cGUsXFxuICAgIHNtYWxsXFxufSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXCIpO1xcbnZhciBkYXRhID0gW107XFxuYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAkLnRvU3RyaW5nKCgpID0+IHtcXG4gICAgY2xlYXJWYXIoXFxcIldhcmVob3VzZS5QYXNzd29yZFxcXCIpO1xcbiAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLlVzZXJuYW1lXFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UuRGVzY3JpcHRpb25cXFwiKTtcXG4gICAgY2xlYXJWYXIoXFxcIldhcmVob3VzZS5Vc2VyQWRkcmVzc1xcXCIpO1xcbn0pKTtcXG5hZGRMaXN0ZW5lcignb25SZWZyZXNoJywgJC50b1N0cmluZygoKT0+e1xcbiAgICBwdXRWYXIoXFxcIldhcmVob3VzZS5XYWl0XFxcIiwgXFxcIlxcXCIpO1xcbn0pKTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogJ+i0puWPtycsXFxuICAgIGRlc2M6IFxcXCLor7fovpPlhaXotKblj7co5b+F5aGrKVxcXCIsXFxuICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcbiAgICBleHRyYToge1xcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5Vc2VybmFtZScsICcnKSxcXG4gICAgICAgIHR5cGU6IFxcXCJudW1iZXJcXFwiLFxcbiAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcIldhcmVob3VzZS5Vc2VybmFtZVxcXCIsaW5wdXQpJ1xcbiAgICB9XFxufSwge1xcbiAgICB0aXRsZTogJ+WvhueggScsXFxuICAgIGRlc2M6IFxcXCLor7fovpPlhaXlr4bnoIEo5b+F5aGrKVxcXCIsXFxuICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcbiAgICBleHRyYToge1xcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5QYXNzd29yZCcsICcnKSxcXG4gICAgICAgIHR5cGU6IFxcXCJwYXNzd29yZFxcXCIsXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFwiV2FyZWhvdXNlLlBhc3N3b3JkXFxcIixpbnB1dCknXFxuICAgIH1cXG59KTtcXG5tYXBDb2xUeXBlKGRhdGEsIFxcXCJsaW5lX2JsYW5rXFxcIiwgMSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6ICfmmLXnp7AnLFxcbiAgICBkZXNjOiBcXFwi6K+36L6T5YWl5pi156ewKOW/heWhqylcXFwiLFxcbiAgICBjb2xfdHlwZTogJ2lucHV0JyxcXG4gICAgZXh0cmE6IHtcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UuVXNlckFkZHJlc3MnLCAnJyksXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFwiV2FyZWhvdXNlLlVzZXJBZGRyZXNzXFxcIixpbnB1dCknXFxuICAgIH1cXG59LCB7XFxuICAgIHRpdGxlOiAn5o+P6L+wJyxcXG4gICAgZGVzYzogXFxcIuivtOivtOS4uuS7gOS5iOimgeazqOWGjOWQp1xcXFxuKOWPr+S7peWinuWKoOmAmui/h+amgueOhyzpgInloaspXFxcIixcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGdldFZhcignV2FyZWhvdXNlLkRlc2NyaXB0aW9uJywgJycpLFxcbiAgICAgICAgdHlwZTogXFxcInRleHRhcmVhXFxcIixcXG4gICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXCJXYXJlaG91c2UuRGVzY3JpcHRpb25cXFwiLGlucHV0KSdcXG4gICAgfVxcbn0pXFxuXFxubWFwQ29sVHlwZShkYXRhLCBcXFwibGluZV9ibGFua1xcXCIsIDEpO1xcblxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBodG1sVGFnKFxcXCJiXFxcIiwgXFxcIuazqOWGjFxcXCIpLFxcbiAgICB1cmw6ICQoZ2V0QXBpKFxcXCJuZXdfZGV2XFxcIikrXFxcIiNub0xvYWRpbmcjXFxcIikubGF6eVJ1bGUoKGdldElkLCBjb25maXJtKSA9PiB7XFxuICAgICAgICBsZXQgdXNlcm5hbWUgPSBnZXRWYXIoJ1dhcmVob3VzZS5Vc2VybmFtZScsIFxcXCJcXFwiKSxcXG4gICAgICAgICAgICBwYXNzd29yZCA9IGdldFZhcignV2FyZWhvdXNlLlBhc3N3b3JkJywgXFxcIlxcXCIpLFxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gZ2V0VmFyKCdXYXJlaG91c2UuRGVzY3JpcHRpb24nLCBcXFwiXFxcIiksXFxuICAgICAgICAgICAgbmFtZSA9IGdldFZhcihcXFwiV2FyZWhvdXNlLlVzZXJBZGRyZXNzXFxcIiwgXFxcIlxcXCIpO1xcbiAgICAgICAgaWYgKFt1c2VybmFtZSwgcGFzc3dvcmQsIG5hbWVdLmluY2x1ZGVzKFxcXCJcXFwiKSkge1xcbiAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/otKblj7cs5a+G56CB5ZKM5pi156ew5LiN6IO95Li656m6XFxcIjtcXG4gICAgICAgIH1cXG4gICAgICAgIHNob3dMb2FkaW5nKFxcXCLmraPlnKjmj5DkuqTnlLPor7fooahcXFwiKTtcXG4gICAgICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGlucHV0LCB7XFxuICAgICAgICAgICAgaGVhZGVyczoge1xcbiAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXFxuICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XFxuICAgICAgICAgICAgICAgIFxcXCJwYXJhbXNcXFwiOiB7XFxuICAgICAgICAgICAgICAgICAgICBcXFwicmVhc29uXFxcIjogZGVzY3JpcHRpb24sXFxuICAgICAgICAgICAgICAgICAgICBcXFwibmFtZVxcXCI6IG5hbWUsXFxuICAgICAgICAgICAgICAgICAgICBcXFwicGFzc3dvcmRcXFwiOiBwYXNzd29yZCxcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJxcVxcXCI6IHVzZXJuYW1lXFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB9KSxcXG4gICAgICAgICAgICBtZXRob2Q6ICdwb3N0J1xcbiAgICAgICAgfSk7XFxuICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3VsdCkucmVzdWx0O1xcbiAgICAgICAgaGlkZUxvYWRpbmcoKTtcXG4gICAgICAgIGlmIChyZXN1bHQuc3RhdHVzICE9PSAwKSB7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL1xcXCIgKyByZXN1bHQuZGV0YWlsO1xcbiAgICAgICAgfVxcbiAgICAgICAgbGV0IGlkcmVzdWx0ID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldElkICsgXFxcIj9xcT1cXFwiICsgdXNlcm5hbWUpKTtcXG4gICAgICAgIGlmIChpZHJlc3VsdC5zdGF0dXMgIT09IDApIHtcXG4gICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vXFxcIiArIGlkcmVzdWx0LmRldGFpbDtcXG4gICAgICAgIH1cXG4gICAgICAgIFxcbiAgICAgICAgcmV0dXJuICQoXFxcIlxcXCIsIFxcXCLovpPlhaXpgq7nrrHpqozor4HnoIFcXFxcblxcXCIgKyByZXN1bHQuZGV0YWlsKS5pbnB1dCgoY29uZmlybSwgaWQsIGFjY291bnQpID0+IHtcXG4gICAgICAgICAgICBzaG93TG9hZGluZyhcXFwi6K+36ICQ5b+D562J5b6FXFxcIik7XFxuICAgICAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHJlcXVlc3QoY29uZmlybSwge1xcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xcbiAgICAgICAgICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcXG4gICAgICAgICAgICAgICAgICAgIH0sXFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XFxuICAgICAgICAgICAgICAgICAgICAgICAgXFxcInBhcmFtc1xcXCI6IHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcInJlZ2lzdF9pZFxcXCI6IGlkLFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFwieXptXFxcIjogaW5wdXRcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICB9KSxcXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnXFxuICAgICAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3VsdCkucmVzdWx0O1xcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyAhPT0gMCkge1xcbiAgICAgICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly9cXFwiICsgcmVzdWx0LmRldGFpbDtcXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICAgICAgICAgIHB1dFZhcihcXFwiV2FyZWhvdXNlVXNlcm5hbWVcXFwiLCBhY2NvdW50WzBdKTtcXG4gICAgICAgICAgICAgICAgICAgIHB1dFZhcihcXFwiV2FyZWhvdXNlUGFzc3dvcmRcXFwiLCBhY2NvdW50WzFdKTtcXG4gICAgICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XFxuICAgICAgICAgICAgICAgICAgICBiYWNrKCk7XFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5oiQ5Yqf5o+Q5Lqk5rOo5YaM5rOo5YaMXFxcXG5cXFwiK3Jlc3VsdC5kZXRhaWw7XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XFxuICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/lh7rplJnkuoblkZBcXFwiO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0sIGNvbmZpcm0sIGlkcmVzdWx0LnJlc3VsdCwgW3VzZXJuYW1lLCBwYXNzd29yZF0pO1xcbiAgICB9LCBnZXRBcGkoXFxcIm5ld19nZXRJZFxcXCIpLCBnZXRBcGkoXFxcIm5ld19jb25maXJtXFxcIikpLFxcbiAgICBjb2xfdHlwZTogJ3RleHRfY2VudGVyXzEnXFxufSk7XFxuc2V0UmVzdWx0KGRhdGEpO1wifSx7XCJjb2xfdHlwZVwiOlwidGV4dF8xXCIsXCJuYW1lXCI6XCLkuKrkurrotYTmlplcIixcInBhdGhcIjpcIlBlcnNvbmFsRGF0YVwiLFwicnVsZVwiOlwianM6XFxuc2V0UGFnZVRpdGxlKFxcXCLkuKrkurrotYTmlplcXFwiKTtcXG52YXIgZGF0YT1bXTtcXG5jb25zdCB7XFxuICAgIGdldEFwaSxcXG4gICAgZ2V0RmlsZSxcXG4gICAgYXBpXFxufSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXCIpO1xcblxcbmRhdGEucHVzaCh7XFxuICAgIGNvbF90eXBlOlxcXCJsaW5lX2JsYW5rXFxcIlxcbn0pO1xcblxcbmxldCB7dXNlcm5hbWUscGFzc3dvcmR9ID0gZ2V0RmlsZSgpO1xcbmxldCBkZXYgPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXCJ1c2VyXFxcIikrTVlfUEFSQU1TLmlkKSkucmVzdWx0O1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOlxcXCLlpLTlg49cXFwiLFxcbiAgICBkZXNjOmRldi5hdmF0YXIsXFxuICAgIHVybDpcXFwiaGlrZXI6Ly9wYWdlL21vZGlmeV9QZXJzb25hbERhdGEjbm9IaXN0b3J5IyNub1JlY29yZEhpc3RvcnkjXFxcIixcXG4gICAgZXh0cmE6e1xcbiAgICAgICAgZGV2OmRldixcXG4gICAgICAgIHVzZXJuYW1lOnVzZXJuYW1lLFxcbiAgICAgICAgcGFzc3dvcmQ6cGFzc3dvcmQsXFxuICAgICAgICBQYXR0ZXJuOjBcXG4gICAgfSxcXG4gICAgY29sX3R5cGU6XFxcInRleHRfMVxcXCJcXG59KTtcXG5cXG5cXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTpcXFwi5pi156ewXFxcIixcXG4gICAgZGVzYzpkZXYubmFtZSxcXG4gICAgdXJsOlxcXCJoaWtlcjovL3BhZ2UvbW9kaWZ5X1BlcnNvbmFsRGF0YSNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFwiLFxcbiAgICBleHRyYTp7XFxuICAgICAgICBkZXY6ZGV2LFxcbiAgICAgICAgdXNlcm5hbWU6dXNlcm5hbWUsXFxuICAgICAgICBwYXNzd29yZDpwYXNzd29yZCxcXG4gICAgICAgIFBhdHRlcm46MVxcbiAgICB9LFxcbiAgICBjb2xfdHlwZTpcXFwidGV4dF8xXFxcIlxcbn0pO1xcblxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOlxcXCLlr4bnoIFcXFwiLFxcbiAgICB1cmw6XFxcImhpa2VyOi8vcGFnZS9tb2RpZnlfUGVyc29uYWxEYXRhI25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXCIsXFxuICAgIGV4dHJhOntcXG4gICAgICAgIGRldjpkZXYsXFxuICAgICAgICB1c2VybmFtZTp1c2VybmFtZSxcXG4gICAgICAgIHBhc3N3b3JkOnBhc3N3b3JkLFxcbiAgICAgICAgUGF0dGVybjoyXFxuICAgIH0sXFxuICAgIGNvbF90eXBlOlxcXCJ0ZXh0XzFcXFwiXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgY29sX3R5cGU6XFxcImxpbmVfYmxhbmtcXFwiXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6XFxcIui0puWPt++8mlxcXCIrdXNlcm5hbWUsXFxuICAgIHVybDpcXFwiY29weTovL1xcXCIrdXNlcm5hbWUsXFxuICAgIGNvbF90eXBlOlxcXCJ0ZXh0XzFcXFwiXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6XFxcIlVJRO+8mlxcXCIrZGV2LmlkLFxcbiAgICB1cmw6XFxcImNvcHk6Ly9cXFwiK2Rldi5pZCxcXG4gICAgY29sX3R5cGU6XFxcInRleHRfMVxcXCJcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICBjb2xfdHlwZTpcXFwibGluZV9ibGFua1xcXCJcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTpcXFwi5o+Q5Lqk5LqR5LuT5bqT6KeE5YiZXFxcIixcXG4gICAgdXJsOiQoXFxcIiNub0xvYWRpbmcjXFxcIikubGF6eVJ1bGUoKGhvc3QpPT57XFxuICAgICAgICBsZXQgY29kZT1yZXF1ZXN0KGhvc3QrXFxcIi9oaWtlcnVsZS9ydWxlbGlzdC5qc29uP2lkPTE0NVxcXCIpO1xcbiAgICAgICAgbGV0IHdvcmQ9XFxcIu+/pXB1Ymxpc2jvv6VcXFwiK2Jhc2U2NEVuY29kZShjb2RlKTtcXG4gICAgICAgIHJldHVybiBcXFwicnVsZTovL1xcXCIrYmFzZTY0RW5jb2RlKHdvcmQpO1xcbiAgICB9LGFwaS5ob3N0KSxcXG4gICAgY29sX3R5cGU6XFxcInRleHRfMVxcXCJcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTpcXFwi5ZCM5q2l5o+Q5Lqk5LqR5LuT5bqT6LSm5Y+35a+G56CBXFxcIixcXG4gICAgdXJsOlxcXCJydWxlOi8vXFxcIitiYXNlNjRFbmNvZGUoXFxcIu+/pXB1Ymxpc2hfYWNjb3VudO+/pVxcXCIrdXNlcm5hbWUrXFxcIkBcXFwiK3Bhc3N3b3JkKSxcXG4gICAgY29sX3R5cGU6XFxcInRleHRfMVxcXCJcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICBjb2xfdHlwZTpcXFwibGluZV9ibGFua1xcXCJcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTpcXFwi5L2g5LiA5YWx5Y+R5biD5LqG44CMXFxcIitkZXYucnVsZV9udW0rXFxcIuOAjeadoeinhOWImVxcXCIsXFxuICAgIHVybDpcXFwiaGlrZXI6Ly9lbXB0eVxcXCIsXFxuICAgIGNvbF90eXBlOlxcXCJ0ZXh0XzFcXFwiXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgY29sX3R5cGU6XFxcImxpbmVfYmxhbmtcXFwiXFxufSk7XFxubGV0IHVzZXIgPSBnZXRGaWxlKCk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6XFxcIuazqOmUgOeZu+W9lVxcXCIsXFxuICAgIHVybDokKFxcXCLnoa7orqTms6jplIDnmbvlvZU/XFxcIikuY29uZmlybShmID0+IHtcXG4gICAgICAgIGYudXNlcm5hbWU9XFxcIlxcXCI7XFxuICAgICAgICBmLnBhc3N3b3JkPVxcXCJcXFwiO1xcbiAgICAgICAgd3JpdGVGaWxlKCdoaWtlcjovL2ZpbGVzL1dhcmVob3VzZVVTRVIuanNvbicsIEpTT04uc3RyaW5naWZ5KGYpKTtcXG4gICAgICAgIHB1dFZhcihcXFwiV2FyZWhvdXNlLmJhY2tcXFwiLFxcXCIxXFxcIik7XFxuICAgICAgICBiYWNrKCk7XFxuICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5bey5rOo6ZSAXFxcIjtcXG4gICAgfSx1c2VyKSxcXG4gICAgY29sX3R5cGU6XFxcInRleHRfY2VudGVyXzFcXFwiXFxufSk7XFxuc2V0UmVzdWx0KGRhdGEpO1wifSx7XCJjb2xfdHlwZVwiOlwibW92aWVfM1wiLFwibmFtZVwiOlwi5pu05pS55Liq5Lq66LWE5paZXCIsXCJwYXRoXCI6XCJtb2RpZnlfUGVyc29uYWxEYXRhXCIsXCJydWxlXCI6XCJqczpcXG5jb25zdCB7XFxuICAgIGdldEFwaSxcXG4gICAgY29sb3IsXFxuICAgIHNtYWxsLFxcbiAgICBnZXRGaWxlLFxcbiAgICBodG1sVGFnXFxufSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXCIpO1xcbmxldCB7XFxuICAgIGRldixcXG4gICAgdXNlcm5hbWUsXFxuICAgIHBhc3N3b3JkLFxcbiAgICBQYXR0ZXJuXFxufSA9IE1ZX1BBUkFNUztcXG52YXIgZGF0YSA9IFtdO1xcbmxldCBwYXRoID0gXFxcIj9xcT1cXFwiICsgdXNlcm5hbWUgKyBcXFwiJnBhc3N3b3JkPVxcXCIgKyBwYXNzd29yZDtcXG5hZGRMaXN0ZW5lcignb25DbG9zZScsICQudG9TdHJpbmcoKCkgPT4ge1xcbiAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLm0ucGV0TmFtZVxcXCIpO1xcbiAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLm0uYXZhdGFyXFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UubS5QYXNzd29yZC5jXFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UubS5QYXNzd29yZC54XFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UubS5QYXNzd29yZC55XFxcIik7XFxufSkpO1xcbmZ1bmN0aW9uIG1fcGV0TmFtZSgpIHtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIGNvbF90eXBlOiBcXFwibGluZV9ibGFua1xcXCJcXG4gICAgfSk7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICBjb2xfdHlwZTogJ2lucHV0JyxcXG4gICAgICAgIGRlc2M6IFxcXCLor7fovpPlhaXmlrDmmLXnp7BcXFwiLFxcbiAgICAgICAgZXh0cmE6IHtcXG4gICAgICAgICAgICB0aXRsZVZpc2libGU6IGZhbHNlLFxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS5wZXROYW1lJywgJycpfHxkZXYubmFtZSxcXG4gICAgICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFwiV2FyZWhvdXNlLm0ucGV0TmFtZVxcXCIsaW5wdXQpJ1xcbiAgICAgICAgfVxcbiAgICB9KTtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIGNvbF90eXBlOiBcXFwibGluZV9ibGFua1xcXCJcXG4gICAgfSk7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuS/neWtmFxcXCIsXFxuICAgICAgICB1cmw6ICQoZ2V0QXBpKFxcXCJtb2RpZnlfbmFtZVxcXCIpICsgcGF0aCkubGF6eVJ1bGUoKCkgPT4ge1xcbiAgICAgICAgICAgIGxldCBuZXdQZXROYW1lID0gZ2V0VmFyKCdXYXJlaG91c2UubS5wZXROYW1lJywgJycpO1xcbiAgICAgICAgICAgIGlmIChuZXdQZXROYW1lID09IFxcXCJcXFwiKSB7XFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/kvaDov5jku4DkuYjpg73msqHloavllYohXFxcIjtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHJlcXVlc3QoaW5wdXQgKyBcXFwiJm5hbWU9XFxcIiArIGVuY29kZVVSSUNvbXBvbmVudChuZXdQZXROYW1lKSk7XFxuICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpO1xcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAwKSB7XFxuICAgICAgICAgICAgICAgIGJhY2soKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+S/ruaUueaIkOWKn1xcXCI7XFxuICAgICAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL1xcXCIgKyByZXN1bHQuZGV0YWlsO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0pLFxcbiAgICAgICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJ1xcbiAgICB9KTtcXG59XFxuXFxuZnVuY3Rpb24gbV9hdmF0YXIoKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICBjb2xfdHlwZTogXFxcImxpbmVfYmxhbmtcXFwiXFxuICAgIH0pO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgY29sX3R5cGU6ICdpbnB1dCcsXFxuICAgICAgICBkZXNjOiBcXFwi6K+36L6T5YWl5paw55qE5aS05YOP6ZO+5o6lXFxcIixcXG4gICAgICAgIGV4dHJhOiB7XFxuICAgICAgICAgICAgdGl0bGVWaXNpYmxlOiBmYWxzZSxcXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWU6IGdldFZhcignV2FyZWhvdXNlLm0uYXZhdGFyJywgJycpIHx8IGRldi5hdmF0YXIsXFxuICAgICAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcIldhcmVob3VzZS5tLmF2YXRhclxcXCIsaW5wdXQpJ1xcbiAgICAgICAgfVxcbiAgICB9KTtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIGNvbF90eXBlOiBcXFwibGluZV9ibGFua1xcXCJcXG4gICAgfSk7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIuS/neWtmFxcXCIsXFxuICAgICAgICB1cmw6ICQoZ2V0QXBpKFxcXCJtb2RpZnlfYXZhXFxcIikgKyBwYXRoKS5sYXp5UnVsZSgoKSA9PiB7XFxuICAgICAgICAgICAgbGV0IG5ld0F2YXRhciA9IGdldFZhcignV2FyZWhvdXNlLm0uYXZhdGFyJywgJycpO1xcbiAgICAgICAgICAgIFxcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGlucHV0ICsgXFxcIiZhdmF0YXJfdXJsPVxcXCIgKyBlbmNvZGVVUklDb21wb25lbnQobmV3QXZhdGFyKSk7XFxuICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpO1xcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAwKSB7XFxuICAgICAgICAgICAgICAgIGJhY2soKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+S/ruaUueaIkOWKn1xcXCI7XFxuICAgICAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL1xcXCIgKyByZXN1bHQuZGV0YWlsO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0pLFxcbiAgICAgICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJ1xcbiAgICB9KTtcXG59XFxuXFxuZnVuY3Rpb24gbV9wd2QoKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICBjb2xfdHlwZTogXFxcImxpbmVfYmxhbmtcXFwiXFxuICAgIH0pO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6XFxcIuWOn+WvhueggVxcXCIsXFxuICAgICAgICBjb2xfdHlwZTogJ2lucHV0JyxcXG4gICAgICAgIGRlc2M6IFxcXCLor7fovpPlhaXljp/lr4bnoIFcXFwiLFxcbiAgICAgICAgZXh0cmE6IHtcXG4gICAgICAgICAgICB0eXBlOlxcXCJwYXNzd29yZFxcXCIsXFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5tLlBhc3N3b3JkLnknLCAnJyksXFxuICAgICAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcIldhcmVob3VzZS5tLlBhc3N3b3JkLnlcXFwiLGlucHV0KSdcXG4gICAgICAgIH1cXG4gICAgfSk7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICBjb2xfdHlwZTogXFxcImxpbmVfYmxhbmtcXFwiXFxuICAgIH0pO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6XFxcIuaWsOWvhueggVxcXCIsXFxuICAgICAgICBjb2xfdHlwZTogJ2lucHV0JyxcXG4gICAgICAgIGRlc2M6IFxcXCLor7fovpPlhaXmlrDlr4bnoIFcXFwiLFxcbiAgICAgICAgZXh0cmE6IHtcXG4gICAgICAgICAgICB0eXBlOlxcXCJwYXNzd29yZFxcXCIsXFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5tLlBhc3N3b3JkLngnLCAnJyksXFxuICAgICAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcIldhcmVob3VzZS5tLlBhc3N3b3JkLnhcXFwiLGlucHV0KSdcXG4gICAgICAgIH1cXG4gICAgfSk7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTpcXFwi6YeN5aSN5paw5a+G56CBXFxcIixcXG4gICAgICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcbiAgICAgICAgZGVzYzogXFxcIuivt+mHjeWkjeaWsOWvhueggVxcXCIsXFxuICAgICAgICBleHRyYToge1xcbiAgICAgICAgICAgIHR5cGU6XFxcInBhc3N3b3JkXFxcIixcXG4gICAgICAgICAgICB0aXRsZVZpc2libGU6IGZhbHNlLFxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS5QYXNzd29yZC5jJywgJycpLFxcbiAgICAgICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXCJXYXJlaG91c2UubS5QYXNzd29yZC5jXFxcIixpbnB1dCknXFxuICAgICAgICB9XFxuICAgIH0pO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgY29sX3R5cGU6IFxcXCJsaW5lX2JsYW5rXFxcIlxcbiAgICB9KTtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBcXFwi5L+d5a2YXFxcIixcXG4gICAgICAgIHVybDogJChnZXRBcGkoXFxcIm1vZGlmeV9wd2RcXFwiKStwYXRoKS5sYXp5UnVsZSgocGFzc3dvcmQsdXNlcm5hbWUpID0+IHtcXG4gICAgICAgICAgICBsZXQgb2xkX3Bhc3N3b3JkID0gZ2V0VmFyKCdXYXJlaG91c2UubS5QYXNzd29yZC55JywgJycpO1xcbiAgICAgICAgICAgIGxldCBuZXdfcGFzc3dvcmQgPSBnZXRWYXIoJ1dhcmVob3VzZS5tLlBhc3N3b3JkLngnLCAnJyk7XFxuICAgICAgICAgICAgbGV0IG5ld19wYXNzd29yZF9hZ2FpbiA9IGdldFZhcignV2FyZWhvdXNlLm0uUGFzc3dvcmQuYycsICcnKTtcXG4gICAgICAgICAgICBpZiAob2xkX3Bhc3N3b3JkIT09cGFzc3dvcmQpIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+WOn+WvhueggemUmeivr1xcXCI7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGlmKG5ld19wYXNzd29yZD09PVxcXCJcXFwiKXtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+ivt+i+k+WFpeaWsOWvhueggVxcXCI7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGlmKG5ld19wYXNzd29yZCE9PW5ld19wYXNzd29yZF9hZ2Fpbil7XFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/kuKTmrKHlr4bnoIHkuI3lkIxcXFwiXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGlucHV0ICsgXFxcIiZuZXdfcGFzc3dvcmQ9XFxcIiArIG5ld19wYXNzd29yZCtcXFwiJm5ld19wYXNzd29yZF9yZT1cXFwiK25ld19wYXNzd29yZF9hZ2Fpbik7XFxuICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpO1xcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAwKSB7XFxuICAgICAgICAgICAgICAgIHdyaXRlRmlsZShcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb25cXFwiLEpTT04uc3RyaW5naWZ5KHtcXG4gICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOnVzZXJuYW1lLFxcbiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6bmV3X3Bhc3N3b3JkXFxuICAgICAgICAgICAgICAgIH0pKTtcXG4gICAgICAgICAgICAgICAgYmFjaygpO1xcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5L+u5pS55oiQ5YqfXFxcIjtcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vXFxcIiArIHJlc3VsdC5kZXRhaWw7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSxwYXNzd29yZCx1c2VybmFtZSksXFxuICAgICAgICBjb2xfdHlwZTogJ3RleHRfY2VudGVyXzEnXFxuICAgIH0pO1xcbn1cXG5cXG5zd2l0Y2ggKFBhdHRlcm4pIHtcXG4gICAgY2FzZSAwOlxcbiAgICAgICAgc2V0UGFnZVRpdGxlKFxcXCLkv67mlLnlpLTlg49cXFwiKTtcXG4gICAgICAgIG1fYXZhdGFyKCk7XFxuICAgICAgICBicmVhaztcXG4gICAgY2FzZSAxOlxcbiAgICAgICAgc2V0UGFnZVRpdGxlKFxcXCLkv67mlLnmmLXnp7BcXFwiKTtcXG4gICAgICAgIG1fcGV0TmFtZSgpO1xcbiAgICAgICAgYnJlYWs7XFxuICAgIGNhc2UgMjpcXG4gICAgICAgIHNldFBhZ2VUaXRsZShcXFwi5L+u5pS55a+G56CBXFxcIik7XFxuICAgICAgICBtX3B3ZCgpO1xcbiAgICAgICAgYnJlYWs7XFxufVxcbnNldFJlc3VsdChkYXRhKTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIue8lui+keinhOWImeWkh+azqFwiLFwicGF0aFwiOlwic2V0X3J1bGVfbm90ZXNcIixcInJ1bGVcIjpcImpzOlxcbmxldCBkYXRhID0gW107XFxuY29uc3Qge1xcbiAgICBnZXRBcGlcXG59ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcIik7XFxubGV0IHtcXG4gICAgaWQsXFxuICAgIHVzZXJuYW1lLFxcbiAgICBwYXNzd29yZCxcXG4gICAgbmFtZVxcbn0gPSBNWV9QQVJBTVM7XFxuc2V0UGFnZVRpdGxlKFxcXCLlpIfms6jjgIxcXFwiK25hbWUrXFxcIuOAjVxcXCIpO1xcbmFkZExpc3RlbmVyKCdvbkNsb3NlJyxcXFwiY2xlYXJWYXIoJ1dhcmVob3VzZS5ydWxlLm5vdGVzJywgJycpXFxcIik7XFxubGV0IG5vdGVzPXJlcXVlc3QoZ2V0QXBpKFxcXCJnZXRfcnVsZV9ub3RlXFxcIikraWQpO1xcbm5vdGVzPUpTT04ucGFyc2Uobm90ZXMpLnJlc3VsdDtcXG5kYXRhLnB1c2goe1xcbiAgICBkZXNjOiBcXFwi6KeE5YiZ5aSH5rOoLi4uLi4uXFxcIixcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICB0aXRsZVZpc2libGU6IGZhbHNlLFxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5ydWxlLm5vdGVzJywgJycpfHxub3Rlc3x8XFxcIlxcXCIsXFxuICAgICAgICB0eXBlOiBcXFwidGV4dGFyZWFcXFwiLFxcbiAgICAgICAgaGVpZ2h0Oi0xLFxcbiAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcIldhcmVob3VzZS5ydWxlLm5vdGVzXFxcIixpbnB1dCknXFxuICAgIH1cXG59KTtcXG5cXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogXFxcIuS/neWtmFxcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwidGV4dF9jZW50ZXJfMVxcXCIsXFxuICAgIHVybDogJChnZXRBcGkoXFxcInNldF9ydWxlX25vdGVcXFwiKSArIGlkKS5sYXp5UnVsZSgodXNlcm5hbWUsIHBhc3N3b3JkKSA9PiB7XFxuICAgICAgICBsZXQgbm90ZXMgPSBnZXRWYXIoJ1dhcmVob3VzZS5ydWxlLm5vdGVzJywgJycpO1xcbiAgICAgICAgbGV0IHJlc3VsdCA9IHJlcXVlc3QoaW5wdXQsIHtcXG4gICAgICAgICAgICBoZWFkZXJzOiB7XFxuICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcXG4gICAgICAgICAgICB9LFxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcXG4gICAgICAgICAgICAgICAgXFxcInBhcmFtc1xcXCI6IHtcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJxcVxcXCI6IHVzZXJuYW1lLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcInBhc3N3b3JkXFxcIjogcGFzc3dvcmQsXFxuICAgICAgICAgICAgICAgICAgICBcXFwibm90ZVxcXCI6bm90ZXNcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH0pLFxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnXFxuICAgICAgICB9KTtcXG4gICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzdWx0KS5yZXN1bHQ7XFxuICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyAhPT0gMCkge1xcbiAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly9cXFwiICsgcmVzdWx0LmRldGFpbDtcXG4gICAgICAgIH1cXG4gICAgICAgIGJhY2soZmFsc2UpO1xcbiAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+S/ruaUueaIkOWKn1xcXCI7XFxuICAgIH0sIHVzZXJuYW1lLCBwYXNzd29yZClcXG59KTtcXG5zZXRSZXN1bHQoZGF0YSk7XCJ9LHtcImNvbF90eXBlXCI6XCJsaW5lXCIsXCJuYW1lXCI6XCLor4TorrrliJfooahcIixcInBhdGhcIjpcIkNvbW1lbnRcIixcInJ1bGVcIjpcImpzOlxcbnNldFBhZ2VUaXRsZShcXFwi6K+E6K665YiX6KGoXFxcIik7XFxuY29uc3Qge1xcbiAgICBhcGlcXG59ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcIik7XFxubGV0IGRhdGEgPSBbXTtcXG5sZXQge1xcbiAgICB0b3RhbFN1bSxcXG4gICAgaWQsXFxuICAgIG5vX2FjdGl2ZSxcXG4gICAgdXNlcm5hbWUsXFxuICAgIHBhc3N3b3JkXFxufSA9IE1ZX1BBUkFNUztcXG5sZXQgcGFnZSA9IHBhcnNlSW50KE1ZX1VSTC5zcGxpdChcXFwiI1xcXCIpWzFdKTtcXG5sZXQgZGlzY3Vzc190eXBlID0gZ2V0VmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC5kaXNjdXNzX3R5cGVcXFwiLCBcXFwiXFxcIik7XFxuaWYgKHBhZ2UgPT09IDEpIHtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIGNvbF90eXBlOiBcXFwibGluZV9ibGFua1xcXCJcXG4gICAgfSk7XFxuICAgIGFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKSA9PiB7XFxuICAgICAgICBwdXRWYXIoXFxcIldhcmVob3VzZS5jb21tZW50LmRpc2N1c3NfdHlwZVxcXCIsIFxcXCJcXFwiKTtcXG4gICAgfSkpO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLlhajpg6hcXFwiICsgKGRpc2N1c3NfdHlwZSA9PT0gXFxcIlxcXCIgPyBcXFwi4peJXFxcIiA6IFxcXCLil4tcXFwiKSxcXG4gICAgICAgIHVybDogJChcXFwiI25vTG9hZGluZyNcXFwiKS5sYXp5UnVsZSgoKSA9PiB7XFxuICAgICAgICAgICAgcHV0VmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC5kaXNjdXNzX3R5cGVcXFwiLCBcXFwiXFxcIik7XFxuICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKTtcXG4gICAgICAgICAgICByZXR1cm4gXFxcImhpa2VyOi8vZW1wdHlcXFwiO1xcbiAgICAgICAgfSksXFxuICAgICAgICBjb2xfdHlwZTogJ3RleHRfNCdcXG5cXG4gICAgfSk7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIvCfkY3otZ5cXFwiICsgKGRpc2N1c3NfdHlwZSA9PT0gXFxcImdvb2RcXFwiID8gXFxcIuKXiVxcXCIgOiBcXFwi4peLXFxcIiksXFxuICAgICAgICB1cmw6ICQoXFxcIiNub0xvYWRpbmcjXFxcIikubGF6eVJ1bGUoKCkgPT4ge1xcbiAgICAgICAgICAgIHB1dFZhcihcXFwiV2FyZWhvdXNlLmNvbW1lbnQuZGlzY3Vzc190eXBlXFxcIiwgXFxcImdvb2RcXFwiKTtcXG4gICAgICAgICAgICByZWZyZXNoUGFnZSgpO1xcbiAgICAgICAgICAgIHJldHVybiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCI7XFxuICAgICAgICB9KSxcXG4gICAgICAgIGNvbF90eXBlOiAndGV4dF80J1xcblxcbiAgICB9KTtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBcXFwi8J+Rjui4qVxcXCIgKyAoZGlzY3Vzc190eXBlID09PSBcXFwiYmFkXFxcIiA/IFxcXCLil4lcXFwiIDogXFxcIuKXi1xcXCIpLFxcbiAgICAgICAgdXJsOiAkKFxcXCIjbm9Mb2FkaW5nI1xcXCIpLmxhenlSdWxlKCgpID0+IHtcXG4gICAgICAgICAgICBwdXRWYXIoXFxcIldhcmVob3VzZS5jb21tZW50LmRpc2N1c3NfdHlwZVxcXCIsIFxcXCJiYWRcXFwiKTtcXG4gICAgICAgICAgICByZWZyZXNoUGFnZSgpO1xcbiAgICAgICAgICAgIHJldHVybiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCI7XFxuICAgICAgICB9KSxcXG4gICAgICAgIGNvbF90eXBlOiAndGV4dF80J1xcbiAgICB9KTtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBcXFwi5Zue5aSNXFxcIiArIChkaXNjdXNzX3R5cGUgPT09IFxcXCJyZXBseVxcXCIgPyBcXFwi4peJXFxcIiA6IFxcXCLil4tcXFwiKSxcXG4gICAgICAgIHVybDogJChcXFwiI25vTG9hZGluZyNcXFwiKS5sYXp5UnVsZSgoKSA9PiB7XFxuICAgICAgICAgICAgcHV0VmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC5kaXNjdXNzX3R5cGVcXFwiLCBcXFwicmVwbHlcXFwiKTtcXG4gICAgICAgICAgICByZWZyZXNoUGFnZSgpO1xcbiAgICAgICAgICAgIHJldHVybiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCI7XFxuICAgICAgICB9KSxcXG4gICAgICAgIGNvbF90eXBlOiAndGV4dF80J1xcbiAgICB9KTtcXG59XFxuXFxuXFxubGV0IGljb24gPSB7XFxuICAgIFxcXCJnb29kXFxcIjogXFxcIvCfkY1cXFwiLFxcbiAgICBcXFwiYmFkXFxcIjogXFxcIvCfkY5cXFwiLFxcbiAgICBcXFwicmVwbHlcXFwiOlxcXCLlvIDlj5HogIXwn5ejXFxcIlxcbn1cXG5sZXQgY29udHJvbD0ocGlkLGFjdGl2ZSk9PnZvaWQgMDtcXG5pZihub19hY3RpdmUpe1xcbiAgICBjb250cm9sPWZ1bmN0aW9uKHBpZCxhY3RpdmUpe1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICB0aXRsZTphY3RpdmU/XFxcIumakOiXj+ivhOiuulxcXCI6XFxcIuWxleekuuivhOiuulxcXCIsXFxuICAgICAgICAgICAgdXJsOiQoYXBpLmRpc19kZXZfY29udHJvbCtwaWQrXFxcIj9xcT1cXFwiICsgdXNlcm5hbWUgKyBcXFwiJnBhc3N3b3JkPVxcXCIgKyBwYXNzd29yZCtcXFwiI25vTG9hZGluZyNcXFwiKS5sYXp5UnVsZSgoKT0+e1xcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0PUpTT04ucGFyc2UocmVxdWVzdChpbnB1dCkpO1xcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSlcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL1xcXCIrcmVzdWx0LmRldGFpbDtcXG4gICAgICAgICAgICB9KSxcXG4gICAgICAgICAgICBjb2xfdHlwZTpcXFwidGV4dF8yXFxcIlxcbiAgICAgICAgfSk7XFxuICAgICAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOlxcXCLliKDpmaTor4TorrpcXFwiLFxcbiAgICAgICAgICAgIHVybDokKFxcXCLnoa7orqTliKDpmaTor6Xor4Torro/XFxcIikuY29uZmlybSgoaW5wdXQpPT57XFxuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ9SlNPTi5wYXJzZShyZXF1ZXN0KGlucHV0KSk7XFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKVxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vXFxcIityZXN1bHQuZGV0YWlsO1xcbiAgICAgICAgICAgIH0sYXBpLmRpc19kZXZfY29udHJvbCtwaWQrXFxcIj9xcT1cXFwiICsgdXNlcm5hbWUgKyBcXFwiJnBhc3N3b3JkPVxcXCIgKyBwYXNzd29yZCtcXFwiJmRlbGV0ZT0xXFxcIiksXFxuICAgICAgICAgICAgY29sX3R5cGU6XFxcInRleHRfMlxcXCJcXG4gICAgICAgIH0pO1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICBjb2xfdHlwZTpcXFwibGluZVxcXCJcXG4gICAgICAgIH0pO1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICBjb2xfdHlwZTpcXFwibGluZVxcXCJcXG4gICAgICAgIH0pO1xcbiAgICB9XFxufVxcbmlmICh0b3RhbFN1bSA9PT0gMCkge1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCI8aDUgc3R5bGU9J3RleHQtYWxpZ246Y2VudGVyJz7kuIDmnaHor4TorrrkuZ/msqHmnInvvIzlv6vmnaXmiqLmspnlj5HlkKfvvIE8L2g1PlxcXCIsXFxuICAgICAgICBjb2xfdHlwZTogXFxcInJpY2hfdGV4dFxcXCJcXG4gICAgfSk7XFxufSBlbHNlIHtcXG4gICAgbGV0IGNvbW1lbnRMaXN0ID0gSlNPTi5wYXJzZShyZXF1ZXN0KGFwaS5kaXNfZ2V0ICsgaWQgKyBcXFwiP2xpbWl0PTUmcGFnZT1cXFwiICsgcGFnZSArIFxcXCImbm9fYWN0aXZlPVxcXCIgKyBub19hY3RpdmUgKyBcXFwiJmRpc2N1c3NfdHlwZT1cXFwiICsgZGlzY3Vzc190eXBlKSkucmVzdWx0O1xcbiAgICBmb3IgKGxldCBpdGVtIG9mIGNvbW1lbnRMaXN0KSB7XFxuICAgICAgICBsZXQgUmVwbHkgPSBpdGVtLmRpc2N1c3NfdHlwZT09PVxcXCJyZXBseVxcXCImJml0ZW0ucmVwbHlfdG9fbmFtZSE9PWZhbHNlJiZpdGVtLnJlcGx5X3RvX2lkIT09ZmFsc2U/XFxcIuKAmOKAmOWbnuWkjUBcXFwiK2l0ZW0ucmVwbHlfdG9fbmFtZStcXFwiICNcXFwiK2l0ZW0uZGlzY3Vzc19pZCtcXFwi4oCZ4oCZXFxcXG5cXFwiOlxcXCJcXFwiO1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICB0aXRsZTogaXRlbS5uYW1lICsgXFxcIiZuYnNwOyZuYnNwOzxmb250IGNvbG9yPSdncmF5Jz48c21hbGw+I1xcXCIgKyBpdGVtLmlkICsgXFxcIjwvc21hbGw+PGZvbnQ+XFxcIixcXG4gICAgICAgICAgICBjb2xfdHlwZTogXFxcImF2YXRhclxcXCIsXFxuICAgICAgICAgICAgLy91cmw6IG5vX2FjdGl2ZT9cXFwiaGlrZXI6Ly9wYWdlL1JlcGx5XFxcIjpcXFwidG9hc3Q6Ly9cXFwiICsgaXRlbS5xcSxcXG5cXHRcXHQgICAgICAgdXJsOm5vX2FjdGl2ZT9cXFwiaGlrZXI6Ly9wYWdlL1JlcGx5XFxcIjpcXFwibXFxd3BhOi8vaW0vY2hhdD9jaGF0X3R5cGU9d3BhJnVpbj1cXFwiK2l0ZW0ucXEsXFxuICAgICAgICAgICAgZXh0cmE6e1xcbiAgICAgICAgICAgICAgICBydWxlSWQ6IGlkLFxcbiAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCxcXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxcbiAgICAgICAgICAgICAgICByZXBseUlkOml0ZW0uaWRcXG4gICAgICAgICAgICB9LFxcbiAgICAgICAgICAgIHBpY191cmw6IGl0ZW0uYXZhdGFyX3VybFxcbiAgICAgICAgfSk7XFxuICAgICAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLmRpc2N1c3NfdGV4dCxcXG4gICAgICAgICAgICBkZXNjOiBSZXBseStpdGVtLmNyZWF0ZV9kYXRlICsgXFxcIsK3XFxcIiArIGljb25baXRlbS5kaXNjdXNzX3R5cGVdLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF8xXFxcIixcXG4gICAgICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvaW5mb1xcXCIsXFxuICAgICAgICAgICAgZXh0cmE6e1xcbiAgICAgICAgICAgICAgICBuYW1lOml0ZW0ubmFtZSxcXG4gICAgICAgICAgICAgICAgdHlwZTpcXFwibG9uZ190ZXh0XFxcIixcXG4gICAgICAgICAgICAgICAgdGV4dDppdGVtLmRpc2N1c3NfdGV4dFxcbiAgICAgICAgICAgIH0sXFxuICAgICAgICAgICAgcGljX3VybDogaXRlbS5hdmF0YXJfdXJsXFxuICAgICAgICB9KTtcXG4gICAgICAgIGNvbnRyb2woaXRlbS5pZCxpdGVtLmFjdGl2ZSk7XFxuICAgIH1cXG4gICAgaWYgKGNvbW1lbnRMaXN0Lmxlbmd0aCA9PT0gMCkge1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICBjb2xfdHlwZTogXFxcImxpbmVfYmxhbmtcXFwiXFxuICAgICAgICB9KTtcXG4gICAgfVxcbn1cXG5cXG5zZXRSZXN1bHQoZGF0YSlcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuWPkeihqOivhOiuulwiLFwicGF0aFwiOlwiTWFrZUFjb21tZW50XCIsXCJydWxlXCI6XCJqczpcXG5sZXQgZGF0YSA9IFtdO1xcbmNvbnN0IHtcXG4gICAgYXBpLFxcbiAgICBnZXRGaWxlXFxufSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXCIpO1xcbmxldCB7XFxuICAgIGlkLFxcbiAgICBuYW1lLFxcbiAgICBkZWZhdWx0VHlwZVxcbn0gPSBNWV9QQVJBTVM7XFxubGV0IHVzZXI9Z2V0RmlsZSgpLnVzZXJ8fFtcXFwiXFxcIixcXFwiXFxcIl07XFxuXFxuc2V0UGFnZVRpdGxlKFxcXCLor4TorrooXFxcIiArIG5hbWUgKyBcXFwiKVxcXCIpO1xcbmFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKSA9PiB7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC50eXBlXFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC50ZXh0XFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC5xcVxcXCIpO1xcbiAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxufSkpO1xcbmxldCB0eXBlID0gZ2V0VmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC50eXBlXFxcIikgfHwgZGVmYXVsdFR5cGV8fFxcXCJnb29kXFxcIjtcXG5kYXRhLnB1c2goe1xcbiAgICBkZXNjOiBcXFwi6K+E6K66Li4uLi4uXFxcIixcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICB0aXRsZVZpc2libGU6IGZhbHNlLFxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5jb21tZW50LnRleHQnLCAnJyksXFxuICAgICAgICB0eXBlOiBcXFwidGV4dGFyZWFcXFwiLFxcbiAgICAgICAgaGVpZ2h0OjcsXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFwiV2FyZWhvdXNlLmNvbW1lbnQudGV4dFxcXCIsaW5wdXQpJ1xcbiAgICB9XFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6XFxcIui0puWPt++8mlxcXCIrKHVzZXJbMF18fFxcXCJcXFwiKSxcXG4gICAgZGVzYzpcXFwi6aqM6K+B56CB77yaXFxcIisodXNlclsxXXx8XFxcIlxcXCIpLFxcbiAgICB1cmw6XFxcImhpa2VyOi8vcGFnZS9Vc2VycmVnaXN0cmF0aW9uXFxcIixcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzEnLFxcbiAgICBcXG59KTtcXG5cXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogICh0eXBlID09PSBcXFwiZ29vZFxcXCIgPyBcXFwi4peJXFxcIiA6IFxcXCLil4tcXFwiKStcXFwiIPCfkY1cXFwiLFxcbiAgICB1cmw6ICQoXFxcIiNub0xvYWRpbmcjXFxcIikubGF6eVJ1bGUoKCkgPT4ge1xcbiAgICAgICAgcHV0VmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC50eXBlXFxcIiwgXFxcImdvb2RcXFwiKTtcXG4gICAgICAgIHJlZnJlc2hQYWdlKCk7XFxuICAgICAgICByZXR1cm4gXFxcImhpa2VyOi8vZW1wdHlcXFwiO1xcbiAgICB9KSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzInXFxuXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6ICAodHlwZSA9PT0gXFxcImJhZFxcXCIgPyBcXFwi4peJXFxcIiA6IFxcXCLil4tcXFwiKStcXFwiIPCfkY5cXFwiLFxcbiAgICB1cmw6ICQoXFxcIiNub0xvYWRpbmcjXFxcIikubGF6eVJ1bGUoKCkgPT4ge1xcbiAgICAgICAgcHV0VmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC50eXBlXFxcIiwgXFxcImJhZFxcXCIpO1xcbiAgICAgICAgcmVmcmVzaFBhZ2UoKTtcXG4gICAgICAgIHJldHVybiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCI7XFxuICAgIH0pLFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcXG59KTtcXG5cXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogXFxcIuaPkOS6pFxcXCIsXFxuICAgIGNvbF90eXBlOiBcXFwidGV4dF9jZW50ZXJfMVxcXCIsXFxuICAgIHVybDogJChhcGkuZGlzX25ldyArIGlkKS5sYXp5UnVsZSgoQWNjb3VudCkgPT4ge1xcbiAgICAgICAgbGV0IHRleHQgPSBnZXRWYXIoJ1dhcmVob3VzZS5jb21tZW50LnRleHQnLCAnJyk7XFxuICAgICAgICBsZXQgW3FxLGF1dGhfY29kZV0gPSBBY2NvdW50O1xcbiAgICAgICAgbGV0IHR5cGUgPSBnZXRWYXIoJ1dhcmVob3VzZS5jb21tZW50LnR5cGUnKSB8fCAnZ29vZCc7XFxuICAgICAgICBxcT1xcXx8XFxcIlxcXCI7XFxuICAgICAgICBhdXRoX2NvZGU9YXV0aF9jb2RlfHxcXFwiXFxcIjtcXG4gICAgICAgIGlmKHFxPT1cXFwiXFxcInx8YXV0aF9jb2RlPT1cXFwiXFxcIil7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+acqueZu+W9lei0puWPt1xcXCI7XFxuICAgICAgICB9XFxuICAgICAgICBpZih0ZXh0PT1cXFwiXFxcIil7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+S9oOi/mOS7gOS5iOmDveayoeWGmeWVilxcXCI7XFxuICAgICAgICB9XFxuICAgICAgICBmdW5jdGlvbiByKHApIHtcXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVxdWVzdChpbnB1dCwge1xcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XFxuICAgICAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXFxuICAgICAgICAgICAgICAgIH0sXFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHApLFxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJ1xcbiAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHJlc3VsdCkucmVzdWx0O1xcbiAgICAgICAgfVxcbiAgICAgICAgbGV0IHAgPSB7XFxuICAgICAgICAgICAgXFxcInBhcmFtc1xcXCI6IHtcXG4gICAgICAgICAgICAgICAgXFxcImRpc2N1c3NfdGV4dFxcXCI6IHRleHQsXFxuICAgICAgICAgICAgICAgIFxcXCJxcVxcXCI6IHFxLFxcbiAgICAgICAgICAgICAgICBcXFwiZGlzY3Vzc190eXBlXFxcIjogdHlwZSxcXG4gICAgICAgICAgICAgICAgXFxcImF1dGhfY29kZVxcXCI6IGF1dGhfY29kZVxcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG4gICAgICAgIGxldCByZXN1bHQgPSByKHApO1xcbiAgICAgICAgaWYocmVzdWx0LnN0YXR1cz09PTApe1xcbiAgICAgICAgICAgIGJhY2soZmFsc2UpO1xcbiAgICAgICAgfVxcbiAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL1xcXCIrcmVzdWx0LmRldGFpbDtcXG5cXG4gICAgfSx1c2VyKVxcbn0pO1xcblxcbnNldFJlc3VsdChkYXRhKTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuS8queUqOaIt+azqOWGjFwiLFwicGF0aFwiOlwiVXNlcnJlZ2lzdHJhdGlvblwiLFwicnVsZVwiOlwianM6XFxuY29uc3Qge1xcbiAgICBhcGksXFxuICAgIGdldEZpbGUsXFxuICAgIGdldFVzZXJEYXRlXFxufSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXCIpO1xcbmxldCBkYXRhID0gW107XFxuZGF0YS5wdXNoKHtcXG4gICAgY29sX3R5cGU6IFxcXCJsaW5lX2JsYW5rXFxcIlxcbn0pO1xcbnNldFBhZ2VUaXRsZShcXFwi55So5oi35YiX6KGo566h55CGXFxcIik7XFxuYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAkLnRvU3RyaW5nKCgpID0+IHtcXG4gICAgY2xlYXJWYXIoXFxcIldhcmVob3VzZS5tLnFxXFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UubS55em1cXFwiKTtcXG59KSk7XFxubGV0IHVzZXIgPSBnZXRGaWxlKCk7XFxubGV0IHVzZXJOYW1lID0gdXNlci51c2VyIHx8IFtcXFwiXFxcIl07XFxudXNlck5hbWUgPSB1c2VyTmFtZVswXTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogXFxcIuKAnOKAnOKAneKAnTxiaWc+KOa3u+WKoC/pqozor4Ep6LSm5Y+3PC9iaWc+XFxcIixcXG4gICAgY29sX3R5cGU6IFxcXCJ0ZXh0XzFcXFwiLFxcbiAgICB1cmw6IFxcXCJoaWtlcjovL2VtcHR5XFxcIlxcbn0pO1xcblxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwi6I635Y+WXFxcIixcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxuICAgIGRlc2M6IFxcXCLor7fovpPlhaVxcVxcXCIsXFxuICAgIHVybDogJC50b1N0cmluZygoYSwgYikgPT4ge1xcbiAgICAgICAgbGV0IHFxID0gaW5wdXQ7XFxuICAgICAgICBpZiAocXEgPT0gXFxcIlxcXCIpIHtcXG4gICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5L2g6L+Y5LuA5LmI6YO95rKh5aGr5ZWKIVxcXCI7XFxuICAgICAgICB9XFxuICAgICAgICBzaG93TG9hZGluZyhcXFwi6I635Y+W5LitLi4uXFxcIilcXG4gICAgICAgIHJldHVybiAkKFxcXCIjbm9Mb2FkaW5nI1xcXCIpLmxhenlSdWxlKChxcSwgYSwgYikgPT4ge1xcbiAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVxdWVzdChhLCB7XFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcXG4gICAgICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcXG4gICAgICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xcbiAgICAgICAgICAgICAgICAgICAgXFxcInBhcmFtc1xcXCI6IHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBcXFwicXFcXFwiOiBxcVxcbiAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB9KSxcXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCdcXG4gICAgICAgICAgICB9KTtcXG4gICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3VsdCkucmVzdWx0O1xcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAwKSB7XFxuICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly9cXFwiICsgcmVzdWx0LmRldGFpbDtcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0MiA9IEpTT04ucGFyc2UocmVxdWVzdChiICsgXFxcIj9xcT1cXFwiICsgcXEpKTtcXG4gICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL1xcXCIgKyByZXN1bHQyLmRldGFpbDtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9IGNhdGNoIChlKSB7XFxuICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcXG4gICAgICAgICAgICB0aHJvdyBlO1xcbiAgICAgICAgfVxcbiAgICAgICAgfSwgcXEsIGEsIGIpO1xcblxcbiAgICB9LCBhcGkuZGlzX25ld191c2VyLCBhcGkuZGlzX3ZlcmlmeSksXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICB0eXBlOiBcXFwibnVtYmVyXFxcIixcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS5xcScsICcnKSB8fCB1c2VyTmFtZSxcXG4gICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXCJXYXJlaG91c2UubS5xcVxcXCIsaW5wdXQpJ1xcbiAgICB9XFxufSk7XFxuXFxuZGF0YS5wdXNoKHtcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxuICAgIGRlc2M6IFxcXCLor7fovpPlhaXpqozor4HnoIFcXFwiLFxcbiAgICBleHRyYToge1xcbiAgICAgICAgdGl0bGVWaXNpYmxlOiBmYWxzZSxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS55em0nLCAnJyksXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFwiV2FyZWhvdXNlLm0ueXptXFxcIixpbnB1dCknXFxuICAgIH1cXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICBjb2xfdHlwZTogJ3JpY2hfdGV4dCcsXFxuICAgIHRpdGxlOiBcXFwiPHNtYWxsPuaPkOekuu+8mjEu5q+P5aSp5Y+q6IO96I635Y+WNeasoemqjOivgeeggS48YnI+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Mi48cz7pqozor4HnoIHmnInmlYjmnJ/mjIHnu63kuIDlkajlt6blj7M8L3M+KOaaguaXtuS4jeS8mu+8jOW/mOiusOmqjOivgeeggeWPr+mAmui/h1FR5Y+36I635Y+WKTwvc21hbGw+XFxcIlxcbn0pO1xcblxcbmxldCB1c2VyTGlzdCA9IGdldFVzZXJEYXRlKCk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IFxcXCLpqozor4Ev55m75b2VXFxcIixcXG4gICAgdXJsOiAkKFxcXCLnoa7lrprkv53lrZjvvIzpqozor4HnoIHloavplJnvvIzml6Dms5Xor4Torrrlk6ZcXFwiKS5jb25maXJtKChmLCBsLCBsb2dpbikgPT4ge1xcbiAgICAgICAgbGV0IHFxID0gZ2V0VmFyKCdXYXJlaG91c2UubS5xcScsICcnKTtcXG4gICAgICAgIGxldCB5em0gPSBnZXRWYXIoJ1dhcmVob3VzZS5tLnl6bScsICcnKTtcXG4gICAgICAgIGlmIChxcSA9PSBcXFwiXFxcIiB8fCB5em0gPT0gXFxcIlxcXCIpIHtcXG4gICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vcXHmiJbpqozor4HnoIHkuLrnqbpcXFwiO1xcbiAgICAgICAgfVxcbiAgICAgICAgbGV0IHJlc3VsdCA9IHJlcXVlc3QobG9naW4sIHtcXG4gICAgICAgICAgICBoZWFkZXJzOiB7XFxuICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcXG4gICAgICAgICAgICB9LFxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcXG4gICAgICAgICAgICAgICAgXFxcInBhcmFtc1xcXCI6IHtcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJxcVxcXCI6IHFxLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcImF1dGhfY29kZVxcXCI6IHl6bVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfSksXFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCdcXG4gICAgICAgIH0pO1xcbiAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpLnJlc3VsdDtcXG4gICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAwKSB7XFxuICAgICAgICAgICAgZi51c2VyID0gW3FxLCB5em1dO1xcbiAgICAgICAgICAgIHdyaXRlRmlsZShcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb25cXFwiLCBKU09OLnN0cmluZ2lmeShmKSk7XFxuICAgICAgICAgICAgbGV0IGluZGV4ID0gbC5maW5kSW5kZXgoaXRlbSA9PiBpdGVtWzBdID09PSBxcSk7XFxuICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcXG4gICAgICAgICAgICAgICAgbC5zcGxpY2UoaW5kZXgsIDEsIFtxcSwgeXptXSk7XFxuICAgICAgICAgICAgfSBlbHNlIGlmIChsLmxlbmd0aCA8IDYpIHtcXG4gICAgICAgICAgICAgICAgbC5wdXNoKFtxcSwgeXptXSk7XFxuICAgICAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICAgICAgbC5zcGxpY2UoMCwgMSk7XFxuICAgICAgICAgICAgICAgIGwucHVzaChbcXEsIHl6bV0pO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMvV2FyZWhvdXNlVVNFUkEuanNvblxcXCIsIEpTT04uc3RyaW5naWZ5KGwpKTtcXG4gICAgICAgICAgICBiYWNrKCk7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+mqjOivgeaIkOWKn1xcXCI7XFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8vXFxcIiArIHJlc3VsdC5kZXRhaWw7XFxuICAgIH0sIHVzZXIsIHVzZXJMaXN0LCBhcGkuZGlzX2xvZ2luKSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJ1xcbn0pO1xcbmRhdGEucHVzaCh7XFxuICAgIGNvbF90eXBlOiBcXFwibGluZV9ibGFua1xcXCJcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogXFxcIuKAnOKAnOKAneKAnTxiaWc+6LSm5Y+35YiX6KGoPC9iaWc+XFxcXHRcXFxcdFxcXFx0PHNtYWxsPijkv53nlZk15p2h6K6w5b2VKTwvc21hbGw+XFxcIixcXG4gICAgY29sX3R5cGU6IFxcXCJ0ZXh0XzFcXFwiLFxcbiAgICB1cmw6IFxcXCJoaWtlcjovL2VtcHR5XFxcIlxcbn0pO1xcbnVzZXJMaXN0LnJldmVyc2UoKTtcXG5cXG5mb3IgKGxldCBpdGVtIG9mIHVzZXJMaXN0KSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIui0puWPt++8mlxcXCIgKyBpdGVtWzBdICsgKHVzZXJOYW1lID09PSBpdGVtWzBdID8gXFxcIlxcXFx0XFxcXHRcXFxcdOKAnOKAnFvlvZPliY3otKblj7dd4oCd4oCdXFxcIiA6IFxcXCJcXFwiKSxcXG4gICAgICAgIGRlc2M6IFxcXCLpqozor4HnoIHvvJpcXFwiICsgaXRlbVsxXSxcXG4gICAgICAgIHVybDogJChcXFwi5piv5ZCm5YiH5o2i5Li66K+lW1xcXCIgKyBpdGVtWzBdICsgXFxcIl3otKblj7dcXFwiKS5jb25maXJtKChmLCBpdGVtKSA9PiB7XFxuICAgICAgICAgICAgZi51c2VyID0gaXRlbTtcXG4gICAgICAgICAgICB3cml0ZUZpbGUoXFxcImhpa2VyOi8vZmlsZXMvV2FyZWhvdXNlVVNFUi5qc29uXFxcIiwgSlNPTi5zdHJpbmdpZnkoZikpO1xcbiAgICAgICAgICAgIGJhY2soKTtcXG4gICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5YiH5o2i5oiQ5YqfXFxcIjtcXG4gICAgICAgIH0sIHVzZXIsIGl0ZW0pLFxcbiAgICAgICAgY29sX3R5cGU6IFxcXCJ0ZXh0XzFcXFwiXFxuICAgIH0pO1xcbn1cXG5kYXRhLnB1c2goe1xcbiAgICBjb2xfdHlwZTogXFxcImxpbmVfYmxhbmtcXFwiXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IFxcXCLpgIDlh7rotKblj7dcXFwiLFxcbiAgICB1cmw6ICQoXFxcIuehruiupOmAgOWHuueZu+W9leeKtuaAgVxcXCIpLmNvbmZpcm0oKGYpID0+IHtcXG4gICAgICAgIGYudXNlciA9IFtdO1xcbiAgICAgICAgd3JpdGVGaWxlKFxcXCJoaWtlcjovL2ZpbGVzL1dhcmVob3VzZVVTRVIuanNvblxcXCIsIEpTT04uc3RyaW5naWZ5KGYpKTtcXG4gICAgICAgIGJhY2soKTtcXG4gICAgICAgIHJldHVybiBcXFwidG9hc3Q6Ly/pgIDlh7rmiJDlip9cXFwiO1xcbiAgICB9LCB1c2VyKSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJ1xcbn0pO1xcbnNldFJlc3VsdChkYXRhKTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuWIl+ihqOaOkuW6j+eul+azlVwiLFwicGF0aFwiOlwic29ydFwiLFwicnVsZVwiOlwianM6XFxuLyog6KeE5YiZ5YiX6KGo5o6S5bqPIFsgVVDjgIFORVfjgIHml6Dmm7TmlrAgXSDpobrluo8gKi9cXG4vKiDlvZLlubbmjpLluo8gU3RhcnQgKi9cXG4vKlxcbmZ1bmN0aW9uIG1lcmdlU29ydChhcnIpIHtcXG4gICAgdmFyIGxlbiA9IGFyci5sZW5ndGg7XFxuICAgIGlmIChsZW4gPCAyKSB7XFxuICAgICAgICByZXR1cm4gYXJyO1xcbiAgICB9XFxuICAgIHZhciBtaWRkbGUgPSBNYXRoLmZsb29yKGxlbiAvIDIpLFxcbiAgICAgICAgbGVmdCA9IGFyci5zbGljZSgwLCBtaWRkbGUpLFxcbiAgICAgICAgcmlnaHQgPSBhcnIuc2xpY2UobWlkZGxlKTtcXG4gICAgcmV0dXJuIG1lcmdlKG1lcmdlU29ydChsZWZ0KSwgbWVyZ2VTb3J0KHJpZ2h0KSk7XFxufVxcbmZ1bmN0aW9uIG1lcmdlKGxlZnQsIHJpZ2h0KSB7XFxuICAgIHZhciByZXN1bHQgPSBbXTtcXG4gICAgdmFyIGlzVGhpc1ZlcnNpb25MaXN0ID0gW107XFxuXFxuICAgIHdoaWxlIChsZWZ0Lmxlbmd0aCA+IDAgJiYgcmlnaHQubGVuZ3RoID4gMCkge1xcbiAgICAgICAgaWYgKGxlZnRbMF0udGl0bGUuaW5jbHVkZXMoXFxcIvCfhplcXFwiKSkge1xcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxlZnQuc2hpZnQoKSk7XFxuICAgICAgICB9IGVsc2UgaWYgKHJpZ2h0WzBdLnRpdGxlLmluY2x1ZGVzKFxcXCLwn4aZXFxcIikpIHtcXG4gICAgICAgICAgICByZXN1bHQucHVzaChyaWdodC5zaGlmdCgpKTtcXG4gICAgICAgIH0gZWxzZSBpZiAobGVmdFswXS50aXRsZS5pbmNsdWRlcyhcXFwi8J+GlVxcXCIpKSB7XFxuICAgICAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcXG4gICAgICAgIH0gZWxzZSBpZiAocmlnaHRbMF0udGl0bGUuaW5jbHVkZXMoXFxcIvCfhpVcXFwiKSkge1xcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xcbiAgICAgICAgfSBlbHNlIHtcXG4gICAgICAgICAgICBpc1RoaXNWZXJzaW9uTGlzdC5wdXNoKGxlZnQuc2hpZnQoKSk7XFxuICAgICAgICAgICAgaXNUaGlzVmVyc2lvbkxpc3QucHVzaChyaWdodC5zaGlmdCgpKTtcXG4gICAgICAgIH1cXG4gICAgfVxcblxcbiAgICB3aGlsZSAoaXNUaGlzVmVyc2lvbkxpc3QubGVuZ3RoKSByZXN1bHQucHVzaChpc1RoaXNWZXJzaW9uTGlzdC5zaGlmdCgpKTtcXG5cXG4gICAgd2hpbGUgKGxlZnQubGVuZ3RoKVxcbiAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcXG5cXG4gICAgd2hpbGUgKHJpZ2h0Lmxlbmd0aClcXG4gICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xcblxcbiAgICByZXR1cm4gcmVzdWx0O1xcbn1cXG4kLmV4cG9ydHMubWVyZ2VTb3J0ID0gbWVyZ2VTb3J0O1xcbiovXFxuLyog5b2S5bm25o6S5bqPIEVuZCAqL1xcbi8qIOaZrumAmuWIhuexu+aOkuW6jyBTdGFydCAqL1xcbmZ1bmN0aW9uIG5vcm1hbFNvcnQoYXJyKSB7XFxuICAgIHZhciBsZW4gPSBhcnIubGVuZ3RoO1xcbiAgICBpZiAobGVuIDwgMikge1xcbiAgICAgICAgcmV0dXJuIGFycjtcXG4gICAgfVxcbiAgICBsZXQgdXBSZXN1bHQgPSBbXTtcXG4gICAgbGV0IG90aGVyUmVzdWx0ID0gW107XFxuICAgIHdoaWxlKGFyci5sZW5ndGgpIHtcXG4gICAgICAgIGxldCBpdGVtID0gYXJyLnNoaWZ0KCk7XFxuICAgICAgICBpZihpdGVtLnRpdGxlLmluY2x1ZGVzKFxcXCLwn4aZXFxcIikpIHtcXG4gICAgICAgICAgICB1cFJlc3VsdC5wdXNoKGl0ZW0pXFxuICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgIG90aGVyUmVzdWx0LnB1c2goaXRlbSlcXG4gICAgICAgIH1cXG4gICAgfVxcbiAgICByZXR1cm4gdXBSZXN1bHQuY29uY2F0KG90aGVyUmVzdWx0KTtcXG59XFxuJC5leHBvcnRzLm5vcm1hbFNvcnQgPSBub3JtYWxTb3J0O1xcbi8qIOaZrumAmuWIhuexu+aOkuW6jyBFbmQgKi9cIn0se1wiY29sX3R5cGVcIjpcImljb25fMl9yb3VuZFwiLFwibmFtZVwiOlwi5YWo6YOo5YWs5byA6KeE5YiZXCIsXCJwYXRoXCI6XCJBbGxQdWJsaWNSdWxlXCIsXCJydWxlXCI6XCJqczpcXG4gICAgY29uc3Qge1xcbiAgICAgICAgYXBpLFxcbiAgICAgICAgbG9jYWxSdWxlVmVyLFxcbiAgICAgICAgZ2V0QXBpXFxuICAgIH0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFwiKTtcXG5jb25zdCB7XFxuICAgIG1lcmdlU29ydFxcbn0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS9zb3J0XFxcIik7XFxubGV0IGRhdGFUeXBlID0gZ2V0VmFyKFxcXCJXYXJlaG91c2UudHlwZVxcXCIsIFxcXCJcXFwiKTtcXG5sZXQgb3JkZXIgPSBnZXRWYXIoXFxcIldhcmVob3VzZS5vcmRlclxcXCIsIFxcXCIwXFxcIik7XFxubGV0IHNvcnQgPSBnZXRWYXIoXFxcIldhcmVob3VzZS5zb3J0XFxcIiwgXFxcIjBcXFwiKTtcXG5sZXQgZ29vZCA9IGdldFZhcihcXFwiV2FyZWhvdXNlLmdvb2RcXFwiLCBcXFwiXFxcIik7XFxubGV0IHBhZ2UgPSBNWV9VUkwuc3BsaXQoXFxcIiNcXFwiKVsxXSB8fCAxO1xcbmxldCBydWxlTGlzdCA9IEpTT04ucGFyc2UocmVxdWVzdChhcGkuYWxsX3J1bGUgKyBcXFwiP2RhdGFfdHlwZT1cXFwiICsgZGF0YVR5cGUgKyBcXFwiJnBhZ2U9XFxcIiArIHBhZ2UgKyBcXFwiJmxpbWl0PTIwJm9yZGVyPVxcXCIgKyBvcmRlciArIFxcXCImc29ydD1cXFwiICsgc29ydCsgXFxcIiZpc19nb29kPVxcXCIgKyBnb29kKSkucmVzdWx0O1xcbmFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKSA9PiB7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UudHlwZVxcXCIpO1xcbiAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLm9yZGVyXFxcIik7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2Uuc29ydFxcXCIpO1xcbiAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLmdvb2RcXFwiKTtcXG4gICAgY2xlYXJWYXIoXFxcIldhcmVob3VzZS5iYWNrXFxcIik7XFxufSkpO1xcbmxldCBkYXRhID0gW107XFxuaWYgKGdldFZhcihcXFwiV2FyZWhvdXNlLmJhY2tcXFwiKSA9PT0gXFxcIjFcXFwiKSB7XFxuICAgIGJhY2soKTtcXG59XFxuZnVuY3Rpb24gdGFiKGFyciwgdHlwZSwgY29udHJhc3QpIHtcXG4gICAgZm9yIChsZXQgaXRlbSBvZiBhcnIpIHtcXG4gICAgICAgIGRhdGEucHVzaCh7XFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW1bMV0gPT09IGNvbnRyYXN0ID8gXFxcIuKAnOKAnFxcXCIgKyBpdGVtWzBdICsgXFxcIuKAneKAnVxcXCIgOiBpdGVtWzBdLFxcbiAgICAgICAgICAgIHVybDogJChcXFwiI25vTG9hZGluZyNcXFwiKS5sYXp5UnVsZSgoa2V5LCB0eXBlKSA9PiB7XFxuICAgICAgICAgICAgICAgIHB1dFZhcih0eXBlLCBrZXkpO1xcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCI7XFxuICAgICAgICAgICAgfSwgaXRlbVsxXSwgdHlwZSksXFxuICAgICAgICAgICAgY29sX3R5cGU6IFxcXCJzY3JvbGxfYnV0dG9uXFxcIlxcbiAgICAgICAgfSk7XFxuICAgIH1cXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIGNvbF90eXBlOiBcXFwiYmxhbmtfYmxvY2tcXFwiXFxuICAgIH0pO1xcbn1cXG5pZiAocGFnZSA9PT0gXFxcIjFcXFwiKSB7XFxuICAgIHRhYihbXFxuICAgICAgICBbXFxcIuWFqOmDqFxcXCIsIFxcXCJcXFwiXSxcXG4gICAgICAgIFtcXFwi5bCP56iL5bqPXFxcIiwgXFxcImhvbWVfcnVsZV91cmxcXFwiXSxcXG4gICAgICAgIFtcXFwi5o+Q5Lqk5LqR5LuT5bqT6KeE5YiZXFxcIiwgXFxcInB1Ymxpc2hcXFwiXSxcXG4gICAgICAgIFtcXFwi572R6aG15o+S5Lu2XFxcIiwgXFxcImpzX3VybFxcXCJdLFxcbiAgICAgICAgW1xcXCLpnZnmgIHpobXpnaJcXFwiLCBcXFwiaHRtbFxcXCJdLFxcbiAgICAgICAgW1xcXCLkuLvpophcXFwiLCBcXFwiY29uZmlnXFxcIl1cXG4gICAgXSwgXFxcIldhcmVob3VzZS50eXBlXFxcIiwgZGF0YVR5cGUpO1xcbiAgICB0YWIoW1xcbiAgICAgICAgW1xcXCLml7bpl7RcXFwiLCBcXFwiMFxcXCJdLFxcbiAgICAgICAgW1xcXCJJRFxcXCIsIFxcXCIxXFxcIl0sXFxuICAgICAgICBbXFxcIuWlveivhOW6plxcXCIsIFxcXCIyXFxcIl0sXFxuICAgICAgICBbXFxcIuW3ruivhOW6plxcXCIsIFxcXCIzXFxcIl0sXFxuICAgICAgICBbXFxcIuWbnuWkjeaVsFxcXCIsIFxcXCI0XFxcIl1cXG4gICAgXSwgXFxcIldhcmVob3VzZS5vcmRlclxcXCIsIG9yZGVyKTtcXG4gICAgdGFiKFtcXG4gICAgICAgIFtcXFwi5YCS5bqPXFxcIiwgXFxcIjBcXFwiXSxcXG4gICAgICAgIFtcXFwi5q2j5bqPXFxcIiwgXFxcIjFcXFwiXVxcbiAgICBdLCBcXFwiV2FyZWhvdXNlLnNvcnRcXFwiLCBzb3J0KTtcXG4gICAgdGFiKFtcXG4gICAgICAgIFtcXFwi5LiN6K66XFxcIiwgXFxcIlxcXCJdLFxcbiAgICAgICAgW1xcXCLkvJjotKhcXFwiLCBcXFwiMVxcXCJdXFxuICAgIF0sIFxcXCJXYXJlaG91c2UuZ29vZFxcXCIsIGdvb2QpO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLmkJzntKJcXFwiLFxcbiAgICAgICAgdXJsOiAkLnRvU3RyaW5nKG5hbWUgPT4gXFxcImhpa2VyOi8vc2VhcmNoP3M9XFxcIiArIGlucHV0ICsgXFxcIiZydWxlPVxcXCIgKyBuYW1lLCBNWV9SVUxFLnRpdGxlKSxcXG4gICAgICAgIGNvbF90eXBlOiBcXFwiaW5wdXRcXFwiLFxcbiAgICAgICAgZGVzYzogXFxcIuaQnOe0ouWFqOmDqOinhOWImVxcXCJcXG4gICAgfSk7XFxufVxcblxcbmxldCBob21lTGlzdCA9IEpTT04ucGFyc2UocmVxdWVzdChhcGkuaG9tZSkpO1xcbmxldCBtUnVsZUxpc3QgPSBbXTtcXG5mb3IgKHZhciBpdGVtIG9mIHJ1bGVMaXN0KSB7XFxuICAgIHZhciBuYW1lID0gaXRlbS5uYW1lO1xcbiAgICBpZiAoaXRlbS5pc190YXApIHtcXG4gICAgICAgIGxldCBsb2NhdGlvbiA9IEpTT04ucGFyc2UocmVxdWVzdChnZXRBcGkoXFxcInJ1bGVMaXN0SnNvblxcXCIpICsgXFxcIj9pZD1cXFwiICsgaXRlbS5pZCkpO1xcbiAgICAgICAgaXRlbS5pZCA9IGxvY2F0aW9uLmlkO1xcbiAgICAgICAgaXRlbS5uYW1lID0gbG9jYXRpb24ubmFtZTtcXG4gICAgICAgIGl0ZW0uYXV0aG9yID0gbG9jYXRpb24uYXV0aG9yO1xcbiAgICAgICAgaXRlbS5kYXRhX3R5cGUgPSBsb2NhdGlvbi5kYXRhX3R5cGU7XFxuICAgICAgICBpdGVtLnZlciA9IGxvY2F0aW9uLnZlclxcbiAgICB9XFxuICAgIGl0ZW0udmVyc2lvbiA9IGl0ZW0udmVyO1xcbiAgICBsZXQgbGFiZWwgPSBcXFwiXFxcIixcXG4gICAgICAgIGx2ZXIgPSAtMjtcXG4gICAgaWYgKGl0ZW0uaXNfanNvbiAmJiBpdGVtLmRhdGFfdHlwZSA9PT0gXFxcImhvbWVfcnVsZV91cmxcXFwiKSB7XFxuICAgICAgICBsdmVyID0gbG9jYWxSdWxlVmVyKGhvbWVMaXN0LCBpdGVtKTtcXG4gICAgICAgIGlmIChsdmVyID09PSAtMSkge1xcbiAgICAgICAgICAgIGxhYmVsID0gXFxcIvCfhpVcXFwiO1xcbiAgICAgICAgfSBlbHNlIGlmIChsdmVyIDwgaXRlbS52ZXIpIHtcXG4gICAgICAgICAgICBsYWJlbCA9IFxcXCLwn4aZXFxcIjtcXG4gICAgICAgIH1cXG4gICAgfVxcbiAgICBtUnVsZUxpc3QucHVzaCh7XFxuICAgICAgICB0aXRsZTogbGFiZWwgKyBuYW1lLFxcbiAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9wYWdlL3J1bGVEZXRhaWwjbm9IaXN0b3J5IyNub1JlY29yZEhpc3RvcnkjXFxcIixcXG4gICAgICAgIGV4dHJhOiB7XFxuICAgICAgICAgICAgbHZlcjogbHZlcixcXG4gICAgICAgICAgICBpZDogaXRlbS5pZCxcXG4gICAgICAgICAgICBpc0FsbDp0cnVlXFxuICAgICAgICB9LFxcbiAgICAgICAgcGljX3VybDogaXRlbS5waWMsXFxuICAgIH0pXFxufVxcbi8qIOW9kuW5tuaOkuW6jyBTdGFydCAqL1xcbi8vbVJ1bGVMaXN0ID0gbWVyZ2VTb3J0KG1SdWxlTGlzdCk7XFxuLyog5b2S5bm25o6S5bqPIEVuZCAqL1xcbmRhdGEucHVzaC5hcHBseShkYXRhLCBtUnVsZUxpc3QpXFxuc2V0UmVzdWx0KGRhdGEpO1wifSx7XCJjb2xfdHlwZVwiOlwibW92aWVfM1wiLFwibmFtZVwiOlwi5Zue5aSNXCIsXCJwYXRoXCI6XCJSZXBseVwiLFwicnVsZVwiOlwianM6XFxubGV0IGRhdGEgPSBbXTtcXG5jb25zdCB7XFxuICAgIGFwaVxcbn0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFwiKTtcXG5sZXQge1xcbiAgICByZXBseUlkLFxcbiAgICBydWxlSWQsXFxuICAgIG5hbWUsXFxuICAgIHBhc3N3b3JkLFxcbiAgICB1c2VybmFtZVxcbn0gPSBNWV9QQVJBTVM7XFxuXFxuXFxuc2V0UGFnZVRpdGxlKFxcXCLlm57lpI0oXFxcIiArIG5hbWUgKyBcXFwiKVxcXCIpO1xcbmFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKSA9PiB7XFxuICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UuY29tbWVudC50ZXh0XFxcIik7XFxuICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXG59KSk7XFxuXFxuZGF0YS5wdXNoKHtcXG4gICAgZGVzYzogXFxcIuWbnuWkjS4uLi4uLlxcXCIsXFxuICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcbiAgICBleHRyYToge1xcbiAgICAgICAgdGl0bGVWaXNpYmxlOiBmYWxzZSxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UuY29tbWVudC50ZXh0JywgJycpLFxcbiAgICAgICAgdHlwZTogXFxcInRleHRhcmVhXFxcIixcXG4gICAgICAgIGhlaWdodDo3LFxcbiAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcIldhcmVob3VzZS5jb21tZW50LnRleHRcXFwiLGlucHV0KSdcXG4gICAgfVxcbn0pO1xcblxcblxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwi5o+Q5LqkXFxcIixcXG4gICAgY29sX3R5cGU6IFxcXCJ0ZXh0X2NlbnRlcl8xXFxcIixcXG4gICAgdXJsOiAkKGFwaS5kaXNfcmVwbHkgKyBydWxlSWQpLmxhenlSdWxlKChwYXNzd29yZCwgdXNlcm5hbWUsIHJ1bGVJZCkgPT4ge1xcbiAgICAgICAgbGV0IHRleHQgPSBnZXRWYXIoJ1dhcmVob3VzZS5jb21tZW50LnRleHQnLCAnJyk7XFxuICAgICAgICBpZiAocGFzc3dvcmQgPT0gXFxcIlxcXCIgfHwgdXNlcm5hbWUgPT0gXFxcIlxcXCIpIHtcXG4gICAgICAgICAgICByZXR1cm4gXFxcInRvYXN0Oi8v5pyq55m75b2V6LSm5Y+3XFxcIjtcXG4gICAgICAgIH1cXG4gICAgICAgIGlmICh0ZXh0ID09IFxcXCJcXFwiKSB7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+S9oOi/mOS7gOS5iOmDveayoeWGmeWVilxcXCI7XFxuICAgICAgICB9XFxuICAgICAgICBsZXQgcmVzdWx0ID0gcmVxdWVzdChpbnB1dCwge1xcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcXG4gICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xcbiAgICAgICAgICAgIH0sXFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xcbiAgICAgICAgICAgICAgICBcXFwicGFyYW1zXFxcIjoge1xcbiAgICAgICAgICAgICAgICAgICAgXFxcImRpc2N1c3NfdGV4dFxcXCI6IHRleHQsXFxuICAgICAgICAgICAgICAgICAgICBcXFwicXFcXFwiOiB1c2VybmFtZSxcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJwYXNzd29yZFxcXCI6IHBhc3N3b3JkLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcImRpc2N1c3NfaWRcXFwiOiBydWxlSWRcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH0pLFxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnXFxuICAgICAgICB9KTtcXG4gICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzdWx0KS5yZXN1bHQ7XFxuICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMCkge1xcbiAgICAgICAgICAgIGJhY2soZmFsc2UpO1xcbiAgICAgICAgfVxcbiAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL1xcXCIgKyByZXN1bHQuZGV0YWlsO1xcblxcbiAgICB9LCBwYXNzd29yZCwgdXNlcm5hbWUsIHJlcGx5SWQpXFxufSk7XFxuXFxuc2V0UmVzdWx0KGRhdGEpO1wifSx7XCJjb2xfdHlwZVwiOlwibW92aWVfM1wiLFwibmFtZVwiOlwi5oiR55qE5Zue5aSNXCIsXCJwYXRoXCI6XCJNeVJlcGx5XCIsXCJydWxlXCI6XCJqczpcXG5jb25zdCB7XFxuICAgIGFwaVxcbn0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFwiKTtcXG5sZXQge1xcbiAgICBhdXRoX2NvZGUsXFxuICAgIHFxXFxufSA9IE1ZX1BBUkFNUztcXG5sZXQgcGFnZSA9IHBhcnNlSW50KE1ZX1VSTC5zcGxpdChcXFwiI1xcXCIpWzFdKTtcXG5sZXQgZGF0YT1bXTtcXG5sZXQgY29tbWVudExpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoYXBpLmRpc19nZXRfcmVwbHkgKyBcXFwiP2xpbWl0PTUmcGFnZT1cXFwiICsgcGFnZSArIFxcXCImcXE9XFxcIiArIHFxICsgXFxcIiZhdXRoX2NvZGU9XFxcIiArIGF1dGhfY29kZSkpLnJlc3VsdDtcXG5pZiAoY29tbWVudExpc3QubGVuZ3RoID09PSAwKSB7XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTogXFxcIjxoNSBzdHlsZT0ndGV4dC1hbGlnbjpjZW50ZXInPuWIq+aLieS6huS4gOadoeS5n+S4jeWJqeS6hjwvaDU+XFxcIixcXG4gICAgICAgIGNvbF90eXBlOiBcXFwicmljaF90ZXh0XFxcIlxcbiAgICB9KTtcXG59IGVsc2Uge1xcbiAgICBmb3IgKGxldCBpdGVtIG9mIGNvbW1lbnRMaXN0KSB7XFxuICAgICAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLm5hbWUgKyBcXFwiJm5ic3A7Jm5ic3A7PGZvbnQgY29sb3I9J2dyYXknPjxzbWFsbD4jXFxcIiArIGl0ZW0uaWQgKyBcXFwiPC9zbWFsbD48Zm9udD5cXFwiLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwiYXZhdGFyXFxcIixcXG4gICAgICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvcnVsZURldGFpbCNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFwiLFxcbiAgICAgICAgICAgIGV4dHJhOiB7XFxuICAgICAgICAgICAgICAgIGx2ZXI6IFxcXCLlm57lpI3ov5vlhaXkuI3mlK/mjIHmn6XnnItcXFwiLFxcbiAgICAgICAgICAgICAgICBpZDogaXRlbS5ydWxlX2lkWzBdXFxuICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICBwaWNfdXJsOiBpdGVtLmF2YXRhcl91cmxcXG4gICAgICAgIH0pO1xcbiAgICAgICAgZGF0YS5wdXNoKHtcXG4gICAgICAgICAgICB0aXRsZTogaXRlbS5kaXNjdXNzX3RleHQsXFxuICAgICAgICAgICAgZGVzYzogaXRlbS5jcmVhdGVfZGF0ZSArIFxcXCLCt1xcXCIraXRlbS5ydWxlX2lkWzFdK1xcXCLCt1xcXCIrXFxcIuW8gOWPkeiAhfCfl6NcXFwiLFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF8xXFxcIixcXG4gICAgICAgICAgICB1cmw6IFxcXCJoaWtlcjovL3BhZ2UvaW5mb1xcXCIsXFxuICAgICAgICAgICAgZXh0cmE6e1xcbiAgICAgICAgICAgICAgICBuYW1lOml0ZW0ubmFtZSxcXG4gICAgICAgICAgICAgICAgdHlwZTpcXFwibG9uZ190ZXh0XFxcIixcXG4gICAgICAgICAgICAgICAgdGV4dDppdGVtLmRpc2N1c3NfdGV4dFxcbiAgICAgICAgICAgIH0sXFxuICAgICAgICAgICAgcGljX3VybDogaXRlbS5hdmF0YXJfdXJsXFxuICAgICAgICB9KTtcXG4gICAgfVxcbiAgICBcXG59XFxuc2V0UmVzdWx0KGRhdGEpO1xcblwifSx7XCJjb2xfdHlwZVwiOlwibW92aWVfM1wiLFwibmFtZVwiOlwi5pu05aSa5YiG5LqrXCIsXCJwYXRoXCI6XCJtb3JlU2hhcmVcIixcInJ1bGVcIjpcImpzOlxcbiAgICBhZGRMaXN0ZW5lcignb25DbG9zZScsICQudG9TdHJpbmcoKCk9PntcXG4gICAgICAgIGNsZWFyVmFyKFxcXCJob3VzZS51cGxvYWRfY29kZVxcXCIpO1xcbiAgICB9KSk7XFxuY29uc3Qge2NvbG9yLHNtYWxsLGFwaSwgZ2V0RmlsZX0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFwiKTtcXG5sZXQgaG91c2VGaWxlID0gZ2V0RmlsZXx8ZmFsc2U7XFxubGV0IHB1dF91cmwgPSBhcGkuaG9zdCsnL2hpa2VydWxlL2Rldi9wdXQnO1xcbmlmKCFob3VzZUZpbGUpe1xcbiAgICBzZXRJdGVtKCdpc19ob3VzZV92aXAnLCAnZmFsc2UnKTtcXG59XFxubGV0IGhvdXNlX2RhdGEgPSBob3VzZUZpbGUoKTtcXG4vLyBsb2coaG91c2VfZGF0YS51c2VybmFtZSsnLScraG91c2VfZGF0YS5wYXNzd29yZCk7XFxudmFyIGNhbnVwID0gaG91c2VfZGF0YS51c2VybmFtZS5sZW5ndGggPj0gNiAmJiBob3VzZV9kYXRhLnBhc3N3b3JkLmxlbmd0aCA+IDI7XFxubG9nKCflj6/ku6XkuIrkvKA/JytjYW51cCk7XFxubGV0IGQgPSBbXTtcXG5sZXQgZmlsZV90eXBlID0gW3tuYW1lOifpnZnmgIHmlofku7YnLHZhbHVlOidodG1sJ30se25hbWU6J+e9kemhteaPkuS7ticsdmFsdWU6J2pzX3VybCd9LHtuYW1lOifkuLvpobXphY3nva4nLHZhbHVlOidjb25maWcnfV07IC8v5LiK5Lyg57G75Z6LXFxubGV0IGZpbGVfcmVkaXJlY3QgPSBbe25hbWU6J+acrOWcsCcsdmFsdWU6J2ZhbHNlJ30se25hbWU6J+ebtOmTvjMwMicsdmFsdWU6J3RydWUnfV07IC8v5piv5ZCm6YeN5a6a5ZCRXFxubGV0IGZpbGVfdWEgPSBbe25hbWU6J+eUteiEkScsdmFsdWU6J3BjJ30se25hbWU6J+aJi+acuicsdmFsdWU6J21vYmlsZSd9XTtcXG5sZXQgZmlsZV90eXBlX3RpdGxlID0gZmlsZV90eXBlLm1hcCgoaXRlbSkgPT4ge1xcbiAgICBsZXQgbmFtZSA9IGdldEl0ZW0oJ2hvdXNlLmZpbGVfdHlwZScsJ+mdmeaAgeaWh+S7ticpO1xcbiAgICBpZihpdGVtLm5hbWU9PT1uYW1lKXtcXG4gICAgICAgIHJldHVybiAn8J+RiScraXRlbS5uYW1lO1xcbiAgICB9ZWxzZXtcXG4gICAgICAgIHJldHVybiBpdGVtLm5hbWU7XFxuICAgIH1cXG59KTtcXG5sZXQgZmlsZV9yZWRpcmVjdF90aXRsZSA9IGZpbGVfcmVkaXJlY3QubWFwKChpdGVtKSA9PiB7XFxuICAgIGxldCBuYW1lID0gZ2V0SXRlbSgnaG91c2UuZmlsZV9yZWRpcmVjdCcsJ+acrOWcsCcpO1xcbiAgICBpZihpdGVtLm5hbWU9PT1uYW1lKXtcXG4gICAgICAgIHJldHVybiAn8J+RiScraXRlbS5uYW1lO1xcbiAgICB9ZWxzZXtcXG4gICAgICAgIHJldHVybiBpdGVtLm5hbWU7XFxuICAgIH1cXG59KTtcXG5sZXQgZmlsZV91YV90aXRsZSA9IGZpbGVfdWEubWFwKChpdGVtKSA9PiB7XFxuICAgIGxldCBuYW1lID0gZ2V0SXRlbSgnaG91c2UuZmlsZV91YScsJ+eUteiEkScpO1xcbiAgICBpZihpdGVtLm5hbWU9PT1uYW1lKXtcXG4gICAgICAgIHJldHVybiAn8J+RiScraXRlbS5uYW1lO1xcbiAgICB9ZWxzZXtcXG4gICAgICAgIHJldHVybiBpdGVtLm5hbWU7XFxuICAgIH1cXG59KTtcXG5kLnB1c2goe2NvbF90eXBlOiAneDVfd2Vidmlld19zaW5nbGUnLCBleHRyYToge2pzOiAnY29uc29sZS5sb2coXFxcIuaIkeWKoOi9veS6hlxcXCIpJ319KTtcXG5kLnB1c2goe1xcbiAgICB0aXRsZTogJ+iOt+WPlicsXFxuICAgIGRlc2M6IFxcXCLmlofku7bot6/lvoQs5pSv5oyBaGlrZXIsZmlsZSxodHRwLOS4u+mimFxcXCIsXFxuICAgIGV4dHJhOiB7XFxuICAgICAgICBvbkNoYW5nZTogXFxcInB1dFZhcignaG91c2Uud2ViX3VybCcsaW5wdXQpXFxcIixcXG4gICAgICAgIHRpdGxlVmlzaWJsZTogdHJ1ZSxcXG4gICAgICAgIGlkOidmaWxlUGF0aCcsXFxuICAgICAgICBkZWZhdWx0VmFsdWU6Z2V0VmFyKCdob3VzZS53ZWJfdXJsJylcXG4gICAgfSxcXG4gICAgdXJsOiQudG9TdHJpbmcoKCkgPT4ge1xcbiAgICAgICAgbGV0IGlucHV0ID0gZ2V0VmFyKCdob3VzZS53ZWJfdXJsJywnJyk7XFxuICAgICAgICBpZihpbnB1dC5sZW5ndGg8Mil7XFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+mTvuaOpeS4jeWPr+S7peS4uuepuidcXG4gICAgICAgIH0gZWxzZSBpZigvXmhpa2VyOnxeZmlsZTp8Xmh0dHA6fF5odHRwczp8XlxcXFwvc3RvcmFnZVxcXFwvfF5cXFxcL3NkY2FyZFxcXFwvLy50ZXN0KGlucHV0KSl7XFxuICAgICAgICAgICAgaWYoL15cXFxcL3N0b3JhZ2VcXFxcL3xeXFxcXC9zZGNhcmRcXFxcLy8udGVzdChpbnB1dCkpe1xcbiAgICAgICAgICAgICAgICBpbnB1dCA9ICdmaWxlOi8vJytpbnB1dDtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgbG9nKCfmraPluLjpk77mjqU6JytpbnB1dCk7XFxuICAgICAgICAgICAgbGV0IHVhID0gZ2V0SXRlbSgnaG91c2UuZmlsZV91YScpPT09J+eUteiEkSc/J01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84OC4wLjQzMjQuMTQ2IFNhZmFyaS81MzcuMzYnOidNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgOTsgTUkgNikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg5LjAuNDM4OS45MCBNb2JpbGUgU2FmYXJpLzUzNy4zNic7XFxuICAgICAgICAgICAgbGV0IHdlYl91cmxfYXJyID0gaW5wdXQuc3BsaXQoJzsnKTtcXG4gICAgICAgICAgICBsZXQgd2ViX3VybCA9IHdlYl91cmxfYXJyWzBdO1xcbiAgICAgICAgICAgIGxldCBoZWFkZXJzID0ge1xcbiAgICAgICAgICAgICAgICAnUmVmZXJlcic6J2h0dHBzOi8vYmxvZy5jc2RuLm5ldCcsXFxuICAgICAgICAgICAgICAgICdVc2VyLUFnZW50Jzp1YSxcXG4gICAgICAgICAgICAgICAgJ0FjY2VwdCc6J2FwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCwgKi8qOyBxPTAuMDEnLFxcbiAgICAgICAgICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzonemgtQ04nLFxcbiAgICAgICAgICAgIH07XFxuICAgICAgICAgICAgaWYod2ViX3VybF9hcnIubGVuZ3RoPj0zJiZ3ZWJfdXJsX2FyclsyXS5sZW5ndGg+Mil7IC8v6K6+572u57yW56CBXFxuICAgICAgICAgICAgICAgIGhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID0gJ2NoYXJzZXQ9Jyt3ZWJfdXJsX2FyclsyXS50b1VwcGVyQ2FzZSgpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBsZXQgcGFyYW1zID0ge2hlYWRlcnM6aGVhZGVycyx3aXRoSGVhZGVyczpmYWxzZSxyZWRpcmVjdDpmYWxzZX07XFxuICAgICAgICAgICAgaWYod2ViX3VybF9hcnIubGVuZ3RoPj0yJiZ3ZWJfdXJsX2FyclsxXS5sZW5ndGg+Mil7IC8vIOiuvue9ruivt+axguaWueazlVxcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ21ldGhvZCddID0gd2ViX3VybF9hcnJbMV0udG9VcHBlckNhc2UoKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgbG9nKCflvIDlp4vojrflj5bmupDnoIEnKTtcXG4gICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAvKlxcbiAgICAgICAgICAgICAgICByZXF1ZXN0QXN5bmMod2ViX3VybCxwYXJhbXMsZnVuY3Rpb24gKGtleSxjb2RlKSB7XFxuICAgICAgICAgICAgICAgICAgICBsZXQgYmFja19jb2RlID0gY29kZTtcXG4gICAgICAgICAgICAgICAgICAgIGlmKGJhY2tfY29kZS5sZW5ndGg+MjApe1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1dFZhcignaG91c2UudXBsb2FkX2NvZGUnLGJhY2tfY29kZSk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UodHJ1ZSk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+a6kOeggeW3suiOt+WPlizlubbpg6jliIbmj5LlhaXliLDmlofmnKzljLrln58nXFxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v6ZSZ6K+v77yM5pys5qyh6I635Y+W5Yiw56m65paH5pys77yM55aR5Ly85L2g5rKh5pyJ5q2k5paH5Lu2ISc7XFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgICAgICAqL1xcbiAgICAgICAgICAgICAgICBsZXQgYmFja19jb2RlID0gZ2V0SXRlbSgnaG91c2UuZmlsZV91YScpPT09J+eUteiEkSc/ZmV0Y2god2ViX3VybCxwYXJhbXMpOnJlcXVlc3Qod2ViX3VybCxwYXJhbXMpO1xcbiAgICAgICAgICAgICAgICBpZihiYWNrX2NvZGUubGVuZ3RoPjIwKXtcXG4gICAgICAgICAgICAgICAgICAgIHB1dFZhcignaG91c2UudXBsb2FkX2NvZGUnLGJhY2tfY29kZSk7XFxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/mupDnoIHlt7Lojrflj5Ys5bm26YOo5YiG5o+S5YWl5Yiw5paH5pys5Yy65Z+fJ1xcbiAgICAgICAgICAgICAgICB9ZWxzZXtcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/plJnor6/vvIzmnKzmrKHojrflj5bliLDnqbrmlofmnKzvvIznlpHkvLzkvaDmsqHmnInmraTmlofku7YhJztcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH1jYXRjaCAoZSkge1xcbiAgICAgICAgICAgICAgICBsb2coZS5tZXNzYWdlKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+WPkeeUn+S6humUmeivrzpcXFxcbicrZS5tZXNzYWdlO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1lbHNlIGlmKC/kuLvpopjvv6V85YWD57Sg77+lLy50ZXN0KGlucHV0KSl7XFxuICAgICAgICAgICAgbG9nKCfkuLvpopjpk77mjqUnKTtcXG4gICAgICAgICAgICBsZXQgd2ViX3VybF9hcnIgPSBpbnB1dC5zcGxpdCgn77+lJyk7XFxuICAgICAgICAgICAgbGV0IHdlYl91cmwgPSB3ZWJfdXJsX2Fyclt3ZWJfdXJsX2Fyci5sZW5ndGgtMV07XFxuICAgICAgICAgICAgbGV0IGJhY2tfY29kZSA9IHBhcnNlUGFzdGUod2ViX3VybCk7XFxuICAgICAgICAgICAgaWYoYmFja19jb2RlLmxlbmd0aD4yMCkge1xcbiAgICAgICAgICAgICAgICBwdXRWYXIoJ2hvdXNlLnVwbG9hZF9jb2RlJyxiYWNrX2NvZGUpO1xcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+a6kOeggeW3suiOt+WPlizlubbpg6jliIbmj5LlhaXliLDmlofmnKzljLrln58nXFxuICAgICAgICAgICAgfWVsc2V7XFxuICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/plJnor6/vvIzmnKzmrKHojrflj5bov5Tlm57kuLo6XFxcXG4nK2JhY2tfY29kZTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9ZWxzZXtcXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v6Z2e5rOV6ZO+5o6lOlxcXFxuJytnZXRWYXIoJ2hvdXNlLndlYl91cmwnKTtcXG4gICAgICAgIH1cXG4gICAgfSksXFxuICAgIGNvbF90eXBlOiBcXFwiaW5wdXRcXFwiXFxufSk7XFxuZC5wdXNoKHtcXG4gICAgdGl0bGU6IFxcXCLpgInmi6nmlofku7bot6/lvoRcXFwiLFxcbiAgICB1cmw6JCgnI25vTG9hZGluZyMnKS5sYXp5UnVsZSgoKT0+e1xcbiAgICAgICAgLypcXG4gICAgICAgIGxldCBmcCA9ICdodHRwczovL2dpdGNvZGUubmV0L3FxXzMyMzk0MzUxL2RyLy0vcmF3L21hc3Rlci9qcy9maWxlU2VsZWN0LmpzJztcXG4gICAgICAgIGxldCBmID0gcmVxdWlyZShmcCk7XFxuICAgICAgICAqL1xcbiAgICAgICAgbGV0IGZwPWNvbmZpZy5saWIuZmlsZVNlbGVjdDtcXG4gICAgICAgIGxldCBmPSQucmMoZnApO1xcbiAgICAgICAgcmV0dXJuIGYuZmlsZVNlbGVjdGlvblVyaSh7XFxuICAgICAgICAgICAgY2FsbGJhY2s6ICQudG9TdHJpbmcoKCkgPT4ge1xcbiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gZmluZEl0ZW0oXFxcImZpbGVQYXRoXFxcIikuZXh0cmE7XFxuICAgICAgICAgICAgICAgIHVwZGF0ZUl0ZW0oXFxcImZpbGVQYXRoXFxcIiwge1xcbiAgICAgICAgICAgICAgICAgICAgZXh0cmE6IE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBQQVRIXFxuICAgICAgICAgICAgICAgICAgICB9KVxcbiAgICAgICAgICAgICAgICB9KTtcXG4gICAgICAgICAgICAgICAgcHV0VmFyKCdob3VzZS53ZWJfdXJsJyxQQVRIKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XFxuICAgICAgICAgICAgfSksXFxuICAgICAgICAgICAgb25DbGlja1R5cGU6J2NvbmZpcm0nLFxcbiAgICAgICAgICAgIGZpbGVUeXBlOiBcXFwiLmpzfC50eHR8Lmhpa2VyfC5qc29ufC5odG1sXFxcIixcXG4gICAgICAgICAgICBwYXR0ZXJuOiAwLFxcbiAgICAgICAgICAgIHJlcXVpcmVVcmw6ZnAsXFxuICAgICAgICAgICAgaW5pdGlhbFBhdGg6Z2V0UGF0aCgnaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlLycpLnNsaWNlKDcpLFxcbiAgICAgICAgICAgIG1lbW9yeTondHJ1ZScsXFxuICAgICAgICB9KTtcXG4gICAgfSksXFxuICAgIGNvbF90eXBlOiBcXFwidGV4dF9jZW50ZXJfMVxcXCIsXFxufSk7XFxuZC5wdXNoKHtcXG4gICAgdGl0bGU6J+S4iuS8oOexu+WeiycsXFxuICAgIGRlc2M6J+S4iuS8oOaWh+S7tueahOexu+WeiyzlvZPliY3kuLo6Jytjb2xvcihnZXRJdGVtKCdob3VzZS5maWxlX3R5cGUnLCfpnZnmgIHmlofku7YnKSwnI2ZmNzAwMCcpLFxcbiAgICBjb2xfdHlwZTondGV4dF8xJyxcXG4gICAgdXJsOiQoZmlsZV90eXBlX3RpdGxlLDIpLnNlbGVjdCgoKSA9PiB7XFxuICAgICAgICBzZXRJdGVtKCdob3VzZS5maWxlX3R5cGUnLGlucHV0LnJlcGxhY2UoJ/CfkYknLCcnKSk7XFxuICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXG4gICAgICAgIHJldHVybiAndG9hc3Q6Ly/kvaDpgInmi6nkuoY6JytpbnB1dDtcXG4gICAgfSlcXG59KTtcXG5cXG5kLnB1c2goe1xcbiAgICB0aXRsZTon5paH5Lu25a6a5L2NJyxcXG4gICAgZGVzYzon5paH5Lu25piv5ZCm5bGe5LqO6YeN5a6a5ZCRLOW9k+WJjeS4ujonK2NvbG9yKGdldEl0ZW0oJ2hvdXNlLmZpbGVfcmVkaXJlY3QnLCfmnKzlnLAnKSwnI2ZmNzAwMCcpLFxcbiAgICBjb2xfdHlwZTondGV4dF8xJyxcXG4gICAgdXJsOiQoZmlsZV9yZWRpcmVjdF90aXRsZSwyKS5zZWxlY3QoKCkgPT4ge1xcbiAgICAgICAgc2V0SXRlbSgnaG91c2UuZmlsZV9yZWRpcmVjdCcsaW5wdXQucmVwbGFjZSgn8J+RiScsJycpKTtcXG4gICAgICAgIHJlZnJlc2hQYWdlKHRydWUpO1xcbiAgICAgICAgcmV0dXJuICd0b2FzdDovL+S9oOmAieaLqeS6hjonK2lucHV0O1xcbiAgICB9KVxcbn0pO1xcblxcbmQucHVzaCh7XFxuICAgIHRpdGxlOiforr7lpIdVQScsXFxuICAgIGRlc2M6J+WPkei1t+e9kemhteivt+axguWktOagh+ivhizlvZPliY3kuLo6Jytjb2xvcihnZXRJdGVtKCdob3VzZS5maWxlX3VhJywn55S16ISRJyksJyNmZjcwMDAnKSxcXG4gICAgY29sX3R5cGU6J3RleHRfMScsXFxuICAgIHVybDokKGZpbGVfdWFfdGl0bGUsMikuc2VsZWN0KCgpID0+IHtcXG4gICAgICAgIHNldEl0ZW0oJ2hvdXNlLmZpbGVfdWEnLGlucHV0LnJlcGxhY2UoJ/CfkYknLCcnKSk7XFxuICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXG4gICAgICAgIHJldHVybiAndG9hc3Q6Ly/kvaDpgInmi6nkuoY6JytpbnB1dDtcXG4gICAgfSlcXG59KTtcXG5mdW5jdGlvbiBjb21wYXJlKG5hbWUpIHtcXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHtcXG4gICAgICAgIHJldHVybiBpdGVtLm5hbWUgPT09IG5hbWU7XFxuICAgIH1cXG59XFxuZC5wdXNoKHtcXG4gICAgdGl0bGU6J/Cfl4TvuI/njq/looMnLFxcbiAgICBjb2xfdHlwZTonZmxleF9idXR0b24nLFxcbiAgICB1cmw6JCgpLmxhenlSdWxlKChmaWxlX3R5cGUsY29tcGFyZSk9PntcXG4gICAgICAgIGxvZygn5p+l55yL546v5aKD5Y+Y6YePJyk7XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIGxldCB1cF9jb2RlID0gZ2V0VmFyKCdob3VzZS51cGxvYWRfY29kZScsJycpO1xcbiAgICAgICAgICAgIGxldCBmdHlwZSA9ICBmaWxlX3R5cGUuZmlsdGVyKGNvbXBhcmUoZ2V0SXRlbSgnaG91c2UuZmlsZV90eXBlJywn6Z2Z5oCB5paH5Lu2JykpKVswXS52YWx1ZTtcXG4gICAgICAgICAgICBsZXQgcmVkaXJlY3QgPSBnZXRJdGVtKCdob3VzZS5maWxlX3JlZGlyZWN0Jywn5pys5ZywJykhPT0n5pys5ZywJztcXG4gICAgICAgICAgICBsZXQgY29kZSA9ICFyZWRpcmVjdD91cF9jb2RlOmlucHV0O1xcbiAgICAgICAgICAgIGxldCBlbnYgPSB7XFxuICAgICAgICAgICAgICAgIHdlYl91cmw6Z2V0VmFyKCdob3VzZS53ZWJfdXJsJywnJyksXFxuICAgICAgICAgICAgICAgIGRldmljZTpnZXRJdGVtKCdob3VzZS5maWxlX3VhJywn55S16ISRJyksXFxuICAgICAgICAgICAgICAgIGZ0eXBlOmZ0eXBlfHxcXFwiXFxcIixcXG4gICAgICAgICAgICAgICAgcmVkaXJlY3Q6cmVkaXJlY3QsXFxuICAgICAgICAgICAgICAgIGNvZGU6Y29kZS5zdWJzdHJpbmcoMCw0MCl8fFxcXCJcXFwiLFxcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBsb2coZW52KTtcXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8vJytKU09OLnN0cmluZ2lmeShlbnYpO1xcbiAgICAgICAgICAgIC8vIGFsZXJ0KEpTT04uc3RyaW5naWZ5KGVudikpO1xcbiAgICAgICAgfWNhdGNoIChlKSB7XFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovLycrZS5tZXNzYWdlO1xcbiAgICAgICAgICAgIC8vIGFsZXJ0KGUubWVzc2FnZSk7XFxuICAgICAgICB9XFxuICAgIH0sZmlsZV90eXBlLGNvbXBhcmUpXFxufSk7XFxuXFxuZC5wdXNoKHtcXG4gICAgdGl0bGU6J/Cfk4PmlZnnqIsnLFxcbiAgICBjb2xfdHlwZTonZmxleF9idXR0b24nLFxcbiAgICB1cmw6JCgpLng1UnVsZSgoKT0+e1xcbiAgICAgICAgbGV0IG1zZyA9ICfmrKLov47kvb/nlKjlvIDlj5HogIXmm7TlpJrliIbkuqvlt6XlhbdcXFxcbjEu6L6T5YWl572R5Z2A5Li65pys5Zyw5paH5Lu26Lev5b6ELGhpa2VyOi8v5oiW6ICFZmlsZTovL+W8gOWktFxcXFxuMi7ngrnlh7vnvZHlnYDovpPlhaXmoI/lkI7pnaLnmoTmjInpkq5cXFxcbjMu55yL5paH5pys6aKE6KeI5Yy65piv5ZCm5q2j56GuXFxcXG40LueCueWHu+S4iuS8oOaMiemSruaPkOS6pOWIsOS7k+W6kyc7XFxuICAgICAgICBhbGVydChtc2cpO1xcbiAgICB9KVxcbn0pO1xcblxcbmQucHVzaCh7XFxuICAgIHRpdGxlOifwn5eR77iP5riF56m6JyxcXG4gICAgY29sX3R5cGU6J2ZsZXhfYnV0dG9uJyxcXG4gICAgdXJsOiQoKS5sYXp5UnVsZSgoKT0+e1xcbiAgICAgICAgY2xlYXJWYXIoJ2hvdXNlLnVwbG9hZF9jb2RlJyk7XFxuICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXG4gICAgICAgIHJldHVybiAndG9hc3Q6Ly/lt7LmuIXpmaTpooTop4jljLrln5/lhoXlrrknXFxuICAgIH0pXFxufSk7XFxuXFxuZC5wdXNoKHtcXG4gICAgdGl0bGU6J/Cfk7LnpLrkvosnLFxcbiAgICBjb2xfdHlwZTonZmxleF9idXR0b24nLFxcbiAgICB1cmw6JCgpLmxhenlSdWxlKCgpPT57XFxuICAgICAgICBsZXQgZGVtb19jb2RlID0gZ2V0SXRlbSgnaG91c2UuZGVtbycsJzAnKTtcXG4gICAgICAgIGlmKGRlbW9fY29kZT09JzAnKXtcXG4gICAgICAgICAgICBwdXRWYXIoJ2hvdXNlLndlYl91cmwnLCdoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvaHRtbC/otYTmupDnvZHkuabnrb4uaHRtbCcpO1xcbiAgICAgICAgICAgIGRlbW9fY29kZSA9IHBhcnNlSW50KGRlbW9fY29kZSkrMTtcXG4gICAgICAgICAgICBzZXRJdGVtKCdob3VzZS5kZW1vJyxkZW1vX2NvZGUrJycpO1xcbiAgICAgICAgfWVsc2V7XFxuICAgICAgICAgICAgcHV0VmFyKCdob3VzZS53ZWJfdXJsJywnZmlsZTovLy9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL2NvbS5leGFtcGxlLmhpa2Vydmlldy9maWxlcy9Eb2N1bWVudHMvcnVsZXMvZHpIb3VzZS9odG1sL+i1hOa6kOe9keS5puetvi5odG1sJyk7XFxuICAgICAgICAgICAgc2V0SXRlbSgnaG91c2UuZGVtbycsJzAnKTtcXG4gICAgICAgIH1cXG4gICAgICAgIHJlZnJlc2hQYWdlKHRydWUpO1xcbiAgICAgICAgcmV0dXJuICd0b2FzdDovL+W3suiuvue9ruekuuS+i+WcsOWdgCdcXG4gICAgfSlcXG59KTtcXG5cXG5kLnB1c2goe1xcbiAgICB0aXRsZTon8J+TpOS4iuS8oCcsXFxuICAgIGNvbF90eXBlOidmbGV4X2J1dHRvbicsXFxuICAgIHVybDokKCkubGF6eVJ1bGUoKGNhbnVwLGhvdXNlX2RhdGEscHV0X3VybCxmaWxlX3R5cGUpID0+e1xcbiAgICAgICAgZnVuY3Rpb24gY29tcGFyZShuYW1lKSB7XFxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmFtZSA9PT0gbmFtZTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgICAgICBjb25zdCB7Z2V0Tm93Rm9ybWF0RGF0ZX09JC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcIik7XFxuICAgICAgICBsZXQgdXBfY29kZSA9IGdldFZhcignaG91c2UudXBsb2FkX2NvZGUnLCcnKTtcXG4gICAgICAgIGlmKHVwX2NvZGUubGVuZ3RoIDwgMil7XFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+a6kOeggeWMuuaXoOWGheWuue+8jOivt+WFiOiuv+mXruS4gOS4qumdmeaAgemhtemdoidcXG4gICAgICAgIH1cXG4gICAgICAgIGlmKCFjYW51cCl7XFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+S9oOS4jeaYr+W8gOWPkeiAhe+8jOayoeacieaPkOS6pOWIsOS7k+W6k+eahOadg+WIqSEnXFxuICAgICAgICB9XFxuICAgICAgICBsZXQgaW5wdXQgPSBnZXRWYXIoJ2hvdXNlLndlYl91cmwnLCcnKTtcXG4gICAgICAgIGxldCB3ZWJfdXJsID0gaW5wdXQuc3BsaXQoJzsnKVswXTtcXG4gICAgICAgIGxldCBmaWxlTmFtZSA9ICcnO1xcbiAgICAgICAgaWYoL15oaWtlcjp8XmZpbGU6fF5odHRwOnxeaHR0cHM6fF5cXFxcL3N0b3JhZ2VcXFxcL3xeXFxcXC9zZGNhcmRcXFxcLy8udGVzdCh3ZWJfdXJsKSl7XFxuICAgICAgICAgICAgZmlsZU5hbWUgPSB3ZWJfdXJsLnNwbGl0KCcvJylbd2ViX3VybC5zcGxpdCgnLycpLmxlbmd0aC0xXTtcXG4gICAgICAgIH1lbHNlIGlmKC/kuLvpopjvv6V85YWD57Sg77+lLy50ZXN0KGlucHV0KSl7XFxuICAgICAgICAgICAgbGV0IGJrYXJyID0gdXBfY29kZS5zcGxpdCgn77+lJyk7XFxuICAgICAgICAgICAgaWYoYmthcnIubGVuZ3RoPDMpe1xcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v5LqR5Ymq6LS05p2/5YaF5a655pyJ6K+vJ1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBzd2l0Y2ggKGJrYXJyWzFdKSB7XFxuICAgICAgICAgICAgICAgIGNhc2UgJ215X2hvbWVfdGhlbWUnOlxcbiAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSB1cF9jb2RlLnNwbGl0KCfjgIwnKVsxXS5zcGxpdCgn44CNJylbMF07XFxuICAgICAgICAgICAgICAgICAgICBicmVhaztcXG4gICAgICAgICAgICAgICAgY2FzZSAnbXlfaG9tZV9zaW5nbGUnOlxcbiAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSB1cF9jb2RlLnNwbGl0KCfjgIwnKVsxXS5zcGxpdCgn44CNJylbMF07XFxuICAgICAgICAgICAgICAgICAgICBicmVhaztcXG4gICAgICAgICAgICAgICAgY2FzZSAnanNfdXJsJzpcXG4gICAgICAgICAgICAgICAgICAgIGZpbGVOYW1lID0gdXBfY29kZS5zcGxpdCgn77+lJylbMl0uc3BsaXQoJ0AnKVswXTtcXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1lbHNle1xcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/plJnor6/vvIznvZHpobXpk77mjqXml6DlhoXlrrkhJztcXG4gICAgICAgIH1cXG4gICAgICAgIGxldCB1YSA9IGdldEl0ZW0oJ2hvdXNlLmZpbGVfdWEnKT09PSfnlLXohJEnPydNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvODguMC40MzI0LjE0NiBTYWZhcmkvNTM3LjM2JzonTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDk7IE1JIDYpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84OS4wLjQzODkuOTAgTW9iaWxlIFNhZmFyaS81MzcuMzYnO1xcbiAgICAgICAgbGV0IGhlYWRlcnMgPSB7XFxuICAgICAgICAgICAgJ1JlZmVyZXInOidodHRwczovL2Jsb2cuY3Nkbi5uZXQnLFxcbiAgICAgICAgICAgIFxcXCJjb250ZW50LXR5cGVcXFwiOiBcXFwiYXBwbGljYXRpb24vanNvblxcXCIsXFxuICAgICAgICAgICAgJ1VzZXItQWdlbnQnOnVhLFxcbiAgICAgICAgICAgICdBY2NlcHQnOidhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQsICovKjsgcT0wLjAxJyxcXG4gICAgICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzonemgtQ04nLFxcbiAgICAgICAgfTtcXG4gICAgICAgIGxldCB0b0NvbXBhcmUgPSAnJztcXG4gICAgICAgIGlmKGZpbGVOYW1lLmVuZHNXaXRoKCcuaHRtbCcpKXtcXG4gICAgICAgICAgICB0b0NvbXBhcmUgPSAn6Z2Z5oCB5paH5Lu2JztcXG4gICAgICAgIH1lbHNlIGlmKC/kuLvpopgvLnRlc3QoZmlsZU5hbWUpKXtcXG4gICAgICAgICAgICB0b0NvbXBhcmUgPSAn5Li76aG16YWN572uJ1xcbiAgICAgICAgfVxcbiAgICAgICAgbGV0IGZ0eXBlID0gIGZpbGVfdHlwZS5maWx0ZXIoY29tcGFyZSh0b0NvbXBhcmV8fGdldEl0ZW0oJ2hvdXNlLmZpbGVfdHlwZScsJ+mdmeaAgeaWh+S7ticpKSlbMF0udmFsdWU7XFxuICAgICAgICBsZXQgcmVkaXJlY3QgPSBnZXRJdGVtKCdob3VzZS5maWxlX3JlZGlyZWN0Jywn5pys5ZywJykhPT0n5pys5ZywJztcXG4gICAgICAgIGlmKHJlZGlyZWN0JiYhd2ViX3VybC5zdGFydHNXaXRoKCdodHRwJykpe1xcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/nm7Tpk74zMDLph43lrprlkJHnvZHlnYDpk77mjqXlv4XpobtodHRw5byA5aS0JztcXG4gICAgICAgIH1cXG4gICAgICAgIGxldCBjb2RlID0gIXJlZGlyZWN0P3VwX2NvZGU6d2ViX3VybDtcXG4gICAgICAgIGxldCBkYXRhID0ge1xcXCJwYXJhbXNcXFwiOlxcbiAgICAgICAgICAgICAgICB7XFxcImRhdGFcXFwiOiB7cnVsZV9uYW1lOiBmaWxlTmFtZSwgXFxcInJ1bGVfdHlwZVxcXCI6ICfmm7TlpJrliIbkuqsnLCBcXFwidmVyc2lvblxcXCI6Z2V0Tm93Rm9ybWF0RGF0ZSgpLFxcXCJydWxlX3ZhbHVlXFxcIjogY29kZSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhX3R5cGU6ZnR5cGUsIGlzX3JlZGlyZWN0OnJlZGlyZWN0LGRldmljZVVhOmdldEl0ZW0oJ2hvdXNlLmZpbGVfdWEnKSxcXG4gICAgICAgICAgICAgICAgICAgIH0sXFxuICAgICAgICAgICAgICAgICAgICBcXFwibmFtZVxcXCI6IGhvdXNlX2RhdGEudXNlcm5hbWUsXFxuICAgICAgICAgICAgICAgICAgICBcXFwicGFzc3dvcmRcXFwiOiBob3VzZV9kYXRhLnBhc3N3b3JkfVxcbiAgICAgICAgfTtcXG4gICAgICAgIGxldCB1cHBhcmFtcyA9IHtoZWFkZXJzOmhlYWRlcnMsYm9keTpKU09OLnN0cmluZ2lmeShkYXRhKSx3aXRoSGVhZGVyczpmYWxzZSxyZWRpcmVjdDpmYWxzZSxtZXRob2Q6J1BPU1QnfTtcXG4gICAgICAgIGxldCBiYWNrbXNnID0gZ2V0SXRlbSgnaG91c2UuZmlsZV91YScpPT09J+eUteiEkSc/ZmV0Y2gocHV0X3VybCx1cHBhcmFtcyk6cmVxdWVzdChwdXRfdXJsLHVwcGFyYW1zKTtcXG4gICAgICAgIHRyeXtcXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZShiYWNrbXNnKS5yZXN1bHQ7XFxuICAgICAgICAgICAgbGV0IGRldGFpbCA9IHJlc3VsdC5kZXRhaWw7XFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovLycrZGV0YWlsO1xcbiAgICAgICAgfWNhdGNoIChlKSB7XFxuICAgICAgICAgICAgbG9nKGUubWVzc2FnZSk7XFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+WPkeeUn+S6humUmeivr1xcXFxuJytlLm1lc3NhZ2U7XFxuICAgICAgICB9XFxuICAgIH0sY2FudXAsaG91c2VfZGF0YSxwdXRfdXJsLGZpbGVfdHlwZSlcXG59KTtcXG5cXG5kLnB1c2goe1xcbiAgICB0aXRsZTon6ZW/5paH5pys6aKE6KeI5Yy65Z+fJyxcXG4gICAgY29sX3R5cGU6J3RleHRfMScsXFxuICAgIHVybDonaGlrZXI6Ly9lbXB0eScsXFxuICAgIGV4dHJhOiB7dGV4dFNpemU6IDExLGxpbmVWaXNpYmxlOmZhbHNlfVxcbn0pO1xcblxcbmQucHVzaCh7XFxuICAgIHRpdGxlOmdldFZhcignaG91c2UudXBsb2FkX2NvZGUnLCcnKS5zdWJzdHJpbmcoMCwxMDI0MCksXFxuICAgIGNvbF90eXBlOidsb25nX3RleHQnLFxcbiAgICBleHRyYToge3RleHRTaXplOiAxMX1cXG59KTtcXG5zZXRQYWdlVGl0bGUoXFxcIuabtOWkmuWIhuS6q1xcXCIpO1xcbnNldFJlc3VsdChkKTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIui9u+WQiOmbhueUn+aIkOaOpeWPo1wiLFwicGF0aFwiOlwiZ2VuQXBpXCIsXCJydWxlXCI6XCJqczpcXG5mdW5jdGlvbiBnZW5SdWxlKG5hbWUsdXJsLGljb24pe1xcbiAgICBpY29uPWljb258fCdodHRwczovL3ozLmF4MXguY29tLzIwMjEvMTEvMTYvSVdKaHhmLnBuZyc7XFxuICAgIGNvbnN0IHtnZXROb3dGb3JtYXREYXRlLGFwaSxnZXRBcGl9PSQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeT9ydWxlPemBk+mVv+S7k+W6k1Byb1xcXCIpO1xcbiAgICBTdHJpbmcucHJvdG90eXBlLnJlcGxhY2VBbGwgPSBmdW5jdGlvbihvbGQsbmV3X3N0cil7XFxuICAgICAgICByZXR1cm4gdGhpcy5zcGxpdChvbGQpLmpvaW4obmV3X3N0cik7XFxuICAgIH07XFxuICAgIGxldCBtdWJhbiA9IGdldEFwaSgnaW1wb3J0VXJsJykrXFxcIjE2OTBcXFwiO1xcbiAgICBsZXQgbXViYW5fd29yZD17bmFtZTpcXFwiQOi9u+WQiOmbhlxcXCIsdXJsOlxcXCJA5Zyw5Z2AXFxcIix2ZXI6XFxcIkDniYjmnKxcXFwiLGljb246XFxcIkDlm77moIdcXFwifTtcXG4gICAgbGV0IG11YmFuX2NvZGUgPSBmZXRjaChtdWJhbik7XFxuICAgIG11YmFuX2NvZGU9bXViYW5fY29kZS5yZXBsYWNlQWxsKG11YmFuX3dvcmQubmFtZSxuYW1lKS5yZXBsYWNlQWxsKG11YmFuX3dvcmQudmVyLGdldE5vd0Zvcm1hdERhdGUoKSkucmVwbGFjZUFsbChtdWJhbl93b3JkLnVybCx1cmwpLnJlcGxhY2VBbGwobXViYW5fd29yZC5pY29uLGljb24pO1xcbiAgICBsZXQgaW1wb3J0X2NvZGU9XFxcIua1t+mYlOinhueVjOinhOWImeWIhuS6q++8jOW9k+WJjeWIhuS6q+eahOaYr++8muWwj+eoi+W6j++8jOaXoOagueagke+8jOiKseato+a4he+8jOS4jeaWreiNpOiFpeS4jeaIkua3q++/pWhvbWVfcnVsZV92Mu+/pWJhc2U2NDovL0BcXFwiK25hbWUrXFxcIkBcXFwiK2Jhc2U2NEVuY29kZShtdWJhbl9jb2RlKTtcXG4gICAgdmFyIHBhc3RlcyA9IGdldFBhc3RlcygpO1xcbiAgICB2YXIgdXJsID0gc2hhcmVQYXN0ZShpbXBvcnRfY29kZSxwYXN0ZXMuc2xpY2UoLTEpWzBdKTtcXG4gICAgbGV0IGltcG9ydF9ydWxlPSB1cmwrXFxcIlxcXFxuXFxcXG7lsI/nqIvluo/vvJpcXFwiK25hbWU7XFxuICAgIHJldHVybiBpbXBvcnRfcnVsZTtcXG59XFxuJC5leHBvcnRzLmdlblJ1bGU9Z2VuUnVsZTtcIn0se1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuWFqOWxgOino+aekOWFjeWXhVwiLFwicGF0aFwiOlwiZ2xvYmFsUGFyc2VcIixcInJ1bGVcIjpcImpzOlxcbiAgICBmdW5jdGlvbiBnZXRIZWFkZXJzKHBsYXlVcmwpe1xcbiAgICAgICAgbGV0IGhlYWRlcnMgPSB7fTtcXG4gICAgICAgIGxldCByZWZlcj1wbGF5VXJsLnNwbGl0KFxcXCIvL1xcXCIpWzBdK1xcXCIvL1xcXCIrcGxheVVybC5zcGxpdChcXFwiLy9cXFwiKVsxXS5zcGxpdChcXFwiL1xcXCIpWzBdO1xcbiAgICAgICAgaWYoL2xlY2xvdWRcXFxcLmNvbXxiaWxpdmlkZW9cXFxcLmNvbS8udGVzdChwbGF5VXJsKSl7XFxuICAgICAgICAgICAgaGVhZGVycyA9IHtcXFwiUmVmZXJlclxcXCI6ICdodHRwczovL3d3dy5iaWxpYmlsaS5jb20vJyxcXFwiVXNlci1BZ2VudFxcXCI6XFxcIk1vemlsbGEvNS4wXFxcIn1cXG4gICAgICAgIH1lbHNlIGlmKC9tZ3R2XFxcXC5jb20vLnRlc3QocGxheVVybCkpe1xcbiAgICAgICAgICAgIGhlYWRlcnMgPSB7XFxcIlJlZmVyZXJcXFwiOiByZWZlcixcXFwiVXNlci1BZ2VudFxcXCI6XFxcIk1vemlsbGEvNS4wXFxcIn1cXG4gICAgICAgIH1lbHNlIGlmKC9peGlndWFcXFxcLmNvbS8udGVzdChwbGF5VXJsKSl7XFxuICAgICAgICAgICAgaGVhZGVycyA9IHtcXFwiUmVmZXJlclxcXCI6ICdodHRwczovL3d3dy5peGlndWEuY29tLycsXFxcIlVzZXItQWdlbnRcXFwiOlxcXCJNb3ppbGxhLzUuMFxcXCJ9XFxuICAgICAgICB9ZWxzZXtcXG4gICAgICAgICAgICAvLyBoZWFkZXJzID0ge1xcXCJSZWZlcmVyXFxcIjogcmVmZXIsJ1VzZXItQWdlbnQnOidEYXJ0LzIuMTMgKGRhcnQ6aW8pJ31cXG4gICAgICAgICAgICAvLyBoZWFkZXJzID0ge1xcXCJSZWZlcmVyXFxcIjogcmVmZXIsJ1VzZXItQWdlbnQnOk1PQklMRV9VQX07XFxuICAgICAgICAgICAgaGVhZGVycyA9IHsnVXNlci1BZ2VudCc6TU9CSUxFX1VBfTtcXG4gICAgICAgIH1cXG4gICAgICAgIHJldHVybiBoZWFkZXJzXFxuICAgIH1cXG5mdW5jdGlvbiBpc1BpYyhzdHIpe1xcbiAgICByZXR1cm4gL1xcXFwuKGdpZnxqcGd8anBlZ3xwbmd8R0lGfEpQR3xQTkcpJC8udGVzdChzdHIpO1xcbn1cXG5mdW5jdGlvbiBpc1ZpZGVvKHBsYXlVcmwscmVjaGFuZ2Upe1xcbiAgICAvL+azqOaEjy5waHDkuI3lj6/ku6XooqvmjpLpmaTlkKbliJnono3lhbTop6PmnpDkuI3kuoYgfC5waHAkXFxuICAgIC8v5aaC5p6c5piv5pKt5pS+5Zyw5Z2A5bCx55u05o6l6L+U5Zue5Zyw5Z2A5Yqg5LiKVUHvvIzkuI3mmK/nmoTor53lsLHov5Tlm55mYWxzZVxcbiAgICAvLyBsZXQgdDEgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcXG4gICAgbGV0IGNhY2hlUmVneCA9IG5ldyBSZWdFeHAoJ2ZpbGU6Ly8vc3RvcmFnZS9lbXVsYXRlZC8oLio/KVxcXFxcXFxcLm0zdTh8aGlrZXI6Ly9maWxlcy8oLio/KVxcXFxcXFxcLm0zdTgnKTtcXG4gICAgaWYoY2FjaGVSZWd4LnRlc3QocGxheVVybCkpe1xcbiAgICAgICAgcmV0dXJuIHBsYXlVcmxcXG4gICAgfVxcbiAgICBmdW5jdGlvbiBnZXRIb3N0KHVybCl7XFxuICAgICAgICAvLyBmYmHnmoRwYXJzZUxhennlpKrmhaLkuobljYPkuIfliKvnlKhcXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgcmV0dXJuIHVybC5tYXRjaCgvXmh0dHAocyk/OlxcXFwvXFxcXC8oLio/KVxcXFwvLylbMF0uc2xpY2UoMCwtMSk7XFxuICAgICAgICB9Y2F0Y2ggKGUpIHtcXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcXG4gICAgICAgIH1cXG4gICAgICAgIC8qXFxuICAgICAgICBpZih0eXBlb2YobG9nKT09PSd1bmRlZmluZWQnKXtcXG4gICAgICAgICAgICByZXR1cm4gIGZiYS5wYXJzZUxhenlSdWxlKCQkJCgpLmxhenlSdWxlKCh1cmwpPT57XFxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRIb21lKHVybClcXG4gICAgICAgICAgICB9LHVybCkpXFxuICAgICAgICB9ZWxzZSB7XFxuICAgICAgICAgICAgcmV0dXJuIGdldEhvbWUodXJsKVxcbiAgICAgICAgfVxcbiAgICAgICAgKi9cXG4gICAgfVxcbiAgICBsZXQgcFVybD1wbGF5VXJsLnNwbGl0KFxcXCI7XFxcIilbMF07Ly/ojrflj5bmiqDmjonmtbfpmJR1YeetieWPguaVsOeahOe9kemhteaSreaUvumTvuaOpVxcbiAgICBsZXQgaG9zdCA9IGdldEhvc3QocFVybCk7IC8vIOiOt+WPluWfn+WQjVxcbiAgICBpZighaG9zdCl7Ly/liKTmlq3ml6Dln5/lkI3nm7TmjqXkuI3mmK/op4bpopFcXG4gICAgICAgIHJldHVybiBmYWxzZVxcbiAgICB9XFxuICAgIGZ1bmN0aW9uIHByaW50KGRhdGEpe1xcbiAgICAgICAgaWYodHlwZW9mKGxvZyk9PT0ndW5kZWZpbmVkJyl7XFxuICAgICAgICAgICAgcmV0dXJuICBmYmEubG9nKGRhdGEpXFxuICAgICAgICB9ZWxzZSB7XFxuICAgICAgICAgICAgcmV0dXJuIGxvZyhkYXRhKVxcbiAgICAgICAgfVxcbiAgICB9XFxuICAgIHJlY2hhbmdlPXR5cGVvZihyZWNoYW5nZSk9PT1cXFwiZnVuY3Rpb25cXFwiP3JlY2hhbmdlOmZ1bmN0aW9uKHBsYXlVcmwpe3JldHVybiBwbGF5VXJsfTtcXG4gICAgbGV0IGV4Y2VwdFdvcmRzID0gJy5qcyR8LmNzcyR8LnRzJHwuaHRtbCR8Lmh0bSR8LmdpZiR8LmpwZyR8LmpwZWckfC5wbmckfC5pY28kfC5zdmckfC50eHQkJy5zcGxpdCgnfCcpLm1hcChpdD0+J1xcXFxcXFxcJytpdCkuam9pbignfCcpO1xcbiAgICB2YXIgZXhjZXB0S2V5cyA9IG5ldyBSZWdFeHAoZXhjZXB0V29yZHMpO1xcbiAgICBsZXQgZXhjZXB0V29yZHMxID0gJ3JlZmVyZXI9fHVybD0nLnNwbGl0KCd8JykubWFwKGl0PT5pdCkuam9pbignfCcpO1xcbiAgICB2YXIgZXhjZXB0S2V5czEgPSBuZXcgUmVnRXhwKGV4Y2VwdFdvcmRzMSk7XFxuICAgIGxldCByZXBsYWNlV29yZHMgPSAncGxheW0zdTh8bTN1OFxcXFwudHYnLnNwbGl0KCd8JykubWFwKGl0PT5pdCkuam9pbignfCcpO1xcbiAgICBsZXQgcmVwbGFjZUtleXMgPSBuZXcgUmVnRXhwKHJlcGxhY2VXb3JkcywnZycpO1xcbiAgICBsZXQgdmlkZW9Xb3JkcyA9IFxcXCIvdmlkZW8vdG9zfC5tcDQkfC5tM3U4JHwuZmx2JHwuYXZpJHwuM2dwJHwubXBlZyR8LndtdiR8Lm1vdiR8cm12YnwuZGF0JHwubXAzJHwubTRhJHxxcUJGZG93bmxvYWR8bWltZT12aWRlbyUyRnxtaW1lX3R5cGU9dmlkZW9ffHR5cGU9bTN1OHxwdD1tM3U4XFxcIi5zcGxpdCgnfCcpLm1hcCgoaXQpPT57XFxuICAgICAgICAvL3R5cGU9bXA0XFxuICAgICAgICBpZihpdC5zdGFydHNXaXRoKFxcXCIuXFxcIikpe1xcbiAgICAgICAgICAgIHJldHVybiAnXFxcXFxcXFwnK2l0XFxuICAgICAgICB9ZWxzZXtcXG4gICAgICAgICAgICByZXR1cm4gaXRcXG4gICAgICAgIH1cXG4gICAgfSkuam9pbihcXFwifFxcXCIpO1xcbiAgICBsZXQgdmlkZW9LZXlzID0gbmV3IFJlZ0V4cCh2aWRlb1dvcmRzKTtcXG4gICAgbGV0IHJVcmwgPSBwVXJsLnJlcGxhY2UoaG9zdCwnJyk7Ly/ojrflj5bpmaTlvIDln5/lkI3nmoTliankvZnpk77mjqVcXG4gICAgbGV0IHBVcmwyPXBVcmwuc3BsaXQoXFxcIiZcXFwiKVswXS5zcGxpdChcXFwiP1xcXCIpWzBdOy8v6I635Y+W5LiN5bim5Y+C5pWw55qE572R6aG16ZO+5o6lXFxuICAgIGxldCBydXJsMiA9IHBVcmwyLnJlcGxhY2UoaG9zdCwnJyk7Ly/ojrflj5bpmaTlvIDln5/lkI3nmoTliankvZnkuI3luKblj4LmlbDpk77mjqVcXG4gICAgbGV0IGhhc0tleSA9IHZpZGVvS2V5cy50ZXN0KHJVcmwpfHx2aWRlb0tleXMudGVzdChydXJsMik7XFxuICAgIGxldCBwYXJVcmwgPSBwVXJsLnJlcGxhY2UocFVybC5zcGxpdChcXFwiP1xcXCIpWzBdLCcnKTsgLy8g5YiG5Ymy6Zeu5Y+35ZCO5Ymp5L2Z5Y+C5pWw55qE5a6M5pW06ZO+5o6lXFxuICAgIGxldCBleGNLZXkgPSBleGNlcHRLZXlzMS50ZXN0KHBhclVybCk7XFxuICAgIGlmKHJVcmwuc3BsaXQoJz8nKS5sZW5ndGg+Mil7XFxuICAgICAgICBsZXQgclVybDM9clVybC5zcGxpdChcXFwiP1xcXCIpWzFdOy8v6I635Y+WP+WIhuWJsuWQjueahOesrOS4gOautVxcbiAgICAgICAgaGFzS2V5ID0gaGFzS2V5fHx2aWRlb0tleXMudGVzdChyVXJsMyk7XFxuICAgIH1cXG4gICAgaWYoaGFzS2V5JiYhZXhjS2V5KXtcXG4gICAgICAgIGxldCB0aXBzID0gJ+ajgOa1i+WIsOeWkeS8vOWkmuWqkuS9k+eahOWcsOWdgDonO1xcbiAgICAgICAgcHJpbnQoXFxcImpz5LitXFxcIit0aXBzK3BVcmwpO1xcbiAgICAgICAgcHJpbnQoXFxcIuWIhuWJsumXruWPt+WQjjpcXFwiK3BhclVybCk7XFxuICAgIH1cXG4gICAgLy8gbG9nKCcxOicrKHZpZGVvS2V5cy50ZXN0KHBVcmwpfHx2aWRlb0tleXMudGVzdChwVXJsMil8fHZpZGVvS2V5cy50ZXN0KHBVcmwucmVwbGFjZShyZXBsYWNlS2V5cyxcXFwiXFxcIikuc3BsaXQoXFxcIiZcXFwiKVswXS5zcGxpdChcXFwiP1xcXCIpWzBdKSkpO1xcbiAgICAvLyBsb2coJzI6JyshZXhjZXB0S2V5cy50ZXN0KHBVcmwuc3BsaXQoXFxcIj9cXFwiKVswXS5zcGxpdCgnJicpWzBdKSk7XFxuICAgIC8vIGxvZygnMzonKyFleGNlcHRLZXlzMS50ZXN0KHBVcmwucmVwbGFjZShwVXJsLnNwbGl0KFxcXCI/XFxcIilbMF0sJycpKSk7XFxuICAgIGlmICgoaGFzS2V5fHx2aWRlb0tleXMudGVzdChyVXJsLnJlcGxhY2UocmVwbGFjZUtleXMsXFxcIlxcXCIpLnNwbGl0KFxcXCImXFxcIilbMF0uc3BsaXQoXFxcIj9cXFwiKVswXSkgKSYmICFleGNlcHRLZXlzLnRlc3QocFVybDIpJiYhZXhjZXB0S2V5czEudGVzdChwVXJsMikpIHtcXG4gICAgICAgIGlmKCEoL1VzZXItQWdlbnR8UmVmZXJlckAvLnRlc3QocGxheVVybCkpKXtcXG4gICAgICAgICAgICBpZigvbGVjbG91ZFxcXFwuY29tfGJpbGl2aWRlby8udGVzdChwbGF5VXJsKSl7XFxuICAgICAgICAgICAgICAgIHBsYXlVcmwrPVxcXCI7e1JlZmVyZXJAaHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tLyYmVXNlci1BZ2VudEBNb3ppbGxhLzUuMH1cXFwiO1xcbiAgICAgICAgICAgIH1lbHNlIGlmKC9peGlndWFcXFxcLmNvbS8udGVzdChwbGF5VXJsKSl7XFxuICAgICAgICAgICAgICAgIHBsYXlVcmwrPVxcXCIjaXN2aWRlbz10cnVlIzt7UmVmZXJlckBodHRwczovL3d3dy5peGlndWEuY29tLyYmVXNlci1BZ2VudEBNb3ppbGxhLzUuMH1cXFwiO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBlbHNlIGlmKC9tZ3R2XFxcXC5jb218Ynl0ZWFtb25lLy50ZXN0KHBsYXlVcmwpKXtcXG4gICAgICAgICAgICAgICAgcGxheVVybCs9XFxcIjt7VXNlci1BZ2VudEBNb3ppbGxhLzUuMH1cXFwiO1xcbiAgICAgICAgICAgIH1lbHNlIGlmKC9wdHdvXFxcXC53a2ZpbGVcXFxcLmNvbS8udGVzdChwbGF5VXJsKSYmL3VybD0vLnRlc3QocGxheVVybCkpe1xcbiAgICAgICAgICAgICAgICBwbGF5VXJsPXBsYXlVcmwuc3BsaXQoXFxcInVybD1cXFwiKVsxXStcXFwiO3tSZWZlcmVyQGh0dHBzOi8vZmFudHVhbi50dn1cXFwiXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC8vIOWkhOeQhuWkp+W4iOWFhOS5i+exu+eahGFwcFxcbiAgICAgICAgICAgIC8vIGVsc2V7XFxuICAgICAgICAgICAgLy8gICAgIHBsYXlVcmwrPVxcXCI7e1VzZXItQWdlbnRATW96aWxsYS81LjB9XFxcIjtcXG4gICAgICAgICAgICAvLyB9XFxuICAgICAgICB9XFxuICAgICAgICBwbGF5VXJsPXJlY2hhbmdlKHBsYXlVcmwpO1xcbiAgICAgICAgaWYoIS8jaXNWaWRlbz10cnVlIy8udGVzdChwbGF5VXJsKSl7XFxuICAgICAgICAgICAgcGxheVVybCs9XFxcIiNpc1ZpZGVvPXRydWUjXFxcIjtcXG4gICAgICAgIH1cXG4gICAgICAgIC8vIGxldCB0MiA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xcbiAgICAgICAgLy8gcHJpbnQoJ+WIpOaWrWlzVmlkZW/ogJfml7Y6JysodDItdDEpKTtcXG4gICAgICAgIHJldHVybiBwbGF5VXJsO1xcbiAgICB9ZWxzZXtcXG4gICAgICAgIC8vIGxldCB0MiA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xcbiAgICAgICAgLy8gcHJpbnQoJ+WIpOaWrWlzVmlkZW/ogJfml7Y6JysodDItdDEpKTtcXG4gICAgICAgIHJldHVybiBmYWxzZTtcXG4gICAgfVxcbn1cXG5mdW5jdGlvbiBjb21QYXJzZShwYXJTdHIsZWosb25seWJhY2ssaHRtbCl7XFxuICAgIC8v5YiX6KGo77yM5qCH6aKY77yM5Zu+54mH77yM5o+P6L+w77yM6ZO+5o6l77yM5YaF5a65XFxuICAgIGVqID0gZWp8fGZhbHNlOy8v5pyJ5LqM57qnXFxuICAgIG9ubHliYWNrPW9ubHliYWNrfHxmYWxzZTsvL+WPqui/lOWbnuaVsOaNrlxcbiAgICBodG1sID0gaHRtbHx8Z2V0UmVzQ29kZSgpO1xcbiAgICBodG1sID0gdHlwZW9mKGh0bWwpPT09J3N0cmluZyc/aHRtbDpodG1sLmh0bWw7XFxuICAgIHJldHVybiAkLnRvU3RyaW5nKChwYXJTdHIsZWosb25seWJhY2ssaHRtbCxpc1BpYyk9PntcXG4gICAgICAgIGxldCB0PXBhclN0ci5zcGxpdChcXFwiO1xcXCIpO1xcbiAgICAgICAgbGV0IGQ9W107XFxuICAgICAgICAvLyBsZXQgbGlzdD1wZGZhKGdldFJlc0NvZGUoKSx0WzBdKTtcXG4gICAgICAgIGxldCBsaXN0PXBkZmEoaHRtbCx0WzBdKTtcXG4gICAgICAgIGxldCBsYXp5ID0gJCgnJykubGF6eVJ1bGUoKCk9PntcXG4gICAgICAgICAgICBjb25zdCB7bGF6eVBhcnNlfSA9ICQucmVxdWlyZSgnaGlrZXI6Ly9wYWdlL2dsb2JhbFBhcnNlP3J1bGU96YGT6ZW/5LuT5bqTUHJvJyk7XFxuICAgICAgICAgICAgcmV0dXJuIGxhenlQYXJzZShpbnB1dClcXG4gICAgICAgIH0pO1xcbiAgICAgICAgZm9yKGxldCBpIGluIGxpc3Qpe1xcbiAgICAgICAgICAgIGxldCBfcGljID0gdFsyXT9wZChsaXN0W2ldLHRbMl0pOicnO1xcbiAgICAgICAgICAgIGlmKGlzUGljKF9waWMpJiYhL0BSZWZlcmVyPS8udGVzdChfcGljKSl7XFxuICAgICAgICAgICAgICAgIF9waWMrPSdAUmVmZXJlcj0nXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGxldCBpdD17XFxuICAgICAgICAgICAgICAgIHRpdGxlOnBkZmgobGlzdFtpXSx0WzFdKSxcXG4gICAgICAgICAgICAgICAgcGljX3VybDpfcGljLFxcbiAgICAgICAgICAgICAgICBkZXNjOnBkZmgobGlzdFtpXSx0WzNdKSxcXG4gICAgICAgICAgICAgICAgdXJsOmVqP3BkKGxpc3RbaV0sdFs0XSk6cGQobGlzdFtpXSx0WzRdKStsYXp5XFxuICAgICAgICAgICAgfTtcXG4gICAgICAgICAgICBpZih0Lmxlbmd0aD41KXsvL+WGheWuue+8jOeUqOS6juaQnOe0olxcbiAgICAgICAgICAgICAgICBpdC5jb250ZW50PXBkZmgobGlzdFtpXSx0WzVdKVxcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBkLnB1c2goaXQpO1xcbiAgICAgICAgfVxcbiAgICAgICAgaWYob25seWJhY2spe1xcbiAgICAgICAgICAgIHJldHVybiBkXFxuICAgICAgICB9ZWxzZXtcXG4gICAgICAgICAgICBzZXRSZXN1bHQoZClcXG4gICAgICAgIH1cXG4gICAgfSxwYXJTdHIsZWosb25seWJhY2ssaHRtbCxpc1BpYylcXG59XFxuXFxuZnVuY3Rpb24gaXNCYWRWaWRlbyh2aWRlb1VybCkgey8v5piv5Z2P55qE6KeG6aKRXFxuICAgIGxldCBkbVBhdGggPSAnaGlrZXI6Ly9maWxlcy9jYWNoZS9kaWFvbWFvLnR4dCc7Ly/lkIrmr5vmqKHlvI/ov4fmu6Tmlofku7bot6/lvoRcXG4gICAgbGV0IGRtVXJscztcXG4gICAgdHJ5IHtcXG4gICAgICAgIGRtVXJscyA9IHJlcXVlc3QoZG1QYXRoKS50cmltKCkuc3BsaXQoJ1xcXFxuJykuZmlsdGVyKGl0ID0+IGl0ICYmICFpdC5zdGFydHNXaXRoKCcvLycpKTtcXG4gICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgZG1VcmxzID0gW107XFxuICAgIH1cXG5cXG4gICAgZnVuY3Rpb24gaGFzRG0odmlkZW9VcmwsIGRtVXJscykgey8v5pKt5pS+5Zyw5Z2A5piv5ZCm5Li65ZCK5q+b6KeG6aKRXFxuICAgICAgICBpZiAoZG1VcmxzLmxlbmd0aCA8IDEpIHtcXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcXG4gICAgICAgIH1cXG4gICAgICAgIGZ1bmN0aW9uIHByaW50KHN0cil7XFxuICAgICAgICAgICAgaWYodHlwZW9mKGxvZykhPT0ndW5kZWZpbmVkJyl7XFxuICAgICAgICAgICAgICAgIGxvZyhzdHIpO1xcbiAgICAgICAgICAgIH1lbHNle1xcbiAgICAgICAgICAgICAgICBmYmEubG9nKHN0cik7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfVxcbiAgICAgICAgZm9yIChsZXQgZG1Vcmwgb2YgZG1VcmxzKSB7XFxuICAgICAgICAgICAgaWYgKChuZXcgUmVnRXhwKGRtVXJsKSkudGVzdCh2aWRlb1VybCkpIHsvL+aSreaUvuWcsOWdgOWMheWQq+WQiuavm+agh+W/l+eahOWcsOWdgFxcbiAgICAgICAgICAgICAgICBwcmludCgn5ZCK5q+b6KeG6aKRLOiHquWKqOi/h+a7pDonK3ZpZGVvVXJsKTtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9XFxuICAgICAgICBwcmludCgn6Z2e5ZCK5q+b6KeG6aKRLOWPr+aSreaUvjonK3ZpZGVvVXJsKTtcXG4gICAgICAgIHJldHVybiBmYWxzZVxcbiAgICB9XFxuXFxuICAgIGZ1bmN0aW9uIGlzRG0ocmV0KSB7XFxuICAgICAgICBpZiAoIXJldCkge1xcbiAgICAgICAgICAgIHJldHVybiB0cnVlXFxuICAgICAgICB9XFxuICAgICAgICByZXR1cm4gaGFzRG0ocmV0LnNwbGl0KCcjJylbMF0uc3BsaXQoJzsnKVswXSwgZG1VcmxzKVxcbiAgICB9XFxuICAgIHJldHVybiBpc0RtKHZpZGVvVXJsKVxcbn1cXG5cXG5mdW5jdGlvbiBsYXp5UGFyc2UocGxheVVybCxtcyx0bSxyZWNoYW5nZSl7XFxuICAgIC8vIGxvZygn6LCD55So5LuT5bqT5YWN5ZeF5o6i5Lyg5Y+C6LaF5pe25Li6OicrbXMpO1xcbiAgICB0bSA9IHBhcnNlSW50KHRtKXx8NTAwMDtcXG4gICAgY29uc3Qge2lzVmlkZW8sZ2V0SGVhZGVycyxpc0JhZFZpZGVvfSA9ICQucmVxdWlyZSgnaGlrZXI6Ly9wYWdlL2dsb2JhbFBhcnNlP3J1bGU96YGT6ZW/5LuT5bqTUHJvJyk7XFxuICAgIGxldCByZWFsVXJsID0gaXNWaWRlbyhwbGF5VXJsLHJlY2hhbmdlKTtcXG4gICAgLy9sb2cocmVhbFVybCk7XFxuICAgIGlmKHR5cGVvZihyZWFsVXJsKT09J3N0cmluZycpey8vYm9vbOWAvOWwseaYr+Wksei0pVxcbiAgICAgICAgdHJ5e1xcbiAgICAgICAgICAgIGxldCBydXJsPXJlYWxVcmwuc3BsaXQoXFxcIjtcXFwiKVswXS5zcGxpdChcXFwiI1xcXCIpWzBdO1xcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHJlcXVlc3QocnVybCx7dGltZW91dDp0bX0pKS51cmxcXG4gICAgICAgIH1jYXRjaChlKXtcXG4gICAgICAgICAgICByZXR1cm4gcmVhbFVybFxcbiAgICAgICAgfVxcbiAgICAgICAgLy9yZXR1cm4gcmVhbFVybFxcbiAgICB9XFxuXFxuICAgIC8vbG9nKFxcXCLorr/pl67otoXml7Y6XFxcIit0bSk7XFxuICAgIGxvZyhcXFwi5bCd6K+V6YGT6ZW/5LuT5bqTeDXlhY3ll4U6XFxcIitwbGF5VXJsKTtcXG4gICAgY2xlYXJWYXIoXFxcIl94NWp4VXJsXFxcIik7XFxuICAgIGxldCBiYWQ9JChcXFwi572R57uc5LiN5L2z5oiW6ICF55aR5Ly85a+55pa5572R56uZ5oyC5LqG77yM5L2g6KaB5p+l55yL5YW2572R6aG15ZCX77yfXFxcIikuY29uZmlybSgocGxheVVybCk9PntcXG4gICAgICAgIGxvZyhcXFwi572R56uZ55yL6LW35p2l5oyC5LqGOlxcXCIrcGxheVVybCk7XFxuICAgICAgICByZXR1cm4gcGxheVVybFxcbiAgICB9LHBsYXlVcmwpO1xcbiAgICB0cnl7XFxuICAgICAgICB2YXIgYmFjaz1yZXF1ZXN0KHBsYXlVcmwse2hlYWRlcnM6IGdldEhlYWRlcnMocGxheVVybCksdGltZW91dDp0bX0pO1xcbiAgICAgICAgLy92YXIgYmFjaz1mZXRjaChwbGF5VXJsLHtoZWFkZXJzOiB7J1VzZXItQWdlbnQnOiBQQ19VQX19KTtcXG4gICAgICAgIGlmKCFiYWNrKXtcXG4gICAgICAgICAgICBsb2coXFxcIue9keermVxcXCIrcGxheVVybCtcXFwi56Gu5a6e5ZWl5Lmf5rKh6L+U5ZueXFxcIik7XFxuICAgICAgICAgICAgcmV0dXJuIGJhZFxcbiAgICAgICAgfWVsc2UgaWYoLyNFWFRJTkYvLnRlc3QoYmFjaykpe1xcbiAgICAgICAgICAgIC8vbGV0IGxjYWNoZT1cXFwiL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL2RhdGEvY29tLmV4YW1wbGUuaGlrZXJ2aWV3L2ZpbGVzL0RvY3VtZW50cy9jYWNoZS92aWRlby5tM3U4XFxcIjtcXG4gICAgICAgICAgICAvL3dyaXRlRmlsZShsY2FjaGUsYmFjayk7XFxuICAgICAgICAgICAgLy9yZXR1cm4gbGNhY2hlK1xcXCIjI1xcXCIrcGxheVVybCtcXFwiI2lzVmlkZW89dHJ1ZSNcXFwiXFxuICAgICAgICAgICAgcGxheVVybD1jYWNoZU0zdTgocGxheVVybCk7XFxuICAgICAgICAgICAgcmV0dXJuIHBsYXlVcmxcXG4gICAgICAgIH1lbHNlIGlmKCghL+inpuWPkeS6humYsuebl+mTvnzmnKrmjojmnYN85o6l5Y+j6Ziy55uXLy50ZXN0KGJhY2spKSYmKCEvaHR0cHx1cmwvLnRlc3QoYmFjaykpJiYoIS9tc2d8Y29kZXxodG1sLy50ZXN0KGJhY2spKSl7XFxuICAgICAgICAgICAgbG9nKGJhY2spO1xcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/nlpHkvLzlr7nmlrnmlbDmja7liqDlr4bkuobvvIzlhbfkvZPmlbDmja7nnIvml6Xlv5cnXFxuICAgICAgICB9XFxuICAgIH1jYXRjaChlKXtcXG4gICAgICAgIGxvZyhlLm1lc3NhZ2UpO1xcbiAgICAgICAgcmV0dXJuIGJhZFxcbiAgICB9XFxuICAgIHRyeSB7XFxuICAgICAgICBiYWNrPUpTT04ucGFyc2UoYmFjayk7XFxuICAgICAgICBsZXQgcmVhbFVybD1iYWNrLnVybDtcXG4gICAgICAgIGlmKHR5cGVvZihyZWFsVXJsKT09XFxcInVuZGVmaW5lZFxcXCJ8fCFyZWFsVXJsKXtcXG4gICAgICAgICAgICBsb2coYmFjayk7XFxuICAgICAgICAgICAgcmV0dXJuIFxcXCJ0b2FzdDovL+mBk+mVv+S7k+W6k+ino+aekOWksei0pe+8gei/lOWbnuaSreaUvuWcsOWdgOS4uuepulxcXCJcXG4gICAgICAgIH0gZWxzZSBpZih0eXBlb2YoaXNWaWRlbyhyZWFsVXJsLHJlY2hhbmdlKSk9PSdzdHJpbmcnKXtcXG4gICAgICAgICAgICByZXR1cm4gaXNWaWRlbyhyZWFsVXJsLHJlY2hhbmdlKTtcXG4gICAgICAgIH1lbHNle1xcbiAgICAgICAgICAgIHJldHVybiByZWFsVXJsK1xcXCIjaXNWaWRlbz10cnVlI1xcXCI7XFxuICAgICAgICB9XFxuICAgICAgICAvL2Vsc2V7XFxuICAgICAgICAvL3JlYWxVcmwrPVxcXCI7e1VzZXItQWdlbnRATW96aWxsYS81LjB9XFxcIjtcXG4gICAgICAgIC8vIH1cXG4gICAgfWNhdGNoIChlKSB7XFxuICAgICAgICBsb2coXFxcIuajgOa1i+WIsOino+aekOWPo+mdnmpzb27plJnor686XFxcIitlLm1lc3NhZ2UrJyzlvIDlp4t4NeWFjeWXheaOoicpO1xcbiAgICAgICAgLy8gcmVxdWlyZSgnaHR0cHM6Ly9oamRobnguY29kaW5nLm5ldC9wL2hpa2VyL2QvZHIvZ2l0L3Jhdy9tYXN0ZXIvanMvbHNnLmpzJyk7Ly/lvJXnlKjmnKzlnLDlgqjlrZjmj5Lku7ZcXG4gICAgICAgIGNvbnN0IGxzZz0kLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS9sb2NhbFN0b3JhZ2U/cnVsZT3pgZPplb/ku5PlupNQcm9cXFwiKTsvL+W8leeUqOWtkOmhtemdouacrOWcsOWCqOWtmOaPkuS7tlxcbiAgICAgICAgbGV0IGxvY2FsX21zID0gbHNnLmdldEl0ZW0oJ3RpbWVvdXQnKTtcXG4gICAgICAgIGxldCBtcyA9IHBhcnNlSW50KG1zKXx8cGFyc2VJbnQobG9jYWxfbXMpfHw1MDAwO1xcbiAgICAgICAgbGV0IG1heF9jb3VudD1NYXRoLmNlaWwobXMvMjUwKTtcXG4gICAgICAgIGxvZyhcXFwi5pys5qyh5ZeF5o6i6LaF5pe2OlxcXCIrbXMrXFxcIuWFseiuoeW+heaKk+WMhTpcXFwiK21heF9jb3VudCtcXFwi5qyhXFxcIik7XFxuICAgICAgICBzaG93TG9hZGluZygn5ZeF5o6i5Lit77yM6Iul5aSx6LSl5bCx5YiH5o2id2Vi5ZeF5o6iLi4uJyk7XFxuICAgICAgICBsZXQgX3g1ID0gJC50b1N0cmluZygoaXNWaWRlbyxyZWNoYW5nZSxwbGF5VXJsLG1heF9jb3VudCxQQ19VQSxpc0JhZFZpZGVvKT0+e1xcbiAgICAgICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgICAgIGlmKHR5cGVvZihmYmEpPT0ndW5kZWZpbmVkJ3x8IWZiYSl7XFxuICAgICAgICAgICAgICAgICAgICB2YXIgZmJhID0gZnlfYnJpZGdlX2FwcDtcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mKHJlcXVlc3QpPT0ndW5kZWZpbmVkJ3x8IXJlcXVlc3Qpe1xcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2YWwoZmJhLmdldEludGVybmFsSnMoKSk7XFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH1jYXRjaCAoZSkge1xcbiAgICAgICAgICAgICAgICAgICAgZmJhLmxvZyhlLm1lc3NhZ2UpO1xcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIGZiYS5wdXRWYXIoXFxcIl94NWp4VXJsXFxcIixwbGF5VXJsKTtcXG4gICAgICAgICAgICAgICAgaWYod2luZG93LmNvdW50ID09IG51bGwpe1xcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNvdW50PTE7XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgbGV0IHRleHQ9Jyc7XFxuICAgICAgICAgICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgICAgICAgICB0ZXh0PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXFxcImJvZHlcXFwiKS5pbm5lclRleHQ7XFxuICAgICAgICAgICAgICAgIH1jYXRjaCAoZSkge2ZiYS5sb2coZS5tZXNzYWdlKX1cXG4gICAgICAgICAgICAgICAgaWYoL+inpuWPkeS6humYsuebl+mTvnzmnKrmjojmnYN85o6l5Y+j6Ziy55uXLy50ZXN0KHRleHQpJiZ3aW5kb3cuY291bnQ9PT0xKXtcXG4gICAgICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcIuajgOa1i+WIsOacieaOiOadg++8jOW8gOWni+i/h+aOiOadg1xcXCIpO1xcbiAgICAgICAgICAgICAgICAgICAgLy9sb2NhdGlvbi5yZWxvYWQoKTtcXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWY9ZmJhLmdldFZhcihcXFwiX3g1anhVcmxcXFwiKTtcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB3aW5kb3cuY291bnQrKztcXG4gICAgICAgICAgICAgICAgLy8gZmJhLmxvZygnY291bnQ6Jyt3aW5kb3cuY291bnQrJyxtYXhfY291bnQ6JyttYXhfY291bnQpO1xcbiAgICAgICAgICAgICAgICBpZiggd2luZG93LmNvdW50ID49IG1heF9jb3VudCl7XFxuICAgICAgICAgICAgICAgICAgICBmYmEubG9nKFxcXCLotoXov4dcXFwiK21heF9jb3VudCoyNTArXFxcIuavq+enkuacquiOt+WPluWIsOi1hOa6kOWcsOWdgO+8jOi3s+WIsOa6kOe9kemhtSzku6XkuIvmmK/liqDovb3ov4fnmoTlnLDlnYBcXFwiKTtcXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRleHQ9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcXFwiYm9keVxcXCIpLmlubmVyVGV4dDtcXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmYmEubG9nKHRleHQpO1xcbiAgICAgICAgICAgICAgICAgICAgfWNhdGNoIChlKSB7ZmJhLmxvZyhlLm1lc3NhZ2UpfVxcbiAgICAgICAgICAgICAgICAgICAgZmJhLmxvZyhKU09OLnN0cmluZ2lmeShfZ2V0VXJscygpKSk7XFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmJhLmdldFZhcihcXFwiX3g1anhVcmxcXFwiKTtcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBtdXRlTWUoZWxlbSkge1xcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtLnBhdXNlKCk7XFxuICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xcbiAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIHZhciB2aWRlb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxcXCJ2aWRlb1xcXCIpLCBhdWRpb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxcXCJhdWRpb1xcXCIpLCB2MiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXFxcImVtYmVkXFxcIiksIHYzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcXFwiI3BsYXllclxcXCIpO1xcbiAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKHZpZGVvcywgZnVuY3Rpb24gKHZpZGVvKSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgbXV0ZU1lKHZpZGVvKTtcXG4gICAgICAgICAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxcbiAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKGF1ZGlvcywgZnVuY3Rpb24gKGF1ZGlvKSB7XFxuICAgICAgICAgICAgICAgICAgICAgICAgbXV0ZU1lKGF1ZGlvKTtcXG4gICAgICAgICAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxcbiAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKHYyLCBmdW5jdGlvbiAodikge1xcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGVNZSh2KTtcXG4gICAgICAgICAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxcbiAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKHYzLCBmdW5jdGlvbiAodikge1xcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGVNZSh2KTtcXG4gICAgICAgICAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxcbiAgICAgICAgICAgICAgICB2YXIgdXJscyA9IF9nZXRVcmxzKCk7XFxuICAgICAgICAgICAgICAgIC8vIGZiYS5sb2coSlNPTi5zdHJpbmdpZnkodXJscykpO1xcbiAgICAgICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpIGluIHVybHMpIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdT11cmxzW2ldO1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXt1PWRlY29kZVVSSUNvbXBvbmVudCh1KTt9Y2F0Y2goZSl7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU9dW5lc2NhcGUodSk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoL3VybD1odHRwLy50ZXN0KHUpKXtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdSA9IHUuc3BsaXQoXFxcInVybD1cXFwiKS5zbGljZSgtMSlbMF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZiYS5sb2coXFxcInVybOWIhuWJsjpcXFwiK3UpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKC91cmw9XFxcXC8vLnRlc3QodSkmJi9cXFxcLm0zdTgvLnRlc3QodSkpe1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaG9zdCA9IHUubWF0Y2goLyguKilcXFxcL1xcXFwvKC4qPylcXFxcLy8pWzBdO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ID0gaG9zdCt1LnNwbGl0KFxcXCJ1cmw9XFxcIikuc2xpY2UoLTEpWzBdO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYmEubG9nKFxcXCJ1cmzliIblibI6XFxcIit1KTtcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZigvdmlkPWh0dHAvLnRlc3QodSkpe1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ID0gdS5zcGxpdChcXFwidmlkPVxcXCIpLnNsaWNlKC0xKVswXTtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmJhLmxvZyhcXFwidmlk5YiG5YmyOlxcXCIrdSk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoL3ZpZD1cXFxcLy8udGVzdCh1KSYmL1xcXFwubTN1OC8udGVzdCh1KSl7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBob3N0ID0gdS5tYXRjaCgvKC4qKVxcXFwvXFxcXC8oLio/KVxcXFwvLylbMF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUgPSBob3N0K3Uuc3BsaXQoXFxcInZpZD1cXFwiKS5zbGljZSgtMSlbMF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcInZpZOWIhuWJsjpcXFwiK3UpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKC9cXFxcPyguKik9aHR0cC8udGVzdCh1KSYmL1xcXFwubTN1OC8udGVzdCh1KSl7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUgPSBcXFwiaHR0cFxcXCIrdS5zcGxpdCgvXFxcXD8oLiopPWh0dHAvKS5zbGljZSgtMSlbMF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcIuWFtuS7luWIhuWJsjpcXFwiK3UpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3xpbmRleFxcXFwubTN1OCRcXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKC9cXFxcLzFcXFxcLm0zdTgvLnRlc3QodSkpe1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICAgICAgdT11LnJlcGxhY2UoLyZmcm9tPS4qfCZuZXh0PS4qfCZqdW1wPS4qLywnJyk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlYWxVcmwgPSBpc1ZpZGVvKHUscmVjaGFuZ2UpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZihyZWFsVXJsKT09J3N0cmluZycmJiFpc0JhZFZpZGVvKHUpKXsvL+i/h+a7pOWQiuavm+inhumikVxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2Z5X2JyaWRnZV9hcHAuc2V0V2ViVWEoUENfVUEpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2YoZmJhLmdldEhlYWRlclVybCkhPT0ndW5kZWZpbmVkJyYmdHlwZW9mKHJlY2hhbmdlKSE9PSdmdW5jdGlvbicpe1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGV0IGJhY2tVcmwgPSBmYmEuZ2V0SGVhZGVyVXJsKHUucmVwbGFjZShcXFwiO3tcXFwiLFxcXCIjaXNWaWRlbz10cnVlIzt7XFxcIikpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJhY2tVcmwgPSBmYmEuZ2V0SGVhZGVyVXJsKHVybHNbaV0pLnJlcGxhY2UoJzt7JywnI2lnbm9yZUltZz10cnVlIyNpc1ZpZGVvPXRydWUjO3snKTtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1MSA9IGJhY2tVcmwuc3BsaXQoJyNpZ25vcmVJbWcnKVswXTtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1MiA9ICcjaWdub3JlSW1nJytiYWNrVXJsLnNwbGl0KCcjaWdub3JlSW1nJylbMV07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MSA9IHUxLnJlcGxhY2UoLyZmcm9tPS4qfCZuZXh0PS4qfCZqdW1wPS4qLywnJyk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigvdXJsPWh0dHAvLnRlc3QodTEpKXtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MSA9IHUxLnNwbGl0KFxcXCJ1cmw9XFxcIikuc2xpY2UoLTEpWzBdO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoL3VybD1cXFxcLy8udGVzdCh1MSkmJi9cXFxcLm0zdTgvLnRlc3QodTEpKXtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaG9zdDEgPSB1MS5tYXRjaCgvKC4qKVxcXFwvXFxcXC8oLio/KVxcXFwvLylbMF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEgPSBob3N0MSt1MS5zcGxpdChcXFwidXJsPVxcXCIpLnNsaWNlKC0xKVswXTtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYmEubG9nKFxcXCJ1cmzliIblibI6XFxcIit1KTtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoL3ZpZD1odHRwLy50ZXN0KHUxKSl7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEgPSB1MS5zcGxpdChcXFwidmlkPVxcXCIpLnNsaWNlKC0xKVswXTtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKC92aWQ9XFxcXC8vLnRlc3QodTEpJiYvXFxcXC5tM3U4Ly50ZXN0KHUxKSl7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGhvc3QxID0gdTEubWF0Y2goLyguKilcXFxcL1xcXFwvKC4qPylcXFxcLy8pWzBdO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUxID0gaG9zdDErdTEuc3BsaXQoXFxcInZpZD1cXFwiKS5zbGljZSgtMSlbMF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKC9cXFxcPyguKik9aHR0cC8udGVzdCh1MSkmJi9cXFxcLm0zdTgvLnRlc3QodTEpKXtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MSA9IFxcXCJodHRwXFxcIit1MS5zcGxpdCgvXFxcXD8oLiopPWh0dHAvKS5zbGljZSgtMSlbMF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrVXJsID0gdTEgKyB1MjtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZiYS5sb2coJ+i/lOWbnuiHquWKqOWKoGNvb2tpZemTvuaOpTonK2JhY2tVcmwpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmJhLmxvZygn6L+U5Zue6ZO+5o6lOicrdSsn5bm26Ieq5Yqo5Yqg5LqGY29va2llLOWFt+S9k2Nvb2tpZeWcqOinhumikeaSreaUvuWkhOafpeeciycpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJhY2tVcmw7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcIui/lOWbnuS7k+W6k3g15YWN5ZeF57uT5p6cOlxcXCIrcmVhbFVybCk7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhbFVybFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB9Y2F0Y2ggKGUpIHtcXG4gICAgICAgICAgICAgICAgICAgIGZiYS5sb2coZS5tZXNzYWdlKVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfWNhdGNoIChlKSB7XFxuICAgICAgICAgICAgICAgIC8vIGZ5X2JyaWRnZV9hcHAubG9nKCd4NeWkp+iMg+WbtOmUmeivrzonK2UubWVzc2FnZSk7XFxuICAgICAgICAgICAgICAgIGFsZXJ0KCd4NeWkp+iMg+WbtOmUmeivrzonK2UubWVzc2FnZSk7XFxuICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/miqXplJnnu5PmnZ94NSdcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9LGlzVmlkZW8scmVjaGFuZ2UscGxheVVybCxtYXhfY291bnQsUENfVUEsaXNCYWRWaWRlbyk7XFxuICAgICAgICBsZXQgdXNlV2ViPWxzZy5nZXRJdGVtKFxcXCLpgJrlhY1cXFwiLFxcXCJYNVxcXCIpPT09XFxcIldFQlxcXCI7XFxuICAgICAgICAvL2xvZyhcXFwi5LuT5bqT5L2/55Sod2Vi6YCa5YWN5pu/5LujeDU6XFxcIit1c2VXZWIpO1xcbiAgICAgICAgbGV0IHJ1bGVIZWFkPXVzZVdlYiYmcGFyc2VJbnQoZ2V0QXBwVmVyc2lvbigpKT49MjMzOT9cXFwid2ViUnVsZTovL1xcXCI6XFxcIng1UnVsZTovL1xcXCI7XFxuICAgICAgICBsZXQgeDVVcmwgPSBydWxlSGVhZCtwbGF5VXJsKyAnQCcgK194NTtcXG4gICAgICAgIHJldHVybiB4NVVybFxcbiAgICB9XFxufVxcblxcbmZ1bmN0aW9uIHg1UGFyc2VQcm8oeDVsaXN0LHg1VGltZW91dCxpc1ZpZGVvKXtcXG4gICAgbGV0IGJwYXRoID0gJ2ZpbGU6Ly8vc3RvcmFnZS9lbXVsYXRlZC8wL0FuZHJvaWQvZGF0YS9jb20uZXhhbXBsZS5oaWtlcnZpZXcvZmlsZXMvRG9jdW1lbnRzL3J1bGVzL2R6SG91c2UvaHRtbC/mtbfpmJTll4XmjqLlmaguaHRtbCc7XFxuICAgIGxldCBiY29kZSA9IGZldGNoKGJwYXRoKTtcXG4gICAgaWYoIWJjb2RlfHwhL2Z5X2JyaWRnZV9hcHAvLnRlc3QoYmNvZGUpKXtcXG4gICAgICAgIGxvZygn5pys5Zyw5pyq5a6J6KOF5ZeF5o6i5Zmo77yM5byA5aeL5a6J6KOFJyk7XFxuICAgICAgICBjb25zdCB7YXBpfSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeT9ydWxlPemBk+mVv+S7k+W6k1Byb1xcXCIpO1xcbiAgICAgICAgbGV0IGh0bWwgPSBmZXRjaChhcGkuaG9zdCsnL3J1bGVsaXN0Lmpzb24/aWQ9MjA1NScpO1xcbiAgICAgICAgaWYoL+a1t+mYlOinhueVjC8udGVzdChodG1sKSl7XFxuICAgICAgICAgICAgd3JpdGVGaWxlKGJwYXRoLGh0bWwpO1xcbiAgICAgICAgfWVsc2V7XFxuICAgICAgICAgICAgd3JpdGVGaWxlKGJwYXRoLGZldGNoKCdodHRwczovL2hqZGhueC5jb2RpbmcubmV0L3AvaGlrZXIvZC9kci9naXQvcmF3L21hc3Rlci9odG1sL2dldFZpZGVvLmh0bWwnKSlcXG4gICAgICAgIH1cXG4gICAgfVxcbiAgICB4NVRpbWVvdXQgPSBwYXJzZUludCh4NVRpbWVvdXQpfHw1MDAwO1xcbiAgICBsZXQgbWF4X2NvdW50PSh4NVRpbWVvdXQvMjUwKTsgLy/moLnmja7otoXml7boh6rliqjorqHnrpfkuoblj6/miafooYznmoTmrKHmlbBcXG4gICAgcHV0VmFyKCd4NUxpc3QnLEpTT04uc3RyaW5naWZ5KHg1bGlzdCkpO1xcbiAgICBsZXQgX3g1ID0gJC50b1N0cmluZygoaXNWaWRlbywgbWF4X2NvdW50LHg1VGltZW91dCxpc0JhZFZpZGVvKSA9PiB7XFxuICAgICAgICAvL+WIneWni+WMlmZiYeWSjHJlcXVzdFxcbiAgICAgICAgaWYgKHR5cGVvZiAoZmJhKSA9PSAndW5kZWZpbmVkJyB8fCAhZmJhKSB7XFxuICAgICAgICAgICAgdmFyIGZiYSA9IGZ5X2JyaWRnZV9hcHA7XFxuICAgICAgICB9XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKHJlcXVlc3QpID09ICd1bmRlZmluZWQnIHx8ICFyZXF1ZXN0KSB7XFxuICAgICAgICAgICAgICAgIGV2YWwoZmJhLmdldEludGVybmFsSnMoKSk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgICAgIGZiYS5sb2coZS5tZXNzYWdlKTtcXG4gICAgICAgIH1cXG4gICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tXFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIGlmICh3aW5kb3cuY291bnQgPT0gbnVsbCkge1xcbiAgICAgICAgICAgICAgICB3aW5kb3cuY291bnQgPSAxO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBsZXQgdGV4dD0nJztcXG4gICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICB0ZXh0PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXFxcImJvZHlcXFwiKS5pbm5lclRleHQ7XFxuICAgICAgICAgICAgfWNhdGNoIChlKSB7ZmJhLmxvZyhlLm1lc3NhZ2UpfVxcbiAgICAgICAgICAgIGlmKC/op6blj5HkuobpmLLnm5fpk7585pyq5o6I5p2DfOaOpeWPo+mYsuebly8udGVzdCh0ZXh0KSYmd2luZG93LmNvdW50PT0xKXtcXG4gICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XFxuICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcIuajgOa1i+WIsOacieaOiOadg++8jOW8gOWni+i/h+aOiOadg1xcXCIpO1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB3aW5kb3cuY291bnQrKztcXG4gICAgICAgICAgICAvLyBmYmEubG9nKCdjb3VudDonICsgd2luZG93LmNvdW50ICsgJyxtYXhfY291bnQ6JyArIG1heF9jb3VudCk7XFxuICAgICAgICAgICAgaWYgKHdpbmRvdy5jb3VudCA+PSBtYXhfY291bnQpIHtcXG4gICAgICAgICAgICAgICAgZmJhLmNsZWFyVmFyKCd4NUxpc3QnKTtcXG4gICAgICAgICAgICAgICAgZmJhLmhpZGVMb2FkaW5nKCk7XFxuICAgICAgICAgICAgICAgIGxldCBmbXNnID0gJ+mBk+mVv+S7k+W6k+mAmuWFjeino+aekOWksei0pSzljp/lm6A66LaF5pe2Jyt4NVRpbWVvdXQrJ+avq+enkic7XFxuICAgICAgICAgICAgICAgIGZiYS5sb2coZm1zZyk7XFxuICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly8nK2Ztc2c7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfWNhdGNoIChlKSB7XFxuICAgICAgICAgICAgZmJhLmxvZyhlLm1lc3NhZ2UpO1xcbiAgICAgICAgfVxcblxcbiAgICAgICAgZnVuY3Rpb24gbXV0ZU1lKGVsZW0pIHtcXG4gICAgICAgICAgICB0cnkge1xcbiAgICAgICAgICAgICAgICBlbGVtLnBhdXNlKCk7XFxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG5cXG4gICAgICAgIHZhciB2aWRlb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxcXCJ2aWRlb1xcXCIpLCBhdWRpb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxcXCJhdWRpb1xcXCIpLFxcbiAgICAgICAgICAgIHYyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcXFwiZW1iZWRcXFwiKSwgdjMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxcXCIjcGxheWVyXFxcIik7XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbCh2aWRlb3MsIGZ1bmN0aW9uICh2aWRlbykge1xcbiAgICAgICAgICAgICAgICBtdXRlTWUodmlkZW8pO1xcbiAgICAgICAgICAgIH0pO1xcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgfVxcbiAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICBbXS5mb3JFYWNoLmNhbGwoYXVkaW9zLCBmdW5jdGlvbiAoYXVkaW8pIHtcXG4gICAgICAgICAgICAgICAgbXV0ZU1lKGF1ZGlvKTtcXG4gICAgICAgICAgICB9KTtcXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcXG4gICAgICAgIH1cXG4gICAgICAgIHRyeSB7XFxuICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKHYyLCBmdW5jdGlvbiAodikge1xcbiAgICAgICAgICAgICAgICBtdXRlTWUodik7XFxuICAgICAgICAgICAgfSk7XFxuICAgICAgICB9IGNhdGNoIChlKSB7XFxuICAgICAgICB9XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbCh2MywgZnVuY3Rpb24gKHYpIHtcXG4gICAgICAgICAgICAgICAgbXV0ZU1lKHYpO1xcbiAgICAgICAgICAgIH0pO1xcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgfVxcbiAgICAgICAgdmFyIHVybHMgPSBfZ2V0VXJscygpO1xcbiAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICBmb3IgKGxldCBpIGluIHVybHMpIHtcXG4gICAgICAgICAgICAgICAgbGV0IHU9dXJsc1tpXTtcXG4gICAgICAgICAgICAgICAgLy91PWRlY29kZVVSSUNvbXBvbmVudCh1KTtcXG4gICAgICAgICAgICAgICAgdHJ5e3U9ZGVjb2RlVVJJQ29tcG9uZW50KHUpO31jYXRjaChlKXtcXG4gICAgICAgICAgICAgICAgICAgIHU9dW5lc2NhcGUodSk7XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgaWYoL3VybD1odHRwLy50ZXN0KHUpKXtcXG4gICAgICAgICAgICAgICAgICAgIHUgPSB1LnNwbGl0KFxcXCJ1cmw9XFxcIikuc2xpY2UoLTEpWzBdO1xcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZigvdmlkPWh0dHAvLnRlc3QodSkpe1xcbiAgICAgICAgICAgICAgICAgICAgdSA9IHUuc3BsaXQoXFxcInZpZD1cXFwiKS5zbGljZSgtMSlbMF07XFxuICAgICAgICAgICAgICAgIH1lbHNlIGlmKC9cXFxcPyguKik9aHR0cC8udGVzdCh1KSl7XFxuICAgICAgICAgICAgICAgICAgICB1ID0gXFxcImh0dHBcXFwiK3Uuc3BsaXQoL1xcXFw/KC4qKT1odHRwLykuc2xpY2UoLTEpWzBdO1xcbiAgICAgICAgICAgICAgICAgICAgLy9mYmEubG9nKFxcXCLlhbbku5bliIblibI6XFxcIit1KTtcXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYoL1xcXFwvMVxcXFwubTN1OCQvLnRlc3QodSkpe1xcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgdT11LnJlcGxhY2UoLyZmcm9tPS4qfCZuZXh0PS4qfCZqdW1wPS4qLywnJyk7XFxuICAgICAgICAgICAgICAgIGxldCByZWFsVXJsID0gaXNWaWRlbyh1KTtcXG4gICAgICAgICAgICAgICAgaWYgKHJlYWxVcmwmJiFpc0JhZFZpZGVvKHUpKSB7Ly/ov4fmu6TlkIrmr5tcXG4gICAgICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcIuS7k+W6k3g15YWN5ZeF57uT5p6cOlxcXCIgKyByZWFsVXJsKTtcXG4gICAgICAgICAgICAgICAgICAgIGZiYS5jbGVhclZhcigneDVMaXN0Jyk7XFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhbFVybFxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcbiAgICAgICAgICAgIGZiYS5sb2coZS5tZXNzYWdlKVxcbiAgICAgICAgfVxcbiAgICB9LCBpc1ZpZGVvLCBtYXhfY291bnQseDVUaW1lb3V0LGlzQmFkVmlkZW8pO1xcbiAgICBjb25zdCBsc2c9JC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvbG9jYWxTdG9yYWdlP3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcIik7XFxuICAgIGxldCB1c2VXZWI9bHNnLmdldEl0ZW0oXFxcIumAmuWFjVxcXCIsXFxcIlg1XFxcIik9PT1cXFwiV0VCXFxcIjtcXG4gICAgLy9sb2coXFxcIuS7k+W6k+S9v+eUqHdlYumAmuWFjeabv+S7o3g1OlxcXCIrdXNlV2ViKTtcXG4gICAgbGV0IHJ1bGVIZWFkPXVzZVdlYiYmcGFyc2VJbnQoZ2V0QXBwVmVyc2lvbigpKT49MjMzOT9cXFwid2ViUnVsZTovL1xcXCI6XFxcIng1UnVsZTovL1xcXCI7XFxuICAgIHJldHVybiBydWxlSGVhZCticGF0aCsnQCcgKyBfeDU7XFxufVxcblxcbmZ1bmN0aW9uIExhenlQYXJzZUZhc3QocGxheVVybExpc3QsZ2V0VGltZW91dCx4NVRpbWVvdXQpe1xcbiAgICBjb25zdCB7aXNWaWRlbyxnZXRIZWFkZXJzLHg1UGFyc2VQcm99ID0gJC5yZXF1aXJlKCdoaWtlcjovL3BhZ2UvZ2xvYmFsUGFyc2U/cnVsZT3pgZPplb/ku5PlupNQcm8nKTtcXG4gICAgLy8gbG9nKCflvIDlp4vmiafooYwnK3BsYXlVcmxMaXN0Lmxlbmd0aCsn5Liq5Zyw5Z2A55qE5om56YeP5ZeF5o6iOicrcGxheVVybExpc3QpO1xcbiAgICBsb2coJ+W8gOWni+aJp+ihjCcrcGxheVVybExpc3QubGVuZ3RoKyfkuKrlnLDlnYDnmoTmibnph4/ll4XmjqInKTtcXG4gICAgbGV0IHBsYXlVcmxzID0gcGxheVVybExpc3QubWFwKChpdCk9PntcXG4gICAgICAgIHJldHVybiB7XFxuICAgICAgICAgICAgdXJsOml0LnNwbGl0KFxcXCI7XFxcIilbMF0sXFxuICAgICAgICAgICAgb3B0aW9uczoge1xcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XFxuICAgICAgICAgICAgICAgICAgICAvL1xcXCJVc2VyLUFnZW50XFxcIjogXFxcIkRhcnQvMi4xMyAoZGFydDppbylcXFwiLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcIlVzZXItQWdlbnRcXFwiOlxcXCJNb3ppbGxhLzUuMFxcXCJcXG4gICAgICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICAgICAgdGltZW91dDogZ2V0VGltZW91dFxcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH1cXG4gICAgfSk7XFxuICAgIGxldCBiaHRtbCA9IGJhdGNoRmV0Y2gocGxheVVybHMpO1xcbiAgICBsZXQgdmlkZW9zID0gW107XFxuICAgIGxldCB4NWxpc3QgPSBbXTtcXG4gICAgZm9yKGxldCBpIGluIGJodG1sKXtcXG4gICAgICAgIGxldCBvcmRlciA9IHBhcnNlSW50KGkpKzE7XFxuICAgICAgICBsZXQgdG5hbWU9b3JkZXIrJ+WPt+ino+aekOe9keWdgDonO1xcbiAgICAgICAgLy9sb2codG5hbWUpO1xcbiAgICAgICAgbGV0IHR1cmw9cGxheVVybExpc3RbaV0uc3BsaXQoXFxcIjtcXFwiKVswXTtcXG4gICAgICAgIGxldCBqbmFtZT1wbGF5VXJsTGlzdFtpXS5zcGxpdChcXFwiO1xcXCIpLmxlbmd0aD4xP3BsYXlVcmxMaXN0W2ldLnNwbGl0KFxcXCI7XFxcIilbMV06XFxcIlxcXCI7XFxuICAgICAgICB0bmFtZSs9am5hbWU7XFxuICAgICAgICBsZXQgYmFja2NvZGUgPSBiaHRtbFtpXTtcXG4gICAgICAgIGlmKCghL3VybHxodHRwLy50ZXN0KGJhY2tjb2RlKSkmJighLyNFWFRJTkYvLnRlc3QoYmFja2NvZGUpKSl7XFxuICAgICAgICAgICAgbG9nKHRuYW1lK3R1cmwrJ+aciemXrumimCzlj6/og73liqDlr4bmiJbogIXmjILkuoYnKTtcXG4gICAgICAgICAgICBjb250aW51ZTtcXG4gICAgICAgIH1lbHNlIGlmKC8jRVhUSU5GLy50ZXN0KGJhY2tjb2RlKSl7XFxuICAgICAgICAgICAgLy9sZXQgbGNhY2hlPVxcXCIvc3RvcmFnZS9lbXVsYXRlZC8wL0FuZHJvaWQvZGF0YS9jb20uZXhhbXBsZS5oaWtlcnZpZXcvZmlsZXMvRG9jdW1lbnRzL2NhY2hlL3ZpZGVvX1xcXCIrdG5hbWUrXFxcIi5tM3U4XFxcIjtcXG4gICAgICAgICAgICAvL3dyaXRlRmlsZShsY2FjaGUsYmFja2NvZGUpO1xcbiAgICAgICAgICAgIC8vdmlkZW9zLnB1c2gobGNhY2hlKTtcXG4gICAgICAgICAgICBsZXQgcFVybD1jYWNoZU0zdTgodHVybCk7XFxuICAgICAgICAgICAgdmlkZW9zLnB1c2gocFVybCk7XFxuICAgICAgICAgICAgY29udGludWU7XFxuICAgICAgICB9XFxuICAgICAgICB0cnkge1xcbiAgICAgICAgICAgIGxldCB1cmwgPSBKU09OLnBhcnNlKGJhY2tjb2RlKS51cmw7XFxuICAgICAgICAgICAgaWYoL15odHRwLy50ZXN0KHVybCkpe1xcbiAgICAgICAgICAgICAgICBsZXQgcmVhbFZpZGVvID0gaXNWaWRlbyh1cmwpO1xcbiAgICAgICAgICAgICAgICBpZih0eXBlb2YocmVhbFZpZGVvKT09J3N0cmluZycpe1xcbiAgICAgICAgICAgICAgICAgICAgbG9nKHRuYW1lKyflt7Lop6PmnpDlh7rop4bpopE6JytyZWFsVmlkZW8pO1xcbiAgICAgICAgICAgICAgICAgICAgaWYoam5hbWUpe1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxWaWRlbys9XFxcIuKYhVxcXCIram5hbWVcXG4gICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgIHZpZGVvcy5wdXNoKHJlYWxWaWRlbyk7XFxuICAgICAgICAgICAgICAgIH1lbHNle1xcbiAgICAgICAgICAgICAgICAgICAgbG9nKHRuYW1lKyfop6PmnpDlh7rkuI3nn6XpgZPku4DkuYjkuJzopb86Jyt1cmwpO1xcbiAgICAgICAgICAgICAgICAgICAgdXJsKz1cXFwiI2lzVmlkZW89dHJ1ZSNcXFwiO1xcbiAgICAgICAgICAgICAgICAgICAgaWYoam5hbWUpe1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCs9XFxcIuKYhVxcXCIram5hbWVcXG4gICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgICAgIHZpZGVvcy5wdXNoKHVybCk7XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB9ZWxzZXtcXG4gICAgICAgICAgICAgICAgbG9nKHRuYW1lKyfkuLpqc29u5o6l5Y+j5LiU5peg6L+U5Zue6KeG6aKR5Zyw5Z2A5pWw5o2uOicrcGxheVVybExpc3RbaV0rJ1xcXFxuJytiYWNrY29kZSk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfWNhdGNoIChlKSB7XFxuICAgICAgICAgICAgbG9nKHRuYW1lKyfkuLp4NeaOpeWPoyzliqDlhaV4NeWXheaOouWIl+ihqCcpO1xcbiAgICAgICAgICAgIHg1bGlzdC5wdXNoKHBsYXlVcmxMaXN0W2ldKTtcXG4gICAgICAgIH1cXG4gICAgfVxcbiAgICAvLyBsb2codmlkZW9zKTtcXG4gICAgaWYodmlkZW9zLmxlbmd0aD4wKXtcXG4gICAgICAgIGlmKGdldFZhcignZHAuY2FjaGVWaWRlbycsJ3RydWUnKT09PSd0cnVlJyYmcGFyc2VJbnQoZ2V0QXBwVmVyc2lvbigpKT49MjI1NSlcXG4gICAgICAgIHtcXG4gICAgICAgICAgICBsb2coXFxcIuWwiuaVrOeahOmtlOaWreeUqOaIt++8jOinhumikee8k+WtmOW3suWQr+eUqO+8jOivt+WwveaDheS6q+WPl+eci+WJp+aXtuWFiVxcXCIpO1xcbiAgICAgICAgICAgIGxldCB2aWRlb3NDYWNoZT12aWRlb3MubWFwKChpdCk9PntcXG4gICAgICAgICAgICAgICAgbGV0IGhlYWRlcnM9e307XFxuICAgICAgICAgICAgICAgIGlmKGl0LnNwbGl0KFxcXCI7XFxcIikubGVuZ3RoPjEpe1xcbiAgICAgICAgICAgICAgICAgICAgbGV0IGhlYWQgPSBpdC5zcGxpdCgnOycpWzFdO1xcbiAgICAgICAgICAgICAgICAgICAgaWYoL0AvLnRlc3QoaGVhZCkmJi97fH0vLnRlc3QoaGVhZCkpe1xcbi8vaGVhZCA9IGhlYWQucmVwbGFjZSgve3x9L2csJycpO1xcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWQgPSBoZWFkLnNwbGl0KFxcXCJ7XFxcIilbMV0uc3BsaXQoXFxcIn1cXFwiKVswXTtcXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkID0gaGVhZC5zcGxpdCgnJiYnKTtcXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGkgaW4gaGVhZCl7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBrZXkgPSBoZWFkW2ldLnNwbGl0KCdAJylbMF07XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9aGVhZFtpXS5zcGxpdCgnQCcpWzFdLnJlcGxhY2UoLzsvLCfvvJvvvJsnKTtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1trZXldID0gdmFsdWU7XFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIHJldHVybiB7XFxuICAgICAgICAgICAgICAgICAgICB1cmw6aXQuc3BsaXQoXFxcIjtcXFwiKVswXS5zcGxpdChcXFwi4piFXFxcIilbMF0sXFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOntcXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOmhlYWRlcnNcXG4gICAgICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH0pO1xcbiAgICAgICAgICAgIHZhciBkYXRhPWJhdGNoQ2FjaGVNM3U4KHZpZGVvc0NhY2hlKTtcXG4gICAgICAgICAgICBkYXRhPWRhdGEubWFwKChpdCxpZCk9PntcXG4gICAgICAgICAgICAgICAgbGV0IGV4dHJhPVxcXCJcXFwiO1xcbiAgICAgICAgICAgICAgICBpZih2aWRlb3NbaWRdLnNwbGl0KFxcXCI7XFxcIikubGVuZ3RoPjEpe1xcbiAgICAgICAgICAgICAgICAgICAgZXh0cmE9XFxcIjtcXFwiK3ZpZGVvc1tpZF0uc3BsaXQoXFxcIjtcXFwiKVsxXTtcXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYodmlkZW9zW2lkXS5zcGxpdChcXFwi4piFXFxcIikubGVuZ3RoPjEpe1xcbiAgICAgICAgICAgICAgICAgICAgZXh0cmE9XFxcIuKYhVxcXCIrdmlkZW9zW2lkXS5zcGxpdChcXFwi4piFXFxcIilbMV07XFxuICAgICAgICAgICAgICAgIH1cXG5cXG4gICAgICAgICAgICAgICAgaWYoaXQrXFxcIlxcXCIhPVxcXCJudWxsXFxcIil7XFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXQrZXh0cmFcXG4gICAgICAgICAgICAgICAgfWVsc2V7XFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmlkZW9zW2lkXVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfSk7XFxuICAgICAgICAgICAgLy9sb2coZGF0YSk7XFxuICAgICAgICAgICAgcmV0dXJuIGRhdGFcXG4gICAgICAgICAgICAvL3JldHVybiB2aWRlb3NcXG4gICAgICAgIH1lbHNle1xcbiAgICAgICAgICAgIHJldHVybiB2aWRlb3NcXG4gICAgICAgIH1cXG4gICAgfVxcbiAgICBsb2coJ+WFseaciScreDVsaXN0Lmxlbmd0aCsn5LiqeDXlnLDlnYDov5vooYzova7mtYHll4XmjqInKTtcXG4gICAgLy/msqHmnInnmoTor53lsLHlvIDlp4vkvp3mrKF4NeWXheaOolxcbiAgICBzaG93TG9hZGluZygn5ZeF5o6i5Lit77yM6Iul5aSx6LSl5bCx5YiH5o2id2Vi5ZeF5o6iLi4uJyk7XFxuICAgIHJldHVybiB4NVBhcnNlUHJvKHg1bGlzdCx4NVRpbWVvdXQsaXNWaWRlbyk7XFxufVxcbnZhciBsYXp5PSQoJycpLmxhenlSdWxlKCgpPT57XFxuICAgIHRyeXtcXG4gICAgICAgIHJlYWxVcmw9aW5wdXQ7XFxuICAgICAgICBldmFsKFxcXCJ2YXIgY29uZmlnX2RwID1cXFwiICsgZmV0Y2goXFxcImhpa2VyOi8vZmlsZXMvY2FjaGUvTXlQYXJzZVNldC5qc29uXFxcIikpO1xcbiAgICAgICAgZXZhbChmZXRjaChjb25maWdfZHAuY2opKTtcXG4gICAgICAgIGxvZyhpbnB1dCsnLT7mraPlnKjmlq3mj5LprZTmlLnniYjop6PmnpAuLi4nKTtcXG4gICAgICAgIC8vIOWKoOWFpei2heaXtuiuvue9ru+8jOW7uuiuruWcqOmmlumhteiuvue9rlxcbiAgICAgICAgcmV0dXJuIGF5dG1QYXJzZShyZWFsVXJsKVxcbiAgICB9Y2F0Y2goZSl7XFxuICAgICAgICByZXR1cm4gaW5wdXRcXG4gICAgfVxcbn0pO1xcbiQuZXhwb3J0cy5pc1BpYz1pc1BpYztcXG4kLmV4cG9ydHMuaXNWaWRlbz1pc1ZpZGVvO1xcbiQuZXhwb3J0cy5pc0JhZFZpZGVvPWlzQmFkVmlkZW87XFxuJC5leHBvcnRzLmNvbVBhcnNlPWNvbVBhcnNlO1xcbiQuZXhwb3J0cy5nZXRIZWFkZXJzPWdldEhlYWRlcnM7XFxuJC5leHBvcnRzLmxhenlQYXJzZT1sYXp5UGFyc2U7XFxuJC5leHBvcnRzLng1UGFyc2VQcm89eDVQYXJzZVBybztcXG4kLmV4cG9ydHMuTGF6eVBhcnNlRmFzdD1MYXp5UGFyc2VGYXN0O1xcbiQuZXhwb3J0cy5sYXp5PWxhenk7XCJ9LHtcIm5hbWVcIjpcIuS7u+WKoeS7k+W6k+aOpeWPo1wiLFwicGF0aFwiOlwidGFza0NhbGxcIixcInJ1bGVcIjpcImpzOlxcblN0cmluZy5wcm90b3R5cGUuc3RyaXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLnJlcGxhY2UoLyheXFxcXHMqKXwoXFxcXHMqJCkvZywgXFxcIlxcXCIpOyB9O1xcbmZ1bmN0aW9uIHRhc2tfcmVxKHRhc2tfYXBpLHRhc2spIHsgLy8g6YCa55So5Y+R6YCB5LuT5bqTcG9zdOiwg+eUqOS7u+WKoeivt+axglxcbiAgICBjb25zdCB7Z2V0RmlsZX0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXk/cnVsZT3pgZPplb/ku5PlupNQcm9cXFwiKTtcXG4gICAgbGV0IGhvdXNlRmlsZSA9IGdldEZpbGV8fGZhbHNlO1xcbiAgICBpZighaG91c2VGaWxlKXtcXG4gICAgICAgIHNldEl0ZW0oJ2lzX2hvdXNlX3ZpcCcsICdmYWxzZScpO1xcbiAgICB9XFxuICAgIGxldCBob3VzZV9kYXRhID0gaG91c2VGaWxlKCk7XFxuICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KHRhc2tfYXBpLCB7XFxuICAgICAgICBoZWFkZXJzOiB7XFxuICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xcbiAgICAgICAgfSxcXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcXG4gICAgICAgICAgICBcXFwicGFyYW1zXFxcIjoge1xcbiAgICAgICAgICAgICAgICBcXFwiZGF0YVxcXCI6IHtcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJ0eXBlXFxcIjogdGFzay5tb2RlfHwncnVuJyxcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJmdW5jXFxcIjogdGFzay5mdW5jfHwnJyxcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJwYXJhbXNcXFwiOiB0YXNrLnBhcmFtc3x8W11cXG4gICAgICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICAgICAgXFxcImF1dGhcXFwiOiB7XFxuICAgICAgICAgICAgICAgICAgICBcXFwibmFtZVxcXCI6IGhvdXNlX2RhdGEudXNlcm5hbWV8fFxcXCJcXFwiLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcInBhc3N3b3JkXFxcIjogaG91c2VfZGF0YS5wYXNzd29yZHx8XFxcIlxcXCJcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0pLFxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCdcXG4gICAgfSk7XFxuICAgIHJldHVybiBKU09OLnBhcnNlKHJlc3VsdCkucmVzdWx0O1xcbn1cXG5cXG5mdW5jdGlvbiB0YXNrX3VwbG9hZCh0YXNrKXsgLy8g6YCa55So5Lu75Yqh5Y+R5biD5paw5aKe5Y+K5L+u5pS55Yqf6IO9XFxuICAgIGNvbnN0IHthcGksZ2V0RmlsZX0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXk/cnVsZT3pgZPplb/ku5PlupNQcm9cXFwiKTtcXG4gICAgbGV0IGhvdXNlRmlsZSA9IGdldEZpbGV8fGZhbHNlO1xcbiAgICBpZighaG91c2VGaWxlKXtcXG4gICAgICAgIHNldEl0ZW0oJ2lzX2hvdXNlX3ZpcCcsICdmYWxzZScpO1xcbiAgICB9XFxuICAgIGxldCBhcGlfdXJsID0gYXBpLmhvc3QrJy9oaWtlcnVsZS90YXNrL2FkZCc7XFxuICAgIGxldCBob3VzZV9kYXRhID0gaG91c2VGaWxlKCk7XFxuICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGFwaV91cmwsIHtcXG4gICAgICAgIGhlYWRlcnM6IHtcXG4gICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXFxuICAgICAgICB9LFxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xcbiAgICAgICAgICAgIFxcXCJwYXJhbXNcXFwiOiB7XFxuICAgICAgICAgICAgICAgIFxcXCJkYXRhXFxcIjoge1xcbiAgICAgICAgICAgICAgICAgICAgXFxcIm5hbWVcXFwiOiB0YXNrLm5hbWUsXFxuICAgICAgICAgICAgICAgICAgICBcXFwicHljb2RlXFxcIjogdGFzay5weWNvZGUsXFxuICAgICAgICAgICAgICAgICAgICBcXFwibm90ZVxcXCI6IHRhc2subm90ZSxcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJ0ZXN0X2NvZGVcXFwiOiB0YXNrLnRlc3RfY29kZSxcXG4gICAgICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICAgICAgXFxcImF1dGhcXFwiOiB7XFxuICAgICAgICAgICAgICAgICAgICBcXFwibmFtZVxcXCI6IGhvdXNlX2RhdGEudXNlcm5hbWV8fFxcXCJcXFwiLFxcbiAgICAgICAgICAgICAgICAgICAgXFxcInBhc3N3b3JkXFxcIjogaG91c2VfZGF0YS5wYXNzd29yZHx8XFxcIlxcXCJcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIH1cXG4gICAgICAgIH0pLFxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCdcXG4gICAgfSk7XFxuICAgIHJldHVybiBKU09OLnBhcnNlKHJlc3VsdCkucmVzdWx0O1xcbn1cXG5cXG5mdW5jdGlvbiB0YXNrX2NhbGwoaWQsZnVuYyxwYXJhbXMpe1xcbiAgICBjb25zdCB7YXBpfSA9ICQucmVxdWlyZShcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeT9ydWxlPemBk+mVv+S7k+W6k1Byb1xcXCIpO1xcbiAgICBsZXQgdGFza19hcGkgPSBhcGkuaG9zdCsnL2hpa2VydWxlL3Rhc2svcnVuLycraWQ7XFxuICAgIGxldCB0YXNrID0ge1xcbiAgICAgICAgbW9kZTonY2FsbCcsXFxuICAgICAgICBmdW5jOmZ1bmMsXFxuICAgICAgICBwYXJhbXM6cGFyYW1zfHxbXVxcbiAgICB9O1xcbiAgICByZXR1cm4gdGFza19yZXEodGFza19hcGksdGFzayk7XFxufVxcblxcbmZ1bmN0aW9uIHRhc2tfcmVuYW1lKGlkLG5ld190YXNrX25hbWUpe1xcbiAgICBjb25zdCB7YXBpLGdldEZpbGV9ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5P3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcIik7XFxuICAgIGxldCBob3VzZUZpbGUgPSBnZXRGaWxlfHxmYWxzZTtcXG4gICAgaWYoIWhvdXNlRmlsZSl7XFxuICAgICAgICBzZXRJdGVtKCdpc19ob3VzZV92aXAnLCAnZmFsc2UnKTtcXG4gICAgfVxcbiAgICBsZXQgaG91c2VfZGF0YSA9IGhvdXNlRmlsZSgpO1xcbiAgICBsZXQgdGFza19hcGkgPSBhcGkuaG9zdCsnL2hpa2VydWxlL3Rhc2svcmVuYW1lLycraWQ7XFxuICAgIHRhc2tfYXBpID0gdGFza19hcGkrJz9uYW1lPScraG91c2VfZGF0YS51c2VybmFtZSsnJnBhc3N3b3JkPScraG91c2VfZGF0YS5wYXNzd29yZCsnJnRhc2tfbmFtZT0nK25ld190YXNrX25hbWU7XFxuICAgIHRyeSB7XFxuICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZShmZXRjaCh0YXNrX2FwaSx7fSkpO1xcbiAgICAgICAgaWYocmVzdWx0LnN0YXR1cz09MCl7XFxuICAgICAgICAgICAgcmV0dXJuICByZXN1bHQuZGV0YWlsXFxuICAgICAgICB9ZWxzZXtcXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0LnJlc3VsdCsnJytyZXN1bHQuZGV0YWlsXFxuICAgICAgICB9XFxuICAgIH1jYXRjaCAoZSkge1xcbiAgICAgICAgbG9nKGUubWVzc2FnZSk7XFxuICAgICAgICByZXR1cm4gJycrZS5tZXNzYWdlXFxuICAgIH1cXG59XFxuXFxuZnVuY3Rpb24gdGFza19jaGFuZ2Vfc3RhdGUoaWQpe1xcbiAgICBjb25zdCB7YXBpLGdldEZpbGV9ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5P3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcIik7XFxuICAgIGxldCBob3VzZUZpbGUgPSBnZXRGaWxlfHxmYWxzZTtcXG4gICAgaWYoIWhvdXNlRmlsZSl7XFxuICAgICAgICBzZXRJdGVtKCdpc19ob3VzZV92aXAnLCAnZmFsc2UnKTtcXG4gICAgfVxcbiAgICBsZXQgaG91c2VfZGF0YSA9IGhvdXNlRmlsZSgpO1xcbiAgICBsZXQgdGFza19hcGkgPSBhcGkuaG9zdCsnL2hpa2VydWxlL3Rhc2svY2hhbmdlX3N0YXRlLycraWQ7XFxuICAgIHRhc2tfYXBpID0gdGFza19hcGkrJz9uYW1lPScraG91c2VfZGF0YS51c2VybmFtZSsnJnBhc3N3b3JkPScraG91c2VfZGF0YS5wYXNzd29yZDtcXG4gICAgdHJ5IHtcXG4gICAgICAgIGxldCByZXN1bHQgPSBKU09OLnBhcnNlKGZldGNoKHRhc2tfYXBpLHt9KSk7XFxuICAgICAgICBpZihyZXN1bHQuc3RhdHVzPT0wKXtcXG4gICAgICAgICAgICByZXR1cm4gIHJlc3VsdC5kZXRhaWxcXG4gICAgICAgIH1lbHNle1xcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQucmVzdWx0KycnK3Jlc3VsdC5kZXRhaWxcXG4gICAgICAgIH1cXG4gICAgfWNhdGNoIChlKSB7XFxuICAgICAgICBsb2coZS5tZXNzYWdlKTtcXG4gICAgICAgIHJldHVybiAnJytlLm1lc3NhZ2VcXG4gICAgfVxcbn1cXG5cXG5mdW5jdGlvbiB0YXNrX3J1bihpZCl7XFxuICAgIGNvbnN0IHthcGl9ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5P3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcIik7XFxuICAgIGxldCB0YXNrX2FwaSA9IGFwaS5ob3N0KycvaGlrZXJ1bGUvdGFzay9ydW4vJytpZDtcXG4gICAgbGV0IHRhc2sgPSB7fTtcXG4gICAgcmV0dXJuIHRhc2tfcmVxKHRhc2tfYXBpLHRhc2spO1xcbn1cXG5cXG4kLmV4cG9ydHMudGFza0NhbGwgPSB0YXNrX2NhbGw7XFxuJC5leHBvcnRzLnRhc2tSdW4gPSB0YXNrX3J1bjtcXG4kLmV4cG9ydHMudGFza1JlcSA9IHRhc2tfcmVxO1xcbiQuZXhwb3J0cy50YXNrVXBsb2FkID0gdGFza191cGxvYWQ7XFxuJC5leHBvcnRzLnRhc2tSZW5hbWUgPSB0YXNrX3JlbmFtZTtcXG4kLmV4cG9ydHMudGFza0NoYW5nZVN0YXRlID0gdGFza19jaGFuZ2Vfc3RhdGU7XCJ9LHtcImNvbF90eXBlXCI6XCJtb3ZpZV8zXCIsXCJuYW1lXCI6XCLlhajlsYDlgqjlrZhcIixcInBhdGhcIjpcImxvY2FsU3RvcmFnZVwiLFwicnVsZVwiOlwibGV0IGxvY2FsU3RvcmFnZSA9IChmdW5jdGlvbigpIHtcXG4gICAgZXZhbFByaXZhdGVKUyhcXFwiandVS3dOVGlQR2NXU0xDWEI1WHRBWHdiNkxRYlZ5SEQrMFhKN2wwN2NlMD1cXFwiKTtcXG4gICAgLy9wYXRodG89dW5kZWZpbmVkO1xcbiAgICBldmFsUHJpdmF0ZUpTKFxcXCI0QzBZeFJZbkdDWWtnRlJYdHBsL0N6NXpMNWhoNGpDQ3p0YituZytXb2t5bVE4b1VyelM5bEE4eXhDNWFGYWRuU0VteUhLTWJyYWZsUnFYQ25OUkhEbGs2dWU4eUhUTzE2bEJQcnB3Z3M1amYwUGhyQXRvVEpJRTBaSG45bUthUTRKZDJlcnFiNEk1NWJlV0lldWdLc0RzMjExU3pJTlE1eUpnU2gxZFZ1Tnp6eFJHSmc0MEZtVHVWbVhWZk4xeGcyV0lHSEJFbWtWbkd4bU9SaFBPTkErUTVWd1BtZHA0MS9oemUzZUlzVXZobzdWQ0JnSzRyYUptUGFsSVJCQlZsQ1ZnbjhGa1dtZktxWm8rVlcrb0JjSDdocmNyc1NsQ1NqQmFuZ1QvN3N5V0h4S1loZWhVMGthTVlqbldGZzFFbTBjbU5SdG9tQ3NIejFCOHEzMk9lUUhvYXdkV3h6S09hTUhPWERCalJvakE4RS9haDBXUk95emlxUlN4bC9tOGRoQmQwZjlwaFl6LzVTVS96SkQ1MlgvOUVDMTZXVlZkcFNXMzNha1JIUnNsUHBSbFRXRjkrQXlSbVJ3MGVaT0VzMW85UU1QQVFVZkF4Yll5RkhnenR3L08yZEpScEh5VG1pQmlhYXFUY2l2eDZ2OXp5dkJ6MDR3STFBYVNDdWkrZFR1VTNsdTV4ZEV0M0FqdDZaM2lEWE9WY0VQMEVERjc0NzRQUVU2SkVadXdlOTdTY2g0Ymkxd0IxWEhaU2ZJdGRsWVlvR2VkM0xMcGJtREFJUmNpdjByQW9wOFZtUWNUdDJLM0xmaDFSRFlZMFl0dlJjSDQ5T3ZwRFJIL3hhNUZjOE1ZM0RyRm9BN3Fjb0Y0ZUNnaVZCZkJnSlI2OCtMcFFLN3RPa2c4azllYyszTlN4SlRoY2w4ZDZ5Tnd4VDlUazE3emVKZ2Q2TW95WVpJcFdRTGxGNll2Yk9kRVdoam1uQTc4d0MwaFd6K1htNmhRTVNxdEZ3K2JoRmY3Y0JHVTNhYXRQRm1kQ1kyRWRYZmgwSVlXODV3ZE95TWZpd1c3L3ZWVHA5aUUwMEkzRjA5d0dIa0dLaFZiTHVlQWtZZTd6ekpYUjd0aGFGb3I2SDdxTG1KamJSUWs5ZXZOdEJRWE5SN0RpZmlYdVFmMmx0N25PSDgwU1dtMWZESEh6am1Qc05JcHMyVFhHVCtpd1ZWNjlnL3RXaXBWUTZEOEJUeCtjQ1FwNDdubVRJclkrcU40a2gyRlloNUxsd1hkZ0l5eTFWSXVDM3gwNTNld0FJSVVtbFk5bmlFcHFZdCsxZkZQWE9DdENHdFliU2QzN3ZWUjFFT2oyazVHdS8rOUpXZzJxdndsMXR3ZWxnMUowdHhhcklpNGtUYlRydnJuRkxOOTJwb2ZwWlFVZm9XbzRjZTdIV05kYnU0SktFcmFMUVVmZGZHRVBkMVRJdWZ1dVJWYTM5ZXE5R1p5U0R1Qkw2ME1QZGxkeEt3MXpvK2ZCNVpZK1lNajNMTDJnR3REYnM5OCtBc1JWOUxKV21VbXN4OTFobUp0RlVNV0QzeG5qOEhNWldzME5QbENGVXI5NDg1S3FUcG81a1J6R2ZGK2svTmwySnpydjVjdmtxdFVuTGdLcFhFT2ovc2Uvb0R6T0FyUUtJNVROVWJ2WXdjd2NkampNU2ZqSzY4S3J3aHMrbjZTbVdaNFpkZ1JIZ0FLNU1vRmkzWG1MVjQ3UDN2U1JXdTV6eUVzTWs0eTN1dUNGaXVSUFJsdTRRNXBKdnVPZW03SDdVTGlJaENlbXY1RGdrR3RETDFjR0w0RVFoWVJCNklTelZ2c2IyRWFQOXdRRTZEVlJuTTdPK3BuU3pldDZsenAzcEZkR25ib3gxTFJmQzYwdXRYWitDakltNGlFTW10YkIyTjV6RFNoR2JlTTNYVWJKUWRDQmlzOFhJcmhoMmJpQjVoQkNWd24zWTNldHQ3R0RQVnRvaTFHUmp6K0piZ00rWVI5MjhLYmRXUzV0RmFNTTNLajNYdjZvdEl4ek1CbkRDOXVXM2QrSVh4NnZMUEowSlJ1aDN5UDdwVGxhNmMzaVI0cDluV1lEcUorWlNtcHJIRm5ET3pzTFdtRmphcGplL01xd01KZDZUazNuQVd3aWNNT1B1WXBNeXFJRjA0Zmw0bXFndHNITFNNV1JSTkhQWmpFVFE5Z1JtZURZZTZhUnRsVzAycUwyb2xERU5xTFFNdEFkb2lyTldSY1A5VkwzVGQ4SGFVTzZmU2xHTmFiTWFrSkQvMDBYQ2hPU1VPSVArN2ZNN1YwL2wxYkxXUHRFejFpN0x5Z1RWN3BkR29EbnRxU0NFbkpyQnloQkF6TFJnNVFJYzk0MzhJaEtteWZuMC8zYXdvRDFJcjc4MGV5cC9YY0k2eE5jdzZUdi9FVGZIZzBlN2lZQzBVWWNKSUU1UVVYdjBzK1lvR0lFcTVHSXpLdWI4SE5qU1RVcHN2bmtWeCtkYmUyalJuM1liOVc3SkNaNVlTNkY1TXlVVnNwak1EN05ZYytEV2pVTDJiMnNWeUFmZVlwQzhVaGFoOXR1bWF2YkJ2N2EzYTlrZ0ZicTU4bHJIeHpZN2lKUVZpZ3pxM2UxYTJCU2IwUGNXMWFKOEJEN05rTnBoS1lheVR4eWtnd2lsRVJMOGpxcUJFbmlIVmRCeERKWUxiK1h3M2FsTG1sdHVURVY2S0d0Qm50QlgreXozNlJQRE15R0lLZSszZnpjeGZuQ0RuMjBNb2RWVmtWTm96UHFNWFowRzVMNGFMVEFRYWtZS1Vqc1ZNUWpBaFFrVGxIQmVPL2FMUHg5c3hsKytqMVo1ckxnRzEyVE40WEoxZWljdnc0QVZFNThMb3JhcTBRaUUwY1M3UEgxcGJyWldyZnQ3TFlHaXlCU2hvcjcrMGppb1VoMXBkV3EycU1ZTHFlTUVldUNST1F0NTdtRnJPanlQSDQ5cXA5N2NXT3JnZWcyV3lmV1NER1FQamU1K1AweVFvQ3BEL0QzUkFNdVdtYjl3bEJ0Y3EyajhXSlB0OTFFM2tLYXd1UUl5dmQycjJVang0K0hUTnRWS2I5a01MT084NUk2NWJOR0JIKzRpclN5NWdRWWxFMjZBMmNTR0ljTEtRUmx2Sm9NbmE3TC85d3lyeTRIek9yemtyQXZMZGdzU05sWWpwSFFFUmlPSTgwc0o1ak5DQ25mdzAxM0YrQStzQWZMbXlTL0JETE5RMXFhUTNwNmg4L0pxQWZoWDVPR0hnU2lSVk9DRWp1YURCL013Wk5DdTNRTDllaGhvQWo3dU9mOFBrcjNtSWpiaGg5SGlqc2p4MTkxKzBlMkpRckZhMDFBVkpLRVZ0dVB0SWMyaC8xcFBLTXZ5ZW54alRPMk94UG5qanQrODRuSUtLaHhESi9naFB0N2l2OFBtVEowbEtLeVBSc3NsOGYvUWRIZHh1cGI2alRzSTZVS216OVk0NlBNQnVENlAzd2g4cXAzNk82b2liTkRpUWQxc0UxMHZKaDl6MUZ5c0tJZThFcU1wbk5kRW1HMlRmRUJ4UnBtUXJoS0VxZWUwcDYrYTZzUW84Y1ZsUkprS1FBWUthd2NhTkVTNVhjNmRRWTVucWVpcThzVWl6ZjFzcGZIZUhlbER1MU02QlJYdUNqRmFmWGh6OGkzbFBXZ1lxVnBmeDEzaWdWQ1JmNDdVSDY1MnlMbnNtZXBDQldneUJUV0FjT3lGMVF4OFlHdFpub2IxVE4rNnhFd3pwY1dWeTdRTzlQOTJzS0E5U0srL05Ic3FmMTNDT3QwSkhDdFRWMU9sVFFXK0pBS3l4ZTFIbDcrczk1ejNLQ2dGS1FTKzNBczFKVjdOYStnK0xDUjJJZXZ1OGQ1RDBMN0d3b0RyZVV2NDM3NExSYUZrTnNIT3FXYlU5bmhRamRNVnI3YS9pOE8vNGhicHRhU3pxcWtnWUZpTkZVL29tVzVxd0l6N3NwNG5zY0lUUkUzZ3VhNmJ6a2xNWjhFQ24xaXFBV3QwYTZnZWtpNURhTDhxWWFwVENDaGpsV3NFeHFGdXhpV1AzNVRVQ2RkRWQ4QUNiTUdzK2dRRnlET296ZkJERzE3ZFpPMG1Dd1crUHpDTDJqYklDRE5haTUvam0xUXI2TUw1Nmp6VWFJRHowR0xQVFNhZXgxVUREd2tROW83bVhXQzBSN2pXbnpia0hSV2NvbVZiV21HcUwxcmpkb2Fjcy9SOXVqcVV1QkE2QTVWTC9xa1ExeEhMNDJFWG9vcHJDOHdycmZSNjh6TU1GeE93VTdDWUhKN2JoRy9RNHJOc1hEQmNNbzFBZGlxOUxYYlhtL1FKajB1L2pnWkdzc3owbm5LS1VGSmN4enVBTks5NnpXd2YxRFhhc1VjT29FdUVhdG0xcm1QNXdyQkptVy9ad1Q2YUJCaVIyT1NKMHhyOHRRNk9ibWRLanliKzFlRVhiMTQzN1IySWRoRFVkazVQUnp0SDJZRnQycG11TDQvTG1JTEZBdlBkaXlNdERITmorS2g0c1Y0TWxYYldQcnJJOTdZQk9GcEZsWCtnbmV3S0tmRlprSEU3ZGl0eTM0ZFVRMkduZTZzQUd4MXp4eWpadjVLQk0yNmxSSEY0NVhxRk5KMVJRM2hNeW1KSHN5WU5zTU80MUJXckd2MTlQQTQ2OGVjdzlIY1JOMHdoalVUZ25zOFpWYUM0aGlKc2dZMDdhQUVCSG05MC91aGhqTy9XbWI3d3VWYWRobDlSbkhlUWpweDRnd0NyTHo1aTVzNUl0MXNCd2ZEYjBGZStQQ3BMa2Mrd0lJTksyWTg2a1B0aFI2Z0p3Vzc1enVvTjVDMENBaUR3ZlU3M3ZhQVphaHpmNFZMTmxNMFUwNE90SFlCaTEzWWdQb05tR0hSZWxaVkV5Mkt1S1ZaZ2hEMTR2U2xZK0pyTUJEZG0yeTJ0aEZWK0JyaWhMNytmUTV3Y1lueEdlbGF3RHVvU1I1K2JERGtyNlJMNDBMNHh5ZkFoeGxyT24wdUEyOGdoR2VXZ3VhV0tFdjVuQnJydmV1MXVlVnkxTXZHVVlCWStJbEVyOE5kRE5SZG1Felh0MzlrR2xkODZ4T2ZBSC94TDFWbXVnYVhPR2FQQjJxYzdXRFJrVzZrNUY2bjNQa0l6ZFBYeU9OS3AxRGtPZzNvY1NNWk1UczZHS2o5QzN2T0RaNlpRcHdORFlMTVQrQ21FTDE4R1JqWE5jWmxQL0xuaGlBSXNjWVRMMStpSFdEWXZSbXZQTXd0T0hoQ25FWElVM0ZUYlArNlFSR0E2cXlkYm5uZXFWaFhvd2NMbWJNSXoxNklDMWt3aFpqNzUvTTUzc0tZWDJ6UmdPU1RBZk5TRC81bFpZU05VeEpmS1REZ2lhRkVnZ3JDcmQrM0NjK2NoenNsSTN6RFhFS1RydmxjWDJJbkM5dUgrZnN5cHlIdytBdlkyT21CR1FNSUljOGZFM3ROTzBnQlRWcVhzZHNFNzZZd0hyMjlkelFja3VzdXlKc0JmU1ZjbHJ2c05DWjFQUURMOEgzY1JzM0hFOW5Va3g1YmJKWVdzUHhiODI1Z25FcFdVOVo5S3R6dnNsaTcvaGVPbERLcEh4SmIxdUNyV3FmOGdSbldtcTN6ZlNTclVYQkhTTHU2Mk1ya1hUaldnYXBVVnhNR2tybnpSMEU0UE15MWJGY3lEcEVRZTE1VGF5V0JNMUI2anJJRyswRFJSOU9hQ1VQd0Q3ZXhObWpaYjlNODF1cytBSVJmeXpKUFpHbWZIdVQ5U056RmZOdVFkRlp5aVpWdGFZYW92V3VOMmlySTN6UWF0S0NEblFJWHByMFZoRzBHb3A4Yy96cm9XQm9OL2FWS21uOHNrU0Z2QURPam9aQWl4ZzZLMXk5d0ZpOHBlQ21pbUZaM1p6Q1ZzRzZFVTlTdmxicTUrd243RDZ5K2RBWWRhUG1zNGd3Q3JMejVpNXM1SXQxc0J3ZkRiejRYNFZ4cUlwY1RDOU5hWUtxQTdHS0srYVRyWldVd3dOMjFRT3RyOGVxeFNnSjFVOWVDT2NXWFFkK3AzNkd5NGZZK3Q5YzJDc1ZOYk5sMWdoeGE5Ykk4VTZlNkZUZC92dkJhcTlqcktkaXRxNG1OQ2Fpb2dtZlBLNk00OFVZSThqWk1DZGQvOUM4QnF2VWo0YllVNWJ5V0FTRUc2QkJHZEs4S2xmaS9hNExXdDNpdkM0dTlRQlRmYi92Q21OSmkvUUFmYWJjUEcrVXNXbXNZTlJLK2c4aE1jc3VCbWhoNDhOcGhSdmViVlFxcTZuY0t4YzFuRkhXTVc1TTZvZit6OGMxSGRkbmllRFA5R2FCc3EreXNsaktzbFlydDk4OVBZOXhzYm1rcjNYL29DZmlGVTROZmNPaGVlKytuZ1cwWHBaQVZ0MUkyUW5jMWFsd2Jub05xTU1oWElCOTVpa0x4U0ZxSDIyNlpxOXNHL3RyZHIyU0FWdXJueVdzZkhOanVJbEJXS0RPcmQ3VnJZRkp2UTl4YlZvbUtxUWp1aDlkemYybnZWckJ6YkVGMENaWTZpemtZL1JRWTVyOWs5My95Mk5HN28wN25NWWpPdFpZWWVOVW9pazdHYksvSHpRbDFTN3MvRkNobnQ5TTZmRTBVeXVQbXR0Tzk4aHF6eFFidGVNYWxNdFNjZTJXTGNqeVhWR2ZwcWRCa1l5bTRnWkJ5Y2NTNmFudHQ0b0xkbHVXU1NKc0hYMUljWGhReTZvSitBaGp3OWhGWXdYTEhQTG9DbzNqRWxpVUFLNDE3OXd0WXRIc08wYWJMeDQraG10TTVGejd3VVZhaEJBOXN1cE9UZi9GRDRzaVpNTW9mNVczdm01RGVkaHFHQU5saHQzbUk2Um1JaHY0OFFWdG5lTXNVellDNE5EaFpENE01UjZwN0dYQnFjcHUzRmFFRi8wSTBlM0xjZVgxSE4raURxS1JQdUd6dnBhYy8xdHNHUEl0ZUFEeHU5T1lvYXAyejNGMUN6U2cvVXVhOGwvS0V6dEFLRGN2YmhOVS9ZVWMybGhneGdmZGI0ZStQOVRaN1JhWDgyczYyN3UwQ2JGc2ZHRS8xaExwYjVNYzJ2azF1REdyZEljYldBNnhocFlBSFloRVlVbDljNzVZL1IvMGdsNnI5K202Y0kwQnZCWTVBYTVOQlJjNlVNdnNPL1BPdzVDY3I3OXNKemljZWFWM1l3cllFa2pwNktpK09Zckd1OTU0QUErZEo5V3N2TkdCRkdNcktBZlE5VlVDL0FUa0pmVGxvTWx0RGVWNUFvOXprYWF5M2RLQWE1L1B4QUdSREFVY1FMREY3dVZYYkQxdkZnRS8rUlhpd3pTNU43Y3IzYUZCZFJZN1hBbUZ6L2ZiMC9LU3BSOENRL2xva3BtTTJtbHRKOXZHUGdpcWI1blpsOUt1N2QyR2xnQWRpRVJoU1gxenZsajlIL1NCdWpCUG9PMWZwb091NUYzNWNkSGE1a1NGdkFET2pvWkFpeGc2SzF5OXdGbGowRXo1a3NVVzNXVTYzRTdlNHF0RFVDS1d3ampVNWYwRmQ1N1Z5VnpwQzZDZENTY0JqWVN6VDlyWkxWc2txNjFhT1dyRERVTktxQVEzK25YL0JCVzNjUVRFY09WZGMxNW5nVlhjU1MvYUsyUUZNZGlLUWxxbTE1ZkVySmR3cXllemE3aGZsS1RpQ3pVZHU1VkdsRlc5cUN0OHN5SG9vc0EyTnpmb3NKZFRkTjhiV0hub0RyNU4yNWV0K3AvbnZqak96WlJhTFlvWS9mci9rNWhxcHRPaz1cXFwiKTtcXG4gICAgcmV0dXJuICQuZXhwb3J0cztcXG59KSgpO1wifSx7XCJjb2xfdHlwZVwiOlwibW92aWVfM1wiLFwibmFtZVwiOlwi57yW6L6R5YWs5ZGKXCIsXCJwYXRoXCI6XCJkZXZJbmZvRWRpdFwiLFwicnVsZVwiOlwianM6XFxuYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAkLnRvU3RyaW5nKCgpPT57XFxuICAgIHB1dE15VmFyKFxcXCJkZXZJbmZvXFxcIiwnJyk7IC8v5riF6Zmk5Y6G5Y+y5YWs5ZGKXFxufSkpO1xcbnNldFBhZ2VUaXRsZSgn57yW6L6R5YWs5ZGKJyk7XFxuLy8gbGV0IHtub3dKeCxNeUppZXhpLGp4c1JvdXRlfSA9IE1ZX1BBUkFNUztcXG5jb25zdCB7Y29sb3Isc21hbGwsYXBpLCBnZXRGaWxlLGdldEFwaX0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFwiKTtcXG4vLyBsZXQgaG91c2VGaWxlID0gZ2V0RmlsZXx8ZmFsc2U7XFxudmFyIGRldl9pbmZvX3VybCA9IGdldEFwaSgnaW5mb0dldFVybCcpO1xcbi8vIGxvZyhkZXZfaW5mb191cmwpO1xcbnZhciBnZXRfaW5mbyA9IGZ1bmN0aW9uKHFxKXtcXG4gICAgcXEgPSBxcXx8JzQzNDg1NzAwNSc7XFxuICAgIGxldCBkZXZfaW5mb191cmwgPSBkZXZfaW5mb191cmwrcXE7XFxuICAgIGxldCBiYWNrX2NvZGUgPSBKU09OLnBhcnNlKHJlcXVlc3QoZGV2X2luZm9fdXJsKSk7XFxuICAgIGxldCBkZXZfaW5mbz1iYWNrX2NvZGUucmVzdWx0fHxiYWNrX2NvZGUuZGV0YWlsO1xcbiAgICByZXR1cm4gZGV2X2luZm87XFxufTtcXG52YXIgYmVmb3JlX3JlZnJlc2ggPSBmdW5jdGlvbigpe1xcbiAgICBsZXQgZGV2X3NldF9pbmZvID0gZ2V0TXlWYXIoXFxcImRldl9zZXRfaW5mb1xcXCIpLnNwbGl0KCckJCcpO1xcbiAgICBsZXQgZGV2X2luZm9fdXJsID0gZGV2X3NldF9pbmZvLnNsaWNlKC0xKVswXTtcXG4gICAgbGV0IGJhY2tfY29kZSA9IEpTT04ucGFyc2UocmVxdWVzdChkZXZfaW5mb191cmwpKTtcXG4gICAgbGV0IGRldl9pbmZvPWJhY2tfY29kZS5yZXN1bHR8fGJhY2tfY29kZS5kZXRhaWw7XFxuICAgIHB1dE15VmFyKFxcXCJkZXZJbmZvXFxcIixkZXZfaW5mbyk7XFxuICAgIHJldHVybiBkZXZfaW5mb1xcbn07XFxubGV0IGQgPSBbXTtcXG5kLnB1c2goe1xcbiAgICB0aXRsZTon57yW6L6R5YWs5ZGKJyxcXG4gICAgZGVzYzon5pSv5oyBbWTor63ms5Us54K55Ye76L+b5YWl5a2m5LmgTWTor63ms5VcXFxcbuS/neWtmOWFrOWRiuaMiemSruWcqOaWh+acrOahhuacgOS4i+mdoicsXFxuICAgIGNvbF90eXBlOid0ZXh0XzEnLFxcbiAgICB1cmw6J2h0dHBzOi8vd3d3LnJ1bm9vYi5jb20vbWFya2Rvd24vbWQtdHV0b3JpYWwuaHRtbCdcXG59KTtcXG5kLnB1c2goe1xcbiAgICB0aXRsZTon6L+U5ZueJyxcXG4gICAgY29sX3R5cGU6J3RleHRfMicsXFxuICAgIHVybDokKCcjbm9Mb2FkaW5nIycpLmxhenlSdWxlKCgpPT57XFxuICAgICAgICBiYWNrKGZhbHNlKTtcXG4gICAgICAgIHJldHVybiAnaGlrZXI6Ly9lbXB0eSdcXG4gICAgfSlcXG59KTtcXG5pZighZ2V0TXlWYXIoJ2RldkluZm8nKSl7XFxuICAgIGJlZm9yZV9yZWZyZXNoKCk7XFxufVxcbmxldCBlbXB0eSA9ICdoaWtlcjovL2VtcHR5JztcXG5kLnB1c2goe1xcbiAgICB0aXRsZTon6ZiF6KeI5p+l6ZiFJyxcXG4gICAgY29sX3R5cGU6J3RleHRfMicsXFxuICAgIC8vIHVybDokKGdldE15VmFyKCdkZXZJbmZvJykpLmNvbmZpcm0oKVxcbiAgICB1cmw6JChlbXB0eSkucnVsZSgoKT0+e1xcbiAgICAgICAgcmVxdWlyZShcXFwiaHR0cHM6Ly9naXRsYWIuY29tL2hqZGhueC9oaWtlci8tL3Jhdy9tYWluL2pzL21hcmtlZC5taW4uanNcXFwiKTtcXG4gICAgICAgbGV0IGRldkluZm89XFxcIlxcXCI7XFxuICAgICAgIHRyeXtcXG4gICAgICAgICAgZGV2SW5mbz1tYXJrZWQucGFyc2UoZ2V0TXlWYXIoJ2RldkluZm8nKSk7XFxuICAgICAgIH1jYXRjaChlKXt9XFxuICAgICAgICBzZXRSZXN1bHQoW1xcbiAgICAgICAgICAgIHtcXG4gICAgICAgICAgICAgICAgdGl0bGU6ZGV2SW5mbyxcXG4gICAgICAgICAgICAgICAgY29sX3R5cGU6J3JpY2hfdGV4dCcsXFxuICAgICAgICAgICAgfVxcbiAgICAgICAgXSk7XFxuICAgIH0pXFxufSk7XFxuZC5wdXNoKHtcXG4gICAgZGVzYzogXFxcIuW/q+adpee8lui+keS9oOeahOWFrOWRiuWQp35cXFwiLFxcbiAgICBjb2xfdHlwZTogJ2lucHV0JyxcXG4gICAgZXh0cmE6IHtcXG4gICAgICAgIHRpdGxlVmlzaWJsZTogZmFsc2UsXFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGdldE15VmFyKCdkZXZJbmZvJywgJycpfHxcXFwiXFxcIixcXG4gICAgICAgIHR5cGU6IFxcXCJ0ZXh0YXJlYVxcXCIsXFxuICAgICAgICBoZWlnaHQ6LTEsXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dE15VmFyKFxcXCJkZXZJbmZvXFxcIixpbnB1dCknXFxuICAgIH1cXG59KTtcXG5kLnB1c2goe1xcbiAgICB0aXRsZTpcXFwi5L+d5a2Y5YWs5ZGKXFxcIixcXG4gICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJyxcXG4gICAgdXJsOiQoJ+ehruiupOS/neWtmOWFrOWRiuWQl++8n+WwhuS8muS4jumBk+mVv+S7k+W6k+acjeWKoeWZqOmAmuiurycpLmNvbmZpcm0oKCk9PntcXG4gICAgICAgIGxldCBkZXZfc2V0X2luZm8gPSBnZXRNeVZhcihcXFwiZGV2X3NldF9pbmZvXFxcIikuc3BsaXQoJyQkJyk7XFxuICAgICAgICBsZXQgaW5wdXRfdGV4dCA9IGdldE15VmFyKCdkZXZJbmZvJywgJycpO1xcbiAgICAgICAgaWYoaW5wdXRfdGV4dC5sZW5ndGggPj0gNCl7XFxuICAgICAgICAgICAgbGV0IGluZm9fc2V0X3VybD0gZGV2X3NldF9pbmZvWzJdO1xcbiAgICAgICAgICAgIGxldCBzZW5kX2RhdGEgPSB7XFxcInBhcmFtc1xcXCI6XFxuICAgICAgICAgICAgICAgICAgICB7XFxcImRhdGFcXFwiOiB7XFxcImluZm9cXFwiOiBpbnB1dF90ZXh0fSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBcXFwibmFtZVxcXCI6IGRldl9zZXRfaW5mb1swXSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBcXFwicGFzc3dvcmRcXFwiOiBkZXZfc2V0X2luZm9bMV19XFxuICAgICAgICAgICAgfTtcXG4gICAgICAgICAgICAvLyBsb2coc2VuZF9kYXRhKTtcXG4gICAgICAgICAgICBsZXQgcGFyMiA9IHtoZWFkZXJzOnsnY29udGVudC10eXBlJzonYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04JywnVXNlci1BZ2VudCc6ZGV2X3NldF9pbmZvWzNdfSxib2R5OkpTT04uc3RyaW5naWZ5KHNlbmRfZGF0YSksbWV0aG9kOidQT1NUJ307XFxuICAgICAgICAgICAgLy8gcGFyMiA9IEpTT04uc3RyaW5naWZ5KHBhcjIpOyAvL3g16YeM6Z2i6K+35rGC5omN6ZyA6KaB57yW56CBXFxuICAgICAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICAgICAgbGV0IGJhY2tfcmV0ID0gcmVxdWVzdChpbmZvX3NldF91cmwsIHBhcjIpO1xcbiAgICAgICAgICAgICAgICBiYWNrX3JldCA9IEpTT04ucGFyc2UoYmFja19yZXQpLnJlc3VsdDtcXG4gICAgICAgICAgICAgICAgaWYoYmFja19yZXQuc3RhdHVzPT09MCl7XFxuICAgICAgICAgICAgICAgICAgICAvLyByZWZyZXNoUGFnZSgpO1xcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+S/neWtmOaIkOWKn1xcXFxuJytiYWNrX3JldC5kZXRhaWw7XFxuICAgICAgICAgICAgICAgIH1lbHNle1xcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+S/neWtmOWksei0pVxcXFxuJytiYWNrX3JldC5kZXRhaWw7XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB9Y2F0Y2ggKGUpIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+mUmeivr1xcXFxuJytlLm1lc3NhZ2U7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgfWVsc2V7XFxuICAgICAgICAgICAgY29uZmlybSh7dGl0bGU6J+mBk+mVv+aPkOekuicsY29udGVudDon6Jm954S25L2g5b6I5oeS77yM5L2G5piv5YWs5ZGK6Iez5bCR5YaZNOS4quWtl+WQp++8gSd9KTtcXG4gICAgICAgICAgICByZXR1cm4gJ2hpa2VyOi8vZW1wdHknXFxuICAgICAgICB9XFxuICAgIH0pXFxufSk7XFxuXFxuc2V0UmVzdWx0KGQpO1wifSx7XCJjb2xfdHlwZVwiOlwibW92aWVfM1wiLFwibmFtZVwiOlwi6aKE5aSE55CG5L6d6LWW5paH5Lu2XCIsXCJwYXRoXCI6XCJsaWJzXCIsXCJydWxlXCI6XCJpZihnZXRBcHBWZXJzaW9uKCk+PTMyMDApe1xcbiAgICB0cnl7XFxuICAgICAgICByYyhcXFwiaGlrZXI6Ly9maWxlcy9ydWxlcy9qcy8kaGlrZXIuanNcXFwiLCAtMSk7XFxuICAgICAgICAvLyQuc2V0Um9vdCgnaHR0cHM6Ly9oamRobnguY29kaW5nLm5ldC9wdWJsaWMvaGlrZXIvaGlrZXIvZ2l0L2ZpbGVzL21hc3Rlci9qcy8nKTtcXG4gICAgICAgICQuc2V0Um9vdCgpO1xcbiAgICAgICAgJC5zZXRMaWIoe1xcbiAgICAgICAgICAgIGxzZzogXFxcImxzZy5qc1xcXCIsIC8v5pys5Zyw5YKo5a2YXFxuICAgICAgICAgICAgZmlsZTogXFxcImZpbGUuanNcXFwiLCAvL+aWh+S7tm9zXFxuICAgICAgICAgICAgZmlsZVNlbGVjdDogXFxcImZpbGVTZWxlY3QuanNcXFwiLCAvL+aWh+S7tumAieaLqeWZqFxcbiAgICAgICAgICAgIGR0OiBcXFwiZHQuanNcXFwiLCAvL+WKqOaAgeWIhuexu1xcbiAgICAgICAgICAgIGRyOiBcXFwiZHIuanNcXFwiLCAvL2Ry5qih5p2/5L6d6LWWXFxuICAgICAgICAgICAgZHJwcmU6IFxcXCJkcnByZS5qc1xcXCIsIC8vZHLmqKHmnb/pooTlpITnkIZcXG4gICAgICAgICAgICBkcnVwOiBcXFwiZHJ1cC5qc1xcXCIsIC8vZHLmqKHmnb/oh6rliqjmm7TmlrBcXG4gICAgICAgICAgICBkcm1hdGNoOiBcXFwiZHJtYXRjaC5qc1xcXCIsIC8vZHLmqKHmnb/oh6rliqjmqKHmnb/ljLnphY1cXG4gICAgICAgICAgICBkcm06IFxcXCJkcm0uanNcXFwiLCAvL2Ry5qih5p2/5bCP56iL5bqPXFxuICAgICAgICAgICAgY21zOiBcXFwiY21zLmpzXFxcIiwgLy9jbXPmqKHmnb/kvp3otZZcXG4gICAgICAgICAgICBjbXNwcmU6IFxcXCJjbXNwcmUuanNcXFwiLCAvL2Ntc+mihOWkhOeQhlxcbiAgICAgICAgICAgIGNtc206IFxcXCJjbXNtLmpzXFxcIiwgLy9jbXPmqKHmnb/lsI/nqIvluo9cXG4gICAgICAgICAgICBsaWJjaGVjazogXFxcImxpYmNoZWNrLmpzXFxcIiwgLy9kcuajgOa1i+S+nei1llxcbiAgICAgICAgICAgIHJ1bGVFZGl0b3I6IFxcXCJydWxlRWRpdG9yLmpzXFxcIiwgLy/lhpnpobXmupDnpZ7lmajlsI/nqIvluo9cXG4gICAgICAgICAgICBob3VzZUxhenk6IFxcXCJob3VzZUxhenkuanNcXFwiLCAvL+S7k+W6k+mAmuWFjVxcbiAgICAgICAgICAgIGxhenk6IFxcXCJsYXp5LmpzXFxcIiwgLy/pppnlhY1cXG4gICAgICAgICAgICBzdWI6IFxcXCJzdWIuanNcXFwiLCAvL+mBk+W+t+e7j+iuoumYhVxcbiAgICAgICAgICAgIGhpa2VyVWk6IFxcXCJoaWtlclVpLmpzXFxcIiwgLy/mtbfpmJTnu4Tku7bkvp3otZZcXG4gICAgICAgICAgICBoaWtlckxpYnM6IFxcXCJoaWtlckxpYnMuanNcXFwiLCAvL+a1t+mYlOWFqOiDveS+nei1llxcbiAgICAgICAgfSk7XFxuICAgIH1jYXRjaChlKXtcXG4gICAgICAgIC8vdG9hc3QoJ+ivt+WwneivleeCueWHu+S7k+W6k+S4u+mhteeahOWNh+e6p+S7k+W6k+aXgei+ueeahOaMiemSruWNh+e6pyTmianlsZXvvIzlkKbliJnmn5Dkupvlip/og73kuI3og73mraPluLjkvb/nlKgnKTtcXG4gICAgICAgIGNvbmZpcm0oe1xcbiAgICAgICAgICAgIHRpdGxlOiAn5o+Q56S6LeeCueWHu+ehruWumuWPr+S7peWvvOWFpScsXFxuICAgICAgICAgICAgY29udGVudDogJ+ivt+WwneivleeCueWHu+S7k+W6k+S4u+mhteeahOWNh+e6p+S7k+W6k+aXgei+ueeahOaMiemSruWNh+e6pyTmianlsZXvvIzlkKbliJnmn5Dkupvlip/og73kuI3og73mraPluLjkvb/nlKgnLFxcbiAgICAgICAgICAgIGNvbmZpcm06ICQudG9TdHJpbmcoKCk9PntcXG4gICAgICAgICAgICAgICAgY29uc3Qge2dldEFwaX0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS91dGlsaXk/cnVsZT3pgZPplb/ku5PlupNQcm9cXFwiKTtcXG4gICAgICAgICAgICAgICAgbGV0IHJ1bGVIZWFkID0gJ+a1t+mYlOinhueVjO+8jOe9kemhteaPkuS7tu+/pWpzX3VybO+/pSRoaWtlckAnO1xcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gZ2V0QXBpKCdpbXBvcnRVcmwnKStcXFwiNTExMVxcXCI7XFxuICAgICAgICAgICAgICAgIGxldCBpbXBvcnRVcmwgPSAncnVsZTovLycrYmFzZTY0RW5jb2RlKHJ1bGVIZWFkK3VybCk7XFxuICAgICAgICAgICAgICAgIHJldHVybiBpbXBvcnRVcmxcXG4gICAgICAgICAgICB9KSxcXG4gICAgICAgICAgICBjYW5jZWw6ICQudG9TdHJpbmcoKCk9PntcXG5cXG4gICAgICAgICAgICB9KSxcXG4gICAgICAgIH0pXFxuICAgIH1cXG59XCJ9LHtcImNvbF90eXBlXCI6XCJtb3ZpZV8zXCIsXCJuYW1lXCI6XCJJbXBvcnTor6bnu4ZcIixcInBhdGhcIjpcInJ1bGVEZXRhaWxJbXBvcnRcIixcInJ1bGVcIjpcImpzOlxcbiQuZXhwb3J0cyA9IFxcXCJoaWtlcjovL3BhZ2UvcnVsZURldGFpbD9ydWxlPemBk+mVv+S7k+W6k1BybyZpZD1cXFwiICsgJC5pbXBvcnRQYXJhbTtcXG5cIn1dLFwicGFyYW1zXCI6XCJ7XFxcImF2YXRhclVybFxcXCI6XFxcImh0dHBzOi8vcGljLnFxdG4uY29tL3VwLzIwMTktOS8yMDE5MDkyODA4NTM0NTQyOTY1LmpwZ1xcXCIsXFxcImNhbl91cGxvYWRcXFwiOnRydWUsXFxcImlkXFxcIjoyNjYsXFxcInFxXFxcIjpcXFwiOTcyMDYzMTgzXFxcIn1cIixcInNhdmVkXCI6ZmFsc2UsXCJ0aXRsZVwiOlwi6YGT6ZW/5LuT5bqTUHJvXCIsXCJ2ZXJzaW9uXCI6MCxcInVybFwiOlwiaGlrZXI6Ly9wYWdlL3J1bGVzI25vSGlzdG9yeSNcIixcImNvbF90eXBlXCI6XCJpY29uXzJfcm91bmRcIixcImZpbmRfcnVsZVwiOlwianM6XFxuICAgIGFkZExpc3RlbmVyKCdvbkNsb3NlJywkLnRvU3RyaW5nKCgpPT57XFxuICAgICAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLmJhY2tcXFwiKTtcXG4gICAgICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UuZmlsdGVyXFxcIik7XFxuICAgICAgICBjbGVhclZhcihcXFwiV2FyZWhvdXNlLnR5cGVcXFwiKTtcXG4gICAgICAgIGlmKGdldFZhcignV2FyZWhvdXNlLmNhbl91cGxvYWQnLCcnKSl7XFxuICAgICAgICAgICAgbG9nKCfmk43kvZzov4fnpoHmraLkuIrkvKA6JytnZXRWYXIoJ1dhcmVob3VzZS5jYW5fdXBsb2FkJykpO1xcbiAgICAgICAgICAgIGNsZWFyVmFyKFxcXCJXYXJlaG91c2UuY2FuX3VwbG9hZFxcXCIpO1xcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKHRydWUpO1xcbiAgICAgICAgfVxcbiAgICB9KSk7XFxuXFxuaWYgKGdldFZhcihcXFwiV2FyZWhvdXNlLmJhY2tcXFwiKSA9PT0gXFxcIjFcXFwiKSB7XFxuICAgIGJhY2soZmFsc2UpO1xcbn1cXG5cXG5jb25zdCB7XFxuICAgIGdldEFwaSxcXG4gICAgYXBpLFxcbiAgICBjb2xvcixcXG4gICAgc21hbGwsXFxuICAgIGxvY2FsUnVsZVZlcixcXG4gICAgaHRtbFRhZyxcXG4gICAgbWRcXG59ID0gJC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcIik7XFxuY29uc3QgeyBub3JtYWxTb3J0IH0gPSAkLnJlcXVpcmUoXFxcImhpa2VyOi8vcGFnZS9zb3J0XFxcIik7XFxubGV0IHtcXG4gICAgYXZhdGFyVXJsLFxcbiAgICBxcSxcXG4gICAgaWQsXFxuICAgIGNhbl91cGxvYWRcXG59ID0gTVlfUEFSQU1TO1xcbmxldCBkYXRhVHlwZSA9IGdldFZhcihcXFwiV2FyZWhvdXNlLnR5cGVcXFwiLFxcXCJcXFwiKTtcXG5sZXQgYmFja0NvZGUgPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXCJydWxlc1VybFxcXCIpICsgXFxcIj9uYW1lPVxcXCIgKyBxcStcXFwiJmRhdGFfdHlwZT1cXFwiK2RhdGFUeXBlKSk7XFxubGV0IGRldk5hbWUgPSBiYWNrQ29kZS5kZXZfbmFtZTtcXG5wdXRWYXIoXFxcIldhcmVob3VzZS5maWx0ZXJcXFwiLCBkZXZOYW1lKTtcXG5sZXQgcnVsZUxpc3QgPSBiYWNrQ29kZS5yZXN1bHQ7XFxubGV0IHN1YlVybCA9IGdldEFwaShcXFwianNvbkxpc3RcXFwiKSArIFxcXCI/bmFtZT1cXFwiICsgcXE7XFxubGV0IGhhc1N1YiA9IGhhc0hvbWVTdWIoc3ViVXJsKTtcXG5sZXQgZGV2SW5mbyA9IFxcXCLov5nkuKrkurrlvojmh5Is5LuA5LmI6YO95rKh5YaZ5ZOmflxcXCI7XFxubGV0IHRtcEpzb24gPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXCJpbmZvR2V0VXJsXFxcIikgKyBxcSkpO1xcbmlmICh0bXBKc29uLnN0YXR1cyA9PSAwKSB7XFxuICAgIGRldkluZm8gPSB0bXBKc29uLnJlc3VsdCB8fCBkZXZJbmZvO1xcbn1cXG5sZXQgc3ViRmxhZyA9IGhhc1N1YiA/ICfwn4aXJyA6ICfwn5OhJztcXG5sZXQgZGF0YSA9IFtdO1xcbnJlcXVpcmUobWQpO1xcbmRldkluZm89bWFya2VkLnBhcnNlKGRldkluZm8pO1xcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwi4oCc4oCc4oCd4oCdXFxcIiArIGRldk5hbWUgKyBcXFwiXFxcXG5cXFxcblxcXCIgKyBzbWFsbChodG1sVGFnKFxcXCJ1XFxcIiwgXFxcIueCueWHu+afpeeci+WujOaVtOWFrOWRilxcXCIpKSxcXG4gICAgZGVzYzogc21hbGwoZGV2SW5mbyksXFxuICAgIHVybDogJ2hpa2VyOi8vcGFnZS9pbmZvJyxcXG4gICAgZXh0cmE6IHtcXG4gICAgICAgIHRleHQ6IGRldkluZm8sXFxuICAgICAgICBuYW1lOiBkZXZOYW1lLFxcbiAgICAgICAgdHlwZTpcXFwicmljaF90ZXh0XFxcIlxcbiAgICB9LFxcbiAgICBwaWNfdXJsOiBhdmF0YXJVcmwsXFxuICAgIGNvbF90eXBlOiAnbW92aWVfMV92ZXJ0aWNhbF9waWMnXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IFxcXCI8YmlnPuiuoumYheeuoeeQhjwvYmlnPiZuYnNwOyZuYnNwOzxzbWFsbD4o5b2T5YmNXFxcIiArIChoYXNTdWIgPyBcXFwi5bey6K6i6ZiFXFxcIiA6IFxcXCLmnKrorqLpmIVcXFwiKSArIFxcXCIpPC9zbWFsbD5cXFwiLFxcbiAgICBjb2xfdHlwZTogXFxcInJpY2hfdGV4dFxcXCJcXG59KTtcXG5cXG5sZXQgc3ViX2NvZGUgPSAn5rW36ZiU6KeG55WM5ZCI6ZuG6KeE5YiZ6K6i6ZiF77+laG9tZV9zdWLvv6UnICsgZGV2TmFtZSArIFxcXCLlkIjpm4ZAQFxcXCIgKyBzdWJVcmw7XFxubGV0IHJ1bGVzQ29kZSA9ICfmtbfpmJTop4bnlYzlkIjpm4bop4TliJnvv6Vob21lX3J1bGVfdXJs77+lJyArIHN1YlVybDtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogJ+KAnOKAnOKAneKAnTxzcGFuIHN0eWxlPVxcXCJjb2xvcjogI2ZmNzAwMFxcXCI+5LiA6ZSu6K6i6ZiFPC9zcGFuPicsXFxuICAgIGRlc2M6ICforqLpmIXigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFwiY29sb3I6ICM1Y2ZmMmNcXFwiPicgKyBkZXZOYW1lICsgJzwvc3Bhbj7nmoTmiYDmnInljZXop4TliJnvvIzlkIjpm4bpnIDljZXni6zorqLpmIUnLFxcbiAgICB1cmw6IHN1Yl9jb2RlLFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogJ+KAnOKAnOKAneKAnTxzcGFuIHN0eWxlPVxcXCJjb2xvcjogI2ZmNzAwMFxcXCI+5a+85YWl5YWo6YOoPC9zcGFuPicsXFxuICAgIHVybDogcnVsZXNDb2RlLFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcXG59KTtcXG5kYXRhLnB1c2goe1xcbiAgICB0aXRsZTogJ+KAnOKAnOKAneKAnTxzcGFuIHN0eWxlPVxcXCJjb2xvcjogI2ZmNzAwMFxcXCI+5a+85YWl6L275ZCI6ZuGPC9zcGFuPicsXFxuICAgIHVybDogJCgpLmxhenlSdWxlKChkZXZOYW1lLHN1YlVybCxhdmF0YXJVcmwpPT57XFxuICAgICAgICBjb25zdCB7Z2VuUnVsZX09JC5yZXF1aXJlKFxcXCJoaWtlcjovL3BhZ2UvZ2VuQXBpXFxcIik7XFxuICAgICAgICBsb2coXFxcIui9u+WQiOmbhuWbvuagh+mTvuaOpTpcXFwiK2F2YXRhclVybCk7XFxuICAgICAgICBsZXQgaW1wb3J0X3J1bGU9Z2VuUnVsZShcXFwi6L275ZCI6ZuGLlxcXCIrZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKTtcXG4gICAgICAgIC8vY29weShpbXBvcnRfcnVsZSk7XFxuICAgICAgICBsZXQgcnVsZUNvZGU9cGFyc2VQYXN0ZShpbXBvcnRfcnVsZS5zcGxpdChcXFwiXFxcXG5cXFwiKVswXSk7XFxuICAgICAgICAvL3JldHVybiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCJcXG4gICAgICAgIGltcG9ydFVybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShydWxlQ29kZSk7XFxuICAgICAgICByZXR1cm4gaW1wb3J0VXJsXFxuICAgIH0sZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzInXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6ICfigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFwiY29sb3I6ICNmZjcwMDBcXFwiPuWvvOWFpemBk+W+t+e7jzwvc3Bhbj4nLFxcbiAgICB1cmw6ICQoKS5sYXp5UnVsZSgoZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKT0+e1xcbiAgICAgICAgbGV0IHRpdGxlID0gXFxcIkgtXFxcIitkZXZOYW1lO1xcbiAgICAgICAgbGV0IHN1Yk9iaiA9IHtcXG4gICAgICAgICAgICB0aXRsZTogdGl0bGUsXFxuICAgICAgICAgICAgdXJsOiBzdWJVcmwsXFxuICAgICAgICAgICAgZGVzYzogXFxcImhpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9ydWxlQ2FjaGUvXFxcIit0aXRsZStcXFwiLmpzb25cXFwiLFxcbiAgICAgICAgICAgIGNvZGU6IFxcXCJcXFwiLFxcbiAgICAgICAgICAgIGFjdGl2ZTogZmFsc2UsLy/npoHnlKjlubblj5Hmm7TmlrBcXG4gICAgICAgIH1cXG4gICAgICAgIGxldCBzaGFyZVRleHQgPSBiYXNlNjRFbmNvZGUoSlNPTi5zdHJpbmdpZnkoc3ViT2JqKSk7XFxuICAgICAgICB2YXIgcGFzdGVzID0gZ2V0UGFzdGVzKCk7XFxuICAgICAgICB2YXIgdXJsID0gc2hhcmVQYXN0ZShzaGFyZVRleHQscGFzdGVzLnNsaWNlKC0xKVswXSk7XFxuICAgICAgICBsZXQgaW1wb3J0X3J1bGU9IFxcXCLovbvlkIjpm4borqLpmIXvvJpcXFwiK3RpdGxlKydcXFxcbicrdXJsO1xcbiAgICAgICAgY29weShpbXBvcnRfcnVsZSk7XFxuICAgICAgICBjb25zdCBwYXRoID0gJ2hpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9ydWxlQ2FjaGUvc3ViLmpzb24nO1xcbiAgICAgICAgJC5yYyhjb25maWcubGliLnN1Yik7XFxuICAgICAgICByZXR1cm4g6K6i6ZiF5a+85YWlKHBhdGgpXFxuICAgIH0sZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKSxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzInXFxufSk7XFxubGV0IGNhbl91cGxvYWRfYXBpID0gZ2V0QXBpKFxcXCJtYW5DYW5VcGxvYWRcXFwiKStpZDtcXG5pZihnZXRWYXIoJ2hvdXNlLmlzX21hbmFnZXInKSl7XFxuICAgIGxldCB0aXBzID0gY2FuX3VwbG9hZD8n6IO9Jzon5ZCmJztcXG4gICAgLy8gbG9nKCd0aXBzOicrdGlwcyk7XFxuICAgIC8vIGxvZygnY2FuX3VwbG9hZDonK2Nhbl91cGxvYWQpO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6J+KaoOiDveWQpuS4iuS8oDonKyhnZXRWYXIoJ1dhcmVob3VzZS5jYW5fdXBsb2FkJyl8fHRpcHMpLFxcbiAgICAgICAgY29sX3R5cGU6J3Njcm9sbF9idXR0b24nLFxcbiAgICAgICAgdXJsOidoaWtlcjovL2VtcHR5J1xcbiAgICB9KTtcXG4gICAgZnVuY3Rpb24gc2V0VXBsb2FkKGZsYWcsY2FuX3VwbG9hZF9hcGkpIHtcXG4gICAgICAgIGZsYWcgPSBmbGFnIHx8ICcnO1xcbiAgICAgICAgdHJ5IHtcXG4gICAgICAgICAgICBsZXQgY29kZSA9IGZldGNoKGNhbl91cGxvYWRfYXBpLCB7XFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcXFwiVXNlci1BZ2VudFxcXCI6IE1PQklMRV9VQX0sXFxuICAgICAgICAgICAgICAgIGJvZHk6IHtcXG4gICAgICAgICAgICAgICAgICAgIFxcXCJwYXJhbXNcXFwiOlxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcInVzZXJuYW1lXFxcIjogZ2V0VmFyKCdob3VzZS51c2VybmFtZScpLFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFwicGFzc3dvcmRcXFwiOiBnZXRWYXIoJ2hvdXNlLnBhc3N3b3JkJyksXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcXCJjYW5fdXBsb2FkXFxcIjogISFmbGFnXFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgfSk7XFxuICAgICAgICAgICAgY29kZSA9IEpTT04ucGFyc2UoY29kZSkucmVzdWx0O1xcbiAgICAgICAgICAgIGlmIChjb2RlLnN0YXR1cyA9PT0gMCkge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gY29kZS5kZXRhaWxcXG4gICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+aTjeS9nOWksei0pTonICsgY29kZS5kZXRhaWxcXG4gICAgICAgICAgICB9XFxuICAgICAgICB9IGNhdGNoIChlKSB7XFxuICAgICAgICAgICAgcmV0dXJuICfmk43kvZzlpLHotKU6JyArIGUubWVzc2FnZVxcbiAgICAgICAgfVxcbiAgICB9XFxuICAgIGRhdGEucHVzaCh7XFxuICAgICAgICB0aXRsZTon8J+aq+emgeatouS4iuS8oCcsXFxuICAgICAgICBjb2xfdHlwZTonc2Nyb2xsX2J1dHRvbicsXFxuICAgICAgICB1cmw6JCgn56aB5q2i6K+l5byA5Y+R6ICF5LiK5Lyg6KeE5YiZP+S9oOeahOaTjeS9nOWwhuiiq+ezu+e7n+iusOW9lScpLmNvbmZpcm0oKGlkLGNhbl91cGxvYWRfYXBpLHNldFVwbG9hZCk9PntcXG4gICAgICAgICAgICBsZXQgcmV0ID0gc2V0VXBsb2FkKGZhbHNlLGNhbl91cGxvYWRfYXBpKTtcXG4gICAgICAgICAgICBpZighL+aTjeS9nOWksei0pS8udGVzdChyZXQpKXtcXG4gICAgICAgICAgICAgICAgcHV0VmFyKCdXYXJlaG91c2UuY2FuX3VwbG9hZCcsJ+WQpicpO1xcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly8nK3JldFxcbiAgICAgICAgfSxpZCxjYW5fdXBsb2FkX2FwaSxzZXRVcGxvYWQpXFxuICAgIH0pO1xcbiAgICBkYXRhLnB1c2goe1xcbiAgICAgICAgdGl0bGU6J+KcheWFgeiuuOS4iuS8oCcsXFxuICAgICAgICBjb2xfdHlwZTonc2Nyb2xsX2J1dHRvbicsXFxuICAgICAgICB1cmw6JCgn5YWB6K646K+l5byA5Y+R6ICF5LiK5Lyg6KeE5YiZP+S9oOeahOaTjeS9nOWwhuiiq+ezu+e7n+iusOW9lScpLmNvbmZpcm0oKGlkLGNhbl91cGxvYWRfYXBpLHNldFVwbG9hZCk9PntcXG4gICAgICAgICAgICBsZXQgcmV0ID0gc2V0VXBsb2FkKHRydWUsY2FuX3VwbG9hZF9hcGkpO1xcbiAgICAgICAgICAgIGlmKCEv5pON5L2c5aSx6LSlLy50ZXN0KHJldCkpe1xcbiAgICAgICAgICAgICAgICBwdXRWYXIoJ1dhcmVob3VzZS5jYW5fdXBsb2FkJywn5pivJyk7XFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovLycrcmV0XFxuICAgICAgICB9LGlkLGNhbl91cGxvYWRfYXBpLHNldFVwbG9hZClcXG4gICAgfSk7XFxufVxcbmRhdGEucHVzaCh7XFxuICAgIHRpdGxlOiBcXFwiPHNtYWxsPuaPkOekuu+8muW8gOWPkeiAheWNleeLrOWIhuS6q+eahOWQiOmbhuaWh+S7tuWPquiDveWNleeLrOWvvOWFpeOAgjwvc21hbGw+XFxcIixcXG4gICAgY29sX3R5cGU6IFxcXCJyaWNoX3RleHRcXFwiXFxufSk7XFxuZGF0YS5wdXNoKHtcXG4gICAgdGl0bGU6IFxcXCI8YmlnPuinhOWImeWIl+ihqDwvYmlnPiZuYnNwOyZuYnNwOzxzbWFsbD4o5YWxXFxcIiArIHJ1bGVMaXN0Lmxlbmd0aCArIFxcXCLmnaEpPC9zbWFsbD5cXFwiLFxcbiAgICBjb2xfdHlwZTogXFxcInJpY2hfdGV4dFxcXCJcXG59KTtcXG5sZXQgZGF0YVR5cGVMaXN0ID0ge1xcbiAgICBcXFwiXFxcIjpcXFwi5YWo6YOoXFxcIixcXG4gICAgXFxcImhvbWVfcnVsZV91cmxcXFwiOiAn5bCP56iL5bqPJyxcXG4gICAgLy9cXFwicHVibGlzaFxcXCI6ICfmj5DkuqTkupHku5PlupPop4TliJknLFxcbiAgICBcXFwianNfdXJsXFxcIjogJ+e9kemhteaPkuS7ticsXFxuICAgIFxcXCJodG1sXFxcIjogJ+mdmeaAgemhtemdoicsXFxuICAgIFxcXCJjb25maWdcXFwiOiAn5Li76aKYJ1xcbn07XFxuZm9yKGxldCBrZXkgaW4gZGF0YVR5cGVMaXN0KXtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOmRhdGFUeXBlPT09a2V5P1xcXCLigJzigJxcXFwiK2RhdGFUeXBlTGlzdFtrZXldK1xcXCLigJ3igJ1cXFwiOmRhdGFUeXBlTGlzdFtrZXldLFxcbiAgICAgICAgdXJsOiQoXFxcIiNub0xvYWRpbmcjXFxcIikubGF6eVJ1bGUoKGtleSk9PntcXG4gICAgICAgICAgICBwdXRWYXIoXFxcIldhcmVob3VzZS50eXBlXFxcIixrZXkpO1xcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXG4gICAgICAgICAgICByZXR1cm4gXFxcImhpa2VyOi8vZW1wdHlcXFwiO1xcbiAgICAgICAgfSxrZXkpLFxcbiAgICAgICAgY29sX3R5cGU6XFxcInNjcm9sbF9idXR0b25cXFwiXFxuICAgIH0pO1xcbn1cXG5pZiAocnVsZUxpc3QubGVuZ3RoID4gMjApIHtcXG4gICAgZGF0YS5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBcXFwi5pCc57SiXFxcIixcXG4gICAgICAgIHVybDogJC50b1N0cmluZyhuYW1lID0+IFxcXCJoaWtlcjovL3NlYXJjaD9zPVxcXCIgKyBpbnB1dCArIFxcXCImcnVsZT1cXFwiICsgbmFtZSwgTVlfUlVMRS50aXRsZSksXFxuICAgICAgICBjb2xfdHlwZTogXFxcImlucHV0XFxcIixcXG4gICAgICAgIGRlc2M6IFxcXCLmkJzntKLlvZPliY3lvIDlj5HogIXnmoTop4TliJlcXFwiXFxuICAgIH0pO1xcbn1cXG5sZXQgaG9tZUxpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoYXBpLmhvbWUpKTtcXG5sZXQgbVJ1bGVMaXN0ID0gW107XFxuZm9yICh2YXIgaXRlbSBvZiBydWxlTGlzdCkge1xcbiAgICB2YXIgbmFtZSA9IGl0ZW0ubmFtZTtcXG4gICAgaWYgKGl0ZW0uaXNfdGFwKSB7XFxuICAgICAgICBsZXQgbG9jYXRpb24gPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXCJydWxlTGlzdEpzb25cXFwiKSArIFxcXCI/aWQ9XFxcIiArIGl0ZW0uaWQpKTtcXG4gICAgICAgIGl0ZW0uaWQgPSBsb2NhdGlvbi5pZDtcXG4gICAgICAgIGl0ZW0ubmFtZSA9IGxvY2F0aW9uLm5hbWU7XFxuICAgICAgICBpdGVtLmF1dGhvciA9IGxvY2F0aW9uLmF1dGhvcjtcXG4gICAgICAgIGl0ZW0uZGF0YV90eXBlID0gbG9jYXRpb24uZGF0YV90eXBlO1xcbiAgICAgICAgaXRlbS52ZXIgPSBsb2NhdGlvbi52ZXJcXG4gICAgfVxcbiAgICBpdGVtLnZlcnNpb24gPSBpdGVtLnZlcjtcXG4gICAgbGV0IGxhYmVsID0gXFxcIlxcXCIsXFxuICAgICAgICBsdmVyID0gLTI7XFxuICAgIGlmIChpdGVtLmlzX2pzb24gJiYgaXRlbS5kYXRhX3R5cGUgPT09IFxcXCJob21lX3J1bGVfdXJsXFxcIikge1xcbiAgICAgICAgbHZlciA9IGxvY2FsUnVsZVZlcihob21lTGlzdCwgaXRlbSk7XFxuICAgICAgICBpZiAobHZlciA9PT0gLTEpIHtcXG4gICAgICAgICAgICBsYWJlbCA9IFxcXCLwn4aVXFxcIjtcXG4gICAgICAgIH0gZWxzZSBpZiAobHZlciA8IGl0ZW0udmVyKSB7XFxuICAgICAgICAgICAgbGFiZWwgPSBcXFwi8J+GmVxcXCI7XFxuICAgICAgICB9XFxuICAgIH1cXG4gICAgbVJ1bGVMaXN0LnB1c2goe1xcbiAgICAgICAgdGl0bGU6IGxhYmVsICsgbmFtZSxcXG4gICAgICAgIHVybDogXFxcImhpa2VyOi8vcGFnZS9ydWxlRGV0YWlsI25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXCIsXFxuICAgICAgICBleHRyYToge1xcbiAgICAgICAgICAgIGx2ZXI6IGx2ZXIsXFxuICAgICAgICAgICAgaWQ6IGl0ZW0uaWRcXG4gICAgICAgIH0sXFxuICAgICAgICBwaWNfdXJsOiBpdGVtLnBpYyxcXG4gICAgfSk7XFxufVxcbi8qIOW9kuW5tuaOkuW6jyBTdGFydCAqL1xcbmlmKGdldEl0ZW0oXFxcIuaOkuW6j1xcXCIsXFxcIuaXtumXtOS8mOWFiFxcXCIpPT09J+aWsOeJiOS8mOWFiCcpe1xcbiAgICBtUnVsZUxpc3QgPSBub3JtYWxTb3J0KG1SdWxlTGlzdCk7XFxufVxcbi8qIOW9kuW5tuaOkuW6jyBFbmQgKi9cXG5kYXRhLnB1c2guYXBwbHkoZGF0YSwgbVJ1bGVMaXN0KVxcbnNldFJlc3VsdChkYXRhKTtcXG5cIixcImdyb3VwXCI6XCJcIixcInVhXCI6XCJtb2JpbGVcIixcInByZVJ1bGVcIjpcIiQucmVxdWlyZSgnaGlrZXI6Ly9wYWdlL2xpYnM/cnVsZT3pgZPplb/ku5PlupNQcm8nKTtcIixcInBhZ2VzXCI6XCJbe1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi5bel5YW3XFxcIixcXFwicGF0aFxcXCI6XFxcInV0aWxpeVxcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbmxldCBob3N0ID0gXFxcXFxcXCJodHRwOi8vaGlrZXIubm9raWEucHJlc3NcXFxcXFxcIjtcXFxcbi8vbGV0IGhvc3QgPSBcXFxcXFxcImh0dHA6Ly8xOTIuMTY4LjMuOTQ6ODA3OVxcXFxcXFwiO1xcXFxubGV0IGhvbWUgPSBiYXNlNjREZWNvZGUoXFxcXFxcXCJhR2xyWlhJNkx5OW9iMjFsXFxcXFxcXCIpO1xcXFxudmFyIGFwaSA9IHtcXFxcbiAgICBob3N0OiBob3N0K1xcXFxcXFwiL2hpa2VydWxlXFxcXFxcXCIsXFxcXG4gICAgdXNlcnNVcmw6IFxcXFxcXFwiL2Rldi91c2Vycz9vcmRlcj1cXFxcXFxcIiwgLy/nlKjmiLfliJfooahcXFxcbiAgICBydWxlQ291bnRVcmw6IFxcXFxcXFwiL2Rldi9ydWxlY291bnRcXFxcXFxcIiwgLy/ojrflj5bop4TliJnmlbDph49cXFxcbiAgICBydWxlc1VybDogXFxcXFxcXCIvZGV2L2dldFxcXFxcXFwiLCAvL+eUqOaIt+WvueW6lOeahOinhOWImeWIl+ihqOS7heS7heiOt+WPluWFrOW8gFxcXFxuICAgIHJ1bGVzQWxsVXJsOiBcXFxcXFxcIi9kZXYvZ2V0YWxsXFxcXFxcXCIsIC8v5byA5Y+R6ICF5a+55bqU55qE6KeE5YiZ5YiX6KGo5Y+v6I635Y+W56eB5pyJXFxcXG4gICAgZGV2U2VsZjonL2Rldi9nZXRzZWxmJywvL+iOt+WPluW8gOWPkeiAheS/oeaBr1xcXFxuICAgIG1hbkNhblVwbG9hZDonL3NldF9jYW5fdXBsb2FkLycsLy/otoXnrqHorr7nva7lvIDlj5HogIXmmK/lkKblj6/kuIrkvKBcXFxcbiAgICBtYW5SdWxlU2FmZTonL3NldF9ydWxlX3NhZmUvJywvL+i2heeuoeiuvue9ruinhOWImeWuieWFqOaAp1xcXFxuICAgIG1hblJ1bGVHb29kOicvc2V0X3J1bGVfZ29vZC8nLC8v6LaF566h6K6+572u6KeE5YiZ5LyY6LSo5oCnXFxcXG4gICAgaW1wb3J0VXJsOiBcXFxcXFxcIi9ydWxlbGlzdC5qc29uP2lkPVxcXFxcXFwiLCAvL+inhOWImeivpuaDheWPr+WvvOWFpVxcXFxuICAgIGluZm9TZXRVcmw6IFxcXFxcXFwiL2Rldi9zZXRfaW5mb1xcXFxcXFwiLFxcXFxuICAgIG5vd0NvblVybDogXFxcXFxcXCIvc3FsX2luZm8vZ2V0X25vd19jb25cXFxcXFxcIixcXFxcbiAgICBpbmZvR2V0VXJsOiBcXFxcXFxcIi9kZXYvZ2V0X2luZm8/bmFtZT1cXFxcXFxcIixcXFxcbiAgICBzZXR0aW5nc0dldFVybDogXFxcXFxcXCIvZGV2L2dldF9zZXR0aW5ncz9uYW1lPVxcXFxcXFwiLFxcXFxuICAgIGd1cGxvYWQ6IFxcXFxcXFwiL2Rldi9ndXBsb2FkXFxcXFxcXCIsXFxcXG4gICAgZ3RpbWVvdmVyOiBcXFxcXFxcIi9kZXYvZ3RpbWVvdmVyXFxcXFxcXCIsXFxcXG4gICAgZ2V0YnlpZDogXFxcXFxcXCIvZGV2L2dldGJ5aWRcXFxcXFxcIixcXFxcbiAgICBydWxlTGlzdEpzb246IFxcXFxcXFwiL3J1bGVsaXN0Lmpzb25cXFxcXFxcIixcXFxcbiAgICBhdXRoOiBcXFxcXFxcIi9kZXYvZ2V0X2F1dGhcXFxcXFxcIixcXFxcbiAgICB0aW1lb3ZlcjogXFxcXFxcXCIvZGV2L3RpbWVvdmVyXFxcXFxcXCIsXFxcXG4gICAgc2hhcmU6IFxcXFxcXFwiL2Rldi9zaGFyZVxcXFxcXFwiLFxcXFxuICAgIGdlbkF1dGg6IFxcXFxcXFwiL2Rldi9nZW5fYXV0aFxcXFxcXFwiLFxcXFxuICAgIGRlbGV0ZVVybDogXFxcXFxcXCIvZGV2L2RlbGV0ZVxcXFxcXFwiLFxcXFxuICAgIGpzb25MaXN0OiBcXFxcXFxcIi9kZXYvanNvbl9saXN0XFxcXFxcXCIsXFxcXG4gICAgc2VhcmNoOiBcXFxcXFxcIi9kZXYvc2VhcmNoXFxcXFxcXCIsXFxcXG4gICAgbmV3X2RldjogXFxcXFxcXCIvZGV2X3JlZ2lzdC9uZXdcXFxcXFxcIixcXFxcbiAgICBuZXdfZ2V0SWQ6IFxcXFxcXFwiL2Rldl9yZWdpc3QvZ2V0X2lkXFxcXFxcXCIsXFxcXG4gICAgbmV3X2NvbmZpcm06IFxcXFxcXFwiL2Rldl9yZWdpc3QvY29uZmlybVxcXFxcXFwiLFxcXFxuICAgIG1vZGlmeV9wd2Q6IFxcXFxcXFwiL21vZGlmeS9wYXNzd29yZFxcXFxcXFwiLFxcXFxuICAgIG1vZGlmeV9uYW1lOiBcXFxcXFxcIi9tb2RpZnkvbmFtZVxcXFxcXFwiLFxcXFxuICAgIG1vZGlmeV9hdmE6IFxcXFxcXFwiL21vZGlmeS9hdmF0YXJcXFxcXFxcIixcXFxcbiAgICB1c2VyOiBcXFxcXFxcIi9kZXYvdXNlci9cXFxcXFxcIixcXFxcbiAgICBnZXRfcnVsZV9ub3RlOiBcXFxcXFxcIi9tb2RpZnkvZ2V0X3J1bGVfbm90ZS9cXFxcXFxcIixcXFxcbiAgICBzZXRfcnVsZV9waWM6IFxcXFxcXFwiL21vZGlmeS9ydWxlX3BpYy9cXFxcXFxcIixcXFxcbiAgICBzZXRfcnVsZV9ub3RlOiBcXFxcXFxcIi9tb2RpZnkvcnVsZV9ub3RlL1xcXFxcXFwiXFxcXG59XFxcXG4kLmV4cG9ydHMucmFuZ2UgPSBmdW5jdGlvbihtLCBuKSB7XFxcXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtIC0gbiArIDEpICsgbik7XFxcXG59XFxcXG4kLmV4cG9ydHMubWFwQ29sVHlwZSA9IGZ1bmN0aW9uKHRhcmdldCwgdHlwZSwgbikge1xcXFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7XFxcXG4gICAgICAgIHRhcmdldC5wdXNoKHtcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiB0eXBlXFxcXG4gICAgICAgIH0pO1xcXFxuICAgIH1cXFxcbn1cXFxcbnZhciBnZXRBcGkgPSBmdW5jdGlvbihrKSB7XFxcXG4gICAgcmV0dXJuIGFwaS5ob3N0ICsgYXBpW2tdO1xcXFxufTtcXFxcbiQuZXhwb3J0cy5nZXRBcGk9Z2V0QXBpO1xcXFxuJC5leHBvcnRzLm1kPWdldEFwaSgnaW1wb3J0VXJsJykrXFxcXFxcXCIzMTg3XFxcXFxcXCI7XFxcXG4kLmV4cG9ydHMubG9jYWxSdWxlVmVyID0gZnVuY3Rpb24obG9jYWxSdWxlTGlzdCwgcnVsZSkge1xcXFxuICAgIGxldCBsb2NhbFJ1bGU7XFxcXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NhbFJ1bGVMaXN0Lmxlbmd0aDsgaSsrKSB7XFxcXG4gICAgICAgIGxldCBpdGVtID0gbG9jYWxSdWxlTGlzdFtpXTtcXFxcbiAgICAgICAgbGV0IGF1ID0gaXRlbS5hdXRob3IgfHwgXFxcXFxcXCJcXFxcXFxcIjtcXFxcbiAgICAgICAgbGV0IHNhbWVBdT1hdS5sZW5ndGggPiAwICYmIHJ1bGUuYXV0aG9yLmluY2x1ZGVzKGF1KTtcXFxcbiAgICAgICAgc2FtZUF1PXRydWU7Ly/kuI3liKTmlq3kvZzogIXpu5jorqTkuLp0cnVlXFxcXG4gICAgICAgIGlmIChpdGVtLnRpdGxlID09PSBydWxlLm5hbWUgJiYgc2FtZUF1KSB7XFxcXG4gICAgICAgICAgICBsb2NhbFJ1bGUgPSBpdGVtO1xcXFxuICAgICAgICAgICAgYnJlYWs7XFxcXG4gICAgICAgIH1cXFxcbiAgICB9XFxcXG4gICAgaWYgKGxvY2FsUnVsZSA9PT0gdm9pZCAwKSB7XFxcXG4gICAgICAgIHJldHVybiAtMTtcXFxcbiAgICB9IGVsc2Uge1xcXFxuICAgICAgICByZXR1cm4gbG9jYWxSdWxlLnZlcnNpb247XFxcXG4gICAgfVxcXFxufVxcXFxuJC5leHBvcnRzLmNvbG9yID0gZnVuY3Rpb24odGV4dCwgY29sb3IpIHtcXFxcbiAgICB0ZXh0ICs9IFxcXFxcXFwiXFxcXFxcXCI7XFxcXG4gICAgaWYgKHRleHQuaW5kZXhPZihcXFxcXFxcIuKAnOKAnOKAneKAnVxcXFxcXFwiKSA9PT0gMCkge1xcXFxuICAgICAgICB0ZXh0LnJlcGxhY2UoXFxcXFxcXCLigJzigJzigJ3igJ1cXFxcXFxcIiwgXFxcXFxcXCJcXFxcXFxcIik7XFxcXG4gICAgfVxcXFxuICAgIHJldHVybiBcXFxcXFxcIuKAnOKAnOKAneKAnTxmb250IGNvbG9yPSdcXFxcXFxcIiArIGNvbG9yICsgXFxcXFxcXCInPlxcXFxcXFwiICsgdGV4dCArIFxcXFxcXFwiPC9mb250PlxcXFxcXFwiO1xcXFxufVxcXFxuXFxcXG4kLmV4cG9ydHMuc2xlZXAgPSBmdW5jdGlvbih0aW1lb3V0KXtcXFxcbiAgICBqYXZhLmxhbmcuVGhyZWFkLnNsZWVwKHRpbWVvdXQpO1xcXFxufVxcXFxuZnVuY3Rpb24gaHRtbFRhZyh0YWcsIHRleHQpIHtcXFxcbiAgICB0ZXh0ICs9IFxcXFxcXFwiXFxcXFxcXCI7XFxcXG4gICAgaWYgKHRleHQuaW5kZXhPZihcXFxcXFxcIuKAnOKAnOKAneKAnVxcXFxcXFwiKSA9PT0gMCkge1xcXFxuICAgICAgICB0ZXh0LnJlcGxhY2UoXFxcXFxcXCLigJzigJzigJ3igJ1cXFxcXFxcIiwgXFxcXFxcXCJcXFxcXFxcIik7XFxcXG4gICAgfVxcXFxuICAgIHJldHVybiBcXFxcXFxcIuKAnOKAnOKAneKAnVxcXFxcXFwiICsgXFxcXFxcXCI8XFxcXFxcXCIgKyB0YWcgKyBcXFxcXFxcIj5cXFxcXFxcIiArIHRleHQgKyBcXFxcXFxcIjwvXFxcXFxcXCIgKyB0YWcgKyBcXFxcXFxcIj5cXFxcXFxcIjtcXFxcblxcXFxufVxcXFxuXFxcXG5mdW5jdGlvbiBnZXROb3dGb3JtYXREYXRlKCkge1xcXFxuICAgICAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpO1xcXFxuICAgICAgICAgICAgbGV0IHNlcGVyYXRvcjEgPSBcXFxcXFxcIi1cXFxcXFxcIjtcXFxcbiAgICAgICAgICAgIGxldCBzZXBlcmF0b3IyID0gXFxcXFxcXCI6XFxcXFxcXCI7XFxcXG4gICAgICAgICAgICBsZXQgbW9udGggPSBkYXRlLmdldE1vbnRoKCkgKyAxO1xcXFxuICAgICAgICAgICAgbGV0IHN0ckRhdGUgPSBkYXRlLmdldERhdGUoKTtcXFxcbiAgICAgICAgICAgIGxldCBzdHJIb3VycyA9IGRhdGUuZ2V0SG91cnMoKTtcXFxcbiAgICAgICAgICAgIGxldCBzdHJNaW51dGVzID0gZGF0ZS5nZXRNaW51dGVzKCk7XFxcXG4gICAgICAgICAgICBsZXQgc3RyU2Vjb25kcyA9IGRhdGUuZ2V0U2Vjb25kcygpKzE7XFxcXG4gICAgICAgICAgICBpZiAobW9udGggPj0gMSAmJiBtb250aCA8PSA5KSB7XFxcXG4gICAgICAgICAgICAgICAgbW9udGggPSBcXFxcXFxcIjBcXFxcXFxcIiArIG1vbnRoXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICBpZiAoc3RyRGF0ZSA+PSAwICYmIHN0ckRhdGUgPD0gOSkge1xcXFxuICAgICAgICAgICAgICAgIHN0ckRhdGUgPSBcXFxcXFxcIjBcXFxcXFxcIiArIHN0ckRhdGVcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIGlmIChzdHJIb3VycyA+PSAwICYmIHN0ckhvdXJzIDw9IDkpIHtcXFxcbiAgICAgICAgICAgICAgICBzdHJIb3VycyA9IFxcXFxcXFwiMFxcXFxcXFwiICsgc3RySG91cnNcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIGlmIChzdHJNaW51dGVzID49IDAgJiYgc3RyTWludXRlcyA8PSA5KSB7XFxcXG4gICAgICAgICAgICAgICAgc3RyTWludXRlcyA9IFxcXFxcXFwiMFxcXFxcXFwiICsgc3RyTWludXRlc1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgaWYgKHN0clNlY29uZHMgPj0gMCAmJiBzdHJTZWNvbmRzIDw9IDkpIHtcXFxcbiAgICAgICAgICAgICAgICBzdHJTZWNvbmRzID0gXFxcXFxcXCIwXFxcXFxcXCIgKyBzdHJTZWNvbmRzXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAvL2xldCBjdXJyZW50ZGF0ZSA9IGRhdGUuZ2V0RnVsbFllYXIoKSArIHNlcGVyYXRvcjEgKyBtb250aCArIHNlcGVyYXRvcjEgKyBzdHJEYXRlICsgXFxcXFxcXCIgXFxcXFxcXCIgKyBzdHJIb3VycyArIHNlcGVyYXRvcjIgKyBzdHJNaW51dGVzICsgc2VwZXJhdG9yMiArIHN0clNlY29uZHM7XFxcXG4gICAgICAgICAgICBsZXQgY3VycmVudGRhdGUgPSAoZGF0ZS5nZXRGdWxsWWVhcigpLTIwMjApKycnKyBtb250aCArJycrIHN0ckRhdGUgKycnKyBzdHJIb3VycysnJyArIHN0ck1pbnV0ZXMgKycnKyBNYXRoLmNlaWwoc3RyU2Vjb25kcy83KTtcXFxcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludChjdXJyZW50ZGF0ZSlcXFxcbiAgICAgICAgfVxcXFxuJC5leHBvcnRzLmdldE5vd0Zvcm1hdERhdGUgPSBnZXROb3dGb3JtYXREYXRlO1xcXFxuJC5leHBvcnRzLmh0bWxUYWcgPSBodG1sVGFnO1xcXFxuJC5leHBvcnRzLnNtYWxsID0gZnVuY3Rpb24odGV4dCkge1xcXFxuICAgIHJldHVybiBodG1sVGFnKFxcXFxcXFwic21hbGxcXFxcXFxcIiwgdGV4dCk7XFxcXG59XFxcXG4kLmV4cG9ydHMuZ2V0RmlsZSA9IGZ1bmN0aW9uKCkge1xcXFxuICAgIHZhciBGaWxlID0gcmVxdWVzdChcXFxcXFxcImhpa2VyOi8vZmlsZXMvV2FyZWhvdXNlVVNFUi5qc29uXFxcXFxcXCIpIHx8IFxcXFxcXFwie31cXFxcXFxcIjtcXFxcbiAgICB0cnkge1xcXFxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShGaWxlKTtcXFxcbiAgICB9IGNhdGNoIChlKSB7XFxcXG4gICAgICAgIHdyaXRlRmlsZShcXFxcXFxcImhpa2VyOi8vZmlsZXMvV2FyZWhvdXNlVVNFUi5qc29uXFxcXFxcXCIsIFxcXFxcXFwie31cXFxcXFxcIik7XFxcXG4gICAgICAgIHJldHVybiB7fTtcXFxcbiAgICB9XFxcXG59XFxcXG4kLmV4cG9ydHMuZ2V0VXNlckRhdGUgPWZ1bmN0aW9uKCl7XFxcXG4gICAgdmFyIEZpbGUgPSByZXF1ZXN0KFxcXFxcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSQS5qc29uXFxcXFxcXCIpIHx8IFxcXFxcXFwiW11cXFxcXFxcIjtcXFxcbiAgICB0cnkge1xcXFxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShGaWxlKTtcXFxcbiAgICB9IGNhdGNoIChlKSB7XFxcXG4gICAgICAgIHdyaXRlRmlsZShcXFxcXFxcImhpa2VyOi8vZmlsZXMvV2FyZWhvdXNlVVNFUkEuanNvblxcXFxcXFwiLCBcXFxcXFxcIltdXFxcXFxcXCIpO1xcXFxuICAgICAgICByZXR1cm4gW107XFxcXG4gICAgfVxcXFxufVxcXFxuJC5leHBvcnRzLmV4aXN0RmlsZSA9IGZ1bmN0aW9uKHNwYXRoLCBpcGF0aCwgaGVhZGVycykge1xcXFxuICAgIGxldCBzY29kZSA9IHJlcXVlc3Qoc3BhdGgpO1xcXFxuICAgIGlmICghc2NvZGUpIHtcXFxcbiAgICAgICAgd3JpdGVGaWxlKHNwYXRoLCByZXF1ZXN0KGlwYXRoLCBoZWFkZXJzKSk7XFxcXG4gICAgfVxcXFxufVxcXFxuXFxcXG5sZXQgbmV3QXBpID0ge1xcXFxuICAgIFxcXFxcXFwiZGlzX25ld1xcXFxcXFwiOiBcXFxcXFxcIi9oaWtlcnVsZS9uZXdfcnVsZV9kaXNjdXNzL1xcXFxcXFwiLFxcXFxuICAgIFxcXFxcXFwiZGlzX3ZlcmlmeVxcXFxcXFwiOiBcXFxcXFxcIi9oaWtlcnVsZS9ydWxlX2Rpc2N1c3MvZ2V0X3l6bVxcXFxcXFwiLFxcXFxuICAgIFxcXFxcXFwiZGlzX2dldFxcXFxcXFwiOiBcXFxcXFxcIi9oaWtlcnVsZS9ydWxlX2Rpc2N1c3MvXFxcXFxcXCIsXFxcXG4gICAgXFxcXFxcXCJkaXNfc2V0XFxcXFxcXCI6IFxcXFxcXFwiL2hpa2VydWxlL21vZGlmeS9jYW5fZGlzY3Vzcy9cXFxcXFxcIixcXFxcbiAgICBcXFxcXFxcImRpc19uZXdfdXNlclxcXFxcXFwiOiBcXFxcXFxcIi9oaWtlcnVsZS9ydWxlX2Rpc2N1c3MvbmV3X3VzZXJcXFxcXFxcIixcXFxcbiAgICBcXFxcXFxcImRpc19sb2dpblxcXFxcXFwiOlxcXFxcXFwiL2hpa2VydWxlL3J1bGVfZGlzY3Vzcy91c2VyX2xvZ2luXFxcXFxcXCIsXFxcXG4gICAgXFxcXFxcXCJkaXNfZGV2X2Rpc2N1c3NcXFxcXFxcIjpcXFxcXFxcIi9oaWtlcnVsZS9tb2RpZnkvZGV2X2Nhbl9kaXNjdXNzXFxcXFxcXCIsXFxcXG4gICAgXFxcXFxcXCJkaXNfZGV2X2NvbnRyb2xcXFxcXFxcIjpcXFxcXFxcIi9oaWtlcnVsZS9ydWxlX2Rpc2N1c3MvcmVtb3ZlL1xcXFxcXFwiLFxcXFxuICAgIFxcXFxcXFwiYWxsX3J1bGVcXFxcXFxcIjpcXFxcXFxcIi9oaWtlcnVsZS9nZXRfcnVsZXNcXFxcXFxcIixcXFxcbiAgICBcXFxcXFxcImRpc19nZXRfcmVwbHlcXFxcXFxcIjpcXFxcXFxcIi9oaWtlcnVsZS9nZXRfcmVwbHlfcnVsZV9kaXNjdXNzXFxcXFxcXCIsXFxcXG4gICAgXFxcXFxcXCJkaXNfcmVwbHlcXFxcXFxcIjpcXFxcXFxcIi9oaWtlcnVsZS9kZXZfbmV3X3J1bGVfZGlzY3Vzcy9cXFxcXFxcIixcXFxcbn1cXFxcblxcXFxuZnVuY3Rpb24gc2V0QXBpKG9iamVjdCkge1xcXFxuICAgIGxldCB0YXJnZXQgPSB7fTtcXFxcbiAgICBmb3IgKGxldCBrZXkgaW4gb2JqZWN0KSB7XFxcXG4gICAgICAgIHRhcmdldFtrZXldPWhvc3Qrb2JqZWN0W2tleV1cXFxcbiAgICB9XFxcXG4gICAgcmV0dXJuIHRhcmdldDtcXFxcbn1cXFxcblxcXFxuJC5leHBvcnRzLmFwaSA9IHNldEFwaShuZXdBcGkpO1xcXFxuJC5leHBvcnRzLmFwaS5ob3N0PWhvc3Q7XFxcXG4kLmV4cG9ydHMuYXBpLmhvbWU9aG9tZTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLlvIDlj5HogIXnmbvlvZVcXFwiLFxcXCJwYXRoXFxcIjpcXFwiZGV2TG9naW5cXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG5zZXRQYWdlVGl0bGUoXFxcXFxcXCLlvIDlj5HogIXnmbvlvZVcXFxcXFxcIik7XFxcXG5jb25zdCB7XFxcXG4gICAgZ2V0QXBpLFxcXFxuICAgIGh0bWxUYWcsXFxcXG4gICAgbWFwQ29sVHlwZSxcXFxcbiAgICBzbWFsbCxcXFxcbmdldEZpbGVcXFxcbn0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcXFxcXCIpO1xcXFxudmFyIGRhdGEgPSBbXTtcXFxcbmFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKT0+e1xcXFxuICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlVXNlcm5hbWVcXFxcXFxcIik7XFxcXG4gICAgY2xlYXJWYXIoXFxcXFxcXCJXYXJlaG91c2VQYXNzd29yZFxcXFxcXFwiKTtcXFxcbn0pKVxcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogJ+i0puWPtycsXFxcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxcXG4gICAgZXh0cmE6IHtcXFxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZVVzZXJuYW1lJywnJyksXFxcXG4gICAgICAgIHR5cGU6XFxcXFxcXCJudW1iZXJcXFxcXFxcIixcXFxcbiAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2VVc2VybmFtZVxcXFxcXFwiLGlucHV0KSdcXFxcbiAgICB9XFxcXG59LCB7XFxcXG4gICAgdGl0bGU6ICflr4bnoIEnLFxcXFxuICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2VQYXNzd29yZCcsICcnKSxcXFxcbiAgICAgICAgdHlwZTogXFxcXFxcXCJwYXNzd29yZFxcXFxcXFwiLFxcXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFxcXFxcIldhcmVob3VzZVBhc3N3b3JkXFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgIH1cXFxcbn0pO1xcXFxuXFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOlxcXFxcXFwiJm5ic3A7Jm5ic3A7PGEgaHJlZj0naGlrZXI6Ly9wYWdlL1JlZ2lzdGVyJz7ms6jlhow8L2E+XFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6XFxcXFxcXCJyaWNoX3RleHRcXFxcXFxcIlxcXFxufSk7XFxcXG5tYXBDb2xUeXBlKGRhdGEsIFxcXFxcXFwibGluZV9ibGFua1xcXFxcXFwiLCAxKTtcXFxcbmxldCB1c2VyID0gZ2V0RmlsZSgpO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogaHRtbFRhZyhcXFxcXFxcImJcXFxcXFxcIiwgXFxcXFxcXCLnmbvlvZVcXFxcXFxcIiksXFxcXG4gICAgdXJsOiAkKCkubGF6eVJ1bGUoKHVybCwgZik9PiB7XFxcXG4gICAgICAgIGxldCB1c2VybmFtZSA9IGdldFZhcignV2FyZWhvdXNlVXNlcm5hbWUnLCAnJyksXFxcXG4gICAgICAgICAgICBwYXNzd29yZCA9IGdldFZhcignV2FyZWhvdXNlUGFzc3dvcmQnLCAnJyk7XFxcXG4gICAgICAgIGlmKHVzZXJuYW1lID09PSBcXFxcXFxcIlxcXFxcXFwiICYmIHBhc3N3b3JkID09PVxcXFxcXFwiXFxcXFxcXCIpe1xcXFxuICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/otKblj7flkozlr4bnoIHkuI3og73kuLrnqbpcXFxcXFxcIlxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGxldCBteVVybCA9IHVybCArICc/cXE9JyArIHVzZXJuYW1lICsgJyZwYXNzd29yZD0nICsgcGFzc3dvcmQ7XFxcXG4gICAgICAgIGxldCBjb2RlX3N0ciA9IHJlcXVlc3QobXlVcmwpO1xcXFxuICAgICAgICBsZXQgY29kZSA9IEpTT04ucGFyc2UoY29kZV9zdHIpO1xcXFxuICAgICAgICBpZiAoY29kZS5zdGF0dXMgPT0gMCkge1xcXFxuICAgICAgICAgICAgZi51c2VybmFtZT11c2VybmFtZTtcXFxcbiAgICAgICAgICAgIGYucGFzc3dvcmQ9cGFzc3dvcmRcXFxcbiAgICAgICAgICAgIHdyaXRlRmlsZSgnaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb24nLCBKU09OLnN0cmluZ2lmeShmKSk7XFxcXG4gICAgICAgICAgICBiYWNrKCk7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+eZu+W9leaIkOWKn1xcXFxcXFwiO1xcXFxuICAgICAgICB9ZWxzZXtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v6LSm5Y+35oiW5a+G56CB6ZSZ6K+vXFxcXFxcXCI7XFxcXG4gICAgICAgIH1cXFxcbiAgICB9LCBnZXRBcGkoXFxcXFxcXCJydWxlc0FsbFVybFxcXFxcXFwiKSx1c2VyKSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfY2VudGVyXzEnXFxcXG59KTtcXFxcbnNldFJlc3VsdChkYXRhKTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwiaWNvbl8yX3JvdW5kXFxcIixcXFwibmFtZVxcXCI6XFxcIuW8gOWPkeiAheeuoeeQhlxcXCIsXFxcInBhdGhcXFwiOlxcXCJkZXZNYW5hZ2VcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG5zZXRQYWdlVGl0bGUoXFxcXFxcXCLop4TliJnnrqHnkIZcXFxcXFxcIik7XFxcXG5hZGRMaXN0ZW5lcignb25DbG9zZScsICdjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5iYWNrXFxcXFxcXCIsXFxcXFxcXCJcXFxcXFxcIik7Jyk7XFxcXG5pZiAoZ2V0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmJhY2tcXFxcXFxcIikgPT09IFxcXFxcXFwiMVxcXFxcXFwiKSB7XFxcXG4gICAgYmFjaygpO1xcXFxufVxcXFxuY29uc3Qge1xcXFxuICAgIGdldEFwaSxcXFxcbiAgICBjb2xvcixcXFxcbiAgICBzbWFsbCxcXFxcbiAgICBnZXRGaWxlLFxcXFxuICAgIGV4aXN0RmlsZSxcXFxcbiAgICBtYXBDb2xUeXBlLFxcXFxuICAgIGFwaVxcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG5sZXQge1xcXFxuICAgIGRldlxcXFxufSA9IE1ZX1BBUkFNUztcXFxcbmxldCB7XFxcXG4gICAgdXNlcm5hbWUsXFxcXG4gICAgcGFzc3dvcmQsXFxcXG59ID0gZ2V0RmlsZSgpO1xcXFxuLy9leGlzdEZpbGUoXFxcXFxcXCJoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvaHRtbC/lvIDlj5HogIXliIbkuqsuaHRtbFxcXFxcXFwiLCBcXFxcXFxcImh0dHBzOi8vZXJwLnNjd2luYmFvLmNvbS9oaWtlcnVsZS9ydWxlbGlzdC5qc29uP2lkPTUzOVxcXFxcXFwiKTtcXFxcbmxldCBydWxlTGlzdCA9IEpTT04ucGFyc2UocmVxdWVzdChnZXRBcGkoXFxcXFxcXCJydWxlc0FsbFVybFxcXFxcXFwiKSArICc/cXE9JyArIHVzZXJuYW1lICsgJyZwYXNzd29yZD0nICsgcGFzc3dvcmQpKS5yZXN1bHQ7XFxcXG5sZXQgTU9CSUxFX1VBID0gJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA1LjA7IFNNLUc5MDBQIEJ1aWxkL0xSWDIxVCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg4LjAuNDMyNC4xNDYgTW9iaWxlIFNhZmFyaS81MzcuMzYnO1xcXFxubGV0IGluZm9TZXRVcmwgPSBnZXRBcGkoXFxcXFxcXCJpbmZvU2V0VXJsXFxcXFxcXCIpO1xcXFxubGV0IGluZm9HZXRVcmwgPSBnZXRBcGkoXFxcXFxcXCJpbmZvR2V0VXJsXFxcXFxcXCIpICsgdXNlcm5hbWU7XFxcXG5sZXQgc2V0dGluZ3NHZXRVcmwgPSBnZXRBcGkoXFxcXFxcXCJzZXR0aW5nc0dldFVybFxcXFxcXFwiKSArIHVzZXJuYW1lO1xcXFxucHV0TXlWYXIoXFxcXFxcXCJkZXZfc2V0X2luZm9cXFxcXFxcIiwgW3VzZXJuYW1lLCBwYXNzd29yZCwgaW5mb1NldFVybCwgTU9CSUxFX1VBLCBpbmZvR2V0VXJsXS5qb2luKFxcXFxcXFwiJCRcXFxcXFxcIikpO1xcXFxubGV0IGRhdGEgPSBbXTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6ICfigJzigJzigJ3igJ08YmlnPuS7k+W6k+iuvue9rjwvYmlnPiZuYnNwOyZuYnNwOyZuYnNwOzxzbWFsbD48dT7vvIgg5Liq5Lq66LWE5paZID7vvIk8L3U+PC9zbWFsbD4nLFxcXFxuICAgIGRlc2M6ICfigJzigJzigJ3igJ3mgqjlhbHmnIkgPHNwYW4gc3R5bGU9XFxcXFxcXCJjb2xvcjogI2ZmNzAwMFxcXFxcXFwiPicgKyBydWxlTGlzdC5sZW5ndGggKyAnPC9zcGFuPicgKyBcXFxcXFxcIiDmnaHop4TliJnjgIJcXFxcXFxcXG7ngrnlh7vop4TliJnlj6/ov5vooYzliIbkuqvjgIHliKDpmaTjgIHlr7zlhaXmk43kvZzlj4rmn6XnnIvor6bmg4VcXFxcXFxcIixcXFxcbiAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL1BlcnNvbmFsRGF0YSNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFxcXFxcIixcXFxcbiAgICBleHRyYTp7aWQ6ZGV2LmlkfSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMSdcXFxcbn0pO1xcXFxubWFwQ29sVHlwZShkYXRhLCBcXFxcXFxcImxpbmVcXFxcXFxcIiwgMik7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBzbWFsbChjb2xvcihcXFxcXFxcIuabtOaUueWFrOWRiuKcjVxcXFxcXFwiLCBcXFxcXFxcIiMzNGIxZmZcXFxcXFxcIikpLFxcXFxuICAgIC8vIHVybDogXFxcXFxcXCJ4NTovL2ZpbGU6Ly8vc3RvcmFnZS9lbXVsYXRlZC8wL0FuZHJvaWQvZGF0YS9jb20uZXhhbXBsZS5oaWtlcnZpZXcvZmlsZXMvRG9jdW1lbnRzL3J1bGVzL2R6SG91c2UvaHRtbC9kZXZfaW5mb19lZGl0Lmh0bWxcXFxcXFxcIixcXFxcbiAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL2RldkluZm9FZGl0XFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzMnXFxcXG59KTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IHNtYWxsKGNvbG9yKFxcXFxcXFwi5pu05aSa5YiG5Lqr8J+TslxcXFxcXFwiLCBcXFxcXFxcIiMzNGIxZmZcXFxcXFxcIikpLFxcXFxuICAgIC8vdXJsOiBcXFxcXFxcIng1Oi8vZmlsZTovLy9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL2NvbS5leGFtcGxlLmhpa2Vydmlldy9maWxlcy9Eb2N1bWVudHMvcnVsZXMvZHpIb3VzZS9odG1sL+W8gOWPkeiAheWIhuS6qy5odG1sXFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9tb3JlU2hhcmVcXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMydcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogc21hbGwoY29sb3IoXFxcXFxcXCLljYfnuqfkvp3otZbwn5OlXFxcXFxcXCIsIFxcXFxcXFwiIzM0YjFmZlxcXFxcXFwiKSksXFxcXG4gICAgdXJsOiAkKFxcXFxcXFwi5Y2H57qn5Lya6YeN5paw5LuO5LuT5bqT5ouJ5Y+W55u45YWz55qE6Z2Z5oCB6aG16Z2i5Yiw5pys5ZywXFxcXFxcXFxu56Gu6K6k5Y2H57qn5ZCXP1xcXFxcXFwiKS5jb25maXJtKChob3N0KSA9PiB7XFxcXG4gICAgICAgIHdyaXRlRmlsZShcXFxcXFxcImhpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9odG1sL+W8gOWPkeiAheWIhuS6qy5odG1sXFxcXFxcXCIsIHJlcXVlc3QoaG9zdCsnL2hpa2VydWxlL3J1bGVsaXN0Lmpzb24/aWQ9NTM5JykpO1xcXFxuICAgICAgICB3cml0ZUZpbGUoXFxcXFxcXCJoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvaHRtbC9kZXZfaW5mb19lZGl0Lmh0bWxcXFxcXFxcIiwgcmVxdWVzdChob3N0KycvaGlrZXJ1bGUvcnVsZWxpc3QuanNvbj9pZD00MDInKSk7XFxcXG4gICAgICAgIHdyaXRlRmlsZShcXFxcXFxcImhpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9odG1sL2Rldl9pbmZvX2dldC5odG1sXFxcXFxcXCIsIHJlcXVlc3QoaG9zdCsnL2hpa2VydWxlL3J1bGVsaXN0Lmpzb24/aWQ9NDA0JykpO1xcXFxuICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxcXG4gICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5bey6YeN572u5byA5Y+R6ICF5YiG5LqrLOeugOS7i+afpeeciyznroDku4vnvJbovpHnrYnpnZnmgIHmlofku7ZcXFxcXFxcIjtcXFxcbiAgICB9LGFwaS5ob3N0KSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMydcXFxcbn0pO1xcXFxubGV0IGRldlNldEJhY2s7XFxcXG50cnkge1xcXFxuICAgIGRldlNldEJhY2sgPSBKU09OLnBhcnNlKHJlcXVlc3Qoc2V0dGluZ3NHZXRVcmwpKTtcXFxcbn0gY2F0Y2ggKGUpIHtcXFxcbiAgICBkZXZTZXRCYWNrID0ge307XFxcXG59XFxcXG5cXFxcbmZ1bmN0aW9uIHNldFNldHRpbmdJdGVtKGJhc2ljKSB7XFxcXG4gICAgbGV0IHRlbXAgPSB7XFxcXG4gICAgICAgIHRpdGxlOiBiYXNpYy50aXRsZSxcXFxcbiAgICAgICAgY29sX3R5cGU6IGJhc2ljLmNvbF90eXBlLFxcXFxuICAgICAgICB1cmw6ICQoYmFzaWMuY29uZmlybSkuY29uZmlybSgodXJsLCBtc2cpID0+IHtcXFxcbiAgICAgICAgICAgIGxldCBiYWNrID0gcmVxdWVzdCh1cmwpO1xcXFxuICAgICAgICAgICAgbGV0IHJldCA9IEpTT04ucGFyc2UoYmFjayk7XFxcXG4gICAgICAgICAgICBpZiAocmV0LnN0YXR1cyA9PSAwKSB7XFxcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UodHJ1ZSk7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly9cXFxcXFxcIiArIG1zZ1swXTtcXFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vXFxcXFxcXCIgKyBtc2dbMV0gKyBcXFxcXFxcIlxcXFxcXFxcblxcXFxcXFwiICsgcmV0LmRldGFpbDtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfSwgYmFzaWMudXJsLCBiYXNpYy5tc2cpXFxcXG4gICAgfTtcXFxcbiAgICByZXR1cm4gdGVtcDtcXFxcbn1cXFxcbmlmIChkZXZTZXRCYWNrLnN0YXR1cyA9PSAwKSB7XFxcXG4gICAgbGV0IGRldlNldHRpbmdzID0gZGV2U2V0QmFjay5yZXN1bHQ7XFxcXG4gICAgbGV0IHNoYXJlID0ge1xcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJ0ZXh0XzNcXFxcXFxcIlxcXFxuICAgIH07XFxcXG4gICAgaWYgKGRldlNldHRpbmdzLnNoYXJlX3B1YmxpYykge1xcXFxuICAgICAgICBzaGFyZS50aXRsZSA9IHNtYWxsKGNvbG9yKFxcXFxcXFwi5YWs5byA5LiK5LygXFxcXFxcXCIsIFxcXFxcXFwiZ3JlZW5cXFxcXFxcIikgKyBjb2xvcihcXFxcXFxcIijnp4Hol48pXFxcXFxcXCIsIFxcXFxcXFwiIzAwYmZmZlxcXFxcXFwiKSk7XFxcXG4gICAgICAgIHNoYXJlLnVybCA9IGdldEFwaShcXFxcXFxcImd1cGxvYWRcXFxcXFxcIikgKyBcXFxcXFxcIj9xcT1cXFxcXFxcIiArIHVzZXJuYW1lICsgXFxcXFxcXCImcGFzc3dvcmQ9XFxcXFxcXCIgKyBwYXNzd29yZCArIFxcXFxcXFwiJmZsYWc9MVxcXFxcXFwiO1xcXFxuICAgICAgICBzaGFyZS5jb25maXJtID0gXFxcXFxcXCLmmK/lkKbnoa7orqTnp4Hol4/ku6XlkI7mj5DkuqTnmoTop4TliJk/XFxcXFxcXCI7XFxcXG4gICAgICAgIHNoYXJlLm1zZyA9IFtcXFxcXFxcIuW3suengeiXj1xcXFxcXFwiLCBcXFxcXFxcIuengeiXj+Wksei0pVxcXFxcXFwiXTtcXFxcbiAgICB9IGVsc2Uge1xcXFxuICAgICAgICBzaGFyZS50aXRsZSA9IHNtYWxsKGNvbG9yKFxcXFxcXFwi56eB5a+G5LiK5LygXFxcXFxcXCIsIFxcXFxcXFwicmVkXFxcXFxcXCIpICsgY29sb3IoXFxcXFxcXCIo5YWs5byAKVxcXFxcXFwiLCBcXFxcXFxcIiNhZGZmMmZcXFxcXFxcIikpO1xcXFxuICAgICAgICBzaGFyZS51cmwgPSBnZXRBcGkoXFxcXFxcXCJndXBsb2FkXFxcXFxcXCIpICsgXFxcXFxcXCI/cXE9XFxcXFxcXCIgKyB1c2VybmFtZSArIFxcXFxcXFwiJnBhc3N3b3JkPVxcXFxcXFwiICsgcGFzc3dvcmQ7XFxcXG4gICAgICAgIHNoYXJlLmNvbmZpcm0gPSBcXFxcXFxcIuaYr+WQpuehruiupOWFrOW8gOS7peWQjuaPkOS6pOeahOinhOWImT9cXFxcXFxcIjtcXFxcbiAgICAgICAgc2hhcmUubXNnID0gW1xcXFxcXFwi5bey5YWs5byAXFxcXFxcXCIsIFxcXFxcXFwi5YWs5byA5aSx6LSlXFxcXFxcXCJdO1xcXFxuICAgIH1cXFxcbiAgICBkYXRhLnB1c2goc2V0U2V0dGluZ0l0ZW0oc2hhcmUpKTtcXFxcbiAgICBsZXQgdGltZU92ZXIgPSB7XFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfM1xcXFxcXFwiXFxcXG4gICAgfTtcXFxcbiAgICBpZiAoZGV2U2V0dGluZ3MudGltZV9vdmVyKSB7XFxcXG4gICAgICAgIHRpbWVPdmVyLnRpdGxlID0gc21hbGwoY29sb3IoXFxcXFxcXCLnn63ml7bnp5jpkqVcXFxcXFxcIiwgXFxcXFxcXCJncmVlblxcXFxcXFwiKSArIGNvbG9yKFxcXFxcXFwiKOawuOS5hSlcXFxcXFxcIiwgXFxcXFxcXCIjMDBiZmZmXFxcXFxcXCIpKTtcXFxcbiAgICAgICAgdGltZU92ZXIudXJsID0gZ2V0QXBpKFxcXFxcXFwiZ3RpbWVvdmVyXFxcXFxcXCIpICsgXFxcXFxcXCI/cXE9XFxcXFxcXCIgKyB1c2VybmFtZSArIFxcXFxcXFwiJnBhc3N3b3JkPVxcXFxcXFwiICsgcGFzc3dvcmQgKyBcXFxcXFxcIiZmbGFnPTFcXFxcXFxcIjtcXFxcbiAgICAgICAgdGltZU92ZXIuY29uZmlybSA9IFxcXFxcXFwi5piv5ZCm56Gu6K6k5Lul5ZCO55qE56eB6JeP6KeE5YiZ5YiG5Lqr5LiN6L+H5pyfP1xcXFxcXFwiO1xcXFxuICAgICAgICB0aW1lT3Zlci5tc2cgPSBbXFxcXFxcXCLlt7Lorr7kuLrmsLjkuYVcXFxcXFxcIiwgXFxcXFxcXCLorr7kuLrmsLjkuYXlpLHotKVcXFxcXFxcIl07XFxcXG4gICAgfSBlbHNlIHtcXFxcbiAgICAgICAgdGltZU92ZXIudGl0bGUgPSBzbWFsbChjb2xvcihcXFxcXFxcIuawuOS5heenmOmSpVxcXFxcXFwiLCBcXFxcXFxcInJlZFxcXFxcXFwiKSArIGNvbG9yKFxcXFxcXFwiKOi/h+acnylcXFxcXFxcIiwgXFxcXFxcXCIjYWRmZjJmXFxcXFxcXCIpKTtcXFxcbiAgICAgICAgdGltZU92ZXIudXJsID0gZ2V0QXBpKFxcXFxcXFwiZ3RpbWVvdmVyXFxcXFxcXCIpICsgXFxcXFxcXCI/cXE9XFxcXFxcXCIgKyB1c2VybmFtZSArIFxcXFxcXFwiJnBhc3N3b3JkPVxcXFxcXFwiICsgcGFzc3dvcmQ7XFxcXG4gICAgICAgIHRpbWVPdmVyLmNvbmZpcm0gPSBcXFxcXFxcIuehruiupOimgeS7peWQjuWIhuS6q+eahOengeiXj+inhOWImeiHquWKqOWIsOacnz9cXFxcXFxcIjtcXFxcbiAgICAgICAgdGltZU92ZXIubXNnID0gW1xcXFxcXFwi5bey6K6+5Li66L+H5pyfXFxcXFxcXCIsIFxcXFxcXFwi6K6+5Li66L+H5pyf5aSx6LSlXFxcXFxcXCJdO1xcXFxuICAgIH1cXFxcbiAgICBkYXRhLnB1c2goc2V0U2V0dGluZ0l0ZW0odGltZU92ZXIpKTtcXFxcbiAgICBsZXQgZGlzY3VzcyA9IHtcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8zXFxcXFxcXCJcXFxcbiAgICB9O1xcXFxuICAgIGlmIChkZXZTZXR0aW5ncy5jYW5fZGlzY3Vzcykge1xcXFxuICAgICAgICBkaXNjdXNzLnRpdGxlID0gc21hbGwoY29sb3IoXFxcXFxcXCLlhYHorrjor4TorrpcXFxcXFxcIiwgXFxcXFxcXCJyZWRcXFxcXFxcIikgKyBjb2xvcihcXFxcXFxcIijkuI3orrgpXFxcXFxcXCIsIFxcXFxcXFwiI2FkZmYyZlxcXFxcXFwiKSk7XFxcXG4gICAgICAgIGRpc2N1c3MudXJsID0gYXBpLmRpc19kZXZfZGlzY3VzcyArIFxcXFxcXFwiP3FxPVxcXFxcXFwiICsgdXNlcm5hbWUgKyBcXFxcXFxcIiZwYXNzd29yZD1cXFxcXFxcIiArIHBhc3N3b3JkKyBcXFxcXFxcIiZmbGFnPTFcXFxcXFxcIjtcXFxcbiAgICAgICAgZGlzY3Vzcy5jb25maXJtID0gXFxcXFxcXCLmmK/lkKbnoa7orqTku6XlkI7kuIrkvKDnmoTop4TliJnlhYHorrjor4Torro/XFxcXFxcXCI7XFxcXG4gICAgICAgIGRpc2N1c3MubXNnID0gW1xcXFxcXFwi5bey6K6+5Li65LiN6K64XFxcXFxcXCIsIFxcXFxcXFwi6K6+572u5aSx6LSlXFxcXFxcXCJdO1xcXFxuXFxcXG4gICAgfSBlbHNlIHtcXFxcbiAgICAgICAgZGlzY3Vzcy50aXRsZSA9IHNtYWxsKGNvbG9yKFxcXFxcXFwi5LiN6K646K+E6K66XFxcXFxcXCIsIFxcXFxcXFwiZ3JlZW5cXFxcXFxcIikgKyBjb2xvcihcXFxcXFxcIijlhYHorrgpXFxcXFxcXCIsIFxcXFxcXFwiIzAwYmZmZlxcXFxcXFwiKSk7XFxcXG4gICAgICAgIGRpc2N1c3MudXJsID0gYXBpLmRpc19kZXZfZGlzY3VzcyArIFxcXFxcXFwiP3FxPVxcXFxcXFwiICsgdXNlcm5hbWUgKyBcXFxcXFxcIiZwYXNzd29yZD1cXFxcXFxcIiArIHBhc3N3b3JkO1xcXFxuICAgICAgICBkaXNjdXNzLmNvbmZpcm0gPSBcXFxcXFxcIuaYr+WQpuehruiupOS7peWQjuS4iuS8oOeahOinhOWImeWFgeiuuOivhOiuuj9cXFxcXFxcIjtcXFxcbiAgICAgICAgZGlzY3Vzcy5tc2cgPSBbXFxcXFxcXCLlt7Lorr7kuLrlhYHorrhcXFxcXFxcIiwgXFxcXFxcXCLorr7nva7lpLHotKVcXFxcXFxcIl07XFxcXG4gICAgfVxcXFxuICAgIGRhdGEucHVzaChzZXRTZXR0aW5nSXRlbShkaXNjdXNzKSk7XFxcXG59XFxcXG5tYXBDb2xUeXBlKGRhdGEsIFxcXFxcXFwibGluZVxcXFxcXFwiLCAyKTtcXFxcbmZvciAobGV0IGl0ZW0gb2YgcnVsZUxpc3QpIHtcXFxcbiAgICBsZXQgbXlfdF9leGNvZGUxID0gJyc7XFxcXG4gICAgbGV0IG15X3RfZXhjb2RlMiA9ICcnO1xcXFxuICAgIGlmIChpdGVtLnN0YXRlICE9ICdwdWJsaWMnKSB7XFxcXG4gICAgICAgIG15X3RfZXhjb2RlMSArPSAn44qZ77iPJztcXFxcbiAgICB9IGVsc2Uge1xcXFxuICAgICAgICBteV90X2V4Y29kZTEgKz0gJyc7XFxcXG4gICAgfVxcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBteV90X2V4Y29kZTEgKyBpdGVtLm5hbWUgKyBteV90X2V4Y29kZTIsXFxcXG4gICAgICAgIHVybDogXFxcXFxcXCJoaWtlcjovL3BhZ2UvbWFuYWdlUnVsZSNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFxcXFxcIixcXFxcbiAgICAgICAgZXh0cmE6IHtcXFxcbiAgICAgICAgICAgIGlkOiBpdGVtLmlkLFxcXFxuICAgICAgICAgICAgLy91c2VybmFtZTogdXNlcm5hbWUsXFxcXG4gICAgICAgICAgICAvL3Bhc3N3b3JkOiBwYXNzd29yZFxcXFxuICAgICAgICB9LFxcXFxuICAgICAgICBwaWNfdXJsOiBpdGVtLnBpYyxcXFxcbiAgICB9KVxcXFxufVxcXFxuaWYgKHJ1bGVMaXN0Lmxlbmd0aCA9PT0gMCkge1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBcXFxcXFxcIjxoNSBzdHlsZT0ndGV4dC1hbGlnbjpjZW50ZXInPuW/q+adpeS4iuS8oOS9oOeahOesrOS4gOadoeinhOWImeWQp++8gTwvaDU+XFxcXFxcXCIsXFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInJpY2hfdGV4dFxcXFxcXFwiXFxcXG4gICAgfSk7XFxcXG59XFxcXG5zZXRSZXN1bHQoZGF0YSk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi6KeE5YiZ6K+m57uGLWRldlxcXCIsXFxcInBhdGhcXFwiOlxcXCJtYW5hZ2VSdWxlXFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxuICAgIGNvbnN0IHtcXFxcbiAgICAgICAgZ2V0QXBpLFxcXFxuICAgICAgICBjb2xvcixcXFxcbiAgICAgICAgc21hbGwsXFxcXG4gICAgICAgIGdldEZpbGUsXFxcXG4gICAgICAgIGV4aXN0RmlsZSxcXFxcbiAgICAgICAgbWFwQ29sVHlwZSxcXFxcbiAgICAgICAgaHRtbFRhZyxcXFxcbiAgICAgICAgYXBpLFxcXFxuICAgICAgICBtZCxcXFxcbiAgICB9ID0gJC5yZXF1aXJlKFxcXFxcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXFxcXFwiKTtcXFxcbmxldCB7XFxcXG4gICAgaWRcXFxcbn0gPSBNWV9QQVJBTVM7XFxcXG5sZXQge1xcXFxuICAgIHVzZXJuYW1lLFxcXFxuICAgIHBhc3N3b3JkLFxcXFxufSA9IGdldEZpbGUoKTtcXFxcbmFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKSA9PiB7XFxcXG4gICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcXFxufSkpO1xcXFxubGV0IGRhdGFJdGVtID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldEFwaShcXFxcXFxcImdldGJ5aWRcXFxcXFxcIikgKyBcXFxcXFxcIj9pZD1cXFxcXFxcIiArIGlkKSkucmVzdWx0O1xcXFxuc2V0UGFnZVRpdGxlKFxcXFxcXFwi57yW6L6R44CMXFxcXFxcXCIgKyBkYXRhSXRlbS5uYW1lICsgXFxcXFxcXCLjgI1cXFxcXFxcIik7XFxcXG5sZXQgcmVxQnlHZXQgPSBcXFxcXFxcIj9pZD1cXFxcXFxcIiArIGRhdGFJdGVtLmlkICsgXFxcXFxcXCImcXE9XFxcXFxcXCIgKyB1c2VybmFtZSArIFxcXFxcXFwiJnBhc3N3b3JkPVxcXFxcXFwiICsgcGFzc3dvcmQ7XFxcXG5sZXQgcnVsZUxpc3RKc29uID0gZ2V0QXBpKFxcXFxcXFwicnVsZUxpc3RKc29uXFxcXFxcXCIpICsgXFxcXFxcXCI/aWQ9XFxcXFxcXCI7XFxcXG5sZXQgZGF0YSA9IFtdO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogaHRtbFRhZyhcXFxcXFxcImJpZ1xcXFxcXFwiLCBcXFxcXFxcIueJiOacrFxcXFxcXFwiKSxcXFxcbiAgICBkZXNjOiBcXFxcXFxcIuKAnOKAnOKAneKAneS6keerr+eJiOacrDpcXFxcXFxcIiArIGNvbG9yKGRhdGFJdGVtLnZlciwgXFxcXFxcXCIjNWNmZjJjXFxcXFxcXCIpICsgXFxcXFxcXCJcXFxcXFxcXG7kuIrmrKHmj5DkuqTkuo46IFtcXFxcXFxcIiArIGNvbG9yKGRhdGFJdGVtLmxhc3RfdXBkYXRlLCBcXFxcXFxcIiNmZjcwMDBcXFxcXFxcIikgKyBcXFxcXFxcIl1cXFxcXFxcIixcXFxcbiAgICB1cmw6ICQoXFxcXFxcXCI85byA5Y+R6ICFPlxcXFxcXFxcblxcXFxcXFwiICsgZGF0YUl0ZW0uYXV0aG9yICsgXFxcXFxcXCJcXFxcXFxcXG485ZCN56ewPlxcXFxcXFxcblxcXFxcXFwiICsgZGF0YUl0ZW0ubmFtZSArIFxcXFxcXFwiXFxcXFxcXFxuPOS6keerr+eJiOacrD5cXFxcXFxcXG5cXFxcXFxcIiArIGRhdGFJdGVtLnZlciArIFxcXFxcXFwiXFxcXFxcXFxuPOabtOaWsOaXtumXtD5cXFxcXFxcXG5bXFxcXFxcXCIgKyBkYXRhSXRlbS5sYXN0X3VwZGF0ZSArIFxcXFxcXFwiXVxcXFxcXFwiKS5jb25maXJtKCgpID0+IHt9KSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMSdcXFxcbn0pO1xcXFxubGV0IGRhdGFUeXBlID0ge1xcXFxuICAgIGhvbWVfcnVsZV91cmw6ICfpppbpobXkupHop4TliJknLFxcXFxuICAgIHB1Ymxpc2g6ICfmj5DkuqTkupHku5PlupPop4TliJknLFxcXFxuICAgIGpzX3VybDogJ+e9kemhteaPkuS7tuinhOWImScsXFxcXG4gICAgaHRtbDogJ+mdmeaAgemhtemdoicsXFxcXG4gICAgY29uZmlnOiAn5Li76aG16YWN572uJ1xcXFxufTtcXFxcblxcXFxubGV0IGJhc2ljID0ge1xcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfMVxcXFxcXFwiLFxcXFxuICAgIHVybDogXFxcXFxcXCJoaWtlcjovL2VtcHR5XFxcXFxcXCJcXFxcbn07XFxcXG5sZXQgZGF0YVR5cGVUaXBzID0gZGF0YVR5cGVbZGF0YUl0ZW0uZGF0YV90eXBlXSB8fCAn5pyq55+l6KeE5YiZOicgKyBkYXRhSXRlbS5kYXRhX3R5cGU7XFxcXG5cXFxcbmJhc2ljLnRpdGxlID0gaHRtbFRhZyhcXFxcXFxcImJpZ1xcXFxcXFwiLCBcXFxcXFxcIuexu+Wei1xcXFxcXFwiKSArIFxcXFxcXFwiXFxcXFxcXFx0XFxcXFxcXFx0XFxcXFxcXFx0XFxcXFxcXCIgKyBzbWFsbChcXFxcXFxcIihpZDpcXFxcXFxcIiArIGRhdGFJdGVtLmlkICsgXFxcXFxcXCIpXFxcXFxcXCIpO1xcXFxuYmFzaWMuZGVzYyA9IFxcXFxcXFwi5pWw5o2u57G75Z6L77yaXFxcXFxcXCIgKyBjb2xvcihkYXRhVHlwZVRpcHMsIFxcXFxcXFwiI2NiNTRmZlxcXFxcXFwiKSArIFxcXFxcXFwiXFxcXFxcXFxu5YiG5Lqr54q25oCB5Li677yaXFxcXFxcXCIgKyBkYXRhSXRlbS5zdGF0ZTtcXFxcbmlmIChbXFxcXFxcXCJodG1sXFxcXFxcXCIsIFxcXFxcXFwiY29uZmlnXFxcXFxcXCIsIFxcXFxcXFwianNfdXJsXFxcXFxcXCJdLmluY2x1ZGVzKGRhdGFJdGVtLmRhdGFfdHlwZSkpIHtcXFxcbiAgICBiYXNpYy5kZXNjICs9IFxcXFxcXFwiXFxcXFxcXFxu4oCc4oCc4oCd4oCdID0+XFxcXFxcXCIgKyBzbWFsbChcXFxcXFxcIueCueatpOmihOiniFxcXFxcXFwiKTtcXFxcbiAgICBiYXNpYy51cmwgPSBydWxlTGlzdEpzb24gKyBkYXRhSXRlbS5pZDtcXFxcbn1cXFxcbmxldCBhdXRoID0gXFxcXFxcXCJcXFxcXFxcIjtcXFxcbmlmIChkYXRhSXRlbS5zdGF0ZSA9PSBcXFxcXFxcInByaXZhdGVcXFxcXFxcIikge1xcXFxuICAgIGxldCBhdXRoX2JhY2sgPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXFxcXFwiYXV0aFxcXFxcXFwiKSArIHJlcUJ5R2V0KSk7XFxcXG4gICAgYmFzaWMudGl0bGUgPSBiYXNpYy50aXRsZSArIFxcXFxcXFwiXFxcXFxcXFxuXFxcXFxcXCIgKyBzbWFsbChjb2xvcihhdXRoX2JhY2sucmVzdWx0LCBcXFxcXFxcImdyZXlcXFxcXFxcIikpO1xcXFxuICAgIGF1dGggPSAnJmF1dGg9JyArIGF1dGhfYmFjay5yZXN1bHQ7XFxcXG4gICAgYmFzaWMudXJsID0gYmFzaWMudXJsID09PSBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIiA/IGJhc2ljLnVybCA6IGJhc2ljLnVybCArIGF1dGg7XFxcXG59XFxcXG5kYXRhLnB1c2goYmFzaWMpO1xcXFxubGV0IG5vdGVzID0gcmVxdWVzdChnZXRBcGkoXFxcXFxcXCJnZXRfcnVsZV9ub3RlXFxcXFxcXCIpICsgaWQpO1xcXFxubm90ZXMgPSBKU09OLnBhcnNlKG5vdGVzKS5yZXN1bHQ7XFxcXG5yZXF1aXJlKG1kKTtcXFxcbmxldCBub3Rlc0h0bWw9XFxcXFxcXCJcXFxcXFxcIlxcXFxudHJ5e1xcXFxuICAgIG5vdGVzSHRtbD1tYXJrZWQucGFyc2Uobm90ZXMpO1xcXFxufWNhdGNoKGUpe31cXFxcbmlmIChub3RlcyAhPT0gZmFsc2UpIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogaHRtbFRhZyhcXFxcXFxcImJpZ1xcXFxcXFwiLCBcXFxcXFxcIuWkh+azqFxcXFxcXFwiKSArIFxcXFxcXFwiXFxcXFxcXFx0XFxcXFxcXFx0XFxcXFxcXFx0XFxcXFxcXCIgKyBzbWFsbChodG1sVGFnKFxcXFxcXFwidVxcXFxcXFwiLCBcXFxcXFxcIuafpeeci+WujOaVtOWFrOWRiiA+XFxcXFxcXCIpKSxcXFxcbiAgICAgICAgZGVzYzogbm90ZXMsXFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfMVxcXFxcXFwiLFxcXFxuICAgICAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL2luZm9cXFxcXFxcIixcXFxcbiAgICAgICAgZXh0cmE6IHtcXFxcbiAgICAgICAgICAgIHRleHQ6IG5vdGVzSHRtbCxcXFxcbiAgICAgICAgICAgIG5hbWU6IGRhdGFJdGVtLm5hbWUsXFxcXG4gICAgICAgICAgICAvLyB0eXBlOiBcXFxcXFxcImxvbmdfdGV4dFxcXFxcXFwiXFxcXG4gICAgICAgICAgICB0eXBlOiBcXFxcXFxcInJpY2hfdGV4dFxcXFxcXFwiXFxcXG4gICAgICAgIH1cXFxcbiAgICB9KTtcXFxcbn1cXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IGh0bWxUYWcoXFxcXFxcXCJiaWdcXFxcXFxcIiwgXFxcXFxcXCLmk43kvZxcXFxcXFxcIiksXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8xXFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcInRvYXN0Oi8v5L2g5omN5piv5pyA5biF55qE6YKj5Liq5Lq677yBXFxcXFxcXCJcXFxcbn0pO1xcXFxubGV0IGltcG9ydFVybCwgcnVsZUNvZGUsIHNoYXJlVXJsLCBiYWNrQ29kZSA9IFxcXFxcXFwiXFxcXFxcXCI7XFxcXG5sZXQgc3ViVXJsID0gcnVsZUxpc3RKc29uICsgZGF0YUl0ZW0uaWQgKyBhdXRoO1xcXFxuaWYgKCFkYXRhSXRlbS5pc19qc29uKSB7XFxcXG4gICAgYmFja0NvZGUgPSByZXF1ZXN0KHN1YlVybCk7XFxcXG59XFxcXG5zd2l0Y2ggKGRhdGFJdGVtLmRhdGFfdHlwZSkge1xcXFxuICAgIGNhc2UgXFxcXFxcXCJob21lX3J1bGVfdXJsXFxcXFxcXCI6XFxcXG4gICAgICAgIHJ1bGVDb2RlID0gXFxcXFxcXCLmtbfpmJTop4bnlYzpppbpobXpopHpgZPop4TliJnjgJBcXFxcXFxcIiArIGRhdGFJdGVtLm5hbWUgKyBcXFxcXFxcIuOAke+/pWhvbWVfcnVsZV91cmzvv6VcXFxcXFxcIiArIHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkICsgYXV0aDtcXFxcbiAgICAgICAgaW1wb3J0VXJsID0gXFxcXFxcXCJydWxlOi8vXFxcXFxcXCIgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpXFxcXG4gICAgICAgIGJyZWFrO1xcXFxuICAgIGNhc2UgJ3B1Ymxpc2gnOlxcXFxuICAgICAgICBydWxlQ29kZSA9ICfmtbfpmJTop4bnlYzop4TliJnliIbkuqvvvIzlvZPliY3liIbkuqvnmoTmmK/vvJonICsgZGF0YUl0ZW0ubmFtZSArICfvv6VwdWJsaXNo77+lJyArIGJhc2U2NEVuY29kZShiYWNrQ29kZSk7XFxcXG4gICAgICAgIGltcG9ydFVybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShydWxlQ29kZSk7XFxcXG4gICAgICAgIGJyZWFrO1xcXFxuICAgIGNhc2UgJ2pzX3VybCc6XFxcXG4gICAgICAgIHJ1bGVDb2RlID0gJ+a1t+mYlOinhueVjOinhOWImeWIhuS6q++8jOW9k+WJjeWIhuS6q+eahOaYr++8mue9kemhteaPkuS7tu+/pWpzX3VybO+/pScgKyBkYXRhSXRlbS5uYW1lICsgJ0BiYXNlNjQ6Ly8nICsgYmFzZTY0RW5jb2RlKGJhY2tDb2RlKTtcXFxcbiAgICAgICAgaW1wb3J0VXJsID0gJ3J1bGU6Ly8nICsgYmFzZTY0RW5jb2RlKHJ1bGVDb2RlKTtcXFxcbiAgICAgICAgYnJlYWs7XFxcXG4gICAgY2FzZSAnaHRtbCc6XFxcXG4gICAgICAgIGxldCBmaWxlX3RtcCA9IGRhdGFJdGVtLm5hbWUuc3BsaXQoJy4nKTtcXFxcbiAgICAgICAgbGV0IGZpbGVfcGF0aCA9IGZpbGVfdG1wLmxlbmd0aCA+IDEgPyBmaWxlX3RtcFtmaWxlX3RtcC5sZW5ndGggLSAxXSArIFxcXFxcXFwiL1xcXFxcXFwiICsgZGF0YUl0ZW0ubmFtZSA6IGRhdGFJdGVtLm5hbWU7XFxcXG4gICAgICAgIHJ1bGVDb2RlID0gXFxcXFxcXCLmtbfpmJTop4bnlYzmnKzlnLDmlofku7bliIbkuqvvv6VmaWxlX3VybO+/pWhpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9cXFxcXFxcIiArIGZpbGVfcGF0aCArIFxcXFxcXFwiQFxcXFxcXFwiICsgcnVsZUxpc3RKc29uICsgZGF0YUl0ZW0uaWQgKyBhdXRoO1xcXFxuICAgICAgICBpbXBvcnRVcmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpO1xcXFxuICAgICAgICBicmVha1xcXFxuICAgIGNhc2UgXFxcXFxcXCJjb25maWdcXFxcXFxcIjpcXFxcbiAgICAgICAgaW1wb3J0VXJsID0gJCgpLnJ1bGUocGFzc3dvcmQgPT4ge1xcXFxuICAgICAgICAgICAgZXZhbChmZXRjaChcXFxcXFxcImhpa2VyOi8vYXNzZXRzL2hvbWUuanNcXFxcXFxcIikpO1xcXFxuICAgICAgICAgICAgSGlrZXJIb21lLmxvYWQoXFxcXFxcXCJpbXBvcnRcXFxcXFxcIiwgcGFzc3dvcmQpO1xcXFxuICAgICAgICB9LCBiYWNrQ29kZSk7XFxcXG4gICAgICAgIGJyZWFrO1xcXFxufVxcXFxubGV0IG15X2NvbF90eXBlID0gXFxcXFxcXCJ0ZXh0XzJcXFxcXFxcIjtcXFxcbmlmIChpbXBvcnRVcmwpIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLlr7zlhaXop4TliJlcXFxcXFxcIixcXFxcbiAgICAgICAgdXJsOiBpbXBvcnRVcmwsXFxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcXFxuICAgIH0pO1xcXFxuICAgIGlmKGRhdGFJdGVtLmlzX2pzb25fbGlzdCYmL2hvbWVfcnVsZV91cmx8aHRtbC8udGVzdChkYXRhSXRlbS5kYXRhX3R5cGUpKXtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiAn4oCc4oCc4oCd4oCdPHNwYW4gc3R5bGU9XFxcXFxcXCJjb2xvcjogI2ZmNzAwMFxcXFxcXFwiPuWvvOWFpemBk+W+t+e7jzwvc3Bhbj4nLFxcXFxuICAgICAgICAgICAgdXJsOiAkKCkubGF6eVJ1bGUoKGRhdGFJdGVtLHN1YlVybCk9PntcXFxcbiAgICAgICAgICAgICAgICAvLyBsZXQgdGl0bGUgPSBcXFxcXFxcIkgtXFxcXFxcXCIrZGF0YUl0ZW0ubmFtZStcXFxcXFxcIi5cXFxcXFxcIitkYXRhSXRlbS5hdXRob3I7XFxcXG4gICAgICAgICAgICAgICAgbGV0IHRpdGxlID0gXFxcXFxcXCJKLVxcXFxcXFwiK2RhdGFJdGVtLm5hbWUuc3BsaXQoJy4nKVswXTtcXFxcbiAgICAgICAgICAgICAgICBsZXQgc3ViT2JqID0ge1xcXFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsXFxcXG4gICAgICAgICAgICAgICAgICAgIHVybDogc3ViVXJsLFxcXFxuICAgICAgICAgICAgICAgICAgICBkZXNjOiBcXFxcXFxcImhpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9ydWxlQ2FjaGUvXFxcXFxcXCIrdGl0bGUrXFxcXFxcXCIuanNvblxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgICAgICBjb2RlOiBcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmU6IGZhbHNlLC8v56aB55So5bm25Y+R5pu05pawXFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIGxldCBzaGFyZVRleHQgPSBiYXNlNjRFbmNvZGUoSlNPTi5zdHJpbmdpZnkoc3ViT2JqKSk7XFxcXG4gICAgICAgICAgICAgICAgdmFyIHBhc3RlcyA9IGdldFBhc3RlcygpO1xcXFxuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBzaGFyZVBhc3RlKHNoYXJlVGV4dCxwYXN0ZXMuc2xpY2UoLTEpWzBdKTtcXFxcbiAgICAgICAgICAgICAgICBsZXQgaW1wb3J0X3J1bGU9IFxcXFxcXFwi6L275ZCI6ZuG6K6i6ZiF77yaXFxcXFxcXCIrdGl0bGUrJ1xcXFxcXFxcbicrdXJsO1xcXFxuICAgICAgICAgICAgICAgIGNvcHkoaW1wb3J0X3J1bGUpO1xcXFxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGggPSAnaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlL3J1bGVDYWNoZS9zdWIuanNvbic7XFxcXG4gICAgICAgICAgICAgICAgJC5yYyhjb25maWcubGliLnN1Yik7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIOiuoumYheWvvOWFpShwYXRoKVxcXFxuICAgICAgICAgICAgfSxkYXRhSXRlbSxzdWJVcmwpLFxcXFxuICAgICAgICAgICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxcXG4gICAgICAgIH0pO1xcXFxuICAgIH1cXFxcbn1cXFxcbmlmIChydWxlQ29kZSkge1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBcXFxcXFxcIuWIhuS6q+inhOWImVxcXFxcXFwiLFxcXFxuICAgICAgICB1cmw6IFxcXFxcXFwiY29weTovL1xcXFxcXFwiICsgcnVsZUNvZGUsXFxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcXFxuICAgIH0pO1xcXFxufVxcXFxuXFxcXG5mdW5jdGlvbiBzZXRTZXR0aW5nSXRlbShiYXNpYywgcGF0dGVybikge1xcXFxuICAgIGxldCB0ZW1wID0ge1xcXFxuICAgICAgICB0aXRsZTogYmFzaWMudGl0bGUsXFxcXG4gICAgICAgIGNvbF90eXBlOiBiYXNpYy5jb2xfdHlwZSxcXFxcbiAgICAgICAgdXJsOiAkKGJhc2ljLmNvbmZpcm0pLmNvbmZpcm0oKHVybCwgbXNnLCBwYXR0ZXJuKSA9PiB7XFxcXG4gICAgICAgICAgICBsZXQgYmFja0EgPSByZXF1ZXN0KHVybCk7XFxcXG4gICAgICAgICAgICBsZXQgcmV0ID0gSlNPTi5wYXJzZShiYWNrQSk7XFxcXG4gICAgICAgICAgICBpZiAocmV0LnN0YXR1cyA9PSAwKSB7XFxcXG4gICAgICAgICAgICAgICAgcGF0dGVybiA/IGJhY2soKSA6IHJlZnJlc2hQYWdlKGZhbHNlKTtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL1xcXFxcXFwiICsgbXNnWzBdO1xcXFxuICAgICAgICAgICAgfSBlbHNlIHtcXFxcbiAgICAgICAgICAgICAgICBwYXR0ZXJuID8gYmFjaygpIDogcmVmcmVzaFBhZ2UoZmFsc2UpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vXFxcXFxcXCIgKyBtc2dbMV0gKyBcXFxcXFxcIlxcXFxcXFxcblxcXFxcXFwiICsgcmV0LmRldGFpbDtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfSwgYmFzaWMudXJsLCBiYXNpYy5tc2csIHBhdHRlcm4pXFxcXG4gICAgfTtcXFxcbiAgICByZXR1cm4gdGVtcDtcXFxcbn1cXFxcbmlmIChkYXRhSXRlbS5zdGF0ZSA9PSAncHJpdmF0ZScpIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLorr7kuLrlhazlvIBcXFxcXFxcIixcXFxcbiAgICAgICAgdXJsOiAkKGdldEFwaShcXFxcXFxcInNoYXJlXFxcXFxcXCIpICsgcmVxQnlHZXQgKyBcXFxcXFxcIiZmbGFnXFxcXFxcXCIgKyBcXFxcXFxcIiNub0xvYWRpbmcjXFxcXFxcXCIpLmxhenlSdWxlKCgpID0+IHtcXFxcbiAgICAgICAgICAgIHJlcXVlc3QoaW5wdXQpO1xcXFxuICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcXFxuICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/lt7Lorr7kuLrlhazlvIBcXFxcXFxcIjtcXFxcbiAgICAgICAgfSksXFxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcXFxuICAgIH0sIHtcXFxcbiAgICAgICAgdGl0bGU6IFxcXFxcXFwi6ZqP5py65a+G6ZKlXFxcXFxcXCIsXFxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZSxcXFxcbiAgICAgICAgdXJsOiAkKGdldEFwaShcXFxcXFxcImdlbkF1dGhcXFxcXFxcIikgKyByZXFCeUdldCArIFxcXFxcXFwiI25vTG9hZGluZyNcXFxcXFxcIikubGF6eVJ1bGUoKCkgPT4ge1xcXFxuICAgICAgICAgICAgbGV0IGJhY2sgPSByZXF1ZXN0KGlucHV0KTtcXFxcbiAgICAgICAgICAgIGxldCByZXQgPSBKU09OLnBhcnNlKGJhY2spO1xcXFxuICAgICAgICAgICAgaWYgKHJldC5zdGF0dXMgPT0gMCkge1xcXFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+W3sueUn+aIkOmaj+acuuWvhueggVxcXFxcXFxcblxcXFxcXFwiICsgcmV0LnJlc3VsdFxcXFxuICAgICAgICAgICAgfSBlbHNlIHtcXFxcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+maj+acuuWvhueggeeUn+aIkOWksei0pVxcXFxcXFwiXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH0pXFxcXG4gICAgfSk7XFxcXG4gICAgbGV0IHRpbWVPdmVyID0ge1xcXFxuICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXFxcbiAgICB9O1xcXFxuICAgIGlmIChkYXRhSXRlbS50aW1lX292ZXIpIHtcXFxcbiAgICAgICAgdGltZU92ZXIudGl0bGUgPSBzbWFsbChjb2xvcihcXFxcXFxcIuefreaXtuWvhumSpVxcXFxcXFwiLCBcXFxcXFxcImdyZWVuXFxcXFxcXCIpICsgY29sb3IoXFxcXFxcXCIo4oaS5rC45LmFKVxcXFxcXFwiLCBcXFxcXFxcInJlZFxcXFxcXFwiKSk7XFxcXG4gICAgICAgIHRpbWVPdmVyLnVybCA9IGdldEFwaShcXFxcXFxcInRpbWVvdmVyXFxcXFxcXCIpICsgcmVxQnlHZXQgKyBcXFxcXFxcIiZmbGFnPTFcXFxcXFxcIjtcXFxcbiAgICAgICAgdGltZU92ZXIuY29uZmlybSA9IFxcXFxcXFwi5piv5ZCm56Gu6K6k5Lul5ZCO55qE56eB6JeP6KeE5YiZ5YiG5Lqr5LiN6L+H5pyfP1xcXFxcXFwiO1xcXFxuICAgICAgICB0aW1lT3Zlci5tc2cgPSBbXFxcXFxcXCLlt7Lorr7kuLrmsLjkuYVcXFxcXFxcIiwgXFxcXFxcXCLorr7kuLrmsLjkuYXlpLHotKVcXFxcXFxcIl07XFxcXG4gICAgfSBlbHNlIHtcXFxcbiAgICAgICAgdGltZU92ZXIudGl0bGUgPSBzbWFsbChjb2xvcihcXFxcXFxcIuawuOS5heWvhumSpVxcXFxcXFwiLCBcXFxcXFxcInJlZFxcXFxcXFwiKSArIGNvbG9yKFxcXFxcXFwiKOKGkuefreaXtilcXFxcXFxcIiwgXFxcXFxcXCJncmVlblxcXFxcXFwiKSk7XFxcXG4gICAgICAgIHRpbWVPdmVyLnVybCA9IGdldEFwaShcXFxcXFxcInRpbWVvdmVyXFxcXFxcXCIpICsgcmVxQnlHZXQ7XFxcXG4gICAgICAgIHRpbWVPdmVyLmNvbmZpcm0gPSBcXFxcXFxcIuehruiupOimgeS7peWQjuWIhuS6q+eahOengeiXj+inhOWImeiHquWKqOWIsOacnz9cXFxcXFxcIjtcXFxcbiAgICAgICAgdGltZU92ZXIubXNnID0gW1xcXFxcXFwi5bey6K6+5Li66L+H5pyfXFxcXFxcXCIsIFxcXFxcXFwi6K6+5Li66L+H5pyf5aSx6LSlXFxcXFxcXCJdO1xcXFxuICAgIH1cXFxcbiAgICBkYXRhLnB1c2goc2V0U2V0dGluZ0l0ZW0odGltZU92ZXIpKTtcXFxcbn0gZWxzZSBpZiAoZGF0YUl0ZW0uc3RhdGUgPT0gJ3B1YmxpYycpIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLorr7kuLrnp4HmnIlcXFxcXFxcIixcXFxcbiAgICAgICAgdXJsOiAkKGdldEFwaShcXFxcXFxcInNoYXJlXFxcXFxcXCIpICsgcmVxQnlHZXQgKyBcXFxcXFxcIiZmbGFnPTEjbm9Mb2FkaW5nI1xcXFxcXFwiKS5sYXp5UnVsZSgoKSA9PiB7XFxcXG4gICAgICAgICAgICByZXF1ZXN0KGlucHV0KTtcXFxcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5bey6K6+5Li656eB5pyJXFxcXFxcXCI7XFxcXG4gICAgICAgIH0pLFxcXFxuICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXFxcbiAgICB9KTtcXFxcbn1cXFxcbmRhdGEucHVzaChzZXRTZXR0aW5nSXRlbSh7XFxcXG4gICAgdGl0bGU6IFxcXFxcXFwi5Yig6Zmk5pWw5o2uXFxcXFxcXCIsXFxcXG4gICAgY29uZmlybTogXFxcXFxcXCLmmK/lkKbnoa7orqTliKDpmaRcXFxcXFxcIixcXFxcbiAgICBtc2c6IFtcXFxcXFxcIuW3suWIoOmZpFxcXFxcXFwiLCBcXFxcXFxcIuWIoOmZpOWksei0pVxcXFxcXFwiXSxcXFxcbiAgICB1cmw6IGdldEFwaShcXFxcXFxcImRlbGV0ZVVybFxcXFxcXFwiKSArIHJlcUJ5R2V0LFxcXFxuICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcXFxufSwgdHJ1ZSkpO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogXFxcXFxcXCLorr7nva7lm77moIdcXFxcXFxcIixcXFxcbiAgICB1cmw6ICQoZGF0YUl0ZW0ucGljX3VybCwgXFxcXFxcXCLovpPlhaXlm77moIflnLDlnYBcXFxcXFxcIikuaW5wdXQoYXBpID0+IHtcXFxcbiAgICAgICAgaWYgKGlucHV0ID09PSBcXFxcXFxcIlxcXFxcXFwiKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+S9oOWcqOmAl+aIkemTvuaOpeWTqj9cXFxcXFxcIlxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGFwaSArIFxcXFxcXFwiJnJ1bGVfcGljPVxcXFxcXFwiICsgaW5wdXQpO1xcXFxuICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3VsdCk7XFxcXG4gICAgICAgIGlmIChyZXN1bHQuc3RhdHVzICE9PSAwKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL1xcXFxcXFwiICsgcmVzdWx0LmRldGFpbDtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+S/ruaUueaIkOWKn1xcXFxcXFwiO1xcXFxuICAgIH0sIGdldEFwaShcXFxcXFxcInNldF9ydWxlX3BpY1xcXFxcXFwiKSArIGRhdGFJdGVtLmlkICsgcmVxQnlHZXQpLFxcXFxuICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcXFxufSk7XFxcXG5cXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IGRhdGFJdGVtLmNhbl9kaXNjdXNzID8gXFxcXFxcXCLnpoHmraLor4TorrpcXFxcXFxcIiA6IFxcXFxcXFwi5byA5ZCv6K+E6K66XFxcXFxcXCIsXFxcXG4gICAgdXJsOiAkKGFwaS5kaXNfc2V0ICsgZGF0YUl0ZW0uaWQgKyByZXFCeUdldCArIFxcXFxcXFwiJnN0YXRlPVxcXFxcXFwiICsgKGRhdGFJdGVtLmNhbl9kaXNjdXNzID8gXFxcXFxcXCJcXFxcXFxcIiA6IDEpKS5sYXp5UnVsZSgoY2FuX2Rpc2N1c3MpID0+IHtcXFxcbiAgICAgICAgcmVxdWVzdChpbnB1dCk7XFxcXG4gICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXFxcbiAgICAgICAgcmV0dXJuIGNhbl9kaXNjdXNzID8gXFxcXFxcXCJ0b2FzdDovL+W3suemgeatouivhOiuulxcXFxcXFwiIDogXFxcXFxcXCJ0b2FzdDovL+W3suW8gOWQr+ivhOiuulxcXFxcXFwiO1xcXFxuICAgIH0sIGRhdGFJdGVtLmNhbl9kaXNjdXNzKSxcXFxcbiAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXFxcbn0pO1xcXFxuTVlfUEFSQU1TLm5hbWUgPSBkYXRhSXRlbS5uYW1lO1xcXFxuTVlfUEFSQU1TLnVzZXJuYW1lPXVzZXJuYW1lO1xcXFxuTVlfUEFSQU1TLnBhc3N3b3JkPXBhc3N3b3JkO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogXFxcXFxcXCLorr7nva7lpIfms6hcXFxcXFxcIixcXFxcbiAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL3NldF9ydWxlX25vdGVzXFxcXFxcXCIsXFxcXG4gICAgZXh0cmE6IE1ZX1BBUkFNUyxcXFxcbiAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXFxcbn0pO1xcXFxuaWYgKGRhdGFJdGVtLmlzX2pzb24gJiYgZGF0YUl0ZW0uZGF0YV90eXBlID09PSBcXFxcXFxcImhvbWVfcnVsZV91cmxcXFxcXFxcIiAmJiAhZGF0YUl0ZW0uaXNfanNvbl9saXN0KSB7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6ICfov5vlhaXpopHpgZMnLFxcXFxuICAgICAgICB1cmw6ICQoIC8qXFxcXFxcXCIjbm9Mb2FkaW5nI1xcXFxcXFwiKi8gKS5sYXp5UnVsZSgobmFtZSxob21lKSA9PiB7XFxcXG4gICAgICAgICAgICBsZXQgcnVsZUxpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoaG9tZSkpO1xcXFxuICAgICAgICAgICAgbGV0IGhhc1J1bGUgPSBydWxlTGlzdC5zb21lKGl0ZW0gPT4gaXRlbS50aXRsZSA9PT0gbmFtZSk7XFxcXG4gICAgICAgICAgICBpZiAoaGFzUnVsZSkge1xcXFxuICAgICAgICAgICAgICAgIHB1dFZhcihcXFxcXFxcIldhcmVob3VzZS5iYWNrXFxcXFxcXCIsIFxcXFxcXFwiMVxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgICAgICBiYWNrKCk7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvbWUrXFxcXFxcXCJzQFxcXFxcXFwiICsgbmFtZTtcXFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/mnKrlronoo4VcXFxcXFxcIjtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfSwgZGF0YUl0ZW0ubmFtZSxhcGkuaG9tZSksXFxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcXFxuICAgIH0pO1xcXFxufVxcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCJcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogZGF0YUl0ZW0uZ29vZF9udW0sXFxcXG4gICAgcGljX3VybDogXFxcXFxcXCJoaWtlcjovL2ZpbGVzL2ljb24v6LWeLnN2Z1xcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcImljb25fc21hbGxfM1xcXFxcXFwiLFxcXFxuICAgIHVybDogXFxcXFxcXCJoaWtlcjovL2VtcHR5XFxcXFxcXCJcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogZGF0YUl0ZW0uYmFkX251bSxcXFxcbiAgICBwaWNfdXJsOiBcXFxcXFxcImhpa2VyOi8vZmlsZXMvaWNvbi/ouKkuc3ZnXFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwiaWNvbl9zbWFsbF8zXFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIlxcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBcXFxcXFxcIuivhOiuulxcXFxcXFwiLFxcXFxuICAgIHBpY191cmw6IFxcXFxcXFwiaGlrZXI6Ly9maWxlcy9pY29uL+ivhOiuui5zdmdcXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJpY29uX3NtYWxsXzNcXFxcXFxcIixcXFxcbiAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL1JlcGx5I25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXFxcXFwiLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIHJ1bGVJZDogZGF0YUl0ZW0uaWQsXFxcXG4gICAgICAgIG5hbWU6IGRhdGFJdGVtLmF1dGhvcixcXFxcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkLFxcXFxuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWVcXFxcbiAgICB9XFxcXG59KTtcXFxcbmxldCB0b3RhbFN1bSA9IGRhdGFJdGVtLmdvb2RfbnVtICsgZGF0YUl0ZW0uYmFkX251bTtcXFxcblxcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogaHRtbFRhZyhcXFxcXFxcImJpZ1xcXFxcXFwiLCBcXFxcXFxcIuivhOiuuihcXFxcXFxcIiArIHRvdGFsU3VtICsgXFxcXFxcXCIpXFxcXFxcXCIpICsgXFxcXFxcXCJcXFxcXFxcXHRcXFxcXFxcXHRcXFxcXFxcXHRcXFxcXFxcIiArIHNtYWxsKGh0bWxUYWcoXFxcXFxcXCJ1XFxcXFxcXCIsIFxcXFxcXFwi5p+l55yL5YWo6YOo6K+E6K66KOaOp+ivhCkgPlxcXFxcXFwiKSksXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8xXFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9Db21tZW50XFxcXFxcXCIsXFxcXG4gICAgZXh0cmE6IHtcXFxcbiAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vZW1wdHkjZnlwYWdlI25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXFxcXFwiLFxcXFxuICAgICAgICBpZDogZGF0YUl0ZW0uaWQsXFxcXG4gICAgICAgIHRvdGFsU3VtOiB0b3RhbFN1bSxcXFxcbiAgICAgICAgbm9fYWN0aXZlOiB0cnVlLFxcXFxuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXFxcXG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxcXFxuICAgIH1cXFxcbn0pO1xcXFxuLy9jb25zdCBsb25nZXN0U3VtPTEyMDtcXFxcbmxldCBpY29uID0ge1xcXFxuICAgIFxcXFxcXFwiZ29vZFxcXFxcXFwiOiBcXFxcXFxcIvCfkY1cXFxcXFxcIixcXFxcbiAgICBcXFxcXFxcImJhZFxcXFxcXFwiOiBcXFxcXFxcIvCfkY5cXFxcXFxcIixcXFxcbiAgICBcXFxcXFxcInJlcGx5XFxcXFxcXCI6IFxcXFxcXFwi5byA5Y+R6ICF8J+Xo1xcXFxcXFwiXFxcXG59XFxcXG5pZiAodG90YWxTdW0gPT09IDApIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCI8aDUgc3R5bGU9J3RleHQtYWxpZ246Y2VudGVyJz7kuIDmnaHor4TorrrkuZ/msqHmnInvvIzlv6vmnaXmiqLmspnlj5HlkKfvvIE8L2g1PlxcXFxcXFwiLFxcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJyaWNoX3RleHRcXFxcXFxcIlxcXFxuICAgIH0pO1xcXFxufSBlbHNlIHtcXFxcbiAgICBsZXQgY29tbWVudExpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoYXBpLmRpc19nZXQgKyBkYXRhSXRlbS5pZCArIFxcXFxcXFwiP2xpbWl0PTVcXFxcXFxcIikpLnJlc3VsdDtcXFxcbiAgICBmb3IgKGxldCBpdGVtIG9mIGNvbW1lbnRMaXN0KSB7XFxcXG4gICAgICAgIGxldCBSZXBseSA9IGl0ZW0uZGlzY3Vzc190eXBlPT09XFxcXFxcXCJyZXBseVxcXFxcXFwiJiZpdGVtLnJlcGx5X3RvX25hbWUhPT1mYWxzZSYmaXRlbS5yZXBseV90b19pZCE9PWZhbHNlP1xcXFxcXFwi4oCY4oCY5Zue5aSNQFxcXFxcXFwiK2l0ZW0ucmVwbHlfdG9fbmFtZStcXFxcXFxcIiAjXFxcXFxcXCIraXRlbS5kaXNjdXNzX2lkK1xcXFxcXFwi4oCZ4oCZXFxcXFxcXFxuXFxcXFxcXCI6XFxcXFxcXCJcXFxcXFxcIjtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLm5hbWUgKyBcXFxcXFxcIiZuYnNwOyZuYnNwOzxmb250IGNvbG9yPSdncmF5Jz48c21hbGw+I1xcXFxcXFwiICsgaXRlbS5pZCArIFxcXFxcXFwiPC9zbWFsbD48Zm9udD5cXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcImF2YXRhclxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9SZXBseVxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgZXh0cmE6e1xcXFxuICAgICAgICAgICAgICAgIHJ1bGVJZDogZGF0YUl0ZW0uaWQsXFxcXG4gICAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxcXFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCxcXFxcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXFxcXG4gICAgICAgICAgICAgICAgcmVwbHlJZDppdGVtLmlkXFxcXG4gICAgICAgICAgICB9LFxcXFxuICAgICAgICAgICAgcGljX3VybDogaXRlbS5hdmF0YXJfdXJsXFxcXG4gICAgICAgIH0pO1xcXFxuICAgICAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW0uZGlzY3Vzc190ZXh0LFxcXFxuICAgICAgICAgICAgZGVzYzogUmVwbHkraXRlbS5jcmVhdGVfZGF0ZSArIFxcXFxcXFwiwrdcXFxcXFxcIiArIGljb25baXRlbS5kaXNjdXNzX3R5cGVdLFxcXFxuICAgICAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8xXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL2luZm9cXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGV4dHJhOiB7XFxcXG4gICAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxcXFxuICAgICAgICAgICAgICAgIHR5cGU6IFxcXFxcXFwibG9uZ190ZXh0XFxcXFxcXCIsXFxcXG4gICAgICAgICAgICAgICAgdGV4dDogaXRlbS5kaXNjdXNzX3RleHRcXFxcbiAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICBwaWNfdXJsOiBpdGVtLmF2YXRhcl91cmxcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgfVxcXFxufVxcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCJcXFxcbn0pO1xcXFxuc2V0UmVzdWx0KGRhdGEpO1xcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJpY29uXzJfcm91bmRcXFwiLFxcXCJuYW1lXFxcIjpcXFwi6KeE5YiZ5YiX6KGoXFxcIixcXFwicGF0aFxcXCI6XFxcInJ1bGVzXFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxuICAgIGFkZExpc3RlbmVyKCdvbkNsb3NlJywkLnRvU3RyaW5nKCgpPT57XFxcXG4gICAgICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLmJhY2tcXFxcXFxcIik7XFxcXG4gICAgICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLmZpbHRlclxcXFxcXFwiKTtcXFxcbiAgICAgICAgY2xlYXJWYXIoXFxcXFxcXCJXYXJlaG91c2UudHlwZVxcXFxcXFwiKTtcXFxcbiAgICAgICAgaWYoZ2V0VmFyKCdXYXJlaG91c2UuY2FuX3VwbG9hZCcsJycpKXtcXFxcbiAgICAgICAgICAgIGxvZygn5pON5L2c6L+H56aB5q2i5LiK5LygOicrZ2V0VmFyKCdXYXJlaG91c2UuY2FuX3VwbG9hZCcpKTtcXFxcbiAgICAgICAgICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLmNhbl91cGxvYWRcXFxcXFxcIik7XFxcXG4gICAgICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXFxcbiAgICAgICAgfVxcXFxuICAgIH0pKTtcXFxcblxcXFxuaWYgKGdldFZhcihcXFxcXFxcIldhcmVob3VzZS5iYWNrXFxcXFxcXCIpID09PSBcXFxcXFxcIjFcXFxcXFxcIikge1xcXFxuICAgIGJhY2soZmFsc2UpO1xcXFxufVxcXFxuXFxcXG5jb25zdCB7XFxcXG4gICAgZ2V0QXBpLFxcXFxuICAgIGFwaSxcXFxcbiAgICBjb2xvcixcXFxcbiAgICBzbWFsbCxcXFxcbiAgICBsb2NhbFJ1bGVWZXIsXFxcXG4gICAgaHRtbFRhZyxcXFxcbiAgICBtZFxcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG5jb25zdCB7IG5vcm1hbFNvcnQgfSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS9zb3J0XFxcXFxcXCIpO1xcXFxubGV0IHtcXFxcbiAgICBhdmF0YXJVcmwsXFxcXG4gICAgcXEsXFxcXG4gICAgaWQsXFxcXG4gICAgY2FuX3VwbG9hZFxcXFxufSA9IE1ZX1BBUkFNUztcXFxcbmxldCBkYXRhVHlwZSA9IGdldFZhcihcXFxcXFxcIldhcmVob3VzZS50eXBlXFxcXFxcXCIsXFxcXFxcXCJcXFxcXFxcIik7XFxcXG5sZXQgYmFja0NvZGUgPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXFxcXFwicnVsZXNVcmxcXFxcXFxcIikgKyBcXFxcXFxcIj9uYW1lPVxcXFxcXFwiICsgcXErXFxcXFxcXCImZGF0YV90eXBlPVxcXFxcXFwiK2RhdGFUeXBlKSk7XFxcXG5sZXQgZGV2TmFtZSA9IGJhY2tDb2RlLmRldl9uYW1lO1xcXFxucHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmZpbHRlclxcXFxcXFwiLCBkZXZOYW1lKTtcXFxcbmxldCBydWxlTGlzdCA9IGJhY2tDb2RlLnJlc3VsdDtcXFxcbmxldCBzdWJVcmwgPSBnZXRBcGkoXFxcXFxcXCJqc29uTGlzdFxcXFxcXFwiKSArIFxcXFxcXFwiP25hbWU9XFxcXFxcXCIgKyBxcTtcXFxcbmxldCBoYXNTdWIgPSBoYXNIb21lU3ViKHN1YlVybCk7XFxcXG5sZXQgZGV2SW5mbyA9IFxcXFxcXFwi6L+Z5Liq5Lq65b6I5oeSLOS7gOS5iOmDveayoeWGmeWTpn5cXFxcXFxcIjtcXFxcbmxldCB0bXBKc29uID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldEFwaShcXFxcXFxcImluZm9HZXRVcmxcXFxcXFxcIikgKyBxcSkpO1xcXFxuaWYgKHRtcEpzb24uc3RhdHVzID09IDApIHtcXFxcbiAgICBkZXZJbmZvID0gdG1wSnNvbi5yZXN1bHQgfHwgZGV2SW5mbztcXFxcbn1cXFxcbmxldCBzdWJGbGFnID0gaGFzU3ViID8gJ/CfhpcnIDogJ/Cfk6EnO1xcXFxubGV0IGRhdGEgPSBbXTtcXFxcbnJlcXVpcmUobWQpO1xcXFxuZGV2SW5mbz1tYXJrZWQucGFyc2UoZGV2SW5mbyk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBcXFxcXFxcIuKAnOKAnOKAneKAnVxcXFxcXFwiICsgZGV2TmFtZSArIFxcXFxcXFwiXFxcXFxcXFxuXFxcXFxcXFxuXFxcXFxcXCIgKyBzbWFsbChodG1sVGFnKFxcXFxcXFwidVxcXFxcXFwiLCBcXFxcXFxcIueCueWHu+afpeeci+WujOaVtOWFrOWRilxcXFxcXFwiKSksXFxcXG4gICAgZGVzYzogc21hbGwoZGV2SW5mbyksXFxcXG4gICAgdXJsOiAnaGlrZXI6Ly9wYWdlL2luZm8nLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIHRleHQ6IGRldkluZm8sXFxcXG4gICAgICAgIG5hbWU6IGRldk5hbWUsXFxcXG4gICAgICAgIHR5cGU6XFxcXFxcXCJyaWNoX3RleHRcXFxcXFxcIlxcXFxuICAgIH0sXFxcXG4gICAgcGljX3VybDogYXZhdGFyVXJsLFxcXFxuICAgIGNvbF90eXBlOiAnbW92aWVfMV92ZXJ0aWNhbF9waWMnXFxcXG59KTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IFxcXFxcXFwiPGJpZz7orqLpmIXnrqHnkIY8L2JpZz4mbmJzcDsmbmJzcDs8c21hbGw+KOW9k+WJjVxcXFxcXFwiICsgKGhhc1N1YiA/IFxcXFxcXFwi5bey6K6i6ZiFXFxcXFxcXCIgOiBcXFxcXFxcIuacquiuoumYhVxcXFxcXFwiKSArIFxcXFxcXFwiKTwvc21hbGw+XFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwicmljaF90ZXh0XFxcXFxcXCJcXFxcbn0pO1xcXFxuXFxcXG5sZXQgc3ViX2NvZGUgPSAn5rW36ZiU6KeG55WM5ZCI6ZuG6KeE5YiZ6K6i6ZiF77+laG9tZV9zdWLvv6UnICsgZGV2TmFtZSArIFxcXFxcXFwi5ZCI6ZuGQEBcXFxcXFxcIiArIHN1YlVybDtcXFxcbmxldCBydWxlc0NvZGUgPSAn5rW36ZiU6KeG55WM5ZCI6ZuG6KeE5YiZ77+laG9tZV9ydWxlX3VybO+/pScgKyBzdWJVcmw7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiAn4oCc4oCc4oCd4oCdPHNwYW4gc3R5bGU9XFxcXFxcXCJjb2xvcjogI2ZmNzAwMFxcXFxcXFwiPuS4gOmUruiuoumYhTwvc3Bhbj4nLFxcXFxuICAgIGRlc2M6ICforqLpmIXigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFxcXFxcImNvbG9yOiAjNWNmZjJjXFxcXFxcXCI+JyArIGRldk5hbWUgKyAnPC9zcGFuPueahOaJgOacieWNleinhOWIme+8jOWQiOmbhumcgOWNleeLrOiuoumYhScsXFxcXG4gICAgdXJsOiBzdWJfY29kZSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogJ+KAnOKAnOKAneKAnTxzcGFuIHN0eWxlPVxcXFxcXFwiY29sb3I6ICNmZjcwMDBcXFxcXFxcIj7lr7zlhaXlhajpg6g8L3NwYW4+JyxcXFxcbiAgICB1cmw6IHJ1bGVzQ29kZSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogJ+KAnOKAnOKAneKAnTxzcGFuIHN0eWxlPVxcXFxcXFwiY29sb3I6ICNmZjcwMDBcXFxcXFxcIj7lr7zlhaXovbvlkIjpm4Y8L3NwYW4+JyxcXFxcbiAgICB1cmw6ICQoKS5sYXp5UnVsZSgoZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKT0+e1xcXFxuICAgICAgICBjb25zdCB7Z2VuUnVsZX09JC5yZXF1aXJlKFxcXFxcXFwiaGlrZXI6Ly9wYWdlL2dlbkFwaVxcXFxcXFwiKTtcXFxcbiAgICAgICAgbG9nKFxcXFxcXFwi6L275ZCI6ZuG5Zu+5qCH6ZO+5o6lOlxcXFxcXFwiK2F2YXRhclVybCk7XFxcXG4gICAgICAgIGxldCBpbXBvcnRfcnVsZT1nZW5SdWxlKFxcXFxcXFwi6L275ZCI6ZuGLlxcXFxcXFwiK2Rldk5hbWUsc3ViVXJsLGF2YXRhclVybCk7XFxcXG4gICAgICAgIC8vY29weShpbXBvcnRfcnVsZSk7XFxcXG4gICAgICAgIGxldCBydWxlQ29kZT1wYXJzZVBhc3RlKGltcG9ydF9ydWxlLnNwbGl0KFxcXFxcXFwiXFxcXFxcXFxuXFxcXFxcXCIpWzBdKTtcXFxcbiAgICAgICAgLy9yZXR1cm4gXFxcXFxcXCJoaWtlcjovL2VtcHR5XFxcXFxcXCJcXFxcbiAgICAgICAgaW1wb3J0VXJsID0gJ3J1bGU6Ly8nICsgYmFzZTY0RW5jb2RlKHJ1bGVDb2RlKTtcXFxcbiAgICAgICAgcmV0dXJuIGltcG9ydFVybFxcXFxuICAgIH0sZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogJ+KAnOKAnOKAneKAnTxzcGFuIHN0eWxlPVxcXFxcXFwiY29sb3I6ICNmZjcwMDBcXFxcXFxcIj7lr7zlhaXpgZPlvrfnu488L3NwYW4+JyxcXFxcbiAgICB1cmw6ICQoKS5sYXp5UnVsZSgoZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKT0+e1xcXFxuICAgICAgICBsZXQgdGl0bGUgPSBcXFxcXFxcIkgtXFxcXFxcXCIrZGV2TmFtZTtcXFxcbiAgICAgICAgbGV0IHN1Yk9iaiA9IHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcXFxcbiAgICAgICAgICAgIHVybDogc3ViVXJsLFxcXFxuICAgICAgICAgICAgZGVzYzogXFxcXFxcXCJoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvcnVsZUNhY2hlL1xcXFxcXFwiK3RpdGxlK1xcXFxcXFwiLmpzb25cXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGNvZGU6IFxcXFxcXFwiXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICBhY3RpdmU6IGZhbHNlLC8v56aB55So5bm25Y+R5pu05pawXFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgbGV0IHNoYXJlVGV4dCA9IGJhc2U2NEVuY29kZShKU09OLnN0cmluZ2lmeShzdWJPYmopKTtcXFxcbiAgICAgICAgdmFyIHBhc3RlcyA9IGdldFBhc3RlcygpO1xcXFxuICAgICAgICB2YXIgdXJsID0gc2hhcmVQYXN0ZShzaGFyZVRleHQscGFzdGVzLnNsaWNlKC0xKVswXSk7XFxcXG4gICAgICAgIGxldCBpbXBvcnRfcnVsZT0gXFxcXFxcXCLovbvlkIjpm4borqLpmIXvvJpcXFxcXFxcIit0aXRsZSsnXFxcXFxcXFxuJyt1cmw7XFxcXG4gICAgICAgIGNvcHkoaW1wb3J0X3J1bGUpO1xcXFxuICAgICAgICBjb25zdCBwYXRoID0gJ2hpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9ydWxlQ2FjaGUvc3ViLmpzb24nO1xcXFxuICAgICAgICAkLnJjKGNvbmZpZy5saWIuc3ViKTtcXFxcbiAgICAgICAgcmV0dXJuIOiuoumYheWvvOWFpShwYXRoKVxcXFxuICAgIH0sZGV2TmFtZSxzdWJVcmwsYXZhdGFyVXJsKSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcXFxcbn0pO1xcXFxubGV0IGNhbl91cGxvYWRfYXBpID0gZ2V0QXBpKFxcXFxcXFwibWFuQ2FuVXBsb2FkXFxcXFxcXCIpK2lkO1xcXFxuaWYoZ2V0VmFyKCdob3VzZS5pc19tYW5hZ2VyJykpe1xcXFxuICAgIGxldCB0aXBzID0gY2FuX3VwbG9hZD8n6IO9Jzon5ZCmJztcXFxcbiAgICAvLyBsb2coJ3RpcHM6Jyt0aXBzKTtcXFxcbiAgICAvLyBsb2coJ2Nhbl91cGxvYWQ6JytjYW5fdXBsb2FkKTtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTon4pqg6IO95ZCm5LiK5LygOicrKGdldFZhcignV2FyZWhvdXNlLmNhbl91cGxvYWQnKXx8dGlwcyksXFxcXG4gICAgICAgIGNvbF90eXBlOidzY3JvbGxfYnV0dG9uJyxcXFxcbiAgICAgICAgdXJsOidoaWtlcjovL2VtcHR5J1xcXFxuICAgIH0pO1xcXFxuICAgIGZ1bmN0aW9uIHNldFVwbG9hZChmbGFnLGNhbl91cGxvYWRfYXBpKSB7XFxcXG4gICAgICAgIGZsYWcgPSBmbGFnIHx8ICcnO1xcXFxuICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgbGV0IGNvZGUgPSBmZXRjaChjYW5fdXBsb2FkX2FwaSwge1xcXFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcXFxcXFxcIlVzZXItQWdlbnRcXFxcXFxcIjogTU9CSUxFX1VBfSxcXFxcbiAgICAgICAgICAgICAgICBib2R5OiB7XFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwicGFyYW1zXFxcXFxcXCI6XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJ1c2VybmFtZVxcXFxcXFwiOiBnZXRWYXIoJ2hvdXNlLnVzZXJuYW1lJyksXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJwYXNzd29yZFxcXFxcXFwiOiBnZXRWYXIoJ2hvdXNlLnBhc3N3b3JkJyksXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJjYW5fdXBsb2FkXFxcXFxcXCI6ICEhZmxhZ1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH0pO1xcXFxuICAgICAgICAgICAgY29kZSA9IEpTT04ucGFyc2UoY29kZSkucmVzdWx0O1xcXFxuICAgICAgICAgICAgaWYgKGNvZGUuc3RhdHVzID09PSAwKSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvZGUuZGV0YWlsXFxcXG4gICAgICAgICAgICB9IGVsc2Uge1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiAn5pON5L2c5aSx6LSlOicgKyBjb2RlLmRldGFpbFxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9IGNhdGNoIChlKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gJ+aTjeS9nOWksei0pTonICsgZS5tZXNzYWdlXFxcXG4gICAgICAgIH1cXFxcbiAgICB9XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6J/CfmqvnpoHmraLkuIrkvKAnLFxcXFxuICAgICAgICBjb2xfdHlwZTonc2Nyb2xsX2J1dHRvbicsXFxcXG4gICAgICAgIHVybDokKCfnpoHmraLor6XlvIDlj5HogIXkuIrkvKDop4TliJk/5L2g55qE5pON5L2c5bCG6KKr57O757uf6K6w5b2VJykuY29uZmlybSgoaWQsY2FuX3VwbG9hZF9hcGksc2V0VXBsb2FkKT0+e1xcXFxuICAgICAgICAgICAgbGV0IHJldCA9IHNldFVwbG9hZChmYWxzZSxjYW5fdXBsb2FkX2FwaSk7XFxcXG4gICAgICAgICAgICBpZighL+aTjeS9nOWksei0pS8udGVzdChyZXQpKXtcXFxcbiAgICAgICAgICAgICAgICBwdXRWYXIoJ1dhcmVob3VzZS5jYW5fdXBsb2FkJywn5ZCmJyk7XFxcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovLycrcmV0XFxcXG4gICAgICAgIH0saWQsY2FuX3VwbG9hZF9hcGksc2V0VXBsb2FkKVxcXFxuICAgIH0pO1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOifinIXlhYHorrjkuIrkvKAnLFxcXFxuICAgICAgICBjb2xfdHlwZTonc2Nyb2xsX2J1dHRvbicsXFxcXG4gICAgICAgIHVybDokKCflhYHorrjor6XlvIDlj5HogIXkuIrkvKDop4TliJk/5L2g55qE5pON5L2c5bCG6KKr57O757uf6K6w5b2VJykuY29uZmlybSgoaWQsY2FuX3VwbG9hZF9hcGksc2V0VXBsb2FkKT0+e1xcXFxuICAgICAgICAgICAgbGV0IHJldCA9IHNldFVwbG9hZCh0cnVlLGNhbl91cGxvYWRfYXBpKTtcXFxcbiAgICAgICAgICAgIGlmKCEv5pON5L2c5aSx6LSlLy50ZXN0KHJldCkpe1xcXFxuICAgICAgICAgICAgICAgIHB1dFZhcignV2FyZWhvdXNlLmNhbl91cGxvYWQnLCfmmK8nKTtcXFxcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8vJytyZXRcXFxcbiAgICAgICAgfSxpZCxjYW5fdXBsb2FkX2FwaSxzZXRVcGxvYWQpXFxcXG4gICAgfSk7XFxcXG59XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBcXFxcXFxcIjxzbWFsbD7mj5DnpLrvvJrlvIDlj5HogIXljZXni6zliIbkuqvnmoTlkIjpm4bmlofku7blj6rog73ljZXni6zlr7zlhaXjgII8L3NtYWxsPlxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcInJpY2hfdGV4dFxcXFxcXFwiXFxcXG59KTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IFxcXFxcXFwiPGJpZz7op4TliJnliJfooag8L2JpZz4mbmJzcDsmbmJzcDs8c21hbGw+KOWFsVxcXFxcXFwiICsgcnVsZUxpc3QubGVuZ3RoICsgXFxcXFxcXCLmnaEpPC9zbWFsbD5cXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJyaWNoX3RleHRcXFxcXFxcIlxcXFxufSk7XFxcXG5sZXQgZGF0YVR5cGVMaXN0ID0ge1xcXFxuICAgIFxcXFxcXFwiXFxcXFxcXCI6XFxcXFxcXCLlhajpg6hcXFxcXFxcIixcXFxcbiAgICBcXFxcXFxcImhvbWVfcnVsZV91cmxcXFxcXFxcIjogJ+Wwj+eoi+W6jycsXFxcXG4gICAgLy9cXFxcXFxcInB1Ymxpc2hcXFxcXFxcIjogJ+aPkOS6pOS6keS7k+W6k+inhOWImScsXFxcXG4gICAgXFxcXFxcXCJqc191cmxcXFxcXFxcIjogJ+e9kemhteaPkuS7ticsXFxcXG4gICAgXFxcXFxcXCJodG1sXFxcXFxcXCI6ICfpnZnmgIHpobXpnaInLFxcXFxuICAgIFxcXFxcXFwiY29uZmlnXFxcXFxcXCI6ICfkuLvpopgnXFxcXG59O1xcXFxuZm9yKGxldCBrZXkgaW4gZGF0YVR5cGVMaXN0KXtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTpkYXRhVHlwZT09PWtleT9cXFxcXFxcIuKAnOKAnFxcXFxcXFwiK2RhdGFUeXBlTGlzdFtrZXldK1xcXFxcXFwi4oCd4oCdXFxcXFxcXCI6ZGF0YVR5cGVMaXN0W2tleV0sXFxcXG4gICAgICAgIHVybDokKFxcXFxcXFwiI25vTG9hZGluZyNcXFxcXFxcIikubGF6eVJ1bGUoKGtleSk9PntcXFxcbiAgICAgICAgICAgIHB1dFZhcihcXFxcXFxcIldhcmVob3VzZS50eXBlXFxcXFxcXCIsa2V5KTtcXFxcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIjtcXFxcbiAgICAgICAgfSxrZXkpLFxcXFxuICAgICAgICBjb2xfdHlwZTpcXFxcXFxcInNjcm9sbF9idXR0b25cXFxcXFxcIlxcXFxuICAgIH0pO1xcXFxufVxcXFxuaWYgKHJ1bGVMaXN0Lmxlbmd0aCA+IDIwKSB7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IFxcXFxcXFwi5pCc57SiXFxcXFxcXCIsXFxcXG4gICAgICAgIHVybDogJC50b1N0cmluZyhuYW1lID0+IFxcXFxcXFwiaGlrZXI6Ly9zZWFyY2g/cz1cXFxcXFxcIiArIGlucHV0ICsgXFxcXFxcXCImcnVsZT1cXFxcXFxcIiArIG5hbWUsIE1ZX1JVTEUudGl0bGUpLFxcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJpbnB1dFxcXFxcXFwiLFxcXFxuICAgICAgICBkZXNjOiBcXFxcXFxcIuaQnOe0ouW9k+WJjeW8gOWPkeiAheeahOinhOWImVxcXFxcXFwiXFxcXG4gICAgfSk7XFxcXG59XFxcXG5sZXQgaG9tZUxpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoYXBpLmhvbWUpKTtcXFxcbmxldCBtUnVsZUxpc3QgPSBbXTtcXFxcbmZvciAodmFyIGl0ZW0gb2YgcnVsZUxpc3QpIHtcXFxcbiAgICB2YXIgbmFtZSA9IGl0ZW0ubmFtZTtcXFxcbiAgICBpZiAoaXRlbS5pc190YXApIHtcXFxcbiAgICAgICAgbGV0IGxvY2F0aW9uID0gSlNPTi5wYXJzZShyZXF1ZXN0KGdldEFwaShcXFxcXFxcInJ1bGVMaXN0SnNvblxcXFxcXFwiKSArIFxcXFxcXFwiP2lkPVxcXFxcXFwiICsgaXRlbS5pZCkpO1xcXFxuICAgICAgICBpdGVtLmlkID0gbG9jYXRpb24uaWQ7XFxcXG4gICAgICAgIGl0ZW0ubmFtZSA9IGxvY2F0aW9uLm5hbWU7XFxcXG4gICAgICAgIGl0ZW0uYXV0aG9yID0gbG9jYXRpb24uYXV0aG9yO1xcXFxuICAgICAgICBpdGVtLmRhdGFfdHlwZSA9IGxvY2F0aW9uLmRhdGFfdHlwZTtcXFxcbiAgICAgICAgaXRlbS52ZXIgPSBsb2NhdGlvbi52ZXJcXFxcbiAgICB9XFxcXG4gICAgaXRlbS52ZXJzaW9uID0gaXRlbS52ZXI7XFxcXG4gICAgbGV0IGxhYmVsID0gXFxcXFxcXCJcXFxcXFxcIixcXFxcbiAgICAgICAgbHZlciA9IC0yO1xcXFxuICAgIGlmIChpdGVtLmlzX2pzb24gJiYgaXRlbS5kYXRhX3R5cGUgPT09IFxcXFxcXFwiaG9tZV9ydWxlX3VybFxcXFxcXFwiKSB7XFxcXG4gICAgICAgIGx2ZXIgPSBsb2NhbFJ1bGVWZXIoaG9tZUxpc3QsIGl0ZW0pO1xcXFxuICAgICAgICBpZiAobHZlciA9PT0gLTEpIHtcXFxcbiAgICAgICAgICAgIGxhYmVsID0gXFxcXFxcXCLwn4aVXFxcXFxcXCI7XFxcXG4gICAgICAgIH0gZWxzZSBpZiAobHZlciA8IGl0ZW0udmVyKSB7XFxcXG4gICAgICAgICAgICBsYWJlbCA9IFxcXFxcXFwi8J+GmVxcXFxcXFwiO1xcXFxuICAgICAgICB9XFxcXG4gICAgfVxcXFxuICAgIG1SdWxlTGlzdC5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IGxhYmVsICsgbmFtZSxcXFxcbiAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9ydWxlRGV0YWlsI25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXFxcXFwiLFxcXFxuICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgbHZlcjogbHZlcixcXFxcbiAgICAgICAgICAgIGlkOiBpdGVtLmlkXFxcXG4gICAgICAgIH0sXFxcXG4gICAgICAgIHBpY191cmw6IGl0ZW0ucGljLFxcXFxuICAgIH0pO1xcXFxufVxcXFxuLyog5b2S5bm25o6S5bqPIFN0YXJ0ICovXFxcXG5pZihnZXRJdGVtKFxcXFxcXFwi5o6S5bqPXFxcXFxcXCIsXFxcXFxcXCLml7bpl7TkvJjlhYhcXFxcXFxcIik9PT0n5paw54mI5LyY5YWIJyl7XFxcXG4gICAgbVJ1bGVMaXN0ID0gbm9ybWFsU29ydChtUnVsZUxpc3QpO1xcXFxufVxcXFxuLyog5b2S5bm25o6S5bqPIEVuZCAqL1xcXFxuZGF0YS5wdXNoLmFwcGx5KGRhdGEsIG1SdWxlTGlzdClcXFxcbnNldFJlc3VsdChkYXRhKTtcXFxcblxcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJtb3ZpZV8zXFxcIixcXFwibmFtZVxcXCI6XFxcIuinhOWImeivpue7hi11c2VyXFxcIixcXFwicGF0aFxcXCI6XFxcInJ1bGVEZXRhaWxcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG4gICAgY29uc3Qge1xcXFxuICAgICAgICBnZXRBcGksXFxcXG4gICAgICAgIGNvbG9yLFxcXFxuICAgICAgICBzbWFsbCxcXFxcbiAgICAgICAgaHRtbFRhZyxcXFxcbiAgICAgICAgYXBpLFxcXFxuICAgICAgICBtZFxcXFxuICAgIH0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcXFxcXCIpO1xcXFxubGV0IHtcXFxcbiAgICBpZCxcXFxcbiAgICBsdmVyLFxcXFxuICAgIGlzQWxsXFxcXG59ID0gTVlfUEFSQU1TO1xcXFxuaWYoZ2V0UGFyYW0oXFxcXFxcXCJpZFxcXFxcXFwiKSl7XFxcXG4gICAgaXNBbGwgPSB0cnVlO1xcXFxuICAgIGlkID0gZ2V0UGFyYW0oXFxcXFxcXCJpZFxcXFxcXFwiKTtcXFxcbiAgICBsdmVyID0gbHZlciB8fCBcXFxcXFxcIuacquiOt+WPlueJiOacrOWPt1xcXFxcXFwiO1xcXFxufVxcXFxuYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAkLnRvU3RyaW5nKChpc0FsbCkgPT4ge1xcXFxuICAgIGlmKCFpc0FsbCl7XFxcXG4gICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXFxcbiAgICB9XFxcXG59LGlzQWxsKSk7XFxcXG5sZXQgZGF0YUl0ZW0gPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXFxcXFwiZ2V0YnlpZFxcXFxcXFwiKSArIFxcXFxcXFwiP2lkPVxcXFxcXFwiICsgaWQpKS5yZXN1bHQ7XFxcXG5zZXRQYWdlVGl0bGUoXFxcXFxcXCLjgIxcXFxcXFxcIiArIGRhdGFJdGVtLm5hbWUgKyBcXFxcXFxcIuOAjVxcXFxcXFwiKVxcXFxubGV0IHJ1bGVMaXN0SnNvbiA9IGdldEFwaShcXFxcXFxcInJ1bGVMaXN0SnNvblxcXFxcXFwiKSArIFxcXFxcXFwiP2lkPVxcXFxcXFwiO1xcXFxubGV0IGRhdGEgPSBbXTtcXFxcbnZhciBoYXNTdWIgPSBmYWxzZTtcXFxcblxcXFxuaWYgKGRhdGFJdGVtLmlzX2pzb25fbGlzdCkge1xcXFxuICAgIGhhc1N1YiA9IGhhc0hvbWVTdWIocnVsZUxpc3RKc29uICsgZGF0YUl0ZW0uaWQpO1xcXFxufSBlbHNlIGlmICghZGF0YUl0ZW0uaXNfanNvbl9saXN0ICYmIGRhdGFJdGVtLmRhdGFfdHlwZSA9PSAnaG9tZV9ydWxlX3VybCcpIHtcXFxcbiAgICBoYXNTdWIgPSBoYXNIb21lU3ViKHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkICsgJyZkZWJ1Zz10cnVlJyk7XFxcXG59XFxcXG5cXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IGh0bWxUYWcoXFxcXFxcXCJiaWdcXFxcXFxcIiwgXFxcXFxcXCLniYjmnKxcXFxcXFxcIiksXFxcXG4gICAgZGVzYzogXFxcXFxcXCLigJzigJzigJ3igJ3lvIDlj5HogIXvvJpcXFxcXFxcIiArIGNvbG9yKGRhdGFJdGVtLmF1dGhvciwgXFxcXFxcXCIjMjI4QkU2XFxcXFxcXCIpICsgXFxcXFxcXCJcXFxcXFxcXG7kupHnq6/niYjmnKzvvJpcXFxcXFxcIiArIGNvbG9yKGRhdGFJdGVtLnZlciwgXFxcXFxcXCIjNWNmZjJjXFxcXFxcXCIpICsgXFxcXFxcXCJcXFxcXFxcXHRcXFxcXFxcXHTmnKzlnLDniYjmnKzvvJpcXFxcXFxcIiArIGNvbG9yKGx2ZXIsIFxcXFxcXFwiIzVjZmYyY1xcXFxcXFwiKSArIFxcXFxcXFwiXFxcXFxcXFxu5pu05paw5LqOOiBbXFxcXFxcXCIgKyBjb2xvcihkYXRhSXRlbS5sYXN0X3VwZGF0ZSwgXFxcXFxcXCIjZmY3MDAwXFxcXFxcXCIpICsgXFxcXFxcXCJdXFxcXFxcXCIsXFxcXG4gICAgdXJsOiAkKFxcXFxcXFwiPOW8gOWPkeiAhT5cXFxcXFxcXG5cXFxcXFxcIiArIGRhdGFJdGVtLmF1dGhvciArIFxcXFxcXFwiXFxcXFxcXFxuPOWQjeensD5cXFxcXFxcXG5cXFxcXFxcIiArIGRhdGFJdGVtLm5hbWUgKyBcXFxcXFxcIlxcXFxcXFxcbjzkupHnq6/niYjmnKw+XFxcXFxcXFxuXFxcXFxcXCIgKyBkYXRhSXRlbS52ZXIgKyBcXFxcXFxcIlxcXFxcXFxcbjzmnKzlnLDniYjmnKw+XFxcXFxcXFxuXFxcXFxcXCIgKyBsdmVyICsgXFxcXFxcXCJcXFxcXFxcXG485pu05paw5pe26Ze0PlxcXFxcXFxcbltcXFxcXFxcIiArIGRhdGFJdGVtLmxhc3RfdXBkYXRlICsgXFxcXFxcXCJdXFxcXFxcXCIpLmNvbmZpcm0oKCkgPT4ge30pLFxcXFxuICAgIGNvbF90eXBlOiAndGV4dF8xJ1xcXFxufSk7XFxcXG5sZXQgZGF0YVR5cGUgPSB7XFxcXG4gICAgaG9tZV9ydWxlX3VybDogJ+mmlumhteS6keinhOWImScsXFxcXG4gICAgcHVibGlzaDogJ+aPkOS6pOS6keS7k+W6k+inhOWImScsXFxcXG4gICAganNfdXJsOiAn572R6aG15o+S5Lu26KeE5YiZJyxcXFxcbiAgICBodG1sOiAn6Z2Z5oCB6aG16Z2iJyxcXFxcbiAgICBjb25maWc6ICfkuLvpobXphY3nva4nXFxcXG59O1xcXFxuXFxcXG5sZXQgYmFzaWMgPSB7XFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8xXFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIlxcXFxufTtcXFxcbmxldCBkYXRhVHlwZVRpcHMgPSBkYXRhVHlwZVtkYXRhSXRlbS5kYXRhX3R5cGVdIHx8ICfmnKrnn6Xop4TliJnvvJonICsgZGF0YUl0ZW0uZGF0YV90eXBlO1xcXFxuXFxcXG5sZXQgc2FmZV90aXA9ZGF0YUl0ZW0uaXNfc2FmZT9cXFxcXFxcIuWuieWFqFxcXFxcXFwiOlxcXFxcXFwi5Y2x6ZmpXFxcXFxcXCI7XFxcXG5sZXQgZ29vZF90aXAgPSBkYXRhSXRlbS5pc19nb29kP3NtYWxsKGNvbG9yKFxcXFxcXFwi44CQ5LyY6LSo6KeE5YiZ44CRXFxcXFxcXCIsJyNmZjcwMDAnKSk6XFxcXFxcXCJcXFxcXFxcIjtcXFxcbmxldCBub3Rfc2FmZV9ub3RlPWRhdGFJdGVtLm5vdF9zYWZlX25vdGU7XFxcXG5iYXNpYy50aXRsZSA9IGh0bWxUYWcoXFxcXFxcXCJiaWdcXFxcXFxcIiwgXFxcXFxcXCLnsbvlnotcXFxcXFxcIikgKyBcXFxcXFxcIlxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFwiICsgc21hbGwoXFxcXFxcXCIoaWQ6XFxcXFxcXCIgKyBkYXRhSXRlbS5pZCArIFxcXFxcXFwiKVxcXFxcXFwiKStcXFxcXFxcIlxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFwiICsgc21hbGwoXFxcXFxcXCIo6aOO6Zmp5qOA5rWLOlxcXFxcXFwiICtzYWZlX3RpcCtcXFxcXFxcIilcXFxcXFxcIikrZ29vZF90aXA7XFxcXG5iYXNpYy5kZXNjID0gXFxcXFxcXCLmlbDmja7nsbvlnovvvJpcXFxcXFxcIiArIGNvbG9yKGRhdGFUeXBlVGlwcywgXFxcXFxcXCIjY2I1NGZmXFxcXFxcXCIpICsgXFxcXFxcXCJcXFxcXFxcXG7liIbkuqvnirbmgIHkuLrvvJpcXFxcXFxcIiArIGRhdGFJdGVtLnN0YXRlO1xcXFxuaWYgKFtcXFxcXFxcImh0bWxcXFxcXFxcIiwgXFxcXFxcXCJjb25maWdcXFxcXFxcIiwgXFxcXFxcXCJqc191cmxcXFxcXFxcIl0uaW5jbHVkZXMoZGF0YUl0ZW0uZGF0YV90eXBlKSkge1xcXFxuICAgIGJhc2ljLmRlc2MgKz0gXFxcXFxcXCJcXFxcXFxcXG7igJzigJzigJ3igJ0gPT5cXFxcXFxcIiArIHNtYWxsKFxcXFxcXFwi54K55q2k6aKE6KeIXFxcXFxcXCIpO1xcXFxuICAgIGJhc2ljLnVybCA9IHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkO1xcXFxufVxcXFxuXFxcXG5kYXRhLnB1c2goYmFzaWMpO1xcXFxubGV0IGhhc1N1YnMgPSBcXFxcXFxcIlxcXFxcXFwiO1xcXFxuaWYgKGhhc1N1Yikge1xcXFxuICAgIGhhc1N1YnMgPSBcXFxcXFxcIlxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFwiICsgc21hbGwoXFxcXFxcXCLlt7LorqLpmIVcXFxcXFxcIilcXFxcbn1cXFxcblxcXFxubGV0IG5vdGVzID0gcmVxdWVzdChnZXRBcGkoXFxcXFxcXCJnZXRfcnVsZV9ub3RlXFxcXFxcXCIpICsgaWQpO1xcXFxubm90ZXMgPSBKU09OLnBhcnNlKG5vdGVzKS5yZXN1bHQ7XFxcXG5yZXF1aXJlKG1kKTtcXFxcbmxldCBub3Rlc0h0bWw9XFxcXFxcXCJcXFxcXFxcIlxcXFxudHJ5e1xcXFxuICAgIG5vdGVzSHRtbD1tYXJrZWQucGFyc2Uobm90ZXMpO1xcXFxufWNhdGNoKGUpe31cXFxcblxcXFxuaWYgKG5vdGVzICE9PSBmYWxzZSkge1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBodG1sVGFnKFxcXFxcXFwiYmlnXFxcXFxcXCIsIFxcXFxcXFwi5aSH5rOoXFxcXFxcXCIpICsgXFxcXFxcXCJcXFxcXFxcXHRcXFxcXFxcXHRcXFxcXFxcXHRcXFxcXFxcIiArIHNtYWxsKGh0bWxUYWcoXFxcXFxcXCJ1XFxcXFxcXCIsIFxcXFxcXFwi5p+l55yL5a6M5pW05YWs5ZGKID5cXFxcXFxcIikpLFxcXFxuICAgICAgICBkZXNjOiBub3RlcyxcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8xXFxcXFxcXCIsXFxcXG4gICAgICAgIHVybDogXFxcXFxcXCJoaWtlcjovL3BhZ2UvaW5mb1xcXFxcXFwiLFxcXFxuICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgdGV4dDogbm90ZXNIdG1sLFxcXFxuICAgICAgICAgICAgbmFtZTogZGF0YUl0ZW0ubmFtZSxcXFxcbiAgICAgICAgICAgIC8vIHR5cGU6IFxcXFxcXFwibG9uZ190ZXh0XFxcXFxcXCJcXFxcbiAgICAgICAgICAgIHR5cGU6IFxcXFxcXFwicmljaF90ZXh0XFxcXFxcXCJcXFxcbiAgICAgICAgfVxcXFxuICAgIH0pO1xcXFxufVxcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogaHRtbFRhZyhcXFxcXFxcImJpZ1xcXFxcXFwiLCBcXFxcXFxcIuaTjeS9nCjliIbkuqvor6bnu4bpobUpXFxcXFxcXCIpICsgaGFzU3VicyxcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJ0ZXh0XzFcXFxcXFxcIixcXFxcbiAgICB1cmw6IFxcXFxcXFwiY29weTovL+mBk+mVv+S7k+W6k+OAjFxcXFxcXFwiK2RhdGFJdGVtLm5hbWUrXFxcXFxcXCLjgI1cXFxcXFxcXG5cXFxcXFxcIitpZCsnQGltcG9ydD1qczokLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvcnVsZURldGFpbEltcG9ydD9ydWxlPemBk+mVv+S7k+W6k1Byb1xcXFxcXFwiLCBpbnB1dCknXFxcXG59KTtcXFxcbmxldCBpbXBvcnRVcmwsIHJ1bGVDb2RlLCBzaGFyZVVybCwgYmFja0NvZGUgPSBcXFxcXFxcIlxcXFxcXFwiO1xcXFxuaWYgKCFkYXRhSXRlbS5pc19qc29uKSB7XFxcXG4gICAgYmFja0NvZGUgPSByZXF1ZXN0KHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkKTtcXFxcbn1cXFxcbnN3aXRjaCAoZGF0YUl0ZW0uZGF0YV90eXBlKSB7XFxcXG4gICAgY2FzZSBcXFxcXFxcImhvbWVfcnVsZV91cmxcXFxcXFxcIjpcXFxcbiAgICAgICAgcnVsZUNvZGUgPSBcXFxcXFxcIua1t+mYlOinhueVjOmmlumhtemikemBk+inhOWImeOAkFxcXFxcXFwiICsgZGF0YUl0ZW0ubmFtZSArIFxcXFxcXFwi44CR77+laG9tZV9ydWxlX3VybO+/pVxcXFxcXFwiICsgcnVsZUxpc3RKc29uICsgZGF0YUl0ZW0uaWQ7XFxcXG4gICAgICAgIGltcG9ydFVybCA9IFxcXFxcXFwicnVsZTovL1xcXFxcXFwiICsgYmFzZTY0RW5jb2RlKHJ1bGVDb2RlKVxcXFxuICAgICAgICBicmVhaztcXFxcbiAgICBjYXNlICdwdWJsaXNoJzpcXFxcbiAgICAgICAgcnVsZUNvZGUgPSAn5rW36ZiU6KeG55WM6KeE5YiZ5YiG5Lqr77yM5b2T5YmN5YiG5Lqr55qE5piv77yaJyArIGRhdGFJdGVtLm5hbWUgKyAn77+lcHVibGlzaO+/pScgKyBiYXNlNjRFbmNvZGUoYmFja0NvZGUpO1xcXFxuICAgICAgICBpbXBvcnRVcmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpO1xcXFxuICAgICAgICBicmVhaztcXFxcbiAgICBjYXNlICdqc191cmwnOlxcXFxuICAgICAgICBydWxlQ29kZSA9ICfmtbfpmJTop4bnlYzop4TliJnliIbkuqvvvIzlvZPliY3liIbkuqvnmoTmmK/vvJrnvZHpobXmj5Lku7bvv6Vqc191cmzvv6UnICsgZGF0YUl0ZW0ubmFtZSArICdAYmFzZTY0Oi8vJyArIGJhc2U2NEVuY29kZShiYWNrQ29kZSk7XFxcXG4gICAgICAgIGltcG9ydFVybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShydWxlQ29kZSk7XFxcXG4gICAgICAgIGJyZWFrO1xcXFxuICAgIGNhc2UgJ2h0bWwnOlxcXFxuICAgICAgICBsZXQgZmlsZV90bXAgPSBkYXRhSXRlbS5uYW1lLnNwbGl0KCcuJyk7XFxcXG4gICAgICAgIGxldCBmaWxlX3BhdGggPSBmaWxlX3RtcC5sZW5ndGggPiAxID8gZmlsZV90bXBbZmlsZV90bXAubGVuZ3RoIC0gMV0gKyBcXFxcXFxcIi9cXFxcXFxcIiArIGRhdGFJdGVtLm5hbWUgOiBkYXRhSXRlbS5uYW1lO1xcXFxuICAgICAgICBydWxlQ29kZSA9IFxcXFxcXFwi5rW36ZiU6KeG55WM5pys5Zyw5paH5Lu25YiG5Lqr77+lZmlsZV91cmzvv6VoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvXFxcXFxcXCIgKyBmaWxlX3BhdGggKyBcXFxcXFxcIkBcXFxcXFxcIiArIHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkO1xcXFxuICAgICAgICBpbXBvcnRVcmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUocnVsZUNvZGUpO1xcXFxuICAgICAgICBicmVha1xcXFxuICAgIGNhc2UgXFxcXFxcXCJjb25maWdcXFxcXFxcIjpcXFxcbiAgICAgICAgaW1wb3J0VXJsID0gJCgpLnJ1bGUocGFzc3dvcmQgPT4ge1xcXFxuICAgICAgICAgICAgZXZhbChmZXRjaChcXFxcXFxcImhpa2VyOi8vYXNzZXRzL2hvbWUuanNcXFxcXFxcIikpO1xcXFxuICAgICAgICAgICAgSGlrZXJIb21lLmxvYWQoXFxcXFxcXCJpbXBvcnRcXFxcXFxcIiwgcGFzc3dvcmQpO1xcXFxuICAgICAgICB9LCBiYWNrQ29kZSk7XFxcXG4gICAgICAgIGJyZWFrO1xcXFxufVxcXFxubGV0IG15X2NvbF90eXBlID0gXFxcXFxcXCJ0ZXh0XzJcXFxcXFxcIjtcXFxcbmxldCBteV9jb2xfdHlwZTIgPSBcXFxcXFxcInRleHRfM1xcXFxcXFwiO1xcXFxuaWYgKGltcG9ydFVybCkge1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBcXFxcXFxcIuWvvOWFpeinhOWImVxcXFxcXFwiLFxcXFxuICAgICAgICB1cmw6IGRhdGFJdGVtLmlzX3NhZmU/aW1wb3J0VXJsOid0b2FzdDovL+mjjumZqeinhOWImeemgeatouWvvOWFpSEhIScsXFxcXG4gICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZVxcXFxuICAgIH0pO1xcXFxufVxcXFxuaWYgKHJ1bGVDb2RlKSB7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IFxcXFxcXFwi5YiG5Lqr5Y+j5LukXFxcXFxcXCIsXFxcXG4gICAgICAgIHVybDogXFxcXFxcXCJjb3B5Oi8vXFxcXFxcXCIgKyBydWxlQ29kZSxcXFxcbiAgICAgICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxcXG4gICAgfSk7XFxcXG59XFxcXG5cXFxcbmlmIChpbXBvcnRVcmwpIHtcXFxcbiAgICBpZiAoZGF0YUl0ZW0uaXNfanNvbl9saXN0ICYmICFoYXNTdWIpIHtcXFxcbiAgICAgICAgbGV0IHN1Yl9ydWxlX2NvZGUgPSAn5rW36ZiU6KeG55WM5ZCI6ZuG6KeE5YiZ6K6i6ZiF77+laG9tZV9zdWLvv6UnICsgZGF0YUl0ZW0ubmFtZSArIFxcXFxcXFwiQEBcXFxcXFxcIiArIHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkO1xcXFxuICAgICAgICBsZXQgc3ViX3VybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShzdWJfcnVsZV9jb2RlKTtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiAn6K6i6ZiF5ZCI6ZuGJyxcXFxcbiAgICAgICAgICAgIHVybDogc3ViX3VybCxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZTJcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgICAgICB0aXRsZTogJ+KAnOKAnOKAneKAnTxzcGFuIHN0eWxlPVxcXFxcXFwiY29sb3I6ICNmZjcwMDBcXFxcXFxcIj7lr7zlhaXovbvlkIjpm4Y8L3NwYW4+JyxcXFxcbiAgICAgICAgICAgIHVybDogJCgpLmxhenlSdWxlKChkYXRhSXRlbSxzdWJVcmwpPT57XFxcXG4gICAgICAgICAgICAgICAgY29uc3Qge2dlblJ1bGV9PSQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS9nZW5BcGlcXFxcXFxcIik7XFxcXG4gICAgICAgICAgICAgICAgbGV0IGltcG9ydF9ydWxlPWdlblJ1bGUoZGF0YUl0ZW0ubmFtZStcXFxcXFxcIi5cXFxcXFxcIitkYXRhSXRlbS5hdXRob3Isc3ViVXJsKTtcXFxcbiAgICAgICAgICAgICAgICAvL2NvcHkoaW1wb3J0X3J1bGUpO1xcXFxuICAgICAgICAgICAgICAgIGxldCBydWxlQ29kZT1wYXJzZVBhc3RlKGltcG9ydF9ydWxlLnNwbGl0KFxcXFxcXFwiXFxcXFxcXFxuXFxcXFxcXCIpWzBdKTtcXFxcbiAgICAgICAgICAgICAgICAvL3JldHVybiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIlxcXFxuICAgICAgICAgICAgICAgIGltcG9ydFVybCA9ICdydWxlOi8vJyArIGJhc2U2NEVuY29kZShydWxlQ29kZSk7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIGltcG9ydFVybFxcXFxuICAgICAgICAgICAgfSxkYXRhSXRlbSxydWxlTGlzdEpzb24gKyBkYXRhSXRlbS5pZCksXFxcXG4gICAgICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGUyXFxcXG4gICAgICAgIH0pO1xcXFxuICAgICAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICAgICAgdGl0bGU6ICfigJzigJzigJ3igJ08c3BhbiBzdHlsZT1cXFxcXFxcImNvbG9yOiAjZmY3MDAwXFxcXFxcXCI+5a+85YWl6YGT5b6357uPPC9zcGFuPicsXFxcXG4gICAgICAgICAgICB1cmw6ICQoKS5sYXp5UnVsZSgoZGF0YUl0ZW0sc3ViVXJsKT0+e1xcXFxuICAgICAgICAgICAgICAgIC8vIGxldCB0aXRsZSA9IFxcXFxcXFwiSC1cXFxcXFxcIitkYXRhSXRlbS5uYW1lK1xcXFxcXFwiLlxcXFxcXFwiK2RhdGFJdGVtLmF1dGhvcjtcXFxcbiAgICAgICAgICAgICAgICBsZXQgdGl0bGUgPSBcXFxcXFxcIkotXFxcXFxcXCIrZGF0YUl0ZW0ubmFtZS5zcGxpdCgnLicpWzBdO1xcXFxuICAgICAgICAgICAgICAgIGxldCBzdWJPYmogPSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcXFxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBzdWJVcmwsXFxcXG4gICAgICAgICAgICAgICAgICAgIGRlc2M6IFxcXFxcXFwiaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlL3J1bGVDYWNoZS9cXFxcXFxcIit0aXRsZStcXFxcXFxcIi5qc29uXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IFxcXFxcXFwiXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZTogZmFsc2UsLy/npoHnlKjlubblj5Hmm7TmlrBcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgbGV0IHNoYXJlVGV4dCA9IGJhc2U2NEVuY29kZShKU09OLnN0cmluZ2lmeShzdWJPYmopKTtcXFxcbiAgICAgICAgICAgICAgICB2YXIgcGFzdGVzID0gZ2V0UGFzdGVzKCk7XFxcXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHNoYXJlUGFzdGUoc2hhcmVUZXh0LHBhc3Rlcy5zbGljZSgtMSlbMF0pO1xcXFxuICAgICAgICAgICAgICAgIGxldCBpbXBvcnRfcnVsZT0gXFxcXFxcXCLovbvlkIjpm4borqLpmIXvvJpcXFxcXFxcIit0aXRsZSsnXFxcXFxcXFxuJyt1cmw7XFxcXG4gICAgICAgICAgICAgICAgY29weShpbXBvcnRfcnVsZSk7XFxcXG4gICAgICAgICAgICAgICAgY29uc3QgcGF0aCA9ICdoaWtlcjovL2ZpbGVzL3J1bGVzL2R6SG91c2UvcnVsZUNhY2hlL3N1Yi5qc29uJztcXFxcbiAgICAgICAgICAgICAgICAkLnJjKGNvbmZpZy5saWIuc3ViKTtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4g6K6i6ZiF5a+85YWlKHBhdGgpXFxcXG4gICAgICAgICAgICB9LGRhdGFJdGVtLHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkKSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBteV9jb2xfdHlwZTJcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgICAgICB0aXRsZTogXFxcXFxcXCI8c21hbGw+5o+Q56S677ya5byA5Y+R6ICF5Y2V54us5YiG5Lqr55qE5ZCI6ZuG5paH5Lu25Y+q6IO95Y2V54us5a+85YWl44CCPC9zbWFsbD5cXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInJpY2hfdGV4dFxcXFxcXFwiXFxcXG4gICAgICAgIH0pO1xcXFxuICAgIH0gZWxzZSBpZiAoIWRhdGFJdGVtLmlzX2pzb25fbGlzdCAmJiAhaGFzU3ViICYmIGRhdGFJdGVtLmRhdGFfdHlwZSA9PSAnaG9tZV9ydWxlX3VybCcpIHtcXFxcbiAgICAgICAgbGV0IHN1Yl9ydWxlX2NvZGUgPSAn5rW36ZiU6KeG55WM5Y2V6KeE5YiZ6K6i6ZiF77+laG9tZV9zdWLvv6UnICsgZGF0YUl0ZW0ubmFtZSArIFxcXFxcXFwiQEBcXFxcXFxcIiArIHJ1bGVMaXN0SnNvbiArIGRhdGFJdGVtLmlkICsgJyZkZWJ1Zz10cnVlJztcXFxcbiAgICAgICAgbGV0IHN1Yl91cmwgPSAncnVsZTovLycgKyBiYXNlNjRFbmNvZGUoc3ViX3J1bGVfY29kZSk7XFxcXG4gICAgICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgICAgICB0aXRsZTogJ+iuoumYheinhOWImScsXFxcXG4gICAgICAgICAgICB1cmw6IHN1Yl91cmwsXFxcXG4gICAgICAgICAgICBjb2xfdHlwZTogbXlfY29sX3R5cGVcXFxcbiAgICAgICAgfSlcXFxcbiAgICB9XFxcXG59XFxcXG5pZiAoZGF0YUl0ZW0uaXNfanNvbiAmJiBkYXRhSXRlbS5kYXRhX3R5cGUgPT09IFxcXFxcXFwiaG9tZV9ydWxlX3VybFxcXFxcXFwiICYmICFkYXRhSXRlbS5pc19qc29uX2xpc3QpIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogJ+i/m+WFpemikemBkycsXFxcXG4gICAgICAgIHVybDogJCggLypcXFxcXFxcIiNub0xvYWRpbmcjXFxcXFxcXCIqLyApLmxhenlSdWxlKChuYW1lLGhvbWUpID0+IHtcXFxcbiAgICAgICAgICAgIGxldCBydWxlTGlzdCA9IEpTT04ucGFyc2UocmVxdWVzdChob21lKSk7XFxcXG4gICAgICAgICAgICBsZXQgaGFzUnVsZSA9IHJ1bGVMaXN0LnNvbWUoaXRlbSA9PiBpdGVtLnRpdGxlID09PSBuYW1lKTtcXFxcbiAgICAgICAgICAgIGlmIChoYXNSdWxlKSB7XFxcXG4gICAgICAgICAgICAgICAgcHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmJhY2tcXFxcXFxcIiwgXFxcXFxcXCIxXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgICAgIGJhY2soKTtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gaG9tZStcXFxcXFxcInNAXFxcXFxcXCIgKyBuYW1lO1xcXFxuICAgICAgICAgICAgfSBlbHNlIHtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+acquWuieijhVxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9LCBkYXRhSXRlbS5uYW1lLGFwaS5ob21lKSxcXFxcbiAgICAgICAgY29sX3R5cGU6IG15X2NvbF90eXBlXFxcXG4gICAgfSlcXFxcbn1cXFxcbmxldCBtYW5fcnVsZV9zYWZlID0gZ2V0QXBpKFxcXFxcXFwibWFuUnVsZVNhZmVcXFxcXFxcIikrZGF0YUl0ZW0uaWQ7XFxcXG5sZXQgbWFuX3J1bGVfZ29vZCA9IGdldEFwaShcXFxcXFxcIm1hblJ1bGVHb29kXFxcXFxcXCIpK2RhdGFJdGVtLmlkO1xcXFxuLy8gZGF0YUl0ZW0uaXNfc2FmZTtcXFxcbmlmKGdldFZhcignaG91c2UuaXNfbWFuYWdlcicpKXtcXFxcbiAgICBmdW5jdGlvbiBzZXRJc1NhZmUoZmxhZyxtYW5fcnVsZV9zYWZlKSB7XFxcXG4gICAgICAgIGZsYWcgPSBmbGFnIHx8ICcnO1xcXFxuICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgbGV0IGNvZGUgPSBmZXRjaChtYW5fcnVsZV9zYWZlLCB7XFxcXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xcXFxcXFwiVXNlci1BZ2VudFxcXFxcXFwiOiBNT0JJTEVfVUF9LFxcXFxuICAgICAgICAgICAgICAgIGJvZHk6IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJwYXJhbXNcXFxcXFxcIjpcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInVzZXJuYW1lXFxcXFxcXCI6IGdldFZhcignaG91c2UudXNlcm5hbWUnKSxcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhc3N3b3JkXFxcXFxcXCI6IGdldFZhcignaG91c2UucGFzc3dvcmQnKSxcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFxcXFxcImlzX3NhZmVcXFxcXFxcIjogISFmbGFnXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgfSk7XFxcXG4gICAgICAgICAgICBjb2RlID0gSlNPTi5wYXJzZShjb2RlKS5yZXN1bHQ7XFxcXG4gICAgICAgICAgICBpZiAoY29kZS5zdGF0dXMgPT09IDApIHtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gY29kZS5kZXRhaWxcXFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuICfmk43kvZzlpLHotKU6JyArIGNvZGUuZGV0YWlsXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgICAgIHJldHVybiAn5pON5L2c5aSx6LSlOicgKyBlLm1lc3NhZ2VcXFxcbiAgICAgICAgfVxcXFxuICAgIH1cXFxcbiAgICBmdW5jdGlvbiBzZXRJc0dvb2QoZmxhZyxtYW5fcnVsZV9nb29kKSB7XFxcXG4gICAgICAgIGZsYWcgPSBmbGFnIHx8ICcnO1xcXFxuICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgbGV0IGNvZGUgPSBmZXRjaChtYW5fcnVsZV9nb29kLCB7XFxcXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xcXFxcXFwiVXNlci1BZ2VudFxcXFxcXFwiOiBNT0JJTEVfVUF9LFxcXFxuICAgICAgICAgICAgICAgIGJvZHk6IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJwYXJhbXNcXFxcXFxcIjpcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInVzZXJuYW1lXFxcXFxcXCI6IGdldFZhcignaG91c2UudXNlcm5hbWUnKSxcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhc3N3b3JkXFxcXFxcXCI6IGdldFZhcignaG91c2UucGFzc3dvcmQnKSxcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFxcXFxcImlzX2dvb2RcXFxcXFxcIjogISFmbGFnXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgfSk7XFxcXG4gICAgICAgICAgICBjb2RlID0gSlNPTi5wYXJzZShjb2RlKS5yZXN1bHQ7XFxcXG4gICAgICAgICAgICBpZiAoY29kZS5zdGF0dXMgPT09IDApIHtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gY29kZS5kZXRhaWxcXFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuICfmk43kvZzlpLHotKU6JyArIGNvZGUuZGV0YWlsXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgICAgIHJldHVybiAn5pON5L2c5aSx6LSlOicgKyBlLm1lc3NhZ2VcXFxcbiAgICAgICAgfVxcXFxuICAgIH1cXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTon8J+aq+mjjumZqScsXFxcXG4gICAgICAgIGNvbF90eXBlOidzY3JvbGxfYnV0dG9uJyxcXFxcbiAgICAgICAgdXJsOiQoJ+agh+iusOivpeinhOWImeS4uumjjumZqT/po47pmanop4TliJnml6Dms5Xooqvlr7zlhaUnKS5jb25maXJtKChpZCxtYW5fcnVsZV9zYWZlLHNldElzU2FmZSk9PntcXFxcbiAgICAgICAgICAgIGxldCByZXQgPSBzZXRJc1NhZmUoZmFsc2UsbWFuX3J1bGVfc2FmZSk7XFxcXG4gICAgICAgICAgICBpZighL+aTjeS9nOWksei0pS8udGVzdChyZXQpKXtcXFxcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8vJytyZXRcXFxcbiAgICAgICAgfSxkYXRhSXRlbS5pZCxtYW5fcnVsZV9zYWZlLHNldElzU2FmZSlcXFxcbiAgICB9KTtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTon4pyF5q2j5bi4JyxcXFxcbiAgICAgICAgY29sX3R5cGU6J3Njcm9sbF9idXR0b24nLFxcXFxuICAgICAgICB1cmw6JCgn5qCH6K6w6K+l6KeE5YiZ5Li65q2j5bi4PycpLmNvbmZpcm0oKGlkLG1hbl9ydWxlX3NhZmUsc2V0SXNTYWZlKT0+e1xcXFxuICAgICAgICAgICAgbGV0IHJldCA9IHNldElzU2FmZSh0cnVlLG1hbl9ydWxlX3NhZmUpO1xcXFxuICAgICAgICAgICAgaWYoIS/mk43kvZzlpLHotKUvLnRlc3QocmV0KSl7XFxcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovLycrcmV0XFxcXG4gICAgICAgIH0sZGF0YUl0ZW0uaWQsbWFuX3J1bGVfc2FmZSxzZXRJc1NhZmUpXFxcXG4gICAgfSk7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6J+KZpemdnuS8mOi0qCcsXFxcXG4gICAgICAgIGNvbF90eXBlOidzY3JvbGxfYnV0dG9uJyxcXFxcbiAgICAgICAgdXJsOiQoJ+agh+iusOivpeinhOWImeS4uumdnuS8mOi0qD8nKS5jb25maXJtKChpZCxtYW5fcnVsZV9nb29kLHNldElzR29vZCk9PntcXFxcbiAgICAgICAgICAgIGxldCByZXQgPSBzZXRJc0dvb2QoZmFsc2UsbWFuX3J1bGVfZ29vZCk7XFxcXG4gICAgICAgICAgICBpZighL+aTjeS9nOWksei0pS8udGVzdChyZXQpKXtcXFxcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8vJytyZXRcXFxcbiAgICAgICAgfSxkYXRhSXRlbS5pZCxtYW5fcnVsZV9nb29kLHNldElzR29vZClcXFxcbiAgICB9KTtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTon8J+SluS8mOi0qCcsXFxcXG4gICAgICAgIGNvbF90eXBlOidzY3JvbGxfYnV0dG9uJyxcXFxcbiAgICAgICAgdXJsOiQoJ+agh+iusOivpeinhOWImeS4uuS8mOi0qD8nKS5jb25maXJtKChpZCxtYW5fcnVsZV9nb29kLHNldElzR29vZCk9PntcXFxcbiAgICAgICAgICAgIGxldCByZXQgPSBzZXRJc0dvb2QodHJ1ZSxtYW5fcnVsZV9nb29kKTtcXFxcbiAgICAgICAgICAgIGlmKCEv5pON5L2c5aSx6LSlLy50ZXN0KHJldCkpe1xcXFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly8nK3JldFxcXFxuICAgICAgICB9LGRhdGFJdGVtLmlkLG1hbl9ydWxlX2dvb2Qsc2V0SXNHb29kKVxcXFxuICAgIH0pO1xcXFxufVxcXFxuXFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcImxpbmVfYmxhbmtcXFxcXFxcIlxcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBkYXRhSXRlbS5nb29kX251bSxcXFxcbiAgICBwaWNfdXJsOiBcXFxcXFxcImhpa2VyOi8vZmlsZXMvaWNvbi/otZ4uc3ZnXFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwiaWNvbl9zbWFsbF8zXFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9NYWtlQWNvbW1lbnQjbm9IaXN0b3J5IyNub1JlY29yZEhpc3RvcnkjXFxcXFxcXCIsXFxcXG4gICAgZXh0cmE6IHtcXFxcbiAgICAgICAgaWQ6IGRhdGFJdGVtLmlkLFxcXFxuICAgICAgICBuYW1lOiBkYXRhSXRlbS5uYW1lXFxcXG4gICAgfVxcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBkYXRhSXRlbS5iYWRfbnVtLFxcXFxuICAgIHBpY191cmw6IFxcXFxcXFwiaGlrZXI6Ly9maWxlcy9pY29uL+i4qS5zdmdcXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJpY29uX3NtYWxsXzNcXFxcXFxcIixcXFxcbiAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL01ha2VBY29tbWVudCNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFxcXFxcIixcXFxcbiAgICBleHRyYToge1xcXFxuICAgICAgICBpZDogZGF0YUl0ZW0uaWQsXFxcXG4gICAgICAgIG5hbWU6IGRhdGFJdGVtLm5hbWUsXFxcXG4gICAgICAgIGRlZmF1bHRUeXBlOlxcXFxcXFwiYmFkXFxcXFxcXCJcXFxcbiAgICB9XFxcXG59KTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IFxcXFxcXFwi6K+E6K66XFxcXFxcXCIsXFxcXG4gICAgcGljX3VybDogXFxcXFxcXCJoaWtlcjovL2ZpbGVzL2ljb24v6K+E6K66LnN2Z1xcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcImljb25fc21hbGxfM1xcXFxcXFwiLFxcXFxuICAgIHVybDogXFxcXFxcXCJoaWtlcjovL3BhZ2UvTWFrZUFjb21tZW50I25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXFxcXFwiLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIGlkOiBkYXRhSXRlbS5pZCxcXFxcbiAgICAgICAgbmFtZTogZGF0YUl0ZW0ubmFtZVxcXFxuICAgIH1cXFxcbn0pO1xcXFxubGV0IHRvdGFsU3VtID0gZGF0YUl0ZW0uZ29vZF9udW0gKyBkYXRhSXRlbS5iYWRfbnVtO1xcXFxuXFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBodG1sVGFnKFxcXFxcXFwiYmlnXFxcXFxcXCIsIFxcXFxcXFwi6K+E6K66KFxcXFxcXFwiICsgdG90YWxTdW0gKyBcXFxcXFxcIilcXFxcXFxcIikgKyBcXFxcXFxcIlxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFwiICsgc21hbGwoaHRtbFRhZyhcXFxcXFxcInVcXFxcXFxcIiwgXFxcXFxcXCLmn6XnnIvlhajpg6jor4TorrogPlxcXFxcXFwiKSksXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8xXFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9Db21tZW50XFxcXFxcXCIsXFxcXG4gICAgZXh0cmE6IHtcXFxcbiAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vZW1wdHkjZnlwYWdlI25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXFxcXFwiLFxcXFxuICAgICAgICBpZDogZGF0YUl0ZW0uaWQsXFxcXG4gICAgICAgIHRvdGFsU3VtOiB0b3RhbFN1bSxcXFxcbiAgICAgICAgbm9fYWN0aXZlOiBmYWxzZVxcXFxuICAgIH1cXFxcbn0pO1xcXFxuLy9jb25zdCBsb25nZXN0U3VtPTEyMDtcXFxcbmxldCBpY29uID0ge1xcXFxuICAgIFxcXFxcXFwiZ29vZFxcXFxcXFwiOiBcXFxcXFxcIvCfkY1cXFxcXFxcIixcXFxcbiAgICBcXFxcXFxcImJhZFxcXFxcXFwiOiBcXFxcXFxcIvCfkY5cXFxcXFxcIixcXFxcbiAgICBcXFxcXFxcInJlcGx5XFxcXFxcXCI6XFxcXFxcXCLlvIDlj5HogIXwn5ejXFxcXFxcXCJcXFxcbn1cXFxcbmlmICh0b3RhbFN1bSA9PT0gMCkge1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBcXFxcXFxcIjxoNSBzdHlsZT0ndGV4dC1hbGlnbjpjZW50ZXInPuS4gOadoeivhOiuuuS5n+ayoeacie+8jOW/q+adpeaKouaymeWPkeWQp++8gTwvaDU+XFxcXFxcXCIsXFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInJpY2hfdGV4dFxcXFxcXFwiXFxcXG4gICAgfSk7XFxcXG59IGVsc2Uge1xcXFxuICAgIGxldCBjb21tZW50TGlzdCA9IEpTT04ucGFyc2UocmVxdWVzdChhcGkuZGlzX2dldCArIGRhdGFJdGVtLmlkICsgXFxcXFxcXCI/bGltaXQ9NVxcXFxcXFwiKSkucmVzdWx0O1xcXFxuICAgIGZvciAobGV0IGl0ZW0gb2YgY29tbWVudExpc3QpIHtcXFxcbiAgICAgICAgbGV0IFJlcGx5ID0gaXRlbS5kaXNjdXNzX3R5cGU9PT1cXFxcXFxcInJlcGx5XFxcXFxcXCImJml0ZW0ucmVwbHlfdG9fbmFtZSE9PWZhbHNlJiZpdGVtLnJlcGx5X3RvX2lkIT09ZmFsc2U/XFxcXFxcXCLigJjigJjlm57lpI1AXFxcXFxcXCIraXRlbS5yZXBseV90b19uYW1lK1xcXFxcXFwiICNcXFxcXFxcIitpdGVtLmRpc2N1c3NfaWQrXFxcXFxcXCLigJnigJlcXFxcXFxcXG5cXFxcXFxcIjpcXFxcXFxcIlxcXFxcXFwiO1xcXFxuICAgICAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW0ubmFtZSArIFxcXFxcXFwiJm5ic3A7Jm5ic3A7PGZvbnQgY29sb3I9J2dyYXknPjxzbWFsbD4jXFxcXFxcXCIgKyBpdGVtLmlkICsgXFxcXFxcXCI8L3NtYWxsPjxmb250PlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwiYXZhdGFyXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICAvL3VybDogXFxcXFxcXCJ0b2FzdDovL1xcXFxcXFwiICsgaXRlbS5xcSxcXFxcbiAgICAgICAgICAgIHVybDpcXFxcXFxcIm1xcXdwYTovL2ltL2NoYXQ/Y2hhdF90eXBlPXdwYSZ1aW49XFxcXFxcXCIraXRlbS5xcSxcXFxcbiAgICAgICAgICAgIHBpY191cmw6IGl0ZW0uYXZhdGFyX3VybFxcXFxuICAgICAgICB9KTtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLmRpc2N1c3NfdGV4dCxcXFxcbiAgICAgICAgICAgIGRlc2M6IFJlcGx5K2l0ZW0uY3JlYXRlX2RhdGUgKyBcXFxcXFxcIsK3XFxcXFxcXCIgKyBpY29uW2l0ZW0uZGlzY3Vzc190eXBlXSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfMVxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9pbmZvXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICBleHRyYTp7XFxcXG4gICAgICAgICAgICAgICAgbmFtZTppdGVtLm5hbWUsXFxcXG4gICAgICAgICAgICAgICAgdHlwZTpcXFxcXFxcImxvbmdfdGV4dFxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgIHRleHQ6aXRlbS5kaXNjdXNzX3RleHRcXFxcbiAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICBwaWNfdXJsOiBpdGVtLmF2YXRhcl91cmxcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgfVxcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcImxpbmVfYmxhbmtcXFxcXFxcIlxcXFxuICAgIH0pO1xcXFxufVxcXFxuXFxcXG5zZXRSZXN1bHQoZGF0YSk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcInJpY2hfdGV4dFxcXCIsXFxcIm5hbWVcXFwiOlxcXCLmn6XnnItcXFwiLFxcXCJwYXRoXFxcIjpcXFwiaW5mb1xcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbnNldFBhZ2VUaXRsZShcXFxcXFxcIuafpeeci+OAjFxcXFxcXFwiK01ZX1BBUkFNUy5uYW1lK1xcXFxcXFwi44CNXFxcXFxcXCIpXFxcXG5zZXRSZXN1bHQoW3tcXFxcbiAgICB0aXRsZTogTVlfUEFSQU1TLnRleHQsXFxcXG4gICAgY29sX3R5cGU6TVlfUEFSQU1TLnR5cGVcXFxcbn1dKTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLlvIDlj5HogIXms6jlhoxcXFwiLFxcXCJwYXRoXFxcIjpcXFwiUmVnaXN0ZXJcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG5zZXRQYWdlVGl0bGUoXFxcXFxcXCLlvIDlj5HogIXms6jlhoxcXFxcXFxcIik7XFxcXG5jb25zdCB7XFxcXG4gICAgZ2V0QXBpLFxcXFxuICAgIGh0bWxUYWcsXFxcXG4gICAgbWFwQ29sVHlwZSxcXFxcbiAgICBzbWFsbFxcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG52YXIgZGF0YSA9IFtdO1xcXFxuYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAkLnRvU3RyaW5nKCgpID0+IHtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5QYXNzd29yZFxcXFxcXFwiKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5Vc2VybmFtZVxcXFxcXFwiKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5EZXNjcmlwdGlvblxcXFxcXFwiKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5Vc2VyQWRkcmVzc1xcXFxcXFwiKTtcXFxcbn0pKTtcXFxcbmFkZExpc3RlbmVyKCdvblJlZnJlc2gnLCAkLnRvU3RyaW5nKCgpPT57XFxcXG4gICAgcHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLldhaXRcXFxcXFxcIiwgXFxcXFxcXCJcXFxcXFxcIik7XFxcXG59KSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiAn6LSm5Y+3JyxcXFxcbiAgICBkZXNjOiBcXFxcXFxcIuivt+i+k+WFpei0puWPtyjlv4XloaspXFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxcXG4gICAgZXh0cmE6IHtcXFxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5Vc2VybmFtZScsICcnKSxcXFxcbiAgICAgICAgdHlwZTogXFxcXFxcXCJudW1iZXJcXFxcXFxcIixcXFxcbiAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2UuVXNlcm5hbWVcXFxcXFxcIixpbnB1dCknXFxcXG4gICAgfVxcXFxufSwge1xcXFxuICAgIHRpdGxlOiAn5a+G56CBJyxcXFxcbiAgICBkZXNjOiBcXFxcXFxcIuivt+i+k+WFpeWvhueggSjlv4XloaspXFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxcXG4gICAgZXh0cmE6IHtcXFxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5QYXNzd29yZCcsICcnKSxcXFxcbiAgICAgICAgdHlwZTogXFxcXFxcXCJwYXNzd29yZFxcXFxcXFwiLFxcXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFxcXFxcIldhcmVob3VzZS5QYXNzd29yZFxcXFxcXFwiLGlucHV0KSdcXFxcbiAgICB9XFxcXG59KTtcXFxcbm1hcENvbFR5cGUoZGF0YSwgXFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCIsIDEpO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogJ+aYteensCcsXFxcXG4gICAgZGVzYzogXFxcXFxcXCLor7fovpPlhaXmmLXnp7Ao5b+F5aGrKVxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UuVXNlckFkZHJlc3MnLCAnJyksXFxcXG4gICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLlVzZXJBZGRyZXNzXFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgIH1cXFxcbn0sIHtcXFxcbiAgICB0aXRsZTogJ+aPj+i/sCcsXFxcXG4gICAgZGVzYzogXFxcXFxcXCLor7Tor7TkuLrku4DkuYjopoHms6jlhozlkKdcXFxcXFxcXG4o5Y+v5Lul5aKe5Yqg6YCa6L+H5qaC546HLOmAieWhqylcXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogJ2lucHV0JyxcXFxcbiAgICBleHRyYToge1xcXFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGdldFZhcignV2FyZWhvdXNlLkRlc2NyaXB0aW9uJywgJycpLFxcXFxuICAgICAgICB0eXBlOiBcXFxcXFxcInRleHRhcmVhXFxcXFxcXCIsXFxcXG4gICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLkRlc2NyaXB0aW9uXFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgIH1cXFxcbn0pXFxcXG5cXFxcbm1hcENvbFR5cGUoZGF0YSwgXFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCIsIDEpO1xcXFxuXFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBodG1sVGFnKFxcXFxcXFwiYlxcXFxcXFwiLCBcXFxcXFxcIuazqOWGjFxcXFxcXFwiKSxcXFxcbiAgICB1cmw6ICQoZ2V0QXBpKFxcXFxcXFwibmV3X2RldlxcXFxcXFwiKStcXFxcXFxcIiNub0xvYWRpbmcjXFxcXFxcXCIpLmxhenlSdWxlKChnZXRJZCwgY29uZmlybSkgPT4ge1xcXFxuICAgICAgICBsZXQgdXNlcm5hbWUgPSBnZXRWYXIoJ1dhcmVob3VzZS5Vc2VybmFtZScsIFxcXFxcXFwiXFxcXFxcXCIpLFxcXFxuICAgICAgICAgICAgcGFzc3dvcmQgPSBnZXRWYXIoJ1dhcmVob3VzZS5QYXNzd29yZCcsIFxcXFxcXFwiXFxcXFxcXCIpLFxcXFxuICAgICAgICAgICAgZGVzY3JpcHRpb24gPSBnZXRWYXIoJ1dhcmVob3VzZS5EZXNjcmlwdGlvbicsIFxcXFxcXFwiXFxcXFxcXCIpLFxcXFxuICAgICAgICAgICAgbmFtZSA9IGdldFZhcihcXFxcXFxcIldhcmVob3VzZS5Vc2VyQWRkcmVzc1xcXFxcXFwiLCBcXFxcXFxcIlxcXFxcXFwiKTtcXFxcbiAgICAgICAgaWYgKFt1c2VybmFtZSwgcGFzc3dvcmQsIG5hbWVdLmluY2x1ZGVzKFxcXFxcXFwiXFxcXFxcXCIpKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+i0puWPtyzlr4bnoIHlkozmmLXnp7DkuI3og73kuLrnqbpcXFxcXFxcIjtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBzaG93TG9hZGluZyhcXFxcXFxcIuato+WcqOaPkOS6pOeUs+ivt+ihqFxcXFxcXFwiKTtcXFxcbiAgICAgICAgbGV0IHJlc3VsdCA9IHJlcXVlc3QoaW5wdXQsIHtcXFxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcXFxcbiAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXFxcXG4gICAgICAgICAgICB9LFxcXFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xcXFxuICAgICAgICAgICAgICAgIFxcXFxcXFwicGFyYW1zXFxcXFxcXCI6IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJyZWFzb25cXFxcXFxcIjogZGVzY3JpcHRpb24sXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwibmFtZVxcXFxcXFwiOiBuYW1lLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhc3N3b3JkXFxcXFxcXCI6IHBhc3N3b3JkLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInFxXFxcXFxcXCI6IHVzZXJuYW1lXFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgfSksXFxcXG4gICAgICAgICAgICBtZXRob2Q6ICdwb3N0J1xcXFxuICAgICAgICB9KTtcXFxcbiAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpLnJlc3VsdDtcXFxcbiAgICAgICAgaGlkZUxvYWRpbmcoKTtcXFxcbiAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgIT09IDApIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vXFxcXFxcXCIgKyByZXN1bHQuZGV0YWlsO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGxldCBpZHJlc3VsdCA9IEpTT04ucGFyc2UocmVxdWVzdChnZXRJZCArIFxcXFxcXFwiP3FxPVxcXFxcXFwiICsgdXNlcm5hbWUpKTtcXFxcbiAgICAgICAgaWYgKGlkcmVzdWx0LnN0YXR1cyAhPT0gMCkge1xcXFxuICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly9cXFxcXFxcIiArIGlkcmVzdWx0LmRldGFpbDtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBcXFxcbiAgICAgICAgcmV0dXJuICQoXFxcXFxcXCJcXFxcXFxcIiwgXFxcXFxcXCLovpPlhaXpgq7nrrHpqozor4HnoIFcXFxcXFxcXG5cXFxcXFxcIiArIHJlc3VsdC5kZXRhaWwpLmlucHV0KChjb25maXJtLCBpZCwgYWNjb3VudCkgPT4ge1xcXFxuICAgICAgICAgICAgc2hvd0xvYWRpbmcoXFxcXFxcXCLor7fogJDlv4PnrYnlvoVcXFxcXFxcIik7XFxcXG4gICAgICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGNvbmZpcm0sIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xcXFxuICAgICAgICAgICAgICAgICAgICB9LFxcXFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhcmFtc1xcXFxcXFwiOiB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJyZWdpc3RfaWRcXFxcXFxcIjogaWQsXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJ5em1cXFxcXFxcIjogaW5wdXRcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICAgICAgfSksXFxcXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnXFxcXG4gICAgICAgICAgICAgICAgfSk7XFxcXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpLnJlc3VsdDtcXFxcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyAhPT0gMCkge1xcXFxuICAgICAgICAgICAgICAgICAgICBoaWRlTG9hZGluZygpO1xcXFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL1xcXFxcXFwiICsgcmVzdWx0LmRldGFpbDtcXFxcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xcXFxuICAgICAgICAgICAgICAgICAgICBwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2VVc2VybmFtZVxcXFxcXFwiLCBhY2NvdW50WzBdKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgcHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlUGFzc3dvcmRcXFxcXFxcIiwgYWNjb3VudFsxXSk7XFxcXG4gICAgICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7XFxcXG4gICAgICAgICAgICAgICAgICAgIGJhY2soKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/miJDlip/mj5DkuqTms6jlhozms6jlhoxcXFxcXFxcXG5cXFxcXFxcIityZXN1bHQuZGV0YWlsO1xcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgICAgICAgICBoaWRlTG9hZGluZygpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5Ye66ZSZ5LqG5ZGQXFxcXFxcXCI7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH0sIGNvbmZpcm0sIGlkcmVzdWx0LnJlc3VsdCwgW3VzZXJuYW1lLCBwYXNzd29yZF0pO1xcXFxuICAgIH0sIGdldEFwaShcXFxcXFxcIm5ld19nZXRJZFxcXFxcXFwiKSwgZ2V0QXBpKFxcXFxcXFwibmV3X2NvbmZpcm1cXFxcXFxcIikpLFxcXFxuICAgIGNvbF90eXBlOiAndGV4dF9jZW50ZXJfMSdcXFxcbn0pO1xcXFxuc2V0UmVzdWx0KGRhdGEpO1xcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJ0ZXh0XzFcXFwiLFxcXCJuYW1lXFxcIjpcXFwi5Liq5Lq66LWE5paZXFxcIixcXFwicGF0aFxcXCI6XFxcIlBlcnNvbmFsRGF0YVxcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbnNldFBhZ2VUaXRsZShcXFxcXFxcIuS4quS6uui1hOaWmVxcXFxcXFwiKTtcXFxcbnZhciBkYXRhPVtdO1xcXFxuY29uc3Qge1xcXFxuICAgIGdldEFwaSxcXFxcbiAgICBnZXRGaWxlLFxcXFxuICAgIGFwaVxcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG5cXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgY29sX3R5cGU6XFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCJcXFxcbn0pO1xcXFxuXFxcXG5sZXQge3VzZXJuYW1lLHBhc3N3b3JkfSA9IGdldEZpbGUoKTtcXFxcbmxldCBkZXYgPSBKU09OLnBhcnNlKHJlcXVlc3QoZ2V0QXBpKFxcXFxcXFwidXNlclxcXFxcXFwiKStNWV9QQVJBTVMuaWQpKS5yZXN1bHQ7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOlxcXFxcXFwi5aS05YOPXFxcXFxcXCIsXFxcXG4gICAgZGVzYzpkZXYuYXZhdGFyLFxcXFxuICAgIHVybDpcXFxcXFxcImhpa2VyOi8vcGFnZS9tb2RpZnlfUGVyc29uYWxEYXRhI25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXFxcXFwiLFxcXFxuICAgIGV4dHJhOntcXFxcbiAgICAgICAgZGV2OmRldixcXFxcbiAgICAgICAgdXNlcm5hbWU6dXNlcm5hbWUsXFxcXG4gICAgICAgIHBhc3N3b3JkOnBhc3N3b3JkLFxcXFxuICAgICAgICBQYXR0ZXJuOjBcXFxcbiAgICB9LFxcXFxuICAgIGNvbF90eXBlOlxcXFxcXFwidGV4dF8xXFxcXFxcXCJcXFxcbn0pO1xcXFxuXFxcXG5cXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6XFxcXFxcXCLmmLXnp7BcXFxcXFxcIixcXFxcbiAgICBkZXNjOmRldi5uYW1lLFxcXFxuICAgIHVybDpcXFxcXFxcImhpa2VyOi8vcGFnZS9tb2RpZnlfUGVyc29uYWxEYXRhI25vSGlzdG9yeSMjbm9SZWNvcmRIaXN0b3J5I1xcXFxcXFwiLFxcXFxuICAgIGV4dHJhOntcXFxcbiAgICAgICAgZGV2OmRldixcXFxcbiAgICAgICAgdXNlcm5hbWU6dXNlcm5hbWUsXFxcXG4gICAgICAgIHBhc3N3b3JkOnBhc3N3b3JkLFxcXFxuICAgICAgICBQYXR0ZXJuOjFcXFxcbiAgICB9LFxcXFxuICAgIGNvbF90eXBlOlxcXFxcXFwidGV4dF8xXFxcXFxcXCJcXFxcbn0pO1xcXFxuXFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOlxcXFxcXFwi5a+G56CBXFxcXFxcXCIsXFxcXG4gICAgdXJsOlxcXFxcXFwiaGlrZXI6Ly9wYWdlL21vZGlmeV9QZXJzb25hbERhdGEjbm9IaXN0b3J5IyNub1JlY29yZEhpc3RvcnkjXFxcXFxcXCIsXFxcXG4gICAgZXh0cmE6e1xcXFxuICAgICAgICBkZXY6ZGV2LFxcXFxuICAgICAgICB1c2VybmFtZTp1c2VybmFtZSxcXFxcbiAgICAgICAgcGFzc3dvcmQ6cGFzc3dvcmQsXFxcXG4gICAgICAgIFBhdHRlcm46MlxcXFxuICAgIH0sXFxcXG4gICAgY29sX3R5cGU6XFxcXFxcXCJ0ZXh0XzFcXFxcXFxcIlxcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIGNvbF90eXBlOlxcXFxcXFwibGluZV9ibGFua1xcXFxcXFwiXFxcXG59KTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6XFxcXFxcXCLotKblj7fvvJpcXFxcXFxcIit1c2VybmFtZSxcXFxcbiAgICB1cmw6XFxcXFxcXCJjb3B5Oi8vXFxcXFxcXCIrdXNlcm5hbWUsXFxcXG4gICAgY29sX3R5cGU6XFxcXFxcXCJ0ZXh0XzFcXFxcXFxcIlxcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOlxcXFxcXFwiVUlE77yaXFxcXFxcXCIrZGV2LmlkLFxcXFxuICAgIHVybDpcXFxcXFxcImNvcHk6Ly9cXFxcXFxcIitkZXYuaWQsXFxcXG4gICAgY29sX3R5cGU6XFxcXFxcXCJ0ZXh0XzFcXFxcXFxcIlxcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIGNvbF90eXBlOlxcXFxcXFwibGluZV9ibGFua1xcXFxcXFwiXFxcXG59KTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6XFxcXFxcXCLmj5DkuqTkupHku5PlupPop4TliJlcXFxcXFxcIixcXFxcbiAgICB1cmw6JChcXFxcXFxcIiNub0xvYWRpbmcjXFxcXFxcXCIpLmxhenlSdWxlKChob3N0KT0+e1xcXFxuICAgICAgICBsZXQgY29kZT1yZXF1ZXN0KGhvc3QrXFxcXFxcXCIvaGlrZXJ1bGUvcnVsZWxpc3QuanNvbj9pZD0xNDVcXFxcXFxcIik7XFxcXG4gICAgICAgIGxldCB3b3JkPVxcXFxcXFwi77+lcHVibGlzaO+/pVxcXFxcXFwiK2Jhc2U2NEVuY29kZShjb2RlKTtcXFxcbiAgICAgICAgcmV0dXJuIFxcXFxcXFwicnVsZTovL1xcXFxcXFwiK2Jhc2U2NEVuY29kZSh3b3JkKTtcXFxcbiAgICB9LGFwaS5ob3N0KSxcXFxcbiAgICBjb2xfdHlwZTpcXFxcXFxcInRleHRfMVxcXFxcXFwiXFxcXG59KTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6XFxcXFxcXCLlkIzmraXmj5DkuqTkupHku5PlupPotKblj7flr4bnoIFcXFxcXFxcIixcXFxcbiAgICB1cmw6XFxcXFxcXCJydWxlOi8vXFxcXFxcXCIrYmFzZTY0RW5jb2RlKFxcXFxcXFwi77+lcHVibGlzaF9hY2NvdW5077+lXFxcXFxcXCIrdXNlcm5hbWUrXFxcXFxcXCJAXFxcXFxcXCIrcGFzc3dvcmQpLFxcXFxuICAgIGNvbF90eXBlOlxcXFxcXFwidGV4dF8xXFxcXFxcXCJcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBjb2xfdHlwZTpcXFxcXFxcImxpbmVfYmxhbmtcXFxcXFxcIlxcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOlxcXFxcXFwi5L2g5LiA5YWx5Y+R5biD5LqG44CMXFxcXFxcXCIrZGV2LnJ1bGVfbnVtK1xcXFxcXFwi44CN5p2h6KeE5YiZXFxcXFxcXCIsXFxcXG4gICAgdXJsOlxcXFxcXFwiaGlrZXI6Ly9lbXB0eVxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOlxcXFxcXFwidGV4dF8xXFxcXFxcXCJcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBjb2xfdHlwZTpcXFxcXFxcImxpbmVfYmxhbmtcXFxcXFxcIlxcXFxufSk7XFxcXG5sZXQgdXNlciA9IGdldEZpbGUoKTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6XFxcXFxcXCLms6jplIDnmbvlvZVcXFxcXFxcIixcXFxcbiAgICB1cmw6JChcXFxcXFxcIuehruiupOazqOmUgOeZu+W9lT9cXFxcXFxcIikuY29uZmlybShmID0+IHtcXFxcbiAgICAgICAgZi51c2VybmFtZT1cXFxcXFxcIlxcXFxcXFwiO1xcXFxuICAgICAgICBmLnBhc3N3b3JkPVxcXFxcXFwiXFxcXFxcXCI7XFxcXG4gICAgICAgIHdyaXRlRmlsZSgnaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb24nLCBKU09OLnN0cmluZ2lmeShmKSk7XFxcXG4gICAgICAgIHB1dFZhcihcXFxcXFxcIldhcmVob3VzZS5iYWNrXFxcXFxcXCIsXFxcXFxcXCIxXFxcXFxcXCIpO1xcXFxuICAgICAgICBiYWNrKCk7XFxcXG4gICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5bey5rOo6ZSAXFxcXFxcXCI7XFxcXG4gICAgfSx1c2VyKSxcXFxcbiAgICBjb2xfdHlwZTpcXFxcXFxcInRleHRfY2VudGVyXzFcXFxcXFxcIlxcXFxufSk7XFxcXG5zZXRSZXN1bHQoZGF0YSk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi5pu05pS55Liq5Lq66LWE5paZXFxcIixcXFwicGF0aFxcXCI6XFxcIm1vZGlmeV9QZXJzb25hbERhdGFcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG5jb25zdCB7XFxcXG4gICAgZ2V0QXBpLFxcXFxuICAgIGNvbG9yLFxcXFxuICAgIHNtYWxsLFxcXFxuICAgIGdldEZpbGUsXFxcXG4gICAgaHRtbFRhZ1xcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG5sZXQge1xcXFxuICAgIGRldixcXFxcbiAgICB1c2VybmFtZSxcXFxcbiAgICBwYXNzd29yZCxcXFxcbiAgICBQYXR0ZXJuXFxcXG59ID0gTVlfUEFSQU1TO1xcXFxudmFyIGRhdGEgPSBbXTtcXFxcbmxldCBwYXRoID0gXFxcXFxcXCI/cXE9XFxcXFxcXCIgKyB1c2VybmFtZSArIFxcXFxcXFwiJnBhc3N3b3JkPVxcXFxcXFwiICsgcGFzc3dvcmQ7XFxcXG5hZGRMaXN0ZW5lcignb25DbG9zZScsICQudG9TdHJpbmcoKCkgPT4ge1xcXFxuICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLm0ucGV0TmFtZVxcXFxcXFwiKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5tLmF2YXRhclxcXFxcXFwiKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5tLlBhc3N3b3JkLmNcXFxcXFxcIik7XFxcXG4gICAgY2xlYXJWYXIoXFxcXFxcXCJXYXJlaG91c2UubS5QYXNzd29yZC54XFxcXFxcXCIpO1xcXFxuICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLm0uUGFzc3dvcmQueVxcXFxcXFwiKTtcXFxcbn0pKTtcXFxcbmZ1bmN0aW9uIG1fcGV0TmFtZSgpIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCJcXFxcbiAgICB9KTtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICBjb2xfdHlwZTogJ2lucHV0JyxcXFxcbiAgICAgICAgZGVzYzogXFxcXFxcXCLor7fovpPlhaXmlrDmmLXnp7BcXFxcXFxcIixcXFxcbiAgICAgICAgZXh0cmE6IHtcXFxcbiAgICAgICAgICAgIHRpdGxlVmlzaWJsZTogZmFsc2UsXFxcXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWU6IGdldFZhcignV2FyZWhvdXNlLm0ucGV0TmFtZScsICcnKXx8ZGV2Lm5hbWUsXFxcXG4gICAgICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFxcXFxcIldhcmVob3VzZS5tLnBldE5hbWVcXFxcXFxcIixpbnB1dCknXFxcXG4gICAgICAgIH1cXFxcbiAgICB9KTtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCJcXFxcbiAgICB9KTtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLkv53lrZhcXFxcXFxcIixcXFxcbiAgICAgICAgdXJsOiAkKGdldEFwaShcXFxcXFxcIm1vZGlmeV9uYW1lXFxcXFxcXCIpICsgcGF0aCkubGF6eVJ1bGUoKCkgPT4ge1xcXFxuICAgICAgICAgICAgbGV0IG5ld1BldE5hbWUgPSBnZXRWYXIoJ1dhcmVob3VzZS5tLnBldE5hbWUnLCAnJyk7XFxcXG4gICAgICAgICAgICBpZiAobmV3UGV0TmFtZSA9PSBcXFxcXFxcIlxcXFxcXFwiKSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/kvaDov5jku4DkuYjpg73msqHloavllYohXFxcXFxcXCI7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVxdWVzdChpbnB1dCArIFxcXFxcXFwiJm5hbWU9XFxcXFxcXCIgKyBlbmNvZGVVUklDb21wb25lbnQobmV3UGV0TmFtZSkpO1xcXFxuICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpO1xcXFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDApIHtcXFxcbiAgICAgICAgICAgICAgICBiYWNrKCk7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/kv67mlLnmiJDlip9cXFxcXFxcIjtcXFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly9cXFxcXFxcIiArIHJlc3VsdC5kZXRhaWw7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH0pLFxcXFxuICAgICAgICBjb2xfdHlwZTogJ3RleHRfY2VudGVyXzEnXFxcXG4gICAgfSk7XFxcXG59XFxcXG5cXFxcbmZ1bmN0aW9uIG1fYXZhdGFyKCkge1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcImxpbmVfYmxhbmtcXFxcXFxcIlxcXFxuICAgIH0pO1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcXFxuICAgICAgICBkZXNjOiBcXFxcXFxcIuivt+i+k+WFpeaWsOeahOWktOWDj+mTvuaOpVxcXFxcXFwiLFxcXFxuICAgICAgICBleHRyYToge1xcXFxuICAgICAgICAgICAgdGl0bGVWaXNpYmxlOiBmYWxzZSxcXFxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS5hdmF0YXInLCAnJykgfHwgZGV2LmF2YXRhcixcXFxcbiAgICAgICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLm0uYXZhdGFyXFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgICAgICB9XFxcXG4gICAgfSk7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwibGluZV9ibGFua1xcXFxcXFwiXFxcXG4gICAgfSk7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IFxcXFxcXFwi5L+d5a2YXFxcXFxcXCIsXFxcXG4gICAgICAgIHVybDogJChnZXRBcGkoXFxcXFxcXCJtb2RpZnlfYXZhXFxcXFxcXCIpICsgcGF0aCkubGF6eVJ1bGUoKCkgPT4ge1xcXFxuICAgICAgICAgICAgbGV0IG5ld0F2YXRhciA9IGdldFZhcignV2FyZWhvdXNlLm0uYXZhdGFyJywgJycpO1xcXFxuICAgICAgICAgICAgXFxcXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVxdWVzdChpbnB1dCArIFxcXFxcXFwiJmF2YXRhcl91cmw9XFxcXFxcXCIgKyBlbmNvZGVVUklDb21wb25lbnQobmV3QXZhdGFyKSk7XFxcXG4gICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3VsdCk7XFxcXG4gICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMCkge1xcXFxuICAgICAgICAgICAgICAgIGJhY2soKTtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+S/ruaUueaIkOWKn1xcXFxcXFwiO1xcXFxuICAgICAgICAgICAgfSBlbHNlIHtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL1xcXFxcXFwiICsgcmVzdWx0LmRldGFpbDtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfSksXFxcXG4gICAgICAgIGNvbF90eXBlOiAndGV4dF9jZW50ZXJfMSdcXFxcbiAgICB9KTtcXFxcbn1cXFxcblxcXFxuZnVuY3Rpb24gbV9wd2QoKSB7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwibGluZV9ibGFua1xcXFxcXFwiXFxcXG4gICAgfSk7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6XFxcXFxcXCLljp/lr4bnoIFcXFxcXFxcIixcXFxcbiAgICAgICAgY29sX3R5cGU6ICdpbnB1dCcsXFxcXG4gICAgICAgIGRlc2M6IFxcXFxcXFwi6K+36L6T5YWl5Y6f5a+G56CBXFxcXFxcXCIsXFxcXG4gICAgICAgIGV4dHJhOiB7XFxcXG4gICAgICAgICAgICB0eXBlOlxcXFxcXFwicGFzc3dvcmRcXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS5QYXNzd29yZC55JywgJycpLFxcXFxuICAgICAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2UubS5QYXNzd29yZC55XFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgICAgICB9XFxcXG4gICAgfSk7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwibGluZV9ibGFua1xcXFxcXFwiXFxcXG4gICAgfSk7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6XFxcXFxcXCLmlrDlr4bnoIFcXFxcXFxcIixcXFxcbiAgICAgICAgY29sX3R5cGU6ICdpbnB1dCcsXFxcXG4gICAgICAgIGRlc2M6IFxcXFxcXFwi6K+36L6T5YWl5paw5a+G56CBXFxcXFxcXCIsXFxcXG4gICAgICAgIGV4dHJhOiB7XFxcXG4gICAgICAgICAgICB0eXBlOlxcXFxcXFwicGFzc3dvcmRcXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS5QYXNzd29yZC54JywgJycpLFxcXFxuICAgICAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2UubS5QYXNzd29yZC54XFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgICAgICB9XFxcXG4gICAgfSk7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6XFxcXFxcXCLph43lpI3mlrDlr4bnoIFcXFxcXFxcIixcXFxcbiAgICAgICAgY29sX3R5cGU6ICdpbnB1dCcsXFxcXG4gICAgICAgIGRlc2M6IFxcXFxcXFwi6K+36YeN5aSN5paw5a+G56CBXFxcXFxcXCIsXFxcXG4gICAgICAgIGV4dHJhOiB7XFxcXG4gICAgICAgICAgICB0eXBlOlxcXFxcXFwicGFzc3dvcmRcXFxcXFxcIixcXFxcbiAgICAgICAgICAgIHRpdGxlVmlzaWJsZTogZmFsc2UsXFxcXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWU6IGdldFZhcignV2FyZWhvdXNlLm0uUGFzc3dvcmQuYycsICcnKSxcXFxcbiAgICAgICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLm0uUGFzc3dvcmQuY1xcXFxcXFwiLGlucHV0KSdcXFxcbiAgICAgICAgfVxcXFxuICAgIH0pO1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcImxpbmVfYmxhbmtcXFxcXFxcIlxcXFxuICAgIH0pO1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBcXFxcXFxcIuS/neWtmFxcXFxcXFwiLFxcXFxuICAgICAgICB1cmw6ICQoZ2V0QXBpKFxcXFxcXFwibW9kaWZ5X3B3ZFxcXFxcXFwiKStwYXRoKS5sYXp5UnVsZSgocGFzc3dvcmQsdXNlcm5hbWUpID0+IHtcXFxcbiAgICAgICAgICAgIGxldCBvbGRfcGFzc3dvcmQgPSBnZXRWYXIoJ1dhcmVob3VzZS5tLlBhc3N3b3JkLnknLCAnJyk7XFxcXG4gICAgICAgICAgICBsZXQgbmV3X3Bhc3N3b3JkID0gZ2V0VmFyKCdXYXJlaG91c2UubS5QYXNzd29yZC54JywgJycpO1xcXFxuICAgICAgICAgICAgbGV0IG5ld19wYXNzd29yZF9hZ2FpbiA9IGdldFZhcignV2FyZWhvdXNlLm0uUGFzc3dvcmQuYycsICcnKTtcXFxcbiAgICAgICAgICAgIGlmIChvbGRfcGFzc3dvcmQhPT1wYXNzd29yZCkge1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5Y6f5a+G56CB6ZSZ6K+vXFxcXFxcXCI7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICBpZihuZXdfcGFzc3dvcmQ9PT1cXFxcXFxcIlxcXFxcXFwiKXtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+ivt+i+k+WFpeaWsOWvhueggVxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgaWYobmV3X3Bhc3N3b3JkIT09bmV3X3Bhc3N3b3JkX2FnYWluKXtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+S4pOasoeWvhueggeS4jeWQjFxcXFxcXFwiXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVxdWVzdChpbnB1dCArIFxcXFxcXFwiJm5ld19wYXNzd29yZD1cXFxcXFxcIiArIG5ld19wYXNzd29yZCtcXFxcXFxcIiZuZXdfcGFzc3dvcmRfcmU9XFxcXFxcXCIrbmV3X3Bhc3N3b3JkX2FnYWluKTtcXFxcbiAgICAgICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2UocmVzdWx0KTtcXFxcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAwKSB7XFxcXG4gICAgICAgICAgICAgICAgd3JpdGVGaWxlKFxcXFxcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb25cXFxcXFxcIixKU09OLnN0cmluZ2lmeSh7XFxcXG4gICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOnVzZXJuYW1lLFxcXFxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDpuZXdfcGFzc3dvcmRcXFxcbiAgICAgICAgICAgICAgICB9KSk7XFxcXG4gICAgICAgICAgICAgICAgYmFjaygpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5L+u5pS55oiQ5YqfXFxcXFxcXCI7XFxcXG4gICAgICAgICAgICB9IGVsc2Uge1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vXFxcXFxcXCIgKyByZXN1bHQuZGV0YWlsO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9LHBhc3N3b3JkLHVzZXJuYW1lKSxcXFxcbiAgICAgICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJ1xcXFxuICAgIH0pO1xcXFxufVxcXFxuXFxcXG5zd2l0Y2ggKFBhdHRlcm4pIHtcXFxcbiAgICBjYXNlIDA6XFxcXG4gICAgICAgIHNldFBhZ2VUaXRsZShcXFxcXFxcIuS/ruaUueWktOWDj1xcXFxcXFwiKTtcXFxcbiAgICAgICAgbV9hdmF0YXIoKTtcXFxcbiAgICAgICAgYnJlYWs7XFxcXG4gICAgY2FzZSAxOlxcXFxuICAgICAgICBzZXRQYWdlVGl0bGUoXFxcXFxcXCLkv67mlLnmmLXnp7BcXFxcXFxcIik7XFxcXG4gICAgICAgIG1fcGV0TmFtZSgpO1xcXFxuICAgICAgICBicmVhaztcXFxcbiAgICBjYXNlIDI6XFxcXG4gICAgICAgIHNldFBhZ2VUaXRsZShcXFxcXFxcIuS/ruaUueWvhueggVxcXFxcXFwiKTtcXFxcbiAgICAgICAgbV9wd2QoKTtcXFxcbiAgICAgICAgYnJlYWs7XFxcXG59XFxcXG5zZXRSZXN1bHQoZGF0YSk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi57yW6L6R6KeE5YiZ5aSH5rOoXFxcIixcXFwicGF0aFxcXCI6XFxcInNldF9ydWxlX25vdGVzXFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxubGV0IGRhdGEgPSBbXTtcXFxcbmNvbnN0IHtcXFxcbiAgICBnZXRBcGlcXFxcbn0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcXFxcXCIpO1xcXFxubGV0IHtcXFxcbiAgICBpZCxcXFxcbiAgICB1c2VybmFtZSxcXFxcbiAgICBwYXNzd29yZCxcXFxcbiAgICBuYW1lXFxcXG59ID0gTVlfUEFSQU1TO1xcXFxuc2V0UGFnZVRpdGxlKFxcXFxcXFwi5aSH5rOo44CMXFxcXFxcXCIrbmFtZStcXFxcXFxcIuOAjVxcXFxcXFwiKTtcXFxcbmFkZExpc3RlbmVyKCdvbkNsb3NlJyxcXFxcXFxcImNsZWFyVmFyKCdXYXJlaG91c2UucnVsZS5ub3RlcycsICcnKVxcXFxcXFwiKTtcXFxcbmxldCBub3Rlcz1yZXF1ZXN0KGdldEFwaShcXFxcXFxcImdldF9ydWxlX25vdGVcXFxcXFxcIikraWQpO1xcXFxubm90ZXM9SlNPTi5wYXJzZShub3RlcykucmVzdWx0O1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBkZXNjOiBcXFxcXFxcIuinhOWImeWkh+azqC4uLi4uLlxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIHRpdGxlVmlzaWJsZTogZmFsc2UsXFxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UucnVsZS5ub3RlcycsICcnKXx8bm90ZXN8fFxcXFxcXFwiXFxcXFxcXCIsXFxcXG4gICAgICAgIHR5cGU6IFxcXFxcXFwidGV4dGFyZWFcXFxcXFxcIixcXFxcbiAgICAgICAgaGVpZ2h0Oi0xLFxcXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dFZhcihcXFxcXFxcIldhcmVob3VzZS5ydWxlLm5vdGVzXFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgIH1cXFxcbn0pO1xcXFxuXFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBcXFxcXFxcIuS/neWtmFxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfY2VudGVyXzFcXFxcXFxcIixcXFxcbiAgICB1cmw6ICQoZ2V0QXBpKFxcXFxcXFwic2V0X3J1bGVfbm90ZVxcXFxcXFwiKSArIGlkKS5sYXp5UnVsZSgodXNlcm5hbWUsIHBhc3N3b3JkKSA9PiB7XFxcXG4gICAgICAgIGxldCBub3RlcyA9IGdldFZhcignV2FyZWhvdXNlLnJ1bGUubm90ZXMnLCAnJyk7XFxcXG4gICAgICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGlucHV0LCB7XFxcXG4gICAgICAgICAgICBoZWFkZXJzOiB7XFxcXG4gICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xcXFxuICAgICAgICAgICAgfSxcXFxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcXFxcbiAgICAgICAgICAgICAgICBcXFxcXFxcInBhcmFtc1xcXFxcXFwiOiB7XFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwicXFcXFxcXFxcIjogdXNlcm5hbWUsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwicGFzc3dvcmRcXFxcXFxcIjogcGFzc3dvcmQsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwibm90ZVxcXFxcXFwiOm5vdGVzXFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgfSksXFxcXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJ1xcXFxuICAgICAgICB9KTtcXFxcbiAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpLnJlc3VsdDtcXFxcbiAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgIT09IDApIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vXFxcXFxcXCIgKyByZXN1bHQuZGV0YWlsO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGJhY2soZmFsc2UpO1xcXFxuICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+S/ruaUueaIkOWKn1xcXFxcXFwiO1xcXFxuICAgIH0sIHVzZXJuYW1lLCBwYXNzd29yZClcXFxcbn0pO1xcXFxuc2V0UmVzdWx0KGRhdGEpO1xcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJsaW5lXFxcIixcXFwibmFtZVxcXCI6XFxcIuivhOiuuuWIl+ihqFxcXCIsXFxcInBhdGhcXFwiOlxcXCJDb21tZW50XFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxuc2V0UGFnZVRpdGxlKFxcXFxcXFwi6K+E6K665YiX6KGoXFxcXFxcXCIpO1xcXFxuY29uc3Qge1xcXFxuICAgIGFwaVxcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG5sZXQgZGF0YSA9IFtdO1xcXFxubGV0IHtcXFxcbiAgICB0b3RhbFN1bSxcXFxcbiAgICBpZCxcXFxcbiAgICBub19hY3RpdmUsXFxcXG4gICAgdXNlcm5hbWUsXFxcXG4gICAgcGFzc3dvcmRcXFxcbn0gPSBNWV9QQVJBTVM7XFxcXG5sZXQgcGFnZSA9IHBhcnNlSW50KE1ZX1VSTC5zcGxpdChcXFxcXFxcIiNcXFxcXFxcIilbMV0pO1xcXFxubGV0IGRpc2N1c3NfdHlwZSA9IGdldFZhcihcXFxcXFxcIldhcmVob3VzZS5jb21tZW50LmRpc2N1c3NfdHlwZVxcXFxcXFwiLCBcXFxcXFxcIlxcXFxcXFwiKTtcXFxcbmlmIChwYWdlID09PSAxKSB7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwibGluZV9ibGFua1xcXFxcXFwiXFxcXG4gICAgfSk7XFxcXG4gICAgYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAkLnRvU3RyaW5nKCgpID0+IHtcXFxcbiAgICAgICAgcHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmNvbW1lbnQuZGlzY3Vzc190eXBlXFxcXFxcXCIsIFxcXFxcXFwiXFxcXFxcXCIpO1xcXFxuICAgIH0pKTtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLlhajpg6hcXFxcXFxcIiArIChkaXNjdXNzX3R5cGUgPT09IFxcXFxcXFwiXFxcXFxcXCIgPyBcXFxcXFxcIuKXiVxcXFxcXFwiIDogXFxcXFxcXCLil4tcXFxcXFxcIiksXFxcXG4gICAgICAgIHVybDogJChcXFxcXFxcIiNub0xvYWRpbmcjXFxcXFxcXCIpLmxhenlSdWxlKCgpID0+IHtcXFxcbiAgICAgICAgICAgIHB1dFZhcihcXFxcXFxcIldhcmVob3VzZS5jb21tZW50LmRpc2N1c3NfdHlwZVxcXFxcXFwiLCBcXFxcXFxcIlxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKCk7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJoaWtlcjovL2VtcHR5XFxcXFxcXCI7XFxcXG4gICAgICAgIH0pLFxcXFxuICAgICAgICBjb2xfdHlwZTogJ3RleHRfNCdcXFxcblxcXFxuICAgIH0pO1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBcXFxcXFxcIvCfkY3otZ5cXFxcXFxcIiArIChkaXNjdXNzX3R5cGUgPT09IFxcXFxcXFwiZ29vZFxcXFxcXFwiID8gXFxcXFxcXCLil4lcXFxcXFxcIiA6IFxcXFxcXFwi4peLXFxcXFxcXCIpLFxcXFxuICAgICAgICB1cmw6ICQoXFxcXFxcXCIjbm9Mb2FkaW5nI1xcXFxcXFwiKS5sYXp5UnVsZSgoKSA9PiB7XFxcXG4gICAgICAgICAgICBwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2UuY29tbWVudC5kaXNjdXNzX3R5cGVcXFxcXFxcIiwgXFxcXFxcXCJnb29kXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKTtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIjtcXFxcbiAgICAgICAgfSksXFxcXG4gICAgICAgIGNvbF90eXBlOiAndGV4dF80J1xcXFxuXFxcXG4gICAgfSk7XFxcXG4gICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgdGl0bGU6IFxcXFxcXFwi8J+Rjui4qVxcXFxcXFwiICsgKGRpc2N1c3NfdHlwZSA9PT0gXFxcXFxcXCJiYWRcXFxcXFxcIiA/IFxcXFxcXFwi4peJXFxcXFxcXCIgOiBcXFxcXFxcIuKXi1xcXFxcXFwiKSxcXFxcbiAgICAgICAgdXJsOiAkKFxcXFxcXFwiI25vTG9hZGluZyNcXFxcXFxcIikubGF6eVJ1bGUoKCkgPT4ge1xcXFxuICAgICAgICAgICAgcHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmNvbW1lbnQuZGlzY3Vzc190eXBlXFxcXFxcXCIsIFxcXFxcXFwiYmFkXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgcmVmcmVzaFBhZ2UoKTtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIjtcXFxcbiAgICAgICAgfSksXFxcXG4gICAgICAgIGNvbF90eXBlOiAndGV4dF80J1xcXFxuICAgIH0pO1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBcXFxcXFxcIuWbnuWkjVxcXFxcXFwiICsgKGRpc2N1c3NfdHlwZSA9PT0gXFxcXFxcXCJyZXBseVxcXFxcXFwiID8gXFxcXFxcXCLil4lcXFxcXFxcIiA6IFxcXFxcXFwi4peLXFxcXFxcXCIpLFxcXFxuICAgICAgICB1cmw6ICQoXFxcXFxcXCIjbm9Mb2FkaW5nI1xcXFxcXFwiKS5sYXp5UnVsZSgoKSA9PiB7XFxcXG4gICAgICAgICAgICBwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2UuY29tbWVudC5kaXNjdXNzX3R5cGVcXFxcXFxcIiwgXFxcXFxcXCJyZXBseVxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgIHJlZnJlc2hQYWdlKCk7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJoaWtlcjovL2VtcHR5XFxcXFxcXCI7XFxcXG4gICAgICAgIH0pLFxcXFxuICAgICAgICBjb2xfdHlwZTogJ3RleHRfNCdcXFxcbiAgICB9KTtcXFxcbn1cXFxcblxcXFxuXFxcXG5sZXQgaWNvbiA9IHtcXFxcbiAgICBcXFxcXFxcImdvb2RcXFxcXFxcIjogXFxcXFxcXCLwn5GNXFxcXFxcXCIsXFxcXG4gICAgXFxcXFxcXCJiYWRcXFxcXFxcIjogXFxcXFxcXCLwn5GOXFxcXFxcXCIsXFxcXG4gICAgXFxcXFxcXCJyZXBseVxcXFxcXFwiOlxcXFxcXFwi5byA5Y+R6ICF8J+Xo1xcXFxcXFwiXFxcXG59XFxcXG5sZXQgY29udHJvbD0ocGlkLGFjdGl2ZSk9PnZvaWQgMDtcXFxcbmlmKG5vX2FjdGl2ZSl7XFxcXG4gICAgY29udHJvbD1mdW5jdGlvbihwaWQsYWN0aXZlKXtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOmFjdGl2ZT9cXFxcXFxcIumakOiXj+ivhOiuulxcXFxcXFwiOlxcXFxcXFwi5bGV56S66K+E6K66XFxcXFxcXCIsXFxcXG4gICAgICAgICAgICB1cmw6JChhcGkuZGlzX2Rldl9jb250cm9sK3BpZCtcXFxcXFxcIj9xcT1cXFxcXFxcIiArIHVzZXJuYW1lICsgXFxcXFxcXCImcGFzc3dvcmQ9XFxcXFxcXCIgKyBwYXNzd29yZCtcXFxcXFxcIiNub0xvYWRpbmcjXFxcXFxcXCIpLmxhenlSdWxlKCgpPT57XFxcXG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdD1KU09OLnBhcnNlKHJlcXVlc3QoaW5wdXQpKTtcXFxcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSlcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL1xcXFxcXFwiK3Jlc3VsdC5kZXRhaWw7XFxcXG4gICAgICAgICAgICB9KSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOlxcXFxcXFwidGV4dF8yXFxcXFxcXCJcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgICAgICB0aXRsZTpcXFxcXFxcIuWIoOmZpOivhOiuulxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgdXJsOiQoXFxcXFxcXCLnoa7orqTliKDpmaTor6Xor4Torro/XFxcXFxcXCIpLmNvbmZpcm0oKGlucHV0KT0+e1xcXFxuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ9SlNPTi5wYXJzZShyZXF1ZXN0KGlucHV0KSk7XFxcXG4gICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UoZmFsc2UpXFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly9cXFxcXFxcIityZXN1bHQuZGV0YWlsO1xcXFxuICAgICAgICAgICAgfSxhcGkuZGlzX2Rldl9jb250cm9sK3BpZCtcXFxcXFxcIj9xcT1cXFxcXFxcIiArIHVzZXJuYW1lICsgXFxcXFxcXCImcGFzc3dvcmQ9XFxcXFxcXCIgKyBwYXNzd29yZCtcXFxcXFxcIiZkZWxldGU9MVxcXFxcXFwiKSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOlxcXFxcXFwidGV4dF8yXFxcXFxcXCJcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgICAgICBjb2xfdHlwZTpcXFxcXFxcImxpbmVcXFxcXFxcIlxcXFxuICAgICAgICB9KTtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOlxcXFxcXFwibGluZVxcXFxcXFwiXFxcXG4gICAgICAgIH0pO1xcXFxuICAgIH1cXFxcbn1cXFxcbmlmICh0b3RhbFN1bSA9PT0gMCkge1xcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBcXFxcXFxcIjxoNSBzdHlsZT0ndGV4dC1hbGlnbjpjZW50ZXInPuS4gOadoeivhOiuuuS5n+ayoeacie+8jOW/q+adpeaKouaymeWPkeWQp++8gTwvaDU+XFxcXFxcXCIsXFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInJpY2hfdGV4dFxcXFxcXFwiXFxcXG4gICAgfSk7XFxcXG59IGVsc2Uge1xcXFxuICAgIGxldCBjb21tZW50TGlzdCA9IEpTT04ucGFyc2UocmVxdWVzdChhcGkuZGlzX2dldCArIGlkICsgXFxcXFxcXCI/bGltaXQ9NSZwYWdlPVxcXFxcXFwiICsgcGFnZSArIFxcXFxcXFwiJm5vX2FjdGl2ZT1cXFxcXFxcIiArIG5vX2FjdGl2ZSArIFxcXFxcXFwiJmRpc2N1c3NfdHlwZT1cXFxcXFxcIiArIGRpc2N1c3NfdHlwZSkpLnJlc3VsdDtcXFxcbiAgICBmb3IgKGxldCBpdGVtIG9mIGNvbW1lbnRMaXN0KSB7XFxcXG4gICAgICAgIGxldCBSZXBseSA9IGl0ZW0uZGlzY3Vzc190eXBlPT09XFxcXFxcXCJyZXBseVxcXFxcXFwiJiZpdGVtLnJlcGx5X3RvX25hbWUhPT1mYWxzZSYmaXRlbS5yZXBseV90b19pZCE9PWZhbHNlP1xcXFxcXFwi4oCY4oCY5Zue5aSNQFxcXFxcXFwiK2l0ZW0ucmVwbHlfdG9fbmFtZStcXFxcXFxcIiAjXFxcXFxcXCIraXRlbS5kaXNjdXNzX2lkK1xcXFxcXFwi4oCZ4oCZXFxcXFxcXFxuXFxcXFxcXCI6XFxcXFxcXCJcXFxcXFxcIjtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLm5hbWUgKyBcXFxcXFxcIiZuYnNwOyZuYnNwOzxmb250IGNvbG9yPSdncmF5Jz48c21hbGw+I1xcXFxcXFwiICsgaXRlbS5pZCArIFxcXFxcXFwiPC9zbWFsbD48Zm9udD5cXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcImF2YXRhclxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgLy91cmw6IG5vX2FjdGl2ZT9cXFxcXFxcImhpa2VyOi8vcGFnZS9SZXBseVxcXFxcXFwiOlxcXFxcXFwidG9hc3Q6Ly9cXFxcXFxcIiArIGl0ZW0ucXEsXFxcXG5cXFxcdFxcXFx0ICAgICAgIHVybDpub19hY3RpdmU/XFxcXFxcXCJoaWtlcjovL3BhZ2UvUmVwbHlcXFxcXFxcIjpcXFxcXFxcIm1xcXdwYTovL2ltL2NoYXQ/Y2hhdF90eXBlPXdwYSZ1aW49XFxcXFxcXCIraXRlbS5xcSxcXFxcbiAgICAgICAgICAgIGV4dHJhOntcXFxcbiAgICAgICAgICAgICAgICBydWxlSWQ6IGlkLFxcXFxuICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcXFxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQsXFxcXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxcXFxuICAgICAgICAgICAgICAgIHJlcGx5SWQ6aXRlbS5pZFxcXFxuICAgICAgICAgICAgfSxcXFxcbiAgICAgICAgICAgIHBpY191cmw6IGl0ZW0uYXZhdGFyX3VybFxcXFxuICAgICAgICB9KTtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLmRpc2N1c3NfdGV4dCxcXFxcbiAgICAgICAgICAgIGRlc2M6IFJlcGx5K2l0ZW0uY3JlYXRlX2RhdGUgKyBcXFxcXFxcIsK3XFxcXFxcXCIgKyBpY29uW2l0ZW0uZGlzY3Vzc190eXBlXSxcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfMVxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vcGFnZS9pbmZvXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICBleHRyYTp7XFxcXG4gICAgICAgICAgICAgICAgbmFtZTppdGVtLm5hbWUsXFxcXG4gICAgICAgICAgICAgICAgdHlwZTpcXFxcXFxcImxvbmdfdGV4dFxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgIHRleHQ6aXRlbS5kaXNjdXNzX3RleHRcXFxcbiAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICBwaWNfdXJsOiBpdGVtLmF2YXRhcl91cmxcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgICAgIGNvbnRyb2woaXRlbS5pZCxpdGVtLmFjdGl2ZSk7XFxcXG4gICAgfVxcXFxuICAgIGlmIChjb21tZW50TGlzdC5sZW5ndGggPT09IDApIHtcXFxcbiAgICAgICAgZGF0YS5wdXNoKHtcXFxcbiAgICAgICAgICAgIGNvbF90eXBlOiBcXFxcXFxcImxpbmVfYmxhbmtcXFxcXFxcIlxcXFxuICAgICAgICB9KTtcXFxcbiAgICB9XFxcXG59XFxcXG5cXFxcbnNldFJlc3VsdChkYXRhKVxcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJtb3ZpZV8zXFxcIixcXFwibmFtZVxcXCI6XFxcIuWPkeihqOivhOiuulxcXCIsXFxcInBhdGhcXFwiOlxcXCJNYWtlQWNvbW1lbnRcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG5sZXQgZGF0YSA9IFtdO1xcXFxuY29uc3Qge1xcXFxuICAgIGFwaSxcXFxcbiAgICBnZXRGaWxlXFxcXG59ID0gJC5yZXF1aXJlKFxcXFxcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXFxcXFwiKTtcXFxcbmxldCB7XFxcXG4gICAgaWQsXFxcXG4gICAgbmFtZSxcXFxcbiAgICBkZWZhdWx0VHlwZVxcXFxufSA9IE1ZX1BBUkFNUztcXFxcbmxldCB1c2VyPWdldEZpbGUoKS51c2VyfHxbXFxcXFxcXCJcXFxcXFxcIixcXFxcXFxcIlxcXFxcXFwiXTtcXFxcblxcXFxuc2V0UGFnZVRpdGxlKFxcXFxcXFwi6K+E6K66KFxcXFxcXFwiICsgbmFtZSArIFxcXFxcXFwiKVxcXFxcXFwiKTtcXFxcbmFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKSA9PiB7XFxcXG4gICAgY2xlYXJWYXIoXFxcXFxcXCJXYXJlaG91c2UuY29tbWVudC50eXBlXFxcXFxcXCIpO1xcXFxuICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLmNvbW1lbnQudGV4dFxcXFxcXFwiKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5jb21tZW50LnFxXFxcXFxcXCIpO1xcXFxuICAgIHJlZnJlc2hQYWdlKGZhbHNlKTtcXFxcbn0pKTtcXFxcbmxldCB0eXBlID0gZ2V0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmNvbW1lbnQudHlwZVxcXFxcXFwiKSB8fCBkZWZhdWx0VHlwZXx8XFxcXFxcXCJnb29kXFxcXFxcXCI7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIGRlc2M6IFxcXFxcXFwi6K+E6K66Li4uLi4uXFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6ICdpbnB1dCcsXFxcXG4gICAgZXh0cmE6IHtcXFxcbiAgICAgICAgdGl0bGVWaXNpYmxlOiBmYWxzZSxcXFxcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBnZXRWYXIoJ1dhcmVob3VzZS5jb21tZW50LnRleHQnLCAnJyksXFxcXG4gICAgICAgIHR5cGU6IFxcXFxcXFwidGV4dGFyZWFcXFxcXFxcIixcXFxcbiAgICAgICAgaGVpZ2h0OjcsXFxcXG4gICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmNvbW1lbnQudGV4dFxcXFxcXFwiLGlucHV0KSdcXFxcbiAgICB9XFxcXG59KTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6XFxcXFxcXCLotKblj7fvvJpcXFxcXFxcIisodXNlclswXXx8XFxcXFxcXCJcXFxcXFxcIiksXFxcXG4gICAgZGVzYzpcXFxcXFxcIumqjOivgeegge+8mlxcXFxcXFwiKyh1c2VyWzFdfHxcXFxcXFxcIlxcXFxcXFwiKSxcXFxcbiAgICB1cmw6XFxcXFxcXCJoaWtlcjovL3BhZ2UvVXNlcnJlZ2lzdHJhdGlvblxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiAndGV4dF8xJyxcXFxcbiAgICBcXFxcbn0pO1xcXFxuXFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiAgKHR5cGUgPT09IFxcXFxcXFwiZ29vZFxcXFxcXFwiID8gXFxcXFxcXCLil4lcXFxcXFxcIiA6IFxcXFxcXFwi4peLXFxcXFxcXCIpK1xcXFxcXFwiIPCfkY1cXFxcXFxcIixcXFxcbiAgICB1cmw6ICQoXFxcXFxcXCIjbm9Mb2FkaW5nI1xcXFxcXFwiKS5sYXp5UnVsZSgoKSA9PiB7XFxcXG4gICAgICAgIHB1dFZhcihcXFxcXFxcIldhcmVob3VzZS5jb21tZW50LnR5cGVcXFxcXFxcIiwgXFxcXFxcXCJnb29kXFxcXFxcXCIpO1xcXFxuICAgICAgICByZWZyZXNoUGFnZSgpO1xcXFxuICAgICAgICByZXR1cm4gXFxcXFxcXCJoaWtlcjovL2VtcHR5XFxcXFxcXCI7XFxcXG4gICAgfSksXFxcXG4gICAgY29sX3R5cGU6ICd0ZXh0XzInXFxcXG5cXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogICh0eXBlID09PSBcXFxcXFxcImJhZFxcXFxcXFwiID8gXFxcXFxcXCLil4lcXFxcXFxcIiA6IFxcXFxcXFwi4peLXFxcXFxcXCIpK1xcXFxcXFwiIPCfkY5cXFxcXFxcIixcXFxcbiAgICB1cmw6ICQoXFxcXFxcXCIjbm9Mb2FkaW5nI1xcXFxcXFwiKS5sYXp5UnVsZSgoKSA9PiB7XFxcXG4gICAgICAgIHB1dFZhcihcXFxcXFxcIldhcmVob3VzZS5jb21tZW50LnR5cGVcXFxcXFxcIiwgXFxcXFxcXCJiYWRcXFxcXFxcIik7XFxcXG4gICAgICAgIHJlZnJlc2hQYWdlKCk7XFxcXG4gICAgICAgIHJldHVybiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIjtcXFxcbiAgICB9KSxcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcXFxcbn0pO1xcXFxuXFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBcXFxcXFxcIuaPkOS6pFxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcInRleHRfY2VudGVyXzFcXFxcXFxcIixcXFxcbiAgICB1cmw6ICQoYXBpLmRpc19uZXcgKyBpZCkubGF6eVJ1bGUoKEFjY291bnQpID0+IHtcXFxcbiAgICAgICAgbGV0IHRleHQgPSBnZXRWYXIoJ1dhcmVob3VzZS5jb21tZW50LnRleHQnLCAnJyk7XFxcXG4gICAgICAgIGxldCBbcXEsYXV0aF9jb2RlXSA9IEFjY291bnQ7XFxcXG4gICAgICAgIGxldCB0eXBlID0gZ2V0VmFyKCdXYXJlaG91c2UuY29tbWVudC50eXBlJykgfHwgJ2dvb2QnO1xcXFxuICAgICAgICBxcT1xcXx8XFxcXFxcXCJcXFxcXFxcIjtcXFxcbiAgICAgICAgYXV0aF9jb2RlPWF1dGhfY29kZXx8XFxcXFxcXCJcXFxcXFxcIjtcXFxcbiAgICAgICAgaWYocXE9PVxcXFxcXFwiXFxcXFxcXCJ8fGF1dGhfY29kZT09XFxcXFxcXCJcXFxcXFxcIil7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+acqueZu+W9lei0puWPt1xcXFxcXFwiO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGlmKHRleHQ9PVxcXFxcXFwiXFxcXFxcXCIpe1xcXFxuICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/kvaDov5jku4DkuYjpg73msqHlhpnllYpcXFxcXFxcIjtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBmdW5jdGlvbiByKHApIHtcXFxcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGlucHV0LCB7XFxcXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xcXFxuICAgICAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXFxcXG4gICAgICAgICAgICAgICAgfSxcXFxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShwKSxcXFxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJ1xcXFxuICAgICAgICAgICAgfSk7XFxcXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShyZXN1bHQpLnJlc3VsdDtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBsZXQgcCA9IHtcXFxcbiAgICAgICAgICAgIFxcXFxcXFwicGFyYW1zXFxcXFxcXCI6IHtcXFxcbiAgICAgICAgICAgICAgICBcXFxcXFxcImRpc2N1c3NfdGV4dFxcXFxcXFwiOiB0ZXh0LFxcXFxuICAgICAgICAgICAgICAgIFxcXFxcXFwicXFcXFxcXFxcIjogcXEsXFxcXG4gICAgICAgICAgICAgICAgXFxcXFxcXCJkaXNjdXNzX3R5cGVcXFxcXFxcIjogdHlwZSxcXFxcbiAgICAgICAgICAgICAgICBcXFxcXFxcImF1dGhfY29kZVxcXFxcXFwiOiBhdXRoX2NvZGVcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBsZXQgcmVzdWx0ID0gcihwKTtcXFxcbiAgICAgICAgaWYocmVzdWx0LnN0YXR1cz09PTApe1xcXFxuICAgICAgICAgICAgYmFjayhmYWxzZSk7XFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly9cXFxcXFxcIityZXN1bHQuZGV0YWlsO1xcXFxuXFxcXG4gICAgfSx1c2VyKVxcXFxufSk7XFxcXG5cXFxcbnNldFJlc3VsdChkYXRhKTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLkvKrnlKjmiLfms6jlhoxcXFwiLFxcXCJwYXRoXFxcIjpcXFwiVXNlcnJlZ2lzdHJhdGlvblxcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbmNvbnN0IHtcXFxcbiAgICBhcGksXFxcXG4gICAgZ2V0RmlsZSxcXFxcbiAgICBnZXRVc2VyRGF0ZVxcXFxufSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG5sZXQgZGF0YSA9IFtdO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCJcXFxcbn0pO1xcXFxuc2V0UGFnZVRpdGxlKFxcXFxcXFwi55So5oi35YiX6KGo566h55CGXFxcXFxcXCIpO1xcXFxuYWRkTGlzdGVuZXIoJ29uQ2xvc2UnLCAkLnRvU3RyaW5nKCgpID0+IHtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5tLnFxXFxcXFxcXCIpO1xcXFxuICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLm0ueXptXFxcXFxcXCIpO1xcXFxufSkpO1xcXFxubGV0IHVzZXIgPSBnZXRGaWxlKCk7XFxcXG5sZXQgdXNlck5hbWUgPSB1c2VyLnVzZXIgfHwgW1xcXFxcXFwiXFxcXFxcXCJdO1xcXFxudXNlck5hbWUgPSB1c2VyTmFtZVswXTtcXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IFxcXFxcXFwi4oCc4oCc4oCd4oCdPGJpZz4o5re75YqgL+mqjOivgSnotKblj7c8L2JpZz5cXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJ0ZXh0XzFcXFxcXFxcIixcXFxcbiAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9lbXB0eVxcXFxcXFwiXFxcXG59KTtcXFxcblxcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogXFxcXFxcXCLojrflj5ZcXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogJ2lucHV0JyxcXFxcbiAgICBkZXNjOiBcXFxcXFxcIuivt+i+k+WFpXFxXFxcXFxcXCIsXFxcXG4gICAgdXJsOiAkLnRvU3RyaW5nKChhLCBiKSA9PiB7XFxcXG4gICAgICAgIGxldCBxcSA9IGlucHV0O1xcXFxuICAgICAgICBpZiAocXEgPT0gXFxcXFxcXCJcXFxcXFxcIikge1xcXFxuICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/kvaDov5jku4DkuYjpg73msqHloavllYohXFxcXFxcXCI7XFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgc2hvd0xvYWRpbmcoXFxcXFxcXCLojrflj5bkuK0uLi5cXFxcXFxcIilcXFxcbiAgICAgICAgcmV0dXJuICQoXFxcXFxcXCIjbm9Mb2FkaW5nI1xcXFxcXFwiKS5sYXp5UnVsZSgocXEsIGEsIGIpID0+IHtcXFxcbiAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGEsIHtcXFxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XFxcXG4gICAgICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcXFxcbiAgICAgICAgICAgICAgICB9LFxcXFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJwYXJhbXNcXFxcXFxcIjoge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJxcVxcXFxcXFwiOiBxcVxcXFxuICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgfSksXFxcXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCdcXFxcbiAgICAgICAgICAgIH0pO1xcXFxuICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpLnJlc3VsdDtcXFxcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAwKSB7XFxcXG4gICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL1xcXFxcXFwiICsgcmVzdWx0LmRldGFpbDtcXFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxcXG4gICAgICAgICAgICAgICAgbGV0IHJlc3VsdDIgPSBKU09OLnBhcnNlKHJlcXVlc3QoYiArIFxcXFxcXFwiP3FxPVxcXFxcXFwiICsgcXEpKTtcXFxcbiAgICAgICAgICAgICAgICBoaWRlTG9hZGluZygpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vXFxcXFxcXCIgKyByZXN1bHQyLmRldGFpbDtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTtcXFxcbiAgICAgICAgICAgIHRocm93IGU7XFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgfSwgcXEsIGEsIGIpO1xcXFxuXFxcXG4gICAgfSwgYXBpLmRpc19uZXdfdXNlciwgYXBpLmRpc192ZXJpZnkpLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIHR5cGU6IFxcXFxcXFwibnVtYmVyXFxcXFxcXCIsXFxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS5xcScsICcnKSB8fCB1c2VyTmFtZSxcXFxcbiAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2UubS5xcVxcXFxcXFwiLGlucHV0KSdcXFxcbiAgICB9XFxcXG59KTtcXFxcblxcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBjb2xfdHlwZTogJ2lucHV0JyxcXFxcbiAgICBkZXNjOiBcXFxcXFxcIuivt+i+k+WFpemqjOivgeeggVxcXFxcXFwiLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIHRpdGxlVmlzaWJsZTogZmFsc2UsXFxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0VmFyKCdXYXJlaG91c2UubS55em0nLCAnJyksXFxcXG4gICAgICAgIG9uQ2hhbmdlOiAncHV0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLm0ueXptXFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgIH1cXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBjb2xfdHlwZTogJ3JpY2hfdGV4dCcsXFxcXG4gICAgdGl0bGU6IFxcXFxcXFwiPHNtYWxsPuaPkOekuu+8mjEu5q+P5aSp5Y+q6IO96I635Y+WNeasoemqjOivgeeggS48YnI+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Mi48cz7pqozor4HnoIHmnInmlYjmnJ/mjIHnu63kuIDlkajlt6blj7M8L3M+KOaaguaXtuS4jeS8mu+8jOW/mOiusOmqjOivgeeggeWPr+mAmui/h1FR5Y+36I635Y+WKTwvc21hbGw+XFxcXFxcXCJcXFxcbn0pO1xcXFxuXFxcXG5sZXQgdXNlckxpc3QgPSBnZXRVc2VyRGF0ZSgpO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogXFxcXFxcXCLpqozor4Ev55m75b2VXFxcXFxcXCIsXFxcXG4gICAgdXJsOiAkKFxcXFxcXFwi56Gu5a6a5L+d5a2Y77yM6aqM6K+B56CB5aGr6ZSZ77yM5peg5rOV6K+E6K665ZOmXFxcXFxcXCIpLmNvbmZpcm0oKGYsIGwsIGxvZ2luKSA9PiB7XFxcXG4gICAgICAgIGxldCBxcSA9IGdldFZhcignV2FyZWhvdXNlLm0ucXEnLCAnJyk7XFxcXG4gICAgICAgIGxldCB5em0gPSBnZXRWYXIoJ1dhcmVob3VzZS5tLnl6bScsICcnKTtcXFxcbiAgICAgICAgaWYgKHFxID09IFxcXFxcXFwiXFxcXFxcXCIgfHwgeXptID09IFxcXFxcXFwiXFxcXFxcXCIpIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vcXHmiJbpqozor4HnoIHkuLrnqbpcXFxcXFxcIjtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBsZXQgcmVzdWx0ID0gcmVxdWVzdChsb2dpbiwge1xcXFxuICAgICAgICAgICAgaGVhZGVyczoge1xcXFxuICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcXFxcbiAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XFxcXG4gICAgICAgICAgICAgICAgXFxcXFxcXCJwYXJhbXNcXFxcXFxcIjoge1xcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInFxXFxcXFxcXCI6IHFxLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcImF1dGhfY29kZVxcXFxcXFwiOiB5em1cXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICB9KSxcXFxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnXFxcXG4gICAgICAgIH0pO1xcXFxuICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3VsdCkucmVzdWx0O1xcXFxuICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMCkge1xcXFxuICAgICAgICAgICAgZi51c2VyID0gW3FxLCB5em1dO1xcXFxuICAgICAgICAgICAgd3JpdGVGaWxlKFxcXFxcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb25cXFxcXFxcIiwgSlNPTi5zdHJpbmdpZnkoZikpO1xcXFxuICAgICAgICAgICAgbGV0IGluZGV4ID0gbC5maW5kSW5kZXgoaXRlbSA9PiBpdGVtWzBdID09PSBxcSk7XFxcXG4gICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xcXFxuICAgICAgICAgICAgICAgIGwuc3BsaWNlKGluZGV4LCAxLCBbcXEsIHl6bV0pO1xcXFxuICAgICAgICAgICAgfSBlbHNlIGlmIChsLmxlbmd0aCA8IDYpIHtcXFxcbiAgICAgICAgICAgICAgICBsLnB1c2goW3FxLCB5em1dKTtcXFxcbiAgICAgICAgICAgIH0gZWxzZSB7XFxcXG4gICAgICAgICAgICAgICAgbC5zcGxpY2UoMCwgMSk7XFxcXG4gICAgICAgICAgICAgICAgbC5wdXNoKFtxcSwgeXptXSk7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICB3cml0ZUZpbGUoXFxcXFxcXCJoaWtlcjovL2ZpbGVzL1dhcmVob3VzZVVTRVJBLmpzb25cXFxcXFxcIiwgSlNPTi5zdHJpbmdpZnkobCkpO1xcXFxuICAgICAgICAgICAgYmFjaygpO1xcXFxuICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/pqozor4HmiJDlip9cXFxcXFxcIjtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL1xcXFxcXFwiICsgcmVzdWx0LmRldGFpbDtcXFxcbiAgICB9LCB1c2VyLCB1c2VyTGlzdCwgYXBpLmRpc19sb2dpbiksXFxcXG4gICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJ1xcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIGNvbF90eXBlOiBcXFxcXFxcImxpbmVfYmxhbmtcXFxcXFxcIlxcXFxufSk7XFxcXG5kYXRhLnB1c2goe1xcXFxuICAgIHRpdGxlOiBcXFxcXFxcIuKAnOKAnOKAneKAnTxiaWc+6LSm5Y+35YiX6KGoPC9iaWc+XFxcXFxcXFx0XFxcXFxcXFx0XFxcXFxcXFx0PHNtYWxsPijkv53nlZk15p2h6K6w5b2VKTwvc21hbGw+XFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8xXFxcXFxcXCIsXFxcXG4gICAgdXJsOiBcXFxcXFxcImhpa2VyOi8vZW1wdHlcXFxcXFxcIlxcXFxufSk7XFxcXG51c2VyTGlzdC5yZXZlcnNlKCk7XFxcXG5cXFxcbmZvciAobGV0IGl0ZW0gb2YgdXNlckxpc3QpIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLotKblj7fvvJpcXFxcXFxcIiArIGl0ZW1bMF0gKyAodXNlck5hbWUgPT09IGl0ZW1bMF0gPyBcXFxcXFxcIlxcXFxcXFxcdFxcXFxcXFxcdFxcXFxcXFxcdOKAnOKAnFvlvZPliY3otKblj7dd4oCd4oCdXFxcXFxcXCIgOiBcXFxcXFxcIlxcXFxcXFwiKSxcXFxcbiAgICAgICAgZGVzYzogXFxcXFxcXCLpqozor4HnoIHvvJpcXFxcXFxcIiArIGl0ZW1bMV0sXFxcXG4gICAgICAgIHVybDogJChcXFxcXFxcIuaYr+WQpuWIh+aNouS4uuivpVtcXFxcXFxcIiArIGl0ZW1bMF0gKyBcXFxcXFxcIl3otKblj7dcXFxcXFxcIikuY29uZmlybSgoZiwgaXRlbSkgPT4ge1xcXFxuICAgICAgICAgICAgZi51c2VyID0gaXRlbTtcXFxcbiAgICAgICAgICAgIHdyaXRlRmlsZShcXFxcXFxcImhpa2VyOi8vZmlsZXMvV2FyZWhvdXNlVVNFUi5qc29uXFxcXFxcXCIsIEpTT04uc3RyaW5naWZ5KGYpKTtcXFxcbiAgICAgICAgICAgIGJhY2soKTtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5YiH5o2i5oiQ5YqfXFxcXFxcXCI7XFxcXG4gICAgICAgIH0sIHVzZXIsIGl0ZW0pLFxcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJ0ZXh0XzFcXFxcXFxcIlxcXFxuICAgIH0pO1xcXFxufVxcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJsaW5lX2JsYW5rXFxcXFxcXCJcXFxcbn0pO1xcXFxuZGF0YS5wdXNoKHtcXFxcbiAgICB0aXRsZTogXFxcXFxcXCLpgIDlh7rotKblj7dcXFxcXFxcIixcXFxcbiAgICB1cmw6ICQoXFxcXFxcXCLnoa7orqTpgIDlh7rnmbvlvZXnirbmgIFcXFxcXFxcIikuY29uZmlybSgoZikgPT4ge1xcXFxuICAgICAgICBmLnVzZXIgPSBbXTtcXFxcbiAgICAgICAgd3JpdGVGaWxlKFxcXFxcXFwiaGlrZXI6Ly9maWxlcy9XYXJlaG91c2VVU0VSLmpzb25cXFxcXFxcIiwgSlNPTi5zdHJpbmdpZnkoZikpO1xcXFxuICAgICAgICBiYWNrKCk7XFxcXG4gICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v6YCA5Ye65oiQ5YqfXFxcXFxcXCI7XFxcXG4gICAgfSwgdXNlciksXFxcXG4gICAgY29sX3R5cGU6ICd0ZXh0X2NlbnRlcl8xJ1xcXFxufSk7XFxcXG5zZXRSZXN1bHQoZGF0YSk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi5YiX6KGo5o6S5bqP566X5rOVXFxcIixcXFwicGF0aFxcXCI6XFxcInNvcnRcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG4vKiDop4TliJnliJfooajmjpLluo8gWyBVUOOAgU5FV+OAgeaXoOabtOaWsCBdIOmhuuW6jyAqL1xcXFxuLyog5b2S5bm25o6S5bqPIFN0YXJ0ICovXFxcXG4vKlxcXFxuZnVuY3Rpb24gbWVyZ2VTb3J0KGFycikge1xcXFxuICAgIHZhciBsZW4gPSBhcnIubGVuZ3RoO1xcXFxuICAgIGlmIChsZW4gPCAyKSB7XFxcXG4gICAgICAgIHJldHVybiBhcnI7XFxcXG4gICAgfVxcXFxuICAgIHZhciBtaWRkbGUgPSBNYXRoLmZsb29yKGxlbiAvIDIpLFxcXFxuICAgICAgICBsZWZ0ID0gYXJyLnNsaWNlKDAsIG1pZGRsZSksXFxcXG4gICAgICAgIHJpZ2h0ID0gYXJyLnNsaWNlKG1pZGRsZSk7XFxcXG4gICAgcmV0dXJuIG1lcmdlKG1lcmdlU29ydChsZWZ0KSwgbWVyZ2VTb3J0KHJpZ2h0KSk7XFxcXG59XFxcXG5mdW5jdGlvbiBtZXJnZShsZWZ0LCByaWdodCkge1xcXFxuICAgIHZhciByZXN1bHQgPSBbXTtcXFxcbiAgICB2YXIgaXNUaGlzVmVyc2lvbkxpc3QgPSBbXTtcXFxcblxcXFxuICAgIHdoaWxlIChsZWZ0Lmxlbmd0aCA+IDAgJiYgcmlnaHQubGVuZ3RoID4gMCkge1xcXFxuICAgICAgICBpZiAobGVmdFswXS50aXRsZS5pbmNsdWRlcyhcXFxcXFxcIvCfhplcXFxcXFxcIikpIHtcXFxcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxlZnQuc2hpZnQoKSk7XFxcXG4gICAgICAgIH0gZWxzZSBpZiAocmlnaHRbMF0udGl0bGUuaW5jbHVkZXMoXFxcXFxcXCLwn4aZXFxcXFxcXCIpKSB7XFxcXG4gICAgICAgICAgICByZXN1bHQucHVzaChyaWdodC5zaGlmdCgpKTtcXFxcbiAgICAgICAgfSBlbHNlIGlmIChsZWZ0WzBdLnRpdGxlLmluY2x1ZGVzKFxcXFxcXFwi8J+GlVxcXFxcXFwiKSkge1xcXFxuICAgICAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcXFxcbiAgICAgICAgfSBlbHNlIGlmIChyaWdodFswXS50aXRsZS5pbmNsdWRlcyhcXFxcXFxcIvCfhpVcXFxcXFxcIikpIHtcXFxcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xcXFxuICAgICAgICB9IGVsc2Uge1xcXFxuICAgICAgICAgICAgaXNUaGlzVmVyc2lvbkxpc3QucHVzaChsZWZ0LnNoaWZ0KCkpO1xcXFxuICAgICAgICAgICAgaXNUaGlzVmVyc2lvbkxpc3QucHVzaChyaWdodC5zaGlmdCgpKTtcXFxcbiAgICAgICAgfVxcXFxuICAgIH1cXFxcblxcXFxuICAgIHdoaWxlIChpc1RoaXNWZXJzaW9uTGlzdC5sZW5ndGgpIHJlc3VsdC5wdXNoKGlzVGhpc1ZlcnNpb25MaXN0LnNoaWZ0KCkpO1xcXFxuXFxcXG4gICAgd2hpbGUgKGxlZnQubGVuZ3RoKVxcXFxuICAgICAgICByZXN1bHQucHVzaChsZWZ0LnNoaWZ0KCkpO1xcXFxuXFxcXG4gICAgd2hpbGUgKHJpZ2h0Lmxlbmd0aClcXFxcbiAgICAgICAgcmVzdWx0LnB1c2gocmlnaHQuc2hpZnQoKSk7XFxcXG5cXFxcbiAgICByZXR1cm4gcmVzdWx0O1xcXFxufVxcXFxuJC5leHBvcnRzLm1lcmdlU29ydCA9IG1lcmdlU29ydDtcXFxcbiovXFxcXG4vKiDlvZLlubbmjpLluo8gRW5kICovXFxcXG4vKiDmma7pgJrliIbnsbvmjpLluo8gU3RhcnQgKi9cXFxcbmZ1bmN0aW9uIG5vcm1hbFNvcnQoYXJyKSB7XFxcXG4gICAgdmFyIGxlbiA9IGFyci5sZW5ndGg7XFxcXG4gICAgaWYgKGxlbiA8IDIpIHtcXFxcbiAgICAgICAgcmV0dXJuIGFycjtcXFxcbiAgICB9XFxcXG4gICAgbGV0IHVwUmVzdWx0ID0gW107XFxcXG4gICAgbGV0IG90aGVyUmVzdWx0ID0gW107XFxcXG4gICAgd2hpbGUoYXJyLmxlbmd0aCkge1xcXFxuICAgICAgICBsZXQgaXRlbSA9IGFyci5zaGlmdCgpO1xcXFxuICAgICAgICBpZihpdGVtLnRpdGxlLmluY2x1ZGVzKFxcXFxcXFwi8J+GmVxcXFxcXFwiKSkge1xcXFxuICAgICAgICAgICAgdXBSZXN1bHQucHVzaChpdGVtKVxcXFxuICAgICAgICB9IGVsc2Uge1xcXFxuICAgICAgICAgICAgb3RoZXJSZXN1bHQucHVzaChpdGVtKVxcXFxuICAgICAgICB9XFxcXG4gICAgfVxcXFxuICAgIHJldHVybiB1cFJlc3VsdC5jb25jYXQob3RoZXJSZXN1bHQpO1xcXFxufVxcXFxuJC5leHBvcnRzLm5vcm1hbFNvcnQgPSBub3JtYWxTb3J0O1xcXFxuLyog5pmu6YCa5YiG57G75o6S5bqPIEVuZCAqL1xcXCJ9LHtcXFwiY29sX3R5cGVcXFwiOlxcXCJpY29uXzJfcm91bmRcXFwiLFxcXCJuYW1lXFxcIjpcXFwi5YWo6YOo5YWs5byA6KeE5YiZXFxcIixcXFwicGF0aFxcXCI6XFxcIkFsbFB1YmxpY1J1bGVcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG4gICAgY29uc3Qge1xcXFxuICAgICAgICBhcGksXFxcXG4gICAgICAgIGxvY2FsUnVsZVZlcixcXFxcbiAgICAgICAgZ2V0QXBpXFxcXG4gICAgfSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG5jb25zdCB7XFxcXG4gICAgbWVyZ2VTb3J0XFxcXG59ID0gJC5yZXF1aXJlKFxcXFxcXFwiaGlrZXI6Ly9wYWdlL3NvcnRcXFxcXFxcIik7XFxcXG5sZXQgZGF0YVR5cGUgPSBnZXRWYXIoXFxcXFxcXCJXYXJlaG91c2UudHlwZVxcXFxcXFwiLCBcXFxcXFxcIlxcXFxcXFwiKTtcXFxcbmxldCBvcmRlciA9IGdldFZhcihcXFxcXFxcIldhcmVob3VzZS5vcmRlclxcXFxcXFwiLCBcXFxcXFxcIjBcXFxcXFxcIik7XFxcXG5sZXQgc29ydCA9IGdldFZhcihcXFxcXFxcIldhcmVob3VzZS5zb3J0XFxcXFxcXCIsIFxcXFxcXFwiMFxcXFxcXFwiKTtcXFxcbmxldCBnb29kID0gZ2V0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmdvb2RcXFxcXFxcIiwgXFxcXFxcXCJcXFxcXFxcIik7XFxcXG5sZXQgcGFnZSA9IE1ZX1VSTC5zcGxpdChcXFxcXFxcIiNcXFxcXFxcIilbMV0gfHwgMTtcXFxcbmxldCBydWxlTGlzdCA9IEpTT04ucGFyc2UocmVxdWVzdChhcGkuYWxsX3J1bGUgKyBcXFxcXFxcIj9kYXRhX3R5cGU9XFxcXFxcXCIgKyBkYXRhVHlwZSArIFxcXFxcXFwiJnBhZ2U9XFxcXFxcXCIgKyBwYWdlICsgXFxcXFxcXCImbGltaXQ9MjAmb3JkZXI9XFxcXFxcXCIgKyBvcmRlciArIFxcXFxcXFwiJnNvcnQ9XFxcXFxcXCIgKyBzb3J0KyBcXFxcXFxcIiZpc19nb29kPVxcXFxcXFwiICsgZ29vZCkpLnJlc3VsdDtcXFxcbmFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKSA9PiB7XFxcXG4gICAgY2xlYXJWYXIoXFxcXFxcXCJXYXJlaG91c2UudHlwZVxcXFxcXFwiKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5vcmRlclxcXFxcXFwiKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIldhcmVob3VzZS5zb3J0XFxcXFxcXCIpO1xcXFxuICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLmdvb2RcXFxcXFxcIik7XFxcXG4gICAgY2xlYXJWYXIoXFxcXFxcXCJXYXJlaG91c2UuYmFja1xcXFxcXFwiKTtcXFxcbn0pKTtcXFxcbmxldCBkYXRhID0gW107XFxcXG5pZiAoZ2V0VmFyKFxcXFxcXFwiV2FyZWhvdXNlLmJhY2tcXFxcXFxcIikgPT09IFxcXFxcXFwiMVxcXFxcXFwiKSB7XFxcXG4gICAgYmFjaygpO1xcXFxufVxcXFxuZnVuY3Rpb24gdGFiKGFyciwgdHlwZSwgY29udHJhc3QpIHtcXFxcbiAgICBmb3IgKGxldCBpdGVtIG9mIGFycikge1xcXFxuICAgICAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW1bMV0gPT09IGNvbnRyYXN0ID8gXFxcXFxcXCLigJzigJxcXFxcXFxcIiArIGl0ZW1bMF0gKyBcXFxcXFxcIuKAneKAnVxcXFxcXFwiIDogaXRlbVswXSxcXFxcbiAgICAgICAgICAgIHVybDogJChcXFxcXFxcIiNub0xvYWRpbmcjXFxcXFxcXCIpLmxhenlSdWxlKChrZXksIHR5cGUpID0+IHtcXFxcbiAgICAgICAgICAgICAgICBwdXRWYXIodHlwZSwga2V5KTtcXFxcbiAgICAgICAgICAgICAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwiaGlrZXI6Ly9lbXB0eVxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgfSwgaXRlbVsxXSwgdHlwZSksXFxcXG4gICAgICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJzY3JvbGxfYnV0dG9uXFxcXFxcXCJcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgfVxcXFxuICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcImJsYW5rX2Jsb2NrXFxcXFxcXCJcXFxcbiAgICB9KTtcXFxcbn1cXFxcbmlmIChwYWdlID09PSBcXFxcXFxcIjFcXFxcXFxcIikge1xcXFxuICAgIHRhYihbXFxcXG4gICAgICAgIFtcXFxcXFxcIuWFqOmDqFxcXFxcXFwiLCBcXFxcXFxcIlxcXFxcXFwiXSxcXFxcbiAgICAgICAgW1xcXFxcXFwi5bCP56iL5bqPXFxcXFxcXCIsIFxcXFxcXFwiaG9tZV9ydWxlX3VybFxcXFxcXFwiXSxcXFxcbiAgICAgICAgW1xcXFxcXFwi5o+Q5Lqk5LqR5LuT5bqT6KeE5YiZXFxcXFxcXCIsIFxcXFxcXFwicHVibGlzaFxcXFxcXFwiXSxcXFxcbiAgICAgICAgW1xcXFxcXFwi572R6aG15o+S5Lu2XFxcXFxcXCIsIFxcXFxcXFwianNfdXJsXFxcXFxcXCJdLFxcXFxuICAgICAgICBbXFxcXFxcXCLpnZnmgIHpobXpnaJcXFxcXFxcIiwgXFxcXFxcXCJodG1sXFxcXFxcXCJdLFxcXFxuICAgICAgICBbXFxcXFxcXCLkuLvpophcXFxcXFxcIiwgXFxcXFxcXCJjb25maWdcXFxcXFxcIl1cXFxcbiAgICBdLCBcXFxcXFxcIldhcmVob3VzZS50eXBlXFxcXFxcXCIsIGRhdGFUeXBlKTtcXFxcbiAgICB0YWIoW1xcXFxuICAgICAgICBbXFxcXFxcXCLml7bpl7RcXFxcXFxcIiwgXFxcXFxcXCIwXFxcXFxcXCJdLFxcXFxuICAgICAgICBbXFxcXFxcXCJJRFxcXFxcXFwiLCBcXFxcXFxcIjFcXFxcXFxcIl0sXFxcXG4gICAgICAgIFtcXFxcXFxcIuWlveivhOW6plxcXFxcXFwiLCBcXFxcXFxcIjJcXFxcXFxcIl0sXFxcXG4gICAgICAgIFtcXFxcXFxcIuW3ruivhOW6plxcXFxcXFwiLCBcXFxcXFxcIjNcXFxcXFxcIl0sXFxcXG4gICAgICAgIFtcXFxcXFxcIuWbnuWkjeaVsFxcXFxcXFwiLCBcXFxcXFxcIjRcXFxcXFxcIl1cXFxcbiAgICBdLCBcXFxcXFxcIldhcmVob3VzZS5vcmRlclxcXFxcXFwiLCBvcmRlcik7XFxcXG4gICAgdGFiKFtcXFxcbiAgICAgICAgW1xcXFxcXFwi5YCS5bqPXFxcXFxcXCIsIFxcXFxcXFwiMFxcXFxcXFwiXSxcXFxcbiAgICAgICAgW1xcXFxcXFwi5q2j5bqPXFxcXFxcXCIsIFxcXFxcXFwiMVxcXFxcXFwiXVxcXFxuICAgIF0sIFxcXFxcXFwiV2FyZWhvdXNlLnNvcnRcXFxcXFxcIiwgc29ydCk7XFxcXG4gICAgdGFiKFtcXFxcbiAgICAgICAgW1xcXFxcXFwi5LiN6K66XFxcXFxcXCIsIFxcXFxcXFwiXFxcXFxcXCJdLFxcXFxuICAgICAgICBbXFxcXFxcXCLkvJjotKhcXFxcXFxcIiwgXFxcXFxcXCIxXFxcXFxcXCJdXFxcXG4gICAgXSwgXFxcXFxcXCJXYXJlaG91c2UuZ29vZFxcXFxcXFwiLCBnb29kKTtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCLmkJzntKJcXFxcXFxcIixcXFxcbiAgICAgICAgdXJsOiAkLnRvU3RyaW5nKG5hbWUgPT4gXFxcXFxcXCJoaWtlcjovL3NlYXJjaD9zPVxcXFxcXFwiICsgaW5wdXQgKyBcXFxcXFxcIiZydWxlPVxcXFxcXFwiICsgbmFtZSwgTVlfUlVMRS50aXRsZSksXFxcXG4gICAgICAgIGNvbF90eXBlOiBcXFxcXFxcImlucHV0XFxcXFxcXCIsXFxcXG4gICAgICAgIGRlc2M6IFxcXFxcXFwi5pCc57Si5YWo6YOo6KeE5YiZXFxcXFxcXCJcXFxcbiAgICB9KTtcXFxcbn1cXFxcblxcXFxubGV0IGhvbWVMaXN0ID0gSlNPTi5wYXJzZShyZXF1ZXN0KGFwaS5ob21lKSk7XFxcXG5sZXQgbVJ1bGVMaXN0ID0gW107XFxcXG5mb3IgKHZhciBpdGVtIG9mIHJ1bGVMaXN0KSB7XFxcXG4gICAgdmFyIG5hbWUgPSBpdGVtLm5hbWU7XFxcXG4gICAgaWYgKGl0ZW0uaXNfdGFwKSB7XFxcXG4gICAgICAgIGxldCBsb2NhdGlvbiA9IEpTT04ucGFyc2UocmVxdWVzdChnZXRBcGkoXFxcXFxcXCJydWxlTGlzdEpzb25cXFxcXFxcIikgKyBcXFxcXFxcIj9pZD1cXFxcXFxcIiArIGl0ZW0uaWQpKTtcXFxcbiAgICAgICAgaXRlbS5pZCA9IGxvY2F0aW9uLmlkO1xcXFxuICAgICAgICBpdGVtLm5hbWUgPSBsb2NhdGlvbi5uYW1lO1xcXFxuICAgICAgICBpdGVtLmF1dGhvciA9IGxvY2F0aW9uLmF1dGhvcjtcXFxcbiAgICAgICAgaXRlbS5kYXRhX3R5cGUgPSBsb2NhdGlvbi5kYXRhX3R5cGU7XFxcXG4gICAgICAgIGl0ZW0udmVyID0gbG9jYXRpb24udmVyXFxcXG4gICAgfVxcXFxuICAgIGl0ZW0udmVyc2lvbiA9IGl0ZW0udmVyO1xcXFxuICAgIGxldCBsYWJlbCA9IFxcXFxcXFwiXFxcXFxcXCIsXFxcXG4gICAgICAgIGx2ZXIgPSAtMjtcXFxcbiAgICBpZiAoaXRlbS5pc19qc29uICYmIGl0ZW0uZGF0YV90eXBlID09PSBcXFxcXFxcImhvbWVfcnVsZV91cmxcXFxcXFxcIikge1xcXFxuICAgICAgICBsdmVyID0gbG9jYWxSdWxlVmVyKGhvbWVMaXN0LCBpdGVtKTtcXFxcbiAgICAgICAgaWYgKGx2ZXIgPT09IC0xKSB7XFxcXG4gICAgICAgICAgICBsYWJlbCA9IFxcXFxcXFwi8J+GlVxcXFxcXFwiO1xcXFxuICAgICAgICB9IGVsc2UgaWYgKGx2ZXIgPCBpdGVtLnZlcikge1xcXFxuICAgICAgICAgICAgbGFiZWwgPSBcXFxcXFxcIvCfhplcXFxcXFxcIjtcXFxcbiAgICAgICAgfVxcXFxuICAgIH1cXFxcbiAgICBtUnVsZUxpc3QucHVzaCh7XFxcXG4gICAgICAgIHRpdGxlOiBsYWJlbCArIG5hbWUsXFxcXG4gICAgICAgIHVybDogXFxcXFxcXCJoaWtlcjovL3BhZ2UvcnVsZURldGFpbCNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFxcXFxcIixcXFxcbiAgICAgICAgZXh0cmE6IHtcXFxcbiAgICAgICAgICAgIGx2ZXI6IGx2ZXIsXFxcXG4gICAgICAgICAgICBpZDogaXRlbS5pZCxcXFxcbiAgICAgICAgICAgIGlzQWxsOnRydWVcXFxcbiAgICAgICAgfSxcXFxcbiAgICAgICAgcGljX3VybDogaXRlbS5waWMsXFxcXG4gICAgfSlcXFxcbn1cXFxcbi8qIOW9kuW5tuaOkuW6jyBTdGFydCAqL1xcXFxuLy9tUnVsZUxpc3QgPSBtZXJnZVNvcnQobVJ1bGVMaXN0KTtcXFxcbi8qIOW9kuW5tuaOkuW6jyBFbmQgKi9cXFxcbmRhdGEucHVzaC5hcHBseShkYXRhLCBtUnVsZUxpc3QpXFxcXG5zZXRSZXN1bHQoZGF0YSk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi5Zue5aSNXFxcIixcXFwicGF0aFxcXCI6XFxcIlJlcGx5XFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxubGV0IGRhdGEgPSBbXTtcXFxcbmNvbnN0IHtcXFxcbiAgICBhcGlcXFxcbn0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcXFxcXCIpO1xcXFxubGV0IHtcXFxcbiAgICByZXBseUlkLFxcXFxuICAgIHJ1bGVJZCxcXFxcbiAgICBuYW1lLFxcXFxuICAgIHBhc3N3b3JkLFxcXFxuICAgIHVzZXJuYW1lXFxcXG59ID0gTVlfUEFSQU1TO1xcXFxuXFxcXG5cXFxcbnNldFBhZ2VUaXRsZShcXFxcXFxcIuWbnuWkjShcXFxcXFxcIiArIG5hbWUgKyBcXFxcXFxcIilcXFxcXFxcIik7XFxcXG5hZGRMaXN0ZW5lcignb25DbG9zZScsICQudG9TdHJpbmcoKCkgPT4ge1xcXFxuICAgIGNsZWFyVmFyKFxcXFxcXFwiV2FyZWhvdXNlLmNvbW1lbnQudGV4dFxcXFxcXFwiKTtcXFxcbiAgICByZWZyZXNoUGFnZShmYWxzZSk7XFxcXG59KSk7XFxcXG5cXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgZGVzYzogXFxcXFxcXCLlm57lpI0uLi4uLi5cXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogJ2lucHV0JyxcXFxcbiAgICBleHRyYToge1xcXFxuICAgICAgICB0aXRsZVZpc2libGU6IGZhbHNlLFxcXFxuICAgICAgICBkZWZhdWx0VmFsdWU6IGdldFZhcignV2FyZWhvdXNlLmNvbW1lbnQudGV4dCcsICcnKSxcXFxcbiAgICAgICAgdHlwZTogXFxcXFxcXCJ0ZXh0YXJlYVxcXFxcXFwiLFxcXFxuICAgICAgICBoZWlnaHQ6NyxcXFxcbiAgICAgICAgb25DaGFuZ2U6ICdwdXRWYXIoXFxcXFxcXCJXYXJlaG91c2UuY29tbWVudC50ZXh0XFxcXFxcXCIsaW5wdXQpJ1xcXFxuICAgIH1cXFxcbn0pO1xcXFxuXFxcXG5cXFxcbmRhdGEucHVzaCh7XFxcXG4gICAgdGl0bGU6IFxcXFxcXFwi5o+Q5LqkXFxcXFxcXCIsXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF9jZW50ZXJfMVxcXFxcXFwiLFxcXFxuICAgIHVybDogJChhcGkuZGlzX3JlcGx5ICsgcnVsZUlkKS5sYXp5UnVsZSgocGFzc3dvcmQsIHVzZXJuYW1lLCBydWxlSWQpID0+IHtcXFxcbiAgICAgICAgbGV0IHRleHQgPSBnZXRWYXIoJ1dhcmVob3VzZS5jb21tZW50LnRleHQnLCAnJyk7XFxcXG4gICAgICAgIGlmIChwYXNzd29yZCA9PSBcXFxcXFxcIlxcXFxcXFwiIHx8IHVzZXJuYW1lID09IFxcXFxcXFwiXFxcXFxcXCIpIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8v5pyq55m75b2V6LSm5Y+3XFxcXFxcXCI7XFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgaWYgKHRleHQgPT0gXFxcXFxcXCJcXFxcXFxcIikge1xcXFxuICAgICAgICAgICAgcmV0dXJuIFxcXFxcXFwidG9hc3Q6Ly/kvaDov5jku4DkuYjpg73msqHlhpnllYpcXFxcXFxcIjtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBsZXQgcmVzdWx0ID0gcmVxdWVzdChpbnB1dCwge1xcXFxuICAgICAgICAgICAgaGVhZGVyczoge1xcXFxuICAgICAgICAgICAgICAgICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcXFxcbiAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XFxcXG4gICAgICAgICAgICAgICAgXFxcXFxcXCJwYXJhbXNcXFxcXFxcIjoge1xcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcImRpc2N1c3NfdGV4dFxcXFxcXFwiOiB0ZXh0LFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInFxXFxcXFxcXCI6IHVzZXJuYW1lLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhc3N3b3JkXFxcXFxcXCI6IHBhc3N3b3JkLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcImRpc2N1c3NfaWRcXFxcXFxcIjogcnVsZUlkXFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgfSksXFxcXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJ1xcXFxuICAgICAgICB9KTtcXFxcbiAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShyZXN1bHQpLnJlc3VsdDtcXFxcbiAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDApIHtcXFxcbiAgICAgICAgICAgIGJhY2soZmFsc2UpO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIHJldHVybiBcXFxcXFxcInRvYXN0Oi8vXFxcXFxcXCIgKyByZXN1bHQuZGV0YWlsO1xcXFxuXFxcXG4gICAgfSwgcGFzc3dvcmQsIHVzZXJuYW1lLCByZXBseUlkKVxcXFxufSk7XFxcXG5cXFxcbnNldFJlc3VsdChkYXRhKTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLmiJHnmoTlm57lpI1cXFwiLFxcXCJwYXRoXFxcIjpcXFwiTXlSZXBseVxcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbmNvbnN0IHtcXFxcbiAgICBhcGlcXFxcbn0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcXFxcXCIpO1xcXFxubGV0IHtcXFxcbiAgICBhdXRoX2NvZGUsXFxcXG4gICAgcXFcXFxcbn0gPSBNWV9QQVJBTVM7XFxcXG5sZXQgcGFnZSA9IHBhcnNlSW50KE1ZX1VSTC5zcGxpdChcXFxcXFxcIiNcXFxcXFxcIilbMV0pO1xcXFxubGV0IGRhdGE9W107XFxcXG5sZXQgY29tbWVudExpc3QgPSBKU09OLnBhcnNlKHJlcXVlc3QoYXBpLmRpc19nZXRfcmVwbHkgKyBcXFxcXFxcIj9saW1pdD01JnBhZ2U9XFxcXFxcXCIgKyBwYWdlICsgXFxcXFxcXCImcXE9XFxcXFxcXCIgKyBxcSArIFxcXFxcXFwiJmF1dGhfY29kZT1cXFxcXFxcIiArIGF1dGhfY29kZSkpLnJlc3VsdDtcXFxcbmlmIChjb21tZW50TGlzdC5sZW5ndGggPT09IDApIHtcXFxcbiAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICB0aXRsZTogXFxcXFxcXCI8aDUgc3R5bGU9J3RleHQtYWxpZ246Y2VudGVyJz7liKvmi4nkuobkuIDmnaHkuZ/kuI3liankuoY8L2g1PlxcXFxcXFwiLFxcXFxuICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJyaWNoX3RleHRcXFxcXFxcIlxcXFxuICAgIH0pO1xcXFxufSBlbHNlIHtcXFxcbiAgICBmb3IgKGxldCBpdGVtIG9mIGNvbW1lbnRMaXN0KSB7XFxcXG4gICAgICAgIGRhdGEucHVzaCh7XFxcXG4gICAgICAgICAgICB0aXRsZTogaXRlbS5uYW1lICsgXFxcXFxcXCImbmJzcDsmbmJzcDs8Zm9udCBjb2xvcj0nZ3JheSc+PHNtYWxsPiNcXFxcXFxcIiArIGl0ZW0uaWQgKyBcXFxcXFxcIjwvc21hbGw+PGZvbnQ+XFxcXFxcXCIsXFxcXG4gICAgICAgICAgICBjb2xfdHlwZTogXFxcXFxcXCJhdmF0YXJcXFxcXFxcIixcXFxcbiAgICAgICAgICAgIHVybDogXFxcXFxcXCJoaWtlcjovL3BhZ2UvcnVsZURldGFpbCNub0hpc3RvcnkjI25vUmVjb3JkSGlzdG9yeSNcXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGV4dHJhOiB7XFxcXG4gICAgICAgICAgICAgICAgbHZlcjogXFxcXFxcXCLlm57lpI3ov5vlhaXkuI3mlK/mjIHmn6XnnItcXFxcXFxcIixcXFxcbiAgICAgICAgICAgICAgICBpZDogaXRlbS5ydWxlX2lkWzBdXFxcXG4gICAgICAgICAgICB9LFxcXFxuICAgICAgICAgICAgcGljX3VybDogaXRlbS5hdmF0YXJfdXJsXFxcXG4gICAgICAgIH0pO1xcXFxuICAgICAgICBkYXRhLnB1c2goe1xcXFxuICAgICAgICAgICAgdGl0bGU6IGl0ZW0uZGlzY3Vzc190ZXh0LFxcXFxuICAgICAgICAgICAgZGVzYzogaXRlbS5jcmVhdGVfZGF0ZSArIFxcXFxcXFwiwrdcXFxcXFxcIitpdGVtLnJ1bGVfaWRbMV0rXFxcXFxcXCLCt1xcXFxcXFwiK1xcXFxcXFwi5byA5Y+R6ICF8J+Xo1xcXFxcXFwiLFxcXFxuICAgICAgICAgICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF8xXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICB1cmw6IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL2luZm9cXFxcXFxcIixcXFxcbiAgICAgICAgICAgIGV4dHJhOntcXFxcbiAgICAgICAgICAgICAgICBuYW1lOml0ZW0ubmFtZSxcXFxcbiAgICAgICAgICAgICAgICB0eXBlOlxcXFxcXFwibG9uZ190ZXh0XFxcXFxcXCIsXFxcXG4gICAgICAgICAgICAgICAgdGV4dDppdGVtLmRpc2N1c3NfdGV4dFxcXFxuICAgICAgICAgICAgfSxcXFxcbiAgICAgICAgICAgIHBpY191cmw6IGl0ZW0uYXZhdGFyX3VybFxcXFxuICAgICAgICB9KTtcXFxcbiAgICB9XFxcXG4gICAgXFxcXG59XFxcXG5zZXRSZXN1bHQoZGF0YSk7XFxcXG5cXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLmm7TlpJrliIbkuqtcXFwiLFxcXCJwYXRoXFxcIjpcXFwibW9yZVNoYXJlXFxcIixcXFwicnVsZVxcXCI6XFxcImpzOlxcXFxuICAgIGFkZExpc3RlbmVyKCdvbkNsb3NlJywgJC50b1N0cmluZygoKT0+e1xcXFxuICAgICAgICBjbGVhclZhcihcXFxcXFxcImhvdXNlLnVwbG9hZF9jb2RlXFxcXFxcXCIpO1xcXFxuICAgIH0pKTtcXFxcbmNvbnN0IHtjb2xvcixzbWFsbCxhcGksIGdldEZpbGV9ID0gJC5yZXF1aXJlKFxcXFxcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeVxcXFxcXFwiKTtcXFxcbmxldCBob3VzZUZpbGUgPSBnZXRGaWxlfHxmYWxzZTtcXFxcbmxldCBwdXRfdXJsID0gYXBpLmhvc3QrJy9oaWtlcnVsZS9kZXYvcHV0JztcXFxcbmlmKCFob3VzZUZpbGUpe1xcXFxuICAgIHNldEl0ZW0oJ2lzX2hvdXNlX3ZpcCcsICdmYWxzZScpO1xcXFxufVxcXFxubGV0IGhvdXNlX2RhdGEgPSBob3VzZUZpbGUoKTtcXFxcbi8vIGxvZyhob3VzZV9kYXRhLnVzZXJuYW1lKyctJytob3VzZV9kYXRhLnBhc3N3b3JkKTtcXFxcbnZhciBjYW51cCA9IGhvdXNlX2RhdGEudXNlcm5hbWUubGVuZ3RoID49IDYgJiYgaG91c2VfZGF0YS5wYXNzd29yZC5sZW5ndGggPiAyO1xcXFxubG9nKCflj6/ku6XkuIrkvKA/JytjYW51cCk7XFxcXG5sZXQgZCA9IFtdO1xcXFxubGV0IGZpbGVfdHlwZSA9IFt7bmFtZTon6Z2Z5oCB5paH5Lu2Jyx2YWx1ZTonaHRtbCd9LHtuYW1lOifnvZHpobXmj5Lku7YnLHZhbHVlOidqc191cmwnfSx7bmFtZTon5Li76aG16YWN572uJyx2YWx1ZTonY29uZmlnJ31dOyAvL+S4iuS8oOexu+Wei1xcXFxubGV0IGZpbGVfcmVkaXJlY3QgPSBbe25hbWU6J+acrOWcsCcsdmFsdWU6J2ZhbHNlJ30se25hbWU6J+ebtOmTvjMwMicsdmFsdWU6J3RydWUnfV07IC8v5piv5ZCm6YeN5a6a5ZCRXFxcXG5sZXQgZmlsZV91YSA9IFt7bmFtZTon55S16ISRJyx2YWx1ZToncGMnfSx7bmFtZTon5omL5py6Jyx2YWx1ZTonbW9iaWxlJ31dO1xcXFxubGV0IGZpbGVfdHlwZV90aXRsZSA9IGZpbGVfdHlwZS5tYXAoKGl0ZW0pID0+IHtcXFxcbiAgICBsZXQgbmFtZSA9IGdldEl0ZW0oJ2hvdXNlLmZpbGVfdHlwZScsJ+mdmeaAgeaWh+S7ticpO1xcXFxuICAgIGlmKGl0ZW0ubmFtZT09PW5hbWUpe1xcXFxuICAgICAgICByZXR1cm4gJ/CfkYknK2l0ZW0ubmFtZTtcXFxcbiAgICB9ZWxzZXtcXFxcbiAgICAgICAgcmV0dXJuIGl0ZW0ubmFtZTtcXFxcbiAgICB9XFxcXG59KTtcXFxcbmxldCBmaWxlX3JlZGlyZWN0X3RpdGxlID0gZmlsZV9yZWRpcmVjdC5tYXAoKGl0ZW0pID0+IHtcXFxcbiAgICBsZXQgbmFtZSA9IGdldEl0ZW0oJ2hvdXNlLmZpbGVfcmVkaXJlY3QnLCfmnKzlnLAnKTtcXFxcbiAgICBpZihpdGVtLm5hbWU9PT1uYW1lKXtcXFxcbiAgICAgICAgcmV0dXJuICfwn5GJJytpdGVtLm5hbWU7XFxcXG4gICAgfWVsc2V7XFxcXG4gICAgICAgIHJldHVybiBpdGVtLm5hbWU7XFxcXG4gICAgfVxcXFxufSk7XFxcXG5sZXQgZmlsZV91YV90aXRsZSA9IGZpbGVfdWEubWFwKChpdGVtKSA9PiB7XFxcXG4gICAgbGV0IG5hbWUgPSBnZXRJdGVtKCdob3VzZS5maWxlX3VhJywn55S16ISRJyk7XFxcXG4gICAgaWYoaXRlbS5uYW1lPT09bmFtZSl7XFxcXG4gICAgICAgIHJldHVybiAn8J+RiScraXRlbS5uYW1lO1xcXFxuICAgIH1lbHNle1xcXFxuICAgICAgICByZXR1cm4gaXRlbS5uYW1lO1xcXFxuICAgIH1cXFxcbn0pO1xcXFxuZC5wdXNoKHtjb2xfdHlwZTogJ3g1X3dlYnZpZXdfc2luZ2xlJywgZXh0cmE6IHtqczogJ2NvbnNvbGUubG9nKFxcXFxcXFwi5oiR5Yqg6L295LqGXFxcXFxcXCIpJ319KTtcXFxcbmQucHVzaCh7XFxcXG4gICAgdGl0bGU6ICfojrflj5YnLFxcXFxuICAgIGRlc2M6IFxcXFxcXFwi5paH5Lu26Lev5b6ELOaUr+aMgWhpa2VyLGZpbGUsaHR0cCzkuLvpophcXFxcXFxcIixcXFxcbiAgICBleHRyYToge1xcXFxuICAgICAgICBvbkNoYW5nZTogXFxcXFxcXCJwdXRWYXIoJ2hvdXNlLndlYl91cmwnLGlucHV0KVxcXFxcXFwiLFxcXFxuICAgICAgICB0aXRsZVZpc2libGU6IHRydWUsXFxcXG4gICAgICAgIGlkOidmaWxlUGF0aCcsXFxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTpnZXRWYXIoJ2hvdXNlLndlYl91cmwnKVxcXFxuICAgIH0sXFxcXG4gICAgdXJsOiQudG9TdHJpbmcoKCkgPT4ge1xcXFxuICAgICAgICBsZXQgaW5wdXQgPSBnZXRWYXIoJ2hvdXNlLndlYl91cmwnLCcnKTtcXFxcbiAgICAgICAgaWYoaW5wdXQubGVuZ3RoPDIpe1xcXFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+mTvuaOpeS4jeWPr+S7peS4uuepuidcXFxcbiAgICAgICAgfSBlbHNlIGlmKC9eaGlrZXI6fF5maWxlOnxeaHR0cDp8Xmh0dHBzOnxeXFxcXFxcXFwvc3RvcmFnZVxcXFxcXFxcL3xeXFxcXFxcXFwvc2RjYXJkXFxcXFxcXFwvLy50ZXN0KGlucHV0KSl7XFxcXG4gICAgICAgICAgICBpZigvXlxcXFxcXFxcL3N0b3JhZ2VcXFxcXFxcXC98XlxcXFxcXFxcL3NkY2FyZFxcXFxcXFxcLy8udGVzdChpbnB1dCkpe1xcXFxuICAgICAgICAgICAgICAgIGlucHV0ID0gJ2ZpbGU6Ly8nK2lucHV0O1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgbG9nKCfmraPluLjpk77mjqU6JytpbnB1dCk7XFxcXG4gICAgICAgICAgICBsZXQgdWEgPSBnZXRJdGVtKCdob3VzZS5maWxlX3VhJyk9PT0n55S16ISRJz8nTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg4LjAuNDMyNC4xNDYgU2FmYXJpLzUzNy4zNic6J01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA5OyBNSSA2KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvODkuMC40Mzg5LjkwIE1vYmlsZSBTYWZhcmkvNTM3LjM2JztcXFxcbiAgICAgICAgICAgIGxldCB3ZWJfdXJsX2FyciA9IGlucHV0LnNwbGl0KCc7Jyk7XFxcXG4gICAgICAgICAgICBsZXQgd2ViX3VybCA9IHdlYl91cmxfYXJyWzBdO1xcXFxuICAgICAgICAgICAgbGV0IGhlYWRlcnMgPSB7XFxcXG4gICAgICAgICAgICAgICAgJ1JlZmVyZXInOidodHRwczovL2Jsb2cuY3Nkbi5uZXQnLFxcXFxuICAgICAgICAgICAgICAgICdVc2VyLUFnZW50Jzp1YSxcXFxcbiAgICAgICAgICAgICAgICAnQWNjZXB0JzonYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0LCAqLyo7IHE9MC4wMScsXFxcXG4gICAgICAgICAgICAgICAgJ0FjY2VwdC1MYW5ndWFnZSc6J3poLUNOJyxcXFxcbiAgICAgICAgICAgIH07XFxcXG4gICAgICAgICAgICBpZih3ZWJfdXJsX2Fyci5sZW5ndGg+PTMmJndlYl91cmxfYXJyWzJdLmxlbmd0aD4yKXsgLy/orr7nva7nvJbnoIFcXFxcbiAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9ICdjaGFyc2V0PScrd2ViX3VybF9hcnJbMl0udG9VcHBlckNhc2UoKTtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIGxldCBwYXJhbXMgPSB7aGVhZGVyczpoZWFkZXJzLHdpdGhIZWFkZXJzOmZhbHNlLHJlZGlyZWN0OmZhbHNlfTtcXFxcbiAgICAgICAgICAgIGlmKHdlYl91cmxfYXJyLmxlbmd0aD49MiYmd2ViX3VybF9hcnJbMV0ubGVuZ3RoPjIpeyAvLyDorr7nva7or7fmsYLmlrnms5VcXFxcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ21ldGhvZCddID0gd2ViX3VybF9hcnJbMV0udG9VcHBlckNhc2UoKTtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIGxvZygn5byA5aeL6I635Y+W5rqQ56CBJyk7XFxcXG4gICAgICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgICAgIC8qXFxcXG4gICAgICAgICAgICAgICAgcmVxdWVzdEFzeW5jKHdlYl91cmwscGFyYW1zLGZ1bmN0aW9uIChrZXksY29kZSkge1xcXFxuICAgICAgICAgICAgICAgICAgICBsZXQgYmFja19jb2RlID0gY29kZTtcXFxcbiAgICAgICAgICAgICAgICAgICAgaWYoYmFja19jb2RlLmxlbmd0aD4yMCl7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBwdXRWYXIoJ2hvdXNlLnVwbG9hZF9jb2RlJyxiYWNrX2NvZGUpO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFBhZ2UodHJ1ZSk7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v5rqQ56CB5bey6I635Y+WLOW5tumDqOWIhuaPkuWFpeWIsOaWh+acrOWMuuWfnydcXFxcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v6ZSZ6K+v77yM5pys5qyh6I635Y+W5Yiw56m65paH5pys77yM55aR5Ly85L2g5rKh5pyJ5q2k5paH5Lu2ISc7XFxcXG4gICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICB9KTtcXFxcbiAgICAgICAgICAgICAgICAqL1xcXFxuICAgICAgICAgICAgICAgIGxldCBiYWNrX2NvZGUgPSBnZXRJdGVtKCdob3VzZS5maWxlX3VhJyk9PT0n55S16ISRJz9mZXRjaCh3ZWJfdXJsLHBhcmFtcyk6cmVxdWVzdCh3ZWJfdXJsLHBhcmFtcyk7XFxcXG4gICAgICAgICAgICAgICAgaWYoYmFja19jb2RlLmxlbmd0aD4yMCl7XFxcXG4gICAgICAgICAgICAgICAgICAgIHB1dFZhcignaG91c2UudXBsb2FkX2NvZGUnLGJhY2tfY29kZSk7XFxcXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKHRydWUpO1xcXFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v5rqQ56CB5bey6I635Y+WLOW5tumDqOWIhuaPkuWFpeWIsOaWh+acrOWMuuWfnydcXFxcbiAgICAgICAgICAgICAgICB9ZWxzZXtcXFxcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+mUmeivr++8jOacrOasoeiOt+WPluWIsOepuuaWh+acrO+8jOeWkeS8vOS9oOayoeacieatpOaWh+S7tiEnO1xcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH1jYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgICAgIGxvZyhlLm1lc3NhZ2UpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/lj5HnlJ/kuobplJnor686XFxcXFxcXFxuJytlLm1lc3NhZ2U7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH1lbHNlIGlmKC/kuLvpopjvv6V85YWD57Sg77+lLy50ZXN0KGlucHV0KSl7XFxcXG4gICAgICAgICAgICBsb2coJ+S4u+mimOmTvuaOpScpO1xcXFxuICAgICAgICAgICAgbGV0IHdlYl91cmxfYXJyID0gaW5wdXQuc3BsaXQoJ++/pScpO1xcXFxuICAgICAgICAgICAgbGV0IHdlYl91cmwgPSB3ZWJfdXJsX2Fyclt3ZWJfdXJsX2Fyci5sZW5ndGgtMV07XFxcXG4gICAgICAgICAgICBsZXQgYmFja19jb2RlID0gcGFyc2VQYXN0ZSh3ZWJfdXJsKTtcXFxcbiAgICAgICAgICAgIGlmKGJhY2tfY29kZS5sZW5ndGg+MjApIHtcXFxcbiAgICAgICAgICAgICAgICBwdXRWYXIoJ2hvdXNlLnVwbG9hZF9jb2RlJyxiYWNrX2NvZGUpO1xcXFxuICAgICAgICAgICAgICAgIHJlZnJlc2hQYWdlKHRydWUpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/mupDnoIHlt7Lojrflj5Ys5bm26YOo5YiG5o+S5YWl5Yiw5paH5pys5Yy65Z+fJ1xcXFxuICAgICAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+mUmeivr++8jOacrOasoeiOt+WPlui/lOWbnuS4ujpcXFxcXFxcXG4nK2JhY2tfY29kZTtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v6Z2e5rOV6ZO+5o6lOlxcXFxcXFxcbicrZ2V0VmFyKCdob3VzZS53ZWJfdXJsJyk7XFxcXG4gICAgICAgIH1cXFxcbiAgICB9KSxcXFxcbiAgICBjb2xfdHlwZTogXFxcXFxcXCJpbnB1dFxcXFxcXFwiXFxcXG59KTtcXFxcbmQucHVzaCh7XFxcXG4gICAgdGl0bGU6IFxcXFxcXFwi6YCJ5oup5paH5Lu26Lev5b6EXFxcXFxcXCIsXFxcXG4gICAgdXJsOiQoJyNub0xvYWRpbmcjJykubGF6eVJ1bGUoKCk9PntcXFxcbiAgICAgICAgLypcXFxcbiAgICAgICAgbGV0IGZwID0gJ2h0dHBzOi8vZ2l0Y29kZS5uZXQvcXFfMzIzOTQzNTEvZHIvLS9yYXcvbWFzdGVyL2pzL2ZpbGVTZWxlY3QuanMnO1xcXFxuICAgICAgICBsZXQgZiA9IHJlcXVpcmUoZnApO1xcXFxuICAgICAgICAqL1xcXFxuICAgICAgICBsZXQgZnA9Y29uZmlnLmxpYi5maWxlU2VsZWN0O1xcXFxuICAgICAgICBsZXQgZj0kLnJjKGZwKTtcXFxcbiAgICAgICAgcmV0dXJuIGYuZmlsZVNlbGVjdGlvblVyaSh7XFxcXG4gICAgICAgICAgICBjYWxsYmFjazogJC50b1N0cmluZygoKSA9PiB7XFxcXG4gICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9IGZpbmRJdGVtKFxcXFxcXFwiZmlsZVBhdGhcXFxcXFxcIikuZXh0cmE7XFxcXG4gICAgICAgICAgICAgICAgdXBkYXRlSXRlbShcXFxcXFxcImZpbGVQYXRoXFxcXFxcXCIsIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgZXh0cmE6IE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IFBBVEhcXFxcbiAgICAgICAgICAgICAgICAgICAgfSlcXFxcbiAgICAgICAgICAgICAgICB9KTtcXFxcbiAgICAgICAgICAgICAgICBwdXRWYXIoJ2hvdXNlLndlYl91cmwnLFBBVEgpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xcXFxuICAgICAgICAgICAgfSksXFxcXG4gICAgICAgICAgICBvbkNsaWNrVHlwZTonY29uZmlybScsXFxcXG4gICAgICAgICAgICBmaWxlVHlwZTogXFxcXFxcXCIuanN8LnR4dHwuaGlrZXJ8Lmpzb258Lmh0bWxcXFxcXFxcIixcXFxcbiAgICAgICAgICAgIHBhdHRlcm46IDAsXFxcXG4gICAgICAgICAgICByZXF1aXJlVXJsOmZwLFxcXFxuICAgICAgICAgICAgaW5pdGlhbFBhdGg6Z2V0UGF0aCgnaGlrZXI6Ly9maWxlcy9ydWxlcy9kekhvdXNlLycpLnNsaWNlKDcpLFxcXFxuICAgICAgICAgICAgbWVtb3J5Oid0cnVlJyxcXFxcbiAgICAgICAgfSk7XFxcXG4gICAgfSksXFxcXG4gICAgY29sX3R5cGU6IFxcXFxcXFwidGV4dF9jZW50ZXJfMVxcXFxcXFwiLFxcXFxufSk7XFxcXG5kLnB1c2goe1xcXFxuICAgIHRpdGxlOifkuIrkvKDnsbvlnosnLFxcXFxuICAgIGRlc2M6J+S4iuS8oOaWh+S7tueahOexu+WeiyzlvZPliY3kuLo6Jytjb2xvcihnZXRJdGVtKCdob3VzZS5maWxlX3R5cGUnLCfpnZnmgIHmlofku7YnKSwnI2ZmNzAwMCcpLFxcXFxuICAgIGNvbF90eXBlOid0ZXh0XzEnLFxcXFxuICAgIHVybDokKGZpbGVfdHlwZV90aXRsZSwyKS5zZWxlY3QoKCkgPT4ge1xcXFxuICAgICAgICBzZXRJdGVtKCdob3VzZS5maWxlX3R5cGUnLGlucHV0LnJlcGxhY2UoJ/CfkYknLCcnKSk7XFxcXG4gICAgICAgIHJlZnJlc2hQYWdlKHRydWUpO1xcXFxuICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v5L2g6YCJ5oup5LqGOicraW5wdXQ7XFxcXG4gICAgfSlcXFxcbn0pO1xcXFxuXFxcXG5kLnB1c2goe1xcXFxuICAgIHRpdGxlOifmlofku7blrprkvY0nLFxcXFxuICAgIGRlc2M6J+aWh+S7tuaYr+WQpuWxnuS6jumHjeWumuWQkSzlvZPliY3kuLo6Jytjb2xvcihnZXRJdGVtKCdob3VzZS5maWxlX3JlZGlyZWN0Jywn5pys5ZywJyksJyNmZjcwMDAnKSxcXFxcbiAgICBjb2xfdHlwZTondGV4dF8xJyxcXFxcbiAgICB1cmw6JChmaWxlX3JlZGlyZWN0X3RpdGxlLDIpLnNlbGVjdCgoKSA9PiB7XFxcXG4gICAgICAgIHNldEl0ZW0oJ2hvdXNlLmZpbGVfcmVkaXJlY3QnLGlucHV0LnJlcGxhY2UoJ/CfkYknLCcnKSk7XFxcXG4gICAgICAgIHJlZnJlc2hQYWdlKHRydWUpO1xcXFxuICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v5L2g6YCJ5oup5LqGOicraW5wdXQ7XFxcXG4gICAgfSlcXFxcbn0pO1xcXFxuXFxcXG5kLnB1c2goe1xcXFxuICAgIHRpdGxlOiforr7lpIdVQScsXFxcXG4gICAgZGVzYzon5Y+R6LW3572R6aG16K+35rGC5aS05qCH6K+GLOW9k+WJjeS4ujonK2NvbG9yKGdldEl0ZW0oJ2hvdXNlLmZpbGVfdWEnLCfnlLXohJEnKSwnI2ZmNzAwMCcpLFxcXFxuICAgIGNvbF90eXBlOid0ZXh0XzEnLFxcXFxuICAgIHVybDokKGZpbGVfdWFfdGl0bGUsMikuc2VsZWN0KCgpID0+IHtcXFxcbiAgICAgICAgc2V0SXRlbSgnaG91c2UuZmlsZV91YScsaW5wdXQucmVwbGFjZSgn8J+RiScsJycpKTtcXFxcbiAgICAgICAgcmVmcmVzaFBhZ2UodHJ1ZSk7XFxcXG4gICAgICAgIHJldHVybiAndG9hc3Q6Ly/kvaDpgInmi6nkuoY6JytpbnB1dDtcXFxcbiAgICB9KVxcXFxufSk7XFxcXG5mdW5jdGlvbiBjb21wYXJlKG5hbWUpIHtcXFxcbiAgICByZXR1cm4gZnVuY3Rpb24oaXRlbSkge1xcXFxuICAgICAgICByZXR1cm4gaXRlbS5uYW1lID09PSBuYW1lO1xcXFxuICAgIH1cXFxcbn1cXFxcbmQucHVzaCh7XFxcXG4gICAgdGl0bGU6J/Cfl4TvuI/njq/looMnLFxcXFxuICAgIGNvbF90eXBlOidmbGV4X2J1dHRvbicsXFxcXG4gICAgdXJsOiQoKS5sYXp5UnVsZSgoZmlsZV90eXBlLGNvbXBhcmUpPT57XFxcXG4gICAgICAgIGxvZygn5p+l55yL546v5aKD5Y+Y6YePJyk7XFxcXG4gICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICBsZXQgdXBfY29kZSA9IGdldFZhcignaG91c2UudXBsb2FkX2NvZGUnLCcnKTtcXFxcbiAgICAgICAgICAgIGxldCBmdHlwZSA9ICBmaWxlX3R5cGUuZmlsdGVyKGNvbXBhcmUoZ2V0SXRlbSgnaG91c2UuZmlsZV90eXBlJywn6Z2Z5oCB5paH5Lu2JykpKVswXS52YWx1ZTtcXFxcbiAgICAgICAgICAgIGxldCByZWRpcmVjdCA9IGdldEl0ZW0oJ2hvdXNlLmZpbGVfcmVkaXJlY3QnLCfmnKzlnLAnKSE9PSfmnKzlnLAnO1xcXFxuICAgICAgICAgICAgbGV0IGNvZGUgPSAhcmVkaXJlY3Q/dXBfY29kZTppbnB1dDtcXFxcbiAgICAgICAgICAgIGxldCBlbnYgPSB7XFxcXG4gICAgICAgICAgICAgICAgd2ViX3VybDpnZXRWYXIoJ2hvdXNlLndlYl91cmwnLCcnKSxcXFxcbiAgICAgICAgICAgICAgICBkZXZpY2U6Z2V0SXRlbSgnaG91c2UuZmlsZV91YScsJ+eUteiEkScpLFxcXFxuICAgICAgICAgICAgICAgIGZ0eXBlOmZ0eXBlfHxcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0OnJlZGlyZWN0LFxcXFxuICAgICAgICAgICAgICAgIGNvZGU6Y29kZS5zdWJzdHJpbmcoMCw0MCl8fFxcXFxcXFwiXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICBsb2coZW52KTtcXFxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly8nK0pTT04uc3RyaW5naWZ5KGVudik7XFxcXG4gICAgICAgICAgICAvLyBhbGVydChKU09OLnN0cmluZ2lmeShlbnYpKTtcXFxcbiAgICAgICAgfWNhdGNoIChlKSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8vJytlLm1lc3NhZ2U7XFxcXG4gICAgICAgICAgICAvLyBhbGVydChlLm1lc3NhZ2UpO1xcXFxuICAgICAgICB9XFxcXG4gICAgfSxmaWxlX3R5cGUsY29tcGFyZSlcXFxcbn0pO1xcXFxuXFxcXG5kLnB1c2goe1xcXFxuICAgIHRpdGxlOifwn5OD5pWZ56iLJyxcXFxcbiAgICBjb2xfdHlwZTonZmxleF9idXR0b24nLFxcXFxuICAgIHVybDokKCkueDVSdWxlKCgpPT57XFxcXG4gICAgICAgIGxldCBtc2cgPSAn5qyi6L+O5L2/55So5byA5Y+R6ICF5pu05aSa5YiG5Lqr5bel5YW3XFxcXFxcXFxuMS7ovpPlhaXnvZHlnYDkuLrmnKzlnLDmlofku7bot6/lvoQsaGlrZXI6Ly/miJbogIVmaWxlOi8v5byA5aS0XFxcXFxcXFxuMi7ngrnlh7vnvZHlnYDovpPlhaXmoI/lkI7pnaLnmoTmjInpkq5cXFxcXFxcXG4zLueci+aWh+acrOmihOiniOWMuuaYr+WQpuato+ehrlxcXFxcXFxcbjQu54K55Ye75LiK5Lyg5oyJ6ZKu5o+Q5Lqk5Yiw5LuT5bqTJztcXFxcbiAgICAgICAgYWxlcnQobXNnKTtcXFxcbiAgICB9KVxcXFxufSk7XFxcXG5cXFxcbmQucHVzaCh7XFxcXG4gICAgdGl0bGU6J/Cfl5HvuI/muIXnqbonLFxcXFxuICAgIGNvbF90eXBlOidmbGV4X2J1dHRvbicsXFxcXG4gICAgdXJsOiQoKS5sYXp5UnVsZSgoKT0+e1xcXFxuICAgICAgICBjbGVhclZhcignaG91c2UudXBsb2FkX2NvZGUnKTtcXFxcbiAgICAgICAgcmVmcmVzaFBhZ2UodHJ1ZSk7XFxcXG4gICAgICAgIHJldHVybiAndG9hc3Q6Ly/lt7LmuIXpmaTpooTop4jljLrln5/lhoXlrrknXFxcXG4gICAgfSlcXFxcbn0pO1xcXFxuXFxcXG5kLnB1c2goe1xcXFxuICAgIHRpdGxlOifwn5Oy56S65L6LJyxcXFxcbiAgICBjb2xfdHlwZTonZmxleF9idXR0b24nLFxcXFxuICAgIHVybDokKCkubGF6eVJ1bGUoKCk9PntcXFxcbiAgICAgICAgbGV0IGRlbW9fY29kZSA9IGdldEl0ZW0oJ2hvdXNlLmRlbW8nLCcwJyk7XFxcXG4gICAgICAgIGlmKGRlbW9fY29kZT09JzAnKXtcXFxcbiAgICAgICAgICAgIHB1dFZhcignaG91c2Uud2ViX3VybCcsJ2hpa2VyOi8vZmlsZXMvcnVsZXMvZHpIb3VzZS9odG1sL+i1hOa6kOe9keS5puetvi5odG1sJyk7XFxcXG4gICAgICAgICAgICBkZW1vX2NvZGUgPSBwYXJzZUludChkZW1vX2NvZGUpKzE7XFxcXG4gICAgICAgICAgICBzZXRJdGVtKCdob3VzZS5kZW1vJyxkZW1vX2NvZGUrJycpO1xcXFxuICAgICAgICB9ZWxzZXtcXFxcbiAgICAgICAgICAgIHB1dFZhcignaG91c2Uud2ViX3VybCcsJ2ZpbGU6Ly8vc3RvcmFnZS9lbXVsYXRlZC8wL0FuZHJvaWQvZGF0YS9jb20uZXhhbXBsZS5oaWtlcnZpZXcvZmlsZXMvRG9jdW1lbnRzL3J1bGVzL2R6SG91c2UvaHRtbC/otYTmupDnvZHkuabnrb4uaHRtbCcpO1xcXFxuICAgICAgICAgICAgc2V0SXRlbSgnaG91c2UuZGVtbycsJzAnKTtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICByZWZyZXNoUGFnZSh0cnVlKTtcXFxcbiAgICAgICAgcmV0dXJuICd0b2FzdDovL+W3suiuvue9ruekuuS+i+WcsOWdgCdcXFxcbiAgICB9KVxcXFxufSk7XFxcXG5cXFxcbmQucHVzaCh7XFxcXG4gICAgdGl0bGU6J/Cfk6TkuIrkvKAnLFxcXFxuICAgIGNvbF90eXBlOidmbGV4X2J1dHRvbicsXFxcXG4gICAgdXJsOiQoKS5sYXp5UnVsZSgoY2FudXAsaG91c2VfZGF0YSxwdXRfdXJsLGZpbGVfdHlwZSkgPT57XFxcXG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhcmUobmFtZSkge1xcXFxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHtcXFxcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5uYW1lID09PSBuYW1lO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGNvbnN0IHtnZXROb3dGb3JtYXREYXRlfT0kLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5XFxcXFxcXCIpO1xcXFxuICAgICAgICBsZXQgdXBfY29kZSA9IGdldFZhcignaG91c2UudXBsb2FkX2NvZGUnLCcnKTtcXFxcbiAgICAgICAgaWYodXBfY29kZS5sZW5ndGggPCAyKXtcXFxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/mupDnoIHljLrml6DlhoXlrrnvvIzor7flhYjorr/pl67kuIDkuKrpnZnmgIHpobXpnaInXFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgaWYoIWNhbnVwKXtcXFxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/kvaDkuI3mmK/lvIDlj5HogIXvvIzmsqHmnInmj5DkuqTliLDku5PlupPnmoTmnYPliKkhJ1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGxldCBpbnB1dCA9IGdldFZhcignaG91c2Uud2ViX3VybCcsJycpO1xcXFxuICAgICAgICBsZXQgd2ViX3VybCA9IGlucHV0LnNwbGl0KCc7JylbMF07XFxcXG4gICAgICAgIGxldCBmaWxlTmFtZSA9ICcnO1xcXFxuICAgICAgICBpZigvXmhpa2VyOnxeZmlsZTp8Xmh0dHA6fF5odHRwczp8XlxcXFxcXFxcL3N0b3JhZ2VcXFxcXFxcXC98XlxcXFxcXFxcL3NkY2FyZFxcXFxcXFxcLy8udGVzdCh3ZWJfdXJsKSl7XFxcXG4gICAgICAgICAgICBmaWxlTmFtZSA9IHdlYl91cmwuc3BsaXQoJy8nKVt3ZWJfdXJsLnNwbGl0KCcvJykubGVuZ3RoLTFdO1xcXFxuICAgICAgICB9ZWxzZSBpZigv5Li76aKY77+lfOWFg+e0oO+/pS8udGVzdChpbnB1dCkpe1xcXFxuICAgICAgICAgICAgbGV0IGJrYXJyID0gdXBfY29kZS5zcGxpdCgn77+lJyk7XFxcXG4gICAgICAgICAgICBpZihia2Fyci5sZW5ndGg8Myl7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+S6keWJqui0tOadv+WGheWuueacieivrydcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIHN3aXRjaCAoYmthcnJbMV0pIHtcXFxcbiAgICAgICAgICAgICAgICBjYXNlICdteV9ob21lX3RoZW1lJzpcXFxcbiAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSB1cF9jb2RlLnNwbGl0KCfjgIwnKVsxXS5zcGxpdCgn44CNJylbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xcXFxuICAgICAgICAgICAgICAgIGNhc2UgJ215X2hvbWVfc2luZ2xlJzpcXFxcbiAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSB1cF9jb2RlLnNwbGl0KCfjgIwnKVsxXS5zcGxpdCgn44CNJylbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xcXFxuICAgICAgICAgICAgICAgIGNhc2UgJ2pzX3VybCc6XFxcXG4gICAgICAgICAgICAgICAgICAgIGZpbGVOYW1lID0gdXBfY29kZS5zcGxpdCgn77+lJylbMl0uc3BsaXQoJ0AnKVswXTtcXFxcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH1lbHNle1xcXFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+mUmeivr++8jOe9kemhtemTvuaOpeaXoOWGheWuuSEnO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGxldCB1YSA9IGdldEl0ZW0oJ2hvdXNlLmZpbGVfdWEnKT09PSfnlLXohJEnPydNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvODguMC40MzI0LjE0NiBTYWZhcmkvNTM3LjM2JzonTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDk7IE1JIDYpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84OS4wLjQzODkuOTAgTW9iaWxlIFNhZmFyaS81MzcuMzYnO1xcXFxuICAgICAgICBsZXQgaGVhZGVycyA9IHtcXFxcbiAgICAgICAgICAgICdSZWZlcmVyJzonaHR0cHM6Ly9ibG9nLmNzZG4ubmV0JyxcXFxcbiAgICAgICAgICAgIFxcXFxcXFwiY29udGVudC10eXBlXFxcXFxcXCI6IFxcXFxcXFwiYXBwbGljYXRpb24vanNvblxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgJ1VzZXItQWdlbnQnOnVhLFxcXFxuICAgICAgICAgICAgJ0FjY2VwdCc6J2FwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCwgKi8qOyBxPTAuMDEnLFxcXFxuICAgICAgICAgICAgJ0FjY2VwdC1MYW5ndWFnZSc6J3poLUNOJyxcXFxcbiAgICAgICAgfTtcXFxcbiAgICAgICAgbGV0IHRvQ29tcGFyZSA9ICcnO1xcXFxuICAgICAgICBpZihmaWxlTmFtZS5lbmRzV2l0aCgnLmh0bWwnKSl7XFxcXG4gICAgICAgICAgICB0b0NvbXBhcmUgPSAn6Z2Z5oCB5paH5Lu2JztcXFxcbiAgICAgICAgfWVsc2UgaWYoL+S4u+mimC8udGVzdChmaWxlTmFtZSkpe1xcXFxuICAgICAgICAgICAgdG9Db21wYXJlID0gJ+S4u+mhtemFjee9ridcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICBsZXQgZnR5cGUgPSAgZmlsZV90eXBlLmZpbHRlcihjb21wYXJlKHRvQ29tcGFyZXx8Z2V0SXRlbSgnaG91c2UuZmlsZV90eXBlJywn6Z2Z5oCB5paH5Lu2JykpKVswXS52YWx1ZTtcXFxcbiAgICAgICAgbGV0IHJlZGlyZWN0ID0gZ2V0SXRlbSgnaG91c2UuZmlsZV9yZWRpcmVjdCcsJ+acrOWcsCcpIT09J+acrOWcsCc7XFxcXG4gICAgICAgIGlmKHJlZGlyZWN0JiYhd2ViX3VybC5zdGFydHNXaXRoKCdodHRwJykpe1xcXFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+ebtOmTvjMwMumHjeWumuWQkee9keWdgOmTvuaOpeW/hemhu2h0dHDlvIDlpLQnO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGxldCBjb2RlID0gIXJlZGlyZWN0P3VwX2NvZGU6d2ViX3VybDtcXFxcbiAgICAgICAgbGV0IGRhdGEgPSB7XFxcXFxcXCJwYXJhbXNcXFxcXFxcIjpcXFxcbiAgICAgICAgICAgICAgICB7XFxcXFxcXCJkYXRhXFxcXFxcXCI6IHtydWxlX25hbWU6IGZpbGVOYW1lLCBcXFxcXFxcInJ1bGVfdHlwZVxcXFxcXFwiOiAn5pu05aSa5YiG5LqrJywgXFxcXFxcXCJ2ZXJzaW9uXFxcXFxcXCI6Z2V0Tm93Rm9ybWF0RGF0ZSgpLFxcXFxcXFwicnVsZV92YWx1ZVxcXFxcXFwiOiBjb2RlLFxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV90eXBlOmZ0eXBlLCBpc19yZWRpcmVjdDpyZWRpcmVjdCxkZXZpY2VVYTpnZXRJdGVtKCdob3VzZS5maWxlX3VhJyksXFxcXG4gICAgICAgICAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwibmFtZVxcXFxcXFwiOiBob3VzZV9kYXRhLnVzZXJuYW1lLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhc3N3b3JkXFxcXFxcXCI6IGhvdXNlX2RhdGEucGFzc3dvcmR9XFxcXG4gICAgICAgIH07XFxcXG4gICAgICAgIGxldCB1cHBhcmFtcyA9IHtoZWFkZXJzOmhlYWRlcnMsYm9keTpKU09OLnN0cmluZ2lmeShkYXRhKSx3aXRoSGVhZGVyczpmYWxzZSxyZWRpcmVjdDpmYWxzZSxtZXRob2Q6J1BPU1QnfTtcXFxcbiAgICAgICAgbGV0IGJhY2ttc2cgPSBnZXRJdGVtKCdob3VzZS5maWxlX3VhJyk9PT0n55S16ISRJz9mZXRjaChwdXRfdXJsLHVwcGFyYW1zKTpyZXF1ZXN0KHB1dF91cmwsdXBwYXJhbXMpO1xcXFxuICAgICAgICB0cnl7XFxcXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZShiYWNrbXNnKS5yZXN1bHQ7XFxcXG4gICAgICAgICAgICBsZXQgZGV0YWlsID0gcmVzdWx0LmRldGFpbDtcXFxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly8nK2RldGFpbDtcXFxcbiAgICAgICAgfWNhdGNoIChlKSB7XFxcXG4gICAgICAgICAgICBsb2coZS5tZXNzYWdlKTtcXFxcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/lj5HnlJ/kuobplJnor69cXFxcXFxcXG4nK2UubWVzc2FnZTtcXFxcbiAgICAgICAgfVxcXFxuICAgIH0sY2FudXAsaG91c2VfZGF0YSxwdXRfdXJsLGZpbGVfdHlwZSlcXFxcbn0pO1xcXFxuXFxcXG5kLnB1c2goe1xcXFxuICAgIHRpdGxlOifplb/mlofmnKzpooTop4jljLrln58nLFxcXFxuICAgIGNvbF90eXBlOid0ZXh0XzEnLFxcXFxuICAgIHVybDonaGlrZXI6Ly9lbXB0eScsXFxcXG4gICAgZXh0cmE6IHt0ZXh0U2l6ZTogMTEsbGluZVZpc2libGU6ZmFsc2V9XFxcXG59KTtcXFxcblxcXFxuZC5wdXNoKHtcXFxcbiAgICB0aXRsZTpnZXRWYXIoJ2hvdXNlLnVwbG9hZF9jb2RlJywnJykuc3Vic3RyaW5nKDAsMTAyNDApLFxcXFxuICAgIGNvbF90eXBlOidsb25nX3RleHQnLFxcXFxuICAgIGV4dHJhOiB7dGV4dFNpemU6IDExfVxcXFxufSk7XFxcXG5zZXRQYWdlVGl0bGUoXFxcXFxcXCLmm7TlpJrliIbkuqtcXFxcXFxcIik7XFxcXG5zZXRSZXN1bHQoZCk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi6L275ZCI6ZuG55Sf5oiQ5o6l5Y+jXFxcIixcXFwicGF0aFxcXCI6XFxcImdlbkFwaVxcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbmZ1bmN0aW9uIGdlblJ1bGUobmFtZSx1cmwsaWNvbil7XFxcXG4gICAgaWNvbj1pY29ufHwnaHR0cHM6Ly96My5heDF4LmNvbS8yMDIxLzExLzE2L0lXSmh4Zi5wbmcnO1xcXFxuICAgIGNvbnN0IHtnZXROb3dGb3JtYXREYXRlLGFwaSxnZXRBcGl9PSQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXk/cnVsZT3pgZPplb/ku5PlupNQcm9cXFxcXFxcIik7XFxcXG4gICAgU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlQWxsID0gZnVuY3Rpb24ob2xkLG5ld19zdHIpe1xcXFxuICAgICAgICByZXR1cm4gdGhpcy5zcGxpdChvbGQpLmpvaW4obmV3X3N0cik7XFxcXG4gICAgfTtcXFxcbiAgICBsZXQgbXViYW4gPSBnZXRBcGkoJ2ltcG9ydFVybCcpK1xcXFxcXFwiMTY5MFxcXFxcXFwiO1xcXFxuICAgIGxldCBtdWJhbl93b3JkPXtuYW1lOlxcXFxcXFwiQOi9u+WQiOmbhlxcXFxcXFwiLHVybDpcXFxcXFxcIkDlnLDlnYBcXFxcXFxcIix2ZXI6XFxcXFxcXCJA54mI5pysXFxcXFxcXCIsaWNvbjpcXFxcXFxcIkDlm77moIdcXFxcXFxcIn07XFxcXG4gICAgbGV0IG11YmFuX2NvZGUgPSBmZXRjaChtdWJhbik7XFxcXG4gICAgbXViYW5fY29kZT1tdWJhbl9jb2RlLnJlcGxhY2VBbGwobXViYW5fd29yZC5uYW1lLG5hbWUpLnJlcGxhY2VBbGwobXViYW5fd29yZC52ZXIsZ2V0Tm93Rm9ybWF0RGF0ZSgpKS5yZXBsYWNlQWxsKG11YmFuX3dvcmQudXJsLHVybCkucmVwbGFjZUFsbChtdWJhbl93b3JkLmljb24saWNvbik7XFxcXG4gICAgbGV0IGltcG9ydF9jb2RlPVxcXFxcXFwi5rW36ZiU6KeG55WM6KeE5YiZ5YiG5Lqr77yM5b2T5YmN5YiG5Lqr55qE5piv77ya5bCP56iL5bqP77yM5peg5qC55qCR77yM6Iqx5q2j5riF77yM5LiN5pat6I2k6IWl5LiN5oiS5rer77+laG9tZV9ydWxlX3Yy77+lYmFzZTY0Oi8vQFxcXFxcXFwiK25hbWUrXFxcXFxcXCJAXFxcXFxcXCIrYmFzZTY0RW5jb2RlKG11YmFuX2NvZGUpO1xcXFxuICAgIHZhciBwYXN0ZXMgPSBnZXRQYXN0ZXMoKTtcXFxcbiAgICB2YXIgdXJsID0gc2hhcmVQYXN0ZShpbXBvcnRfY29kZSxwYXN0ZXMuc2xpY2UoLTEpWzBdKTtcXFxcbiAgICBsZXQgaW1wb3J0X3J1bGU9IHVybCtcXFxcXFxcIlxcXFxcXFxcblxcXFxcXFxcbuWwj+eoi+W6j++8mlxcXFxcXFwiK25hbWU7XFxcXG4gICAgcmV0dXJuIGltcG9ydF9ydWxlO1xcXFxufVxcXFxuJC5leHBvcnRzLmdlblJ1bGU9Z2VuUnVsZTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLlhajlsYDop6PmnpDlhY3ll4VcXFwiLFxcXCJwYXRoXFxcIjpcXFwiZ2xvYmFsUGFyc2VcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG4gICAgZnVuY3Rpb24gZ2V0SGVhZGVycyhwbGF5VXJsKXtcXFxcbiAgICAgICAgbGV0IGhlYWRlcnMgPSB7fTtcXFxcbiAgICAgICAgbGV0IHJlZmVyPXBsYXlVcmwuc3BsaXQoXFxcXFxcXCIvL1xcXFxcXFwiKVswXStcXFxcXFxcIi8vXFxcXFxcXCIrcGxheVVybC5zcGxpdChcXFxcXFxcIi8vXFxcXFxcXCIpWzFdLnNwbGl0KFxcXFxcXFwiL1xcXFxcXFwiKVswXTtcXFxcbiAgICAgICAgaWYoL2xlY2xvdWRcXFxcXFxcXC5jb218YmlsaXZpZGVvXFxcXFxcXFwuY29tLy50ZXN0KHBsYXlVcmwpKXtcXFxcbiAgICAgICAgICAgIGhlYWRlcnMgPSB7XFxcXFxcXCJSZWZlcmVyXFxcXFxcXCI6ICdodHRwczovL3d3dy5iaWxpYmlsaS5jb20vJyxcXFxcXFxcIlVzZXItQWdlbnRcXFxcXFxcIjpcXFxcXFxcIk1vemlsbGEvNS4wXFxcXFxcXCJ9XFxcXG4gICAgICAgIH1lbHNlIGlmKC9tZ3R2XFxcXFxcXFwuY29tLy50ZXN0KHBsYXlVcmwpKXtcXFxcbiAgICAgICAgICAgIGhlYWRlcnMgPSB7XFxcXFxcXCJSZWZlcmVyXFxcXFxcXCI6IHJlZmVyLFxcXFxcXFwiVXNlci1BZ2VudFxcXFxcXFwiOlxcXFxcXFwiTW96aWxsYS81LjBcXFxcXFxcIn1cXFxcbiAgICAgICAgfWVsc2UgaWYoL2l4aWd1YVxcXFxcXFxcLmNvbS8udGVzdChwbGF5VXJsKSl7XFxcXG4gICAgICAgICAgICBoZWFkZXJzID0ge1xcXFxcXFwiUmVmZXJlclxcXFxcXFwiOiAnaHR0cHM6Ly93d3cuaXhpZ3VhLmNvbS8nLFxcXFxcXFwiVXNlci1BZ2VudFxcXFxcXFwiOlxcXFxcXFwiTW96aWxsYS81LjBcXFxcXFxcIn1cXFxcbiAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICAvLyBoZWFkZXJzID0ge1xcXFxcXFwiUmVmZXJlclxcXFxcXFwiOiByZWZlciwnVXNlci1BZ2VudCc6J0RhcnQvMi4xMyAoZGFydDppbyknfVxcXFxuICAgICAgICAgICAgLy8gaGVhZGVycyA9IHtcXFxcXFxcIlJlZmVyZXJcXFxcXFxcIjogcmVmZXIsJ1VzZXItQWdlbnQnOk1PQklMRV9VQX07XFxcXG4gICAgICAgICAgICBoZWFkZXJzID0geydVc2VyLUFnZW50JzpNT0JJTEVfVUF9O1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIHJldHVybiBoZWFkZXJzXFxcXG4gICAgfVxcXFxuZnVuY3Rpb24gaXNQaWMoc3RyKXtcXFxcbiAgICByZXR1cm4gL1xcXFxcXFxcLihnaWZ8anBnfGpwZWd8cG5nfEdJRnxKUEd8UE5HKSQvLnRlc3Qoc3RyKTtcXFxcbn1cXFxcbmZ1bmN0aW9uIGlzVmlkZW8ocGxheVVybCxyZWNoYW5nZSl7XFxcXG4gICAgLy/ms6jmhI8ucGhw5LiN5Y+v5Lul6KKr5o6S6Zmk5ZCm5YiZ6J6N5YW06Kej5p6Q5LiN5LqGIHwucGhwJFxcXFxuICAgIC8v5aaC5p6c5piv5pKt5pS+5Zyw5Z2A5bCx55u05o6l6L+U5Zue5Zyw5Z2A5Yqg5LiKVUHvvIzkuI3mmK/nmoTor53lsLHov5Tlm55mYWxzZVxcXFxuICAgIC8vIGxldCB0MSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xcXFxuICAgIGxldCBjYWNoZVJlZ3ggPSBuZXcgUmVnRXhwKCdmaWxlOi8vL3N0b3JhZ2UvZW11bGF0ZWQvKC4qPylcXFxcXFxcXFxcXFxcXFxcLm0zdTh8aGlrZXI6Ly9maWxlcy8oLio/KVxcXFxcXFxcXFxcXFxcXFwubTN1OCcpO1xcXFxuICAgIGlmKGNhY2hlUmVneC50ZXN0KHBsYXlVcmwpKXtcXFxcbiAgICAgICAgcmV0dXJuIHBsYXlVcmxcXFxcbiAgICB9XFxcXG4gICAgZnVuY3Rpb24gZ2V0SG9zdCh1cmwpe1xcXFxuICAgICAgICAvLyBmYmHnmoRwYXJzZUxhennlpKrmhaLkuobljYPkuIfliKvnlKhcXFxcbiAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgIHJldHVybiB1cmwubWF0Y2goL15odHRwKHMpPzpcXFxcXFxcXC9cXFxcXFxcXC8oLio/KVxcXFxcXFxcLy8pWzBdLnNsaWNlKDAsLTEpO1xcXFxuICAgICAgICB9Y2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIC8qXFxcXG4gICAgICAgIGlmKHR5cGVvZihsb2cpPT09J3VuZGVmaW5lZCcpe1xcXFxuICAgICAgICAgICAgcmV0dXJuICBmYmEucGFyc2VMYXp5UnVsZSgkJCQoKS5sYXp5UnVsZSgodXJsKT0+e1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRIb21lKHVybClcXFxcbiAgICAgICAgICAgIH0sdXJsKSlcXFxcbiAgICAgICAgfWVsc2Uge1xcXFxuICAgICAgICAgICAgcmV0dXJuIGdldEhvbWUodXJsKVxcXFxuICAgICAgICB9XFxcXG4gICAgICAgICovXFxcXG4gICAgfVxcXFxuICAgIGxldCBwVXJsPXBsYXlVcmwuc3BsaXQoXFxcXFxcXCI7XFxcXFxcXCIpWzBdOy8v6I635Y+W5oqg5o6J5rW36ZiUdWHnrYnlj4LmlbDnmoTnvZHpobXmkq3mlL7pk77mjqVcXFxcbiAgICBsZXQgaG9zdCA9IGdldEhvc3QocFVybCk7IC8vIOiOt+WPluWfn+WQjVxcXFxuICAgIGlmKCFob3N0KXsvL+WIpOaWreaXoOWfn+WQjeebtOaOpeS4jeaYr+inhumikVxcXFxuICAgICAgICByZXR1cm4gZmFsc2VcXFxcbiAgICB9XFxcXG4gICAgZnVuY3Rpb24gcHJpbnQoZGF0YSl7XFxcXG4gICAgICAgIGlmKHR5cGVvZihsb2cpPT09J3VuZGVmaW5lZCcpe1xcXFxuICAgICAgICAgICAgcmV0dXJuICBmYmEubG9nKGRhdGEpXFxcXG4gICAgICAgIH1lbHNlIHtcXFxcbiAgICAgICAgICAgIHJldHVybiBsb2coZGF0YSlcXFxcbiAgICAgICAgfVxcXFxuICAgIH1cXFxcbiAgICByZWNoYW5nZT10eXBlb2YocmVjaGFuZ2UpPT09XFxcXFxcXCJmdW5jdGlvblxcXFxcXFwiP3JlY2hhbmdlOmZ1bmN0aW9uKHBsYXlVcmwpe3JldHVybiBwbGF5VXJsfTtcXFxcbiAgICBsZXQgZXhjZXB0V29yZHMgPSAnLmpzJHwuY3NzJHwudHMkfC5odG1sJHwuaHRtJHwuZ2lmJHwuanBnJHwuanBlZyR8LnBuZyR8LmljbyR8LnN2ZyR8LnR4dCQnLnNwbGl0KCd8JykubWFwKGl0PT4nXFxcXFxcXFxcXFxcXFxcXCcraXQpLmpvaW4oJ3wnKTtcXFxcbiAgICB2YXIgZXhjZXB0S2V5cyA9IG5ldyBSZWdFeHAoZXhjZXB0V29yZHMpO1xcXFxuICAgIGxldCBleGNlcHRXb3JkczEgPSAncmVmZXJlcj18dXJsPScuc3BsaXQoJ3wnKS5tYXAoaXQ9Pml0KS5qb2luKCd8Jyk7XFxcXG4gICAgdmFyIGV4Y2VwdEtleXMxID0gbmV3IFJlZ0V4cChleGNlcHRXb3JkczEpO1xcXFxuICAgIGxldCByZXBsYWNlV29yZHMgPSAncGxheW0zdTh8bTN1OFxcXFxcXFxcLnR2Jy5zcGxpdCgnfCcpLm1hcChpdD0+aXQpLmpvaW4oJ3wnKTtcXFxcbiAgICBsZXQgcmVwbGFjZUtleXMgPSBuZXcgUmVnRXhwKHJlcGxhY2VXb3JkcywnZycpO1xcXFxuICAgIGxldCB2aWRlb1dvcmRzID0gXFxcXFxcXCIvdmlkZW8vdG9zfC5tcDQkfC5tM3U4JHwuZmx2JHwuYXZpJHwuM2dwJHwubXBlZyR8LndtdiR8Lm1vdiR8cm12YnwuZGF0JHwubXAzJHwubTRhJHxxcUJGZG93bmxvYWR8bWltZT12aWRlbyUyRnxtaW1lX3R5cGU9dmlkZW9ffHR5cGU9bTN1OHxwdD1tM3U4XFxcXFxcXCIuc3BsaXQoJ3wnKS5tYXAoKGl0KT0+e1xcXFxuICAgICAgICAvL3R5cGU9bXA0XFxcXG4gICAgICAgIGlmKGl0LnN0YXJ0c1dpdGgoXFxcXFxcXCIuXFxcXFxcXCIpKXtcXFxcbiAgICAgICAgICAgIHJldHVybiAnXFxcXFxcXFxcXFxcXFxcXCcraXRcXFxcbiAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICByZXR1cm4gaXRcXFxcbiAgICAgICAgfVxcXFxuICAgIH0pLmpvaW4oXFxcXFxcXCJ8XFxcXFxcXCIpO1xcXFxuICAgIGxldCB2aWRlb0tleXMgPSBuZXcgUmVnRXhwKHZpZGVvV29yZHMpO1xcXFxuICAgIGxldCByVXJsID0gcFVybC5yZXBsYWNlKGhvc3QsJycpOy8v6I635Y+W6Zmk5byA5Z+f5ZCN55qE5Ymp5L2Z6ZO+5o6lXFxcXG4gICAgbGV0IHBVcmwyPXBVcmwuc3BsaXQoXFxcXFxcXCImXFxcXFxcXCIpWzBdLnNwbGl0KFxcXFxcXFwiP1xcXFxcXFwiKVswXTsvL+iOt+WPluS4jeW4puWPguaVsOeahOe9kemhtemTvuaOpVxcXFxuICAgIGxldCBydXJsMiA9IHBVcmwyLnJlcGxhY2UoaG9zdCwnJyk7Ly/ojrflj5bpmaTlvIDln5/lkI3nmoTliankvZnkuI3luKblj4LmlbDpk77mjqVcXFxcbiAgICBsZXQgaGFzS2V5ID0gdmlkZW9LZXlzLnRlc3QoclVybCl8fHZpZGVvS2V5cy50ZXN0KHJ1cmwyKTtcXFxcbiAgICBsZXQgcGFyVXJsID0gcFVybC5yZXBsYWNlKHBVcmwuc3BsaXQoXFxcXFxcXCI/XFxcXFxcXCIpWzBdLCcnKTsgLy8g5YiG5Ymy6Zeu5Y+35ZCO5Ymp5L2Z5Y+C5pWw55qE5a6M5pW06ZO+5o6lXFxcXG4gICAgbGV0IGV4Y0tleSA9IGV4Y2VwdEtleXMxLnRlc3QocGFyVXJsKTtcXFxcbiAgICBpZihyVXJsLnNwbGl0KCc/JykubGVuZ3RoPjIpe1xcXFxuICAgICAgICBsZXQgclVybDM9clVybC5zcGxpdChcXFxcXFxcIj9cXFxcXFxcIilbMV07Ly/ojrflj5Y/5YiG5Ymy5ZCO55qE56ys5LiA5q61XFxcXG4gICAgICAgIGhhc0tleSA9IGhhc0tleXx8dmlkZW9LZXlzLnRlc3QoclVybDMpO1xcXFxuICAgIH1cXFxcbiAgICBpZihoYXNLZXkmJiFleGNLZXkpe1xcXFxuICAgICAgICBsZXQgdGlwcyA9ICfmo4DmtYvliLDnlpHkvLzlpJrlqpLkvZPnmoTlnLDlnYA6JztcXFxcbiAgICAgICAgcHJpbnQoXFxcXFxcXCJqc+S4rVxcXFxcXFwiK3RpcHMrcFVybCk7XFxcXG4gICAgICAgIHByaW50KFxcXFxcXFwi5YiG5Ymy6Zeu5Y+35ZCOOlxcXFxcXFwiK3BhclVybCk7XFxcXG4gICAgfVxcXFxuICAgIC8vIGxvZygnMTonKyh2aWRlb0tleXMudGVzdChwVXJsKXx8dmlkZW9LZXlzLnRlc3QocFVybDIpfHx2aWRlb0tleXMudGVzdChwVXJsLnJlcGxhY2UocmVwbGFjZUtleXMsXFxcXFxcXCJcXFxcXFxcIikuc3BsaXQoXFxcXFxcXCImXFxcXFxcXCIpWzBdLnNwbGl0KFxcXFxcXFwiP1xcXFxcXFwiKVswXSkpKTtcXFxcbiAgICAvLyBsb2coJzI6JyshZXhjZXB0S2V5cy50ZXN0KHBVcmwuc3BsaXQoXFxcXFxcXCI/XFxcXFxcXCIpWzBdLnNwbGl0KCcmJylbMF0pKTtcXFxcbiAgICAvLyBsb2coJzM6JyshZXhjZXB0S2V5czEudGVzdChwVXJsLnJlcGxhY2UocFVybC5zcGxpdChcXFxcXFxcIj9cXFxcXFxcIilbMF0sJycpKSk7XFxcXG4gICAgaWYgKChoYXNLZXl8fHZpZGVvS2V5cy50ZXN0KHJVcmwucmVwbGFjZShyZXBsYWNlS2V5cyxcXFxcXFxcIlxcXFxcXFwiKS5zcGxpdChcXFxcXFxcIiZcXFxcXFxcIilbMF0uc3BsaXQoXFxcXFxcXCI/XFxcXFxcXCIpWzBdKSApJiYgIWV4Y2VwdEtleXMudGVzdChwVXJsMikmJiFleGNlcHRLZXlzMS50ZXN0KHBVcmwyKSkge1xcXFxuICAgICAgICBpZighKC9Vc2VyLUFnZW50fFJlZmVyZXJALy50ZXN0KHBsYXlVcmwpKSl7XFxcXG4gICAgICAgICAgICBpZigvbGVjbG91ZFxcXFxcXFxcLmNvbXxiaWxpdmlkZW8vLnRlc3QocGxheVVybCkpe1xcXFxuICAgICAgICAgICAgICAgIHBsYXlVcmwrPVxcXFxcXFwiO3tSZWZlcmVyQGh0dHBzOi8vd3d3LmJpbGliaWxpLmNvbS8mJlVzZXItQWdlbnRATW96aWxsYS81LjB9XFxcXFxcXCI7XFxcXG4gICAgICAgICAgICB9ZWxzZSBpZigvaXhpZ3VhXFxcXFxcXFwuY29tLy50ZXN0KHBsYXlVcmwpKXtcXFxcbiAgICAgICAgICAgICAgICBwbGF5VXJsKz1cXFxcXFxcIiNpc3ZpZGVvPXRydWUjO3tSZWZlcmVyQGh0dHBzOi8vd3d3Lml4aWd1YS5jb20vJiZVc2VyLUFnZW50QE1vemlsbGEvNS4wfVxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgZWxzZSBpZigvbWd0dlxcXFxcXFxcLmNvbXxieXRlYW1vbmUvLnRlc3QocGxheVVybCkpe1xcXFxuICAgICAgICAgICAgICAgIHBsYXlVcmwrPVxcXFxcXFwiO3tVc2VyLUFnZW50QE1vemlsbGEvNS4wfVxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgfWVsc2UgaWYoL3B0d29cXFxcXFxcXC53a2ZpbGVcXFxcXFxcXC5jb20vLnRlc3QocGxheVVybCkmJi91cmw9Ly50ZXN0KHBsYXlVcmwpKXtcXFxcbiAgICAgICAgICAgICAgICBwbGF5VXJsPXBsYXlVcmwuc3BsaXQoXFxcXFxcXCJ1cmw9XFxcXFxcXCIpWzFdK1xcXFxcXFwiO3tSZWZlcmVyQGh0dHBzOi8vZmFudHVhbi50dn1cXFxcXFxcIlxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgLy8g5aSE55CG5aSn5biI5YWE5LmL57G755qEYXBwXFxcXG4gICAgICAgICAgICAvLyBlbHNle1xcXFxuICAgICAgICAgICAgLy8gICAgIHBsYXlVcmwrPVxcXFxcXFwiO3tVc2VyLUFnZW50QE1vemlsbGEvNS4wfVxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgLy8gfVxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIHBsYXlVcmw9cmVjaGFuZ2UocGxheVVybCk7XFxcXG4gICAgICAgIGlmKCEvI2lzVmlkZW89dHJ1ZSMvLnRlc3QocGxheVVybCkpe1xcXFxuICAgICAgICAgICAgcGxheVVybCs9XFxcXFxcXCIjaXNWaWRlbz10cnVlI1xcXFxcXFwiO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIC8vIGxldCB0MiA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xcXFxuICAgICAgICAvLyBwcmludCgn5Yik5pataXNWaWRlb+iAl+aXtjonKyh0Mi10MSkpO1xcXFxuICAgICAgICByZXR1cm4gcGxheVVybDtcXFxcbiAgICB9ZWxzZXtcXFxcbiAgICAgICAgLy8gbGV0IHQyID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XFxcXG4gICAgICAgIC8vIHByaW50KCfliKTmlq1pc1ZpZGVv6ICX5pe2OicrKHQyLXQxKSk7XFxcXG4gICAgICAgIHJldHVybiBmYWxzZTtcXFxcbiAgICB9XFxcXG59XFxcXG5mdW5jdGlvbiBjb21QYXJzZShwYXJTdHIsZWosb25seWJhY2ssaHRtbCl7XFxcXG4gICAgLy/liJfooajvvIzmoIfpopjvvIzlm77niYfvvIzmj4/ov7DvvIzpk77mjqXvvIzlhoXlrrlcXFxcbiAgICBlaiA9IGVqfHxmYWxzZTsvL+acieS6jOe6p1xcXFxuICAgIG9ubHliYWNrPW9ubHliYWNrfHxmYWxzZTsvL+WPqui/lOWbnuaVsOaNrlxcXFxuICAgIGh0bWwgPSBodG1sfHxnZXRSZXNDb2RlKCk7XFxcXG4gICAgaHRtbCA9IHR5cGVvZihodG1sKT09PSdzdHJpbmcnP2h0bWw6aHRtbC5odG1sO1xcXFxuICAgIHJldHVybiAkLnRvU3RyaW5nKChwYXJTdHIsZWosb25seWJhY2ssaHRtbCxpc1BpYyk9PntcXFxcbiAgICAgICAgbGV0IHQ9cGFyU3RyLnNwbGl0KFxcXFxcXFwiO1xcXFxcXFwiKTtcXFxcbiAgICAgICAgbGV0IGQ9W107XFxcXG4gICAgICAgIC8vIGxldCBsaXN0PXBkZmEoZ2V0UmVzQ29kZSgpLHRbMF0pO1xcXFxuICAgICAgICBsZXQgbGlzdD1wZGZhKGh0bWwsdFswXSk7XFxcXG4gICAgICAgIGxldCBsYXp5ID0gJCgnJykubGF6eVJ1bGUoKCk9PntcXFxcbiAgICAgICAgICAgIGNvbnN0IHtsYXp5UGFyc2V9ID0gJC5yZXF1aXJlKCdoaWtlcjovL3BhZ2UvZ2xvYmFsUGFyc2U/cnVsZT3pgZPplb/ku5PlupNQcm8nKTtcXFxcbiAgICAgICAgICAgIHJldHVybiBsYXp5UGFyc2UoaW5wdXQpXFxcXG4gICAgICAgIH0pO1xcXFxuICAgICAgICBmb3IobGV0IGkgaW4gbGlzdCl7XFxcXG4gICAgICAgICAgICBsZXQgX3BpYyA9IHRbMl0/cGQobGlzdFtpXSx0WzJdKTonJztcXFxcbiAgICAgICAgICAgIGlmKGlzUGljKF9waWMpJiYhL0BSZWZlcmVyPS8udGVzdChfcGljKSl7XFxcXG4gICAgICAgICAgICAgICAgX3BpYys9J0BSZWZlcmVyPSdcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIGxldCBpdD17XFxcXG4gICAgICAgICAgICAgICAgdGl0bGU6cGRmaChsaXN0W2ldLHRbMV0pLFxcXFxuICAgICAgICAgICAgICAgIHBpY191cmw6X3BpYyxcXFxcbiAgICAgICAgICAgICAgICBkZXNjOnBkZmgobGlzdFtpXSx0WzNdKSxcXFxcbiAgICAgICAgICAgICAgICB1cmw6ZWo/cGQobGlzdFtpXSx0WzRdKTpwZChsaXN0W2ldLHRbNF0pK2xhenlcXFxcbiAgICAgICAgICAgIH07XFxcXG4gICAgICAgICAgICBpZih0Lmxlbmd0aD41KXsvL+WGheWuue+8jOeUqOS6juaQnOe0olxcXFxuICAgICAgICAgICAgICAgIGl0LmNvbnRlbnQ9cGRmaChsaXN0W2ldLHRbNV0pXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICBkLnB1c2goaXQpO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGlmKG9ubHliYWNrKXtcXFxcbiAgICAgICAgICAgIHJldHVybiBkXFxcXG4gICAgICAgIH1lbHNle1xcXFxuICAgICAgICAgICAgc2V0UmVzdWx0KGQpXFxcXG4gICAgICAgIH1cXFxcbiAgICB9LHBhclN0cixlaixvbmx5YmFjayxodG1sLGlzUGljKVxcXFxufVxcXFxuXFxcXG5mdW5jdGlvbiBpc0JhZFZpZGVvKHZpZGVvVXJsKSB7Ly/mmK/lnY/nmoTop4bpopFcXFxcbiAgICBsZXQgZG1QYXRoID0gJ2hpa2VyOi8vZmlsZXMvY2FjaGUvZGlhb21hby50eHQnOy8v5ZCK5q+b5qih5byP6L+H5ruk5paH5Lu26Lev5b6EXFxcXG4gICAgbGV0IGRtVXJscztcXFxcbiAgICB0cnkge1xcXFxuICAgICAgICBkbVVybHMgPSByZXF1ZXN0KGRtUGF0aCkudHJpbSgpLnNwbGl0KCdcXFxcXFxcXG4nKS5maWx0ZXIoaXQgPT4gaXQgJiYgIWl0LnN0YXJ0c1dpdGgoJy8vJykpO1xcXFxuICAgIH0gY2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgZG1VcmxzID0gW107XFxcXG4gICAgfVxcXFxuXFxcXG4gICAgZnVuY3Rpb24gaGFzRG0odmlkZW9VcmwsIGRtVXJscykgey8v5pKt5pS+5Zyw5Z2A5piv5ZCm5Li65ZCK5q+b6KeG6aKRXFxcXG4gICAgICAgIGlmIChkbVVybHMubGVuZ3RoIDwgMSkge1xcXFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgZnVuY3Rpb24gcHJpbnQoc3RyKXtcXFxcbiAgICAgICAgICAgIGlmKHR5cGVvZihsb2cpIT09J3VuZGVmaW5lZCcpe1xcXFxuICAgICAgICAgICAgICAgIGxvZyhzdHIpO1xcXFxuICAgICAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICAgICAgZmJhLmxvZyhzdHIpO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIGZvciAobGV0IGRtVXJsIG9mIGRtVXJscykge1xcXFxuICAgICAgICAgICAgaWYgKChuZXcgUmVnRXhwKGRtVXJsKSkudGVzdCh2aWRlb1VybCkpIHsvL+aSreaUvuWcsOWdgOWMheWQq+WQiuavm+agh+W/l+eahOWcsOWdgFxcXFxuICAgICAgICAgICAgICAgIHByaW50KCflkIrmr5vop4bpopEs6Ieq5Yqo6L+H5rukOicrdmlkZW9VcmwpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgcHJpbnQoJ+mdnuWQiuavm+inhumikSzlj6/mkq3mlL46Jyt2aWRlb1VybCk7XFxcXG4gICAgICAgIHJldHVybiBmYWxzZVxcXFxuICAgIH1cXFxcblxcXFxuICAgIGZ1bmN0aW9uIGlzRG0ocmV0KSB7XFxcXG4gICAgICAgIGlmICghcmV0KSB7XFxcXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxcXFxuICAgICAgICB9XFxcXG4gICAgICAgIHJldHVybiBoYXNEbShyZXQuc3BsaXQoJyMnKVswXS5zcGxpdCgnOycpWzBdLCBkbVVybHMpXFxcXG4gICAgfVxcXFxuICAgIHJldHVybiBpc0RtKHZpZGVvVXJsKVxcXFxufVxcXFxuXFxcXG5mdW5jdGlvbiBsYXp5UGFyc2UocGxheVVybCxtcyx0bSxyZWNoYW5nZSl7XFxcXG4gICAgLy8gbG9nKCfosIPnlKjku5PlupPlhY3ll4XmjqLkvKDlj4LotoXml7bkuLo6Jyttcyk7XFxcXG4gICAgdG0gPSBwYXJzZUludCh0bSl8fDUwMDA7XFxcXG4gICAgY29uc3Qge2lzVmlkZW8sZ2V0SGVhZGVycyxpc0JhZFZpZGVvfSA9ICQucmVxdWlyZSgnaGlrZXI6Ly9wYWdlL2dsb2JhbFBhcnNlP3J1bGU96YGT6ZW/5LuT5bqTUHJvJyk7XFxcXG4gICAgbGV0IHJlYWxVcmwgPSBpc1ZpZGVvKHBsYXlVcmwscmVjaGFuZ2UpO1xcXFxuICAgIC8vbG9nKHJlYWxVcmwpO1xcXFxuICAgIGlmKHR5cGVvZihyZWFsVXJsKT09J3N0cmluZycpey8vYm9vbOWAvOWwseaYr+Wksei0pVxcXFxuICAgICAgICB0cnl7XFxcXG4gICAgICAgICAgICBsZXQgcnVybD1yZWFsVXJsLnNwbGl0KFxcXFxcXFwiO1xcXFxcXFwiKVswXS5zcGxpdChcXFxcXFxcIiNcXFxcXFxcIilbMF07XFxcXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShyZXF1ZXN0KHJ1cmwse3RpbWVvdXQ6dG19KSkudXJsXFxcXG4gICAgICAgIH1jYXRjaChlKXtcXFxcbiAgICAgICAgICAgIHJldHVybiByZWFsVXJsXFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgLy9yZXR1cm4gcmVhbFVybFxcXFxuICAgIH1cXFxcblxcXFxuICAgIC8vbG9nKFxcXFxcXFwi6K6/6Zeu6LaF5pe2OlxcXFxcXFwiK3RtKTtcXFxcbiAgICBsb2coXFxcXFxcXCLlsJ3or5XpgZPplb/ku5PlupN4NeWFjeWXhTpcXFxcXFxcIitwbGF5VXJsKTtcXFxcbiAgICBjbGVhclZhcihcXFxcXFxcIl94NWp4VXJsXFxcXFxcXCIpO1xcXFxuICAgIGxldCBiYWQ9JChcXFxcXFxcIue9kee7nOS4jeS9s+aIluiAheeWkeS8vOWvueaWuee9keermeaMguS6hu+8jOS9oOimgeafpeeci+WFtue9kemhteWQl++8n1xcXFxcXFwiKS5jb25maXJtKChwbGF5VXJsKT0+e1xcXFxuICAgICAgICBsb2coXFxcXFxcXCLnvZHnq5nnnIvotbfmnaXmjILkuoY6XFxcXFxcXCIrcGxheVVybCk7XFxcXG4gICAgICAgIHJldHVybiBwbGF5VXJsXFxcXG4gICAgfSxwbGF5VXJsKTtcXFxcbiAgICB0cnl7XFxcXG4gICAgICAgIHZhciBiYWNrPXJlcXVlc3QocGxheVVybCx7aGVhZGVyczogZ2V0SGVhZGVycyhwbGF5VXJsKSx0aW1lb3V0OnRtfSk7XFxcXG4gICAgICAgIC8vdmFyIGJhY2s9ZmV0Y2gocGxheVVybCx7aGVhZGVyczogeydVc2VyLUFnZW50JzogUENfVUF9fSk7XFxcXG4gICAgICAgIGlmKCFiYWNrKXtcXFxcbiAgICAgICAgICAgIGxvZyhcXFxcXFxcIue9keermVxcXFxcXFwiK3BsYXlVcmwrXFxcXFxcXCLnoa7lrp7llaXkuZ/msqHov5Tlm55cXFxcXFxcIik7XFxcXG4gICAgICAgICAgICByZXR1cm4gYmFkXFxcXG4gICAgICAgIH1lbHNlIGlmKC8jRVhUSU5GLy50ZXN0KGJhY2spKXtcXFxcbiAgICAgICAgICAgIC8vbGV0IGxjYWNoZT1cXFxcXFxcIi9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL2NvbS5leGFtcGxlLmhpa2Vydmlldy9maWxlcy9Eb2N1bWVudHMvY2FjaGUvdmlkZW8ubTN1OFxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgLy93cml0ZUZpbGUobGNhY2hlLGJhY2spO1xcXFxuICAgICAgICAgICAgLy9yZXR1cm4gbGNhY2hlK1xcXFxcXFwiIyNcXFxcXFxcIitwbGF5VXJsK1xcXFxcXFwiI2lzVmlkZW89dHJ1ZSNcXFxcXFxcIlxcXFxuICAgICAgICAgICAgcGxheVVybD1jYWNoZU0zdTgocGxheVVybCk7XFxcXG4gICAgICAgICAgICByZXR1cm4gcGxheVVybFxcXFxuICAgICAgICB9ZWxzZSBpZigoIS/op6blj5HkuobpmLLnm5fpk7585pyq5o6I5p2DfOaOpeWPo+mYsuebly8udGVzdChiYWNrKSkmJighL2h0dHB8dXJsLy50ZXN0KGJhY2spKSYmKCEvbXNnfGNvZGV8aHRtbC8udGVzdChiYWNrKSkpe1xcXFxuICAgICAgICAgICAgbG9nKGJhY2spO1xcXFxuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+eWkeS8vOWvueaWueaVsOaNruWKoOWvhuS6hu+8jOWFt+S9k+aVsOaNrueci+aXpeW/lydcXFxcbiAgICAgICAgfVxcXFxuICAgIH1jYXRjaChlKXtcXFxcbiAgICAgICAgbG9nKGUubWVzc2FnZSk7XFxcXG4gICAgICAgIHJldHVybiBiYWRcXFxcbiAgICB9XFxcXG4gICAgdHJ5IHtcXFxcbiAgICAgICAgYmFjaz1KU09OLnBhcnNlKGJhY2spO1xcXFxuICAgICAgICBsZXQgcmVhbFVybD1iYWNrLnVybDtcXFxcbiAgICAgICAgaWYodHlwZW9mKHJlYWxVcmwpPT1cXFxcXFxcInVuZGVmaW5lZFxcXFxcXFwifHwhcmVhbFVybCl7XFxcXG4gICAgICAgICAgICBsb2coYmFjayk7XFxcXG4gICAgICAgICAgICByZXR1cm4gXFxcXFxcXCJ0b2FzdDovL+mBk+mVv+S7k+W6k+ino+aekOWksei0pe+8gei/lOWbnuaSreaUvuWcsOWdgOS4uuepulxcXFxcXFwiXFxcXG4gICAgICAgIH0gZWxzZSBpZih0eXBlb2YoaXNWaWRlbyhyZWFsVXJsLHJlY2hhbmdlKSk9PSdzdHJpbmcnKXtcXFxcbiAgICAgICAgICAgIHJldHVybiBpc1ZpZGVvKHJlYWxVcmwscmVjaGFuZ2UpO1xcXFxuICAgICAgICB9ZWxzZXtcXFxcbiAgICAgICAgICAgIHJldHVybiByZWFsVXJsK1xcXFxcXFwiI2lzVmlkZW89dHJ1ZSNcXFxcXFxcIjtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICAvL2Vsc2V7XFxcXG4gICAgICAgIC8vcmVhbFVybCs9XFxcXFxcXCI7e1VzZXItQWdlbnRATW96aWxsYS81LjB9XFxcXFxcXCI7XFxcXG4gICAgICAgIC8vIH1cXFxcbiAgICB9Y2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgbG9nKFxcXFxcXFwi5qOA5rWL5Yiw6Kej5p6Q5Y+j6Z2eanNvbumUmeivrzpcXFxcXFxcIitlLm1lc3NhZ2UrJyzlvIDlp4t4NeWFjeWXheaOoicpO1xcXFxuICAgICAgICAvLyByZXF1aXJlKCdodHRwczovL2hqZGhueC5jb2RpbmcubmV0L3AvaGlrZXIvZC9kci9naXQvcmF3L21hc3Rlci9qcy9sc2cuanMnKTsvL+W8leeUqOacrOWcsOWCqOWtmOaPkuS7tlxcXFxuICAgICAgICBjb25zdCBsc2c9JC5yZXF1aXJlKFxcXFxcXFwiaGlrZXI6Ly9wYWdlL2xvY2FsU3RvcmFnZT9ydWxlPemBk+mVv+S7k+W6k1Byb1xcXFxcXFwiKTsvL+W8leeUqOWtkOmhtemdouacrOWcsOWCqOWtmOaPkuS7tlxcXFxuICAgICAgICBsZXQgbG9jYWxfbXMgPSBsc2cuZ2V0SXRlbSgndGltZW91dCcpO1xcXFxuICAgICAgICBsZXQgbXMgPSBwYXJzZUludChtcyl8fHBhcnNlSW50KGxvY2FsX21zKXx8NTAwMDtcXFxcbiAgICAgICAgbGV0IG1heF9jb3VudD1NYXRoLmNlaWwobXMvMjUwKTtcXFxcbiAgICAgICAgbG9nKFxcXFxcXFwi5pys5qyh5ZeF5o6i6LaF5pe2OlxcXFxcXFwiK21zK1xcXFxcXFwi5YWx6K6h5b6F5oqT5YyFOlxcXFxcXFwiK21heF9jb3VudCtcXFxcXFxcIuasoVxcXFxcXFwiKTtcXFxcbiAgICAgICAgc2hvd0xvYWRpbmcoJ+WXheaOouS4re+8jOiLpeWksei0peWwseWIh+aNondlYuWXheaOoi4uLicpO1xcXFxuICAgICAgICBsZXQgX3g1ID0gJC50b1N0cmluZygoaXNWaWRlbyxyZWNoYW5nZSxwbGF5VXJsLG1heF9jb3VudCxQQ19VQSxpc0JhZFZpZGVvKT0+e1xcXFxuICAgICAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgICAgICBpZih0eXBlb2YoZmJhKT09J3VuZGVmaW5lZCd8fCFmYmEpe1xcXFxuICAgICAgICAgICAgICAgICAgICB2YXIgZmJhID0gZnlfYnJpZGdlX2FwcDtcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mKHJlcXVlc3QpPT0ndW5kZWZpbmVkJ3x8IXJlcXVlc3Qpe1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgZXZhbChmYmEuZ2V0SW50ZXJuYWxKcygpKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIH1jYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgICAgICAgICBmYmEubG9nKGUubWVzc2FnZSk7XFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIGZiYS5wdXRWYXIoXFxcXFxcXCJfeDVqeFVybFxcXFxcXFwiLHBsYXlVcmwpO1xcXFxuICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5jb3VudCA9PSBudWxsKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNvdW50PTE7XFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIGxldCB0ZXh0PScnO1xcXFxuICAgICAgICAgICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIHRleHQ9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcXFxcXFxcImJvZHlcXFxcXFxcIikuaW5uZXJUZXh0O1xcXFxuICAgICAgICAgICAgICAgIH1jYXRjaCAoZSkge2ZiYS5sb2coZS5tZXNzYWdlKX1cXFxcbiAgICAgICAgICAgICAgICBpZigv6Kem5Y+R5LqG6Ziy55uX6ZO+fOacquaOiOadg3zmjqXlj6PpmLLnm5cvLnRlc3QodGV4dCkmJndpbmRvdy5jb3VudD09PTEpe1xcXFxuICAgICAgICAgICAgICAgICAgICBmYmEubG9nKFxcXFxcXFwi5qOA5rWL5Yiw5pyJ5o6I5p2D77yM5byA5aeL6L+H5o6I5p2DXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgICAgICAgICAvL2xvY2F0aW9uLnJlbG9hZCgpO1xcXFxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmPWZiYS5nZXRWYXIoXFxcXFxcXCJfeDVqeFVybFxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgd2luZG93LmNvdW50Kys7XFxcXG4gICAgICAgICAgICAgICAgLy8gZmJhLmxvZygnY291bnQ6Jyt3aW5kb3cuY291bnQrJyxtYXhfY291bnQ6JyttYXhfY291bnQpO1xcXFxuICAgICAgICAgICAgICAgIGlmKCB3aW5kb3cuY291bnQgPj0gbWF4X2NvdW50KXtcXFxcbiAgICAgICAgICAgICAgICAgICAgZmJhLmxvZyhcXFxcXFxcIui2hei/h1xcXFxcXFwiK21heF9jb3VudCoyNTArXFxcXFxcXCLmr6vnp5LmnKrojrflj5bliLDotYTmupDlnLDlnYDvvIzot7PliLDmupDnvZHpobUs5Lul5LiL5piv5Yqg6L296L+H55qE5Zyw5Z2AXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRleHQ9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcXFxcXFxcImJvZHlcXFxcXFxcIikuaW5uZXJUZXh0O1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmJhLmxvZyh0ZXh0KTtcXFxcbiAgICAgICAgICAgICAgICAgICAgfWNhdGNoIChlKSB7ZmJhLmxvZyhlLm1lc3NhZ2UpfVxcXFxuICAgICAgICAgICAgICAgICAgICBmYmEubG9nKEpTT04uc3RyaW5naWZ5KF9nZXRVcmxzKCkpKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZiYS5nZXRWYXIoXFxcXFxcXCJfeDVqeFVybFxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gbXV0ZU1lKGVsZW0pIHtcXFxcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0ucGF1c2UoKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIHZhciB2aWRlb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxcXFxcXFwidmlkZW9cXFxcXFxcIiksIGF1ZGlvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXFxcXFxcXCJhdWRpb1xcXFxcXFwiKSwgdjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxcXFxcXFwiZW1iZWRcXFxcXFxcIiksIHYzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcXFxcXFxcIiNwbGF5ZXJcXFxcXFxcIik7XFxcXG4gICAgICAgICAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKHZpZGVvcywgZnVuY3Rpb24gKHZpZGVvKSB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRlTWUodmlkZW8pO1xcXFxuICAgICAgICAgICAgICAgICAgICB9KTtcXFxcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxcXFxuICAgICAgICAgICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbChhdWRpb3MsIGZ1bmN0aW9uIChhdWRpbykge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgbXV0ZU1lKGF1ZGlvKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgfSk7XFxcXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cXFxcbiAgICAgICAgICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgICAgICAgICBbXS5mb3JFYWNoLmNhbGwodjIsIGZ1bmN0aW9uICh2KSB7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRlTWUodik7XFxcXG4gICAgICAgICAgICAgICAgICAgIH0pO1xcXFxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9XFxcXG4gICAgICAgICAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKHYzLCBmdW5jdGlvbiAodikge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgbXV0ZU1lKHYpO1xcXFxuICAgICAgICAgICAgICAgICAgICB9KTtcXFxcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxcXFxuICAgICAgICAgICAgICAgIHZhciB1cmxzID0gX2dldFVybHMoKTtcXFxcbiAgICAgICAgICAgICAgICAvLyBmYmEubG9nKEpTT04uc3RyaW5naWZ5KHVybHMpKTtcXFxcbiAgICAgICAgICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGkgaW4gdXJscykge1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHU9dXJsc1tpXTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeXt1PWRlY29kZVVSSUNvbXBvbmVudCh1KTt9Y2F0Y2goZSl7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdT11bmVzY2FwZSh1KTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBpZigvdXJsPWh0dHAvLnRlc3QodSkpe1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUgPSB1LnNwbGl0KFxcXFxcXFwidXJsPVxcXFxcXFwiKS5zbGljZSgtMSlbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmJhLmxvZyhcXFxcXFxcInVybOWIhuWJsjpcXFxcXFxcIit1KTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKC91cmw9XFxcXFxcXFwvLy50ZXN0KHUpJiYvXFxcXFxcXFwubTN1OC8udGVzdCh1KSl7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGhvc3QgPSB1Lm1hdGNoKC8oLiopXFxcXFxcXFwvXFxcXFxcXFwvKC4qPylcXFxcXFxcXC8vKVswXTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ID0gaG9zdCt1LnNwbGl0KFxcXFxcXFwidXJsPVxcXFxcXFwiKS5zbGljZSgtMSlbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmJhLmxvZyhcXFxcXFxcInVybOWIhuWJsjpcXFxcXFxcIit1KTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoL3ZpZD1odHRwLy50ZXN0KHUpKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ID0gdS5zcGxpdChcXFxcXFxcInZpZD1cXFxcXFxcIikuc2xpY2UoLTEpWzBdO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcXFxcXCJ2aWTliIblibI6XFxcXFxcXCIrdSk7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZigvdmlkPVxcXFxcXFxcLy8udGVzdCh1KSYmL1xcXFxcXFxcLm0zdTgvLnRlc3QodSkpe1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBob3N0ID0gdS5tYXRjaCgvKC4qKVxcXFxcXFxcL1xcXFxcXFxcLyguKj8pXFxcXFxcXFwvLylbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdSA9IGhvc3QrdS5zcGxpdChcXFxcXFxcInZpZD1cXFxcXFxcIikuc2xpY2UoLTEpWzBdO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcXFxcXCJ2aWTliIblibI6XFxcXFxcXCIrdSk7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKC9cXFxcXFxcXD8oLiopPWh0dHAvLnRlc3QodSkmJi9cXFxcXFxcXC5tM3U4Ly50ZXN0KHUpKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ID0gXFxcXFxcXCJodHRwXFxcXFxcXCIrdS5zcGxpdCgvXFxcXFxcXFw/KC4qKT1odHRwLykuc2xpY2UoLTEpWzBdO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiYS5sb2coXFxcXFxcXCLlhbbku5bliIblibI6XFxcXFxcXCIrdSk7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3xpbmRleFxcXFxcXFxcLm0zdTgkXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKC9cXFxcXFxcXC8xXFxcXFxcXFwubTN1OC8udGVzdCh1KSl7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICB1PXUucmVwbGFjZSgvJmZyb209Lip8Jm5leHQ9Lip8Jmp1bXA9LiovLCcnKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZWFsVXJsID0gaXNWaWRlbyh1LHJlY2hhbmdlKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZihyZWFsVXJsKT09J3N0cmluZycmJiFpc0JhZFZpZGVvKHUpKXsvL+i/h+a7pOWQiuavm+inhumikVxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZnlfYnJpZGdlX2FwcC5zZXRXZWJVYShQQ19VQSk7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mKGZiYS5nZXRIZWFkZXJVcmwpIT09J3VuZGVmaW5lZCcmJnR5cGVvZihyZWNoYW5nZSkhPT0nZnVuY3Rpb24nKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGV0IGJhY2tVcmwgPSBmYmEuZ2V0SGVhZGVyVXJsKHUucmVwbGFjZShcXFxcXFxcIjt7XFxcXFxcXCIsXFxcXFxcXCIjaXNWaWRlbz10cnVlIzt7XFxcXFxcXCIpKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJhY2tVcmwgPSBmYmEuZ2V0SGVhZGVyVXJsKHVybHNbaV0pLnJlcGxhY2UoJzt7JywnI2lnbm9yZUltZz10cnVlIyNpc1ZpZGVvPXRydWUjO3snKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHUxID0gYmFja1VybC5zcGxpdCgnI2lnbm9yZUltZycpWzBdO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdTIgPSAnI2lnbm9yZUltZycrYmFja1VybC5zcGxpdCgnI2lnbm9yZUltZycpWzFdO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MSA9IHUxLnJlcGxhY2UoLyZmcm9tPS4qfCZuZXh0PS4qfCZqdW1wPS4qLywnJyk7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKC91cmw9aHR0cC8udGVzdCh1MSkpe1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEgPSB1MS5zcGxpdChcXFxcXFxcInVybD1cXFxcXFxcIikuc2xpY2UoLTEpWzBdO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZigvdXJsPVxcXFxcXFxcLy8udGVzdCh1MSkmJi9cXFxcXFxcXC5tM3U4Ly50ZXN0KHUxKSl7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaG9zdDEgPSB1MS5tYXRjaCgvKC4qKVxcXFxcXFxcL1xcXFxcXFxcLyguKj8pXFxcXFxcXFwvLylbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MSA9IGhvc3QxK3UxLnNwbGl0KFxcXFxcXFwidXJsPVxcXFxcXFwiKS5zbGljZSgtMSlbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYmEubG9nKFxcXFxcXFwidXJs5YiG5YmyOlxcXFxcXFwiK3UpO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoL3ZpZD1odHRwLy50ZXN0KHUxKSl7XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MSA9IHUxLnNwbGl0KFxcXFxcXFwidmlkPVxcXFxcXFwiKS5zbGljZSgtMSlbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKC92aWQ9XFxcXFxcXFwvLy50ZXN0KHUxKSYmL1xcXFxcXFxcLm0zdTgvLnRlc3QodTEpKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBob3N0MSA9IHUxLm1hdGNoKC8oLiopXFxcXFxcXFwvXFxcXFxcXFwvKC4qPylcXFxcXFxcXC8vKVswXTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUxID0gaG9zdDErdTEuc3BsaXQoXFxcXFxcXCJ2aWQ9XFxcXFxcXCIpLnNsaWNlKC0xKVswXTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKC9cXFxcXFxcXD8oLiopPWh0dHAvLnRlc3QodTEpJiYvXFxcXFxcXFwubTN1OC8udGVzdCh1MSkpe1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTEgPSBcXFxcXFxcImh0dHBcXFxcXFxcIit1MS5zcGxpdCgvXFxcXFxcXFw/KC4qKT1odHRwLykuc2xpY2UoLTEpWzBdO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tVcmwgPSB1MSArIHUyO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmYmEubG9nKCfov5Tlm57oh6rliqjliqBjb29raWXpk77mjqU6JytiYWNrVXJsKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmJhLmxvZygn6L+U5Zue6ZO+5o6lOicrdSsn5bm26Ieq5Yqo5Yqg5LqGY29va2llLOWFt+S9k2Nvb2tpZeWcqOinhumikeaSreaUvuWkhOafpeeciycpO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmFja1VybDtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmJhLmxvZyhcXFxcXFxcIui/lOWbnuS7k+W6k3g15YWN5ZeF57uT5p6cOlxcXFxcXFwiK3JlYWxVcmwpO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhbFVybFxcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIH1jYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgICAgICAgICBmYmEubG9nKGUubWVzc2FnZSlcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICB9Y2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgICAgICAgICAvLyBmeV9icmlkZ2VfYXBwLmxvZygneDXlpKfojIPlm7TplJnor686JytlLm1lc3NhZ2UpO1xcXFxuICAgICAgICAgICAgICAgIGFsZXJ0KCd4NeWkp+iMg+WbtOmUmeivrzonK2UubWVzc2FnZSk7XFxcXG4gICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+aKpemUmee7k+adn3g1J1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9LGlzVmlkZW8scmVjaGFuZ2UscGxheVVybCxtYXhfY291bnQsUENfVUEsaXNCYWRWaWRlbyk7XFxcXG4gICAgICAgIGxldCB1c2VXZWI9bHNnLmdldEl0ZW0oXFxcXFxcXCLpgJrlhY1cXFxcXFxcIixcXFxcXFxcIlg1XFxcXFxcXCIpPT09XFxcXFxcXCJXRUJcXFxcXFxcIjtcXFxcbiAgICAgICAgLy9sb2coXFxcXFxcXCLku5PlupPkvb/nlKh3ZWLpgJrlhY3mm7/ku6N4NTpcXFxcXFxcIit1c2VXZWIpO1xcXFxuICAgICAgICBsZXQgcnVsZUhlYWQ9dXNlV2ViJiZwYXJzZUludChnZXRBcHBWZXJzaW9uKCkpPj0yMzM5P1xcXFxcXFwid2ViUnVsZTovL1xcXFxcXFwiOlxcXFxcXFwieDVSdWxlOi8vXFxcXFxcXCI7XFxcXG4gICAgICAgIGxldCB4NVVybCA9IHJ1bGVIZWFkK3BsYXlVcmwrICdAJyArX3g1O1xcXFxuICAgICAgICByZXR1cm4geDVVcmxcXFxcbiAgICB9XFxcXG59XFxcXG5cXFxcbmZ1bmN0aW9uIHg1UGFyc2VQcm8oeDVsaXN0LHg1VGltZW91dCxpc1ZpZGVvKXtcXFxcbiAgICBsZXQgYnBhdGggPSAnZmlsZTovLy9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL2NvbS5leGFtcGxlLmhpa2Vydmlldy9maWxlcy9Eb2N1bWVudHMvcnVsZXMvZHpIb3VzZS9odG1sL+a1t+mYlOWXheaOouWZqC5odG1sJztcXFxcbiAgICBsZXQgYmNvZGUgPSBmZXRjaChicGF0aCk7XFxcXG4gICAgaWYoIWJjb2RlfHwhL2Z5X2JyaWRnZV9hcHAvLnRlc3QoYmNvZGUpKXtcXFxcbiAgICAgICAgbG9nKCfmnKzlnLDmnKrlronoo4Xll4XmjqLlmajvvIzlvIDlp4vlronoo4UnKTtcXFxcbiAgICAgICAgY29uc3Qge2FwaX0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5P3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcXFxcXCIpO1xcXFxuICAgICAgICBsZXQgaHRtbCA9IGZldGNoKGFwaS5ob3N0KycvcnVsZWxpc3QuanNvbj9pZD0yMDU1Jyk7XFxcXG4gICAgICAgIGlmKC/mtbfpmJTop4bnlYwvLnRlc3QoaHRtbCkpe1xcXFxuICAgICAgICAgICAgd3JpdGVGaWxlKGJwYXRoLGh0bWwpO1xcXFxuICAgICAgICB9ZWxzZXtcXFxcbiAgICAgICAgICAgIHdyaXRlRmlsZShicGF0aCxmZXRjaCgnaHR0cHM6Ly9oamRobnguY29kaW5nLm5ldC9wL2hpa2VyL2QvZHIvZ2l0L3Jhdy9tYXN0ZXIvaHRtbC9nZXRWaWRlby5odG1sJykpXFxcXG4gICAgICAgIH1cXFxcbiAgICB9XFxcXG4gICAgeDVUaW1lb3V0ID0gcGFyc2VJbnQoeDVUaW1lb3V0KXx8NTAwMDtcXFxcbiAgICBsZXQgbWF4X2NvdW50PSh4NVRpbWVvdXQvMjUwKTsgLy/moLnmja7otoXml7boh6rliqjorqHnrpfkuoblj6/miafooYznmoTmrKHmlbBcXFxcbiAgICBwdXRWYXIoJ3g1TGlzdCcsSlNPTi5zdHJpbmdpZnkoeDVsaXN0KSk7XFxcXG4gICAgbGV0IF94NSA9ICQudG9TdHJpbmcoKGlzVmlkZW8sIG1heF9jb3VudCx4NVRpbWVvdXQsaXNCYWRWaWRlbykgPT4ge1xcXFxuICAgICAgICAvL+WIneWni+WMlmZiYeWSjHJlcXVzdFxcXFxuICAgICAgICBpZiAodHlwZW9mIChmYmEpID09ICd1bmRlZmluZWQnIHx8ICFmYmEpIHtcXFxcbiAgICAgICAgICAgIHZhciBmYmEgPSBmeV9icmlkZ2VfYXBwO1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICBpZiAodHlwZW9mIChyZXF1ZXN0KSA9PSAndW5kZWZpbmVkJyB8fCAhcmVxdWVzdCkge1xcXFxuICAgICAgICAgICAgICAgIGV2YWwoZmJhLmdldEludGVybmFsSnMoKSk7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgICAgIGZiYS5sb2coZS5tZXNzYWdlKTtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLVxcXFxuICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgaWYgKHdpbmRvdy5jb3VudCA9PSBudWxsKSB7XFxcXG4gICAgICAgICAgICAgICAgd2luZG93LmNvdW50ID0gMTtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIGxldCB0ZXh0PScnO1xcXFxuICAgICAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgICAgICB0ZXh0PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXFxcXFxcXCJib2R5XFxcXFxcXCIpLmlubmVyVGV4dDtcXFxcbiAgICAgICAgICAgIH1jYXRjaCAoZSkge2ZiYS5sb2coZS5tZXNzYWdlKX1cXFxcbiAgICAgICAgICAgIGlmKC/op6blj5HkuobpmLLnm5fpk7585pyq5o6I5p2DfOaOpeWPo+mYsuebly8udGVzdCh0ZXh0KSYmd2luZG93LmNvdW50PT0xKXtcXFxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcXFxcbiAgICAgICAgICAgICAgICBmYmEubG9nKFxcXFxcXFwi5qOA5rWL5Yiw5pyJ5o6I5p2D77yM5byA5aeL6L+H5o6I5p2DXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgd2luZG93LmNvdW50Kys7XFxcXG4gICAgICAgICAgICAvLyBmYmEubG9nKCdjb3VudDonICsgd2luZG93LmNvdW50ICsgJyxtYXhfY291bnQ6JyArIG1heF9jb3VudCk7XFxcXG4gICAgICAgICAgICBpZiAod2luZG93LmNvdW50ID49IG1heF9jb3VudCkge1xcXFxuICAgICAgICAgICAgICAgIGZiYS5jbGVhclZhcigneDVMaXN0Jyk7XFxcXG4gICAgICAgICAgICAgICAgZmJhLmhpZGVMb2FkaW5nKCk7XFxcXG4gICAgICAgICAgICAgICAgbGV0IGZtc2cgPSAn6YGT6ZW/5LuT5bqT6YCa5YWN6Kej5p6Q5aSx6LSlLOWOn+WboDrotoXml7YnK3g1VGltZW91dCsn5q+r56eSJztcXFxcbiAgICAgICAgICAgICAgICBmYmEubG9nKGZtc2cpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly8nK2Ztc2c7XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH1jYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgZmJhLmxvZyhlLm1lc3NhZ2UpO1xcXFxuICAgICAgICB9XFxcXG5cXFxcbiAgICAgICAgZnVuY3Rpb24gbXV0ZU1lKGVsZW0pIHtcXFxcbiAgICAgICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICAgICAgZWxlbS5wYXVzZSgpO1xcXFxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9XFxcXG5cXFxcbiAgICAgICAgdmFyIHZpZGVvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXFxcXFxcXCJ2aWRlb1xcXFxcXFwiKSwgYXVkaW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcXFxcXFxcImF1ZGlvXFxcXFxcXCIpLFxcXFxuICAgICAgICAgICAgdjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxcXFxcXFwiZW1iZWRcXFxcXFxcIiksIHYzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcXFxcXFxcIiNwbGF5ZXJcXFxcXFxcIik7XFxcXG4gICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICBbXS5mb3JFYWNoLmNhbGwodmlkZW9zLCBmdW5jdGlvbiAodmlkZW8pIHtcXFxcbiAgICAgICAgICAgICAgICBtdXRlTWUodmlkZW8pO1xcXFxuICAgICAgICAgICAgfSk7XFxcXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICB0cnkge1xcXFxuICAgICAgICAgICAgW10uZm9yRWFjaC5jYWxsKGF1ZGlvcywgZnVuY3Rpb24gKGF1ZGlvKSB7XFxcXG4gICAgICAgICAgICAgICAgbXV0ZU1lKGF1ZGlvKTtcXFxcbiAgICAgICAgICAgIH0pO1xcXFxuICAgICAgICB9IGNhdGNoIChlKSB7XFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbCh2MiwgZnVuY3Rpb24gKHYpIHtcXFxcbiAgICAgICAgICAgICAgICBtdXRlTWUodik7XFxcXG4gICAgICAgICAgICB9KTtcXFxcbiAgICAgICAgfSBjYXRjaCAoZSkge1xcXFxuICAgICAgICB9XFxcXG4gICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICBbXS5mb3JFYWNoLmNhbGwodjMsIGZ1bmN0aW9uICh2KSB7XFxcXG4gICAgICAgICAgICAgICAgbXV0ZU1lKHYpO1xcXFxuICAgICAgICAgICAgfSk7XFxcXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgfVxcXFxuICAgICAgICB2YXIgdXJscyA9IF9nZXRVcmxzKCk7XFxcXG4gICAgICAgIHRyeSB7XFxcXG4gICAgICAgICAgICBmb3IgKGxldCBpIGluIHVybHMpIHtcXFxcbiAgICAgICAgICAgICAgICBsZXQgdT11cmxzW2ldO1xcXFxuICAgICAgICAgICAgICAgIC8vdT1kZWNvZGVVUklDb21wb25lbnQodSk7XFxcXG4gICAgICAgICAgICAgICAgdHJ5e3U9ZGVjb2RlVVJJQ29tcG9uZW50KHUpO31jYXRjaChlKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgdT11bmVzY2FwZSh1KTtcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgaWYoL3VybD1odHRwLy50ZXN0KHUpKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgdSA9IHUuc3BsaXQoXFxcXFxcXCJ1cmw9XFxcXFxcXCIpLnNsaWNlKC0xKVswXTtcXFxcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZigvdmlkPWh0dHAvLnRlc3QodSkpe1xcXFxuICAgICAgICAgICAgICAgICAgICB1ID0gdS5zcGxpdChcXFxcXFxcInZpZD1cXFxcXFxcIikuc2xpY2UoLTEpWzBdO1xcXFxuICAgICAgICAgICAgICAgIH1lbHNlIGlmKC9cXFxcXFxcXD8oLiopPWh0dHAvLnRlc3QodSkpe1xcXFxuICAgICAgICAgICAgICAgICAgICB1ID0gXFxcXFxcXCJodHRwXFxcXFxcXCIrdS5zcGxpdCgvXFxcXFxcXFw/KC4qKT1odHRwLykuc2xpY2UoLTEpWzBdO1xcXFxuICAgICAgICAgICAgICAgICAgICAvL2ZiYS5sb2coXFxcXFxcXCLlhbbku5bliIblibI6XFxcXFxcXCIrdSk7XFxcXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYoL1xcXFxcXFxcLzFcXFxcXFxcXC5tM3U4JC8udGVzdCh1KSl7XFxcXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICB1PXUucmVwbGFjZSgvJmZyb209Lip8Jm5leHQ9Lip8Jmp1bXA9LiovLCcnKTtcXFxcbiAgICAgICAgICAgICAgICBsZXQgcmVhbFVybCA9IGlzVmlkZW8odSk7XFxcXG4gICAgICAgICAgICAgICAgaWYgKHJlYWxVcmwmJiFpc0JhZFZpZGVvKHUpKSB7Ly/ov4fmu6TlkIrmr5tcXFxcbiAgICAgICAgICAgICAgICAgICAgZmJhLmxvZyhcXFxcXFxcIuS7k+W6k3g15YWN5ZeF57uT5p6cOlxcXFxcXFwiICsgcmVhbFVybCk7XFxcXG4gICAgICAgICAgICAgICAgICAgIGZiYS5jbGVhclZhcigneDVMaXN0Jyk7XFxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWFsVXJsXFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9IGNhdGNoIChlKSB7XFxcXG4gICAgICAgICAgICBmYmEubG9nKGUubWVzc2FnZSlcXFxcbiAgICAgICAgfVxcXFxuICAgIH0sIGlzVmlkZW8sIG1heF9jb3VudCx4NVRpbWVvdXQsaXNCYWRWaWRlbyk7XFxcXG4gICAgY29uc3QgbHNnPSQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS9sb2NhbFN0b3JhZ2U/cnVsZT3pgZPplb/ku5PlupNQcm9cXFxcXFxcIik7XFxcXG4gICAgbGV0IHVzZVdlYj1sc2cuZ2V0SXRlbShcXFxcXFxcIumAmuWFjVxcXFxcXFwiLFxcXFxcXFwiWDVcXFxcXFxcIik9PT1cXFxcXFxcIldFQlxcXFxcXFwiO1xcXFxuICAgIC8vbG9nKFxcXFxcXFwi5LuT5bqT5L2/55Sod2Vi6YCa5YWN5pu/5LujeDU6XFxcXFxcXCIrdXNlV2ViKTtcXFxcbiAgICBsZXQgcnVsZUhlYWQ9dXNlV2ViJiZwYXJzZUludChnZXRBcHBWZXJzaW9uKCkpPj0yMzM5P1xcXFxcXFwid2ViUnVsZTovL1xcXFxcXFwiOlxcXFxcXFwieDVSdWxlOi8vXFxcXFxcXCI7XFxcXG4gICAgcmV0dXJuIHJ1bGVIZWFkK2JwYXRoKydAJyArIF94NTtcXFxcbn1cXFxcblxcXFxuZnVuY3Rpb24gTGF6eVBhcnNlRmFzdChwbGF5VXJsTGlzdCxnZXRUaW1lb3V0LHg1VGltZW91dCl7XFxcXG4gICAgY29uc3Qge2lzVmlkZW8sZ2V0SGVhZGVycyx4NVBhcnNlUHJvfSA9ICQucmVxdWlyZSgnaGlrZXI6Ly9wYWdlL2dsb2JhbFBhcnNlP3J1bGU96YGT6ZW/5LuT5bqTUHJvJyk7XFxcXG4gICAgLy8gbG9nKCflvIDlp4vmiafooYwnK3BsYXlVcmxMaXN0Lmxlbmd0aCsn5Liq5Zyw5Z2A55qE5om56YeP5ZeF5o6iOicrcGxheVVybExpc3QpO1xcXFxuICAgIGxvZygn5byA5aeL5omn6KGMJytwbGF5VXJsTGlzdC5sZW5ndGgrJ+S4quWcsOWdgOeahOaJuemHj+WXheaOoicpO1xcXFxuICAgIGxldCBwbGF5VXJscyA9IHBsYXlVcmxMaXN0Lm1hcCgoaXQpPT57XFxcXG4gICAgICAgIHJldHVybiB7XFxcXG4gICAgICAgICAgICB1cmw6aXQuc3BsaXQoXFxcXFxcXCI7XFxcXFxcXCIpWzBdLFxcXFxuICAgICAgICAgICAgb3B0aW9uczoge1xcXFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgLy9cXFxcXFxcIlVzZXItQWdlbnRcXFxcXFxcIjogXFxcXFxcXCJEYXJ0LzIuMTMgKGRhcnQ6aW8pXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwiVXNlci1BZ2VudFxcXFxcXFwiOlxcXFxcXFwiTW96aWxsYS81LjBcXFxcXFxcIlxcXFxuICAgICAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICAgICAgdGltZW91dDogZ2V0VGltZW91dFxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9XFxcXG4gICAgfSk7XFxcXG4gICAgbGV0IGJodG1sID0gYmF0Y2hGZXRjaChwbGF5VXJscyk7XFxcXG4gICAgbGV0IHZpZGVvcyA9IFtdO1xcXFxuICAgIGxldCB4NWxpc3QgPSBbXTtcXFxcbiAgICBmb3IobGV0IGkgaW4gYmh0bWwpe1xcXFxuICAgICAgICBsZXQgb3JkZXIgPSBwYXJzZUludChpKSsxO1xcXFxuICAgICAgICBsZXQgdG5hbWU9b3JkZXIrJ+WPt+ino+aekOe9keWdgDonO1xcXFxuICAgICAgICAvL2xvZyh0bmFtZSk7XFxcXG4gICAgICAgIGxldCB0dXJsPXBsYXlVcmxMaXN0W2ldLnNwbGl0KFxcXFxcXFwiO1xcXFxcXFwiKVswXTtcXFxcbiAgICAgICAgbGV0IGpuYW1lPXBsYXlVcmxMaXN0W2ldLnNwbGl0KFxcXFxcXFwiO1xcXFxcXFwiKS5sZW5ndGg+MT9wbGF5VXJsTGlzdFtpXS5zcGxpdChcXFxcXFxcIjtcXFxcXFxcIilbMV06XFxcXFxcXCJcXFxcXFxcIjtcXFxcbiAgICAgICAgdG5hbWUrPWpuYW1lO1xcXFxuICAgICAgICBsZXQgYmFja2NvZGUgPSBiaHRtbFtpXTtcXFxcbiAgICAgICAgaWYoKCEvdXJsfGh0dHAvLnRlc3QoYmFja2NvZGUpKSYmKCEvI0VYVElORi8udGVzdChiYWNrY29kZSkpKXtcXFxcbiAgICAgICAgICAgIGxvZyh0bmFtZSt0dXJsKyfmnInpl67popgs5Y+v6IO95Yqg5a+G5oiW6ICF5oyC5LqGJyk7XFxcXG4gICAgICAgICAgICBjb250aW51ZTtcXFxcbiAgICAgICAgfWVsc2UgaWYoLyNFWFRJTkYvLnRlc3QoYmFja2NvZGUpKXtcXFxcbiAgICAgICAgICAgIC8vbGV0IGxjYWNoZT1cXFxcXFxcIi9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL2NvbS5leGFtcGxlLmhpa2Vydmlldy9maWxlcy9Eb2N1bWVudHMvY2FjaGUvdmlkZW9fXFxcXFxcXCIrdG5hbWUrXFxcXFxcXCIubTN1OFxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgLy93cml0ZUZpbGUobGNhY2hlLGJhY2tjb2RlKTtcXFxcbiAgICAgICAgICAgIC8vdmlkZW9zLnB1c2gobGNhY2hlKTtcXFxcbiAgICAgICAgICAgIGxldCBwVXJsPWNhY2hlTTN1OCh0dXJsKTtcXFxcbiAgICAgICAgICAgIHZpZGVvcy5wdXNoKHBVcmwpO1xcXFxuICAgICAgICAgICAgY29udGludWU7XFxcXG4gICAgICAgIH1cXFxcbiAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgIGxldCB1cmwgPSBKU09OLnBhcnNlKGJhY2tjb2RlKS51cmw7XFxcXG4gICAgICAgICAgICBpZigvXmh0dHAvLnRlc3QodXJsKSl7XFxcXG4gICAgICAgICAgICAgICAgbGV0IHJlYWxWaWRlbyA9IGlzVmlkZW8odXJsKTtcXFxcbiAgICAgICAgICAgICAgICBpZih0eXBlb2YocmVhbFZpZGVvKT09J3N0cmluZycpe1xcXFxuICAgICAgICAgICAgICAgICAgICBsb2codG5hbWUrJ+W3suino+aekOWHuuinhumikTonK3JlYWxWaWRlbyk7XFxcXG4gICAgICAgICAgICAgICAgICAgIGlmKGpuYW1lKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWxWaWRlbys9XFxcXFxcXCLimIVcXFxcXFxcIitqbmFtZVxcXFxuICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgIHZpZGVvcy5wdXNoKHJlYWxWaWRlbyk7XFxcXG4gICAgICAgICAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICAgICAgICAgIGxvZyh0bmFtZSsn6Kej5p6Q5Ye65LiN55+l6YGT5LuA5LmI5Lic6KW/OicrdXJsKTtcXFxcbiAgICAgICAgICAgICAgICAgICAgdXJsKz1cXFxcXFxcIiNpc1ZpZGVvPXRydWUjXFxcXFxcXCI7XFxcXG4gICAgICAgICAgICAgICAgICAgIGlmKGpuYW1lKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCs9XFxcXFxcXCLimIVcXFxcXFxcIitqbmFtZVxcXFxuICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgICAgIHZpZGVvcy5wdXNoKHVybCk7XFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICAgICAgbG9nKHRuYW1lKyfkuLpqc29u5o6l5Y+j5LiU5peg6L+U5Zue6KeG6aKR5Zyw5Z2A5pWw5o2uOicrcGxheVVybExpc3RbaV0rJ1xcXFxcXFxcbicrYmFja2NvZGUpO1xcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICB9Y2F0Y2ggKGUpIHtcXFxcbiAgICAgICAgICAgIGxvZyh0bmFtZSsn5Li6eDXmjqXlj6Ms5Yqg5YWleDXll4XmjqLliJfooagnKTtcXFxcbiAgICAgICAgICAgIHg1bGlzdC5wdXNoKHBsYXlVcmxMaXN0W2ldKTtcXFxcbiAgICAgICAgfVxcXFxuICAgIH1cXFxcbiAgICAvLyBsb2codmlkZW9zKTtcXFxcbiAgICBpZih2aWRlb3MubGVuZ3RoPjApe1xcXFxuICAgICAgICBpZihnZXRWYXIoJ2RwLmNhY2hlVmlkZW8nLCd0cnVlJyk9PT0ndHJ1ZScmJnBhcnNlSW50KGdldEFwcFZlcnNpb24oKSk+PTIyNTUpXFxcXG4gICAgICAgIHtcXFxcbiAgICAgICAgICAgIGxvZyhcXFxcXFxcIuWwiuaVrOeahOmtlOaWreeUqOaIt++8jOinhumikee8k+WtmOW3suWQr+eUqO+8jOivt+WwveaDheS6q+WPl+eci+WJp+aXtuWFiVxcXFxcXFwiKTtcXFxcbiAgICAgICAgICAgIGxldCB2aWRlb3NDYWNoZT12aWRlb3MubWFwKChpdCk9PntcXFxcbiAgICAgICAgICAgICAgICBsZXQgaGVhZGVycz17fTtcXFxcbiAgICAgICAgICAgICAgICBpZihpdC5zcGxpdChcXFxcXFxcIjtcXFxcXFxcIikubGVuZ3RoPjEpe1xcXFxuICAgICAgICAgICAgICAgICAgICBsZXQgaGVhZCA9IGl0LnNwbGl0KCc7JylbMV07XFxcXG4gICAgICAgICAgICAgICAgICAgIGlmKC9ALy50ZXN0KGhlYWQpJiYve3x9Ly50ZXN0KGhlYWQpKXtcXFxcbi8vaGVhZCA9IGhlYWQucmVwbGFjZSgve3x9L2csJycpO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZCA9IGhlYWQuc3BsaXQoXFxcXFxcXCJ7XFxcXFxcXCIpWzFdLnNwbGl0KFxcXFxcXFwifVxcXFxcXFwiKVswXTtcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWQgPSBoZWFkLnNwbGl0KCcmJicpO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpIGluIGhlYWQpe1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBrZXkgPSBoZWFkW2ldLnNwbGl0KCdAJylbMF07XFxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID1oZWFkW2ldLnNwbGl0KCdAJylbMV0ucmVwbGFjZSgvOy8sJ++8m++8mycpO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNba2V5XSA9IHZhbHVlO1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICAgICAgfVxcXFxuICAgICAgICAgICAgICAgIHJldHVybiB7XFxcXG4gICAgICAgICAgICAgICAgICAgIHVybDppdC5zcGxpdChcXFxcXFxcIjtcXFxcXFxcIilbMF0uc3BsaXQoXFxcXFxcXCLimIVcXFxcXFxcIilbMF0sXFxcXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6e1xcXFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczpoZWFkZXJzXFxcXG4gICAgICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICB9KTtcXFxcbiAgICAgICAgICAgIHZhciBkYXRhPWJhdGNoQ2FjaGVNM3U4KHZpZGVvc0NhY2hlKTtcXFxcbiAgICAgICAgICAgIGRhdGE9ZGF0YS5tYXAoKGl0LGlkKT0+e1xcXFxuICAgICAgICAgICAgICAgIGxldCBleHRyYT1cXFxcXFxcIlxcXFxcXFwiO1xcXFxuICAgICAgICAgICAgICAgIGlmKHZpZGVvc1tpZF0uc3BsaXQoXFxcXFxcXCI7XFxcXFxcXCIpLmxlbmd0aD4xKXtcXFxcbiAgICAgICAgICAgICAgICAgICAgZXh0cmE9XFxcXFxcXCI7XFxcXFxcXCIrdmlkZW9zW2lkXS5zcGxpdChcXFxcXFxcIjtcXFxcXFxcIilbMV07XFxcXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYodmlkZW9zW2lkXS5zcGxpdChcXFxcXFxcIuKYhVxcXFxcXFwiKS5sZW5ndGg+MSl7XFxcXG4gICAgICAgICAgICAgICAgICAgIGV4dHJhPVxcXFxcXFwi4piFXFxcXFxcXCIrdmlkZW9zW2lkXS5zcGxpdChcXFxcXFxcIuKYhVxcXFxcXFwiKVsxXTtcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG5cXFxcbiAgICAgICAgICAgICAgICBpZihpdCtcXFxcXFxcIlxcXFxcXFwiIT1cXFxcXFxcIm51bGxcXFxcXFxcIil7XFxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdCtleHRyYVxcXFxuICAgICAgICAgICAgICAgIH1lbHNle1xcXFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmlkZW9zW2lkXVxcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH0pO1xcXFxuICAgICAgICAgICAgLy9sb2coZGF0YSk7XFxcXG4gICAgICAgICAgICByZXR1cm4gZGF0YVxcXFxuICAgICAgICAgICAgLy9yZXR1cm4gdmlkZW9zXFxcXG4gICAgICAgIH1lbHNle1xcXFxuICAgICAgICAgICAgcmV0dXJuIHZpZGVvc1xcXFxuICAgICAgICB9XFxcXG4gICAgfVxcXFxuICAgIGxvZygn5YWx5pyJJyt4NWxpc3QubGVuZ3RoKyfkuKp4NeWcsOWdgOi/m+ihjOi9rua1geWXheaOoicpO1xcXFxuICAgIC8v5rKh5pyJ55qE6K+d5bCx5byA5aeL5L6d5qyheDXll4XmjqJcXFxcbiAgICBzaG93TG9hZGluZygn5ZeF5o6i5Lit77yM6Iul5aSx6LSl5bCx5YiH5o2id2Vi5ZeF5o6iLi4uJyk7XFxcXG4gICAgcmV0dXJuIHg1UGFyc2VQcm8oeDVsaXN0LHg1VGltZW91dCxpc1ZpZGVvKTtcXFxcbn1cXFxcbnZhciBsYXp5PSQoJycpLmxhenlSdWxlKCgpPT57XFxcXG4gICAgdHJ5e1xcXFxuICAgICAgICByZWFsVXJsPWlucHV0O1xcXFxuICAgICAgICBldmFsKFxcXFxcXFwidmFyIGNvbmZpZ19kcCA9XFxcXFxcXCIgKyBmZXRjaChcXFxcXFxcImhpa2VyOi8vZmlsZXMvY2FjaGUvTXlQYXJzZVNldC5qc29uXFxcXFxcXCIpKTtcXFxcbiAgICAgICAgZXZhbChmZXRjaChjb25maWdfZHAuY2opKTtcXFxcbiAgICAgICAgbG9nKGlucHV0KyctPuato+WcqOaWreaPkumtlOaUueeJiOino+aekC4uLicpO1xcXFxuICAgICAgICAvLyDliqDlhaXotoXml7borr7nva7vvIzlu7rorq7lnKjpppbpobXorr7nva5cXFxcbiAgICAgICAgcmV0dXJuIGF5dG1QYXJzZShyZWFsVXJsKVxcXFxuICAgIH1jYXRjaChlKXtcXFxcbiAgICAgICAgcmV0dXJuIGlucHV0XFxcXG4gICAgfVxcXFxufSk7XFxcXG4kLmV4cG9ydHMuaXNQaWM9aXNQaWM7XFxcXG4kLmV4cG9ydHMuaXNWaWRlbz1pc1ZpZGVvO1xcXFxuJC5leHBvcnRzLmlzQmFkVmlkZW89aXNCYWRWaWRlbztcXFxcbiQuZXhwb3J0cy5jb21QYXJzZT1jb21QYXJzZTtcXFxcbiQuZXhwb3J0cy5nZXRIZWFkZXJzPWdldEhlYWRlcnM7XFxcXG4kLmV4cG9ydHMubGF6eVBhcnNlPWxhenlQYXJzZTtcXFxcbiQuZXhwb3J0cy54NVBhcnNlUHJvPXg1UGFyc2VQcm87XFxcXG4kLmV4cG9ydHMuTGF6eVBhcnNlRmFzdD1MYXp5UGFyc2VGYXN0O1xcXFxuJC5leHBvcnRzLmxhenk9bGF6eTtcXFwifSx7XFxcIm5hbWVcXFwiOlxcXCLku7vliqHku5PlupPmjqXlj6NcXFwiLFxcXCJwYXRoXFxcIjpcXFwidGFza0NhbGxcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG5TdHJpbmcucHJvdG90eXBlLnN0cmlwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5yZXBsYWNlKC8oXlxcXFxcXFxccyopfChcXFxcXFxcXHMqJCkvZywgXFxcXFxcXCJcXFxcXFxcIik7IH07XFxcXG5mdW5jdGlvbiB0YXNrX3JlcSh0YXNrX2FwaSx0YXNrKSB7IC8vIOmAmueUqOWPkemAgeS7k+W6k3Bvc3TosIPnlKjku7vliqHor7fmsYJcXFxcbiAgICBjb25zdCB7Z2V0RmlsZX0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5P3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcXFxcXCIpO1xcXFxuICAgIGxldCBob3VzZUZpbGUgPSBnZXRGaWxlfHxmYWxzZTtcXFxcbiAgICBpZighaG91c2VGaWxlKXtcXFxcbiAgICAgICAgc2V0SXRlbSgnaXNfaG91c2VfdmlwJywgJ2ZhbHNlJyk7XFxcXG4gICAgfVxcXFxuICAgIGxldCBob3VzZV9kYXRhID0gaG91c2VGaWxlKCk7XFxcXG4gICAgbGV0IHJlc3VsdCA9IHJlcXVlc3QodGFza19hcGksIHtcXFxcbiAgICAgICAgaGVhZGVyczoge1xcXFxuICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xcXFxuICAgICAgICB9LFxcXFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XFxcXG4gICAgICAgICAgICBcXFxcXFxcInBhcmFtc1xcXFxcXFwiOiB7XFxcXG4gICAgICAgICAgICAgICAgXFxcXFxcXCJkYXRhXFxcXFxcXCI6IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJ0eXBlXFxcXFxcXCI6IHRhc2subW9kZXx8J3J1bicsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwiZnVuY1xcXFxcXFwiOiB0YXNrLmZ1bmN8fCcnLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhcmFtc1xcXFxcXFwiOiB0YXNrLnBhcmFtc3x8W11cXFxcbiAgICAgICAgICAgICAgICB9LFxcXFxuICAgICAgICAgICAgICAgIFxcXFxcXFwiYXV0aFxcXFxcXFwiOiB7XFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwibmFtZVxcXFxcXFwiOiBob3VzZV9kYXRhLnVzZXJuYW1lfHxcXFxcXFxcIlxcXFxcXFwiLFxcXFxuICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhc3N3b3JkXFxcXFxcXCI6IGhvdXNlX2RhdGEucGFzc3dvcmR8fFxcXFxcXFwiXFxcXFxcXCJcXFxcbiAgICAgICAgICAgICAgICB9XFxcXG4gICAgICAgICAgICB9XFxcXG4gICAgICAgIH0pLFxcXFxuICAgICAgICBtZXRob2Q6ICdQT1NUJ1xcXFxuICAgIH0pO1xcXFxuICAgIHJldHVybiBKU09OLnBhcnNlKHJlc3VsdCkucmVzdWx0O1xcXFxufVxcXFxuXFxcXG5mdW5jdGlvbiB0YXNrX3VwbG9hZCh0YXNrKXsgLy8g6YCa55So5Lu75Yqh5Y+R5biD5paw5aKe5Y+K5L+u5pS55Yqf6IO9XFxcXG4gICAgY29uc3Qge2FwaSxnZXRGaWxlfSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXk/cnVsZT3pgZPplb/ku5PlupNQcm9cXFxcXFxcIik7XFxcXG4gICAgbGV0IGhvdXNlRmlsZSA9IGdldEZpbGV8fGZhbHNlO1xcXFxuICAgIGlmKCFob3VzZUZpbGUpe1xcXFxuICAgICAgICBzZXRJdGVtKCdpc19ob3VzZV92aXAnLCAnZmFsc2UnKTtcXFxcbiAgICB9XFxcXG4gICAgbGV0IGFwaV91cmwgPSBhcGkuaG9zdCsnL2hpa2VydWxlL3Rhc2svYWRkJztcXFxcbiAgICBsZXQgaG91c2VfZGF0YSA9IGhvdXNlRmlsZSgpO1xcXFxuICAgIGxldCByZXN1bHQgPSByZXF1ZXN0KGFwaV91cmwsIHtcXFxcbiAgICAgICAgaGVhZGVyczoge1xcXFxuICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xcXFxuICAgICAgICB9LFxcXFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XFxcXG4gICAgICAgICAgICBcXFxcXFxcInBhcmFtc1xcXFxcXFwiOiB7XFxcXG4gICAgICAgICAgICAgICAgXFxcXFxcXCJkYXRhXFxcXFxcXCI6IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJuYW1lXFxcXFxcXCI6IHRhc2submFtZSxcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJweWNvZGVcXFxcXFxcIjogdGFzay5weWNvZGUsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwibm90ZVxcXFxcXFwiOiB0YXNrLm5vdGUsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwidGVzdF9jb2RlXFxcXFxcXCI6IHRhc2sudGVzdF9jb2RlLFxcXFxuICAgICAgICAgICAgICAgIH0sXFxcXG4gICAgICAgICAgICAgICAgXFxcXFxcXCJhdXRoXFxcXFxcXCI6IHtcXFxcbiAgICAgICAgICAgICAgICAgICAgXFxcXFxcXCJuYW1lXFxcXFxcXCI6IGhvdXNlX2RhdGEudXNlcm5hbWV8fFxcXFxcXFwiXFxcXFxcXCIsXFxcXG4gICAgICAgICAgICAgICAgICAgIFxcXFxcXFwicGFzc3dvcmRcXFxcXFxcIjogaG91c2VfZGF0YS5wYXNzd29yZHx8XFxcXFxcXCJcXFxcXFxcIlxcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfSksXFxcXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnXFxcXG4gICAgfSk7XFxcXG4gICAgcmV0dXJuIEpTT04ucGFyc2UocmVzdWx0KS5yZXN1bHQ7XFxcXG59XFxcXG5cXFxcbmZ1bmN0aW9uIHRhc2tfY2FsbChpZCxmdW5jLHBhcmFtcyl7XFxcXG4gICAgY29uc3Qge2FwaX0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5P3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcXFxcXCIpO1xcXFxuICAgIGxldCB0YXNrX2FwaSA9IGFwaS5ob3N0KycvaGlrZXJ1bGUvdGFzay9ydW4vJytpZDtcXFxcbiAgICBsZXQgdGFzayA9IHtcXFxcbiAgICAgICAgbW9kZTonY2FsbCcsXFxcXG4gICAgICAgIGZ1bmM6ZnVuYyxcXFxcbiAgICAgICAgcGFyYW1zOnBhcmFtc3x8W11cXFxcbiAgICB9O1xcXFxuICAgIHJldHVybiB0YXNrX3JlcSh0YXNrX2FwaSx0YXNrKTtcXFxcbn1cXFxcblxcXFxuZnVuY3Rpb24gdGFza19yZW5hbWUoaWQsbmV3X3Rhc2tfbmFtZSl7XFxcXG4gICAgY29uc3Qge2FwaSxnZXRGaWxlfSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXk/cnVsZT3pgZPplb/ku5PlupNQcm9cXFxcXFxcIik7XFxcXG4gICAgbGV0IGhvdXNlRmlsZSA9IGdldEZpbGV8fGZhbHNlO1xcXFxuICAgIGlmKCFob3VzZUZpbGUpe1xcXFxuICAgICAgICBzZXRJdGVtKCdpc19ob3VzZV92aXAnLCAnZmFsc2UnKTtcXFxcbiAgICB9XFxcXG4gICAgbGV0IGhvdXNlX2RhdGEgPSBob3VzZUZpbGUoKTtcXFxcbiAgICBsZXQgdGFza19hcGkgPSBhcGkuaG9zdCsnL2hpa2VydWxlL3Rhc2svcmVuYW1lLycraWQ7XFxcXG4gICAgdGFza19hcGkgPSB0YXNrX2FwaSsnP25hbWU9Jytob3VzZV9kYXRhLnVzZXJuYW1lKycmcGFzc3dvcmQ9Jytob3VzZV9kYXRhLnBhc3N3b3JkKycmdGFza19uYW1lPScrbmV3X3Rhc2tfbmFtZTtcXFxcbiAgICB0cnkge1xcXFxuICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZShmZXRjaCh0YXNrX2FwaSx7fSkpO1xcXFxuICAgICAgICBpZihyZXN1bHQuc3RhdHVzPT0wKXtcXFxcbiAgICAgICAgICAgIHJldHVybiAgcmVzdWx0LmRldGFpbFxcXFxuICAgICAgICB9ZWxzZXtcXFxcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQucmVzdWx0KycnK3Jlc3VsdC5kZXRhaWxcXFxcbiAgICAgICAgfVxcXFxuICAgIH1jYXRjaCAoZSkge1xcXFxuICAgICAgICBsb2coZS5tZXNzYWdlKTtcXFxcbiAgICAgICAgcmV0dXJuICcnK2UubWVzc2FnZVxcXFxuICAgIH1cXFxcbn1cXFxcblxcXFxuZnVuY3Rpb24gdGFza19jaGFuZ2Vfc3RhdGUoaWQpe1xcXFxuICAgIGNvbnN0IHthcGksZ2V0RmlsZX0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5P3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcXFxcXCIpO1xcXFxuICAgIGxldCBob3VzZUZpbGUgPSBnZXRGaWxlfHxmYWxzZTtcXFxcbiAgICBpZighaG91c2VGaWxlKXtcXFxcbiAgICAgICAgc2V0SXRlbSgnaXNfaG91c2VfdmlwJywgJ2ZhbHNlJyk7XFxcXG4gICAgfVxcXFxuICAgIGxldCBob3VzZV9kYXRhID0gaG91c2VGaWxlKCk7XFxcXG4gICAgbGV0IHRhc2tfYXBpID0gYXBpLmhvc3QrJy9oaWtlcnVsZS90YXNrL2NoYW5nZV9zdGF0ZS8nK2lkO1xcXFxuICAgIHRhc2tfYXBpID0gdGFza19hcGkrJz9uYW1lPScraG91c2VfZGF0YS51c2VybmFtZSsnJnBhc3N3b3JkPScraG91c2VfZGF0YS5wYXNzd29yZDtcXFxcbiAgICB0cnkge1xcXFxuICAgICAgICBsZXQgcmVzdWx0ID0gSlNPTi5wYXJzZShmZXRjaCh0YXNrX2FwaSx7fSkpO1xcXFxuICAgICAgICBpZihyZXN1bHQuc3RhdHVzPT0wKXtcXFxcbiAgICAgICAgICAgIHJldHVybiAgcmVzdWx0LmRldGFpbFxcXFxuICAgICAgICB9ZWxzZXtcXFxcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQucmVzdWx0KycnK3Jlc3VsdC5kZXRhaWxcXFxcbiAgICAgICAgfVxcXFxuICAgIH1jYXRjaCAoZSkge1xcXFxuICAgICAgICBsb2coZS5tZXNzYWdlKTtcXFxcbiAgICAgICAgcmV0dXJuICcnK2UubWVzc2FnZVxcXFxuICAgIH1cXFxcbn1cXFxcblxcXFxuZnVuY3Rpb24gdGFza19ydW4oaWQpe1xcXFxuICAgIGNvbnN0IHthcGl9ID0gJC5yZXF1aXJlKFxcXFxcXFwiaGlrZXI6Ly9wYWdlL3V0aWxpeT9ydWxlPemBk+mVv+S7k+W6k1Byb1xcXFxcXFwiKTtcXFxcbiAgICBsZXQgdGFza19hcGkgPSBhcGkuaG9zdCsnL2hpa2VydWxlL3Rhc2svcnVuLycraWQ7XFxcXG4gICAgbGV0IHRhc2sgPSB7fTtcXFxcbiAgICByZXR1cm4gdGFza19yZXEodGFza19hcGksdGFzayk7XFxcXG59XFxcXG5cXFxcbiQuZXhwb3J0cy50YXNrQ2FsbCA9IHRhc2tfY2FsbDtcXFxcbiQuZXhwb3J0cy50YXNrUnVuID0gdGFza19ydW47XFxcXG4kLmV4cG9ydHMudGFza1JlcSA9IHRhc2tfcmVxO1xcXFxuJC5leHBvcnRzLnRhc2tVcGxvYWQgPSB0YXNrX3VwbG9hZDtcXFxcbiQuZXhwb3J0cy50YXNrUmVuYW1lID0gdGFza19yZW5hbWU7XFxcXG4kLmV4cG9ydHMudGFza0NoYW5nZVN0YXRlID0gdGFza19jaGFuZ2Vfc3RhdGU7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi5YWo5bGA5YKo5a2YXFxcIixcXFwicGF0aFxcXCI6XFxcImxvY2FsU3RvcmFnZVxcXCIsXFxcInJ1bGVcXFwiOlxcXCJsZXQgbG9jYWxTdG9yYWdlID0gKGZ1bmN0aW9uKCkge1xcXFxuICAgIGV2YWxQcml2YXRlSlMoXFxcXFxcXCJqd1VLd05UaVBHY1dTTENYQjVYdEFYd2I2TFFiVnlIRCswWEo3bDA3Y2UwPVxcXFxcXFwiKTtcXFxcbiAgICAvL3BhdGh0bz11bmRlZmluZWQ7XFxcXG4gICAgZXZhbFByaXZhdGVKUyhcXFxcXFxcIjRDMFl4UlluR0NZa2dGUlh0cGwvQ3o1ekw1aGg0akNDenRiK25nK1dva3ltUThvVXJ6UzlsQTh5eEM1YUZhZG5TRW15SEtNYnJhZmxScVhDbk5SSERsazZ1ZTh5SFRPMTZsQlBycHdnczVqZjBQaHJBdG9USklFMFpIbjltS2FRNEpkMmVycWI0STU1YmVXSWV1Z0tzRHMyMTFTeklOUTV5SmdTaDFkVnVOenp4UkdKZzQwRm1UdVZtWFZmTjF4ZzJXSUdIQkVta1ZuR3htT1JoUE9OQStRNVZ3UG1kcDQxL2h6ZTNlSXNVdmhvN1ZDQmdLNHJhSm1QYWxJUkJCVmxDVmduOEZrV21mS3FabytWVytvQmNIN2hyY3JzU2xDU2pCYW5nVC83c3lXSHhLWWhlaFUwa2FNWWpuV0ZnMUVtMGNtTlJ0b21Dc0h6MUI4cTMyT2VRSG9hd2RXeHpLT2FNSE9YREJqUm9qQThFL2FoMFdST3l6aXFSU3hsL204ZGhCZDBmOXBoWXovNVNVL3pKRDUyWC85RUMxNldWVmRwU1czM2FrUkhSc2xQcFJsVFdGOStBeVJtUncwZVpPRXMxbzlRTVBBUVVmQXhiWXlGSGd6dHcvTzJkSlJwSHlUbWlCaWFhcVRjaXZ4NnY5enl2QnowNHdJMUFhU0N1aStkVHVVM2x1NXhkRXQzQWp0NlozaURYT1ZjRVAwRURGNzQ3NFBRVTZKRVp1d2U5N1NjaDRiaTF3QjFYSFpTZkl0ZGxZWW9HZWQzTExwYm1EQUlSY2l2MHJBb3A4Vm1RY1R0MkszTGZoMVJEWVkwWXR2UmNINDlPdnBEUkgveGE1RmM4TVkzRHJGb0E3cWNvRjRlQ2dpVkJmQmdKUjY4K0xwUUs3dE9rZzhrOWVjKzNOU3hKVGhjbDhkNnlOd3hUOVRrMTd6ZUpnZDZNb3lZWklwV1FMbEY2WXZiT2RFV2hqbW5BNzh3QzBoV3orWG02aFFNU3F0RncrYmhGZjdjQkdVM2FhdFBGbWRDWTJFZFhmaDBJWVc4NXdkT3lNZml3VzcvdlZUcDlpRTAwSTNGMDl3R0hrR0toVmJMdWVBa1llN3p6SlhSN3RoYUZvcjZIN3FMbUpqYlJRazlldk50QlFYTlI3RGlmaVh1UWYybHQ3bk9IODBTV20xZkRISHpqbVBzTklwczJUWEdUK2l3VlY2OWcvdFdpcFZRNkQ4QlR4K2NDUXA0N25tVElyWStxTjRraDJGWWg1TGx3WGRnSXl5MVZJdUMzeDA1M2V3QUlJVW1sWTluaUVwcVl0KzFmRlBYT0N0Q0d0WWJTZDM3dlZSMUVPajJrNUd1Lys5SldnMnF2d2wxdHdlbGcxSjB0eGFySWk0a1RiVHJ2cm5GTE45MnBvZnBaUVVmb1dvNGNlN0hXTmRidTRKS0VyYUxRVWZkZkdFUGQxVEl1ZnV1UlZhMzllcTlHWnlTRHVCTDYwTVBkbGR4S3cxem8rZkI1WlkrWU1qM0xMMmdHdERiczk4K0FzUlY5TEpXbVVtc3g5MWhtSnRGVU1XRDN4bmo4SE1aV3MwTlBsQ0ZVcjk0ODVLcVRwbzVrUnpHZkYray9ObDJKenJ2NWN2a3F0VW5MZ0twWEVPai9zZS9vRHpPQXJRS0k1VE5VYnZZd2N3Y2Rqak1TZmpLNjhLcndocytuNlNtV1o0WmRnUkhnQUs1TW9GaTNYbUxWNDdQM3ZTUld1NXp5RXNNazR5M3V1Q0ZpdVJQUmx1NFE1cEp2dU9lbTdIN1VMaUloQ2VtdjVEZ2tHdERMMWNHTDRFUWhZUkI2SVN6VnZzYjJFYVA5d1FFNkRWUm5NN08rcG5TemV0Nmx6cDNwRmRHbmJveDFMUmZDNjB1dFhaK0NqSW00aUVNbXRiQjJONXpEU2hHYmVNM1hVYkpRZENCaXM4WElyaGgyYmlCNWhCQ1Z3bjNZM2V0dDdHRFBWdG9pMUdSanorSmJnTStZUjkyOEtiZFdTNXRGYU1NM0tqM1h2Nm90SXh6TUJuREM5dVczZCtJWHg2dkxQSjBKUnVoM3lQN3BUbGE2YzNpUjRwOW5XWURxSitaU21wckhGbkRPenNMV21GamFwamUvTXF3TUpkNlRrM25BV3dpY01PUHVZcE15cUlGMDRmbDRtcWd0c0hMU01XUlJOSFBaakVUUTlnUm1lRFllNmFSdGxXMDJxTDJvbERFTnFMUU10QWRvaXJOV1JjUDlWTDNUZDhIYVVPNmZTbEdOYWJNYWtKRC8wMFhDaE9TVU9JUCs3Zk03VjAvbDFiTFdQdEV6MWk3THlnVFY3cGRHb0RudHFTQ0VuSnJCeWhCQXpMUmc1UUljOTQzOEloS215Zm4wLzNhd29EMUlyNzgwZXlwL1hjSTZ4TmN3NlR2L0VUZkhnMGU3aVlDMFVZY0pJRTVRVVh2MHMrWW9HSUVxNUdJekt1YjhITmpTVFVwc3Zua1Z4K2RiZTJqUm4zWWI5VzdKQ1o1WVM2RjVNeVVWc3BqTUQ3TlljK0RXalVMMmIyc1Z5QWZlWXBDOFVoYWg5dHVtYXZiQnY3YTNhOWtnRmJxNThsckh4elk3aUpRVmlnenEzZTFhMkJTYjBQY1cxYUo4QkQ3TmtOcGhLWWF5VHh5a2d3aWxFUkw4anFxQkVuaUhWZEJ4REpZTGIrWHczYWxMbWx0dVRFVjZLR3RCbnRCWCt5ejM2UlBETXlHSUtlKzNmemN4Zm5DRG4yME1vZFZWa1ZOb3pQcU1YWjBHNUw0YUxUQVFha1lLVWpzVk1RakFoUWtUbEhCZU8vYUxQeDlzeGwrK2oxWjVyTGdHMTJUTjRYSjFlaWN2dzRBVkU1OExvcmFxMFFpRTBjUzdQSDFwYnJaV3JmdDdMWUdpeUJTaG9yNyswamlvVWgxcGRXcTJxTVlMcWVNRWV1Q1JPUXQ1N21Gck9qeVBINDlxcDk3Y1dPcmdlZzJXeWZXU0RHUVBqZTUrUDB5UW9DcEQvRDNSQU11V21iOXdsQnRjcTJqOFdKUHQ5MUUza0thd3VRSXl2ZDJyMlVqeDQrSFROdFZLYjlrTUxPTzg1STY1Yk5HQkgrNGlyU3k1Z1FZbEUyNkEyY1NHSWNMS1FSbHZKb01uYTdMLzl3eXJ5NEh6T3J6a3JBdkxkZ3NTTmxZanBIUUVSaU9JODBzSjVqTkNDbmZ3MDEzRitBK3NBZkxteVMvQkRMTlExcWFRM3A2aDgvSnFBZmhYNU9HSGdTaVJWT0NFanVhREIvTXdaTkN1M1FMOWVoaG9Bajd1T2Y4UGtyM21JamJoaDlIaWpzangxOTErMGUySlFyRmEwMUFWSktFVnR1UHRJYzJoLzFwUEtNdnllbnhqVE8yT3hQbmpqdCs4NG5JS0toeERKL2doUHQ3aXY4UG1USjBsS0t5UFJzc2w4Zi9RZEhkeHVwYjZqVHNJNlVLbXo5WTQ2UE1CdUQ2UDN3aDhxcDM2TzZvaWJORGlRZDFzRTEwdkpoOXoxRnlzS0llOEVxTXBuTmRFbUcyVGZFQnhScG1RcmhLRXFlZTBwNithNnNRbzhjVmxSSmtLUUFZS2F3Y2FORVM1WGM2ZFFZNW5xZWlxOHNVaXpmMXNwZkhlSGVsRHUxTTZCUlh1Q2pGYWZYaHo4aTNsUFdnWXFWcGZ4MTNpZ1ZDUmY0N1VINjUyeUxuc21lcENCV2d5QlRXQWNPeUYxUXg4WUd0Wm5vYjFUTis2eEV3enBjV1Z5N1FPOVA5MnNLQTlTSysvTkhzcWYxM0NPdDBKSEN0VFYxT2xUUVcrSkFLeXhlMUhsNytzOTV6M0tDZ0ZLUVMrM0FzMUpWN05hK2crTENSMklldnU4ZDVEMEw3R3dvRHJlVXY0Mzc0TFJhRmtOc0hPcVdiVTluaFFqZE1WcjdhL2k4Ty80aGJwdGFTenFxa2dZRmlORlUvb21XNXF3SXo3c3A0bnNjSVRSRTNndWE2YnprbE1aOEVDbjFpcUFXdDBhNmdla2k1RGFMOHFZYXBUQ0NoamxXc0V4cUZ1eGlXUDM1VFVDZGRFZDhBQ2JNR3MrZ1FGeURPb3pmQkRHMTdkWk8wbUN3VytQekNMMmpiSUNETmFpNS9qbTFRcjZNTDU2anpVYUlEejBHTFBUU2FleDFVRER3a1E5bzdtWFdDMFI3alduemJrSFJXY29tVmJXbUdxTDFyamRvYWNzL1I5dWpxVXVCQTZBNVZML3FrUTF4SEw0MkVYb29wckM4d3JyZlI2OHpNTUZ4T3dVN0NZSEo3YmhHL1E0ck5zWERCY01vMUFkaXE5TFhiWG0vUUpqMHUvamdaR3NzejBubktLVUZKY3h6dUFOSzk2eld3ZjFEWGFzVWNPb0V1RWF0bTFybVA1d3JCSm1XL1p3VDZhQkJpUjJPU0oweHI4dFE2T2JtZEtqeWIrMWVFWGIxNDM3UjJJZGhEVWRrNVBSenRIMllGdDJwbXVMNC9MbUlMRkF2UGRpeU10REhOaitLaDRzVjRNbFhiV1Byckk5N1lCT0ZwRmxYK2duZXdLS2ZGWmtIRTdkaXR5MzRkVVEyR25lNnNBR3gxenh5alp2NUtCTTI2bFJIRjQ1WHFGTkoxUlEzaE15bUpIc3lZTnNNTzQxQldyR3YxOVBBNDY4ZWN3OUhjUk4wd2hqVVRnbnM4WlZhQzRoaUpzZ1kwN2FBRUJIbTkwL3VoaGpPL1dtYjd3dVZhZGhsOVJuSGVRanB4NGd3Q3JMejVpNXM1SXQxc0J3ZkRiMEZlK1BDcExrYyt3SUlOSzJZODZrUHRoUjZnSndXNzV6dW9ONUMwQ0FpRHdmVTczdmFBWmFoemY0VkxObE0wVTA0T3RIWUJpMTNZZ1BvTm1HSFJlbFpWRXkyS3VLVlpnaEQxNHZTbFkrSnJNQkRkbTJ5MnRoRlYrQnJpaEw3K2ZRNXdjWW54R2VsYXdEdW9TUjUrYkREa3I2Ukw0MEw0eHlmQWh4bHJPbjB1QTI4Z2hHZVdndWFXS0V2NW5CcnJ2ZXUxdWVWeTFNdkdVWUJZK0lsRXI4TmRETlJkbUV6WHQzOWtHbGQ4NnhPZkFIL3hMMVZtdWdhWE9HYVBCMnFjN1dEUmtXNms1RjZuM1BrSXpkUFh5T05LcDFEa09nM29jU01aTVRzNkdLajlDM3ZPRFo2WlFwd05EWUxNVCtDbUVMMThHUmpYTmNabFAvTG5oaUFJc2NZVEwxK2lIV0RZdlJtdlBNd3RPSGhDbkVYSVUzRlRiUCs2UVJHQTZxeWRibm5lcVZoWG93Y0xtYk1JejE2SUMxa3doWmo3NS9NNTNzS1lYMnpSZ09TVEFmTlNELzVsWllTTlV4SmZLVERnaWFGRWdnckNyZCszQ2MrY2h6c2xJM3pEWEVLVHJ2bGNYMkluQzl1SCtmc3lweUh3K0F2WTJPbUJHUU1JSWM4ZkUzdE5PMGdCVFZxWHNkc0U3Nll3SHIyOWR6UWNrdXN1eUpzQmZTVmNscnZzTkNaMVBRREw4SDNjUnMzSEU5blVreDViYkpZV3NQeGI4MjVnbkVwV1U5WjlLdHp2c2xpNy9oZU9sREtwSHhKYjF1Q3JXcWY4Z1JuV21xM3pmU1NyVVhCSFNMdTYyTXJrWFRqV2dhcFVWeE1Ha3JuelIwRTRQTXkxYkZjeURwRVFlMTVUYXlXQk0xQjZqcklHKzBEUlI5T2FDVVB3RDdleE5talpiOU04MXVzK0FJUmZ5ekpQWkdtZkh1VDlTTnpGZk51UWRGWnlpWlZ0YVlhb3ZXdU4yaXJJM3pRYXRLQ0RuUUlYcHIwVmhHMEdvcDhjL3pyb1dCb04vYVZLbW44c2tTRnZBRE9qb1pBaXhnNksxeTl3Rmk4cGVDbWltRlozWnpDVnNHNkVVOVN2bGJxNSt3bjdENnkrZEFZZGFQbXM0Z3dDckx6NWk1czVJdDFzQndmRGJ6NFg0VnhxSXBjVEM5TmFZS3FBN0dLSythVHJaV1V3d04yMVFPdHI4ZXF4U2dKMVU5ZUNPY1dYUWQrcDM2R3k0ZlkrdDljMkNzVk5iTmwxZ2h4YTliSThVNmU2RlRkL3Z2QmFxOWpyS2RpdHE0bU5DYWlvZ21mUEs2TTQ4VVlJOGpaTUNkZC85QzhCcXZVajRiWVU1YnlXQVNFRzZCQkdkSzhLbGZpL2E0TFd0M2l2QzR1OVFCVGZiL3ZDbU5KaS9RQWZhYmNQRytVc1dtc1lOUksrZzhoTWNzdUJtaGg0OE5waFJ2ZWJWUXFxNm5jS3hjMW5GSFdNVzVNNm9mK3o4YzFIZGRuaWVEUDlHYUJzcSt5c2xqS3NsWXJ0OTg5UFk5eHNibWtyM1gvb0NmaUZVNE5mY09oZWUrK25nVzBYcFpBVnQxSTJRbmMxYWx3Ym5vTnFNTWhYSUI5NWlrTHhTRnFIMjI2WnE5c0cvdHJkcjJTQVZ1cm55V3NmSE5qdUlsQldLRE9yZDdWcllGSnZROXhiVm9tS3FRanVoOWR6ZjJudlZyQnpiRUYwQ1pZNml6a1kvUlFZNXI5azkzL3kyTkc3bzA3bk1Zak90WllZZU5Vb2lrN0diSy9IelFsMVM3cy9GQ2hudDlNNmZFMFV5dVBtdHRPOThocXp4UWJ0ZU1hbE10U2NlMldMY2p5WFZHZnBxZEJrWXltNGdaQnljY1M2YW50dDRvTGRsdVdTU0pzSFgxSWNYaFF5Nm9KK0Foanc5aEZZd1hMSFBMb0NvM2pFbGlVQUs0MTc5d3RZdEhzTzBhYkx4NCtobXRNNUZ6N3dVVmFoQkE5c3VwT1RmL0ZENHNpWk1Nb2Y1VzN2bTVEZWRocUdBTmxodDNtSTZSbUlodjQ4UVZ0bmVNc1V6WUM0TkRoWkQ0TTVSNnA3R1hCcWNwdTNGYUVGLzBJMGUzTGNlWDFITitpRHFLUlB1R3p2cGFjLzF0c0dQSXRlQUR4dTlPWW9hcDJ6M0YxQ3pTZy9VdWE4bC9LRXp0QUtEY3ZiaE5VL1lVYzJsaGd4Z2ZkYjRlK1A5VFo3UmFYODJzNjI3dTBDYkZzZkdFLzFoTHBiNU1jMnZrMXVER3JkSWNiV0E2eGhwWUFIWWhFWVVsOWM3NVkvUi8wZ2w2cjkrbTZjSTBCdkJZNUFhNU5CUmM2VU12c08vUE93NUNjcjc5c0p6aWNlYVYzWXdyWUVranA2S2krT1lyR3U5NTRBQStkSjlXc3ZOR0JGR01yS0FmUTlWVUMvQVRrSmZUbG9NbHREZVY1QW85emthYXkzZEtBYTUvUHhBR1JEQVVjUUxERjd1VlhiRDF2RmdFLytSWGl3elM1TjdjcjNhRkJkUlk3WEFtRnovZmIwL0tTcFI4Q1EvbG9rcG1NMm1sdEo5dkdQZ2lxYjVuWmw5S3U3ZDJHbGdBZGlFUmhTWDF6dmxqOUgvU0J1akJQb08xZnBvT3U1RjM1Y2RIYTVrU0Z2QURPam9aQWl4ZzZLMXk5d0ZsajBFejVrc1VXM1dVNjNFN2U0cXREVUNLV3dqalU1ZjBGZDU3VnlWenBDNkNkQ1NjQmpZU3pUOXJaTFZza3E2MWFPV3JERFVOS3FBUTMrblgvQkJXM2NRVEVjT1ZkYzE1bmdWWGNTUy9hSzJRRk1kaUtRbHFtMTVmRXJKZHdxeWV6YTdoZmxLVGlDelVkdTVWR2xGVzlxQ3Q4c3lIb29zQTJOemZvc0pkVGROOGJXSG5vRHI1TjI1ZXQrcC9udmpqT3paUmFMWW9ZL2ZyL2s1aHFwdE9rPVxcXFxcXFwiKTtcXFxcbiAgICByZXR1cm4gJC5leHBvcnRzO1xcXFxufSkoKTtcXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCLnvJbovpHlhazlkYpcXFwiLFxcXCJwYXRoXFxcIjpcXFwiZGV2SW5mb0VkaXRcXFwiLFxcXCJydWxlXFxcIjpcXFwianM6XFxcXG5hZGRMaXN0ZW5lcignb25DbG9zZScsICQudG9TdHJpbmcoKCk9PntcXFxcbiAgICBwdXRNeVZhcihcXFxcXFxcImRldkluZm9cXFxcXFxcIiwnJyk7IC8v5riF6Zmk5Y6G5Y+y5YWs5ZGKXFxcXG59KSk7XFxcXG5zZXRQYWdlVGl0bGUoJ+e8lui+keWFrOWRiicpO1xcXFxuLy8gbGV0IHtub3dKeCxNeUppZXhpLGp4c1JvdXRlfSA9IE1ZX1BBUkFNUztcXFxcbmNvbnN0IHtjb2xvcixzbWFsbCxhcGksIGdldEZpbGUsZ2V0QXBpfSA9ICQucmVxdWlyZShcXFxcXFxcImhpa2VyOi8vcGFnZS91dGlsaXlcXFxcXFxcIik7XFxcXG4vLyBsZXQgaG91c2VGaWxlID0gZ2V0RmlsZXx8ZmFsc2U7XFxcXG52YXIgZGV2X2luZm9fdXJsID0gZ2V0QXBpKCdpbmZvR2V0VXJsJyk7XFxcXG4vLyBsb2coZGV2X2luZm9fdXJsKTtcXFxcbnZhciBnZXRfaW5mbyA9IGZ1bmN0aW9uKHFxKXtcXFxcbiAgICBxcSA9IHFxfHwnNDM0ODU3MDA1JztcXFxcbiAgICBsZXQgZGV2X2luZm9fdXJsID0gZGV2X2luZm9fdXJsK3FxO1xcXFxuICAgIGxldCBiYWNrX2NvZGUgPSBKU09OLnBhcnNlKHJlcXVlc3QoZGV2X2luZm9fdXJsKSk7XFxcXG4gICAgbGV0IGRldl9pbmZvPWJhY2tfY29kZS5yZXN1bHR8fGJhY2tfY29kZS5kZXRhaWw7XFxcXG4gICAgcmV0dXJuIGRldl9pbmZvO1xcXFxufTtcXFxcbnZhciBiZWZvcmVfcmVmcmVzaCA9IGZ1bmN0aW9uKCl7XFxcXG4gICAgbGV0IGRldl9zZXRfaW5mbyA9IGdldE15VmFyKFxcXFxcXFwiZGV2X3NldF9pbmZvXFxcXFxcXCIpLnNwbGl0KCckJCcpO1xcXFxuICAgIGxldCBkZXZfaW5mb191cmwgPSBkZXZfc2V0X2luZm8uc2xpY2UoLTEpWzBdO1xcXFxuICAgIGxldCBiYWNrX2NvZGUgPSBKU09OLnBhcnNlKHJlcXVlc3QoZGV2X2luZm9fdXJsKSk7XFxcXG4gICAgbGV0IGRldl9pbmZvPWJhY2tfY29kZS5yZXN1bHR8fGJhY2tfY29kZS5kZXRhaWw7XFxcXG4gICAgcHV0TXlWYXIoXFxcXFxcXCJkZXZJbmZvXFxcXFxcXCIsZGV2X2luZm8pO1xcXFxuICAgIHJldHVybiBkZXZfaW5mb1xcXFxufTtcXFxcbmxldCBkID0gW107XFxcXG5kLnB1c2goe1xcXFxuICAgIHRpdGxlOifnvJbovpHlhazlkYonLFxcXFxuICAgIGRlc2M6J+aUr+aMgW1k6K+t5rOVLOeCueWHu+i/m+WFpeWtpuS5oE1k6K+t5rOVXFxcXFxcXFxu5L+d5a2Y5YWs5ZGK5oyJ6ZKu5Zyo5paH5pys5qGG5pyA5LiL6Z2iJyxcXFxcbiAgICBjb2xfdHlwZTondGV4dF8xJyxcXFxcbiAgICB1cmw6J2h0dHBzOi8vd3d3LnJ1bm9vYi5jb20vbWFya2Rvd24vbWQtdHV0b3JpYWwuaHRtbCdcXFxcbn0pO1xcXFxuZC5wdXNoKHtcXFxcbiAgICB0aXRsZTon6L+U5ZueJyxcXFxcbiAgICBjb2xfdHlwZTondGV4dF8yJyxcXFxcbiAgICB1cmw6JCgnI25vTG9hZGluZyMnKS5sYXp5UnVsZSgoKT0+e1xcXFxuICAgICAgICBiYWNrKGZhbHNlKTtcXFxcbiAgICAgICAgcmV0dXJuICdoaWtlcjovL2VtcHR5J1xcXFxuICAgIH0pXFxcXG59KTtcXFxcbmlmKCFnZXRNeVZhcignZGV2SW5mbycpKXtcXFxcbiAgICBiZWZvcmVfcmVmcmVzaCgpO1xcXFxufVxcXFxubGV0IGVtcHR5ID0gJ2hpa2VyOi8vZW1wdHknO1xcXFxuZC5wdXNoKHtcXFxcbiAgICB0aXRsZTon6ZiF6KeI5p+l6ZiFJyxcXFxcbiAgICBjb2xfdHlwZTondGV4dF8yJyxcXFxcbiAgICAvLyB1cmw6JChnZXRNeVZhcignZGV2SW5mbycpKS5jb25maXJtKClcXFxcbiAgICB1cmw6JChlbXB0eSkucnVsZSgoKT0+e1xcXFxuICAgICAgICByZXF1aXJlKFxcXFxcXFwiaHR0cHM6Ly9naXRsYWIuY29tL2hqZGhueC9oaWtlci8tL3Jhdy9tYWluL2pzL21hcmtlZC5taW4uanNcXFxcXFxcIik7XFxcXG4gICAgICAgbGV0IGRldkluZm89XFxcXFxcXCJcXFxcXFxcIjtcXFxcbiAgICAgICB0cnl7XFxcXG4gICAgICAgICAgZGV2SW5mbz1tYXJrZWQucGFyc2UoZ2V0TXlWYXIoJ2RldkluZm8nKSk7XFxcXG4gICAgICAgfWNhdGNoKGUpe31cXFxcbiAgICAgICAgc2V0UmVzdWx0KFtcXFxcbiAgICAgICAgICAgIHtcXFxcbiAgICAgICAgICAgICAgICB0aXRsZTpkZXZJbmZvLFxcXFxuICAgICAgICAgICAgICAgIGNvbF90eXBlOidyaWNoX3RleHQnLFxcXFxuICAgICAgICAgICAgfVxcXFxuICAgICAgICBdKTtcXFxcbiAgICB9KVxcXFxufSk7XFxcXG5kLnB1c2goe1xcXFxuICAgIGRlc2M6IFxcXFxcXFwi5b+r5p2l57yW6L6R5L2g55qE5YWs5ZGK5ZCnflxcXFxcXFwiLFxcXFxuICAgIGNvbF90eXBlOiAnaW5wdXQnLFxcXFxuICAgIGV4dHJhOiB7XFxcXG4gICAgICAgIHRpdGxlVmlzaWJsZTogZmFsc2UsXFxcXG4gICAgICAgIGRlZmF1bHRWYWx1ZTogZ2V0TXlWYXIoJ2RldkluZm8nLCAnJyl8fFxcXFxcXFwiXFxcXFxcXCIsXFxcXG4gICAgICAgIHR5cGU6IFxcXFxcXFwidGV4dGFyZWFcXFxcXFxcIixcXFxcbiAgICAgICAgaGVpZ2h0Oi0xLFxcXFxuICAgICAgICBvbkNoYW5nZTogJ3B1dE15VmFyKFxcXFxcXFwiZGV2SW5mb1xcXFxcXFwiLGlucHV0KSdcXFxcbiAgICB9XFxcXG59KTtcXFxcbmQucHVzaCh7XFxcXG4gICAgdGl0bGU6XFxcXFxcXCLkv53lrZjlhazlkYpcXFxcXFxcIixcXFxcbiAgICBjb2xfdHlwZTogJ3RleHRfY2VudGVyXzEnLFxcXFxuICAgIHVybDokKCfnoa7orqTkv53lrZjlhazlkYrlkJfvvJ/lsIbkvJrkuI7pgZPplb/ku5PlupPmnI3liqHlmajpgJrorq8nKS5jb25maXJtKCgpPT57XFxcXG4gICAgICAgIGxldCBkZXZfc2V0X2luZm8gPSBnZXRNeVZhcihcXFxcXFxcImRldl9zZXRfaW5mb1xcXFxcXFwiKS5zcGxpdCgnJCQnKTtcXFxcbiAgICAgICAgbGV0IGlucHV0X3RleHQgPSBnZXRNeVZhcignZGV2SW5mbycsICcnKTtcXFxcbiAgICAgICAgaWYoaW5wdXRfdGV4dC5sZW5ndGggPj0gNCl7XFxcXG4gICAgICAgICAgICBsZXQgaW5mb19zZXRfdXJsPSBkZXZfc2V0X2luZm9bMl07XFxcXG4gICAgICAgICAgICBsZXQgc2VuZF9kYXRhID0ge1xcXFxcXFwicGFyYW1zXFxcXFxcXCI6XFxcXG4gICAgICAgICAgICAgICAgICAgIHtcXFxcXFxcImRhdGFcXFxcXFxcIjoge1xcXFxcXFwiaW5mb1xcXFxcXFwiOiBpbnB1dF90ZXh0fSxcXFxcbiAgICAgICAgICAgICAgICAgICAgICAgIFxcXFxcXFwibmFtZVxcXFxcXFwiOiBkZXZfc2V0X2luZm9bMF0sXFxcXG4gICAgICAgICAgICAgICAgICAgICAgICBcXFxcXFxcInBhc3N3b3JkXFxcXFxcXCI6IGRldl9zZXRfaW5mb1sxXX1cXFxcbiAgICAgICAgICAgIH07XFxcXG4gICAgICAgICAgICAvLyBsb2coc2VuZF9kYXRhKTtcXFxcbiAgICAgICAgICAgIGxldCBwYXIyID0ge2hlYWRlcnM6eydjb250ZW50LXR5cGUnOidhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLTgnLCdVc2VyLUFnZW50JzpkZXZfc2V0X2luZm9bM119LGJvZHk6SlNPTi5zdHJpbmdpZnkoc2VuZF9kYXRhKSxtZXRob2Q6J1BPU1QnfTtcXFxcbiAgICAgICAgICAgIC8vIHBhcjIgPSBKU09OLnN0cmluZ2lmeShwYXIyKTsgLy94NemHjOmdouivt+axguaJjemcgOimgee8lueggVxcXFxuICAgICAgICAgICAgdHJ5IHtcXFxcbiAgICAgICAgICAgICAgICBsZXQgYmFja19yZXQgPSByZXF1ZXN0KGluZm9fc2V0X3VybCwgcGFyMik7XFxcXG4gICAgICAgICAgICAgICAgYmFja19yZXQgPSBKU09OLnBhcnNlKGJhY2tfcmV0KS5yZXN1bHQ7XFxcXG4gICAgICAgICAgICAgICAgaWYoYmFja19yZXQuc3RhdHVzPT09MCl7XFxcXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlZnJlc2hQYWdlKCk7XFxcXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/kv53lrZjmiJDlip9cXFxcXFxcXG4nK2JhY2tfcmV0LmRldGFpbDtcXFxcbiAgICAgICAgICAgICAgICB9ZWxzZXtcXFxcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+S/neWtmOWksei0pVxcXFxcXFxcbicrYmFja19yZXQuZGV0YWlsO1xcXFxuICAgICAgICAgICAgICAgIH1cXFxcbiAgICAgICAgICAgIH1jYXRjaCAoZSkge1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/plJnor69cXFxcXFxcXG4nK2UubWVzc2FnZTtcXFxcbiAgICAgICAgICAgIH1cXFxcbiAgICAgICAgfWVsc2V7XFxcXG4gICAgICAgICAgICBjb25maXJtKHt0aXRsZTon6YGT6ZW/5o+Q56S6Jyxjb250ZW50Oifomb3nhLbkvaDlvojmh5LvvIzkvYbmmK/lhazlkYroh7PlsJHlhpk05Liq5a2X5ZCn77yBJ30pO1xcXFxuICAgICAgICAgICAgcmV0dXJuICdoaWtlcjovL2VtcHR5J1xcXFxuICAgICAgICB9XFxcXG4gICAgfSlcXFxcbn0pO1xcXFxuXFxcXG5zZXRSZXN1bHQoZCk7XFxcIn0se1xcXCJjb2xfdHlwZVxcXCI6XFxcIm1vdmllXzNcXFwiLFxcXCJuYW1lXFxcIjpcXFwi6aKE5aSE55CG5L6d6LWW5paH5Lu2XFxcIixcXFwicGF0aFxcXCI6XFxcImxpYnNcXFwiLFxcXCJydWxlXFxcIjpcXFwiaWYoZ2V0QXBwVmVyc2lvbigpPj0zMjAwKXtcXFxcbiAgICB0cnl7XFxcXG4gICAgICAgIHJjKFxcXFxcXFwiaGlrZXI6Ly9maWxlcy9ydWxlcy9qcy8kaGlrZXIuanNcXFxcXFxcIiwgLTEpO1xcXFxuICAgICAgICAvLyQuc2V0Um9vdCgnaHR0cHM6Ly9oamRobnguY29kaW5nLm5ldC9wdWJsaWMvaGlrZXIvaGlrZXIvZ2l0L2ZpbGVzL21hc3Rlci9qcy8nKTtcXFxcbiAgICAgICAgJC5zZXRSb290KCk7XFxcXG4gICAgICAgICQuc2V0TGliKHtcXFxcbiAgICAgICAgICAgIGxzZzogXFxcXFxcXCJsc2cuanNcXFxcXFxcIiwgLy/mnKzlnLDlgqjlrZhcXFxcbiAgICAgICAgICAgIGZpbGU6IFxcXFxcXFwiZmlsZS5qc1xcXFxcXFwiLCAvL+aWh+S7tm9zXFxcXG4gICAgICAgICAgICBmaWxlU2VsZWN0OiBcXFxcXFxcImZpbGVTZWxlY3QuanNcXFxcXFxcIiwgLy/mlofku7bpgInmi6nlmahcXFxcbiAgICAgICAgICAgIGR0OiBcXFxcXFxcImR0LmpzXFxcXFxcXCIsIC8v5Yqo5oCB5YiG57G7XFxcXG4gICAgICAgICAgICBkcjogXFxcXFxcXCJkci5qc1xcXFxcXFwiLCAvL2Ry5qih5p2/5L6d6LWWXFxcXG4gICAgICAgICAgICBkcnByZTogXFxcXFxcXCJkcnByZS5qc1xcXFxcXFwiLCAvL2Ry5qih5p2/6aKE5aSE55CGXFxcXG4gICAgICAgICAgICBkcnVwOiBcXFxcXFxcImRydXAuanNcXFxcXFxcIiwgLy9kcuaooeadv+iHquWKqOabtOaWsFxcXFxuICAgICAgICAgICAgZHJtYXRjaDogXFxcXFxcXCJkcm1hdGNoLmpzXFxcXFxcXCIsIC8vZHLmqKHmnb/oh6rliqjmqKHmnb/ljLnphY1cXFxcbiAgICAgICAgICAgIGRybTogXFxcXFxcXCJkcm0uanNcXFxcXFxcIiwgLy9kcuaooeadv+Wwj+eoi+W6j1xcXFxuICAgICAgICAgICAgY21zOiBcXFxcXFxcImNtcy5qc1xcXFxcXFwiLCAvL2Ntc+aooeadv+S+nei1llxcXFxuICAgICAgICAgICAgY21zcHJlOiBcXFxcXFxcImNtc3ByZS5qc1xcXFxcXFwiLCAvL2Ntc+mihOWkhOeQhlxcXFxuICAgICAgICAgICAgY21zbTogXFxcXFxcXCJjbXNtLmpzXFxcXFxcXCIsIC8vY21z5qih5p2/5bCP56iL5bqPXFxcXG4gICAgICAgICAgICBsaWJjaGVjazogXFxcXFxcXCJsaWJjaGVjay5qc1xcXFxcXFwiLCAvL2Ry5qOA5rWL5L6d6LWWXFxcXG4gICAgICAgICAgICBydWxlRWRpdG9yOiBcXFxcXFxcInJ1bGVFZGl0b3IuanNcXFxcXFxcIiwgLy/lhpnpobXmupDnpZ7lmajlsI/nqIvluo9cXFxcbiAgICAgICAgICAgIGhvdXNlTGF6eTogXFxcXFxcXCJob3VzZUxhenkuanNcXFxcXFxcIiwgLy/ku5PlupPpgJrlhY1cXFxcbiAgICAgICAgICAgIGxhenk6IFxcXFxcXFwibGF6eS5qc1xcXFxcXFwiLCAvL+mmmeWFjVxcXFxuICAgICAgICAgICAgc3ViOiBcXFxcXFxcInN1Yi5qc1xcXFxcXFwiLCAvL+mBk+W+t+e7j+iuoumYhVxcXFxuICAgICAgICAgICAgaGlrZXJVaTogXFxcXFxcXCJoaWtlclVpLmpzXFxcXFxcXCIsIC8v5rW36ZiU57uE5Lu25L6d6LWWXFxcXG4gICAgICAgICAgICBoaWtlckxpYnM6IFxcXFxcXFwiaGlrZXJMaWJzLmpzXFxcXFxcXCIsIC8v5rW36ZiU5YWo6IO95L6d6LWWXFxcXG4gICAgICAgIH0pO1xcXFxuICAgIH1jYXRjaChlKXtcXFxcbiAgICAgICAgLy90b2FzdCgn6K+35bCd6K+V54K55Ye75LuT5bqT5Li76aG155qE5Y2H57qn5LuT5bqT5peB6L6555qE5oyJ6ZKu5Y2H57qnJOaJqeWxle+8jOWQpuWImeafkOS6m+WKn+iDveS4jeiDveato+W4uOS9v+eUqCcpO1xcXFxuICAgICAgICBjb25maXJtKHtcXFxcbiAgICAgICAgICAgIHRpdGxlOiAn5o+Q56S6LeeCueWHu+ehruWumuWPr+S7peWvvOWFpScsXFxcXG4gICAgICAgICAgICBjb250ZW50OiAn6K+35bCd6K+V54K55Ye75LuT5bqT5Li76aG155qE5Y2H57qn5LuT5bqT5peB6L6555qE5oyJ6ZKu5Y2H57qnJOaJqeWxle+8jOWQpuWImeafkOS6m+WKn+iDveS4jeiDveato+W4uOS9v+eUqCcsXFxcXG4gICAgICAgICAgICBjb25maXJtOiAkLnRvU3RyaW5nKCgpPT57XFxcXG4gICAgICAgICAgICAgICAgY29uc3Qge2dldEFwaX0gPSAkLnJlcXVpcmUoXFxcXFxcXCJoaWtlcjovL3BhZ2UvdXRpbGl5P3J1bGU96YGT6ZW/5LuT5bqTUHJvXFxcXFxcXCIpO1xcXFxuICAgICAgICAgICAgICAgIGxldCBydWxlSGVhZCA9ICfmtbfpmJTop4bnlYzvvIznvZHpobXmj5Lku7bvv6Vqc191cmzvv6UkaGlrZXJAJztcXFxcbiAgICAgICAgICAgICAgICBsZXQgdXJsID0gZ2V0QXBpKCdpbXBvcnRVcmwnKStcXFxcXFxcIjUxMTFcXFxcXFxcIjtcXFxcbiAgICAgICAgICAgICAgICBsZXQgaW1wb3J0VXJsID0gJ3J1bGU6Ly8nK2Jhc2U2NEVuY29kZShydWxlSGVhZCt1cmwpO1xcXFxuICAgICAgICAgICAgICAgIHJldHVybiBpbXBvcnRVcmxcXFxcbiAgICAgICAgICAgIH0pLFxcXFxuICAgICAgICAgICAgY2FuY2VsOiAkLnRvU3RyaW5nKCgpPT57XFxcXG5cXFxcbiAgICAgICAgICAgIH0pLFxcXFxuICAgICAgICB9KVxcXFxuICAgIH1cXFxcbn1cXFwifSx7XFxcImNvbF90eXBlXFxcIjpcXFwibW92aWVfM1xcXCIsXFxcIm5hbWVcXFwiOlxcXCJJbXBvcnTor6bnu4ZcXFwiLFxcXCJwYXRoXFxcIjpcXFwicnVsZURldGFpbEltcG9ydFxcXCIsXFxcInJ1bGVcXFwiOlxcXCJqczpcXFxcbiQuZXhwb3J0cyA9IFxcXFxcXFwiaGlrZXI6Ly9wYWdlL3J1bGVEZXRhaWw/cnVsZT3pgZPplb/ku5PlupNQcm8maWQ9XFxcXFxcXCIgKyAkLmltcG9ydFBhcmFtO1xcXFxuXFxcIn1dXCIsXCJwcm94eVwiOlwiXCJ9IiwicGljVXJsIjoiaHR0cHM6Ly9waWMucXF0bi5jb20vdXAvMjAxOS05LzIwMTkwOTI4MDg1MzQ1NDI5NjUuanBnIiwidGl0bGUiOiLlsI/npaUoNykifQ==
zLTinYeh,Easter Competition,Spocoman,C++,Sunday 17th of September 2023 01:21:29 PM CDT,"#include <iostream>
#include <string>

using namespace std;

int main() {
    int easterBreadCount;
    cin >> easterBreadCount;

    string baker, command, topBaker = """";
    int topPoints = 0;

    for (int i = 0; i < easterBreadCount; i++) {
        cin.ignore();
        getline(cin, baker);
        int bakerpoints = 0;

        while (true) {
            cin >> command;
            if (command == ""Stop"") {
                break;
            }
            bakerpoints += stoi(command);
        }

        if (topPoints < bakerpoints) {
            topBaker = baker;
            topPoints = bakerpoints;
            cout << topBaker << "" has "" << topPoints << "" points.\n""
                << topBaker << "" is the new number 1!\n"";
        }
        else {
            cout << baker << "" has "" << bakerpoints << "" points.\n"";
        }
    }
    
    cout << topBaker << "" won competition with "" << topPoints << "" points!"";

    return 0;
}"
NFYJUQZs,Garagentor - Template-Sensor,gerd_r,YAML,Sunday 17th of September 2023 01:18:12 PM CDT,"  - platform: template
    covers:
      garage_door:
        device_class: garage
        friendly_name: ""Garagentor""
        open_cover:
          - condition: state
            entity_id: binary_sensor.schalter_garagentor_garage_door_contact
            state: ""off""
          - service: switch.turn_on
            target:
              entity_id: switch.schalter_garagentor_trigger
        close_cover:
          - condition: state
            entity_id: binary_sensor.schalter_garagentor_garage_door_contact
            state: ""on""
          - service: switch.turn_off
            target:
              entity_id: switch.schalter_garagentor_trigger
        stop_cover:
          service: switch.turn_on
          target:
            entity_id: switch.schalter_garagentor_trigger
        icon_template: >-
          {% if is_state('binary_sensor.schalter_garagentor_garage_door_contact', 'on') %}
            mdi:garage-open
          {% else %}
            mdi:garage
          {% endif %}
        position_template: >-
          {% if is_state('binary_sensor.schalter_garagentor_garage_door_contact', 'on') %}
            100
          {% else %}
            0
          {% endif %}"
W63YSSW8,ngrokstart/kill,SeloTapeTM,Bash,Sunday 17th of September 2023 01:12:05 PM CDT,"# ngrok http --log=stdout https://localhost:6901 > /dev/null &

#!/bin/sh

# Set local port from command line arg or default to 8080
LOCAL_PORT=${1-8443}

echo ""Start ngrok in background on port [ $LOCAL_PORT ]""
nohup ngrok http ""$LOCAL_PORT"" &>/dev/null &

echo -n ""Extracting ngrok public url .""
NGROK_PUBLIC_URL=""""
while [ -z ""$NGROK_PUBLIC_URL"" ]; do
  # Run 'curl' against ngrok API and extract public (using 'sed' command)
  export NGROK_PUBLIC_URL=$(curl --silent --max-time 10 --connect-timeout 5 \
                            --show-error http://127.0.0.1:4040/api/tunnels | \
                            sed -nE 's/.*public_url"":""(https:..[^""]*).*/\1/p')
  sleep 1
  echo -n "".""
done

echo
echo ""NGROK_PUBLIC_URL => [ $NGROK_PUBLIC_URL ]""
echo $NGROK_PUBLIC_URL > /home/ubuntu/docker/telegram_bot_link.secret



#ngkill

#!/bin/sh

echo ""Stopping background ngrok process""
kill -9 $(ps -ef | grep 'ngrok' | grep -v 'grep' | awk '{print $2}')
echo ""ngrok stopped""
"
krYWrTBR,Horor_CPP3_Done,Neo_Feo,C,Sunday 17th of September 2023 12:59:30 PM CDT,"#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int suma(int lenght, int height,int array [lenght][height]){
    if(height<2){
        printf(""\033[31m Nu exista  coloana cu numarul 2 \033[0m"");
        exit(-6);
    }
    int sum = 0;
    for(int i = 0; i<lenght;++i){
        sum += array[i][1];
    }
    return sum;
}

int produsul (int row, int col,int array [row][col]){
        if(col<2){
            printf(""\033[31m Nu exista  coloana cu numarul 2 \033[0m"");
            exit(-6);
        }
        int prod = 1;
        for(int i = 0; i<row;++i){
            prod *= array[i][1];
        }
        return prod;
}

void input_into_Array(int row,int col, int array[row][col]){
        for (int i = 0; i < row; i++){
            printf(""Introduceti elementele randului %i\n"",i+1);
            for(int j = 0; j < col; j++){
                printf(""%i : "", j+1);
                scanf(""%i"",&array[i][j]);
            }
        }
}

int main()
{
    int row, col;

    printf(""Introduceti numarul de coloane: "");
    scanf(""%i"",&col);
    printf(""Introduceti numarul de randuri: "");
    scanf(""%i"",&row);

    row = abs(row);
    col = abs(col);

    int i [row][col];

    input_into_Array(row,col,i);

    printf(""suma este: %i\n"",suma(row,col,i));
    printf(""produsul este: %i"",produsul(row,col,i));
    return 0;
}
"
MRyZ37y1,Untitled,skaram,Python,Sunday 17th of September 2023 12:54:48 PM CDT,"n = int(input())
s = input()
x = int(s, 2)
g = 0
for i in s:
    if i == '1':
        g += 1
if g == 1:
    for i in s:
        if i == '1':
            print(0)
        else:
            print(1)
    exit(0)
if g == 0:
    print(""1\n"" * n)
    exit(0)
a = x % (g - 1)
ap = 1
c = x % (g + 1)
cp = 1
ans = []
shit = [0]
for i in range(1, 200100):
    shit.append(0)
    k = 1
    while k <= i:
        if i & k:
            shit[i] += 1
        k *= 2
for i in range(n - 1, -1, -1):
    if s[i] == '0':
        b = (c + cp) % (g + 1)
    else:
        b = (a - ap) % (g - 1)
    cnt = 1
    while True:
        h = shit[b]
        if h == 0:
            ans.append(cnt)
            break
        cnt += 1
        b %= h
    ap = 2 * ap % (g - 1)
    cp = 2 * cp % (g + 1)
for i in range(len(ans) - 1, -1, -1):
    print(ans[i])
"
